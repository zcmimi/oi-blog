[{"title": "noip\u63d0\u9ad8\u5386\u5e74\u9898\u76ee\u9898\u8868", "content": "\u4ee3\u7801\u89c1\u6587\u672b\n\n## 2010\n\n|\u9898\u76ee|\u7b97\u6cd5|\u9898\u89e3|\n|-|-|-|\n|\u673a\u5668\u7ffb\u8bd1|\u6a21\u62df|\u76f4\u63a5\u6a21\u62df\u5373\u53ef|\n|\u4e4c\u9f9f\u68cb|\u52a8\u6001\u89c4\u5212|\u76f4\u63a5\u56db\u7ef4dp\u5373\u53ef|\n|\u5173\u62bc\u7f6a\u72af|\u5e76\u67e5\u96c6 \u4e8c\u5206\u56fe \u8d2a\u5fc3|\u5e76\u67e5\u96c6\u505a\u6cd5\u66f4\u4e3a\u65b9\u4fbf,\u8bb0\u5f55\u654c\u4eba\u5e76\u67e5\u96c6,\u4ece\u5927\u5230\u5c0f\u6dfb\u52a0\u8fb9\u76f4\u5230\u51fa\u73b0\u77db\u76fe(\u8be6\u89c1\u4ee3\u7801)|\n|\u5f15\u6c34\u5165\u57ce|\u8bb0\u5fc6\u5316\u641c\u7d22 bfs \u8d2a\u5fc3|\u8bb0\u5fc6\u5316\u641c\u7d22\u6216bfs\u51fa\u7b2c$1$\u884c\u6bcf\u4e2a\u57ce\u5e02\u5efa\u8bbe\u84c4\u6c34\u7ad9\u540e\u80fd\u8986\u76d6\u7b2c$n$\u884c\u7684\u533a\u95f4,\u7136\u540e\u8d2a\u5fc3\u7ebf\u6bb5\u8986\u76d6\u5373\u53ef|\n\n## 2011\n\n|\u9898\u76ee|\u7b97\u6cd5|\u9898\u89e3|\n|-|-|-|\n|\u94fa\u5730\u6bef|\u6a21\u62df|\u76f4\u63a5\u6a21\u62df\u5373\u53ef|\n|\u8ba1\u7b97\u7cfb\u6570|\u52a8\u6001\u89c4\u5212 \u7ec4\u5408\u6570|\u52a8\u6001\u89c4\u5212(\u66f4\u7b80\u5355,\u8be6\u89c1\u4ee3\u7801)\u6216\u76f4\u63a5\u63a8\u5f0f\u5b50|\n|\u9009\u62e9\u5ba2\u6808|rmq|\u679a\u4e3e\u989c\u8272,\u76f4\u63a5\u7edf\u8ba1\u5373\u53ef|\n|\u806a\u660e\u7684\u8d28\u76d1\u5458|\u524d\u7f00\u548c \u4e8c\u5206|\u53d1\u73b0$W$\u5bf9\u7b54\u6848\u6709\u5355\u8c03\u6027,\u76f4\u63a5\u4e8c\u5206\u5373\u53ef|\n|Mayan\u6e38\u620f|\u6a21\u62df \u641c\u7d22 \u526a\u679d|\u4e00\u9053\u6bd4\u8f83\u9ebb\u70e6\u7684\u641c\u7d22\u9898, \u4e0d\u7528\u60f3\u592a\u591a,\u76f4\u63a5\u6a21\u62df\u5373\u53ef,\u552f\u4e00\u7684\u526a\u679d\u5c31\u662f\u4e0e\u53f3\u8fb9\u989c\u8272\u76f8\u540c\u65f6\u4e0d\u5fc5\u4ea4\u6362|\n|\u89c2\u5149\u516c\u4ea4|\u8d2a\u5fc3 \u6a21\u62df|\u9996\u5148\u89c4\u5212\u51fa\u4e0d\u4f7f\u7528\u52a0\u901f\u7684\u884c\u7a0b(\u4eba\u7b49\u8f66,\u8f66\u4e0d\u7b49\u4eba),\u7136\u540e\u4ee5\u8d2a\u5fc3\u7684\u7b56\u7565\u4f7f\u7528\u52a0\u901f\u5668|\n\n## 2012\n\n|\u9898\u76ee|\u7b97\u6cd5|\u9898\u89e3|\n|-|-|-|\n|Vigen\u00e8re \u5bc6\u7801|\u6a21\u62df||\n|\u540c\u4f59\u65b9\u7a0b|exgcd|$ax\\equiv 1 \\pmod b$|\n|\u56fd\u738b\u6e38\u620f|\u8d2a\u5fc3|\u6309\u7167$a_ib_i$\u4ece\u5c0f\u5230\u5927\u6392\u5e8f,\u63a5\u7740\u9ad8\u7cbe\u5ea6\u6bd4\u8f83\u9ebb\u70e6|\n|\u501f\u6559\u5ba4|\u524d\u7f00\u548c \u4e8c\u5206|\u4e8c\u5206\u8ba2\u5355\u5373\u53ef|\n|\u5f00\u8f66\u65c5\u884c|\u500d\u589e|\u53ef\u4ee5\u53d1\u73b0\u5bf9\u4e8e\u6bcf\u4e2a$x$,\u8def\u5f84\u662f\u56fa\u5b9a\u7684. \u5148\u9884\u5904\u7406\u51fa\u79bb\u6bcf\u4e2a\u70b9\u6700\u8fd1\u70b9\u548c\u6b21\u8fd1\u70b9,\u7136\u540e\u500d\u589e\u5904\u7406\u51fa\u8d70$2^i$\u5929\u5230\u8fbe\u7684\u70b9,\u7136\u540e\u5c31\u53ef\u4ee5\u5bf9\u6bcf\u4e2a$x$\u6c42\u51fa\u8def\u5f84\u4e86|\n|\u75ab\u60c5\u63a7\u5236|\u500d\u589e \u4e8c\u5206 \u8d2a\u5fc3|\u53ef\u4ee5\u53d1\u73b0\u7b54\u6848\u5177\u6709\u5355\u8c03\u6027,\u6240\u4ee5\u53ef\u4ee5\u4e8c\u5206\u65f6\u95f4;\u5224\u65ad: \u8ba9\u6240\u6709\u519b\u961f\u5c3d\u53ef\u80fd\u5411\u4e0a\u8d70(\u53ef\u4ee5\u63a7\u5236\u66f4\u591a\u8def\u5f84),\u80fd\u5230\u9996\u90fd\u7684\u5148\u505c\u5728\u9996\u90fd,\u7136\u540e\u518d\u5224\u65ad\u9996\u90fd\u7684\u672a\u88ab\u8986\u76d6\u7684\u5b69\u5b50\u80fd\u5426\u88ab\u505c\u7559\u7684\u519b\u961f\u8986\u76d6|\n\n## 2013\n\n|\u9898\u76ee|\u7b97\u6cd5|\u9898\u89e3|\n|-|-|-|\n|\u79ef\u6728\u5927\u8d5b|\u6a21\u62df||\n|\u8f6c\u5708\u6e38\u620f|\u6a21\u62df \u5feb\u901f\u5e42||\n|\u82b1\u5320|\u8d2a\u5fc3/\u52a8\u6001\u89c4\u5212||\n|\u8d27\u8f66\u8fd0\u8f93|kruscal \u500d\u589e lca|\u6784\u9020\u751f\u6210\u6811\u540e\u5bf9$x,y$\u67e5\u8be2\u8def\u5f84\u4e0a\u6700\u5c0f\u7684\u8fb9\u5373\u53ef|\n|\u706b\u67f4\u6392\u961f|\u6392\u5e8f\u4e0d\u7b49\u5f0f \u9006\u5e8f\u5bf9|$\\sum (a_i-b_i)^2$\u4e2d\u53d8\u5316\u7684\u53ea\u6709$a_i\\times b_i$,\u6839\u636e\u6392\u5e8f\u4e0d\u7b49\u5f0f,$a$\u4e2d\u7b2c$i$\u5927\u7684\u4e0e$b$\u4e2d\u7b2c$i$\u5927\u7684\u76f8\u4e58$\\sum a_i\\times b_i$\u6700\u5927,\u4e8e\u662f\u53d8\u4e3a\u90bb\u4f4d\u4ea4\u6362\u95ee\u9898,\u6c42\u9006\u5e8f\u5bf9\u6570|\n|\u534e\u5bb9\u9053|\u641c\u7d22 \u56fe\u8bba \u6700\u77ed\u8def|\u8be2\u95ee\u6709\u4e94\u767e\u6b21\uff0c\u4e0d\u53ef\u80fd\u5bf9\u6bcf\u6b21\u8be2\u95ee\u90fd\u4f5c\u4e00\u6b21\u641c\u7d22\u3002\u6211\u4eec\u53ea\u9700\u8981\u4fdd\u7559\u6709\u7528\u7684\u72b6\u6001\u5e76\u5efa\u56fe\uff0c\u5bf9\u6bcf\u4e2a\u8be2\u95ee\u90fd\u8dd1\u4e00\u6b21\u6700\u77ed\u8def\u5373\u53ef|\n\n### 2014\n\n|\u9898\u76ee|\u7b97\u6cd5|\u9898\u89e3|\n|-|-|-|\n|\u751f\u6d3b\u5927\u7206\u70b8\u7248\u77f3\u5934\u526a\u5200\u5e03|\u6a21\u62df||\n|\u65e0\u7ebf\u7f51\u7edc\u53d1\u5c04\u5668\u9009\u5740|\u6a21\u62df||\n|\u8054\u5408\u6743\u503c|\u6811\u8bba|\u4e00\u4e2a\u70b9\u8fde\u63a5\u7684\u6240\u6709\u70b9\u4e24\u4e24\u4e4b\u95f4\u8ddd\u79bb\u4e3a2,\u5bf9\u6bcf\u4e2a\u70b9\u5206\u522b\u7edf\u8ba1\u5373\u53ef|\n|\u5bfb\u627e\u9053\u8def|\u56fe\u8bba \u6700\u77ed\u8def|\u5efa\u7acb\u53cd\u5411\u8fb9,\u904d\u5386\u5904\u7406\u51fa\u51fa\u8fb9\u90fd\u53ef\u5230\u8fbe\u7ec8\u70b9\u7684\u70b9,\u7136\u540e\u518d\u8dd1\u6700\u77ed\u8def|\n|\u98de\u626c\u7684\u5c0f\u9e1f|\u52a8\u6001\u89c4\u5212|$f(i,j)$\u8868\u793a\u5230\u8fbe\u5750\u6807$(i,j)$\u6700\u5c11\u9700\u8981\u70b9\u51fb\u51e0\u6b21\u5c4f\u5e55|\n|\u89e3\u65b9\u7a0b|\u6570\u8bba|\u679a\u4e3e$x$,\u5224\u65ad\u662f\u5426\u6210\u7acb\u5373\u53ef|\n\n### 2015\n\n|\u9898\u76ee|\u7b97\u6cd5|\u9898\u89e3|\n|-|-|-|\n|\u795e\u5947\u7684\u5e7b\u65b9|||\n|\u8df3\u77f3\u5934|||\n|\u4fe1\u606f\u4f20\u9012|||\n|\u6597\u5730\u4e3b|\u641c\u7d22 \u526a\u679d|\u5148\u987a\u5b50,\u7136\u540ex\u5e26x,\u6700\u540e\u51fa\u5b8c\u5269\u4e0b\u7684\u724c|\n|\u5b50\u4e32|\u52a8\u6001\u89c4\u5212 \u524d\u7f00\u548c\u4f18\u5316|$f(i,j,k)=\\begin{cases}f(i-1,j,k) &A_i\\neq B_j\\\\ f(i-1,j,k)+\\sum f(i-t,j-t,k-1) &A_i=B_j\\end{cases}$|\n|\u8fd0\u8f93\u8ba1\u5212|lca \u4e8c\u5206 \u6811\u4e0a\u5dee\u5206|\u4e8c\u5206\u6700\u5927\u503c,\u5c06\u5927\u4e8e\u6700\u5927\u503c\u7684\u8def\u5f84\u6807\u8bb0,\u4f7f\u7528\u6811\u4e0a\u5dee\u5206\u627e\u51fa\u80fd\u8986\u76d6\u6240\u6709\u6807\u8bb0\u8def\u5f84\u7684\u8fb9,\u5224\u65ad\u5220\u9664\u8be5\u8fb9\u662f\u5426\u53ef\u884c|\n\n### 2016\n\n|\u9898\u76ee|\u7b97\u6cd5|\u9898\u89e3|\n|-|-|-|\n||||\n||||\n||||\n||||\n||||\n||||\n\n### 2017\n\n|\u9898\u76ee|\u7b97\u6cd5|\u9898\u89e3|\n|-|-|-|\n||||\n||||\n||||\n||||\n||||\n||||\n\n### 2018\n\n|\u9898\u76ee|\u7b97\u6cd5|\u9898\u89e3|\n|-|-|-|\n||||\n||||\n||||\n||||\n||||\n||||", "link": "/posts/noip\u63d0\u9ad8\u5386\u5e74/", "tags": ["noip"], "categories": [["note"]]}, {"title": "\u6570\u4f4ddp", "content": "https://www.luogu.com.cn/blog/s-r-f/oi-bi-ji-shuo-wei-dp-ge-ji-dui-shuo-wei-dp-di-yi-dian-li-xie\n\n", "link": "/posts/\u6570\u4f4ddp/", "tags": ["\u6570\u4f4ddp", "\u52a8\u6001\u89c4\u5212", "\u6570\u8bba"], "categories": [["note"]]}, {"title": "\u5206\u5757", "content": "\u5206\u5757\u662f\u4e00\u79cd\u975e\u5e38\u597d\u7528\u7684\u6839\u53f7\u7b97\u6cd5,\u672c\u8d28\u4e0a\u662f\u66b4\u529b\u4f18\u5316\u6280\u5de7\n\n\u539f\u7406\u662f\u5c06\u5e8f\u5217\u5206\u6210$\\sqrt n$\u5757,\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u5757\u7684\u7ed3\u679c,\u5728\u67e5\u8be2\u65f6\u53ea\u9700\u8981\u5728\u5b8c\u6574\u5757\u7684\u57fa\u7840\u4e0a\u679a\u4e3e\u6563\u5757\u66f4\u65b0\u7b54\u6848\u5373\u53ef\n\n\u590d\u6742\u5ea6$\\mathcal O(n\\sqrt n)$", "link": "/posts/\u5206\u5757/", "tags": ["\u5206\u5757"], "categories": [["note"], ["\u7b97\u6cd5", "\u6280\u5de7"]]}, {"title": "2-SAT", "content": "`SAT`\u6307Satisfiability(\u53ef\u6ee1\u8db3\u6027\u95ee\u9898)\n\n`k-SAT`\u6307\u6bcf\u4e2a\u9650\u5236\u6709$k$\u4e2a\u6761\u4ef6,\u800c\u5f53$k>2$\u65f6\u8be5\u95ee\u9898\u4e3aNP\u5b8c\u5168\u7684,\u53ea\u80fd\u66b4\u529b\n\n> [LG 4782 \u3010\u6a21\u677f\u30112-SAT \u95ee\u9898](https://www.luogu.com.cn/problem/P4782)\n>\n> \u6709$n$\u4e2a\u5e03\u5c14\u53d8\u91cf$x_1,x_2,\\dots,x_n$,\u53e6\u6709$m$\u4e2a\u9700\u8981\u6ee1\u8db3\u7684\u6761\u4ef6,\u6bcf\u4e2a\u6761\u4ef6\u7684\u5f62\u5f0f\u90fd\u662f\u300c$x_i$ \u4e3a`true`/`false`\u6216`x_j`\u4e3a`true`/`false`\u300d.\n> \n> \u6bd4\u5982\u300c$x_1$\u4e3a`true`\u6216$x_3$\u4e3a`false`\u300d\u3001\u300c$x_7$\u4e3a`false`\u6216$x_2$\u4e3a`false`\u300d\u3002\n> \n> `2-SAT`\u95ee\u9898\u7684\u76ee\u6807\u662f\u7ed9\u6bcf\u4e2a\u53d8\u91cf\u8d4b\u503c\u4f7f\u5f97\u6240\u6709\u6761\u4ef6\u5f97\u5230\u6ee1\u8db3\u3002\n\n<!-- more -->\n\n\u4ee5\u4e0b\u628a`true`\u548c`false`\u7406\u89e3\u4e3a\u9009\u6216\u4e0d\u9009\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u53d8\u91cf$x$\u5efa\u7acb$x$,$\\neg x$,\u8868\u793a\u9009\u6216\u4e0d\u9009\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u9650\u5236,\u8fde\u8fb9\u65b9\u5f0f\u5982\u4e0b:\n\n|\u6761\u4ef6|\u8fde\u8fb9|\n|:-:|:-:|\n|$x$\u4e0e$y$\u5fc5\u987b\u540c\u65f6\u9009|$x\\to y,\\neg x\\to \\neg y$|\n|$x$\u4e0e$y$\u4e0d\u80fd\u540c\u65f6\u9009(\u672c\u9898\u6761\u4ef6)|$x\\to \\neg y$, $y\\to \\neg x$|\n|$x$\u4e0e$y$\u4efb\u9009\u4e00\u4e2a|$\\neg x\\to y,\\neg y \\to x$|\n\n\u8fb9$x\\to y$\u7684\u542b\u4e49\u53ef\u4ee5\u7406\u89e3\u4e3a\u9009$x$\u5219\u5fc5\u987b\u9009$y$,\n\n\u8fb9$x\\to \\neg y$\u7684\u542b\u4e49\u53ef\u4ee5\u7406\u89e3\u4e3a\u9009$x$\u5219\u4e0d\u80fd\u9009$y$,\n\n\u8fb9$\\neg x\\to y$\u7684\u542b\u4e49\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e0d\u9009$x$\u5219\u5fc5\u987b\u9009$y$,\n\n\u8fb9$\\neg x\\to \\neg y$\u7684\u542b\u4e49\u53ef\u4ee5\u7406\u89e3\u4e3a\u4e0d\u9009$x$\u5219\u4e0d\u9009$y$\n\n\n\n\u5efa\u56fe\u540e\u7528`tarjan`\u6c42\u51fa\u5f3a\u8fde\u901a\u5206\u91cf\n\n\u53ef\u4ee5\u53d1\u73b0\u5728\u540c\u4e00\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d\u7684\u70b9\u8981\u4e48\u90fd\u9009,\u8981\u4e48\u90fd\u4e0d\u9009\n\n\u5982\u679c\u5b58\u5728$x$\u4e0e$\\neg x$\u5728\u540c\u4e00\u5f3a\u8fde\u901a\u5206\u91cf\u4e2d,\u90a3\u4e48\u65e0\u89e3\n\n\u90a3\u4e48\u5982\u4f55\u6784\u9020\u51fa\u89e3\u5462?\n\n`tarjan`\u4e4b\u540e\u6211\u4eec\u5f97\u5230\u4e86\u4e00\u5f20\u62d3\u6251\u56fe,\u4e14\u56fe\u4e2d\u5982\u679c$x$\u53ef\u4ee5\u5230\u8fbe$y$,\u5219\u9009\u62e9$x$\u65f6\u5fc5\u987b\u9009\u62e9$y$\n\n\u6211\u4eec\u53ea\u8981\u5bf9\u6bcf\u4e2a\u53d8\u91cf$x$,\u9009\u62e9$x$\u4e0e$\\neg x$\u4e2d\u62d3\u6251\u5e8f\u8f83\u5c0f\u7684\u5373\u53ef(\u66f4\u5148\u51fa\u6808,\u5f71\u54cd\u5176\u4ed6\u70b9\u66f4\u5c11)\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=2000011;\nint n,m,cnt,head[N];\nstruct edge{int to,nxt;}e[N*2];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint dfn[N],low[N],sz,st[N],tp,bl[N],tt;\nbool v[N];\nvoid cmin(int&x,int y){if(y<x)x=y;}\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;st[++tp]=x;v[x]=1;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(!dfn[to])tarjan(to),cmin(low[x],low[to]);\n        else if(v[to])cmin(low[x],dfn[to]);\n    if(low[x]==dfn[x]){\n        ++tt;\n        while(int k=st[tp--]){\n            bl[k]=tt;v[k]=0;\n            if(k==x)break;\n        }\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    int x,y,vx,vy;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d%d%d\",&x,&vx,&y,&vy),\n        add(x+n*(vx^1),y+n*(vy&1)), // \u00acx -> y\n        add(y+n*(vy^1),x+n*(vx&1)); // \u00acy -> x\n    for(int i=1;i<=n*2;++i)if(!dfn[i])tarjan(i);\n    for(int i=1;i<=n;++i)\n        if(bl[i]==bl[i+n])return puts(\"IMPOSSIBLE\"),0;\n    puts(\"POSSIBLE\");\n    for(int i=1;i<=n;++i)\n        putchar(bl[i]>bl[i+n]?'1':'0'),putchar(' ');\n}\n```\n\n## \u7ec3\u4e60\n\n[LG 4171 \\[JSOI2010\\]\u6ee1\u6c49\u5168\u5e2d](https://www.luogu.com.cn/problem/P4171)\n\n[LG 5782 \\[POI2001\\]\u548c\u5e73\u59d4\u5458\u4f1a](https://www.luogu.com.cn/problem/P5782)\n\n[LG 6378 \\[PA2010\\]Riddle](/posts/LG%206378%20[PA2010]Riddle/)\n\n[LG 3825 \\[NOI2017\\]\u6e38\u620f](/posts/LG%203825%20[NOI2017]\u6e38\u620f/)", "link": "/posts/2-sat/", "tags": ["2-sat"], "categories": [["note"], ["\u7b97\u6cd5", "\u56fe\u8bba"]]}, {"title": "\u5361\u7279\u5170\u6570", "content": "## \u5b9a\u4e49\n\n$$\nH_n = \\begin{cases}\n    \\sum_{i=1}^n H_{i-1} H_{n-i} & n \\ge 2 \\\\\n    1 & n = 0, 1\n\\end{cases}\n$$\n\n<!-- more -->\n\n\u8be5\u9012\u63a8\u5173\u7cfb\u7684\u89e3\u4e3a\uff1a\n\n$$\nH_n = \\frac{{2n\\choose n}}{n+1}(n \\ge 2)\n$$\n\n\u5e38\u89c1\u516c\u5f0f\uff1a\n\n$$\nH_n = \\frac{H_{n-1} (4n-2)}{n+1}\n$$\n\n$$\nH_n = {2n\\choose n} - {2n\\choose n-1}\n$$\n\n\u5361\u7279\u5170\u6570\u5217(\u4e0b\u6807\u4ece$0$\u5f00\u59cb):\n\n$1,1,2,5,14,42,132,\\dots$\n\n## \u5361\u7279\u5170\u6570\u95ee\u9898\n\n1. \u6709$2n$\u4e2a\u4eba\u6392\u6210\u4e00\u884c\u8fdb\u5165\u5267\u573a\u3002\u5165\u573a\u8d39 5 \u5143\u3002\u5176\u4e2d\u53ea\u6709$n$\u4e2a\u4eba\u6709\u4e00\u5f20 5 \u5143\u949e\u7968\uff0c\u53e6\u5916$n$\u4eba\u53ea\u6709 10 \u5143\u949e\u7968\uff0c\u5267\u9662\u65e0\u5176\u5b83\u949e\u7968\uff0c\u95ee\u6709\u591a\u5c11\u4e2d\u65b9\u6cd5\u4f7f\u5f97\u53ea\u8981\u6709 10 \u5143\u7684\u4eba\u4e70\u7968\uff0c\u552e\u7968\u5904\u5c31\u6709 5 \u5143\u7684\u949e\u7968\u627e\u96f6\uff1f\n2. \u4e00\u4f4d\u5927\u57ce\u5e02\u7684\u5f8b\u5e08\u5728\u5979\u4f4f\u6240\u4ee5\u5317$n$\u4e2a\u8857\u533a\u548c\u4ee5\u4e1c$n$\u4e2a\u8857\u533a\u5904\u5de5\u4f5c\u3002\u6bcf\u5929\u5979\u8d70$2n$\u4e2a\u8857\u533a\u53bb\u4e0a\u73ed\u3002\u5982\u679c\u4ed6\u4ece\u4e0d\u7a7f\u8d8a\uff08\u4f46\u53ef\u4ee5\u78b0\u5230\uff09\u4ece\u5bb6\u5230\u529e\u516c\u5ba4\u7684\u5bf9\u89d2\u7ebf\uff0c\u90a3\u4e48\u6709\u591a\u5c11\u6761\u53ef\u80fd\u7684\u9053\u8def\uff1f\n3. \u5728\u5706\u4e0a\u9009\u62e9$2n$\u4e2a\u70b9\uff0c\u5c06\u8fd9\u4e9b\u70b9\u6210\u5bf9\u8fde\u63a5\u8d77\u6765\u4f7f\u5f97\u6240\u5f97\u5230\u7684$n$\u6761\u7ebf\u6bb5\u4e0d\u76f8\u4ea4\u7684\u65b9\u6cd5\u6570\uff1f\n4. \u5bf9\u89d2\u7ebf\u4e0d\u76f8\u4ea4\u7684\u60c5\u51b5\u4e0b\uff0c\u5c06\u4e00\u4e2a\u51f8\u591a\u8fb9\u5f62\u533a\u57df\u5206\u6210\u4e09\u89d2\u5f62\u533a\u57df\u7684\u65b9\u6cd5\u6570\uff1f\n5. \u4e00\u4e2a\u6808\uff08\u65e0\u7a77\u5927\uff09\u7684\u8fdb\u6808\u5e8f\u5217\u4e3a$1,2,3, \\cdots ,n$\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u51fa\u6808\u5e8f\u5217\uff1f\n6. $n$\u4e2a\u7ed3\u70b9\u53ef\u591f\u9020\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u4e8c\u53c9\u6811\uff1f\n7. $n$\u4e2a\u4e0d\u540c\u7684\u6570\u4f9d\u6b21\u8fdb\u6808\uff0c\u6c42\u4e0d\u540c\u7684\u51fa\u6808\u7ed3\u679c\u7684\u79cd\u6570\uff1f\n8. $n$\u4e2a$+1$\u548c$n$\u4e2a$-1$\u6784\u6210$2n$\u9879$a_1,a_2, \\cdots ,a_{2n}$\uff0c\u5176\u90e8\u5206\u548c\u6ee1\u8db3$a_1+a_2+ \\cdots +a_k \\geq 0(k=1,2,3, \\cdots ,2n)$\u5bf9\u4e0e$n$\u8be5\u6570\u5217\u4e3a\uff1f\n\n## \u8def\u5f84\u8ba1\u6570\u95ee\u9898\n\n\u975e\u964d\u8def\u5f84\u662f\u6307\u53ea\u80fd\u5411\u4e0a\u6216\u5411\u53f3\u8d70\u7684\u8def\u5f84\u3002\n\n1. \u4ece$(0,0)$\u5230$(m,n)$\u7684\u975e\u964d\u8def\u5f84\u6570\u7b49\u4e8e$m$\u4e2a$x$\u548c$n$\u4e2a$y$\u7684\u6392\u5217\u6570\uff0c\u5373${n + m\\choose m}$\u3002\n\n2.  \u4ece$(0,0)$\u5230$(n,n)$\u7684\u9664\u7aef\u70b9\u5916\u4e0d\u63a5\u89e6\u76f4\u7ebf$y=x$\u7684\u975e\u964d\u8def\u5f84\u6570\uff1a\n\n    \u5148\u8003\u8651$y=x$\u4e0b\u65b9\u7684\u8def\u5f84\uff0c\u90fd\u662f\u4ece$(0, 0)$\u51fa\u53d1\uff0c\u7ecf\u8fc7$(1, 0)$\u53ca$(n, n-1)$\u5230$(n,n)$\uff0c\u53ef\u4ee5\u770b\u505a\u662f$(1,0)$\u5230$(n,n-1)$\u4e0d\u63a5\u89e6$y=x$\u7684\u975e\u964d\u8def\u5f84\u6570\u3002\n\n    \u6240\u6709\u7684\u7684\u975e\u964d\u8def\u5f84\u6709${2n-2\\choose n-1}$\u6761\u3002\u5bf9\u4e8e\u8fd9\u91cc\u9762\u4efb\u610f\u4e00\u6761\u63a5\u89e6\u4e86$y=x$\u7684\u8def\u5f84\uff0c\u53ef\u4ee5\u628a\u5b83\u6700\u540e\u79bb\u5f00\u8fd9\u6761\u7ebf\u7684\u70b9\u5230$(1,0)$\u4e4b\u95f4\u7684\u90e8\u5206\u5173\u4e8e$y=x$\u5bf9\u79f0\u53d8\u6362\uff0c\u5c31\u5f97\u5230\u4ece$(0,1)$\u5230$(n,n-1)$\u7684\u4e00\u6761\u975e\u964d\u8def\u5f84\u3002\u53cd\u4e4b\u4e5f\u6210\u7acb\u3002\u4ece\u800c$y=x$\u4e0b\u65b9\u7684\u975e\u964d\u8def\u5f84\u6570\u662f${2n-2\\choose n-1}-{2n-2\\choose n}$\u3002\u6839\u636e\u5bf9\u79f0\u6027\u53ef\u77e5\u6240\u6c42\u7b54\u6848\u4e3a$2\\left[{2n-2\\choose n-1} - {2n-2\\choose n}\\right]$\u3002\n\n3.  \u4ece$(0,0)$\u5230$(n,n)$\u7684\u9664\u7aef\u70b9\u5916\u4e0d\u7a7f\u8fc7\u76f4\u7ebf$y=x$\u7684\u975e\u964d\u8def\u5f84\u6570\uff1a\n\n    \u7528\u7c7b\u4f3c\u7684\u65b9\u6cd5\u53ef\u4ee5\u5f97\u5230\uff1a$\\frac{2}{n+1}{2n\\choose n}$", "link": "/posts/\u5361\u7279\u5170\u6570/", "tags": ["\u5361\u7279\u5170\u6570", "\u6570\u8bba"], "categories": [["note"]]}, {"title": "Prufer \u5e8f\u5217", "content": "## prufer\u5e8f\u5217\n\n\u8fd9\u662f\u4e00\u79cd\u5c06\u5e26\u6807\u53f7\u7684\u6811\u7528\u4e00\u4e2a\u552f\u4e00\u7684\u6574\u6570\u5e8f\u5217\u8868\u793a\u7684\u65b9\u6cd5.\n\n\u5f88\u591a\u4e0e\u5ea6\u6570\u6709\u5173\u7684\u6811\u4e0a\u8ba1\u6570\u95ee\u9898,\u90fd\u53ef\u4ee5\u7528\u5b83\u4ee5\u53ca\u5b83\u7684\u6027\u8d28\u6765\u89e3\u51b3\n\n<!-- more -->\n\n## \u4ece\u6811\u5230prufer\u5e8f\u5217\n\n\u5047\u8bbe\u6709\u4e00\u68f5$n$\u4e2a\u8282\u70b9\u7684\u6811\n\n\u6bcf\u6b21\u9009\u62e9\u4e00\u4e2a\u7f16\u53f7\u6700\u5c0f\u7684\u53f6\u7ed3\u70b9\u5e76\u5220\u6389\u5b83,\n\n\u7136\u540e\u5728\u5e8f\u5217\u4e2d\u8bb0\u5f55\u4e0b\u5b83\u8fde\u63a5\u5230\u7684\u90a3\u4e2a\u7ed3\u70b9.\n\n\u91cd\u590d$n-2$\u6b21\u540e\u5c31\u53ea\u5269\u4e0b\u4e24\u4e2a\u7ed3\u70b9\n\n\u4f7f\u7528\u5806\u6784\u9020\u663e\u7136\u53ef\u4ee5,\u590d\u6742\u5ea6$\\mathcal O(n \\log n)$\n\n### \u7ebf\u6027\u6784\u9020\n\n### \u6027\u8d28\n\n1. `prufer`\u5e8f\u5217\u4e0e\u65e0\u6839\u6811\u4e00\u4e00\u5bf9\u5e94\n2. \u5728\u6784\u9020\u5b8c`prufer`\u5e8f\u5217\u540e\u539f\u6811\u4e2d\u4f1a\u5269\u4e0b\u4e24\u4e2a\u7ed3\u70b9,\u5176\u4e2d\u4e00\u4e2a\u4e00\u5b9a\u662f\u7f16\u53f7\u6700\u5927\u7684\u70b9$n$.\n3. \u6bcf\u4e2a\u7ed3\u70b9\u5728\u5e8f\u5217\u4e2d\u51fa\u73b0\u7684\u6b21\u6570\u662f\u5176\u5ea6\u6570\u51cf$1$(\u6ca1\u6709\u51fa\u73b0\u7684\u5c31\u662f\u53f6\u7ed3\u70b9)\n4. Cayley\u516c\u5f0f(\u51ef\u83b1\u516c\u5f0f)\n\n   $n$\u4e2a\u70b9\u7684\u5b8c\u5168\u56fe\u6709$2^{n-2}$\u68f5\u751f\u6210\u6811\u3002\n\n   \u4e00\u68f5$n$\u4e2a\u70b9\u7684\u6811\u7684`prufer`\u5e8f\u5217\u957f\u5ea6\u4e3a$n-2$,\n\n   \u5373\u603b\u5171\u6709$n^{n-2}$\u79cd`prufer`\u5e8f\u5217\n\n   \u7531\u4e8e`prufer`\u5e8f\u5217\u4e0e\u65e0\u6839\u6811\u4e00\u4e00\u5bf9\u5e94,\u6240\u4ee5\u5171\u6709$2^{n-2}$\u79cd\u751f\u6210\u6811\n\t\n5. \u5bf9\u4e8e\u7ed9\u5b9a\u5ea6\u6570\u4e3a$d_{1\\sim n}$\u200b\u7684\u4e00\u68f5\u65e0\u6839\u6811\u5171\u6709$\\dfrac{(n-2)!}{\\prod_{i=1}^n(d_i-1)!}$\u200b\u79cd\u60c5\u51b5\n\n   \u5168\u90e8\u5168\u6392\u5217\u65b9\u6848\u6570\u9664\u4ee5\u6bcf\u4e2a\u70b9$i$\u7684\u6392\u5217\u65b9\u6848\u6570(\u9664\u53bb\u91cd\u590d\u7684)\n\n   \u7b2c$i$\u4e2a\u70b9\u5ea6\u6570\u4e3a$d_i$\u200b,\u4f1a\u5728`prufer`\u5e8f\u5217\u4e2d\u51fa\u73b0$d_i-1$\u6b21,\u5168\u6392\u5217\u65b9\u6848\u6570\u4e3a$(d_i-1)!$\n\n## \u56fe\u8fde\u901a\u65b9\u6848\u6570\n\n> \u4e00\u4e2a$n$\u4e2a\u70b9$m$\u6761\u8fb9\u7684\u5e26\u6807\u53f7\u65e0\u5411\u56fe\u6709$k$\u4e2a\u8fde\u901a\u5757\u3002\n>\n> \u6c42\u6dfb\u52a0$k$\u6761\u8fb9\u4f7f\u5f97\u6574\u4e2a\u56fe\u8fde\u901a\u7684\u65b9\u6848\u6570\u3002\n\n\n\n\u8bbe$s_i$\u4e3a\u6bcf\u4e2a\u8fde\u901a\u5757\u70b9\u6570\n\n\u5bf9\u6bcf\u4e2a\u8fde\u901a\u5757\u6784\u5efa`prufer`\u5e8f\u5217\n\n\u7531\u4e8e\u5ea6\u6570\u4e3a\u8fb9\u6570\u4e24\u500d,$\\displaystyle \\sum_{i=1}^k d_i=2k-2$\n\n\u5bf9\u4e8e\u7ed9\u5b9a$d$\u5e8f\u5217\u6784\u9020`prufer`\u5e8f\u5217\u7684\u65b9\u6848\u6570\u4e3a:\n\n$\\displaystyle {k-2\\choose d_1-1,d_2-1,\\dots,d_k-1} = \\frac{(k-2)!}{(d_1-1)!(d_2-1)!\\cdot(d_k-1)!}$\n\n\u5bf9\u4e8e\u7b2c$i$\u4e2a\u8fde\u901a\u5757,\u5b83\u7684\u8fde\u63a5\u65b9\u5f0f\u6709$s_i^{d_i}$\u79cd,\u5bf9\u4e8e\u7ed9\u5b9a$d$\u5e8f\u5217\u4f7f\u56fe\u8fde\u901a\u7684\u65b9\u6848\u6570\u4e3a:\n\n$\\displaystyle {k-2\\choose d_1-1,d_2-1,\\dots,d_k-1}\\cdot \\prod_{i=1}^k s_i^{d_i}$\n\n\u679a\u4e3e$d$\u5e8f\u5217:\n\n$\\displaystyle \\sum_{d_i\\ge 1,\\sum d_i=2k-2} {k-2\\choose d_1-1,d_2-1,\\dots,d_k-1}\\cdot \\prod_{i=1}^k s_i^{d_i}$\n\n\u6362\u5143,\u8bbe$e_i=d_i-1$:\n\n$\\displaystyle \\sum_{e_i\\ge 0,\\sum e_i=k-2} {k-2\\choose e_1,e_2,\\dots,e_k}\\cdot \\prod_{i=1}^k s_i^{e_i+1}$\n\n\u6839\u636e\u591a\u5143\u4e8c\u9879\u5f0f\u5b9a\u7406:\n\n$\\displaystyle (x_1+x_2+\\dots+x_m)^p=\\sum_{c_i\\ge 0,\\sum c_i=p} {p\\choose c_1,c_2,\\dots,c_m}\\cdot \\prod_{i=1}^m x_i^{c_i}$\n\n\u539f\u5f0f\u5316\u7b80\u5f97:\n\n$\\displaystyle (s_1+s_2+\\dots+s_k)^{k-2}\\cdot \\prod_{i=1}^k s_i$\n\n\u5373\n$\\displaystyle n^{k-2} \\cdot \\prod_{i=1}^k s_i$\n\n## \u4eceprufer\u5e8f\u5217\u5230\u6811\n\n## \u4f8b\u9898\n\n[\\[HNOI2004\\]\u6811\u7684\u8ba1\u6570](/posts/LG 2290 [HNOI2004]\u6811\u7684\u8ba1\u6570/)\n\n[CF156D Clues](/posts/LG CF156D Clues/)", "link": "/posts/prufer\u5e8f\u5217/", "tags": ["prufer\u5e8f\u5217", "\u56fe\u8bba", "\u6811"], "categories": [["note"], ["\u7b97\u6cd5", "\u56fe\u8bba"]]}, {"title": "\u6839\u53f7\u5206\u6cbb", "content": "\n\u6839\u53f7\u5206\u6cbb\u662f\u4e00\u79cd\n\n## \u7ec3\u4e60\n\n[LG 5901 \\[IOI2009\\]regions](/posts/LG%205901%20[IOI2009]regions/)", "link": "/posts/\u6839\u53f7\u5206\u6cbb/", "tags": ["\u6839\u53f7\u5206\u6cbb"], "categories": [["note"], ["\u7b97\u6cd5", "\u6280\u5de7"]]}, {"title": "\u865a\u6811", "content": "\u865a\u6811\u662f\u4e00\u79cd\u7edf\u8ba1\u6811\u4e0a\u4fe1\u606f\u7684\u6280\u672f\n\n\u4f8b\u9898: [LG 2495 \\[SDOI2011\\]\u6d88\u8017\u6218](https://www.luogu.com.cn/problem/P2495)\n\n\u5982\u679c\u6811\u7684\u70b9\u6570\u5f88\u5c11,\u53ef\u4ee5\u76f4\u63a5\u6811\u4e0adp\n\n\u53ef\u4ee5\u53d1\u73b0$\\sum k_i \\le 5 \\times 10^5$\n\n\u6211\u4eec\u53ef\u4ee5\u6bcf\u6b21\u90fd\u628a\u63d0\u4f9b\u7684$k_i$\u4e2a\u70b9\u6784\u9020\u6210\u4e00\u68f5\u65b0\u6811\u6765\u8dd1\u6811\u5f62dp\n\n\u8fd9\u6837\u65f6\u95f4\u590d\u6742\u5ea6\u5c31\u521a\u521a\u597d\n\n\u865a\u6811\u53ef\u4ee5\u5e2e\u52a9\u6211\u4eec\u6784\u9020\u51fa\u4e00\u68f5\u5305\u542b\u8fd9$k_i$\u4e2a\u70b9\u7684\u65b0\u6811\n\n\u865a\u6811\u4e2d\u5305\u542b\u4e86\u6240\u6709\u7684\u5173\u952e\u70b9\uff0c\u4e5f\u5305\u542b\u4e86\u6240\u6709\u5173\u952e\u70b9\u4e24\u4e24\u4e4b\u95f4\u7684`LCA`\n\n", "link": "/posts/\u865a\u6811/", "tags": ["\u865a\u6811", "\u6811", "lca"], "categories": [["note"], ["\u7b97\u6cd5", "\u6280\u5de7"]]}, {"title": "IDA*", "content": "\n\u524d\u7f6e\u77e5\u8bc6:\n\n- \u8fed\u4ee3\u52a0\u6df1\u641c\u7d22\n- A*\n\n## \u8fed\u4ee3\u52a0\u6df1\u641c\u7d22\n\n\u8fed\u4ee3\u52a0\u6df1\u641c\u7d22\u662f\u4e00\u79cd**\u6bcf\u6b21\u9650\u5236\u641c\u7d22\u6df1\u5ea6**\u7684\u6df1\u5ea6\u4f18\u5148\u641c\u7d22\u3002\n\n\u9996\u5148\u8bbe\u5b9a\u4e00\u4e2a\u8f83\u5c0f\u7684\u6df1\u5ea6\u4f5c\u4e3a\u5168\u5c40\u53d8\u91cf,\u8fdb\u884c`DFS`\u3002\n\n\u6bcf\u8fdb\u5165\u4e00\u6b21`DFS`,\u5c06\u5f53\u524d\u6df1\u5ea6\u52a0\u4e00,\u5f53\u53d1\u73b0**\u5927\u4e8e\u8bbe\u5b9a\u7684\u6df1\u5ea6**\u5c31\u8fd4\u56de\u3002\n\n\u5982\u679c\u5728\u641c\u7d22\u7684\u9014\u4e2d\u53d1\u73b0\u4e86\u7b54\u6848\u5c31\u53ef\u4ee5\u56de\u6eaf,\u540c\u65f6\u5728\u56de\u6eaf\u7684\u8fc7\u7a0b\u4e2d\u53ef\u4ee5\u8bb0\u5f55\u8def\u5f84\u3002\n\n\u5982\u679c\u6ca1\u6709\u53d1\u73b0\u7b54\u6848,\u5c31\u8fd4\u56de\u5230\u51fd\u6570\u5165\u53e3,\u589e\u52a0\u8bbe\u5b9a\u6df1\u5ea6,\u7ee7\u7eed\u641c\u7d22\u3002\n\n> \u5728\u5927\u591a\u6570\u7684\u9898\u76ee\u4e2d,\u5e7f\u5ea6\u4f18\u5148\u641c\u7d22\u8fd8\u662f\u6bd4\u8f83\u65b9\u4fbf\u7684,\u800c\u4e14\u5bb9\u6613\u5224\u91cd\u3002\n> \n> \u5f53\u53d1\u73b0\u5e7f\u5ea6\u4f18\u5148\u641c\u7d22\u5728\u7a7a\u95f4\u4e0a\u4e0d\u591f\u4f18\u79c0,\u800c\u4e14\u8981\u627e\u6700\u4f18\u89e3\u7684\u95ee\u9898\u65f6,\u5c31\u5e94\u8be5\u8003\u8651\u8fed\u4ee3\u52a0\u6df1\u3002\n\n## A*\n\n`A*`\u7b97\u6cd5\u662f`BFS`\u7684\u4e00\u79cd\u6539\u8fdb\n\n\u5b9a\u4e49\u8d77\u70b9$s$,\u7ec8\u70b9$t$,\n\n\u4ece$s$\u5230$x$\u7684\u4f30\u4ef7\u51fd\u6570$g(x)$,\n\n\u4ece$x$\u5230$t$\u7684\u4f30\u4ef7\u51fd\u6570$h(x)$,\n\n\u5b9a\u4e49$x$\u7684\u4f30\u4ef7\u51fd\u6570$f(x)$\n\n`A*`\u7b97\u6cd5\u6bcf\u6b21\u4ece\u4f18\u5148\u961f\u5217\u4e2d\u53d6\u51fa\u4e00\u4e2a$f(x)$\u6700\u5c0f\u7684$x$,\u7136\u540e\u66f4\u65b0\u76f8\u90bb\u7684\u72b6\u6001\n\n\u5982\u679c$h(x)$\u4e0d\u8d85\u8fc7$x$\u7684\u5b9e\u9645\u7b54\u6848,\u5219`A*`\u7b97\u6cd5\u80fd\u627e\u5230\u6700\u4f18\u89e3\n\n\u4e0a\u8ff0\u6761\u4ef6\u4e0b,\u5982\u679c$h$\u6ee1\u8db3\u4e09\u89d2\u5f62\u4e0d\u7b49\u5f0f,\u5219`A*`\u7b97\u6cd5\u4e0d\u4f1a\u5c06\u91cd\u590d\u7ed3\u70b9\u52a0\u5165\u961f\u5217\n\n## IDA*\n\n`IDA*`,\u5373\u91c7\u7528\u8fed\u4ee3\u52a0\u6df1\u7684`A*`\u7b97\u6cd5\u3002\u76f8\u5bf9\u4e8e`A*`\u7b97\u6cd5,`IDA*`\u6539\u6210\u4e86\u6df1\u5ea6\u4f18\u5148\u7684\u65b9\u5f0f\n\n- \u4e0d\u9700\u8981\u5224\u91cd,\u4e0d\u9700\u8981\u6392\u5e8f\n- \u7a7a\u95f4\u9700\u6c42\u51cf\u5c11\n\n\u4f18\u70b9:\n\n- \u7a7a\u95f4\u5f00\u9500\u5c0f,\u6bcf\u4e2a\u6df1\u5ea6\u4e0b\u5b9e\u9645\u4e0a\u662f\u4e00\u4e2a\u6df1\u5ea6\u4f18\u5148\u641c\u7d22,\u4e0d\u8fc7\u6df1\u5ea6\u6709\u9650\u5236,\u800c`DFS`\u7684\u7a7a\u95f4\u6d88\u8017\u5c0f\u662f\u4f17\u6240\u5468\u77e5\u7684\uff1b\n- \u5229\u4e8e\u6df1\u5ea6\u526a\u679d\u3002\n\n\u7f3a\u70b9:\n\n\u91cd\u590d\u641c\u7d22\uff1a\u56de\u6eaf\u8fc7\u7a0b\u4e2d\u6bcf\u6b21\u8bbe\u5b9a\u7684\u6df1\u5ea6\u53d8\u5927\u90fd\u8981\u518d\u6b21\u4ece\u5934\u641c\u7d22\n\n> \u5f71\u54cd\u4e0d\u5927\n\n## \u4f8b\u9898\n\n[\\[AHOI2012\\]\u94c1\u76d8\u6574\u7406](https://www.luogu.com.cn/problem/P2534)\n \n> \u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a$n$\u4e92\u4e0d\u76f8\u540c\u7684\u5e8f\u5217$a_i$,\u6bcf\u6b21\u64cd\u4f5c\u53ef\u4ee5\u5c06$[1,i],i\\in[1,n]$\u7ffb\u8f6c,\u6c42\u6700\u5c11\u51e0\u6b21\u64cd\u4f5c\u53ef\u4ee5\u4f7f\u5b83\u53d8\u6210\u5347\u5e8f\u6570\u5217\u3002($1 \\le n \\le 50, 1 \\le a_i \\le 100$)\n\n\u9996\u5148\u5c06\u6570\u7ec4\u79bb\u6563\u5316\u4e3a$1,2,\\dots,n$\n\n\u4e00\u6b21\u7ffb\u8f6c\u6700\u591a\u53ea\u80fd\u6539\u53d8\u4e00\u5bf9\u76f8\u90bb\u6570\u7684\u5dee,\n\n\u56e0\u6b64\u5bf9\u4e8e\u4e00\u4e2a\u5e8f\u5217,\u6709\u591a\u5c11\u5bf9\u76f8\u90bb\u7684\u6570\u5dee\u4e0d\u4e3a$1$,\u5c31\u81f3\u5c11\u8981\u7ffb\u8f6c\u591a\u5c11\u6b21\u3002\n\n\u4f30\u4ef7\u51fd\u6570:\n\n```cpp\na[n+1]=n+1;\nint h(){\n    int cnt=0;\n    for(int i=1;i<=n;++i)cnt+=(a[i]!=a[i+1]+1&&a[i]!=a[i+1]-1);\n    return cnt;\n}\n```\n\n\u5b8c\u6574\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,mxd,a[N],b[N];\nbool sol;\nint h(){ // \u4f30\u4ef7\u51fd\u6570\n    int cnt=0;\n    for(int i=1;i<=n;++i)cnt+=(a[i]!=a[i+1]+1&&a[i]!=a[i+1]-1);\n    return cnt;\n}\nvoid dfs(int g,int pre){\n    if(sol||g+h()>mxd)return;\n    if(!h())return sol=1,void();\n    for(int i=1;i<=n;++i)if(i!=pre){\n        std::reverse(a+1,a+i+1);\n        dfs(g+1,i);\n        std::reverse(a+1,a+i+1);\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i),b[i]=a[i];\n    std::sort(b+1,b+n+1);\n    for(int i=1;i<=n;++i)a[i]=std::lower_bound(b+1,b+n+1,a[i])-b;\n    a[n+1]=n+1;\n    for(int i=0;!sol;++i){\n        mxd=i,dfs(0,0);\n        if(sol)printf(\"%d\\n\",i);\n    }\n}\n```", "link": "/posts/IDA*/", "tags": ["\u641c\u7d22", "\u526a\u679d"], "categories": [["note"], ["\u7b97\u6cd5", "\u641c\u7d22"]]}, {"title": "\u6982\u7387\u4e0e\u671f\u671b", "content": "## \u6982\u7387\n\n\u5b9a\u4e49\u8be6\u89c1\u6570\u5b66\u8bfe\u672c\n\n### \u6761\u4ef6\u6982\u7387\n\n$P(B|A)$\u6307$A$\u53d1\u751f\u7684\u524d\u63d0\u4e0b,$B$\u53d1\u751f\u7684\u53ef\u80fd\u6027\n\n$P(B|A)=\\dfrac{P(AB)}{P(A)}$\n\n### \u4e58\u6cd5\u516c\u5f0f\n\n$P(B|A)P(A)=P(AB)=P(A|B)P(B)$\n\n### \u5168\u6982\u7387\u516c\u5f0f\n\n\u8bbe$\\forall i,j, A_i \\cap A_j = \\varnothing$\u4e14$\\displaystyle \\sum_{i=1}^n P(A_i)=1$,\u5219\u6709\n\n$\\displaystyle P(B)=\\sum_{i=1}^n P(B|A_i)P(A_i)$\n\n### \u8d1d\u53f6\u65af\u5b9a\u7406\n\n$P(B_i|A)=\\dfrac{P(A|B_i)P(B_i)}{\\sum\\limits_{j=1}^nP(A|B_j)P(B_j)}$\n\n## \u671f\u671b\n\n### \u5b9a\u4e49:\n\n\u5bf9\u4e8e\u4e00\u4e2a\u968f\u673a\u53d8\u91cf\u7684\u5206\u5e03\u5217$X$\uff0c$X$\u7684\u6bcf\u4e2a\u53d6\u503c\u4e0e\u5bf9\u5e94\u6982\u7387\u7684\u4e58\u79ef\u4e4b\u548c\u5373\u4e3a\u671f\u671b\n\n$\\displaystyle E(x)=\\sum_{i=1}^nP(i)X_i$\n\n### \u6027\u8d28\n\n$\nE(X)=X\\\\\nE(aX)=aE(X)\\\\\nE(X+Y)=E(X)+E(Y)\\\\\nE(aX+bY)=aE(X)+bE(y)\\\\\nE(XY)=E(X)E(Y)\n$\n\n\u5176\u4e2d\u52a0\u6cd5\u65f6$X,Y$\u4e0d\u9700\u8981\u76f8\u4e92\u72ec\u7acb\n\n\u4e58\u6cd5\u65f6$X,Y$\u9700\u8981\u76f8\u4e92\u72ec\u7acb\n\n### \u5168\u671f\u671b\u516c\u5f0f\n\n\u8bbe$X,Y,Z$\u4e3a\u968f\u673a\u53d8\u91cf\uff0c$g(\u00b7)$\u548c$h(\u00b7)$\u4e3a\u8fde\u7eed\u51fd\u6570\uff0c\u4e0b\u5217\u671f\u671b\u548c\u6761\u4ef6\u671f\u671b\u5747\u5b58\u5728\uff0c\u5219\n\n$E(X)=E[E(X|Y)]$,$X,Y$\u4e0d\u9700\u8981\u76f8\u4e92\u72ec\u7acb\n\n$\\displaystyle\n\\begin{aligned}\nE[E(X|Y)]\n&=\\sum_yE(X|Y=y)P(Y=y)\\\\\n&=\\sum_y\\left(\\sum_x xP(X=x|Y=y)\\right)P(Y=y)\\\\\n&=\\sum_y\\sum_x x P(X=x|Y=y)P(Y=y)\\\\\n&=\\sum_y\\sum_x x P(Y=y|X=x)P(X=x)\\\\\n&=\\sum_x xP(X=x) \\sum_y P(Y=y|X=x)\\\\\n&=\\sum_x xP(X=x)\\\\\n&=E(x)\n\\end{aligned}\n$\n\n", "link": "/posts/\u6982\u7387\u4e0e\u671f\u671b/", "tags": ["\u671f\u671b", "\u6982\u7387"], "categories": [["note"]]}, {"title": "\u52a8\u6001dp", "content": "> [LG 4719 \u3010\u6a21\u677f\u3011\"\u52a8\u6001 DP\"&\u52a8\u6001\u6811\u5206\u6cbb](https://www.luogu.com.cn/problem/P4719)\n> \n> \u7ed9\u5b9a\u4e00\u68f5$n$\u4e2a\u70b9\u7684\u6811\uff0c\u70b9\u5e26\u70b9\u6743\u3002\n> \n> \u6709$m$\u6b21\u64cd\u4f5c\uff0c\u6bcf\u6b21\u64cd\u4f5c\u7ed9\u5b9a$x,y$\uff0c\u8868\u793a\u4fee\u6539\u70b9$x$\u7684\u6743\u503c\u4e3a$y$\u3002\n> \n> \u4f60\u9700\u8981\u5728\u6bcf\u6b21\u64cd\u4f5c\u4e4b\u540e\u6c42\u51fa\u8fd9\u68f5\u6811\u7684\u6700\u5927\u6743\u72ec\u7acb\u96c6\u7684\u6743\u503c\u5927\u5c0f\u3002\n\n\u8bbe$f_{i,0}$\u8868\u793a\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811,\u4e0d\u9009$i$\u7684\u7b54\u6848,$f_{i,1}$\u8868\u793a\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811,\u9009$i$\u7684\u7b54\u6848\n\n\u5f88\u5bb9\u6613\u5217\u51fadp\u65b9\u7a0b:\n\n$$\nf_{i,0}=\\sum_{j} \\max(f_{j,0},f_{j,1})\\\\\nf_{i,1}=a_i + \\sum_{j} f_{j,0}\n$$\n\n\u8fd9\u91cc$j$\u4e3a$i$\u7684\u6240\u6709\u513f\u5b50\n\n\u6700\u540e\u7b54\u6848\u4e3a$\\max(f_{1,0},f_{1,1})$\n\n\n\u8003\u8651\u5e26\u4fee\u6539:\n\n\u4fee\u6539\u4e86\u4e00\u4e2a\u70b9\u7684\u70b9\u6743\uff0c\u53ea\u4f1a\u66f4\u6539\u4ece\u8fd9\u4e2a\u70b9\u5230\u6839\u8fd9\u6761\u8def\u5f84\u4e0a\u8282\u70b9\u7684\u7b54\u6848\n\n\u6211\u4eec\u5e0c\u671b\u80fd\u591f\u53ea\u66f4\u6539\u8fd9\u6761\u94fe\u4e0a\u7684\u7b54\u6848\n\n\u7531\u4e8e\u6811\u53ef\u80fd\u4f1a\u9000\u5316\u6210\u4e00\u6761\u94fe\uff0c\u8fd9\u6837\u6bcf\u6b21\u66f4\u65b0\u5c31\u662f$\\mathcal{O(n)}$\u7684\uff0c\u4e0d\u53ef\u63a5\u53d7\u3002\n\n\u6211\u4eec\u5e0c\u671b\u8fd9\u6761\u94fe\u53ea\u66f4\u65b0$\\log n$\u6b21\n\n\u4f7f\u7528\u91cd\u94fe\u5256\u5206(\u6811\u94fe\u5256\u5206),\u539f\u56e0:\n\n- \u6bcf\u4e2a\u70b9\u5230\u6839\u7684\u8def\u5f84\u4e0a\uff0c\u6700\u591a\u7ecf\u8fc7$\\log n$\u6761\u8f7b\u8fb9\n- \u6bcf\u6761\u91cd\u94fe\u7684\u94fe\u5c3e\u90fd\u662f\u53f6\u5b50\u8282\u70b9\uff0c\u4e14\u53ea\u6709\u53f6\u5b50\u8282\u70b9\u6ca1\u6709\u91cd\u513f\u5b50\n  \n  (\u8fd9\u4e3a\u52a8\u6001\u89c4\u5212\u7684\u521d\u59cb\u72b6\u6001\u548c\u8f6c\u79fb\u65b9\u5f0f\u505a\u4e86\u4fdd\u969c\u3002)\n- \u4e00\u6761\u91cd\u94fe\u6240\u5728\u7684\u533a\u95f4\u5728\u5256\u51fa\u7684`DFS`\u5e8f\u4e0a\uff0c\u662f\u8fde\u7eed\u7684\u4e00\u6bb5\u533a\u95f4\n  \n  (\u8fd9\u4e3a\u53ef\u4ee5\u4f7f\u7528\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\u533a\u95f4\u4fe1\u606f)\n\n\u8003\u8651\u7b80\u5316dp\u65b9\u7a0b\u4ee5\u8fce\u5408\u91cd\u8fde\u5256\u5206:\n\n\u8bbe$g_{i,0}$\u8868\u793a$i$\u70b9\u6240\u6709\u8f7b\u513f\u5b50\uff0c\u53ef\u53d6\u53ef\u4e0d\u53d6\u5f62\u6210\u7684\u6700\u5927\u6743\u72ec\u7acb\u96c6,$g_{i,1}$\u8868\u793a $i$\u70b9\u53ea\u8003\u8651\u8f7b\u513f\u5b50\u7684\u3001\u53d6\u81ea\u5df1\u7684\u6700\u5927\u6743\u72ec\u7acb\u96c6\n\n\u90a3\u4e48\n\n$$\nf_{i,0}=g_{i,0}+\\max(f_{j,0},f_{j,1})\\\\\nf_{i,1}=g_{i,1}+f_{j,0}\n$$\n\n\u8fd9\u91cc\u7684$j$\u8868\u793a$i$\u70b9\u7684\u91cd\u513f\u5b50\u3002\u7279\u6b8a\u5730\uff0c\u5bf9\u4e8e\u53f6\u5b50\u8282\u70b9\uff0c$g_{i, 0} = g_{i, 1} = 0$\n\n\u533a\u95f4\u7ef4\u62a4: \u4f7f\u7528\u77e9\u9635\n\n\u5b9a\u4e49\u77e9\u9635\n\n$$\n\\begin{vmatrix}\nf_{i,0} & f_{i,1}\n\\end{vmatrix}\n$$\n\n\u6784\u9020\u8f6c\u79fb\u77e9\u9635\u4f7f$\\begin{vmatrix}f_{j,0} & f_{j,1}\\end{vmatrix} \\to \\begin{vmatrix}f_{i,0} & f_{i,1}\\end{vmatrix}$\n\n\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u7684dp\u65b9\u7a0b\u4e0d\u6ee1\u8db3\u77e9\u9635\u4e58\u6cd5\u7684\u5f62\u5f0f\uff0c\n\n\u90a3\u4e48\u6211\u4eec\u91cd\u65b0\u5b9a\u4e49\u77e9\u9635\u4e58\u6cd5$C=A*B$\u4e3a:\n\n$$C_{i,j}=\\max_{k} \\{A_{i,k}+B_{k,j}\\}$$\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u65b0\u5b9a\u4e49\u7684\u77e9\u9635\u4e58\u6cd5\u4ecd\u5177\u6709\u7ed3\u5408\u5f8b\n\n\u6784\u9020\u8f6c\u79fb\u77e9\u9635:\n\n$$\n\\begin{vmatrix}f_{j,0} & f_{j,1}\\end{vmatrix}*\n\\begin{vmatrix}\ng_{i,0} & g_{i,1}\\\\\ng_{i,0} & \\infty\n\\end{vmatrix}\n=\\begin{vmatrix}\nf_{i,0} & f_{i,1}\n\\end{vmatrix}\n$$\n\n\u5bf9\u4e8e\u4e00\u6761\u91cd\u94fe\uff0c\u6211\u4eec\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u533a\u95f4\u4e58\u79ef\n\n\u5230\u4e86\u4e00\u6761\u91cd\u94fe\u94fe\u5934\uff0c\u56e0\u4e3a\u8fd9\u4e2a\u70b9\u662f\u5b83\u7236\u4eb2\u7684\u8f7b\u513f\u5b50\uff0c\u6211\u4eec\u9700\u8981\u66f4\u65b0\u5b83\u7236\u4eb2\u8282\u70b9\u6240\u5728\u7684\u70b9\u7684\u8f6c\u79fb\u77e9\u9635\u3002\n\n\u8fd9\u6837\u5b50\u4e00\u76f4\u8df3\u5230\u6839\u8282\u70b9\u5c31\u53ef\u4ee5\u4e86\n\n\u4ee3\u7801\u5982\u4e0b:\n\n```cpp\n#include<bits/stdc++.h>\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nconst int N=100011;\nvoid cmax(int&x,int y){if(x<y)x=y;}\nint max(int x,int y){return x>y?x:y;}\nint n,m,cnt,a[N],head[N];\nstruct edge{int to,nxt;}e[N<<1];\nint f[N],top[N],siz[N],id[N],dfn[N],sz,F[N][2],end[N];\nvoid add(int x,int y){e[++cnt].to=y,e[cnt].nxt=head[x],head[x]=cnt;}\nstruct mat{\n    int a[2][2];\n    mat(){memset(a,-0x3F,sizeof a);}\n    int&operator()(int x,int y){return a[x][y];}\n    mat operator*(const mat&x)const{\n        mat c;\n        for(int i=0;i<2;++i)\n            for(int j=0;j<2;++j)\n                for(int k=0;k<2;++k)\n                    cmax(c.a[i][j],a[i][k]+x.a[k][j]);\n        return c;\n    }\n    int mx()const{return max(a[0][0],a[1][0]);}\n}val[N];\nstruct seg{\n    mat s[N<<2];\n    #define ls rt<<1\n    #define rs rt<<1|1\n    void pu(int rt){s[rt]=s[ls]*s[rs];}\n    void build(int l=1,int r=n,int rt=1){\n        if(l==r)return s[rt]=val[dfn[l]],void();\n        int m=l+r>>1;\n        build(l,m,ls),build(m+1,r,rs);\n        pu(rt);\n    }\n    void upd(int x,int l=1,int r=n,int rt=1){\n        if(l==r)return s[rt]=val[dfn[l]],void();\n        int m=l+r>>1;\n        if(x<=m)upd(x,l,m,ls);\n        else upd(x,m+1,r,rs);\n        pu(rt);\n    }\n    mat ask(int L,int R,int l=1,int r=n,int rt=1){\n        if(L==l&&r==R)return s[rt];\n        int m=l+r>>1;\n        if(L>m)return ask(L,R,m+1,r,rs);\n        else if(R<=m)return ask(L,R,l,m,ls);\n        else return ask(L,m,l,m,ls)*ask(m+1,R,m+1,r,rs);\n    }\n    #undef ls\n    #undef rs\n}T;\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x])\n        f[to]=x,dfs(to),siz[x]+=siz[to];\n}\nvoid bt(int x,int tp){\n    top[x]=tp;dfn[id[x]=++sz]=x;\n    cmax(end[tp],sz);\n    F[x][0]=0,F[x][1]=a[x];\n    val[x](0,0)=val[x](0,1)=0;\n    val[x](1,0)=a[x];\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;\n    bt(k,tp);\n    F[x][0]+=max(F[k][0],F[k][1]);\n    F[x][1]+=F[k][0];\n    fl(i,x)if(!top[to]){\n        bt(to,to);\n        F[x][0]+=max(F[to][0],F[to][1]);\n        F[x][1]+=F[to][0];\n        val[x](0,1)=val[x](0,0)+=max(F[to][0],F[to][1]);\n        val[x](1,0)+=F[to][0];\n    }\n}\nvoid upd(int x,int v){\n    val[x](1,0)+=v-a[x];\n    a[x]=v;\n    mat bef,aft;\n    while(x){\n        bef=T.ask(id[top[x]],end[top[x]]);\n        T.upd(id[x]);\n        aft=T.ask(id[top[x]],end[top[x]]);\n        x=f[top[x]];\n        val[x](0,1)=val[x](0,0)+=aft.mx()-bef.mx();\n        val[x](1,0)+=aft(0,0)-bef(0,0);\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i);\n    int x,y;\n    for(int i=1;i<n;++i)\n        scanf(\"%d%d\",&x,&y),\n        add(x,y),add(y,x);\n    dfs(1),bt(1,1),T.build();\n    while(m--){\n        scanf(\"%d%d\",&x,&y);\n        upd(x,y);\n        printf(\"%d\\n\",T.ask(id[1],end[1]).mx());\n    }\n}\n```", "link": "/posts/\u52a8\u6001dp/", "tags": ["\u6811\u94fe\u5256\u5206", "\u77e9\u9635\u4e58\u6cd5", "\u52a8\u6001dp"], "categories": [["note"], ["\u7b97\u6cd5", "\u6811\u8bba"]]}, {"title": "\u540e\u7f00\u81ea\u52a8\u673a(SAM)", "content": "\n", "link": "/posts/sam/", "tags": ["\u5b57\u7b26\u4e32", "\u6570\u636e\u7ed3\u6784"], "categories": [["note"], ["\u7b97\u6cd5", "\u5b57\u7b26\u4e32"]]}, {"title": "\u591a\u9879\u5f0f\u5168\u5bb6\u6876", "content": "https://www.luogu.com.cn/blog/wucstdio/duo-xiang-shi-suan-fa-di-chang-shuo-wen-ti\n\nhttps://www.luogu.com.cn/blog/user7035/duo-xiang-shi-zong-jie\n\nhttp://zory.ink/posts/8c82\n\n## \u591a\u9879\u5f0f\u6a21\u677f\u96c6\u5408\n\n\u4ee5\u4e0b\u5bf9\u5e94\u4ee3\u7801\u90fd\u53ef\u4ee5\u5728\u8fd9\u91cc\u627e\u5230: \n\n[\u591a\u9879\u5f0f\u6a21\u677f\u96c6\u5408](https://oi-templates.vercel.app/\u591a\u9879\u5f0f)\n\n\u4f7f\u7528fft\u65f6\u63d0\u9ad8\u7cbe\u5ea6:\n- \u4f7f\u7528`long double`\n- `sin`\u4e0e`cos`\u5e94\u6539\u6210`std::sin`\u4e0e`std::cos`,`cmath`\u4e2d\u7684`sin,cos`\u83b7\u5f97\u7684\u503c\u4e3a`double`\n\n## \u591a\u9879\u5f0f\u4e58\u6cd5\n\n[\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362 FFT](/posts/fft)\n\n[\u5feb\u901f\u6570\u8bba\u53d8\u6362 NTT](/posts/ntt)\n\n[\u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362 FWT](/posts/fwt)\n\n## \u4efb\u610f\u6a21\u6570NTT(\u4e09\u6a21\u6570)\n\n\u6700\u5927\u7684\u6570\u4e3a$p^2\\times \\max(n,m) \\le 10^{23}$,\u6240\u4ee5\u4e00\u822c\u9009$3$\u4e2a\u6a21\u6570\u5373\u53ef\n\n\u8bbe\u6a21\u6570\u4e3a$m_1,m_2,m_3$\n\n$$\n\\begin{cases}\n    x \\equiv A \\pmod{m_1}\\\\\n    x \\equiv B \\pmod{m_2}\\\\\n    x \\equiv C \\pmod{m_3}\n\\end{cases}\n$$\n\n\u5408\u5e76\u524d\u4e24\u4e2a:\n\n$$\nA+k_1m_1=B+k_2m_2\\\\\nA+k_1m_1\\equiv B \\pmod{m_2}\\\\\nk_1\\equiv \\frac{B-A}{m_1} \\pmod{m_2}\n$$\n\n\u6c42\u51fa$k_1$,\u90a3\u4e48$x\\equiv A+k_1m_1 \\pmod{m_1m_2}$\n\n\u8bb0$D=A+k_1m_1$\n\n$$\nD+k_4m_1m_2=C+k_3m_3\\\\\nD+k_4m_1m_2\\equiv C \\pmod{m_3}\\\\\nk_4\\equiv \\frac{C-D}{m_1m_2} \\pmod{m_3}\n$$\n\n\u6c42\u51fa$k_4$\u90a3\u4e48$x\\equiv D+k_4m_1m_2 \\pmod{m_1m_2m_3}$,\n\n\u56e0\u4e3a$x<m_1m_2m_3$,\u6240\u4ee5$x=D+k_4m_1m_2$\n\n## \u62c6\u7cfb\u6570FFT(MTT)\n\n\u76f4\u63a5FFT\u7cbe\u5ea6\u4e0d\u8db3\uff0c\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u62c6\u7cfb\u6570FFT\n\n\u628a\u6bcf\u4e2a\u6570\u62c6\u6210$ak + b$\u7684\u5f62\u5f0f\n\n\u7136\u540e\u518d\u76f8\u4e58\u3001\u5408\u5e76\u5373\u53ef\n\n\u5373\u5047\u8bbe\u7ed9\u5b9a\u591a\u9879\u5f0f$N,M$\u8bbe$N(x)=ka(x)+b(x),M(x)=kc(x)+d(x)$\n\n$\n\\begin{aligned}\n&\\quad N(x)M(x)\\\\\n&=(ka(x)+b(x))(kc(x)+d(x))\\\\\n&=k^2a(x)c(x)+k(a(x)d(x)+b(x)c(x))+b(x)d(x)\n\\end{aligned}\n$\n\n\n**\u9700$8$\u6b21DFT**\n\n\u4f18\u5316\u7248**\u97004\u6b21DFT**\n\n\u4e00\u4e0b$a,b,c,d$\u4e3a\u4e0a\u8ff0$a(x),b(x),c(x),d(x)$\n\n\u4ee4$A_j=a_j+ib_j,B_j=c_j+id_j$\n\n$$\n\\begin{aligned}\n&\\quad A(w_n^j)_x\\\\\n&=(a_x+ib_x){w_n^j}^x\\\\\n&=a_x(\\cos \\frac{2\\pi xj}n+i\\sin \\frac{2\\pi xj}{n})+b_x(i\\cos \\frac{2\\pi xj}n - \\sin \\frac{2\\pi xj}n)\n\\end{aligned}\n$$\n\n\u540c\u7406\n\n$$\n\\begin{aligned}\n&\\quad A(w_n^{-j})_x\\\\\n&=(a_x+ib_x){w_n^{-j}}^x\\\\\n&=a_x(\\cos \\frac{2\\pi xj}n-i\\sin \\frac{2\\pi xj}{n})+b_x(i\\cos \\frac{2\\pi xj}n + \\sin \\frac{2\\pi xj}n)\n\\end{aligned}\n$$\n\n\u56e0\u6b64\n\n$$a(w_n^j)_x=\\frac {A(w_n^j)_x.real+A(w_n^{-j})_x.real}2+i\\frac{A(w_n^j)_x.imagine-A(w_n^{-j})_x.imagine}2$$\n\n(\u5b9e\u90e8\u4e3areal,\u865a\u90e8\u4e3aimagine)\n\n\u540c\u7406\n\n$$b(w_n^j)_x=\\frac {A(w_n^j)_x.imagine+A(w_n^{-j})_x.imagine}2+i\\frac{A(w_n^j)_x.real-A(w_n^{-j})_x.real}2$$\n\n\u8bbe\n$$\nC(x)=a(x)*B(x)=a(x)*c(x)+i*a(x)*d(x)\\\\\nD(x)=b(x)*B(x)=b(x)*c(x)+i*b(x)*d(x)\n$$\n\n\u53ef\u4ee5\u53d1\u73b0$C$\u7684\u5b9e\u90e8\u4e3a$a(x)c(x)$,\u865a\u90e8\u4e3a$a(x)d(x)$,\n\n\u540c\u7406$D$\u7684\u5b9e\u90e8\u4e3a$b(x)c(x)$,\u865a\u90e8\u4e3a$b(x)d(x)$,\n\n\u90a3\u4e48\u53ea\u9700\u89814\u6b21FFT\u5c31\u53ef\u4ee5\u6c42\u51fa$a(x)c(x),a(x)d(x),b(x)c(x),b(x)d(x)$\n\n\u5b9e\u6d4bFFT\u5e38\u6570\u5927,\u8fd8\u662f\u8dd1\u4e0d\u8fc7NTT\n\n## \u591a\u9879\u5f0f\u4e58\u6cd5\u9006\n\n\u7ed9\u51fa\u591a\u9879\u5f0f$A(x)$,\u6c42$B(x)$\u4f7f$A\\cdot B \\equiv 1 \\pmod{x^n}$\n\n\u5047\u8bbe\u5df2\u7ecf\u6c42\u51fa$B'$\u6ee1\u8db3$A\\cdot B' \\equiv 1 \\pmod{x^\\frac n2}$\n\n$\n\\because A\\cdot B \\equiv 1 \\pmod {x^n}\\\\\n\\because A\\cdot B' \\equiv 1 \\pmod{x^\\frac n2}\\\\\n\\therefore A \\cdot (B-B') \\equiv 0 \\pmod{x^\\frac n2}\\\\\n\\therefore B-B' \\equiv 0 \\pmod{x^\\frac n2}\\\\\n\\quad (B-B')^2 \\equiv 0 \\pmod{x^n}\\\\\n\\quad B^2-2BB'+B'^2 \\equiv 0 \\pmod{x^n}\\\\\n\\therefore A(B^2-2BB'+B'^2) \\equiv 0 \\pmod{x^n}\\\\\n\\quad AB^2-2ABB'+AB'^2 \\equiv 0 \\pmod{x^n}\\\\\n\\because A\\cdot B \\equiv 1 \\pmod {x^n}\\\\\n\\therefore B-2B'+AB'^2\\equiv 0 \\pmod{x^n}\\\\\n\\quad B\\equiv 2B'-AB'^2 \\pmod{x^n}\n$\n\n## \u591a\u9879\u5f0f\u9664\u6cd5\u4e0e\u53d6\u6a21\n\n\u7ed9\u51fa\u591a\u9879\u5f0f$n$\u6b21\u591a\u9879\u5f0f$F(x)$\u4e0e$m$\u6b21\u591a\u9879\u5f0f$G(x)$,\u6c42\u51fa\u591a\u9879\u5f0f$Q(x),R(x)$\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6:\n\n- $Q(x)$\u6b21\u6570\u4e3a$n-m$,$R(x)$\u6b21\u6570\u5c0f\u4e8e$m$\n- $F(x)=Q(x)*G(x)+R(x)$\n\n\u8bbe$F_r(x)=x^nf(\\frac 1x)$,\n\n\u53ef\u4ee5\u53d1\u73b0$A_r[i]=A[n-i]$($A_i=[x^i]F(x)$,\u4e5f\u5c31\u662f$F(x)$\u7684\u7b2c$n$\u9879\u7684\u7cfb\u6570)\n\n$\nF(x)=Q(x)*G(x)+R(x)\\\\\nF(\\frac 1x)=Q(\\frac 1x)*G(\\frac 1x)+R(\\frac 1x)\\\\\nx^nF(\\frac 1x)=x^{n-m}Q(\\frac 1x)\\cdot x^mR(\\frac 1x)+x^{n-m+1} \\cdot x^{m-1} R(\\frac 1x)\\\\\nF_r(x)=Q_r(x)*R_r(x)+x^{n-m+1}\\cdot R_r(x)\\\\~\\\\\nF_r(x)\\equiv Q_r(x)*G_r(x) \\pmod{x^{n-m+1}}\\\\\nQ_r(x)\\equiv F_r(x)*G_r(x)^{-1} \\pmod{x^{n-m+1}}\\\\\nR(x)=F(x)-G(x)*Q(x)\n$\n\n## \u591a\u9879\u5f0f\u5f00\u6839\n\n\u7ed9\u5b9a\u591a\u9879\u5f0f$A(x)$,\u6c42\u51fa$B(x)$\u4f7f$B(x)^2\\equiv A(x) \\pmod{x^n}$\n\n\u8bbe$B'(x)^2\\equiv A(x) \\pmod{x^{\\frac n2}}$\n\n$\\displaystyle\nB(x)\\equiv B'(x) \\pmod{x^{\\frac n2}}\\\\\nB(x)-B'(x)\\equiv 0 \\pmod{x^{\\frac n2}}\\\\\n(B(x)-B'(x))^2\\equiv 0 \\pmod{x^{\\frac n2}}\\\\\nB^2(x)+B'^2(x)-2B(x)B'(x)\\equiv 0 \\pmod{x^n}\\\\\nA(x)+B'^2(x)-2B(x)B'(x)\\equiv 0 \\pmod{x^n}\\\\\nB(x)=\\frac{A(x)+B'^2(x)}{2B'(x)}\\\\\n$\n\n## \u591a\u9879\u5f0f\u5bf9\u6570\u51fd\u6570\n\n\u524d\u7f6e\u77e5\u8bc6: \u6c42\u5bfc&\u79ef\u5206\n\n> \u6c42\u5bfc\u516c\u5f0f: $(x^n)'=nx^{n-1}$\n> \n> \u79ef\u5206\u516c\u5f0f: $\\int x^n dx=\\frac 1{n+1}x^{n+1}$\n> \n> \u6c42\u5bfc\u4e0e\u79ef\u5206\u4e92\u9006\n> \n> $\\ln' x=\\frac 1x$\n\n\u7ed9\u51fa\u591a\u9879\u5f0f$A(x)$,\u6c42\u51fa$B(x)$\u4f7f$B(x)\\equiv \\ln A(x)$\n\n\n\u5bf9\u4e24\u8fb9\u5206\u522b\u6c42\u5bfc\n\n$\n\\begin{aligned}\nB'(x)\n&=\\ln' A(x)\\\\\n&=ln'(A(x)) A'(x)\\\\\n&=\\frac{A'(x)}{A(x)}\n\\end{aligned}\n$\n\n\u5c06\u8bfb\u5165$A$\u6c42\u5bfc\u5f97\u5230$a$,\u6c42\u9006\u5f97\u5230$b$,$B'=a*b$\n\n\u5bf9$G'$\u6c42\u79ef\u5206\u5c31\u53ef\u4ee5\u5f97\u5230$G$\n\n## \u591a\u9879\u5f0f\u6307\u6570\u51fd\u6570\n\n\u524d\u7f6e\u77e5\u8bc6: \u6cf0\u52d2\u5c55\u5f00&\u725b\u987f\u8fed\u4ee3\n\n> \u725b\u987f\u8fed\u4ee3:\n> \n> \u8bc1\u660e: http://blog.miskcoo.com/2015/06/polynomial-with-newton-method\n> \n> \u5bf9\u4e8e\u4e00\u4e2a\u51fd\u6570$G(x)$\uff0c\u6c42\u6ee1\u8db3\u6761\u4ef6$G(F(x)) \\equiv 0 \\pmod {x^n}$\u7684\u591a\u9879\u5f0f$F(z)$\n> \n> $\\displaystyle F(x)\\equiv F_0(x)-\\frac{G(F_0(x))}{G'(F_0(x))}\\pmod{x^n}$\n> \n> \u8fd9\u91cc$F_0(x)$\u6307\u7684\u662f\u5728\u6a21$x^{\\frac n2}$\u610f\u4e49\u4e0b\u7684\u7b54\u6848\n\n\u7ed9\u51fa\u591a\u9879\u5f0f$A(x)$,\u6c42\u51fa$B(x)$\u4f7f$B(x)\\equiv e^{A(x)}$\n\n\u53d8\u5f62\u5f97$\\ln B(x) -A(x)=0$\n\n\u8bbe$G(B(x))=\\ln B(x) - A(x)$,\u73b0\u5728\u8981\u6c42$G$\u7684\u96f6\u70b9\n\n$G'(B(x))=\\frac 1{B(x)}$\n\n\u4ee3\u5165\u725b\u987f\u8fed\u4ee3\u516c\u5f0f\u5f97\n\n$B(x)\\equiv B_0(x)(1-\\ln B_0(x)+A(x)) \\pmod{x^n}$\n\n## \u591a\u9879\u5f0f\u5feb\u901f\u5e42\n\n\u7ed9\u5b9a\u591a\u9879\u5f0f$A(x)$,\u6c42\u51fa$B(x)$\u4f7f$B(x)\\equiv A^k(x) \\pmod{x^n}$\n\n\u53d6\u5bf9\u6570\n\n$\\ln B(x)\\equiv kA(x) \\pmod{x^n}$\n\n\u518d\u53d6\u6307\u6570\n\n$B(x)=e^{kA(x)}$\n\n\nhttps://www.cnblogs.com/xzyxzy/p/9270361.html", "link": "/posts/\u591a\u9879\u5f0f\u5168\u5bb6\u6876/", "tags": ["\u6570\u8bba", "\u591a\u9879\u5f0f", "ntt", "fft", "fwt"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "\u81ea\u7136\u6570\u5e42\u548c", "content": "## \u95ee\u9898\n\n\u6c42$\\displaystyle \\sum\\limits_{i=1}^n i^k$\n\n[1258 \u5e8f\u5217\u6c42\u548c V4](http://www.51nod.com/Challenge/Problem.html#problemId=1258)\n\n## \u666e\u901a\u6c42\u6cd5:\n\n$$\n(n+1)^{k+1}-n^{k+1}=\n{k+1\\choose 1}n^k+{k+1\\choose 2}n^{k-1}+\\dots+{k+1\\choose k}n+1\n$$\n\n\u7d2f\u52a0$n=1,2,3,\\dots$\u7684\u7ed3\u679c\n\n$$\n(n+1)^{k+1}-1={k+1\\choose 1}\\sum_{i=1}^n i^k + {k+1\\choose 2}\\sum_{i=1}^n i^{k-1} + \\dots + {k+1\\choose k}\\sum_{i=1}^n i^k + n\n$$\n\n\u79fb\u9879\n\n$$\n\\sum_{i=1}^n i^k=\n\\frac 1{k+1}\\left[\n(n+1)^{k+1}-1\n-{k+1\\choose 2}\\sum_{i=1}^n i^{k-1}\n-{k+1\\choose 3}\\sum_{i=1}^n i^{k-2}\n-\\dots\n-{k+1\\choose k}\\sum_{i=1}^n i\n-n\n\\right]\n$$\n\n\u8bbe$S(n,k)=\\sum\\limits_{i=1}^n i^k$,\u90a3\u4e48\n\n$$\nS(n,k)=\\frac 1{k+1}\\left[\n(n+1)^{k+1}-1\n-{k+1\\choose 2}S(n,k-1)\n-{k+1\\choose 3}S(n,k-2)\n-\\dots\n-{k+1\\choose k}S(n,1)\n-n\n\\right]\n$$\n\n\u5176\u4e2d$S(n,1)=\\frac{n(n+1)}2$\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u52a8\u6001\u89c4\u5212\u6216\u8bb0\u5fc6\u5316\u641c\u7d22\u7684\u65b9\u5f0f\u6c42\u89e3,\u590d\u6742\u5ea6\u4e3a$O(k^2)$\n\n## \u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\n\n\u53ef\u4ee5[\u8bc1\u660e](https://www.luogu.com.cn/blog/formkiller/cf622f-the-sum-of-the-k-th-powers-ti-xie)\u8fd9\u662f\u4e00\u4e2a$k+1$\u6b21\u9879\u5f0f,\u7136\u540e\u8fdb\u884c\u62c9\u683c\u6717\u65e5\u63d2\u503c\u5c31\u53ef\u4ee5\n\n\u76f4\u63a5\u62c9\u683c\u6717\u65e5\u63d2\u503c\u662f\u590d\u6742\u5ea6$O(k^2)$\u7684,\u5fc5\u7136\u4e0d\u884c\n\n\u6211\u4eec\u53ef\u4ee5\u53d6\u8fde\u7eed\u7684$k+2$\u4e2a\u70b9\u6765\u505a\u5230\u7ebf\u6027\u590d\u6742\u5ea6\n\n$F(n)=\\displaystyle \\sum_{i=1}^{k+2} \\sum_{y=0}^i y^k \\prod_{j\\neq i}\\frac{n-j}{i-j}$\n\n\u7ef4\u62a4$pre_i=\\prod_{j=0}^i n-j,suf_i=\\prod_{j=i}^n n-j$\n\n\u90a3\u4e48$\\displaystyle F(n)=\\sum_{i=1}^{k+2} \\sum_{y=0}^i y^k \\frac{pre_{i-1}\\cdot suf_{i+1}}{(i-1)!(k+2-i)!}$\n\n\u6ce8\u610f: \u5f53$k+2-i$\u4e3a\u5947\u6570\u65f6\u5206\u6bcd\u4e3a\u8d1f\u6570\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=50010,P=1000000007;\nint fac[N],ifac[N],pre[N],suf[N];\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%P;\n        x=1ll*x*x%P;b>>=1;\n    }\n    return res;\n}\nvoid init(int k){\n    fac[0]=1;\n    for(int i=1;i<=k;++i)fac[i]=1ll*fac[i-1]*i%P;\n    ifac[k]=pw(fac[k],P-2);\n    for(int i=k;i;--i)ifac[i-1]=1ll*ifac[i]*i%P;\n}\nvoid mod(int&x){if(x>=P)x-=P;}\nint S(int n,int k){\n    pre[0]=1;\n    for(int i=1;i<=k+2;++i)pre[i]=1ll*pre[i-1]*(n-i)%P;\n    suf[k+3]=1;\n    for(int i=k+2;i;--i)suf[i]=1ll*suf[i+1]*(n-i)%P;\n    int ans=0,y=0;\n    for(int i=1;i<=k+2;++i){\n        mod(y+=pw(i,k));\n        int a=1ll*pre[i-1]*suf[i+1]%P*ifac[i-1]%P*ifac[k+2-i]%P;\n        if((k-i)&1)a=P-a;\n        mod(ans+=1ll*y*a%P);\n    }\n    return ans;\n}\nint main(){\n    int T,k;long long n;\n    init(50005);\n    scanf(\"%d\",&T);\n    while(T--)\n        scanf(\"%lld%d\",&n,&k),\n        printf(\"%d\\n\",S(n%P,k));\n}\n```\n\n## \u4f2f\u52aa\u5229\u6570\n\n$\\displaystyle \\sum_{i=1}^{n-1} i^k=\\frac 1{k+1} \\sum_{i=1}^{k+1} {k+1\\choose i}B_in^{k-i+1}$\n\n[\u5f3a\u5f52\u7eb3\u6cd5\u8bc1\u660e](https://www.luogu.com.cn/blog/ShadowassIIXVIIIIV/guan-yu-bo-nu-li-shuo-zhuai-hua-zi-ran-shuo-mi-hu-gong-shi-di-zheng-mi#)\n\n\u751f\u6210\u51fd\u6570\u8bc1\u660e:\n\n\u4f2f\u52aa\u5229\u6570\u751f\u6210\u51fd\u6570\u4e3a$B(x)=\\displaystyle \\frac x{e^x+1}$\n\n\u4ee4$A(x)$\u4e3a$\\displaystyle S_k(n)=\\sum_{i=1}^{n-1} i^k$\u7684\u6307\u6570\u751f\u6210\u51fd\u6570\n\n\u90a3\u4e48\n\n$\n\\displaystyle\n\\begin{aligned}\nA(x)\n&=\\sum_{i=0}^{\\infty} \\frac{S_i(n)x^i}{i!}\\\\\n&=\\sum_{j=0}^{n-1} \\sum_{i=0}^{\\infty} \\frac{j^ix^i}{i!}\\\\\n&=\\sum_{j=0}^{n-1} e^{jx}\\\\\n&=\\frac{e^{nx}-1}{e^x-1}\\\\\n&=B(x)\\frac{e^{nx}-1}x\n\\end{aligned}\n$\n\n\u8003\u8651$[x^k]A(x)$:\n\n$\n\\displaystyle\n\\frac{S_k(n)}{k!}\n=\\sum_{i=0}^k \\frac{B_i n^{k-i+1}}{i!(k-i+1)!}\n\\\\\nS_k(n)=\\frac 1{k+1} \\sum_{i=0}^k {k+1\\choose i} B_i n^{k-i+1}\n$\n\n### ntt\u4efb\u610f\u6a21\u6570\u591a\u9879\u5f0f\u6c42\u9006\u6cd5(3\u6a21\u6570)\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=1<<17,P=1000000007;\nint pw(int x,int b,int p=P){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return res;\n}\nvoid mod(ll&x,ll p){if(x>=p)x-=p;}\nll mul(ll x,ll y,ll p){\n    ll res=0;\n    while(y){\n        if(y&1)mod(res+=x,p);\n        y>>=1;mod(x<<=1,p);\n    }\n    return res;\n}\nint fac[N],ifac[N];\nint C(int n,int m){\n    if(m>n)return 0;\n    return 1ll*fac[n]*ifac[n-m]%P*ifac[m]%P;\n}\nconst int G=3,\n    m[3]={998244353,469762049,1004535809};\nconst ll M=1ll*m[0]*m[1];\nint r[N],L=1;\nvoid swap(int&x,int&y){int t=x;x=y;y=t;}\nvoid ntt(int*A,int typ,int p){\n    int Gi=pw(G,p-2,p);\n    for(int i=0;i<L;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<L;len<<=1){\n        int Wn=pw(~typ?G:Gi,(p-1)/(len<<1),p);\n        for(int i=0;i<L;i+=len<<1){\n            int w=1;\n            for(int k=0;k<len;++k){\n                int t=1ll*A[i+k+len]*w%p;\n                A[i+k+len]=(A[i+k]-t+p)%p;\n                A[i+k]=(A[i+k]+t)%p;\n                w=1ll*w*Wn%p;\n            }\n        }\n    }\n    if(~typ)return;\n    int iL=pw(L,p-2,p);\n    for(int i=0;i<L;++i)A[i]=1ll*A[i]*iL%p;\n}\nint crt(int x,int y,int z){\n    ll a=(\n        mul(1ll*x*m[1]%M,pw(m[1]%m[0],m[0]-2,m[0]),M)+\n        mul(1ll*y*m[0]%M,pw(m[0]%m[1],m[1]-2,m[1]),M)\n    )%M;\n    ll k=((z-a)%m[2]+m[2])%m[2]*pw(M%m[2],m[2]-2,m[2])%m[2];\n    return ((k%P)*(M%P)%P+a%P)%P;\n}\nvoid getL(int n){\n    for(L=1;L<n;L<<=1);\n    for(int i=0;i<L;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)?(L>>1):0);\n}\nint ans[3][N],tmp[N];\nvoid work(int n,int*a,int*b){\n    if(n==1){\n        b[0]=crt(\n            pw(a[0],m[0]-2,m[0]),\n            pw(a[0],m[1]-2,m[1]),\n            pw(a[0],m[2]-2,m[2])\n        );\n        return;\n    }\n    work(n>>1,a,b);\n    getL(n<<1);\n    for(int k=0;k<3;++k)\n        for(int i=0;i<n;++i)\n            ans[k][i]=b[i],ans[k][i+n]=0;\n    for(int k=0;k<3;++k){\n        for(int i=0;i<n;++i)\n            tmp[i]=a[i],tmp[i+n]=0;\n        ntt(tmp,1,m[k]),ntt(ans[k],1,m[k]);\n        for(int i=0;i<L;++i)\n            ans[k][i]=1ll*tmp[i]*ans[k][i]%m[k];\n        ntt(ans[k],-1,m[k]);\n    }\n    for(int i=0;i<n;++i)\n        ans[0][i]=ans[1][i]=ans[2][i]=\n            (P-crt(ans[0][i],ans[1][i],ans[2][i]))%P;\n    ans[0][0]=ans[1][0]=ans[2][0]=(ans[0][0]+2)%P;\n\n    for(int k=0;k<3;++k){\n        for(int i=0;i<n;++i)\n            tmp[i]=b[i],tmp[i+n]=0;\n        ntt(tmp,1,m[k]),ntt(ans[k],1,m[k]);\n        for(int i=0;i<L;++i)\n            ans[k][i]=1ll*tmp[i]*ans[k][i]%m[k];\n        ntt(ans[k],-1,m[k]);\n    }\n    for(int i=0;i<n;++i)\n        b[i]=crt(ans[0][i],ans[1][i],ans[2][i]);\n}\nint a[N],B[N];\nvoid init(){\n    int len=1<<16;\n    fac[0]=1;\n    for(int i=1;i<=len;++i)fac[i]=1ll*fac[i-1]*i%P;\n    ifac[len]=pw(fac[len],P-2);\n    for(int i=len;i;--i)ifac[i-1]=1ll*ifac[i]*i%P;\n    for(int i=0;i<len;++i)a[i]=ifac[i+1];    \n    work(len,a,B);\n    for(int i=0;i<len;++i)\n        B[i]=1ll*B[i]*fac[i]%P;\n    B[1]=P-B[1];\n}\nint S(int n,int k){\n    int x=0;\n    for(int i=0;i<=k;++i)\n        x=(x+1ll*C(k+1,i)*B[i]%P*pw(n,k+1-i)%P)%P;\n    return 1ll*pw(k+1,P-2)*x%P;\n}\nint main(){\n    init();\n    int T,k;long long n;\n    scanf(\"%d\",&T);\n    while(T--)\n        scanf(\"%lld%d\",&n,&k),\n        printf(\"%lld\\n\",S(n%P,k));\n}\n```\n\n### fft\u591a\u9879\u5f0f\u6c42\u9006\u6cd5\n\n```cpp\n```\n\n## \u65af\u7279\u6797\u6570\n\n$\n\\begin{aligned}\n\\sum_{i=1}^n i^k\n&=\\sum_{i=1}^n \\left( i^{\\underline{k}} - \\sum_{j=0}^{k-1} \\begin{bmatrix}k\\\\j\\end{bmatrix}(-1)^{k-j}i^j\\right)\\\\\n&=\\sum_{i=1}^n i^{\\underline{k}} - \\sum_{j=0}^{k-1}(-1)^{k-j}\\left( \\sum_{x=1}^n x^j \\right)\\\\\n&=\\frac{(n+1)^{\\underline{k+1}}}{k+1} - \\sum_{j=0}^{k-1} \\begin{bmatrix}k\\\\j\\end{bmatrix}(-1)^{k-j}S_j(n)\n\\end{aligned}\n$\n\n$\n\\begin{aligned}\n\\sum_{i=1}^n i^k\n&=\\sum_{i=1}^n \\left( i^{\\overline{k}} - \\sum_{j=0}^{k-1} \\begin{bmatrix}k\\\\j\\end{bmatrix}i^j\\right)\\\\\n&=\\sum_{i=1}^n i^{\\overline{k}} - \\sum_{j=0}^{k-1}\\left( \\sum_{x=1}^n x^j \\right)\\\\\n&=\\frac{(n+1)^{\\overline{k+1}}}{k+1} - \\sum_{j=0}^{k-1}\\begin{bmatrix}k\\\\j\\end{bmatrix}S_j(n)\n\\end{aligned}\n$", "link": "/posts/\u81ea\u7136\u6570\u5e42\u548c/", "tags": ["\u6570\u8bba", "\u4f2f\u52aa\u5229\u6570", "\u65af\u7279\u6797\u6570", "\u62c9\u683c\u6717\u65e5\u63d2\u503c", "\u591a\u9879\u5f0f"], "categories": [["note"]]}, {"title": "\u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362(FWT)", "content": "\u7ed9\u5b9a\u5e8f\u5217$A,B$,\u8bbe\n\n$$C_i=\\sum_{j\\oplus k=i}A_j \\times B_k$$\n\n\u5206\u522b\u5f53$\\oplus$\u662f`or`,`and`,`xor`\u65f6\u6c42\u51fa$C$\n\n## \u601d\u60f3\n\n\u8bb0$\\text{fwt}_A$\u4e3a\u5bf9$A$\u8fdb\u884c\u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362\u540e\u7684\u5e8f\u5217\n\n$A\\rightarrow \\text{fwt}_A$\u4e0e$B\\rightarrow \\text{fwt}_B$\u7684\u590d\u6742\u5ea6\u4e3a$\\mathcal O(n\\log n)$\n\n$\\text{fwt}_C=\\text{fwt}_A * \\text{fwt}_B$\u7684\u590d\u6742\u5ea6\u4e3a$\\mathcal O(n)$\n\n$\\text{fwt}_C \\rightarrow C$\u7684\u590d\u6742\u5ea6\u4e3a$\\mathcal O(n\\log n)$\n\n## OR\n\n$$C_i=\\sum_{j|k=i}A_j \\times B_k$$\n\n\u6784\u9020$\\displaystyle {\\text{fwt}_A}_i=\\sum_{j|i}A_j$,\u5219\n\n$$\n\\begin{aligned}\n&\\quad \\text{fwt}_A*\\text{fwt}_B\\\\\n&=\\sum_{j|i=i}\\sum_{k|i=i}A_jB_k\\\\\n&=\\sum_{(j|k)|i=i}A_jB_k\\\\\n&=\\sum_{(j|k)=i}A_jB_k\\\\\n&=\\text{fwt}_C\n\\end{aligned}\n$$\n\n$A\\rightarrow \\text{fwt}_A$\u4e5f\u5c31\u662f\u6c42$\\displaystyle {\\text{fwt}_A}_i=\\sum_{j|i}A_j$\n\n\u8bbe$A0$\u8868\u793a$A$\u4e2d\u4e0b\u6807\u6700\u9ad8\u4f4d\u4e3a$0$\u7684\u90e8\u5206,$A1$\u8868\u793a$A$\u4e2d\u4e0b\u6807\u6700\u9ad8\u4f4d\u4e3a$1$\u7684\u90e8\u5206\n\n$$\\text{fwt}_A=\\text{mg}(\\text{fwt}_{A0},\\text{fwt}_{A0}+\\text{fwt}_{A1})$$\n\n(\u8fd9\u91cc\u7684$\\text{mg}$\u8868\u793a\u62fc\u63a5\u5e8f\u5217,$+$\u8868\u793a\u5bf9\u4e8e\u4f4d\u7f6e\u76f8\u52a0)\n\n\u53cd\u8fc7\u6765$\\text{fwt}_A\\rightarrow A$\u5c31\u662f\n\n$$A=\\text{mg}(A0,A1-A0)$$\n\n## AND\n\n\u4e0eOR\u540c\u7406\n\n$$\\text{fwt}_A=\\text{mg}(\\text{fwt}_{A0}+\\text{fwt}_{A1},\\text{fwt}_{A1})$$\n\n\u53cd\u8fc7\u6765\n\n$$A=\\text{mg}(A0-A1,A1)$$\n\n## XOR\n\n\u8bbe$x\\otimes y$\u8868\u793a$x\\&y$\u5728\u4e8c\u8fdb\u5236\u4e0b$1$\u7684\u4e2a\u6570\u4e3a\u5947\u6570\u8fd8\u662f\u5076\u6570\n\n\u6ee1\u8db3 $(i\\otimes j) ~ \\text{xor} ~ (i\\otimes k)=i\\otimes (j ~ \\text{xor} ~ k)$\n\n\u8bbe $\\displaystyle \\text{fwt}_{A_i}=\\sum_{i\\oplus j=0} A_j - \\sum_{i\\oplus j=1} A_j$\n\n\u5219\u6709\n\n$$\n\\begin{aligned}\n&\\quad \\text{fwt}_A * \\text{fwt}_B\\\\\n&=(\\sum_{i\\oplus j=0} A_j - \\sum_{i\\oplus j=1} A_j)(\\sum_{i\\oplus j=0} B_j - \\sum_{i\\oplus j=1} B_j)\\\\\n&=(\\sum_{i\\oplus j=0} A_j)(\\sum_{i\\oplus j=0} B_j)-(\\sum_{i\\oplus j=0} A_j)(\\sum_{i\\oplus j=1} B_j)-(\\sum_{i\\oplus j=1} A_j)(\\sum_{i\\oplus j=0} B_j)+(\\sum_{i\\oplus j=1} A_j)(\\sum_{i\\oplus j=1} B_j)\\\\\n&=\\sum_{i\\otimes (j~\\text{xor}~k)=0}a_jb_k - \\sum_{i\\otimes (j~\\text{xor}~k)=1}a_jb_k\\\\\n&=\\text{fwt}_C\n\\end{aligned}\n$$\n\n\u6240\u4ee5\n\n$$\\text{fwt}_A=\\text{mg}(\\text{fwt}_{A0}+\\text{fwt}_{A1},\\text{fwt}_{A0}-\\text{fwt}_{A1})$$\n\n\u53cd\u8fc7\u6765\n\n$$a=\\text{mg}(\\frac{A0+A1}2,\\frac{A0-A1}2)$$\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1<<17,P=998244353;\nint n,A[N],B[N],C[N],a[N],b[N];\nvoid cp(){memcpy(a,A,n<<2),memcpy(b,B,n<<2);}\nvoid mul(){for(int i=0;i<n;++i)C[i]=1ll*a[i]*b[i]%P;}\nvoid op(){for(int i=0;i<n;++i)printf(\"%d \",C[i]);putchar('\\n');}\nvoid mod(int&x){if(x>=P)x-=P;}\nvoid OR(int*f){\n    for(int k=1;k<n;k<<=1)\n        for(int i=0;i<n;i+=k<<1)\n            for(int j=0;j<k;++j)\n                mod(f[i+j+k]+=f[i+j]);\n}\nvoid IOR(int*f){\n    for(int k=1;k<n;k<<=1)\n        for(int i=0;i<n;i+=k<<1)\n            for(int j=0;j<k;++j)\n                mod(f[i+j+k]+=P-f[i+j]);\n}\nvoid AND(int*f){\n    for(int k=1;k<n;k<<=1)\n        for(int i=0;i<n;i+=k<<1)\n            for(int j=0;j<k;++j)\n                mod(f[i+j]+=f[i+j+k]);\n}\nvoid IAND(int*f){\n    for(int k=1;k<n;k<<=1)\n        for(int i=0;i<n;i+=k<<1)\n            for(int j=0;j<k;++j)\n                mod(f[i+j]+=P-f[i+j+k]);\n}\nvoid XOR(int*f){\n    for(int k=1;k<n;k<<=1)\n        for(int i=0;i<n;i+=k<<1)\n            for(int j=0;j<k;++j){\n                int t=f[i+j];\n                mod(f[i+j]+=f[i+j+k]),\n                mod(f[i+j+k]=t-f[i+j+k]+P);\n            }\n}\nint i2=499122177;\nvoid IXOR(int*f){\n    for(int k=1;k<n;k<<=1)\n        for(int i=0;i<n;i+=k<<1)\n            for(int j=0;j<k;++j){\n                int t=f[i+j];\n                mod(f[i+j]+=f[i+j+k]),\n                mod(f[i+j+k]=t-f[i+j+k]+P);\n                f[i+j]=1ll*i2*f[i+j]%P,\n                f[i+j+k]=1ll*i2*f[i+j+k]%P;\n            }\n}\nint main(){\n    scanf(\"%d\",&n),n=1<<n;\n    for(int i=0;i<n;++i)scanf(\"%d\",A+i);\n    for(int i=0;i<n;++i)scanf(\"%d\",B+i);\n    cp(),OR(a),OR(b),mul(),IOR(C),op();\n    cp(),AND(a),AND(b),mul(),IAND(C),op();\n    cp(),XOR(a),XOR(b),mul(),IXOR(C),op();\n}\n```", "link": "/posts/fwt/", "tags": ["\u6570\u8bba", "\u591a\u9879\u5f0f", "fwt"], "categories": [["note"], ["\u7b97\u6cd5", "\u6570\u8bba"]]}, {"title": "Miller Rabin\u7b97\u6cd5\u4e0ePollard Rho\u7b97\u6cd5", "content": "## Miller Rabin\n\n\u5224\u65ad\u4e00\u4e2a\u6570\u662f\u5426\u4e3a\u7d20\u6570$O(\\log n)$\n\n\u524d\u7f6e\u77e5\u8bc6:\n\n1. \u8d39\u9a6c\u5c0f\u5b9a\u7406\n\n   \u82e5$p$\u4e3a\u7d20\u6570,$a^{p-1}\\equiv 1 \\pmod p$\n\n2. \u4e8c\u6b21\u63a2\u6d4b\u5b9a\u7406\n   \n   \u82e5$p$\u4e3a\u8d28\u6570$x^2\\equiv 1 \\pmod p$,\u90a3\u4e48$x\\equiv 1\\pmod p$\u6216$x\\equiv -1\\equiv p-1\\pmod p$\n\n\u82e5$p$\u4e3a\u7d20\u6570,\u90a3\u4e48$p-1$\u53ef\u4ee5\u5206\u89e3\u4e3a$2^k\\cdot t$\u7684\u5f62\u5f0f\n\n\u968f\u673a\u53d6\u4e00\u4e2a\u6570$a$,\u5148\u7b97\u51fa$a^t$,\u7136\u540e\u518d\u4e0d\u65ad\u81ea\u4e58,\u5982\u679c\u5f53\u524d\u6570$\\not \\equiv \\pm 1 \\pmod p$\u800c\u81ea\u4e58\u540e\u7684\u6570$\\equiv 1 \\pmod p$,\u90a3\u4e48$p$\u4e0d\u662f\u7d20\u6570\n\n\u770b\u4e0a\u53bb\u6709\u4e9b\u7384\u5b66\n\n\u82e5$p$\u901a\u8fc7\u4e00\u6b21\u6d4b\u8bd5,\u5219$p$\u4e0d\u662f\u7d20\u6570\u7684\u6982\u7387\u4e3a$25\\%$\n\n\u90a3\u4e48\u6d4b\u8bd5$x$\u6b21,\u5219$p$\u4e0d\u662f\u7d20\u6570\u7684\u6982\u7387\u4e3a$\\displaystyle \\frac 1{4^x}$\n\n\u6211\u4eec\u53ef\u4ee5\u4fdd\u8bc1\u975e\u5e38\u9ad8\u7684\u6b63\u786e\u7387\n\n[HDU 2138 How many prime numbers](http://acm.hdu.edu.cn/showproblem.php?pid=2138)\n\n```cpp\n#include<cstdio>\nint pw(int x,int b,int p){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return res;\n}\nbool chk(int p){\n    if(p==2)return 1;\n    if(p<2||!(p&1))return 0;\n    static int test[]={2,3,5,7,11,13,17,19,23,29,31,37,41};\n    int t=p-1,k=0;\n    while(!(t&1))++k,t>>=1;\n    for(int i=0;i<4&&test[i]<p;++i){\n        int a=pw(test[i],t,p),nxt;\n        for(int j=1;j<=k;++j){\n            nxt=1ll*a*a%p;\n            if(nxt==1&&a!=1&&a!=p-1)return 0;\n            a=nxt;\n        }\n        if(a!=1)return 0;\n    }\n    return 1;\n}\nint main(){\n    int T;\n    while(~scanf(\"%d\",&T)){\n        int x,ans=0;\n        while(T--)scanf(\"%d\",&x),ans+=chk(x);\n        printf(\"%d\\n\",ans);\n    }\n}\n```\n\n## Pollard-Rho\n\n`Pollard Rho`\u662f\u4e00\u4e2a\u8457\u540d\u7684\u5927\u6570\u8d28\u56e0\u6570\u5206\u89e3\u7b97\u6cd5\n\n`Pollard Rho`\u53ef\u4ee5\u5728$O(n^{\\frac 14})$\u5185\u627e\u51fa$n$\u7684\u4e00\u4e2a\u56e0\u5b50\n\n\u6211\u4eec\u9700\u8981\u5728$n$\u4e2a\u6570\u4e2d\u731c\u51fa$n$\u7684\u4e00\u4e2a\u56e0\u6570,\u6210\u529f\u7387$\\dfrac 1n$\n\n\u6211\u4eec\u77e5\u9053\u56e0\u6570\u662f\u6210\u5bf9\u7684,\u6211\u4eec\u53ef\u4ee5\u5728$[1,\\sqrt n]$\u5185\u731c,\u6210\u529f\u7387$\\dfrac 1{\\sqrt n}$\n\n\u4f46\u5bf9\u4e8e$n\\ge10^{18}$,\u8fd9\u4e2a\u6210\u529f\u7387\u8fd8\u662f\u4e0d\u591f\n\n### \u751f\u65e5\u653b\u51fb\n\n\u8003\u8651[\u751f\u65e5\u653b\u51fb_\u7ef4\u57fa](https://zh.wikipedia.org/wiki/%E7%94%9F%E6%97%A5%E6%94%BB%E5%87%BB),[\u751f\u65e5\u653b\u51fb_\u767e\u5ea6](https://baike.baidu.com/item/%E7%94%9F%E6%97%A5%E6%94%BB%E5%87%BB/1005939?fr=aladdin)\n\n> \u82e5\u8001\u5e08\u9009\u62e9\u7279\u5b9a\u65e5\u671f\uff08\u4f8b\u59829\u670816\u65e5\uff09\uff0c\u5219\u81f3\u5c11\u6709\u4e00\u540d\u5b66\u751f\u5728\u90a3\u5929\u51fa\u751f\u7684\u6982\u7387\u662f$\\displaystyle 1-(364/365)^{30}$,\u7ea6\u4e3a$7.9\\%$\u3002\u4f46\u662f\uff0c\u4e0e\u6211\u4eec\u7684\u76f4\u89c9\u76f8\u53cd\u7684\u662f\uff0c\u81f3\u5c11\u4e00\u540d\u5b66\u751f\u548c\u53e6\u5916\u4efb\u610f\u4e00\u540d\u5b66\u751f\u6709\u7740\u76f8\u540c\u751f\u65e5\u7684\u6982\u7387\u5927\u7ea6\u4e3a$70.63\\%$\uff08$n = 30$\u65f6\uff09\n\n\u751f\u65e5\u6096\u8bba\u7684\u5b9e\u8d28\u662f:\u7531\u4e8e\u91c7\u7528\"\u7ec4\u5408\u968f\u673a\u91c7\u6837\"\u7684\u65b9\u6cd5,\u6ee1\u8db3\u7b54\u6848\u7684\u7ec4\u5408\u6bd4\u5355\u4e2a\u4e2a\u4f53\u8981\u591a\u4e00\u4e9b.\u8fd9\u6837\u53ef\u4ee5\u63d0\u9ad8\u6b63\u786e\u7387.\n\n### Pollard Rho\u7684\u968f\u673a\u51fd\u6570\n\n\u6211\u4eec\u4e0d\u653e\u9009\u53d6\u4e00\u7ec4\u6570$x_1,x_2,x_3,\\dots,x_nx$,\u82e5\u6709$\\gcd(|x_i-x_j|,N)>1$,\u5219\u79f0$\\gcd(|x_i-x_j|,N)$\u662f$N$\u7684\u4e00\u4e2a\u56e0\u5b50\n\n\u8003\u8651\u8fd9\u4e48\u4e00\u4e2a\u5e8f\u5217$x_i={x_{i-1}}^2+c \\pmod N$,\u5176\u4e2d$c$\u662f\u4e00\u4e2a\u968f\u673a\u7684\u5e38\u6570.\n\n\u8fd9\u6837\u751f\u6210\u7684\u6570\u5217\u4e3a\u4f2a\u968f\u673a\u6570\n\n\u53ef\u4ee5[\u8bc1\u660e](https://www.luogu.com.cn/blog/105254/solution-p4718)\u671f\u671b$n^{\\frac 14}$\u4e2a\u6570\u540e\u4f1a\u5f00\u59cb\u5faa\u73af\n\n### \u5224\u73af\n\n\u6781\u5c11\u6570\u60c5\u51b5\u4e0b\uff0c\u8be5\u7b97\u6cd5\u751a\u81f3\u5728\u904d\u5386\u6574\u4e2a\u6570\u5217\u540e\u4ecd\u7136\u65e0\u6cd5\u627e\u5230\u89e3\n\n\u6211\u4eec\u9700\u8981\u5224\u73af\u5e76\u66f4\u6362$c$\u540e\u91cd\u65b0\u5c1d\u8bd5\n\n[4718 \u3010\u6a21\u677f\u3011Pollard-Rho\u7b97\u6cd5](https://www.luogu.com.cn/problem/P4718)\n\n\u82e5$n$\u662f\u8d28\u6570\uff0c\u5219\u76f4\u63a5\u8fd4\u56de\n\n`Pollard Rho`\u627e\u51fa$n$\u7684\u4e00\u4e2a\u56e0\u5b50$p$\uff0c\u9664\u53bb$n$\u4e2d\u6240\u6709$p$\u5f97\u5230$n'$,\u7ee7\u7eed\u5206\u6790$p$\u548c$n$,\u53ef\u8fdb\u884c\u9002\u5f53\u526a\u679d\n\n\u8003\u8651\u8def\u5f84\u500d\u589e\u4f18\u5316\n\n\u7531\u4e8e\u4e00\u76f4\u53d6$\\gcd$\u4f1a\u8ba9\u7b97\u6cd5\u53d8\u5f97\u5f88\u6162\uff0c\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u4e58\u6cd5\u7d2f\u79ef\u6765\u51cf\u5c11\u6c42gcd\u7684\u6b21\u6570\uff0c\u82e5$\\gcd(a,b)>1$,\u90a3\u4e48$\\gcd(ac,b)>1$\uff0c\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5c06\u4e00\u6bb5\u8def\u5f84\u4e58\u8d77\u6765$\\pmod n$\uff0c\u518d\u505a\u4e00\u6b21$\\gcd$\n\n\u6211\u4eec\u4e0d\u59a8\u8003\u8651\u500d\u589e\u7684\u601d\u60f3:\u6bcf\u6b21\u5728\u8def\u5f84$\\rho$\u4e0a\u500d\u589e\u5730\u53d6\u4e00\u6bb5$[2^{k-1},2^k]$\u7684\u533a\u95f4.\u5c06$2^{k-1}$\u8bb0\u4e3a$l$,$2^k$\u8bb0\u4e3a$r$.\u53d6\u800c\u4ee3\u4e4b\u7684,\u6211\u4eec\u6bcf\u6b21\u53d6\u7684$\\gcd$\u6d4b\u8bd5\u6837\u672c\u4e3a$|x_i-x_l|$,\u5176\u4e2d$l \\le i \\le r$.\u6211\u4eec\u6bcf\u6b21\u79ef\u7d2f\u7684\u6837\u672c\u4e2a\u6570\u5c31\u662f$2^{k-1}$\u4e2a,\u662f\u500d\u589e\u7684\u4e86.\u8fd9\u6837\u53ef\u4ee5\u5728\u4e00\u5b9a\u7a0b\u5ea6\u4e0a\u907f\u514d\u5728\u73af\u4e0a\u505c\u7559\u8fc7\u4e45,\u6216\u8005\u53d6$gcd$\u7684\u6b21\u6570\u8fc7\u7e41\u7684\u5f0a\u7aef.\n\n\u6211\u4eec\u9009\u62e9$2^7=127$\u5c06\"\u8fed\u4ee37\u6b21\"\u4f5c\u4e3a\u4e0a\u754c\u662f\u5b9e\u9a8c\u5f97\u51fa\u7684\u8f83\u4f18\u65b9\u6848\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\ntypedef __int128 i128;\nll pw(ll x,ll b,const ll&p){\n    ll res=1;\n    while(b){\n        if(b&1)res=(i128)res*x%p;\n        b>>=1;x=(i128)x*x%p;\n    }\n    return res;\n}\nbool chk(const ll&p){\n    if(p==2)return 1;\n    if(!(p&1)||p<2)return 0;\n    ll t=p-1;int k=0;\n    while(!(t&1))t>>=1,++k;\n    static int test[]={2,3,5,7,11,13,17,19,23,29};\n    for(int i=0;i<10&&test[i]<p;++i){\n        ll a=pw(test[i],t,p),nxt;\n        for(int j=1;j<=k;++j){\n            nxt=(i128)a*a%p;\n            if(nxt==1&&a!=1&&a!=p-1)return 0;\n            a=nxt;\n        }\n        if(a!=1)return 0;\n    }\n    return 1;\n}\nll mxf;\nll f(const ll&x,const ll&c,const ll&n){\n    return ((i128)x*x+c)%n;\n}\nll abs(const ll&x){return x<0?-x:x;}\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll pr(const ll&x){\n    ll s=0,t=0,c=1ll*rand()%(x-1)+1;\n    int stp=0,goal=1;\n    ll v=1;\n    for(goal=1;;goal<<=1,s=t,v=1){\n        for(stp=1;stp<=goal;++stp){\n            t=f(t,c,x);\n            v=(i128)v*abs(t-s)%x;\n            if(stp%127==0){\n                ll d=gcd(v,x);\n                if(d>1)return d;\n            }\n        }\n        ll d=gcd(v,x);\n        if(d>1)return d;\n    }\n}\nvoid fact(ll x){\n    if(x<=mxf||x<2)return;\n    if(chk(x)){\n        mxf=mxf>x?mxf:x;\n        return;\n    }\n    ll p=x;\n    while(p>=x)p=pr(x);\n    while(x%p==0)x/=p;\n    fact(x),fact(p);\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--){\n        srand(time(0));\n        ll n;scanf(\"%lld\",&n);\n        mxf=0;\n        fact(n);\n        if(mxf==n)printf(\"Prime\\n\");\n        else printf(\"%lld\\n\",mxf);\n    }\n}\n```\n\n\u53c2\u8003:\n\n- https://www.luogu.com.cn/problem/solution/P4718\n- https://www.luogu.com.cn/blog/105254/solution-p4718", "link": "/posts/Miller-Rabin-and-Pollard-Rho/", "tags": ["\u6570\u8bba"], "categories": [["note"]]}, {"title": "\u65af\u7279\u6797\u6570", "content": "## \u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\n\n### \u5b9a\u4e49\n\n- $s(n,m)$\u8868\u793a\u5c06$n$\u4e2a\u5143\u7d20\u5206\u6210$m$\u4e2a\u5706\u6392\u5217\u7684\u65b9\u6848\u6570\n\n- \u8bb0\u4f5c$\\begin{bmatrix}n\\\\m\\end{bmatrix}$\n\n### \u9012\u63a8\u5f0f\n\n$$\n\\begin{bmatrix}n\\\\m\\end{bmatrix}=\\begin{bmatrix}n-1\\\\m-1\\end{bmatrix}+(n-1)\\begin{bmatrix}n-1\\\\m\\end{bmatrix}\n$$\n\n(\u5f53\u524d\u5143\u7d20\u53ef\u4ee5\u5efa\u4e00\u4e2a\u65b0\u73af\u6216\u653e\u5728\u5df2\u6709\u7684\u4efb\u610f\u5143\u7d20\u524d\u9762)\n\n### \u6027\u8d28\n\n$$\n\\sum_{i=0}^n \\begin{bmatrix}n\\\\i\\end{bmatrix} = n!\n$$\n\n\u8bc1\u660e: \u6bcf\u4e2a\u6392\u5217\u5b9e\u9645\u4e0a\u5bf9\u5e94\u7740\u4e00\u4e2a\u7f6e\u6362\n\n\u8003\u8651$s(n,i)$\u5206\u6210\u7684$i$\u4e2a\u73af,\u5b9e\u9645\u4e0a\u5c31\u662f\u5bf9\u5e94\u7740\u5faa\u73af\u8282\u4e2a\u6570\u4e3a$i$\u7684\u4e00\u79cd\u7f6e\u6362,\u4e00\u4e00\u5bf9\u5e94\u8fc7\u53bb\u5c31\u662f\u6240\u6709\u7f6e\u6362\u65b9\u6848\u5c31\u662f\u5168\u6392\u5217\u4e86\n\n\n> \u9636\u4e58\u5e42\n> \n> \u4e0a\u5347\u9636\u4e58\u5e42:\n>\n> $\\begin{aligned}x^{\\overline{n}}&=x(x+1)(x+2)\\cdots(x+n-1)\\\\&=\\frac{(x+n-1)!}{(x-1)!}\\end{aligned}$\n> \n> \u4e0b\u964d\u9636\u4e58\u5e42:\n> \n> $\\begin{aligned}x^{\\underline{n}}&=x(x-1)(x-2)\\cdots(x-n+1)\\\\&=\\frac{x!}{(x-n)!}\\end{aligned}$\n\n- **\u4e0a\u5347\u9636\u4e58\u5e42**\n\n  $\\displaystyle x^{\\overline n}=\\sum_{i=0}^n \\begin{bmatrix}n\\\\i\\end{bmatrix}x^i$\n  \n  \u8bc1\u660e:\n  \n  $\n  \\begin{aligned}\n  x^{\\overline{n+1}}\n  &=(x+n)\\sum_{i=0}^n \\begin{bmatrix}n\\\\i\\end{bmatrix}x^i\\\\\n  &=\\sum_{i=0}^{n+1}\\begin{bmatrix}n\\\\i-1\\end{bmatrix}x^i+n\\sum_{i=0}^{n+1}\\begin{bmatrix}n\\\\i\\end{bmatrix}x^i\\\\\n  &=\\sum_{i=0}^{n+1}\\left( \\begin{bmatrix}n\\\\i-1\\end{bmatrix}+n\\begin{bmatrix}n\\\\i\\end{bmatrix}\\right)x^i\\\\\n  &=\\sum_{i=0}^{n+1}\\begin{bmatrix}n+1\\\\i\\end{bmatrix}x^i\n  \\end{aligned}\n  $\n\n- \u4e0b\u964d\u9636\u4e58\u5e42\n  \n  $\\displaystyle x^{\\underline{n}}=\\sum_{i=0}^n \\begin{bmatrix}n\\\\i\\end{bmatrix}(-1)^{n-i}x^i$\n  \n  \u8bc1\u660e(\u6570\u5b66\u5f52\u7eb3\u6cd5):\n  \n  $n=1$\u65f6,\u6210\u7acb\n  \n  $n>1$\u65f6:\n  \n  $\n  \\begin{aligned}\n  x^{\\underline{n+1}}\n  &=(x-n)x^{\\underline{n}}\\\\\n  &=(x-n)\\sum_{i=0}^n \\begin{bmatrix}n\\\\i\\end{bmatrix}(-1)^{n-i}x^i\\\\\n  &=\\sum_{i=0}^{n+1} \\begin{bmatrix}n\\\\i-1\\end{bmatrix}(-1)^{n-i-1}x^i\n  +n\\sum_{i=0}^{n+1} \\begin{bmatrix}n\\\\i\\end{bmatrix}(-1)^{n-i+1}x^i\\\\\n  &=\\sum_{i=0}^{n+1}\\left( \\begin{bmatrix}n\\\\i-1\\end{bmatrix} + n\\begin{bmatrix}n\\\\i\\end{bmatrix}\\right)(-1)^{n-i+1}x^i\\\\\n  &=\\sum_{i=0}^{n+1}\\begin{bmatrix}n+1\\\\i\\end{bmatrix}(-1)^{n+1-i}x^i\n  \\end{aligned}\n  $\n\n### \u5feb\u901f\u8ba1\u7b97\n\n\u6784\u9020\u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u751f\u6210\u51fd\u6570:\n\n$\\displaystyle\n\\sum_{i=0}^n \\begin{bmatrix}n\\\\i\\end{bmatrix} x^i\n=\\prod_{i=0}^{n-1} (x+i)\n$\n\n\u500d\u589e:\n\n\u8bbe$\\displaystyle F_n(x)=\\prod_{i=0}^{n-1} (x+i)$\n\n\u90a3\u4e48$F_{2n}=F_n(x)F_n(x+n)$\n\n\u53ef\u4ee5\u9012\u5f52\u6c42\u89e3$F_n(x)$\n\n\u8003\u8651\u5feb\u901f\u8ba1\u7b97$F_n(x+n)$:\n\n\u8bbe$a_i=[x_i]F_n(x)=\\begin{bmatrix}n\\\\i\\end{bmatrix}$,(\u4e5f\u5c31\u662f\u4e0a\u4e00\u6b21\u8ba1\u7b97\u51fa\u7684\u7ed3\u679c)\n\n$\\displaystyle\n\\begin{aligned}\nF_n(x+n)\n&=\\sum_{i=0}^{n-1} a_i (x+n)^i\\\\\n&=\\sum_{i=0}^{n-1} a_i \\sum_{j=0}^i {i\\choose j} n^{i-j}x^j\\\\\n&=\\sum_{i=0}^{n-1}x^i \\sum_{j=i}^n {j\\choose i} n^{j-i} a_j\\\\\n&=\\sum_{i=0}^{n-1}\\frac{x^i}{i!} \\sum_{j=i}^n (a_j j!)\\frac{n^{j-i}}{(j-i)!}\n\\end{aligned}\n$\n\n\u8bbe$A(i)=a_i i!,B(i)=\\frac{x^i}{i!}$,\u90a3\u4e48:\n\n$\\displaystyle\n\\begin{aligned}\nF_n(x+n)\n&=\\sum_{i=0}^{n-1}\\frac{x^i}{i!} \\sum_{j=i}^n A(j)B(j-i)\\\\\n&=\\sum_{i=0}^{n-1}\\frac{x^i}{i!} \\sum_{j=0}^{n-i} A(i+j)B(j)\\\\\n&=\\sum_{i=0}^{n-1}\\frac{x^i}{i!} \\sum_{j=0}^{n-i} A'(n-i-j)B(j)\\\\\n&=\\sum_{i=0}^{n-1}\\frac{x^i}{i!} \\sum_{x+y=n-i} A'(x)B(y)\n\\end{aligned}\n$\n\n\u53ef\u4ee5\u53d1\u73b0\u540e\u9762\u662f\u5377\u79ef\u7684\u5f62\u5f0f\n\n\u6a21\u677f: \n\n[LG 5408 \u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c](https://www.luogu.com.cn/problem/P5408)\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1200000,P=167772161,G=3,Gi=55924054;\nint L,l,r[N],fac[N],inv[N];\nvoid swap(int&x,int&y){int t=x;x=y;y=t;}\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%P;\n        b>>=1,x=1ll*x*x%P;\n    }\n    return res;\n}\nvoid getL(int n){\n    for(L=1;L<n;L<<=1,++l);\n    for(int i=0;i<L;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)?(L>>1):0);\n}\nvoid ntt(int*A,int typ){\n    for(int i=0;i<L;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<L;len<<=1){\n        int Wn=pw(~typ?G:Gi,(P-1)/(len<<1));\n        for(int i=0;i<L;i+=len<<1){\n            int w=1;\n            for(int k=0;k<len;++k){\n                int t=1ll*w*A[i+k+len]%P;\n                A[i+k+len]=(A[i+k]-t+P)%P;\n                A[i+k]=(A[i+k]+t)%P;\n                w=1ll*w*Wn%P;\n            }\n        }\n    }\n    if(~typ)return;\n    for(int i=0,iL=pw(L,P-2);i<L;++i)\n        A[i]=1ll*A[i]*iL%P;\n}\nint s[N],a[N],b[N],g[N];\nvoid mul(int*f,int*g){\n    ntt(f,1),ntt(g,1);\n    for(int i=0;i<L;++i)f[i]=1ll*f[i]*g[i]%P;\n    ntt(f,-1);\n}\nvoid solve(int n){\n    if(n==1){s[1]=1;return;}\n    if(n&1){\n        solve(n-1);\n        for(int i=n;i;--i)\n            s[i]=(s[i-1]+1ll*s[i]*(n-1)%P)%P;\n        s[0]=1ll*s[0]*(n-1)%P;\n        return;\n    }\n    int m=n>>1,res=1;\n    solve(m);\n    for(int i=0;i<=m;++i)\n        a[i]=1ll*s[i]*fac[i]%P,\n        b[i]=1ll*res*inv[i]%P,\n        res=1ll*res*m%P;;\n    std::reverse(a,a+m+1);\n    getL((m+1)*2);\n    mul(a,b);\n    for(int i=0;i<=m;++i)\n        g[i]=1ll*inv[i]*a[m-i]%P;\n    mul(s,g);\n    for(int i=m+1;i<L;++i)a[i]=b[i]=g[i]=0;\n    for(int i=n+1;i<L;++i)s[i]=0;\n}\nvoid init(int n){\n    fac[0]=1;\n    for(int i=1;i<=n;++i)fac[i]=1ll*fac[i-1]*i%P;\n    inv[n]=pw(fac[n],P-2);\n    for(int i=n-1;i>=0;--i)inv[i]=1ll*inv[i+1]*(i+1)%P;\n}\nint main(){\n    int n;\n    scanf(\"%d\",&n);\n    init(n+n);\n    solve(n);\n    for(int i=0;i<=n;++i)\n        printf(\"%d \",s[i]);\n}\n```\n\n[LG 5409 \u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u00b7\u5217](https://www.luogu.com.cn/problem/P5409)\n\n### \u81ea\u7136\u6570\u5e42\u548c\n\n\u8bbe$\\displaystyle S_k(n)=\\sum_{i=1}^n i^k$\n\n$\n\\begin{aligned}\nS_k(n)\n&=\\sum_{i=1}^n i^k\\\\\n&=\\sum_{i=1}^n \\left( i^{\\underline{k}} - \\sum_{j=0}^{k-1} \\begin{bmatrix}k\\\\j\\end{bmatrix}(-1)^{k-j}i^j\\right)\\\\\n&=\\sum_{i=1}^n i^{\\underline{k}} - \\sum_{j=0}^{k-1}(-1)^{k-j}\\left( \\sum_{x=1}^n x^j \\right)\\\\\n&=\\frac{(n+1)^{\\underline{k+1}}}{k+1} - \\sum_{j=0}^{k-1} \\begin{bmatrix}k\\\\j\\end{bmatrix}(-1)^{k-j}S_j(n)\n\\end{aligned}\n$\n\n$\n\\begin{aligned}\nS_k(n)\n&=\\sum_{i=1}^n i^k\\\\\n&=\\sum_{i=1}^n \\left( i^{\\overline{k}} - \\sum_{j=0}^{k-1} \\begin{bmatrix}k\\\\j\\end{bmatrix}i^j\\right)\\\\\n&=\\sum_{i=1}^n i^{\\overline{k}} - \\sum_{j=0}^{k-1}\\left( \\sum_{x=1}^n x^j \\right)\\\\\n&=\\frac{(n+1)^{\\overline{k+1}}}{k+1} - \\sum_{j=0}^{k-1}\\begin{bmatrix}k\\\\j\\end{bmatrix}S_j(n)\n\\end{aligned}\n$\n\n\u590d\u6742\u5ea6$O(k^2)$\n\n## \u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\n\n### \u5b9a\u4e49\n\n$S(n,m)$\u8868\u793a\u628a$n$\u4e2a\u5143\u7d20\u5212\u5206\u6210$m$\u4e2a\u5b50\u96c6\u7684\u65b9\u6848\u6570\n\n\u8bb0\u4f5c$\\begin{Bmatrix}n\\\\m\\end{Bmatrix}$\n\n### \u9012\u63a8\u5f0f\n\n$$\n\\begin{Bmatrix}n\\\\m\\end{Bmatrix}\n=\\begin{Bmatrix}n-1\\\\m-1\\end{Bmatrix}\n+m\\cdot\\begin{Bmatrix}n-1\\\\m\\end{Bmatrix}\n$$\n\n(\u5206\u5230\u4e00\u4e2a\u65b0\u7684\u5b50\u96c6\u6216\u8005\u63d2\u5165\u5230\u5df2\u6709\u7684\u5b50\u96c6\u4e2d)\n\n### \u6027\u8d28\n\n$\\displaystyle\n\\begin{aligned}\n\\begin{Bmatrix}n\\\\m\\end{Bmatrix}\n&=\\frac 1{m!} \\sum_{i=0}^m(-1)^i {m\\choose i}(m-i)^n\\\\\n&=\\sum_{i=0}^m \\frac{(-1)^i}{i!}\\cdot \\frac{(m-i)^n}{(m-i)!}\n\\end{aligned}$\n\n(\u53ef\u4ee5\u770b\u505a\u8fdb\u884c\u5bb9\u65a5, \u679a\u4e3e\u591a\u5c11\u4e2a\u96c6\u5408\u662f\u7a7a\u7684, \u5176\u4f59\u7684\u96c6\u5408\u968f\u4fbf\u653e\u7f6e, \u6700\u540e\u6bcf\u4e00\u79cd\u60c5\u51b5\u4f1a\u7edf\u8ba1$m!$\u6b21)\n\n\u53ef\u4ee5\u5377\u79ef\u6c42\u89e3\n\n\n$\\displaystyle\nm^n=\\sum_{i=0}^m \\begin{Bmatrix} n\\\\i \\end{Bmatrix} m^{\\underline{i}}\n$\n\n\u8bc1\u660e:\n\n$\\displaystyle\n\\begin{aligned}\nm^n\n&=\\sum_{i=0}^m \\begin{Bmatrix} n\\\\i \\end{Bmatrix} {m\\choose i} i!\\\\\n&=\\sum_{i=0}^m \\begin{Bmatrix} n\\\\i \\end{Bmatrix} m^{\\underline{i}}\n\\end{aligned}\n$\n\n(\u53ef\u4ee5\u770b\u4f5c\u5c06$n$\u4e2a\u6c42\u653e\u5230$m$\u4e2a\u5e26\u6807\u53f7\u7684\u76d2\u5b50\u5185,\u679a\u4e3e\u54ea\u4e9b\u76d2\u5b50\u4e0d\u4e3a\u7a7a)\n\n\u53c2\u8003\u8d44\u6599:\n\n- https://zh.wikipedia.org/zh-cn/\u65af\u7279\u6797\u6570\n- https://ac.nowcoder.com/discuss/184169\n\n", "link": "/posts/\u65af\u7279\u6797\u6570/", "tags": ["\u6570\u8bba", "\u65af\u7279\u6797\u6570"], "categories": [["note"]]}, {"title": "fft\u4e0e\u5b57\u7b26\u4e32\u5339\u914d", "content": "## \u666e\u901a\u7684\u5355\u6a21\u5f0f\u4e32\u5339\u914d\n\n> \u7ed9\u5b9a\u6a21\u5f0f\u4e32$A(|A|=m)$\u3001\u6587\u672c\u4e32$B(|B|=n)$\uff0c\u9700\u8981\u6c42\u51fa\u6240\u6709\u4f4d\u7f6e$p$,\u6ee1\u8db3$B$\u4e32\u4ece\u7b2c$p$\u4e2a\u5b57\u7b26\u5f00\u59cb\u7684\u8fde\u7eed$m$\u4e2a\u5b57\u7b26\uff0c\u4e0e$A$\u4e32\u5b8c\u5168\u76f8\u540c\n\n\u5b9a\u4e49\u5339\u914d\u51fd\u6570$C(x,y)=[A(x)-B(y)]^2$,\u82e5$A$\u7684\u7b2c$x$\u4e2a\u5b57\u7b26\u4e0e$B$\u7684\u7b2c$y$\u4e2a\u5b57\u7b26\u5339\u914d,\u90a3\u4e48$C(x,y)=0$\n\n\u518d\u5b9a\u4e49\u5b8c\u5168\u5339\u914d\u51fd\u6570$\\displaystyle P(x)=\\sum_{i=0}^{m-1}[A(i)-B(x-m+i+1)]^2$,\u82e5$P(x)=0$,\u5219\u79f0$B$\u4ee5\u7b2c$x$\u4f4d\u7ed3\u675f\u7684\u8fde\u7eed$m$\u4f4d,\u4e0e$A$\u5b8c\u5168\u5339\u914d  \n\n\u548b\u4e00\u770b\u4f3c\u4e4e\u6ca1\u6709\u4ec0\u4e48\u4f18\u5316\u65b9\u6cd5  \n\n\u6211\u4eec\u7ffb\u8f6c$A$\u4e32\u5f97\u5230$S$\u4e32  \n\n\u90a3\u4e48  \n\n$\\displaystyle\n\\begin{aligned}\nP(x)\n&=\\sum_{i=0}^{m-1}[A(i)-B(x-m+i+1)]^2\\\\\n&=\\sum_{i=0}^{m-1}[S(m-i+1)-B(x-m+i+1)]^2\\\\\n&=\\sum_{i=0}^{m-1}[S(m-i+1)^2+B(x-m+i+1)^2-2S(m-i+1)B(x-m+i+1)]\\\\\n&=\\sum_{i=0}^{m-1}S(m-i+1)^2+\\sum_{i=0}^{m-1}B(x-m+i+1)^2-\\sum_{i=0}^{m-1}2S(m-i+1)B(x-m+i+1)]\n\\end{aligned}$\n\n\u7b2c\u4e00\u9879\u662f\u5b9a\u503c,\u7b2c\u4e8c\u9879\u53ef\u4ee5\u9884\u5904\u7406\u524d\u7f00\u548c\u89e3\u51b3,\u7b2c\u4e09\u9879\u53ef\u4ee5\u5377\u79ef\n \n$\\displaystyle  \\sum_{i=0}^{m-1}2S(m-i+1)B(x-m+i+1)]=\\sum_{i+j=x}2S(i)B(j)$\n\n\u8bbe$T=\\sum_{i=0}^{m-1} S(i)^2,f(x)=\\sum_{i=0}^x B(i)^2,g(x)=\\sum_{i+j=x}2S(i)B(j)$\n\n\u90a3\u4e48$P(x)=T+f(x)-f(x-m)-2g(x)$  \n\n\u8fd9\u6837\u53ef\u4ee5$O(n)$\u5f97\u5230\u6240\u6709$P(x)$\u7684\u503c  \n\n## \u5e26\u901a\u914d\u7b26\u7684\u5355\u6a21\u5f0f\u4e32\u5339\u914d  \n\n\u8bbe\u901a\u914d\u7b26\u7684\u6570\u503c\u4e3a$0$,\u5b9a\u4e49\u5339\u914d\u51fd\u6570$C(x,y)=[A(x)-B(y)]^2A(x)B(y)$,\u90a3\u4e48$\\displaystyle P(x)=\\sum_{i=0}^{m-1}[A(i)-B(x-m+i+1)]^2A(i)B(x-m+i+1)$\n\n\u6309\u7167\u5957\u8def,\u7ffb\u8f6c$A$\u4e32\u5f97\u5230$S$\u4e32:\n\n$\\displaystyle\n\\begin{aligned}\nP(x)\n&=\\sum_{i=0}^{m-1}[A(i)-B(x-m+i+1)]^2A(i)B(x-m+i+1)\\\\\n&=\\sum_{i=0}^{m-1}[S(m-i+1)-B(x-m+i+1)]^2S(m-i+1)B(x-m+i+1)\\\\\n&=\\sum_{i=0}^{m-1}S(m-i+1)^3B(x-m+i+1)+\\\\\n&\\quad\\sum_{i=0}^{m-1}B(x-m+i+1)^3S(m-i+1)-\\\\\n&\\quad2\\sum_{i=0}^{m-1}S(m-i+1)^2B(x-m+i+1)^2\n\\end{aligned}$\n\n\u5199\u4e3a\u5377\u79ef\u5f62\u5f0f:\n\n$\\displaystyle P(x)=\\sum_{i+j=x}S(i)^3B(j)+S(i)B(j)^3-2S(i)^2B(j)^2$", "link": "/posts/fft\u4e0e\u5b57\u7b26\u4e32\u5339\u914d/", "tags": ["\u5b57\u7b26\u4e32", "\u6570\u8bba"], "categories": [["note"], ["\u7b97\u6cd5", "\u5b57\u7b26\u4e32"]]}, {"title": "\u6cf0\u52d2\u5c55\u5f00\u4e0e\u6d1b\u5fc5\u8fbe\u6cd5\u5219", "content": "## \u524d\u7f6e\u77e5\u8bc6\n\n1. \u6781\u9650\n2. \u5bfc\u6570\u4e0e\u9ad8\u9636\u5bfc\u6570\n\n\u4e0b\u9762\u7b80\u5355\u4ecb\u7ecd\u4e0b\u6781\u9650\u4e0e\u5bfc\u6570\u7684\u6982\u5ff5\n\n### \u6781\u9650\n\n$\\displaystyle \\lim_{x\\to \\infty} \\frac 1x=0$\u8868\u793a\u5f53$x$\u65e0\u9650\u8d8b\u8fd1\u4e8e\u65e0\u7a77\u5927\u65f6$\\frac 1x$\u65e0\u9650\u63a5\u8fd1\u4e8e$0$\n\n$\\displaystyle \\lim_{x\\to 0} \\frac 1x=\\infty$\u8868\u793a\u5f53$x$\u65e0\u9650\u8d8b\u8fd1\u4e8e$0$\u65f6$\\frac 1x$\u65e0\u9650\u63a5\u8fd1\u4e8e\u65e0\u7a77\u5927\n\n[\u767e\u5ea6\u767e\u79d1 - \u6781\u9650 \uff08\u6570\u5b66\u672f\u8bed\uff09](https://baike.baidu.com/item/%E6%9E%81%E9%99%90/3564509)\n\n[\u7ef4\u57fa\u767e\u79d1 - \u6781\u9650](https://zh.wikipedia.org/wiki/%E6%9E%81%E9%99%90)\n\n### \u5bfc\u6570\n\n\u5bfc\u6570,\u53c8\u540d\u5fae\u5546,\u662f\u5fae\u79ef\u5206\u4e2d\u7684\u91cd\u8981\u57fa\u7840\u6982\u5ff5.\n\n\u5f53\u51fd\u6570$y=f(x)$\u7684\u81ea\u53d8\u91cf$x$\u5728\u4e00\u70b9$x_0$\u4e0a\u4ea7\u751f\u4e00\u4e2a\u589e\u91cf$\\Delta x$\u65f6,\u51fd\u6570\u8f93\u51fa\u503c\u7684\u589e\u91cf$\\Delta y=f(x+\\Delta x)-f(x)$\u4e0e\u81ea\u53d8\u91cf\u589e\u91cf$\\Delta x$\u7684\u6bd4\u503c\u5728$\\Delta x$\u8d8b\u4e8e$0$\u65f6\u7684\u6781\u9650$a$\u5982\u679c\u5b58\u5728,$a$\u5373\u4e3a\u5728$x_0$\u5904\u7684\u5bfc\u6570,\u8bb0\u4f5c$f'(x_0)$\u6216$\\frac d{dx} f(x_0)$.\n\n$\\displaystyle f'(x)=\\lim_{\\Delta x\\to 0} \\frac{\\Delta y}{\\Delta x}=\\lim_{\\Delta x\\to 0} \\frac{f(x+\\Delta x)-f(x)}{\\Delta x}$\n\n$\\displaystyle f'(x_0)=\\lim_{x\\to x_0} \\frac{f(x)-f(x_0)}{x-x_0}$\n\n![](/posts/\u6cf0\u52d2\u5c55\u5f00\u4e0e\u6d1b\u5fc5\u8fbe\u6cd5\u5219/\u5bfc\u6570.png) ![](/posts/\u6cf0\u52d2\u5c55\u5f00\u4e0e\u6d1b\u5fc5\u8fbe\u6cd5\u5219/\u5bfc\u65702.gif)\n\n(\u56fe\u7247\u6458\u81ea\u7ef4\u57fa\u767e\u79d1)\n\n[\u767e\u5ea6\u767e\u79d1 - \u5bfc\u6570](https://baike.baidu.com/item/%E5%AF%BC%E6%95%B0)\n\n[\u7ef4\u57fa\u767e\u79d1 - \u5bfc\u6570](https://zh.wikipedia.org/zh-cn/%E5%AF%BC%E6%95%B0)\n\n## \u5fae\u5206\u4e2d\u503c\u5b9a\u7406\n\n### \u7f57\u5c14\u5b9a\u7406\n\n\u5982\u679c\u51fd\u6570$f(x)$\u6ee1\u8db3:\n\n1. \u5728\u95ed\u533a\u95f4$[a,b]$\u4e0a\u8fde\u7eed\n2. \u5728\u5f00\u533a\u95f4$(a,b)$\u5185\u53ef\u5bfc\n3. $f(a)=f(b)$\n   \n\u90a3\u4e48\u5b58\u5728$f'(\\xi)=0,\\xi \\in(a,b)$\n\n![](/posts/\u6cf0\u52d2\u5c55\u5f00\u4e0e\u6d1b\u5fc5\u8fbe\u6cd5\u5219/\u7f57\u5c14\u5b9a\u7406.svg)\n\n\u51e0\u4f55\u610f\u4e49: \n\n\u5982\u679c\u5149\u6ed1\u7684\u66f2\u7ebf$\\tau: y=f(x)(x\\in [a,b])$\u7684\u4e24\u4e2a\u7aef\u70b9$A,B$\u7b49\u9ad8,\u5373\u5176\u8fde\u7ebf$AB$\u6c34\u5e73,\u5219\u5728$\\tau$\u4e0a\u5fc5\u6709\u4e00\u70b9$C(\\xi,f(\\xi))(\\xi \\in(a,b))$,$\\tau$\u5728$C$\u70b9\u7684\u5207\u7ebf\u662f\u6c34\u5e73\u7684\n\n### \u62c9\u683c\u6717\u65e5\u4e2d\u503c\u5b9a\u7406\n\n**\u62c9\u683c\u6717\u65e5\u4e2d\u503c\u5b9a\u7406**,\u4e5f\u7b80\u79f0**\u5747\u503c\u5b9a\u7406**\n\n\u7f57\u5c14\u5b9a\u7406\u7684\u6269\u5c55\n\n\u5982\u679c\u51fd\u6570$f(x)$\u6ee1\u8db3:\n\n1. \u5728\u95ed\u533a\u95f4$[a,b]$\u4e0a\u8fde\u7eed\n2. \u5728\u5f00\u533a\u95f4$(a,b)$\u5185\u53ef\u5bfc\n\n\u90a3\u4e48\u5b58\u5728$f(b)-f(a)=f'(\\xi)(b-a),\\xi \\in(a,b)$\n\n![](/posts/\u6cf0\u52d2\u5c55\u5f00\u4e0e\u6d1b\u5fc5\u8fbe\u6cd5\u5219/\u62c9\u683c\u6717\u65e5\u4e2d\u503c\u5b9a\u7406.svg)\n\n> \u8bc1\u660e:\n> \n> \u8bbe\u76f4\u7ebf$AB:y=f(a)+\\frac{f(b)-f(a)}{b-a}(x-a)$\n> \n> \u4f5c\u65b0\u7684\u51fd\u6570\n> \n> $\\displaystyle \\varphi(x)=f(x)-\\left[ f(a)+\\frac{f(b)-f(a)}{b-a}(x-a) \\right]$\n> \n> $\\varphi(x)$\u5728$[a,b]$\u4e0a\u8fde\u7eed,\u5728$(a,b)$\u4e0a\u53ef\u5bfc,\n> \n> $\\displaystyle \\varphi'(x)=f'(x)-\\frac{f(b)-f(a)}{b-a}$\n> \n> \u4e14$\\varphi(a)=0,\\varphi(b)=0$. $\\varphi(x)(x\\in [a,b])$\u7b26\u5408\u7f57\u5c14\u5b9a\u7406\u7684\u6761\u4ef6,\u6240\u4ee5$\\exist \\xi \\in (a,b)$\u4f7f\u5f97\n> \n> $\\displaystyle \\varphi'(\\xi)=f'(\\xi)-\\frac{f(b)-f(a)}{b-a}=0$\n\n### \u67ef\u897f\u4e2d\u503c\u5b9a\u7406\n\n**\u67ef\u897f\u4e2d\u503c\u5b9a\u7406**,\u4e5f\u53eb**\u62d3\u5c55\u4e2d\u503c\u5b9a\u7406**\n\n\u5982\u679c\u51fd\u6570$f(x)$\u6ee1\u8db3:\n\n1. \u5728\u95ed\u533a\u95f4$[a,b]$\u4e0a\u8fde\u7eed\n2. \u5728\u5f00\u533a\u95f4$(a,b)$\u5185\u53ef\u5bfc\n3. $g'(x)\\neq 0(\\forall x \\in (a,b))$\n\n\u5219$\\exist \\xi \\in (a,b)$,\u4f7f\u5f97:\n\n$\\displaystyle \\frac{f(b)-f(a)}{g(b)-g(a)}=\\frac{f'(\\xi)}{g'(\\xi)}$\n\n![](/posts/\u6cf0\u52d2\u5c55\u5f00\u4e0e\u6d1b\u5fc5\u8fbe\u6cd5\u5219/\u67ef\u897f\u4e2d\u503c\u5b9a\u7406.png)\n\n> \u8bc1\u660e:\n> \n> \u7531\u62c9\u683c\u6717\u65e5\u5b9a\u7406,\u5728\u6761\u4ef6$g'(x)\\neq 0$\u4e0b,\n> \n> $g(b)-g(a)=g'(\\eta)(b-a)\\neq 0,\\eta \\in (a,b)$\n> \n> \u4f5c\u51fd\u6570\n> \n> $\\displaystyle F(x)=f(x)-\\frac{f(b)-f(a)}{g(b)-g(a)}(g(x)-g(a))$\n> \n> \u6613\u8bc1$F(x)$\u5728$[a,b]$\u4e0a\u6ee1\u8db3\u6d1b\u5c14\u5b9a\u7406\u6761\u4ef6,\u4ece\u800c\u5b58\u5728$\\xi \\in(a,b)$\u4f7f\u5f97$F'(\\xi)=0$,\u5373\n> \n> $\\displaystyle f'(\\xi)=\\frac{f(b)-f(a)}{g(b)-g(a)}g'(\\xi)$\n> \n> \u7531\u4e8e$g'(\\xi)\\neq 0$,\u5f97\u5230\n> \n> $\\displaystyle \\frac{f(b)-f(a)}{g(b)-g(a)}=\\frac{f'(\\xi)}{g'(\\xi)}$\n\n## \u6cf0\u52d2\u5c55\u5f00\n\n### \u6cf0\u52d2\u516c\u5f0f\n\n\u82e5\u51fd\u6570$f(x)$\u5728\u5305\u542b$x_0$\u7684\u67d0\u4e2a\u95ed\u533a\u95f4$[a,b]$\u4e0a\u5177\u6709$n$\u9636\u5bfc\u6570,\u4e14\u5728\u5f00\u533a\u95f4$(a,b)$\u4e0a\u5177\u6709$n+1$\u9636\u5bfc\u6570,\u5219\u5bf9\u95ed\u533a\u95f4$[a,b]$\u4e0a\u4efb\u610f\u4e00\u70b9$x$,\u6210\u7acb\u4e0b\u5f0f:\n\n$\\displaystyle\n\\begin{aligned}\nf(x)\n&=\\sum_{i=0}^n \\frac{f^{(i)}(x_0)}{i!}(x-x_0)^i+R_n(x)\\\\\n&=f(x_0)+f'(x_0)(x-x_0)+\\frac{f''(x_0)}{2!}(x-x_0)^2+\\cdots+\\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n+R_n(x)\n\\end{aligned}\n$\n\n\u5176\u4e2d$\\displaystyle R_n(x)=\\frac{f^{(n+1)} (\\xi)}{(n+1)!}(x-x_0)^{n+1},\\xi \\in (x_0,x)$\n\n\u5f53$n\\to \\infty$\u65f6,$R_n(x)\\to 0$,\u53ef\u5ffd\u7565\u4e0d\u8ba1,\u53ef\u4ee5\u5f97\u5230\u51fd\u6570\u7684\u53e6\u4e00\u79cd\u8868\u73b0\u5f62\u5f0f(\u5373\u7528\u65e0\u7a77\u7ea7\u6570\u8868\u793a)\n\n> \u8bc1\u660e:\n> \n> \u8bbe$x_0<x$($x_0>x$\u7684\u60c5\u51b5\u7c7b\u4f3c),\u8bbe\u51fd\u6570\n> \n> $\\displaystyle F(t)=f(x)-\\sum_{i=0}^n \\frac{f^{(i)}(t)}{i!}(x-t)^i$\n> \n> $G(t)=(x-t)^{n+1}$\n> \n> $F(t)$\u5728$G(t)$\u5728$[x_0,x]$\u4e0a\u8fde\u7eed,\u5728$(x_0,x)$\u4e0a\u53ef\u5bfc,\u4e14\n> \n> $\\displaystyle\nF(x)=0,G(x)=0\n\\\\~\\\\\n\\begin{aligned}\nF'(t)\n&=-\\sum_{i=0}^n \\left[ \\frac{f^{(i)}(t)}{i!}(x-t)^i \\right]'\\\\\n&=-f(t)-\\sum_{i=1}^n \\left[ \\frac{f^{(i+1)}(t)}{i!}(x-t)^i - \\frac{f^{(i)}(t)} {(i-1)!}(x-t)^{i-1} \\right]\\\\\n&=-\\frac{f^{(n+1)}(t)}{n!}(x-t)^n\n\\end{aligned}\n\\\\\nG'(t)=-(n+1)(x-t)^n\n\\\\~\\\\\nF(x_0)=f(x)-\\left[ f(x_0)+f'(x_0)(x-x_0)+\\frac{f''(x_0)}{2!}(x-x_0)^2+\\cdots +\\frac{f^{(n)}(x_0)}{n!}(x-x_0)^2 \\right]\\\\\nG(x_0)=(x-x_0)^{n+1}\n$\n> \n> \u5e76\u4e14\u5728$(x_0,x)$\u4e0a$G'(t)\\neq 0$,\u6240\u4ee5$F(t)$\u548c$G(t)$\u5728$[x_0,x]$\u4e0a\u6ee1\u8db3\u67ef\u897f\u4e2d\u503c\u5b9a\u7406\n> \n> \u4ece\u800c\u5b58\u5728$\\xi \\in (x_0,x)$,\u4f7f\u5f97\n> \n> $\\displaystyle \\frac{F(x)-F(x_0)}{G(x)-G(x_0)}=\\frac{F'(\\xi)}{G'(\\xi)}$\n> \n> \u4e5f\u5c31\u662f:\n> \n> $\\displaystyle \\frac{f(x)-\\sum_{i=0}^n \\frac{f^{(i)}(t)}{i!}(x-t)^i}{(x-x_0)^> {n+1}}=\\frac{-\\frac{f^{(n+1)}(\\xi)}{n!}(x-\\xi)^n}{-(n+1)(x-\\xi)^n}=\\frac{f^{(n> +1)}(\\xi)}{(n+1)!}$\n> \n> \u6240\u4ee5:\n> \n> $\\displaystyle f(x)-\\sum_{i=0}^n \\frac{f^{(i)}(t)}{i!}(x-t)^i=\\frac{f^{(n+1)}(\\xi)}{(n+1)!}(x-x_0)^{n+1}$\n> \n> \u8fd9\u5e38\u79f0\u4e3a$f(x)$\u5728\u70b9$x_0$\u7684$n$\u9636\u6cf0\u52d2\u516c\u5f0f\n\n\u5f53$n=0$\u65f6,\u4e0a\u8ff0\u516c\u5f0f\u5c31\u662f\u62c9\u683c\u6717\u65e5\u4e2d\u503c\u516c\u5f0f,\u6545\u6cf0\u52d2\u5b9a\u7406\u5c31\u662f\u62c9\u683c\u6717\u65e5\u4e2d\u503c\u5b9a\u7406\u7684\u63a8\u5e7f\n\n### \u5e38\u7528\u51fd\u6570\u7684\u6cf0\u52d2\u5c55\u5f00\n\n1. $e^x$\n   \n   $(e^x)'=e^x$,\u5f53$x_0$\u53d6$0$\u65f6,\n\n   $\\displaystyle e^x=1+x+\\frac {x^2}{2!}+\\frac{x^3}{3!}+\\cdots$\n\n2. $\\sin x$\n   \n   $\\sin^{(n)}(x)=\\sin(x+n\\cdot \\frac{\\pi}2)$,\u5f53$x_0$\u53d6$0$\u65f6,\n\n   $\\displaystyle \\sin x=x-\\frac{x^3}{3!}+\\frac{x^5}{5!}-\\frac{x^7}{7!}+\\cdots$\n\n3. $\\cos x$\n   \n   $\\cos^{(n)}(x)=\\cos(x+n\\cdot \\frac{\\pi}2)$,\u5f53$x_0$\u53d6$0$\u65f6,\n\n   $\\displaystyle \\cos x=1-\\frac{x^2}{2!}+\\frac{x^4}{4!}-\\frac{x^6}{6!}+\\cdots$\n\n4. $\\ln (1+x)$\n\n   $\\ln^{(n)} (1+x)=(-1)^{n+1}\\frac{(n-1)!}{(1+x)^n}$,\u5f53$x_0$\u53d6$0$\u65f6,\n   \n   $\\displaystyle x-\\frac {x^2}2+\\frac {x^3}3-\\cdots+\\frac {(-1)^{n+1}}n x^{n}-\\cdots$\n\n5. $\\ln(1-x)$\n   \n   $\\ln^{(n)} (1-x)=-\\frac{(n-1)!}{(1-x)^n}$,\u5f53$x_0$\u53d6$0$\u65f6,\n   \n   $\\displaystyle -x-\\frac {x^2}2-\\frac {x^3}3-\\cdots-\\frac {x^{n}}n-\\cdots$\n6. $\\frac 1{1-x}$\n\n   $(\\frac 1{1-x})^{(n)}=\\frac{n!}{(1-x)^{n+1}}$,\u5f53$x_0$\u53d6$0$\u65f6,\n\n   $\\displaystyle 1+x+x^2+\\cdots+x^n+\\cdots \\quad \\forall x:\\left|x\\right|<1$\n\n## \u6d1b\u5fc5\u8fbe\u6cd5\u5219\n\n\u5047\u8bbe\u51fd\u6570$f(x)$\u548c$g(x)$\u6ee1\u8db3\u4e0b\u5217\u6761\u4ef6:\n\n1. $f(x)$,$g(x)$\u90fd\u5728$a$\u70b9\u7684\u67d0\u53bb\u5fc3\u90bb\u57df$\\mathring{U}(a)$\u4e0a\u53ef\u5bfc,\u4e14$g'(x)\\neq 0(\\forall x \\in \\mathring{U}(a))$\n   \n2. \u5f53$x\\to a$\u65f6$f(x)\\to 0,g(x)\\to 0$(\u6216$f(x)\\to \\infty,g(x)\\to \\infty$)\n   \n3. $\\displaystyle lim_{x\\to a}\\frac{f'(x)}{g'(x)}$\u5b58\u5728(\u4e5f\u53ef\u4ee5\u662f$\\infty$)\n\n\u5219$\\displaystyle \\lim_{x\\to a}\\frac{f(x)}{g(x)}=lim_{x\\to a}\\frac{f'(x)}{g'(x)}$\n\n> \u8bc1\u660e:\n> \n> \u7531\u4e8e$\\displaystyle \\lim_{x\\to a}\\frac{f(x)}{g(x)}$\u4e0e$f(x),g(x)$\u5728$a$\u70b9\u7684\u53d6\u503c\u65e0\u5173,\u6211\u4eec\u53ef\u4ee5\u8bbe$f(a)=0,g(a)=0$,\u5219$f(x),g(x)$\u5728$a$\u7684\u67d0\u4e00\u90bb\u57df\u5185\u8fde\u7eed\n> \n> \u8bbe$x\\in \\mathring{U}(a)$,\u7531\u5b9a\u7406\u7684\u6761\u4ef61,$f(x)$\u548c$g(x)$\u5728$[a,x]$(\u6216$[x,a]$)\u4e0a\u6ee1\u8db3\u67ef\u897f\u4e2d\u503c\u5b9a\u7406\u7684\u6761\u4ef6,\u4ece\u800c\u5b58\u5728$\\xi \\in(a,x)$(\u6216$(x,a)$),\u4f7f\u5f97\n> \n> $\\displaystyle \\frac{f(x)}{g(x)}=\\frac{f(x)-f(a)}{g(x)-g(a)}=\\frac{f'(\\xi)}{g'(\\xi)}$\n> \n> \u5f53$x\\to a$\u65f6$\\xi \\to a$,\u6240\u4ee5\n> \n> $\\displaystyle \\lim_{x\\to a} \\frac{f(x)}{g(x)}=\\lim_{x\\to a} \\frac{f'(\\xi)}{g'(\\xi)}=\\lim_{x\\to a} \\frac{f'(x)}{g'(x)}$\n\n\u5728\u6761\u4ef61,2\u4e0b,\u53ea\u8981$\\displaystyle \\lim_{x\\to a} \\frac{f'(x)}{g'(x)}=A\\text{\u6216}\\infty$,\u5219$\\displaystyle \\lim_{x\\to a} \\frac{f(x)}{g(x)}$\u5fc5\u5b58\u5728,\u4e14\u5c31\u7b49\u4e8e$A\\text{\u6216}\\infty$\n\n\u6240\u4ee5\u4e3a\u4e86\u786e\u5b9a$\\displaystyle \\lim_{x\\to a} \\frac{f(x)}{g(x)}$\u7684\u503c,\u53ea\u8981\u628a\u5206\u5b50\u3001\u5206\u6bcd\u5206\u522b\u6c42\u5bfc\u518d\u53d6\u6781\u9650,\u5728\u8fd9\u4e2a\u6781\u9650\u5b58\u5728(\u6216\u662f$\\infty$)\u7684\u60c5\u51b5\u4e0b,\u5c31\u53ef\u4ee5\u786e\u5b9a\u539f\u6765\u672a\u5b9a\u5f0f\u7684\u503c(\u6216\u662f$\\infty$)\n\n\u8fd9\u79cd\u786e\u5b9a\u672a\u5b9a\u5f0f\u7684\u503c\u5f97\u65b9\u6cd5\u79f0\u4e3a**\u6d1b\u5fc5\u8fbe\u6cd5\u5219**\n\n\u4f7f\u7528\u6d1b\u5fc5\u8fbe\u6cd5\u5219\u65f6\u5fc5\u987b\u6ce8\u610f:\n\n1. $\\displaystyle \\lim_{x\\to a} \\frac{f(x)}{g(x)}$\u5fc5\u987b\u662f$\\frac 00$\u578b\u6216$\\frac \\infty\\infty$\u578b\u7684\n   \n2. $\\displaystyle \\lim_{x\\to a} \\frac{f'(x)}{g'(x)}$\u5b58\u5728(\u6216\u662f$\\infty$),\n   \n   $\\displaystyle \\lim_{x\\to a} \\frac{f'(x)}{g'(x)}$\u4e0d\u5b58\u5728\u65f6\u9700\u8981\u7528\u5176\u4ed6\u65b9\u6cd5\u5224\u65ad\u8fd9\u4e2a\u6781\u9650\u662f\u5426\u5b58\u5728\n\n> \u9519\u8bef\u793a\u4f8b:\n> \n> \u6c42$\\displaystyle \\lim_{x\\to 0} \\frac x{1+\\sin x}$\n> \n> \u5f53$x\\to 0$\u65f6,$1+\\sin x\\to 1$,\n> \n> $\\displaystyle \\lim_{x\\to 0}\\frac x{1+sin x}=\\frac 01=0$\n> \n> \u5957\u7528\u6d1b\u5fc5\u8fbe\u6cd5\u5219,\u5c31\u4f1a\u5bfc\u81f4: \n> \n> $\\displaystyle \\lim_{x\\to 0} \\frac x{1+\\sin x}=\\lim_{x\\to 0} \\frac 1{\\cos x}=1$\n\n\u4f8b1:\n\n\u6c42$\\displaystyle \\lim_{x\\to 0}\\frac{x-\\sin x}{x^3}$\n\n\u8fd9\u662f$\\frac 00$\u578b\u672a\u5b9a\u5f0f,\u4f7f\u7528\u6d1b\u5fc5\u8fbe\u6cd5\u5219,\u6709\n\n$\\displaystyle \\lim_{x\\to 0} \\frac{x-\\sin x}{x^3}=\\lim_{x\\to 0} \\frac{1-\\cos x}{3x^2}$\n\n\u8fd8\u662f$\\frac 00$\u578b,\u518d\u6b21\u4f7f\u7528\u6d1b\u5fc5\u8fbe\u6cd5\u5219\n\n$\\displaystyle \\lim_{x\\to 0} \\frac{1-\\cos x}{3x^2}=\\lim_{x\\to 0} \\frac{\\sin x}{6x}=\\frac 16$\n\n\u4f8b2:\n\n\u6c42$\\displaystyle \\lim_{x\\to +\\infty} \\frac{x^n}{e^x}$\n\n\u8fd9\u662f$\\frac \\infty\\infty$\u578b\u672a\u5b9a\u5f0f\n\n\u63a5\u8fde\u4f7f\u7528\u6d1b\u5fc5\u8fbe\u6cd5\u5219$n$\u6b21,\u5f97\n\n$\\displaystyle \\lim_{x\\to +\\infty} \\frac{x^n}{e^x}=\\lim_{x\\to +\\infty} \\frac{nx^{n-1}}{e^x}=\\cdots=\\lim_{x\\to +\\infty} \\frac{n!}{e^x}=0$", "link": "/posts/\u6cf0\u52d2\u5c55\u5f00\u4e0e\u6d1b\u5fc5\u8fbe\u6cd5\u5219/", "tags": ["\u6570\u8bba"], "categories": [["note"]]}, {"title": "\u6570\u5b66\u5e38\u6570\u4e0e\u6b27\u62c9\u516c\u5f0f", "content": "## \u6570\u5b66\u5e38\u6570\n\n$e$,\u4f5c\u4e3a\u6570\u5b66\u5e38\u6570,\u662f\u81ea\u7136\u5bf9\u6570\u51fd\u6570\u7684\u5e95\u6570.\n\n$e$\u662f\u4e00\u4e2a\u65e0\u7406\u6570,\u5e76\u4e14\u662f\u8d85\u8d8a\u6570\n\n$e=2.71828182845904523536\\cdots$\n\n$e$\u53c8\u79f0\u81ea\u7136\u5e38\u6570\u3001\u6b27\u62c9\u6570.\n\n\u5148\u5f15\u5165\u5173\u4e8e$e$\u7684\u6709\u8da3\u95ee\u9898\n\n### \u94f6\u884c\u95ee\u9898\n\n\u4e00\u7b14\u94b1\u5b58\u5728\u5728\u94f6\u884c,\u5047\u8bbe\u8fd9\u7b14\u94b1\u4e3a$1$,\n\n\u5047\u8bbe\u4e00\u5e74\u5e74\u7ed3\u7b97\u4e00\u6b21,\u5229\u7387\u4e3a$100\\%$,,\u90a3\u4e48\u4e00\u5e74\u540e\u5f97\u5230$1+1=2$,\n\n\u5047\u8bbe\u534a\u5e74\u7ed3\u7b97\u4e00\u6b21,\u5229\u7387\u4e3a$50\\%$,\u90a3\u4e48\u4e00\u5e74\u540e\u5f97\u5230$(1+\\frac 12)^2=2.25$,\n\n\u5047\u8bbe\u6bcf\u4e2a\u6708\u7ed3\u7b97\u4e00\u6b21,\u5229\u7387\u4e3a$\\frac 1{12}$,\u90a3\u4e48\u4e00\u5e74\u540e\u5f97\u5230$(1+\\frac 1{12})^{12}=2.6130\\dots$ ,\n\n$\\vdots$\n\n\u5047\u8bbe$\\frac 1n$\u5e74\u7ed3\u7b97\u4e00\u6b21,\u4e00\u5e74\u540e\u4f1a\u5f97\u5230$(1+\\frac 1n)^n$ .\n\n\u82e5$n$\u8d8b\u8fd1\u4e8e\u65e0\u9650\u5927\u65f6,\u90a3\u4e48\u5f97\u5230\u7684\u94b1\u4f1a\u4e0d\u4f1a\u65e0\u9650\u591a\u5462\uff1f\n\n\u7b54\u6848\u662f\u4e0d\u4f1a,\u4e0d\u7ba1$n$\u600e\u4e48\u589e\u957f,\u5f97\u5230\u7684\u94b1\u90fd\u4e0d\u4f1a\u8d85\u8fc7$e$,\n\n$\\displaystyle e=\\lim_{n\\to\\infty} (1+\\frac 1n)^n$\n\n### \u7ec6\u83cc\u7e41\u6b96\n\n\u5047\u8bbe\u6709\u4e00\u79cd\u7ec6\u83cc\u4e00\u5929\u4f1a\u5206\u88c2\u4e00\u6b21,\n\n\u5982\u679c\u7ec6\u83cc\u521d\u59cb\u6570\u91cf\u4e3a$1$,\u7ecf\u8fc7$x$\u5929\u540e\u7684\u7ec6\u83cc\u6570\u91cf\u4e3a$2^x$\n\n\u6211\u4eec\u628a\u5206\u88c2\u770b\u6210\u589e\u52a0$100\\%$,\u90a3\u4e48\u4e0a\u5f0f\u53ef\u5199\u4e3a$(1+100\\%)^2$\n\n\u6211\u4eec\u7ee7\u7eed\u5047\u5b9a\uff1a\u6bcf\u8fc7$12$\u4e2a\u5c0f\u65f6,\u4e5f\u5c31\u662f\u5206\u88c2\u8fdb\u884c\u5230\u4e00\u534a\u7684\u65f6\u5019,\u65b0\u4ea7\u751f\u7684\u90a3\u534a\u4e2a\u7ec6\u80de\u5df2\u7ecf\u53ef\u4ee5\u518d\u6b21\u5206\u88c2\u4e86.\n\n\u56e0\u6b64,\u4e00\u5929$24$\u4e2a\u5c0f\u65f6\u53ef\u4ee5\u5206\u6210\u4e24\u4e2a\u9636\u6bb5,\u6bcf\u4e00\u4e2a\u9636\u6bb5\u90fd\u5728\u524d\u4e00\u4e2a\u9636\u6bb5\u7684\u57fa\u7840\u4e0a\u589e\u957f$50\\%$.\n\n$(1+\\frac 12)^2=2.25$\n\n\u90a3\u4e48\u4e00\u5929\u540e\u5f97\u5230\u4e86$2.25$\u4e2a\u7ec6\u80de\n\n\u5047\u8bbe\u5206\u88c2\u662f\u8fde\u7eed\u4e0d\u65ad\u8fdb\u884c\u7684,\u65b0\u751f\u7ec6\u80de\u6bcf\u5206\u6bcf\u79d2\u90fd\u5177\u5907\u7ee7\u7eed\u5206\u88c2\u7684\u80fd\u529b,\u90a3\u4e48\u4e00\u5929\u6700\u591a\u53ef\u4ee5\u5f97\u5230\u591a\u5c11\u4e2a\u7ec6\u80de\u5462?\n\n$(1+\\frac 1n)^n=?$\n\n\u5f53$n$\u8d8b\u8fd1\u4e8e\u65e0\u9650\u5927\u65f6,$\\displaystyle \\lim_{n\\to\\infty} (1+\\frac 1n)^n=e$\n\n\u7ecf\u8fc7\u8ba1\u7b97$e=2.71828182845904523536\\cdots$\n\n\u8fd9\u4e5f\u5c31\u662f\u662f$e$\u7684\u542b\u4e49:\u5355\u4f4d\u65f6\u95f4\u5185,\u6301\u7eed\u7684\u7ffb\u500d\u589e\u957f\u6240\u80fd\u8fbe\u5230\u7684\u6781\u9650\u503c.\n\n$e$\u662f\u81ea\u7136\u589e\u957f\u7684\u6781\u9650,\u56e0\u6b64\u4ee5e\u4e3a\u5e95\u7684\u5bf9\u6570,\u5c31\u53eb\u505a\u81ea\u7136\u5bf9\u6570.\n\n### \u5b9a\u4e49\n\n1. $\\displaystyle e=\\lim_{n\\to\\infty} (1+\\frac 1n)^n$\n\n   $\\displaystyle e=\\lim_{t\\to 0} (1+\\frac 1t)^{\\frac 1t}$($t\\to 0$\u65f6,$\\frac 1t\\to\\infty$)\n\n2. $e$\u4e3a\u9636\u4e58\u5012\u6570\u4e4b\u65e0\u7a77\u7ea7\u6570\u7684\u548c\n\n   $\\displaystyle e=\\sum_{n=0}^{\\infty} \\frac 1{n!}=\\frac 1{0!}+\\frac 1{1!}+\\frac 1{2!}+\\frac 1{3!}+\\cdots$\n\n### $e$\u7684\u8ba1\u7b97\n\n$\\displaystyle\n\\begin{aligned}\ne\n&=\\lim_{n\\to\\infty} (1+\\frac 1n)^n\\\\\n&=\\lim_{n\\to\\infty} \\sum_{i=0}^n {n\\choose i} 1^{n-i}\\left(\\frac 1n\\right)^i\\\\\n&=\\lim_{n\\to\\infty} \\left[ {n\\choose 0}1^n \\left(\\frac 1n\\right)^0 + {n\\choose 1}1^{n-1} \\left(\\frac 1n\\right)^1 + {n\\choose 2}1^{n-2} \\left(\\frac 1n\\right)^2 + {n\\choose 3}1^{n-3} \\left(\\frac 1n\\right)^3 + \\cdots + {n\\choose n}1^0 \\left(\\frac 1n\\right)^n \\right]\\\\\n&=\\lim_{n\\to\\infty} \\left[ 1\\times 1 + n \\times \\frac 1n + \\frac{n!}{(n-2)!2!}\\times \\frac 1{n^2} + \\frac{n!}{(n-3)!3!}\\times \\frac 1{n^3} + \\cdots + 1\\times \\frac n{n!} \\right]\\\\\n&=\\lim_{n\\to\\infty}\\left[1+1+\\frac{n\\times \\left(n-1\\right)}{2n^2}+\\frac{n\\times \\left(n-1\\right)\\left(n-2\\right)}{3\\times 2n^3}+\\cdots+\\frac 1{n^n}\\right]\\\\\n&=1+1+\\frac 1{2!}+\\frac 1{3!}+\\cdots\\\\\n&=2.71828182845904523536\\cdots\n\\end{aligned}\n$\n\n\u6536\u655b\u8bc1\u660e:\n\n$\\displaystyle\n\\begin{aligned}\ne\n&=1+1+\\frac 1{2!}+\\frac 1{3!}+\\cdots\\\\\n&<1+1+\\frac 12+\\frac 1{2^2}+\\cdots+\\frac 1{2^{n-1}}\\\\\n&=1+\\frac{1-\\left( \\frac 12 \\right)^n}{1-\\frac 12}\\\\\n&=1+2\\left[1-\\left( \\frac 12 \\right)^n \\right]\\\\\n&<3\n\\end{aligned}\n$\n\n### \u6027\u8d28\n\n\n1. $e$\u4e3a\u552f\u4e00\u7684\u6b63\u6570$x$\u4f7f:\n\n   $\\displaystyle \\int_1^x{\\frac{\\mathrm {d} t}t}=1$\n\n2. $e$\u4e3a\u552f\u4e00\u7684\u5b9e\u6570$x$\u4f7f:\n\n   $\\displaystyle \\lim_{h\\to 0} \\frac{x^h-1}h=1$\n\n   > \u8bc1\u660e:\n   > \n   > $x\\to 0$\u65f6$\\ln(1+x)\\sim x$ ($\\sim$\u4ee3\u8868\u7b49\u4ef7\u4e8e)\n   > \n   > \u8bbe$u=u(x)=\\begin{cases}\n   >    (1+x)^{\\frac 1x} , &x\\neq 0, x>-1\\\\\n   >    e,&x=0\n   > \\end{cases}$\n   > \n   > $\\displaystyle \\lim_{x\\to 0}u(x)=\\lim_{x\\to 0}(1+x)^{\\frac 1x}=e=u(0)$\n   > \n   > \u6240\u4ee5$u$\u5728$x=0$\u70b9\u4e5f\u8fde\u7eed,$u(x)$\u662f$(-1,+\\infty)$\u4e0a\u7684\u8fde\u7eed\u51fd\u6570,\u6545$\\ln u(x)$\u4e5f\u662f$(-1,+\\infty)$\u4e0a\u7684\u8fde\u7eed\u51fd\u6570,\u90a3\u4e48\n   > \n   > $\\displaystyle\n   > \\begin{aligned}\n   > \\lim_{x\\to 0} \\frac{\\ln(1+x)}x\n   > &=\\lim_{x\\to 0} \\ln~(1+x)^{\\frac 1x}\\\\\n   > &=\\lim_{x\\to 0} \\ln u(x)\\\\\n   > &=\\ln u(0)=\\ln e\\\\\n   > &=1\n   > \\end{aligned}\n   > $\n   > \n   > \u6240\u4ee5$x\\to 0$\u65f6$\\ln(1+x)\\sim x$\n   > \n   > \u82e5\u8bb0$t=\\ln (1+x)$,\u5219$x=e^t-1$\n   > \n   > $x\\to 0$\u7b49\u4ef7\u4e8e$t\\to 0$,\n   > \n   > \u6240\u4ee5\u5f53$t\\to 0$\u65f6,$e^t-1\\sim t$\n\n3. $e^x$\u7684\u5bfc\u6570\u8fd8\u662f$e^x$\n   \n   > \u8bc1\u660e:\n   > \n   > $\\displaystyle\n   > \\begin{aligned}\n   > \\frac{\\mathrm{d}}{\\mathrm{d}x}e^x\n   > &=\\lim_{\\Delta x\\to 0} \\frac{e^{x+\\Delta x-e^x}}{\\Delta x}\\\\\n   > &=e^x \\lim_{\\Delta x\\to 0} \\frac{e^{\\Delta x}-1}{\\Delta x}\n   > \\end{aligned}\n   > $\n   > \n   > \u6839\u636e2,$\\frac{e^{\\Delta x}-1}{\\Delta x}=1$,\u6240\u4ee5\n   > \n   > $\\displaystyle \\frac{\\mathrm{d}}{\\mathrm{d}x}e^x=e^x$\n\n## \u6b27\u62c9\u516c\u5f0f\n\n$e^{ix}=\\cos x+i\\sin x$\n\n\u5f53$x=\\pi$\u65f6,\u6b27\u62c9\u516c\u5f0f\u53d8\u4e3a$e^{i\\pi}+1=0$,\u5373\u6b27\u62c9\u6052\u7b49\u5f0f\n\n\u6b27\u62c9\u6052\u7b49\u5f0f,\u88ab\u8a89\u4e3a\u4e0a\u5e1d\u516c\u5f0f,$e$\u3001$\\pi$\u3001$i$\u3001\u4e58\u6cd5\u5355\u4f4d\u51431\u3001\u52a0\u6cd5\u5355\u4f4d\u51430,\u8fd9\u4e94\u4e2a\u91cd\u8981\u7684\u6570\u5b66\u5143\u7d20\u5168\u90e8\u88ab\u5305\u542b\u5728\u5185,\u5728\u6570\u5b66\u7231\u597d\u8005\u773c\u91cc,\u4eff\u4f5b\u4e00\u884c\u8bd7\u9053\u5c3d\u4e86\u6570\u5b66\u7684\u7f8e\u597d.\n\n### \u8bc1\u660e\n\n\u628a\u51fd\u6570$e^x,\\sin x,\\cos x$\u5199\u6210\u6cf0\u52d2\u7ea7\u6570\u5f62\u5f0f\uff1a\n\n$\\displaystyle\ne^x=1+x+\\frac {x^2}{2!}+\\frac{x^3}{3!}+\\cdots\n\\\\~\\\\\n\\cos x=1-\\frac{x^2}{2!}+\\frac{x^4}{4!}-\\frac{x^6}{6!}+\\cdots\n\\\\~\\\\\n\\sin x=x-\\frac{x^3}{3!}+\\frac{x^5}{5!}-\\frac{x^7}{7!}+\\cdots\n$\n\n\u90a3\u4e48:\n\n$\n\\begin{aligned}\ne^{ix}\n&=1+ix+\\frac{i^2x^2}{2!}+\\frac{i^3x^3}{3!}+\\frac{i^4x^4}{4!}+\\frac{i^5x^5}{5!}+\\frac{i^6x^6}{6!}+\\frac{i^7x^7}{7!}+\\cdots\\\\~\\\\\n&=1+ix-\\frac{x^2}{2!}-\\frac{ix^3}{3!}+\\frac{x^4}{4!}+i\\frac{x^5}{5!}-\\frac{x^6}{6!}-i\\frac{x^7}{7!}\\\\~\\\\\n&=(1-\\frac{x^2}{2!}+\\frac{x^4}{4!}-\\frac{x^6}{6!}+\\cdots)+i(x-\\frac{x^3}{3!}+\\frac{x^5}{5!}-\\frac{x^7}{7!}+\\cdots)\\\\~\\\\\n&=\\cos x + i\\sin x\n\\end{aligned}\n$\n\n\u5f53$x=\\pi$\u65f6:\n\n$e^{i\\pi}=\\cos\\pi + i\\sin\\pi=-1$\n\n\u6240\u4ee5:\n\n$e^{i\\pi}+1=0$\n\n\u8bc1\u6bd5.\n\n### \u56fe\u50cf\n\n![](/posts/\u6570\u5b66\u5e38\u6570\u4e0e\u6b27\u62c9\u516c\u5f0f/Axis.svg)", "link": "/posts/\u6570\u5b66\u5e38\u6570\u4e0e\u6b27\u62c9\u516c\u5f0f/", "tags": ["\u6570\u8bba"], "categories": [["note"]]}, {"title": "\u56de\u6eda\u83ab\u961f", "content": "\u6709\u4e00\u7c7b\u666e\u901a\u83ab\u961f\u4e0d\u53ef\u89e3\u7684\u95ee\u9898\u5c31\u662f\u5728\u8f6c\u79fb\u533a\u95f4\u8fc7\u7a0b\u4e2d,\u53ef\u80fd\u51fa\u73b0\u5220\u70b9\u6216\u52a0\u70b9\u64cd\u4f5c\u5176\u4e2d\u4e4b\u4e00\u65e0\u6cd5\u5b9e\u73b0\u7684\u95ee\u9898,\u8fd9\u65f6\u53ef\u4ee5\u4f7f\u7528\u56de\u6eda\u83ab\u961f\u7b97\u6cd5\n\n\n\n", "link": "/posts/\u56de\u6eda\u83ab\u961f/", "tags": ["\u83ab\u961f", "\u56de\u6eda\u83ab\u961f"], "categories": [["note"], ["\u7b97\u6cd5", "\u79bb\u7ebf"]]}, {"title": "\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5", "content": "\u5e73\u9762\u4e0a$n+1$\u4e2a\u70b9\u53ef\u4ee5\u786e\u5b9a\u4e00\u4e2a$n$\u6b21\u591a\u9879\u5f0f$F(x)$\n\n\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5\u53ef\u4ee5\u6839\u636e$n+1$\u4e2a\u70b9\u786e\u5b9a\u4e00\u4e2a$n$\u6b21\u591a\u9879\u5f0f\n\n\u8bbe\u8fd9$n$\u4e2a\u70b9\u4e3a$(x_0,y_0),(x_1,y_1),\\cdots,(x_n,y_n)$\n\n\u6784\u9020\u591a\u9879\u5f0f $\\displaystyle \\ell_i(x)=\\prod_{j=0,i\\neq j}^n \\frac{x-x_j}{x_i-x_j}$\n\n\u53ef\u4ee5\u53d1\u73b0$\\ell_i(x)$\u53ea\u6709\u5728$x_i$\u65f6\u53d6\u503c\u4e3a$1$,\u5728\u5176\u4ed6\u70b9\u53d6\u503c\u4e3a$0$\n\n\u6784\u9020\u591a\u9879\u5f0f$\\displaystyle F(x)=\\sum_{i=0}^n y_i\\ell_i(x)$\n\n\u90a3\u4e48$F(x_i)=y_i$,\u4e5f\u5c31\u662f\u4fdd\u8bc1$F$\u7ecf\u8fc7\u8fd9$n$\u4e2a\u70b9\n\n\u590d\u6742\u5ea6:$O(n^2)$", "link": "/posts/\u62c9\u683c\u6717\u65e5\u63d2\u503c\u6cd5/", "tags": ["\u6570\u8bba", "\u591a\u9879\u5f0f", "\u62c9\u683c\u6717\u65e5\u63d2\u503c"], "categories": [["note"], ["\u7b97\u6cd5", "\u6570\u8bba"]]}, {"title": "\u539f\u6839", "content": "## \u9636: \n \n\u5b9a\u4e49:\n\n\u8bbe$m>1$\u4e14$\\gcd(a,m)=1$,\u90a3\u4e48\u4f7f\u5f97$a^r \\equiv 1 \\pmod m$\u6210\u7acb\u7684\u6700\u5c0f\u7684\u6b63\u6574\u6570$r$\u79f0\u4e3a$a$\u5bf9\u6a21$m$\u7684\u9636,\u8bb0\u4e3a$\\delta_m(a)$,\u6216$ord_m a$\n \n\u5b9a\u7406:\n\n1. \u82e5$m>1$\u4e14$gcd(a,m)=1$,\u6ee1\u8db3$a^n\\equiv 1 \\pmod m$,\u90a3\u4e48$\\delta_m(a)|n$.~~\u663e\u7136~~\n   \n2. $\\delta_m(a) | \\varphi(m)$\n   > \u8bc1\u660e:\n   > \n   > \u6b27\u62c9\u5b9a\u7406: $a^{\\varphi(m)}\\equiv 1\\pmod m$\n   > \n   > $\\therefore \\delta_m(a)\\le \\varphi(m)$\n   > \n   > $\\therefore \\delta_m(a) | \\varphi(m)$\n\n3. \u82e5$\\gcd(a,m)=1$,\u90a3\u4e48$a^i\\equiv a_j\\pmod m$,\u5f53\u4e14\u4ec5\u5f53$i\\equiv j\\pmod{\\delta_m a}$\n   \n4. \u82e5$\\delta_m a=t$,\u90a3\u4e48$\\displaystyle \\delta_ma^u=\\frac t{\\gcd(t,u)}$\n   \n5. $a^0,a^1,a^2,\\dots,a^{\\delta_m a -1}$\u6a21$m$\u4e24\u4e24\u4e0d\u540c\u4f59\u3002\n\n## \u539f\u6839\n\n### \u5b9a\u4e49\n\n\u8bbe$m$\u662f\u6b63\u6574\u6570,$a$\u662f\u6574\u6570,\n\n\u82e5$\\delta_m(a)=\\varphi(m)$,\u5219\u79f0$a$\u4e3a\u6a21$m$\u7684\u4e00\u4e2a\u539f\u6839\n\n### \u5224\u65ad\u662f\u5426\u6709\u539f\u6839\n\n\u82e5$m$\u6709\u539f\u6839,\u90a3\u4e48$m=2,4,p^k,2p^k$(\u5145\u8981\u6761\u4ef6)($p$\u4e3a\u7d20\u6570)\n\n### \u6c42\u539f\u6839\n\n\u539f\u6839\u4e00\u822c\u90fd\u5f88\u5c0f,\u53ef\u4ee5\u901a\u8fc7\u76f4\u63a5\u679a\u4e3e\u7136\u540e\u5224\u65ad\u662f\u5426\u662f\u539f\u6839\n\n\u6c42\u6700\u5c0f\u539f\u6839:\n\n\u679a\u4e3e$g$,\u4f7f$\\gcd(g,m)=1$,\u8bbe$p_1,p_2,\\dots,p_k$\u4e3a$\\varphi(m)$\u7684\u6240\u6709\u4e0d\u540c\u8d28\u56e0\u6570,\u82e5$g$\u662f$m$\u7684\u539f\u6839,\u90a3\u4e48$\\forall 1\\le i \\le k, g^{\\frac{\\varphi(m)}{p_i}} \\not = 1$\n\n> \u82e5\u4e00\u4e2a\u6570$m$\u5b58\u5728\u539f\u6839,\u53ef\u4ee5\u8bc1\u660e$m$\u7684\u6700\u5c0f\u539f\u6839\u5728$m^{0.25}$\u7ea7\u522b.\n>\n> \u8fd9\u4e2a\u7ed3\u8bba\u610f\u5473\u7740,\u6211\u4eec\u6c42\u6240\u6709\u7684\u539f\u6839\u65f6,\u679a\u4e3e\u6700\u5c0f\u539f\u6839\u82b1\u8d39\u7684\u65f6\u95f4\u4e00\u822c\u90fd\u662f\u53ef\u4ee5\u63a5\u53d7\u7684.\n\n\u6c42\u6240\u6709\u539f\u6839:\n\n\u8bbe$g$\u4e3a$m$\u7684\u4e00\u4e2a\u539f\u6839,\u5219\u96c6\u5408$S={g^i|1\\le i\\le \\varphi(m),\\gcd(i,\\varphi(m))=1}$\u4e3a$m$\u7684\u6240\u6709\u539f\u6839.\n\n\u56e0\u6b64,\u82e5$m$\u6709\u539f\u6839,\u90a3\u4e48$m$\u6709$\\varphi(\\varphi(m))$\u4e2a\u5173\u4e8e\u6a21$m$\u4e24\u4e24\u4e92\u4e0d\u540c\u4f59\u7684\u539f\u6839\n\n### \u6027\u8d28\n\n1. \u7d20\u6570\u90fd\u662f\u539f\u6839\n   \n2. \u6ee1\u8db3fft\u4e2d\u5355\u4f4d\u6839\u7684\u6027\u8d28,\u53ef\u4ee5\u7528\u4e8e[ntt](../ntt)(\u5feb\u901f\u6570\u8bba\u53d8\u6362)\n\n3. \u8bbe$g$\u4e3a$m$\u7684\u4e00\u4e2a\u539f\u6839\n   \n   $g^0,g^1,g^2,\\dots,g^{\\varphi(m)-1}$\u6784\u6210\u6a21$m$\u7684\u7b80\u5316\u5269\u4f59\u7cfb\n\n## \u4f8b\u9898\n\n[\\[SDOI2015\\]\u5e8f\u5217\u7edf\u8ba1](https://www.luogu.com.cn/problem/P3321)\n\n\u539f\u6839\u5c06\u4e58\u6cd5\u8f6c\u52a0\u6cd5\u7684\u5e94\u7528\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u5e8f\u5217\u4e2d\u6240\u6709\u6570\u53d8\u6210\u539f\u6839\u7684\u6b21\u5e42,\n\n\u90a3\u4e48\u5e8f\u5217\u4e2d\u6240\u6709\u6570\u7684\u4e58\u79ef\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a\u4ed6\u4eec\u7684\u548c\n\n\u8bbe\u8fd9\u4e2a\u548c\u4e3a$sum$\n\n\u8bbe\u751f\u6210\u51fd\u6570:$\\displaystyle f(x)=\\sum_{i=0}^m [i\\in S]x^i$\n\n\u53ef\u4ee5\u53d1\u73b0$f(x)^n$\u6b21\u6570\u4e3a$sum$\u7684\u90a3\u4e00\u9879\u7684\u7cfb\u6570\u5c31\u662f\u7b54\u6848\n\n\u4f7f\u7528\u5feb\u901f\u5e42+\u5feb\u901f\u6570\u8bba\u53d8\u6362\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=3000010,P=1004535809,G=3,Gi=334845270;\nint n,m,X,S,f[N],F[N],l,r[N],b[N],L;\nvoid mod(int&x){if(x>=P)x-=P;}\nvoid swap(int&x,int&y){x^=y,y^=x,x^=y;}\nint pw(int x,int b,int p=P){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return res;\n}\nvoid ntt(int*A,int typ){\n    for(int i=0;i<L;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<L;len<<=1){\n        int Wn=pw(~typ?G:Gi,(P-1)/(len<<1));\n        for(int i=0;i<L;i+=len<<1){\n            int w=1;\n            for(int k=0;k<len;++k){\n                int t=1ll*w*A[i+k+len]%P;\n                mod(A[i+k+len]=A[i+k]-t+P);\n                mod(A[i+k]+=t);\n                w=1ll*w*Wn%P;\n            }\n        }\n    }\n    if(~typ)return;\n    int inv=pw(L,P-2);\n    for(int i=0;i<L;++i)\n        A[i]=1ll*A[i]*inv%P;\n}\nint a[N],tt;\nint getg(){\n    for(int i=2;i<=m-2;++i)\n        if((m-1)%i==0)a[++tt]=i;\n    for(int i=2;;++i){\n        bool ff=1;\n        for(int j=1;j<=tt;++j)\n            if(pw(i,a[j],m)==1){ff=0;break;}\n        if(ff)return i;\n    }\n}\nint main(){\n    scanf(\"%d%d%d%d\",&n,&m,&X,&S);\n    for(int i=1,x=1,g=getg();i<=m-2;++i)\n        b[x=1ll*x*g%m]=i;\n    for(int i=1,t;i<=S;++i){\n        scanf(\"%d\",&t);\n        if(t)F[b[t]]=1;\n    }\n    \n    for(L=1;L<m;L<<=1,++l);\n    L<<=1,++l;\n\n    for(int i=0;i<L;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    f[0]=1;\n    while(n){\n        ntt(F,1);\n        if(n&1){\n            ntt(f,1);\n            for(int i=0;i<L;++i)\n                f[i]=1ll*f[i]*F[i]%P;\n            ntt(f,-1);\n            for(int i=L-1;i>=m-1;--i)\n                mod(f[i-m+1]+=f[i]),f[i]=0;\n        }\n        n>>=1;\n        for(int i=0;i<L;++i)\n            F[i]=1ll*F[i]*F[i]%P;\n        ntt(F,-1);\n        for(int i=L-1;i>=m-1;--i)\n            mod(F[i-m+1]+=F[i]),F[i]=0;\n    }\n    printf(\"%d\\n\",f[b[X]]);\n}\n```\n\n[ZOJ 3998 Yet Another Data Structure Problem](https://zoj.pintia.cn/problem-sets/91827364500/problems/91827370149)\n\n\u9898\u610f:\n\n\u7ed9\u4e00\u4e2a\u5e8f\u5217A,\u8981\u6c42\u652f\u6301\u4ee5\u4e0b\u64cd\u4f5c:\n\n1. \u533a\u95f4\u4e58\n   \n2. \u533a\u95f4\u91cc\u6240\u6709\u6570\u90fd\u53d8\u6210\u81ea\u5df1\u7684$k$\u6b21\u5e42\n   \n3. \u6c42\u533a\u95f4\u4e58\u79ef(mod 10000000007)\n\n\u7531\u4e8e\u6a21\u6570\u662f\u8d28\u6570,\u6240\u4ee5\u53ef\u4ee5\u5c06\u6bcf\u4e2a\u6570\u90fd\u53d8\u6210\u539f\u6839\u7684\u6b21\u5e42\n\n\u8fd9\u6837\u533a\u95f4\u4e58\u8f6c\u5316\u4e3a\u533a\u95f4\u52a0,\u533a\u95f4\u6b21\u5e42\u8f6c\u5316\u4e3a\u533a\u95f4\u4e58,\u6c42\u533a\u95f4\u4e58\u79ef\u8f6c\u5316\u4e3a\u6c42\u533a\u95f4\u548c\n\n\n\n\n\u63a8\u8350:\n\nhttps://zh.wikipedia.org/wiki/\u539f\u6839\n\nhttp://tonyfang.is-programmer.com/posts/205326.html", "link": "/posts/\u539f\u6839/", "tags": ["\u6570\u8bba", "\u539f\u6839"], "categories": [["note"], ["\u7b97\u6cd5", "\u6570\u8bba"]]}, {"title": "\u5e38\u89c1\u6570\u8bba\u7b26\u53f7\u53ca\u542b\u4e49", "content": "\u521a\u5165\u95e8\u6570\u8bba\u7684OIer\u6709\u53ef\u80fd\u88ab\u6570\u8bba\u7b26\u53f7\u6574\u7684\u4e00\u8138\u61f5\u903c,\u4e00\u4e0b\u7279\u5730\u6574\u7406\u4e86\u5e38\u7528\u7684\u6570\u8bba\u7b26\u53f7\u53ca\u5176\u542b\u4e49\n\n1. \u7ec4\u5408\u6570: $n\\choose m$ \u6216 $C_n^m$\n\n2. \u83ab\u6bd4\u4e4c\u65af\u51fd\u6570: $\\mu$\n   \n3. \u6b27\u62c9\u51fd\u6570: $\\varphi$\u6216$\\varPhi$\n   \n4. \u9636: $a$\u5173\u4e8e\u6a21$m$\u7684\u9636,\u8bb0\u4f5c$\\delta_m a$\u6216$ord_m a$\n\n5. \u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570: $\\begin{bmatrix}n\\\\m\\end{bmatrix}$\n   \n6. \u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570: $\\begin{Bmatrix}n\\\\m\\end{Bmatrix}$\n   \n7. \u6700\u5927\u516c\u7ea6\u6570: $\\gcd(n,m)$\u6216\u7b80\u5199\u4e3a$(n,m)$\n   \n8. \u6700\u5c0f\u516c\u500d\u6570: $lcm(n,m)$\u6216\u7b80\u5199\u4e3a$[n,m]$\n   \n9. \u5411\u4e0b\u53d6\u6574: $\\left\\lfloor x \\right\\rfloor$ \n    \n10. \u5411\u4e0a\u53d6\u6574: $\\left\\lceil x \\right\\rceil$ \n    \n11. \u6c42\u548c\u7b26\u53f7: $\\sum$\n    \n12. \u8fde\u4e58\u7b26\u53f7: $\\prod$\n    \n13. \u9636\u4e58\u7b26\u53f7: $x!$\n    \n14. \u4efb\u610f: $\\forall$\n    \n15. \u5b58\u5728: $\\exist$", "link": "/posts/\u6570\u8bba\u5e38\u89c1\u7b26\u53f7\u53ca\u542b\u4e49/", "tags": ["\u6570\u8bba"], "categories": []}, {"title": "\u7ec4\u5408\u6570", "content": "## \u5b9a\u4e49\n\n\u4ece$n$\u4e2a\u5143\u7d20\u4e2d\u53d6\u51fa$m$\u4e2a\u7684\u65b9\u6848\u6570,\u8bb0\u4e3a$n\\choose m$\u6216$C_n^m$\n\n$$\n{n\\choose m}=\\frac{n!}{m!(n-m)!}\n$$\n\n## \u5e15\u65af\u5361\u6cd5\u5219\n\n$$\n{n-1\\choose m}+{n-1\\choose m-1}={n\\choose m}\n$$\n\n\u8bc1\u660e:\n\n1. \u7ec4\u5408\u6570\u5b66\u4e0a\u7684\u610f\u4e49\u4e0e\u8bc1\u660e\n   \n   ${n\\choose m}$\u8868\u793a\u5728\u6709$n$\u4e2a\u5143\u7d20\u7684\u96c6\u5185,\u6709$m$\u4e2a\u5143\u7d20\u7684\u5b50\u96c6\u7684\u6570\u76ee\u3002\n   \n   \u8fd9\u4e9b\u5b50\u96c6\u4e4b\u4e2d,\u53ef\u5206\u4e3a\u5305\u542b\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u548c\u4e0d\u542b\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u3002\n   \n   \u5305\u542b\u7b2c\u4e00\u4e2a\u5143\u7d20\u7684\u5b50\u96c6\u6709${n-1 \\choose m-1}$\u4e2a,\u4e0d\u542b\u7684\u6709${n-1 \\choose m}$\u4e2a\u3002\n\n2. \u4ee3\u6570\u8bc1\u660e\n\n## \u4e8c\u9879\u5f0f\u5b9a\u7406\n\n$\\displaystyle\n(x+y)^n={n\\choose 0}x^ny^0 + {n\\choose 1}x^{n-1}y^1+{n\\choose 2}x^{n-2}y^2+\\dots+{n\\choose n}x^0y^n\n\\\\~\\\\\n(x+y)^n\n=\\sum_{i=0}^n{n\\choose i}x^{n-i}y^i\n=\\sum_{i=0}^n{n\\choose i}x^iy^{n-i}\n\\\\~\\\\\n(1+x)^n=\\sum_{i=0}^n{n\\choose i}x^i\n$\n\n\u8bc1\u660e(\u6570\u5b66\u5f52\u7eb3\u6cd5):\n\n", "link": "/posts/\u7ec4\u5408\u6570/", "tags": ["\u6570\u8bba", "\u7ec4\u5408\u6570"], "categories": [["note"]]}, {"title": "\u751f\u6210\u51fd\u6570", "content": "\u63a8\u8350:\n- https://www.cnblogs.com/zwfymqz/p/10521686.html\n- https://rqy.moe/Algorithms/generating-function/\n\n## \u5b9a\u4e49\n\n\u751f\u6210\u51fd\u6570\u53c8\u79f0\u6bcd\u51fd\u6570\n\n\u8bbe\u5e8f\u5217$a$\u4e3a$a_0,a_1,a_2,\\dots$\n\n\u5219$g(x)=a_0+a_1x+a_2x^2+a_3x^3+\\dots$\u4e3a\u5e8f\u5217$a$\u7684\u751f\u6210\u51fd\u6570\n\n## \u666e\u901a\u751f\u6210\u51fd\u6570\n\n\u666e\u901a\u578b\u751f\u6210\u51fd\u6570\uff08ordinary generating function, \u7b80\u79f0OGF\uff09\n\n\u5f62\u5982$\\displaystyle G(x)=\\sum_{i=0}^na_ix_i$\u7684\u8868\u793a\u4e00\u4e2a\u5e8f\u5217\u7684\u591a\u9879\u5f0f\u51fd\u6570,\u6211\u4eec\u79f0\u4e4b\u4e3a\u666e\u901a\u751f\u6210\u51fd\u6570\n\n### \u4f7f\u7528\u4f8b\n\n1. > \u67091\u514b\u30012\u514b\u30013\u514b\u30014\u514b\u7684\u781d\u7801\u5404\u4e00\u679a,\u80fd\u79f0\u51fa\u54ea\u51e0\u79cd\u91cd\u91cf\uff1f\u6bcf\u79cd\u91cd\u91cf\u5404\u6709\u51e0\u79cd\u53ef\u80fd\u65b9\u6848\uff1f\n\n    $1$\u4e2a$1$\u514b\u781d\u7801\u53ef\u4ee5\u770b\u6210$1+x^1$,$1$\u8868\u793a\u4e0d\u53d6,$x^n$\u4ee3\u8868\u53d6$n$\u4e2a,\u4ee5\u4e0b\u540c\u7406\n\n    $1$\u4e2a$2$\u514b\u781d\u7801\u53ef\u4ee5\u770b\u6210$1+x^2$\n\n    $1$\u4e2a$3$\u514b\u781d\u7801\u53ef\u4ee5\u770b\u6210$1+x^3$\n\n    $1$\u4e2a$4$\u514b\u781d\u7801\u53ef\u4ee5\u770b\u6210$1+x^4$\n\n    \u90a3\u4e48\n    \n    $\\begin{aligned}\n    g(x)\n    &=(1+x^1)(1+x^2)(1+x^3)(1+x^4)\\\\\n    &=1+x+x^2+2x^3+2x^4+2x^5+2x^6+2x^7+x^8+x^9+x^{10}    \n    \\end{aligned}$\n\n    \u53ef\u4ee5\u770b\u51fa\u91cd\u91cf\u4e3a$3$\u514b\u7684\u65b9\u6848\u4e3a$2$\u79cd,$4$\u514b\u7684\u65b9\u6848\u4e3a$2$\u79cd,$3$\u514b\u7684\u65b9\u6848\u4e3a$5$\u79cd,\u4ee5\u6b64\u7c7b\u63a8\n\n    **\u53ef\u4ee5\u53d1\u73b0\u5f97\u51fa\u7684\u591a\u9879\u5f0f\u6bcf\u4e00\u9879$ax^n$\u4ee3\u8868\u91cd\u91cf\u4e3a$n$\u514b\u7684\u65b9\u6848\u6709$a$\u79cd**\n\n    \u624b\u52a8\u6a21\u62df\u4e00\u4e0b\u591a\u9879\u5f0f\u8ba1\u7b97\u7684\u8fc7\u7a0b,\u4e0e\u80cc\u5305dp\u76f8\u4f3c,\u4e5f\u53ef\u914d\u5408\u4e0b\u53d1\u4f8b\u9898\u4ee3\u7801\u7406\u89e3\n\n2. > \u6c42\u7528$1$\u5206\u3001$2$\u5206\u3001$3$\u5206\u7684\u90ae\u7968\u8d34\u51fa\u4e0d\u540c\u6570\u503c\u7684\u65b9\u6848\u6570(\u90ae\u7968\u5f20\u6570\u65e0\u9650)\n   \n   \u90a3\u4e48\n   \n   $\\begin{aligned}\n   g(x)\n   &=\n   \\begin{aligned}\n   &(1+x+x^2+x^3+\\dots)\\\\\n   &(1+x^2+x^4+x^6+\\dots)\\\\\n   &(1+x^3+x^6+x^9+\\dots)\\\\\n   \\end{aligned}\\\\\n   &=1+x+2x^2+3x^3+4x^4+\\dots    \n   \\end{aligned}$\n\n   $x^4$\u7684\u7cfb\u6570\u4e3a$4$\u8868\u793a$4$\u6709$4$\u4e2d\u62c6\u5206\u65b9\u6cd5:\n\n   $4=1+1+1+1=1+1+1+2=1+3=2+2$\n\n3. > \u8bbe\u6709$n$\u4e2a\u6807\u5fd7\u4e3a$1,2,\u2026,n$\u7684\u7f51\u888b,\u7b2c$i$\u4e2a\u7f51\u888b\u91cc\u653e\u6709$n_i$\u4e2a\u7403\u3002\u4e0d\u540c\u7f51\u888b\u91cc\u7684\u7403\u662f\u4e0d\u540c\u7684,\u800c\u540c\u4e00\u7f51\u888b\u91cc\u7684\u7403\u5219\u662f\u6ca1\u6709\u5dee\u522b\u7684,\u8ba4\u4e3a\u662f\u76f8\u540c\u7684\u3002\u8be2\u95ee\u4ece\u4e2d\u53d6$r$\u4e2a\u7403\u7684\u65b9\u6848\u6570\u3002\n   \n   $g(x)=(1+x+x^2+\\dots+x^{n_1})(1+x+x^2+\\dots+x^{n_2})\\dots$\n\n   \u6700\u540e\u6307\u6570\u4e3a$r$\u7684\u9879\u7684\u7cfb\u6570\u5c31\u662f\u7b54\u6848\n\n### \u4f8b\u9898\n\n[HDU 1028](http://acm.hdu.edu.cn/showproblem.php?pid=1028)\n\n> \u7ed9\u51fa$n$,\u6c42:\n> \n> $n=a_1+a_2+\\dots+a_m(m\\le n,a_i>0)$\u7684\u65b9\u6848\u6570\n> \n> eg: $n=4$\u65f6\u6709$5$\u79cd\u65b9\u6848\n> \n> $\\begin{aligned}\n  &4=4\\\\\n  &4=3+1\\\\\n  &4=2+2\\\\\n  &4=2+1+1\\\\\n  &4=1+1+1+1\\\\\n  \\end{aligned}$\n\n$\n\\begin{aligned}\ng(x)=\n&(1+x+x^2+x^3+\\dots+x^n)\\\\\n&(1+x^2+x^4+x^6+\\dots+x^n)\\\\\n&(1+x^3+x^6+x^9+\\dots+x^n)\\\\\n&\\cdots\\\\\n&(1+x^n)\\\\\n\\end{aligned}\\\\\n$\n\n```cpp\n#include<bits/stdc++.h>\nint n,a[2][121];\nint main(){\n    for(int i=0;i<=120;++i)a[1][i]=1;\n    for(int i=2;i<=120;++i){\n        memset(a[i&1],0,sizeof a[i&1]);\n        int p=0;\n        for(int p=0;p<=120;p+=i)\n            for(int j=0;j+p<=120;++j)\n                a[i&1][j+p]+=a[!(i&1)][j];\n                // ax^j \u00b7 x^p = ax^{j+k}\n                // a'[j+k]+=a[j]\n    }\n    while(~scanf(\"%d\",&n))\n        printf(\"%d\\n\",a[0][n]);\n}\n```\n\n### \u7ec3\u4e60:\n\n[HDU 1085](http://acm.hdu.edu.cn/showproblem.php?pid=1085)\n\n### \u63a8\u5e7f\n\n\u5f53$a=\\{1,1,1,\\dots\\}$\u65f6,$g(x)=1+x+x^2+x^3+\\dots$\n\n\u5f53$x\\in(-1,1)$\u65f6\uff1a\n\n$\n\\displaystyle\ng(x)=1+x+x^2+x^3+\\dots+x^{n-1}\n\\\\\nxg(x)=x+x^2+x^3+x^4+\\dots+x^n\n\\\\\ng(x)=\\frac{xg(x)-g(x)}{x-1}=\\frac{x^n-1}{x-1}\n\\\\\n\\because x\\in(-1,1),n=\\infty\n\\\\\n\\therefore x^n \\rightarrow 0\n\\\\\n\\therefore g(x)=\\frac1{1-x}\n$\n\n\u6240\u4ee5:\n\n$\\displaystyle \\frac1{1-x}=1+x+x^2+x^3+\\dots$\n\n$x$\u66ff\u6362\u4e3a$kx$:\n\n$\\displaystyle \\frac 1{1-kx}=1+kx+k^2x^2+k^3x^3+\\dots$\n\n\u4e24\u8fb9\u5206\u522b\u6c42\u5bfc\u5f97:\n\n$\\displaystyle \\frac1{(1-x)^2}=0+1+2x+3x^2+4x^3+\\dots$\n\n\u518d\u6c42\u5bfc:\n\n$\\displaystyle \\frac2{(1-x)^3}=0+0+1+3x+6x^2+10x^3+\\dots$\n\n\u63a8\u5e7f: $\\displaystyle \\sum_{i=0}^\\infty {i+k-1 \\choose k-1}x^i=\\frac1{(1-x)^k}$\n\n\u5e38\u89c1\u751f\u6210\u51fd\u6570:\n\n|\u6570\u5217|OGF|\n|-|-|\n|$<1,0,0,\\dots>$|$1$|\n|$<1,1,1,\\dots>$|$\\frac 1{1-x}$|\n|$<1,k,k^2,k^3,\\dots>$|$\\frac 1{1-kx}$|\n|$<1,2,3,\\dots>$|$\\frac 1{(1-x)^2}$|\n|$<1,\u22121,1,\u22121,\\dots>$|$\\frac 1{1+x}$|\n|$<1,2,1,0,0,\\dots>$|$(1+x)^2$|\n|$<1,4,6,4,1,0,0,\\dots>$|$(1+x)^4$|\n|$<1,n,{n\\choose 2},{n\\choose 3},\\dots>$|$(1+x)^n$|\n|$<1,n,{n+1\\choose 2},{n+1\\choose 3},\\dots>$|$(1-x)^{-n}$|\n|$<0,1,\\frac 12,\\frac 13,\\dots>$|$ln(1-x)$|\n|$<0,1,-\\frac 12,\\frac 13,-\\frac 14,\\dots>$|$ln(1+x)$|\n|$<1,1,\\frac 12,\\frac 1{3!},\\frac 1{4!},\\dots>$|$e^x$|\n\n### \u677f\u5b50\u9898\n\n[LG 2000 \u62ef\u6551\u4e16\u754c](https://www.luogu.com.cn/problem/P2000)\n\n1. \u91d1\u795e\u77f3\u7684\u5757\u6570\u5fc5\u987b\u662f6\u7684\u500d\u6570\n   $g(x)=1+x^6+x^{12}+...=\\frac 1{1-x^6}$\n2. \u6728\u795e\u77f3\u6700\u591a\u75289\u5757\n   $g(x)=1+x+x^2+...+x^9=\\frac{1-x^{10}}{1-x}$\n3. \u6c34\u795e\u77f3\u6700\u591a\u75285\u5757\n   $g(x)=1+x+x^2+...+x^5=\\frac{1-x^6}{1-x}$\n4. \u706b\u795e\u77f3\u7684\u5757\u6570\u5fc5\u987b\u662f4\u7684\u500d\u6570\n   $g(x)=1+x^4+x^8+...=\\frac 1{1-x^4}$\n5. \u571f\u795e\u77f3\u6700\u591a\u75287\u5757\n   $g(x)=1+x+x^2+...+x^7=\\frac{1-x^8}{1-x}$\n\n6. \u91d1\u795e\u77f3\u7684\u5757\u6570\u5fc5\u987b\u662f2\u7684\u500d\u6570\n   $g(x)=1+x^2+x^4+...=\\frac 1{1-x^2}$\n7. \u6728\u795e\u77f3\u6700\u591a\u75281\u5757\n   $g(x)=1+x=\\frac{1-x^2}{1-x}$\n8. \u6c34\u795e\u77f3\u7684\u5757\u6570\u5fc5\u987b\u662f8\u7684\u500d\u6570\n   $g(x)=1+x^8+x^{16}+...=\\frac 1{1-x^8}$\n9. \u706b\u795e\u77f3\u7684\u5757\u6570\u5fc5\u987b\u662f10\u7684\u500d\u6570\n   $g(x)=1+x^{10}+x^{20}+...=\\frac 1{1-x^{10}}$\n10. \u571f\u795e\u77f3\u6700\u591a\u75283\u5757\n    $g(x)=1+x+x^2+x^3=\\frac{1-x^4}{1-x}$\n\n$\\displaystyle \\frac 1{1-x^6}\\cdot\\frac{1-x^{10}}{1-x}\\cdot\\frac{1-x^6}{1-x}\\cdot\\frac 1{1-x^4}\\cdot\\frac{1-x^8}{1-x}\\cdot\\frac 1{1-x^2}\\cdot\\frac{1-x^2}{1-x}\\cdot\\frac 1{1-x^8}\\cdot\\frac 1{1-x^{10}}\\cdot\\frac{1-x^4}{1-x}\\\\\n=\\frac1{(1-x)^5}\\\\\n=\\sum_{i=0}^\\infty {i+4 \\choose 4}x^i$\n\n\u7b2c$n$\u9879\u7684\u7cfb\u6570\u662f${n+4 \\choose 4}$\u9700\u8981FFT\u6216NTT\n\n### \u6c42\u6590\u6ce2\u90a3\u5951\u6570\u5217\u901a\u9879\u516c\u5f0f\n\n\u6590\u6ce2\u90a3\u5951\u6570\u5217:\n\n$$f_0=1,f_1=1,f_i=f_{i-1}+f_{i-2}(i>1)$$\n\n\u6784\u9020\u751f\u6210\u51fd\u6570:\n\n$$F(x)=x+x^2+2x^3+3x^4+5x^5+\\dots$$\n\n\u6784\u9020\u65b9\u7a0b:\n\n$$\n\\begin{aligned}\n&\\quad F(x)-xF(x)\\\\\n&=(x+x^2+2x^3+3x^4+\\dots)-(x^2+x^3+2x^4+3x^5+\\dots)\\\\\n&=x+x^3+x^4+2x^5+3x^6+\\dots\\\\\n&=x+x^2F(x)\n\\end{aligned}\n$$\n\n\u89e3\u5f97: \n\n$$F(x)=\\frac x{1-x-x^2}$$\n\n\u914d\u65b9: \n\n$$\nF(x)=\\frac x{(1-\\phi_1 x)(1-\\phi_2 x)}\n\\\\~\\\\\n\\displaystyle \\phi_1=\\frac{1+\\sqrt 5}2,\\phi_2=\\frac{1-\\sqrt 5}2\n$$\n\n\u88c2\u9879: \n\n$$F(x)=\\frac 1{\\sqrt 5}\\left( \\frac 1{1-\\phi_1x}  - \\frac 1{1-\\phi_2x} \\right)$$\n\n\u90a3\u4e48:\n\n$$f_n=\\frac 1{\\sqrt 5}\\left[ \\left( \\frac{1+\\sqrt 5}2 \\right)^n - \\left( \\frac{1-\\sqrt 5}2 \\right)^n \\right]$$\n\n## \u6307\u6570\u578b\u751f\u6210\u51fd\u6570\n\n### \u5b9a\u4e49\n\n\u6307\u6570\u578b\u751f\u6210\u51fd\u6570\uff08exponential generating function,\u7b80\u79f0EGF\uff09\n\n\u5f62\u5982$\\displaystyle G(x)=\\sum_{i=0}^n a_i \\frac{x^i}{i!}$\u7684\u8868\u793a\u5e8f\u5217\u7684\u591a\u9879\u5f0f\u51fd\u6570,\u6211\u4eec\u79f0\u4e4b\u4e3a\u6307\u6570\u578b\u751f\u6210\u51fd\u6570\n\n### \u4f7f\u7528\u4f8b\n\n> \u6709\u4e09\u79cd\u7269\u54c1,\u5206\u522b\u6709$3,2,3$\u4e2a,\u95ee\u62ff\u51fa$4$\u4e2a\u8fdb\u884c\u6392\u5217(\u4e0d\u540c\u987a\u5e8f\u7b97\u4e0d\u540c\u65b9\u6848)\u7684\u65b9\u6848\u6570\u662f\u591a\u5c11\n\n\u591a\u91cd\u96c6\u6392\u5217\u6570:\n\n> \u8bbe$S={a_1,a_2,\\dots,a_n},N=\\sum\\limits_{i=1}^n a_i$,\u5176\u4e2d$a_i$\u8868\u793a\u7b2c$i$\u4e2a\u7269\u54c1\u6709$a_i$\u4e2a\u3002\n>  \n> \u4ece\u4e2d\u9009\u51fa$N$\u4e2a\u8fdb\u884c\u6392\u5217\u7684\u65b9\u6848\u6570\u4e3a$\\displaystyle \\frac{N!}{a_1! a_2! \\dots a_n!}$\n>  \n> \u89e3\u91ca: \u4efb\u610f\u6392\u5217\u4e4b\u540e\u51cf\u53bb\u540c\u79cd\u7269\u54c1\u4e4b\u95f4\u591a\u51fa\u6765\u7684\u65b9\u6848\n\n\u6784\u9020:\n\n$\\displaystyle\nG_1(x)=1+\\frac x{1!}+\\frac {x^2}{2!}+\\frac {x^3}{3!}\\\\~\\\\\nG_2(x)=1+\\frac x{1!}+\\frac {x^2}{2!}\\\\~\\\\\nG_3(x)=1+\\frac x{1!}+\\frac {x^2}{2!}+\\frac {x^3}{3!}\\\\\n$\n\n\u90a3\u4e48\n\n$$\n\\begin{aligned}\n&\\quad G_1(x)\\cdot G_2(x) \\cdot G_3(x)\\\\\n&=(1+\\frac x{1!}+\\frac {x^2}{2!}+\\frac {x^3}{3!})(1+\\frac x{1!}+\\frac {x^2}{2!})(1+\\frac x{1!}+\\frac {x^2}{2!}+\\frac {x^3}{3!})\\\\\n&=(1+3x + \\frac{9}{2}x^2 + \\frac{14}{3}x^3 + \\frac{35}{12}x^4 + \\frac{17}{12}x^5 + \\frac{35}{72} x^6 + \\frac{8}{72}x^7 + \\frac{1}{71}x^8)\n\\end{aligned}\n$$\n\n\u9009$4$\u4e2a\u7269\u54c1\u7684\u65b9\u6848\u6570\u5c31\u662f$4!\\cdot \\frac{35}{12}=70$\n\n[hdu 1521 \u6392\u5217\u7ec4\u5408](http://acm.hdu.edu.cn/showproblem.php?pid=1521)\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=11;\nint n,m,a[N],fac[100000],mx=0;\ntypedef double db;\ndb c[2][N];\nvoid solve(){\n    mx=m;\n    for(int i=1;i<=n;++i){\n        scanf(\"%d\",a+i);\n        if(a[i]>mx)mx=a[i];\n    }\n    fac[0]=1;\n    for(int i=1;i<=mx;++i)fac[i]=fac[i-1]*i;\n    memset(c,0,sizeof c);\n    for(int i=0;i<=a[1];++i)\n        c[1][i]=1.0/(db)fac[i];\n    for(int i=2;i<=n;++i){\n        memset(c[i&1],0,sizeof c[i&1]);\n        for(int p=0;p<=m;++p)\n            for(int j=0;j<=a[i]&&j+p<=m;++j)\n                c[i&1][j+p]+=c[!(i&1)][p]/(db)fac[j];\n    }\n    printf(\"%.0f\\n\",c[n&1][m]*fac[m]);\n}\nint main(){\n    while(~scanf(\"%d%d\",&n,&m))solve();\n}\n```\n\n### \u63a8\u5e7f\n\n$\\displaystyle e^x=\\sum_{i=0}^{\\infty}\\frac{x^i}{i!}$\n\n\u5e38\u89c1\u7684\u6307\u6570\u578b\u751f\u6210\u51fd\u6570:\n\n|\u6570\u5217|EGF|\n|-|-|\n|$<1,1,1,\\dots>$|$e^x$|\n|$<1,-1,1,-1,\\dots>$|$e^{-x}$|\n|$<1,k,k^2,k^3,\\dots>$|$e^{kx}$|\n|$<0,1,2,\\dots>$|$xe^x$|\n|$<1,0,1,0,\\dots>$|$\\frac {e^x+e^{-x}}2$|\n|$<0,1,0,1,\\dots>$|$\\frac {e^x-e^{-x}}2$|\n\n\u53ef\u4ee5\u53d1\u73b0$<f_n>$\u7684EGF\u5c31\u662f$<\\frac{f_n}{n!}>$\u7684OGF\n\n\u4f8b\u9898:\n\n[poj 3734 \u79ef\u6728](http://poj.org/problem?id=3734)\n\n> \u957f\u5ea6\u4e3a$n$\u7684\u5e8f\u5217,\u7528\u7ea2\u9ec4\u84dd\u7eff\u67d3\u8272,\u5176\u4e2d\u7ea2\u3001\u7eff\u6570\u91cf\u5747\u4e3a\u5076\u6570,\u6c42\u65b9\u6848\u6570\n\n\u7ea2\u3001\u7eff: $\\frac{e^x+e^{-x}}2$\n\n\u9ec4\u3001\u84dd: $e^x$\n\n$\\displaystyle\n\\begin{aligned}\nF(x)\n&=e^x \\cdot \\frac{e^x+e^{-x}}2 \\cdot e^x \\cdot \\frac{e^x+e^{-x}}2\\\\\n&=\\left(e^x \\cdot \\frac{e^x+e^{-x}}2\\right)^2\\\\\n&=\\left(\\frac{e^{2x}+1}2\\right)^2\\\\\n&=\\frac{e^{4x}+2e^{2x}+1}4\\\\\n&=\\frac 14+\\sum_{i=0}^{\\infty} \\frac{4^i+2^{i+1}}4 \\cdot \\frac{x^i}{n!}\n\\end{aligned}\n\\\\\nf_n=\\frac{4^n+2^{n+1}}4 \n$\n\n```cpp\n#include<cstdio>\ntypedef long long ll;\nconst int P=10007;\nint n;\nint pw(ll x,int b){\n    ll res=1;\n    while(b){\n        if(b&1)res=res*x%P;\n        x=x*x%P;b>>=1;\n    }\n    return res;\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--)\n        scanf(\"%d\",&n),\n        printf(\"%d\\n\",(pw(4,n)+pw(2,n+1))%P*2502%P);\n}\n```", "link": "/posts/\u751f\u6210\u51fd\u6570/", "tags": ["\u6570\u8bba", "\u751f\u6210\u51fd\u6570", "\u591a\u9879\u5f0f"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "\u4f2f\u52aa\u5229\u6570\u4e0e\u81ea\u7136\u6570\u5e42\u548c", "content": "https://www.51nod.com/Challenge/Problem.html#problemId=1822\n\n## \u5b9a\u4e49\n\n$$\n\\begin{cases}\nB_0=1\\\\~\\\\\n\\displaystyle \\sum\\limits_{i=0}^n {n+1\\choose i}B_i=0,n>0\n\\end{cases}\n$$\n\n## \u666e\u901a\u8ba1\u7b97\n\n$\\displaystyle B_n=-\\frac 1{n+1} \\sum_{i=0}^{n-1}{n+1\\choose i}B_i$\n\n\u590d\u6742\u5ea6: $O(n^2)$\n\n## \u9ad8\u6548\u8ba1\u7b97\n\n\u63a8\u5f0f\u5b50:\n\n\u4ee3\u5165$n=n+1$:\n\n$$\n\\sum_{i=0}^n {n\\choose i}B_i=B_n,n>1\n\\\\~\\\\\n\\sum_{i=0}^n \\frac{B_i}{i!(n-i)!}=\\frac{B_n}{n!},n>1\n$$\n\n$0!=1,n=0$\u65f6,\u4e5f\u6ee1\u8db3\u4e0a\u8ff0\u5f0f\u5b50\n\n$$\\sum_{i=0}^n \\frac{B_i}{i!} \\cdot \\frac 1{(n-i)!}=\\frac{B_n}{n!},n\\neq 1$$\n\n\u7b97\u51fa$n=1$\u7684\u60c5\u51b5:\n\n$$\\sum_{i=0}^n \\frac{B_i}{i!} \\cdot \\frac 1{(n-i)!}=\\frac{B_n}{n!}+[n=1]$$\n\n\u6784\u5efa\u751f\u6210\u51fd\u6570\n\n$$\n\\sum_{n=0}^{\\infty}\\sum_{i=0}^n \\frac{B_i}{i!} x^i \\cdot \\frac 1{(n-i)!} x^{n-i}=\\sum_{n=0}^{\\infty} \\left( \\frac{B_n}{n!}+[n=1]\\right)x^n\n\\\\~\\\\\nB(x)e^x=B(x)+x\n\\\\~\\\\\nB(x)=\\frac x{e^x-1}\n\\\\~\\\\ \n\\begin{aligned}\nB(x)\n&=\\frac x{\\sum_{i=0}^{\\infty} \\frac{x^i}{i!}-1}\\\\\n&=\\frac 1{\\sum_{i=0}^{\\infty} \\frac{x^i}{(i+1)!}}\n\\end{aligned}\n$$\n\n\u591a\u9879\u5f0f\u6c42\u9006\u5373\u53ef\n\n## \u6027\u8d28\n\n$\\displaystyle \\sum_{i=1}^{n-1} i^k=\\frac 1{k+1} \\sum_{i=1}^{k+1} {k+1\\choose i}B_in^{k-i+1}$\n\n[51nod 1228 \u5e8f\u5217\u6c42\u548c](https://www.51nod.com/Challenge/Problem.html#problemId=1228)\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=2011,P=1000000007;\ntypedef long long ll;\nint fac[N],inv[N],ifac[N],B[N];\nint pw(int x,int b){\n\tint res=1;\n\twhile(b){\n\t\tif(b&1)res=1ll*res*x%P;\n\t\tb>>=1;x=1ll*x*x%P;\n\t}\n\treturn res;\n}\nvoid mod(int&x){if(x>=P)x-=P;}\nvoid prep(int n){\n\tfac[0]=fac[1]=inv[0]=inv[1]=ifac[0]=ifac[1]=B[0]=1;\n\tfor(int i=2;i<=n;++i)\n\t\tfac[i]=1ll*fac[i-1]*i%P,\n\t\tinv[i]=1ll*inv[P%i]*(P-P/i)%P,\n\t\tifac[i]=1ll*ifac[i-1]*inv[i]%P;\n\tfor(int i=1;i<=n;++i)\n        for(int j=0;j<i;++j)\n            mod(B[i]+=P-1ll*fac[i]*ifac[j]%P*ifac[i+1-j]%P*B[j]%P);\n}\nint S(ll t,int k){\n\tint n=(t+1)%P,ans=0;\n\tfor(int i=0;i<=k;++i)\n\t\tmod(ans+=1ll*fac[k]*ifac[i]%P*ifac[k+1-i]%P*B[i]%P*pw(n,k+1-i)%P);\n\treturn ans;\n}\nint main(){\n\tint T,k;ll n;\n    scanf(\"%d\",&T);\n    prep(2001);\n    while(T--)\n\t    scanf(\"%lld%d\",&n,&k),\n\t    printf(\"%d\\n\",S(n,k));\n}\n```\n\n[51nod 1258 \u5e8f\u5217\u6c42\u548cV4](https://www.51nod.com/Challenge/Problem.html#problemId=1258)\n\n", "link": "/posts/\u4f2f\u52aa\u5229\u6570/", "tags": ["\u6570\u8bba", "\u4f2f\u52aa\u5229\u6570"], "categories": [["note"]]}, {"title": "GDOI2020\u6e38\u8bb0", "content": "\u65f6\u95f4\u4e0d\u77e5\u4e0d\u89c9\u53c8\u8fc7\u53bb\u4e86~~\u4e00~~\u4e24\u5e74,\u53c8\u5230\u4e86\u7701\u9009\u7684\u65f6\u5019\n\n~~\u8fd9\u6b21\u6709\u70b9\u81ea\u95ed,\u6e38\u8bb0\u53ef\u80fd\u5148\u5495\u5495\u5495\u4e86~~\n\n", "link": "/posts/GDOI2020\u6e38\u8bb0/", "tags": ["\u6e38\u8bb0"], "categories": [["\u6e38\u8bb0"]]}, {"title": "DZY Loves Math \u7cfb\u5217", "content": "## DZY Loves Math\n\n\u9898\u610f:\n\n\u5bf9\u4e8e\u6b63\u6574\u6570$n$,\u5b9a\u4e49$f(n)$\u4e3a$n$\u6240\u542b\u8d28\u56e0\u5b50\u7684\u6700\u5927\u5e42\u6307\u6570\n\n\u4f8b\u5982$f(1960)=f(2^3\\cdot 5^1\\cdot 7^2)=3,f(10007)=1,f(1)=0$\n\n\u7ed9\u5b9a\u6b63\u6574\u6570$a,b$,\u6c42$\\sum\\limits_{i=1}^a\\sum\\limits_{j=1}^b f(\\gcd(i,j))$\n\n\u5047\u8bbe$a<b$\n\n$$\n\\sum_{i=1}^a\\sum_{j=1}^b f(\\gcd(i,j))\\\\\n=\\sum_{d=1}^a f(d)\\sum_{i=1}^a\\sum_{j=1}^b[\\gcd(i,j)=d]\\\\\n=\\sum_{d=1}^a f(d)\\sum_{i=1}^{a/d}\\sum_{j=1}^{b/d}[\\gcd(i,j)=1]\\\\\n=\\sum_{d=1}^a f(d)\\sum_{i=1}^{a/d}\\sum_{j=1}^{b/d}\\sum_{x|a,x|b}\\mu(x)\\\\\n=\\sum_{d=1}^a f(d) \\sum_{x=1}^a\\mu(x)\\sum_{i=1}^{a/dx}\\sum_{j=1}^{b/dx}\\\\\n=\\sum_{d=1}^a f(d) \\sum_{x=1}^a\\mu(x)\\left\\lfloor\\frac a{dx}\\right\\rfloor \\left\\lfloor\\frac b{dx}\\right\\rfloor\n$$\n\n\u8bbe$T=dx$\n\n$$\n=\\sum_{T=1}^a \\left\\lfloor\\frac a{T}\\right\\rfloor \\left\\lfloor\\frac b{T}\\right\\rfloor \\sum_{x|T} f(x)\\mu(\\frac Tx)\n$$\n\n\u524d\u9762\u53ef\u4ee5\u6570\u8bba\u5206\u5757,\u4e3b\u8981\u95ee\u9898\u5728\u4e8e\u6c42$,\\sum\\limits_{x|T} f(x)\\mu(\\frac Tx)$\n\n\u8bbe$g(T)=,\\sum\\limits_{x|T} f(x)\\mu(\\frac Tx)$\n\n\u53ef\u4ee5\u53d1\u73b0\u5f53$\\mu(x)$\u4e3a$0$\u65f6\u6ca1\u6709\u8d21\u732e\n\n\u8bbe$T=p_1^{a_1}p_2^{a_2}\\dots p_k^{a_k}$\n\n\u5f53$a_1=a_2=\\dots=a_k$\u65f6,\n$g(T)=(-1)^{k+1}$\u3002\n\n\u5426\u5219$g(T)=0$\n\n\u8bc1\u660e:\n\n1. $a_1,a_2,\\dots,a_k$\u4e0d\u5168\u76f8\u7b49\u65f6,$g(T)=0$\n   \n   \u5982\u679c\u6240\u6709\u8d28\u56e0\u5b50\u7684\u6b21\u6570\u4e0d\u5168\u76f8\u7b49,\u90a3\u4e48\u8003\u8651\u6b21\u6570\u6700\u5c0f\u7684\u90a3\u4e2a\u8d28\u56e0\u5b50,\u5b83\u65e0\u8bba\u662f\u5426\u9009\u62e9\u90fd\u4e0d\u4f1a\u5f71\u54cd$f(\\frac Tx)$\u7684\u503c,\u53ea\u662f\u5dee\u5728$\u03bc(x)$\u7684\u6b63\u8d1f\u3002\u8fd9\u6837\u9009\u5b83\u548c\u4e0d\u9009\u5b83,\u4ea7\u751f\u7684\u8d21\u732e\u6b63\u597d\u6b63\u8d1f\u62b5\u6d88,\u56e0\u6b64$g(T)$\u4e00\u5b9a\u662f$0$\n\n2. $a_1=a_2=...=a_k$\n   \n   \u5f53\u4e14\u4ec5\u5f53\u6bcf\u4e2a\u8d28\u56e0\u5b50\u90fd\u9009\u62e9\u65f6,$f(\\frac Tx)$\u7b49\u4e8e$a\u22121$,\u5426\u5219\u7b49\u4e8e$a$\u3002\u90a3\u4e48\u5982\u679c\u628a$a\u22121$\u7684\u90a3\u6b21\u8d21\u732e\u770b\u4f5c$a$,\u90a3\u4e48\u7b54\u6848\u5e94\u8be5\u662f0\u3002\u6240\u4ee5\u53ea\u9700\u8981\u8003\u8651\u628a$a\u22121$\u770b\u6210$a$\u7684\u53d8\u5316\u3002\u663e\u7136\u5f53$k$\u4e3a\u5947\u6570\u65f6$\u03bc(x)$\u4e3a\u8d1f,$a\u22121$\u7684\u8d21\u732e\u4e3a\u8d1f,\u56e0\u6b64\u7b54\u6848\u4e3a$1$\uff1b\u5426\u5219$a\u22121$\u7684\u8d21\u732e\u4e3a\u6b63,\u7b54\u6848\u4e3a$\u22121$\n\n```cpp\n#include<cstdio>\nconst int N=10000001;\nint pri[N],mi[N],cnt[N],b[N];\nlong long g[N],res;\nbool v[N];\nvoid init(){\n\tfor(int i=2,tt=0;i<N;++i){\n\t\tif(!v[i])pri[++tt]=i,cnt[i]=mi[i]=1;\n\t\tfor(int j=1;j<=tt&&i*pri[j]<N;++j){\n\t\t\tv[i*pri[j]]=1;\n\t\t\tif(i%pri[j]==0){\n\t\t\t\tcnt[i*pri[j]]=cnt[i];//\u8d28\u56e0\u5b50\u4e2a\u6570\n\t\t\t\tmi[i*pri[j]]=mi[i]+1;//\u5f53\u524d\u8d28\u56e0\u5b50\u5e42\u6b21\n                b[i*pri[j]]=b[i];//\u9664\u5f53\u671f\u8d28\u56e0\u5b50\u5916\u6700\u9ad8\u5e42\u6b21\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tif(!b[i]||b[i]==mi[i])b[i*pri[j]]=mi[i];\n                else b[i*pri[j]]=-1;\n                mi[i*pri[j]]=1,cnt[i*pri[j]]=cnt[i]+1;\n\t\t\t}\n\t\t}\n        g[i]=g[i-1];\n        if(!b[i]||b[i]==mi[i])g[i]+=(cnt[i]&1)?1:-1;\n\t}\n}\nint min(int x,int y){return x<y?x:y;}\nvoid solve(){\n\tint a,b;res=0;\n\tscanf(\"%d%d\",&a,&b);\n\tif(a>b)a^=b,b^=a,a^=b;\n\tfor(int l=1,r;l<=a;l=r+1){\n\t\tr=min(a/(a/l),b/(b/l));\n\t\tres+=1ll*(a/l)*(b/l)*(g[r]-g[l-1]);\n\t}\n\tprintf(\"%lld\\n\",res);\n}\nint main(){\n    init();\n\tint T;scanf(\"%d\",&T);\n\twhile(T--)solve();\n}\n```", "link": "/posts/DZY Loves Math \u7cfb\u5217/", "tags": ["\u6570\u8bba", "\u6570\u8bba\u5206\u5757", "\u83ab\u6bd4\u4e4c\u65af"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "\u7ebf\u6027\u57fa", "content": "\n", "link": "/posts/\u7ebf\u6027\u57fa/", "tags": ["\u4f4d\u8fd0\u7b97", "\u4e8c\u8fdb\u5236"], "categories": [["\u7b97\u6cd5"], ["note"]]}, {"title": "SPOJ GSS \u7cfb\u5217", "content": "SPOJ\u7684GSS\u7cfb\u5217\u662f\u5173\u4e8e\u533a\u95f4\u7edf\u8ba1\u6280\u5de7\u7684\u96c6\u5408\n\n~~\u975e\u5e38\u9002\u5408\u953b\u70bc\u7801\u529b~~\n\n[LG GSS1](https://www.luogu.com.cn/problem/SP1043) | [SPOJ GSS1](https://www.SPOJ.com/problems/GSS1)\n\n[LG GSS2](https://www.luogu.com.cn/problem/SP1557) | [SPOJ GSS2](https://www.SPOJ.com/problems/GSS2)\n\n[LG GSS3](https://www.luogu.com.cn/problem/SP1716) | [SPOJ GSS3](https://www.SPOJ.com/problems/GSS3)\n\n[LG GSS4](https://www.luogu.com.cn/problem/SP2713) | [SPOJ GSS4](https://www.SPOJ.com/problems/GSS4)\n\n[LG GSS5](https://www.luogu.com.cn/problem/SP2916) | [SPOJ GSS5](https://www.SPOJ.com/problems/GSS5)\n\n[LG GSS6](https://www.luogu.com.cn/problem/SP4487) | [SPOJ GSS6](https://www.SPOJ.com/problems/GSS6)\n\n[LG GSS7](https://www.luogu.com.cn/problem/SP6779) | [SPOJ GSS7](https://www.SPOJ.com/problems/GSS7)\n\n[LG GSS8](https://www.luogu.com.cn/problem/SP19543) | [SPOJ GSS8](https://www.SPOJ.com/problems/GSS8)\n\nGSS1,GSS3: \u6700\u5927\u5b50\u6bb5\u548c:\n\n\u6bcf\u4e2a\u8282\u70b9\u8bb0\u5f55\u533a\u95f4\u548c,\u6700\u5927\u540e\u7f00\u548c,\u6700\u5927\u524d\u7f00\u548c,\u7b54\u6848\n\n```cpp\nnode operator+(node x,node y){\n    node c;\n    c.s=x.s+y.s;// \u548c\n    c.mx=max(max(x.mx,y.mx),x.r+y.l); //\u7b54\u6848\n    c.l=max(x.l,x.s+y.l);//\u6700\u5927\u524d\u7f00\n    c.r=max(y.r,y.s+x.r);//\u6700\u5927\u540e\u7f00\n    return c;\n}\n```\n\n## GSS3 & GSS 1\n\n> \u9759\u6001\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c,\u5355\u70b9\u4fee\u6539\n\n\u7ebf\u6bb5\u6811\n\n```cpp\n#include<bits/stdc++.h>\nint max(int x,int y){return x>y?x:y;}\nint rd(){int x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return f?-x:x;}\nconst int N=50011;\n#define ls rt<<1\n#define rs rt<<1|1\nint n,q;\nstruct node{int s,l,r,mx;}s[N<<2];\nnode operator+(node x,node y){\n    node c;\n    c.s=x.s+y.s;\n    c.mx=max(max(x.mx,y.mx),x.r+y.l);\n    c.l=max(x.l,x.s+y.l);\n    c.r=max(y.r,y.s+x.r);\n    return c;\n}\nvoid build(int l,int r,int rt){\n    if(l==r){s[rt].s=s[rt].mx=s[rt].l=s[rt].r=rd();return;}\n    int m=l+r>>1;\n    build(l,m,ls),build(m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nvoid upd(int p,int v,int l,int r,int rt){\n    if(l==r){s[rt]={v,v,v,v};return;}\n    int m=l+r>>1;\n    if(p<=m)upd(p,v,l,m,ls);\n    else upd(p,v,m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nnode ask(int L,int R,int l,int r,int rt){\n    if(L==l&&r==R)return s[rt];\n    int m=l+r>>1;\n    if(L>m)return ask(L,R,m+1,r,rs);\n    else if(R<=m)return ask(L,R,l,m,ls);\n    else return ask(L,m,l,m,ls)+ask(m+1,R,m+1,r,rs);\n}\nint main(){\n    n=rd();\n    build(1,n,1);\n    q=rd();\n    while(q--){\n        int opt=rd(),x=rd(),y=rd();\n        if(opt)printf(\"%d\\n\",ask(x,y,1,n,1).mx);\n        else upd(x,y,1,n,1);\n    }\n}\n```\n\n## GSS5\n\n> \u7ed9\u5b9a\u4e00\u4e2a\u5e8f\u5217\u3002\u67e5\u8be2\u5de6\u7aef\u70b9\u5728$[x_1, y_1]$\u4e4b\u95f4,\u4e14\u53f3\u7aef\u70b9\u5728$[x_2, y_2]$\u4e4b\u95f4\u7684\u6700\u5927\u5b50\u6bb5\u548c,\u6570\u636e\u4fdd\u8bc1$x_1\\leq x_2,y_1\\leq y_2$\u200b ,\u4f46\u662f\u4e0d\u4fdd\u8bc1\u7aef\u70b9\u6240\u5728\u7684\u533a\u95f4\u4e0d\u91cd\u5408\n\n\u5206\u7c7b\u8ba8\u8bba\n\n1. \u4e0d\u91cd\u5408:\n   \n   $[y_1,x_2]$\u7684\u548c+$[x_1,y_1-1]$\u7684\u6700\u5927\u540e\u7f00\u548c+$[x_2+1,y_2]$\u7684\u6700\u5927\u524d\u7f00\u548c\n\n2. \u91cd\u5408:\n   \n   - $[x_2,y_1]$\u7684\u6700\u5927\u5b50\u6bb5\u548c\n   - $[x_2,y_1]$\u7684\u548c+$[x_1,x_2-1]$\u7684\u6700\u5927\u540e\u7f00\u548c+$[y_1+1,x_2]$\u7684\u6700\u5927\u524d\u7f00\u548c\n   - $[x_1,x_2-1]$\u6700\u5927\u540e\u7f00\u548c+$[x_2,y_1]$\u6700\u5927\u524d\u7f00\u548c\n   - $[x_2,y_1]$\u6700\u5927\u540e\u7f00\u548c+$[y_1+1,y_2]$\u6700\u5927\u524d\u7f00\u548c\n\n```cpp\n#include<bits/stdc++.h>\nint max(int x,int y){return x>y?x:y;}\nint rd(){int x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return f?-x:x;}\nconst int N=10011;\nint n,q;\n#define ls rt<<1\n#define rs rt<<1|1\nstruct node{int s,l,r,mx;}s[N<<2];\nnode operator+(node x,node y){\n    node c;\n    c.s=x.s+y.s;\n    c.mx=max(max(x.mx,y.mx),x.r+y.l);\n    c.l=max(x.l,x.s+y.l);\n    c.r=max(y.r,y.s+x.r);\n    return c;\n}\nvoid build(int l,int r,int rt){\n    if(l==r){s[rt].s=s[rt].mx=s[rt].l=s[rt].r=rd();return;}\n    int m=l+r>>1;\n    build(l,m,ls),build(m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nnode ask(int L,int R,int l=1,int r=n,int rt=1){\n    if(L>R)return s[0];\n    if(L==l&&r==R)return s[rt];\n    int m=l+r>>1;\n    if(L>m)return ask(L,R,m+1,r,rs);\n    else if(R<=m)return ask(L,R,l,m,ls);\n    else return ask(L,m,l,m,ls)+ask(m+1,R,m+1,r,rs);\n}\nvoid solve(){\n    n=rd();\n    build(1,n,1);\n    q=rd();\n    while(q--){\n        int x=rd(),y=rd(),X=rd(),Y=rd();\n        if(y<X)printf(\"%d\\n\",max(ask(x,y-1).r,0)+ask(y,X).s+max(ask(X+1,Y).l,0));\n        else{\n            node a=ask(x,X-1),b=ask(X,y),c=ask(y+1,Y);\n            printf(\"%d\\n\",max(max(b.mx,max(a.r,0)+b.s+max(c.l,0)),max(a.r+b.l,b.r+c.l)));\n        }\n    }\n}\nint main(){\n    int T=rd();\n    while(T--)solve();\n}\n```\n\n## GSS6\n\n> \u7ed9\u51fa\u4e00\u4e2a\u7531$N$\u4e2a\u6574\u6570\u7ec4\u6210\u7684\u5e8f\u5217$A$,\u4f60\u9700\u8981\u5e94\u7528$M$> \u4e2a\u64cd\u4f5c\uff1a\n> \n> - `I p x` \u5728$~p~$\u5904\u63d2\u5165\u63d2\u5165\u4e00\u4e2a\u5143\u7d20$~x~$\n> - `D p` \u5220\u9664$~p~$\u5904\u7684\u4e00\u4e2a\u5143\u7d20\n> - `R p x` \u4fee\u6539$~p~$\u5904\u5143\u7d20\u7684\u503c\u4e3a$~x~$\n> - `Q l r` \u67e5\u8be2\u4e00\u4e2a\u533a\u95f4$[l,r]$\u7684\u6700\u5927\u5b50\u6bb5\u548c\n\n\u6700\u5927\u5b50\u6bb5\u548c\u642c\u5230\u4e86\u5e73\u8861\u6811\u4e0a\n\n```cpp\n#include<bits/stdc++.h>\nint max(int x,int y){return x>y?x:y;}\nint rd(){int x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return f?-x:x;}\nconst int N=200001;\nstruct node{\n    int s,l,r,mx;\n    node(){s=l=r=mx=0;}\n    node(int v){s=l=r=mx=v;}\n}s[N<<1];\nnode operator+(node x,node y){\n    node c;\n    c.s=x.s+y.s;\n    c.mx=max(max(x.mx,y.mx),x.r+y.l);\n    c.l=max(x.l,x.s+y.l);\n    c.r=max(y.r,y.s+x.r);\n    return c;\n}\nint RT,cnt,sz[N],v[N],rnd[N],c[2][N];\n#define ls c[0][x]\n#define rs c[1][x]\nint ne(int val){\n    s[++cnt]=node(val),rnd[cnt]=rand(),v[cnt]=val,sz[cnt]=1;\n    return cnt;\n}\nvoid pu(int x){\n    sz[x]=sz[ls]+1+sz[rs];\n    s[x]=node(v[x]);\n    if(ls)s[x]=s[ls]+s[x];\n    if(rs)s[x]=s[x]+s[rs];\n}\nvoid sl(int x,int k,int &a,int &b){\n    if(!x){a=b=0;return;}\n    if(sz[ls]>=k)b=x,sl(ls,k,a,ls);\n    else a=x,sl(rs,k-sz[ls]-1,rs,b);\n    pu(x);\n}\nint mg(int x,int y){\n    if(!x||!y)return x|y;\n    if(rnd[x]<rnd[y]){\n        c[1][x]=mg(c[1][x],y);\n        pu(x);return x;\n    }\n    else{\n        c[0][y]=mg(x,c[0][y]);\n        pu(y);return y;\n    }\n}\nint main(){\n    srand(time(0));\n    for(int n=rd();n--;)RT=mg(RT,ne(rd()));\n    char opt;\n    for(int q=rd(),x,y,z,l,r;q--;){\n        while(isspace(opt=getchar()));\n        if(opt=='I')\n            sl(RT,rd()-1,x,z),\n            RT=mg(x,mg(ne(rd()),z));\n        else if(opt=='D')\n            sl(RT,rd()-1,x,z),sl(z,1,y,z),\n            RT=mg(x,z);\n        else if(opt=='R')\n            sl(RT,rd()-1,x,z),sl(z,1,y,z),\n            s[y]=node(v[y]=rd()),\n            RT=mg(x,mg(y,z));\n        else if(opt=='Q')\n            l=rd(),r=rd(),\n            sl(RT,r,x,z),sl(x,l-1,x,y),\n            printf(\"%d\\n\",s[y].mx),\n            RT=mg(x,mg(y,z));\n    }\n}\n```\n\n## GSS7\n\n> \u7ed9\u5b9a\u4e00\u68f5\u6811,\u6709$N(N \\le 100000)$\u4e2a\u8282\u70b9,\u6bcf\u4e00\u4e2a\u8282\u70b9\u90fd\u6709\u4e00\u4e2a\u6743\u503c$x_i (|x_i| \\le 10000)$\n> \n> \u4f60\u9700\u8981\u6267\u884c$Q (Q \\le 100000)$\u6b21\u64cd\u4f5c\uff1a\n> \n> 1. `1 a b` \u67e5\u8be2`(a,b)`\u8fd9\u6761\u94fe\u4e0a\u7684\u6700\u5927\u5b50\u6bb5\u548c,**\u53ef\u4ee5\u4e3a\u7a7a**\uff08\u5373\u8f93\u51fa$0$\uff09\n> 2. `2 a b c` \u5c06`(a,b)`\u8fd9\u6761\u94fe\u4e0a\u7684\u6240\u6709\u70b9\u6743\u53d8\u4e3a`c` $(|c| \\le 10000)$\n\n\u6700\u5927\u5b50\u6bb5\u548c\u642c\u5230\u4e86\u6811\u4e0a,\u6811\u94fe\u5256\u5206\n\n\u6811\u5256\u67e5\u8be2\u65f6\u6ce8\u610f\u5408\u5e76\u987a\u5e8f\u548c\u53cd\u8f6c\u5de6\u8fb9\n\n```cpp\n#include<bits/stdc++.h>\nvoid swap(int&x,int&y){x^=y,y^=x,x^=y;}\nint max(int x,int y){return x>y?x:y;}\nvoid rd(int&x){x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());if(f)x=-x;}\nconst int N=100001;\nint n,cnt,head[N],a[N],c[N];\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint d[N],f[N],siz[N],top[N],id[N],sz;\nvoid dfs(int x){\n    siz[x]=1;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to!=f[x])\n            f[to]=x,d[to]=d[x]+1,\n            dfs(to),siz[x]+=siz[to];\n}\nvoid bt(int x,int tp){\n    top[x]=tp;c[id[x]=++sz]=a[x];\n    int k=0;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(k)bt(k,tp);\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(!top[to])bt(to,to);\n}\nstruct node{\n    int s,l,r,mx;\n    node(){s=l=r=mx=0;}\n    node(int v){s=v,l=r=mx=max(v,0);}\n    void rev(){swap(l,r);}\n}s[N<<2];\nnode operator+(node x,node y){\n    node c;\n    c.s=x.s+y.s;\n    c.mx=max(max(x.mx,y.mx),x.r+y.l);\n    c.l=max(x.l,x.s+y.l);\n    c.r=max(y.r,y.s+x.r);\n    return c;\n}\nint laz[N<<2];bool tag[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\nvoid build(int l,int r,int rt){\n    if(l==r){s[rt]=node(c[l]);return;}\n    int m=l+r>>1;\n    build(l,m,ls),build(m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nvoid pd(int rt,int ln,int rn){\n    if(tag[rt]){\n        laz[ls]=laz[rs]=laz[rt];\n        tag[ls]=tag[rs]=1;\n        s[ls]=node(laz[rt]*ln);\n        s[rs]=node(laz[rt]*rn);\n        tag[rt]=0;\n    }\n}\nvoid mdy(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt]=node(v*(r-l+1));\n        laz[rt]=v;tag[rt]=1;\n        return;\n    }\n    int m=l+r>>1;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)mdy(L,R,v,l,m,ls);\n    if(R>m)mdy(L,R,v,m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nnode qry(int L,int R,int l,int r,int rt){\n    if(L==l&&r==R)return s[rt];\n    int m=l+r>>1;\n    pd(rt,m-l+1,r-m);\n    if(L>m)return qry(L,R,m+1,r,rs);\n    else if(R<=m)return qry(L,R,l,m,ls);\n    else return qry(L,m,l,m,ls)+qry(m+1,R,m+1,r,rs);\n}\nint ask(int x,int y){\n    node l,r;\n    while(top[x]^top[y])\n        if(d[top[x]]>d[top[y]])\n            l=qry(id[top[x]],id[x],1,n,1)+l,x=f[top[x]];\n        else \n            r=qry(id[top[y]],id[y],1,n,1)+r,y=f[top[y]];\n    if(d[x]>d[y])\n        l=qry(id[y],id[x],1,n,1)+l;\n    else \n        r=qry(id[x],id[y],1,n,1)+r;\n    l.rev();\n    return (l+r).mx;\n}\nvoid upd(int x,int y,int v){\n    while(top[x]^top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        mdy(id[top[x]],id[x],v,1,n,1),x=f[top[x]];\n    }\n    if(d[x]>d[y])swap(x,y);\n    mdy(id[x],id[y],v,1,n,1);\n}\nint main(){\n    rd(n);\n    for(int i=1;i<=n;++i)rd(a[i]);\n    int q,opt,x,y,v;\n    for(int i=1;i<n;++i)\n        rd(x),rd(y),\n        add(x,y),add(y,x);\n    dfs(1),bt(1,1),build(1,n,1);\n    for(rd(q);q--;){\n        rd(opt),rd(x),rd(y);\n        if(opt==1)printf(\"%d\\n\",ask(x,y));\n        else rd(v),upd(x,y,v);\n    }\n}\n```\n\n## GSS2\n\n> \u9759\u6001\u533a\u95f4\u6700\u5927\u5b50\u6bb5\u548c,**\u76f8\u540c\u7684\u6570\u53ea\u7b97\u4e00\u6b21**\n\n\u96be\u5ea6\u6fc0\u589e\n\n\u53c2\u8003[\\[SDOI2009\\]HH\u7684\u9879\u94fe](https://www.luogu.com.cn/problem/P1972)\u7684\u505a\u6cd5\n\nGSS1\u7684\u5408\u5e76\u6700\u5927\u524d\u7f00\u548c,\u6700\u5927\u5b50\u6bb5\u548c,\u6700\u5927\u540e\u7f00\u548c\u7684\u65b9\u6cd5\u4ee5\u4e0d\u518d\u9002\u7528\n\n\u5bf9\u6bcf\u4e2a\u4f4d\u7f6e$i$\u6c42\u51fa\u4e0a\u4e00\u6b21\u51fa\u73b0\u76f8\u540c\u6570\u7684\u4f4d\u7f6e$pre_i$\n\n\u8fd8\u662f\u6309\u7167\u53f3\u7aef\u70b9\u6392\u5e8f,\u6309\u987a\u5e8f\u6dfb\u52a0\u5143\u7d20,\u6dfb\u52a0$a_i$\u65f6,\u66f4\u65b0$[pre_i-1,i]$\n\n\u7ebf\u6bb5\u6811\u6bcf\u4e2a\u8282\u70b9\u7ef4\u62a44\u4e2a\u503c,$sum,hismax,sumtag,hismaxtag$\u3002\n\n\u5bf9\u4e8e\u53f6\u5b50\u8282\u70b9:\n\n$sum$\u8868\u793a\u4ece\u8fd9\u4e2a\u53f6\u7ed3\u70b9\u6240\u5bf9\u5e94\u7684\u539f\u5e8f\u5217\u7684\u6240\u6709\u5143\u7d20\u548c\n\n$hismax$\u8868\u793a$sum$\u7684\u5386\u53f2\u6700\u5927\u503c\uff08\u6700\u5c0f\u4e3a0\uff09\n\n\u5bf9\u4e8e\u975e\u53f6\u5b50\u8282\u70b9:\n\n$sum$\u8868\u793a\u5de6\u53f3\u513f\u5b50\u7684$sum$\u7684\u6700\u5927\u503c,\n\n$hismax$\u8868\u793a\u5de6\u53f3\u513f\u5b50\u7684$hismax$\u7684\u6700\u5927\u503c\u3002\n\n\u67e5\u8be2\u533a\u95f4\u7684$hismax$\u5373\u53ef\n\n\u7279\u522b\u6ce8\u610f`pushdown()`\u51fd\u6570\u7684\u66f4\u65b0\u987a\u5e8f\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\ntemplate<class T>\nvoid rd(T&x){char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());if(f)x=-x;}\nll max(ll x,ll y){return x>y?x:y;}\nvoid cmax(ll&x,ll y){if(x<y)x=y;}\nconst int N=100001;\nint n,m,b[N<<1],pre[N];\nll a[N],ans[N];\nstruct node{ll s,hs,laz,hlaz;}s[N<<2];\nnode operator+(node a,node b){return {max(a.s,b.s),max(a.hs,b.hs),0,0};}\n#define ls rt<<1\n#define rs rt<<1|1\nvoid pd(int rt){\n    cmax(s[ls].hs,s[ls].s+s[rt].hlaz);\n    cmax(s[rs].hs,s[rs].s+s[rt].hlaz);\n    s[ls].s+=s[rt].laz;\n    s[rs].s+=s[rt].laz;\n    cmax(s[ls].hlaz,s[ls].laz+s[rt].hlaz);\n    cmax(s[rs].hlaz,s[rs].laz+s[rt].hlaz);\n    s[ls].laz+=s[rt].laz;\n    s[rs].laz+=s[rt].laz;\n    s[rt].laz=s[rt].hlaz=0;\n}\nvoid upd(int L,int R,ll v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        cmax(s[rt].hs,s[rt].s+=v);\n        cmax(s[rt].hlaz,s[rt].laz+=v);\n        return;\n    }\n    int m=l+r>>1;pd(rt);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nnode ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=l+r>>1;pd(rt);\n    if(L>m)return ask(L,R,m+1,r,rs);\n    else if(R<=m)return ask(L,R,l,m,ls);\n    else return ask(L,R,l,m,ls)+ask(L,R,m+1,r,rs);\n}\nstruct que{\n    int l,r,id;\n    bool operator<(que t){return r<t.r;}\n}q[N];\nint main(){\n    rd(n);\n    for(int i=1;i<=n;++i)\n        rd(a[i]),\n        pre[i]=b[a[i]+100000],\n        b[a[i]+100000]=i;\n    rd(m);\n    for(int i=1;i<=m;++i)\n        rd(q[i].l),rd(q[i].r),q[i].id=i;\n    std::sort(q+1,q+m+1);\n    for(int i=1,j=1;i<=n;++i){\n        upd(pre[i]+1,i,a[i],1,n,1);\n        for(;j<=m&&q[j].r<=i;++j)\n            ans[q[j].id]+=ask(q[j].l,q[j].r,1,n,1).hs;\n    }\n    for(int i=1;i<=m;++i)\n        printf(\"%lld\\n\",ans[i]);\n}\n```\n\n## GSS4\n\n> \u533a\u95f4\u5f00\u65b9(\u5411\u4e0b\u53d6\u6574),\u533a\u95f4\u6c42\u548c\n\n\u53ef\u4ee5\u53d1\u73b0$10^{18}$\u6b21\u65b9\u6700\u591a\u5f00\u65b9$6$\u6b21\u5c31\u4f1a\u53d8\u6210$1$\n\n\u90a3\u4e48\u6bcf\u4e2a\u6570\u90fd\u5728$6$\u6b21\u4ee5\u5185\u5c31\u4f1a\u53d8\u6210$1$,\u7136\u540e\u4e0d\u53d8,\u6240\u4ee5\u6700\u591a\u4fee\u6539$6\\times10^5$\u6b21\n\n\u6253\u6807\u8bb0\u8bb0\u5f55\u533a\u95f4\u662f\u5426\u90fd\u662f$1$,\u5982\u679c\u533a\u95f4\u88ab\u6807\u8bb0,\u5c31\u4e0d\u7528\u5411\u4e0b\u7ee7\u7eed\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\ntypedef long long ll;\nll s[N<<2];\nbool b[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\nvoid pu(int rt){s[rt]=s[ls]+s[rs],b[rt]=b[ls]&b[rs];}\nvoid build(int l,int r,int rt){\n    if(l==r){\n        scanf(\"%lld\",s+rt);\n        b[rt]=s[rt]<=1;\n        return;\n    }\n    int m=l+r>>1;\n    build(l,m,ls),build(m+1,r,rs);\n    pu(rt);\n}\nvoid upd(int L,int R,int l,int r,int rt){\n    if(b[rt])return;\n    if(l==r){\n        s[rt]=sqrt(s[rt]),\n        b[rt]=s[rt]<=1;\n        return;\n    }\n    int m=l+r>>1;\n    if(L<=m)upd(L,R,l,m,ls);\n    if(R>m)upd(L,R,m+1,r,rs);\n    pu(rt);\n}\nll ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=l+r>>1;\n    return ((L<=m)?ask(L,R,l,m,ls):0)+((R>m)?ask(L,R,m+1,r,rs):0);\n}\nint main(){\n    int n,q,opt,x,y,id=0;\n    while(~scanf(\"%d\",&n)){\n        printf(\"Case #%d:\\n\",++id);\n        build(1,n,1);\n        scanf(\"%d\",&q);\n        while(q--){\n            scanf(\"%d%d%d\",&opt,&x,&y);\n            if(x>y)x^=y,y^=x,x^=y;\n            if(opt)printf(\"%lld\\n\",ask(x,y,1,n,1));\n            else upd(x,y,1,n,1);\n        }\n    }\n}\n```\n\n## GSS8\n\n> \u7ed9\u4f60\u4e00\u4e2a\u5e8f\u5217,$A[0], A[1]...A[N - 1]. (0 \\le A[i] \\lt 2^{32})$\n> \n> \u4f60\u9700\u8981\u652f\u6301$Q$\u6b21\u64cd\u4f5c\n> \n> 1. `I pos val` \u63d2\u5165\u4e00\u4e2a\u6570\u5b57\u5728\u7b2c$pos$\u4e2a\u4f4d\u7f6e\u4e4b\u524d,$0 \\le val \\lt 2^{32}$, \u5982\u679c$pos=current_length$,\u90a3\u4e48\u4f60\u9700\u8981\u5c06\u8fd9\u4e2a\u6570\u5b57\u653e\u5230\u5e8f\u5217\u672b\u5c3e\n> 2. `D pos` \u5220\u9664\u7b2c$pos$\u4e2a\u5143\u7d20\n> 3. `R pos val` \u5c06\u7b2c$pos$\u4e2a\u5143\u7d20\u53d8\u4e3a$val(0 \\le val \\lt 2^{32})$\n> 4. `Q l r k` \u8be2\u95ee$(\\sum\\limits_{i=l}^{r} A[i] \\cdot (i - l + 1) ^ k) \\mod 2^{32}$,\u4fdd\u8bc1$0 \\le k \\le 10$\n> \n> \u7b2c\u4e00\u884c\u4e00\u4e2a\u6b63\u6574\u6570 $n$,\u63a5\u4e0b\u6765\u4e00\u884c $n$ \u4e2a\u6574\u6570,\u8868\u793a $a_0,a_1...a_{n-1}$\u3002  \n> \n> \u7b2c\u4e09\u884c\u4e00\u4e2a\u6574\u6570 $q$,\u8868\u793a\u64cd\u4f5c\u4e2a\u6570\u3002\n> \n> \u63a5\u4e0b\u6765 $q$ \u884c,\u6bcf\u884c\u8868\u793a\u4e00\u4e2a\u64cd\u4f5c\u3002\n> \n> \u6570\u636e\u70b9\u4fdd\u8bc1\uff1a\n> $1\\le n \\le 10^5,0 \\le q \\le 10^5$\n\n\u5e73\u8861\u6811\n\n\u7531\u4e8e$0\\le k \\le 10$,\u53ef\u4ee5\u7528$ans_k$\u50a8\u5b58\u5f53\u524d$k$\u7684\u533a\u95f4\u7b54\u6848\n\n\u8003\u8651\u5982\u4f55\u5408\u5e76\u5de6\u53f3\u513f\u5b50\u533a\u95f4($m=\\left\\lfloor\\frac{l+r}2\\right\\rfloor$):\n\n$$\n\\sum^r_{i=1}a_i(i-l+1)^k=\\sum^m_{i=1}a_i(i-l+1)^k+\\sum^r_{i=m+1}a_i(i-l+1)^k\n\\\\ \n\\begin{aligned}\n\\sum^r_{i=m+1}a_i(i-l+1)^k\n&=\\sum^r_{i=m+1}a_i[(m-l+1)-(i-m)]^k\\\\\n&=\\sum^r_{i=m+1}a_i \\sum_{j=0}^k{k\\choose j}(m-l+1)^{k-j}(i-m)^k\\\\\n&=\\sum_{j=0}^k{k\\choose j}(m-l+1)^{k-j}\\sum^r_{i=m+1}a_i(i-m)^k\\\\\n&=\\sum_{j=0}^k{k\\choose j}(m-l+1)^{k-j} rans_j\\\\\n\\end{aligned}\n\\\\\n\\sum^r_{i=1}a_i(i-l+1)^k=lans_k+\\sum_{j=0}^k{k\\choose j}(m-l+1)^{k-j} rans_j\n$$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u65b9\u4fbf\u5730\u5408\u5e76\u5de6\u53f3\u513f\u5b50\u533a\u95f4\u4e86\n\n```cpp\n#include<bits/stdc++.h>\n#define int unsigned int\nint rd(){int x=0;char c;for(c=getchar();c<'0'||'9'<c;c=getchar());for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return x;}\nconst int N=200001;\nint RT,cnt,sz[N],v[N],rnd[N],c[2][N],s[N][11],C[11][11],pw[11];\n#define ls c[0][x]\n#define rs c[1][x]\nvoid init(int x,int val){\n    v[x]=val;\n    for(int i=0;i<=10;++i)s[x][i]=val;\n}\nint ne(int val){\n    init(++cnt,val),rnd[cnt]=rand(),sz[cnt]=1;\n    return cnt;\n}\nvoid pu(int x){\n    sz[x]=sz[ls]+1+sz[rs];\n    for(int i=pw[0]=1;i<=10;++i)pw[i]=pw[i-1]*(sz[ls]+1);\n    for(int k=0;k<=10;++k){\n        s[x][k]=s[ls][k]+v[x]*pw[k];\n        for(int j=0;j<=k;++j)\n            s[x][k]+=C[k][j]*pw[k-j]*s[rs][j];\n    }\n}\nvoid sl(int x,int k,int &a,int &b){\n    if(!x){a=b=0;return;}\n    if(sz[ls]>=k)b=x,sl(ls,k,a,ls);\n    else a=x,sl(rs,k-sz[ls]-1,rs,b);\n    pu(x);\n}\nint mg(int x,int y){\n    if(!x||!y)return x|y;\n    if(rnd[x]<rnd[y]){\n        c[1][x]=mg(c[1][x],y);\n        pu(x);return x;\n    }\n    else{\n        c[0][y]=mg(x,c[0][y]);\n        pu(y);return y;\n    }\n}\nsigned main(){\n    srand(time(0));\n    for(int i=C[0][0]=1;i<=10;++i)\n        for(int j=C[i][0]=1;j<=i;++j)\n            C[i][j]=C[i-1][j]+C[i-1][j-1];\n    for(int n=rd();n--;)RT=mg(RT,ne(rd()));\n    char opt;\n    for(int q=rd(),x,y,z,l,r;q--;){\n        while(isspace(opt=getchar()));\n        if(opt=='I')\n            sl(RT,rd(),x,z),\n            RT=mg(x,mg(ne(rd()),z));\n        else if(opt=='D')\n            sl(RT,rd(),x,z),sl(z,1,y,z),\n            RT=mg(x,z);\n        else if(opt=='R')\n            sl(RT,rd(),x,z),sl(z,1,y,z),\n            init(y,rd()),\n            RT=mg(x,mg(y,z));\n        else if(opt=='Q')\n            l=rd()+1,r=rd()+1,\n            sl(RT,r,x,z),sl(x,l-1,x,y),\n            printf(\"%u\\n\",s[y][rd()]),\n            RT=mg(x,mg(y,z));\n    }\n}\n```", "link": "/posts/spoj gss \u7cfb\u5217/", "tags": ["\u6570\u636e\u7ed3\u6784", "\u7ebf\u6bb5\u6811", "\u5e73\u8861\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "OI\u77e5\u8bc6\u70b9\u601d\u7ef4\u5bfc\u56fe", "content": "## \u6570\u636e\u7ed3\u6784\n\n- \u6808\n  - \u5355\u8c03\u6808\n\n- \u961f\u5217\n  - \u5355\u8c03\u961f\u5217\n  - \u4f18\u5148\u961f\u5217\n  - \u53cc\u7aef\u961f\u5217\n  \n- \u5806\n  - \u4e8c\u53c9\u5806\n  - \u53ef\u5e76\u5806\n    - \u5de6\u504f\u6811\n    - \u914d\u5bf9\u5806\n    - \u6590\u6ce2\u90a3\u5951\u5806\n\n- \u5e76\u67e5\u96c6\n  - \u8def\u5f84\u538b\u7f29\n  - \u6309\u79e9\u5408\u5e76\n  - \u53ef\u6301\u4e45\u5316\u5e76\u67e5\u96c6\n\n- \u7ebf\u6bb5\u6811\n  - \u533a\u95f4\u52a0\n  - \u533a\u95f4\u4e58\n  - \u4e3b\u5e2d\u6811\n  - \u6807\u8bb0\u6c38\u4e45\u5316\n\n- \u6811\u72b6\u6570\u7ec4\n    - \u533a\u95f4\u52a0\u5355\u70b9\u67e5\n    - \u533a\u95f4\u52a0\u533a\u95f4\u67e5\n  \n- st\u8868(rmq)\n- \u5e73\u8861\u6811\n  - treap\n  - fhqtreap\n  - splay\n  - SBT\n  - \u66ff\u7f6a\u7f8a\u6811\n- kd-tree\n- link-cut tree\n- \u6811\u5957\u6811\n  - \u7ebf\u6bb5\u6811\u5957\u5e73\u8861\u6811\n  - \u7ebf\u6bb5\u6811\u5957\u7ebf\u6bb5\u6811\n- \u7b1b\u5361\u5c14\u6811\n\n## \u5b57\u7b26\u4e32\n\n- kmp\n  - exkmp\n- hash\n- trie\n- AC\u81ea\u52a8\u673a\n  - fail\u6811\n- \u540e\u7f00\u6570\u7ec4SA\n- \u540e\u7f00\u6811SAM\n- manacher\n- \u56de\u6587\u81ea\u52a8\u673a\n\n## \u6570\u8bba\n\n- \u5feb\u901f\u5e42 & \u6162\u901f\u4e58\n- \u8d28\u6570\n  - \u66b4\u529b\u5224\u65ad\n  - miller-rabbin\n  - \u7b5b\u8d28\u6570\n    - \u57c3\u7b5b\n    - \u6b27\u62c9\u7b5b\n  - \u5206\u89e3\u8d28\u56e0\u6570\n- gcd \n  - exgcd \n- \u8d39\u9a6c\u5c0f\u5b9a\u7406\n- \u9006\u5143\n  - \u7ebf\u6027\u6c42\u9006\u5143\n  - \u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u9006\u5143\n  - exgcd\u6c42\u9006\u5143\n- crt \n  - excrt\n- \u77e9\u9635\n  - \u77e9\u9635\u4e58\u6cd5\n  - \u77e9\u9635\u5feb\u901f\u5e42\n  - \u77e9\u9635\u6c42\u9006\n- \u884c\u5217\u5f0f\n- \u7ec4\u5408\u6570\n  - \u6768\u8f89\u4e09\u89d2\n  - lucas \n    - exlucas\n- bsgs\n  - exbsgs\n- \u6b27\u62c9\u51fd\u6570\n  - \u7ebf\u6027\u7b5b\u6b27\u62c9\u51fd\u6570\n  - \u6b27\u62c9\u5b9a\u7406\n- \u72c4\u5229\u514b\u96f7\u5377\u79ef\n- \u83ab\u6bd4\u4e4c\u65af\u51fd\u6570 \n  - \u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n- \u6982\u7387\u548c\u671f\u671b\n- \u9ad8\u65af\u6d88\u5143\n- \u7ebf\u6027\u57fa\n- \u6570\u5217\n  - \u6590\u6ce2\u90a3\u5951\u6570\u5217\n  - \u5361\u7279\u6797\u6570\n  - \u65af\u7279\u6797\u6570\n    - \u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\n    - \u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\n- Polya\u5b9a\u7406\n- \u7f6e\u6362\u7fa4\n- \u539f\u6839\n- \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362(FFT)\n  - \u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362(DFT)\n  - \u79bb\u6563\u5085\u91cc\u53f6\u9006\u53d8\u6362(IDFT)\n  - \u5feb\u901f\u6570\u8bba\u53d8\u6362(NTT)\n  - \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u7684\u4f18\u5316\u7248(FNTT)\n  - \u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362(FWT)\n  - \u4efb\u610f\u6a21\u6570FFT(MTT)\n  - \u5feb\u901f\u83ab\u6bd4\u4e4c\u65af\u53d8\u5316(FMT)\n\n- \u62c9\u683c\u6717\u65e5\n  - \u62c9\u683c\u6717\u65e5\u63d2\u503c\n  - \u62c9\u683c\u6717\u65e5\u4e58\u5b50\u6cd5\n  - \u62c9\u683c\u6717\u65e5\u56db\u5e73\u65b9\u548c\u5b9a\u7406\n\n- \u7ebf\u6027\u89c4\u5212\n</details>\n\n## \u52a8\u6001\u89c4\u5212\n\n- \u7ebf\u6027dp\n- \u80cc\u5305dp\n  - 01\u80cc\u5305\n  - \u5b8c\u5168\u80cc\u5305\n  - \u591a\u91cd\u80cc\u5305\n    - \u4e8c\u8fdb\u5236\u4f18\u5316\u591a\u91cd\u80cc\u5305\n- \u533a\u95f4dp\n- \u72b6\u538bdp\n- \u6811\u5f62dp\n  - \u57fa\u73af\u6811dp\n- DAG\u4e0adp\n- \u591a\u7ef4dp\n- \u671f\u671bdp\n- \u6570\u4f4ddp\n- \u52a8\u6001dp\n- dp\u7684\u4f18\u5316\n  - \u6570\u636e\u7ed3\u6784\u4f18\u5316dp\n    - \u7ebf\u6bb5\u6811\u4f18\u5316dp\n    - \u5355\u8c03\u961f\u5217\u4f18\u5316dp\n  - \u659c\u7387\u4f18\u5316\n  - \u51b3\u7b56\u5355\u8c03\u6027\n\n## \u6811\u8bba\n\n- \u751f\u6210\u6811\n- LCA\n  - \u6811\u94fe\u5256\u5206\n    - \u6811\u94fe\u5256\u5206\u6362\u6839\n  - \u500d\u589e\n  - tarjan\u79bb\u7ebf\n- \u865a\u6811\n- \u57fa\u73af\u6811\n- \u6811\u94fe\u5256\u5206\n  - \u91cd\u94fe\u5256\u5206\n  - \u5b9e\u94fe\u5256\u5206\n  - \u957f\u94fe\u5256\u5206\n- dfs\u5e8f\n  - \u6b27\u62c9\u5e8f\n- \u6811\u5206\u6cbb\n  - \u70b9\u5206\u6cbb\n    - \u6811\u7684\u76f4\u5f84\n    - \u6811\u7684\u91cd\u5fc3\n  - \u52a8\u6001\u70b9\u5206\u6cbb\n  - \u9759\u6001\u94fe\u5206\u6cbb\n- \u6811\u4e0a\u500d\u589e\n- \u6811\u5206\u5757\n- link-cut tree\n- top tree\n- zip tree\n\n## \u56fe\u8bba\n\n- \u6700\u77ed\u8def\n  - spfa\n    - \u5224\u65ad\u8d1f\u73af\n    - \u5806\u4f18\u5316\n  - dijkstra\n    - \u5806\u4f18\u5316\n    - \u7ebf\u6bb5\u6811\u4f18\u5316\n  - floyed\n    - \u500d\u589efloyed\n  - k\u77ed\u8def\n  - \u5dee\u5206\u7ea6\u675f\n- tarjan\n  - \u5f3a\u8fde\u901a\u5206\u91cf(\u7f29\u70b9)\n  - \u53cc\u8fde\u901a\u5206\u91cf\n  - \u5272\u70b9,\u5272\u8fb9,\u6865\n  - 2-sat\n- \u62d3\u6251\u6392\u5e8f\n- \u4e8c\u5206\u56fe\n  - \u5308\u7259\u5229\n  - \u7f51\u7edc\u6d41\n  - KM\n- \u7f51\u7edc\u6d41\n  - \u6700\u5927\u6d41(\u6700\u5c0f\u5272)\n    - dinic\n    - isap\n  - \u6700\u5c0f\u8d39\u7528\u6700\u5927\u6d41\n    - spfa\u8d39\u7528\u6d41\n    - zkw\u8d39\u7528\u6d41\n  - \u6709\u4e0a\u4e0b\u754c\u7684\u7f51\u7edc\u6d41\n  - \u6570\u636e\u7ed3\u6784\u4f18\u5316\u7f51\u7edc\u6d41\n  - \u5206\u6570\u89c4\u5212\n\n- \u6b27\u62c9\u56fe\n- \u533a\u95f4\u56fe\u4e0e\u5f26\u56fe\n- \u5e73\u9762\u56fe\u4e0e\u5bf9\u5076\u56fe\n- \u6700\u5c0f\u6811\u5f62\u56fe\n- \u4ed9\u4eba\u638c\n  - \u52a8\u6001\u4ed9\u4eba\u638c\n\n\n## STL\n\n- map\n  - unordered_map\n- set\n  - multiset\n- stack\n- queue\n- deque\n- priority_queue\n- vector\n- list\n- bitset\n\n## \u641c\u7d22\n\n- dfs\n- bfs\n  - \u53cc\u5411bfs\n- A*\n- IDA*\n- DLX\n- \u8bb0\u5fc6\u5316\u641c\u7d22\n- \u526a\u679d\n- \u6a21\u62df\u9000\u706b\n- \u722c\u5c71\u7b97\u6cd5\n- \u968f\u673a\u5316\n\n## \u8ba1\u7b97\u51e0\u4f55\n\n- \u5411\u91cf\n  - \u70b9\u79ef\n  - \u53c9\u79ef\n- \u51f8\u5305\n- \u65cb\u8f6c\u5361\u58f3\n- \u626b\u63cf\u7ebf\n</details>\n\n## \u5176\u4ed6\u7b97\u6cd5\u4e0e\u601d\u60f3\n\n- \u4e8c\u5206\n  - \u4e09\u5206\n  - \u6574\u4f53\u4e8c\u5206\n  - 01\u5206\u6570\u89c4\u5212\n\n- \u500d\u589e\n- \u8d2a\u5fc3\n- \u679a\u4e3e\n- \u66b4\u529b\n- \u6a21\u62df\n- \u5206\u6cbb\n  - cdq\u5206\u6cbb\n  - \u7ebf\u6bb5\u6811\u5206\u6cbb\n- \u79bb\u6563\u5316\n- meet in the middle\n- \u6392\u5e8f\n  - \u5feb\u901f\u6392\u5e8f\n  - \u5f52\u5e76\u6392\u5e8f\n    - \u6c42\u9006\u5e8f\u5bf9\n  - \u6876\u6392\n  - \u57fa\u6570\u6392\u5e8f\n  - \u8ba1\u6570\u6392\u5e8f\n  - \u5806\u6392\u5e8f\n- \u5206\u5757\n- \u968f\u673a\u5316\n- \u524d\u7f00\u548c\n  - \u4e8c\u7ef4\u524d\u7f00\u548c\n- \u9ad8\u7cbe\u5ea6\n  - \u538b\u4f4d\n- \u9012\u63a8\n  - \u77e9\u9635\u52a0\u901f\u9012\u63a8\n- \u4f4d\u8fd0\u7b97\n- \u83ab\u961f\n  - \u6811\u4e0a\u83ab\u961f\n  - \u5e26\u4fee\u83ab\u961f\n- \u6253\u8868\n- \u8001\u53f8\u673a\u6811\n", "link": "/posts/OI\u77e5\u8bc6\u70b9\u601d\u7ef4\u5bfc\u56fe/", "tags": [], "categories": [["note"]]}, {"title": "\u540e\u7f00\u6570\u7ec4", "content": "## \u7b80\u4ecb\n\n\u540e\u7f00\u6570\u7ec4,\u53c8\u79f0`SA`\n\n\u662fOI\u4e2d\u5904\u7406\u5b57\u7b26\u4e32\u7684\u6709\u529b\u5de5\u5177\n\n## \u5b9e\u73b0\n\n\u6709\u4e24\u79cd\u5b9e\u73b0\u7684\u65b9\u6cd5\n\n1. \u500d\u589e\u6cd5\n2. DC3\n\n\u8fd9\u91cc\u4e3b\u8981\u8bb2\u500d\u589e\u6cd5\n\n`sa[i]`\u8868\u793a\u6240\u6709\u540e\u7f00\u4e2d\u7684\u5b57\u5178\u5e8f\u6392\u540d\u4e3a$i$\u7684\u540e\u7f00\u7684\u8d77\u59cb\u4f4d\u7f6e\n\n`rnk[i]`\u8868\u793a\u8d77\u59cb\u4f4d\u7f6e\u4e3a$i$\u7684\u540e\u7f00(\u540e\u7f00$i$)\u5728\u6240\u6709\u540e\u7f00\u4e2d\u7684\u6392\u540d\n\n\u56fe\u89e3:\n\n![](1.png)\n\n\u4ece\u957f\u5ea6$1$\u7684\u5757\u5f00\u59cb\u6392\u5e8f,\u63a5\u7740\u662f\u957f\u5ea6\u4e3a$2$,\u7136\u540e\u6bcf\u6b21\u957f\u5ea6\u90fd\u500d\u589e\n\n\u7b2c\u4e00\u6b21\u76f4\u63a5\u5bf9\u6240\u6709\u5b57\u7b26\u8fdb\u884c\u6392\u5e8f\n\n\u6bcf\u6b21\u5c06\u5f53\u524d\u5757\u5206\u4e3a\u76f8\u7b49\u7684\u4e24\u6bb5,\u8fd9\u4e24\u6bb5\u7684\u6392\u540d\u4e0a\u4e00\u8f6e\u5df2\u7ecf\u6c42\u51fa\u4e86,\u53d8\u6210\u4e00\u4e2a\u4e8c\u5143\u7ec4$(a,b)$\n\n\u6bd4\u8f83\u4e24\u4e2a\u5757\u76f8\u5f53\u4e8e\u6bd4\u8f83\u4e24\u4e2a\u4e8c\u5143\u7ec4\n\n\u4e00\u76f4\u500d\u589e\u77e5\u9053\u5757\u957f\u5927\u4e8e\u5b57\u7b26\u4e32\u957f\u5ea6,\u7ec8\u6b62\u5373\u53ef\n\n\u8fd9\u91cc\u7684\u6392\u5e8f\u4f7f\u7528\u57fa\u6570\u6392\u5e8f\u52a0\u5feb\u901f\u5ea6\n\n[LG P3809 \u3010\u6a21\u677f\u3011\u540e\u7f00\u6392\u5e8f](https://www.luogu.com.cn/problem/P3809)\n\n```cpp\n#include<bits/stdc++.h>\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nconst int N=1000001;\nchar s[N];\nint n,m,sa[N],rnk[N],tp[N],tax[N];\nvoid qsort(){//\u5bf9(rnk[i],tp[i])\u8fdb\u884c\u6392\u5e8f\n    // tax[i]: i\u53f7\u5143\u7d20\u51fa\u73b0\u4e86\u591a\u5c11\u6b21\n    fur(i,0,m)tax[i]=0;\n    fur(i,1,n)++tax[rnk[i]];\n    fur(i,1,m)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)\n        sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=75;\n    fur(i,1,n)rnk[i]=s[i]-'a'+1,tp[i]=i;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        fur(i,1,w)tp[++p]=n-w+i;\n        fur(i,1,n)if(sa[i]>w)\n            tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        fur(i,2,n)\n            rnk[sa[i]]=p+=tp[sa[i-1]]^tp[sa[i]]||tp[sa[i-1]+w]^tp[sa[i]+w];\n    }\n}\nint main(){\n    scanf(\"%s\",s+1),n=strlen(s+1);\n    suffix();\n    fur(i,1,n)printf(\"%d \",sa[i]);\n}\n```\n\n## height\u6570\u7ec4\n\n\u5355\u7eaf\u770b`sa`\u6570\u7ec4,\u53ef\u80fd\u6ca1\u4ec0\u4e48\u7528\n\n\u6211\u4eec\u5b9a\u4e49`height[i]`\u8868\u793a\u540e\u7f00`sa[i]`\u4e0e\u540e\u7f00`sa[i-1]`\u7684\u6700\u957f\u516c\u5171\u524d\u7f00(`LCP`)\n\n\u4ed4\u7ec6\u601d\u8003\u53ef\u4ee5\u53d1\u73b0,\u540e\u7f00$j$\u548c\u540e\u7f00$k$($rnk_j<rnk_k$)\u7684\u6700\u957f\u516c\u5171\u524d\u7f00\u4e3a:\n\n$$\\min_{i=rnk_j}^{rnk_k}\\left\\{height_i\\right\\}$$\n\n\u8fd9\u6837\u4e00\u6765\u5efa\u7acb\u4e00\u4e2a`ST`\u8868\u5c31\u53ef\u4ee5\u5feb\u901f\u6c42\u51fa\u4efb\u610f\u4e24\u4e2a\u540e\u7f00\u7684`LCP`\u4e86\n\n\u5982\u679c\u76f4\u63a5\u901a\u8fc7\u679a\u4e3e\u8ba1\u7b97`height`\u6570\u7ec4,\u65f6\u95f4\u590d\u6742\u5ea6\u4e3a$\\Theta(n^2)$\n\n\u5982\u4f55\u5feb\u901f\u6c42`height`\u6570\u7ec4\uff1f\n\n\u518d\u5b9a\u4e49`H[i]=height[rnk[i]]`\n\n\u7ed3\u8bba: $H_i\\ge H_{i-1}-1$\n\n![](height.png)\n\n\u6d45\u84dd\u7684\u662f`H[i-1]`\u7684\u7ed3\u679c,\u84dd\u8272\u90e8\u5206\u6700\u591a\u6bd4\u6d45\u84dd\u90e8\u5206\u5c11\u4e86\u5f00\u5934\u4e00\u5c0f\u6bb5\n\n\u7ea2\u7ebf\u622a\u53d6\u7684\u90e8\u5206\u4e5f\u4e00\u5b9a\u662f\u76f8\u540c\u7684\n\n\u6240\u4ee5$H_i\\ge H_{i-1}-1$\n\n\u6309\u7167`H[1],H[2],...,H[n]`\u7684\u987a\u5e8f\u8ba1\u7b97,\u5e76\u5229\u7528`H`\u6570\u7ec4\u7684\u6027\u8d28,\u65f6\u95f4\u590d\u6742\u5ea6\u53ef\u4ee5\u964d\u4e3a$\\Theta(n)$\n\n```cpp\nint height[N];\nvoid get_height(){\n    for(int i=1,k=0;i<=n;++i){\n\t\tif(k)--k;\n\t\tint j=sa[rnk[i]-1];\n\t\twhile(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n\t\theight[rnk[i]]=k; \n\t}\n}\n```\n\n## \u6700\u957f\u516c\u5171\u5b50\u4e32\n\n1. \u8fde\u63a5\u4e24\u4e2a\u5b57\u7b26\u4e32\n2. \u6c42$sa,rnk,height$\n3. \u6c42\u6392\u540d\u76f8\u90bb\u4f46\u539f\u6765\u4e0d\u5728\u540c\u4e00\u4e2a\u5b57\u7b26\u4e32\u4e2d\u7684\u4e24\u4e2a\u540e\u7f00\u7684`height`\u503c\u7684\u6700\u5927\u503c\u3002\n   \n\u65f6\u95f4\u590d\u6742\u5ea6$\\Theta(A+B)$\u5df2\u7ecf\u53d6\u5230\u4e0b\u9650,\u7531\u6b64\u770b\u51fa,\u8fd9\u662f\u4e00\u4e2a\u975e\u5e38\u4f18\u79c0\u7684\u7b97\u6cd5\u3002\n\n![](lcs.png)\n\n## \u4e60\u9898\n\n[LG P5546 \\[POI2000\\]\u516c\u5171\u4e32](https://www.luogu.com.cn/problem/P5546)\n\n\u591a\u4e2a\u5b57\u7b26\u4e32\u7684\u5171\u540c\u5b50\u4e32\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=10111;\nint cnt,n,m,sa[N],rnk[N],height[N],tax[N],tp[N];\nchar s[N];\nvoid qsort(){\n    for(int i=0;i<=m;++i)tax[i]=0;\n    for(int i=1;i<=n;++i)++tax[rnk[i]];\n    for(int i=1;i<=m;++i)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)\n        sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=100;\n    for(int i=1;i<=n;++i)tp[i]=i,rnk[i]=s[i]-'a'+1;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        for(int i=1;i<=w;++i)tp[++p]=n-w+i;\n        for(int i=1;i<=n;++i)if(sa[i]>w)\n            tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        for(int i=2;i<=n;++i)\n            rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n}\nvoid get_height(){\n    for(int i=1,k=0;i<=n;++i){\n        if(k)--k;\n        int j=sa[rnk[i]-1];\n        while(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n        height[rnk[i]]=k;\n    }\n}\nint col[N],L[N],R[N],v[N],tot;\nvoid add(int x){if(col[x])if(++v[col[x]]==1)++tot;}\nvoid del(int x){if(col[x])if(!--v[col[x]])--tot;}\nvoid cmax(int &x,int y){if(x<y)x=y;}\nint main(){\n    scanf(\"%d\",&cnt);\n    for(int i=1;i<=cnt;++i)\n        L[i]=n+1,\n        scanf(\"%s\",s+n+1),\n        s[n=strlen(s+1)+1]=i+'a'-1,\n        R[i]=n-1;\n    suffix();\n    get_height();\n    for(int i=1;i<=cnt;++i)\n        for(int j=L[i];j<=R[i];++j)\n            col[rnk[j]]=i;\n    using std::deque;\n    deque<int>q;\n\tint l=1,ans=0;\n\tadd(1);\n\tfor(int r=2;r<=n;++r){\n\t\twhile(!q.empty()&&height[q.back()]>=height[r])q.pop_back();\n\t\tq.emplace_back(r);\n\t\tadd(r);\n\t\tif(tot==cnt){\n\t\t\twhile(tot==cnt&&l<r)del(l++);\n\t\t\tadd(--l);\n\t\t}\n\t\twhile(!q.empty()&&q.front()<=l) q.pop_front();\n\t\tif(tot==cnt)cmax(ans,height[q.front()]);\n\t}\n    printf(\"%d\\n\",ans);\n}\n```\n\n[\\[SCOI2012\\]\u55b5\u661f\u7403\u4e0a\u7684\u70b9\u540d](https://www.luogu.com.cn/problem/P2336)\n", "link": "/posts/sa/", "tags": ["\u5b57\u7b26\u4e32", "\u540e\u7f00\u6570\u7ec4"], "categories": [["\u7b97\u6cd5", "\u5b57\u7b26\u4e32"], ["note"]]}, {"title": "\u7ebf\u6bb5\u6811\u5206\u6cbb", "content": "\u6838\u5fc3\u601d\u60f3: \u628a\u4e00\u4e2a\u4fee\u6539\u770b\u6210\u4e00\u4e2a\u533a\u95f4,\u6bcf\u4e2a\u8be2\u95ee\u662f\u4e00\u4e2a\u53f6\u5b50,\u4fee\u6539\u5728\u7ebf\u6bb5\u6811\u4e0a\u6253\u6807\u8bb0\n\n", "link": "/posts/\u7ebf\u6bb5\u6811\u5206\u6cbb/", "tags": ["\u7b97\u6cd5", "\u79bb\u7ebf"], "categories": [["\u7b97\u6cd5", "\u79bb\u7ebf"], ["note"]]}, {"title": "k-d tree", "content": "## \u7b80\u4ecb\n\n`k-D Tree(KDT,k-Dimension Tree)`\u662f\u4e00\u79cd\u53ef\u4ee5\u9ad8\u6548\u5904\u7406$k$\u7ef4\u7a7a\u95f4\u4fe1\u606f\u7684\u6570\u636e\u7ed3\u6784\u3002\n\n[\u7ef4\u57fa\u767e\u79d1](https://wiki.zcmimi.workers.dev/wiki/K-d%E6%A0%91)\n\n\u5728\u7b97\u6cd5\u7ade\u8d5b\u7684\u9898\u76ee\u4e2d,\u4e00\u822c$k=2$\n\n## \u6784\u5efa\n\n`KDT`\u672c\u8d28\u4e0a\u662f\u4e8c\u53c9\u641c\u7d22\u6811,\u6bcf\u4e2a\u8282\u70b9\u5bf9\u5e94\u5750\u6807\u7cfb\u4e2d\u7684\u67d0\u4e2a\u70b9\n\n\u5df2\u77e5$k$\u7ef4\u7a7a\u95f4\u4e2d\u6709$n$\u4e2a\u70b9,\u8981\u600e\u4e48\u6784\u5efa\u6210`KDT`\u5462\n\n1. \u82e5\u53ea\u5269\u4e00\u4e2a\u70b9,\u8fd4\u56de\u8fd9\u4e2a\u70b9\n\n2. \u9009\u62e9\u4e00\u4e2a\u7ef4\u5ea6,\u5c06\u7a7a\u95f4\u5212\u5206\u4e3a\u4e24\u4e2a\n   \n3. \u5728\u9009\u62e9\u7684\u7ef4\u5ea6\u4e0a\u9009\u62e9\u4e00\u4e2a\u5207\u5272\u70b9,\u4f5c\u4e3a\u5f53\u524d\u5b50\u6811\u7684\u6839\u8282\u70b9,\u6839\u636e \u8fd9\u4e2a\u7ef4\u5ea6 \u628a \u5207\u5272\u70b9 \u4e24\u8fb9\u7684\u70b9\u5206\u522b\u5212\u5206\u5230 \u5de6\u5b50\u6811 \u548c \u53f3\u5b50\u6811\n   \n4. \u7ee7\u7eed\u9012\u5f52\u5904\u7406\u5de6\u5b50\u6811\u548c\u53f3\u5b50\u6811\n\n\n> ![](3dtree.png)\n> \n> \u4e00\u4e2a\u4e09\u7ef4k-d\u6811\u3002\n> \n> \u7b2c\u4e00\u6b21\u5212\u5206\uff08\u7ea2\u8272\uff09\u628a\u6839\u8282\u70b9\uff08\u767d\u8272\uff09\u5212\u5206\u6210\u4e24\u4e2a\u8282\u70b9,\n> \n> \u7136\u540e\u5b83\u4eec\u5206\u522b\u518d\u6b21\u88ab\u5212\u5206\uff08\u7eff\u8272\uff09\u4e3a\u4e24\u4e2a\u5b50\u8282\u70b9\u3002\n> \n> \u6700\u540e\u8fd9\u56db\u4e2a\u5b50\u8282\u70b9\u7684\u6bcf\u4e00\u4e2a\u90fd\u88ab\u5212\u5206\uff08\u84dd\u8272\uff09\u4e3a\u4e24\u4e2a\u5b50\u8282\u70b9\u3002\n> \n> \u56e0\u4e3a\u6ca1\u6709\u66f4\u8fdb\u4e00\u6b65\u7684\u5212\u5206,\u6700\u540e\u5f97\u5230\u7684\u516b\u4e2a\u8282\u70b9\u79f0\u4e3a\u53f6\u5b50\u8282\u70b9\u3002\n\n> ![](2dtree.jpg)\n> \n> \u5176\u6784\u5efa\u51fa k-D Tree \u7684\u5f62\u6001\u53ef\u80fd\u662f\u8fd9\u6837\u7684\uff1a\n> \n> ![](2dtree_.jpg)\n\n\u5982\u679c\u53ea\u662f\u8fd9\u6837\u5efa\u6811,\u590d\u6742\u5ea6\u65e0\u6cd5\u4fdd\u8bc1\n\n\u4f18\u5316\uff1a\n\n1. \u6bcf\u6b21\u9009\u62e9\u7684\u5207\u5272\u7ef4\u5ea6\u662f**\u65b9\u5dee\u6700\u5927**\u7684\u7ef4\u5ea6\n   \n2. \u5207\u5272\u70b9\u9009\u62e9\u8be5\u7ef4\u5ea6\u4e0a\u7684**\u4e2d\u4f4d\u6570**,\u4fdd\u8bc1\u5212\u5206\u540e\u5de6\u53f3\u5b50\u6811\u5927\u5c0f\u5927\u81f4\u76f8\u7b49\n\n\u53ef\u4ee5\u53d1\u73b0\u4f7f\u7528\u4f18\u5316\u4e8c\u540e,\u6784\u5efa\u51fa\u7684`KDT`\u6811\u9ad8\u6700\u591a\u4e3a$\\log n$\n\n\u4f18\u5316\u4e00\u4e5f\u53ef\u4ee5\u6362\u6210\u6bcf\u6b21\u5207\u5272\u540e\u90fd\u6362\u53e6\u4e00\u4e2a\u7ef4\u5ea6\u5207\u5272\n\n## \u63d2\u5165\n\n\u5728\u63d2\u5165\u4e00\u4e2a$k$\u7ef4\u70b9\u65f6,\u5148\u6839\u636e\u8bb0\u5f55\u7684\u5206\u5272\u7ef4\u5ea6\u548c\u5206\u5272\u70b9\u5224\u65ad\u5e94\u8be5\u7ee7\u7eed\u63d2\u5165\u5230\u5de6\u5b50\u6811\u8fd8\u662f\u53f3\u5b50\u6811,\u5982\u679c\u5230\u8fbe\u4e86\u7a7a\u7ed3\u70b9,\u65b0\u5efa\u4e00\u4e2a\u7ed3\u70b9\u4ee3\u66ff\u8fd9\u4e2a\u7a7a\u7ed3\u70b9\u3002\n\n## \u5e73\u8861\n\n\u5982\u679c\u6570\u636e\u7ecf\u8fc7\u4e86\u6784\u9020,\u53ef\u80fd\u4f1a\u9020\u6210`KDT`\u53d8\u6210\u94fe\n\n\u8981\u600e\u4e48\u7ef4\u62a4`KDT`\u7684\u5e73\u8861\u6027\u5462\uff1f\n\n\u7531\u4e8e`KDT`\u7684\u6784\u9020,\u4e0d\u80fd\u652f\u6301\u65cb\u8f6c,\u7c7b\u4f3c\u4e0e`fhqtreap`\u7684\u968f\u673a\u4f18\u5148\u7ea7\u4e5f\u4e0d\u80fd\u4fdd\u8bc1\u5176\u590d\u6742\u5ea6,\u53ef\u4ee5\u4fdd\u8bc1\u5e73\u8861\u6027\u7684\u624b\u6bb5\u53ea\u6709\u7c7b\u4f3c\u4e8e**\u66ff\u7f6a\u7f8a\u6811**\u7684\u91cd\u6784\u601d\u60f3\u3002\n\n\u6211\u4eec\u5f15\u5165\u4e00\u4e2a\u91cd\u6784\u5e38\u6570$\\alpha$,\u5bf9\u4e8e`KDT`\u4e0a\u7684\u4e00\u4e2a\u7ed3\u70b9$x$,\u82e5\u5176\u6709\u4e00\u4e2a\u5b50\u6811\u7684\u7ed3\u70b9\u6570\u5728\u4ee5$x$\u4e3a\u6839\u7684\u5b50\u6811\u7684\u7ed3\u70b9\u6570\u4e2d\u7684\u5360\u6bd4\u5927\u4e8e$\\alpha$,\u5219\u8ba4\u4e3a\u4ee5$x$\u4e3a\u6839\u7684\u5b50\u6811\u662f\u4e0d\u5e73\u8861\u7684,\u9700\u8981\u91cd\u6784\u3002\n\n\u91cd\u6784\u65f6,\u4e2d\u5e8f\u904d\u5386\u5b50\u6811\u5f97\u5230\u539f\u5e8f\u5217,\u7136\u540e\u91cd\u65b0\u6784\u5efa\u51fa\u4e00\u68f5`KDT`,\u4ee3\u66ff\u539f\u6765\u4e0d\u5e73\u8861\u7684\u5b50\u6811\u3002\n\n\u6240\u4ee5\uff1a\u6210\u529f\u63d2\u5165\u7ed3\u70b9\u540e\u56de\u6eaf\u63d2\u5165\u7684\u8fc7\u7a0b,\u7ef4\u62a4\u7ed3\u70b9\u7684\u4fe1\u606f,\u5982\u679c\u53d1\u73b0\u5f53\u524d\u7684\u5b50\u6811\u4e0d\u5e73\u8861,\u5219\u91cd\u6784\u5f53\u524d\u5b50\u6811\u3002\n\n## \u90bb\u57df\u67e5\u8be2\n\n[LG 1429 \u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\uff08\u52a0\u5f3a\u7248)](https://www.luogu.org/problem/P1429)\n\n\u9996\u5148: \u6784\u5efa`KDT`\n\n\u5bf9\u6bcf\u4e2a\u70b9\u5206\u522b\u8fdb\u884c\u67e5\u8be2,\u4e5f\u5c31\u662f\u641c\u7d22\n\n\u76f4\u63a5\u5bf9`KDT`\u8fdb\u884c\u904d\u5386\u6bcf\u6b21\u641c\u7d22\u7684\u590d\u6742\u5ea6\u662f`O(n)`\u7684,\u663e\u7136`TLE`\n\n\u8fd9\u65f6\u6211\u4eec\u9700\u8981\u4f30\u4ef7\u51fd\u6570,\u5728\u8fd9\u91cc\u4e5f\u5c31\u662f: \n\n\u4f30\u7b97\u51fa\u67e5\u8be2\u70b9\u5230\u5b50\u6811\u5bf9\u5e94\u7684\u957f\u65b9\u5f62\u4e2d\u7684\u70b9\u7684\"\u6700\u8fd1\u8ddd\u79bb\"\n\n\u82e5\"\u6700\u8fd1\u8ddd\u79bb\"\u5df2\u7ecf\u8d85\u8fc7\u4e86\u5f53\u524d\u7b54\u6848,\u5c31\u8df3\u8fc7\u5f53\u524d\u5b50\u6811.\n\n\u641c\u7d22\u65f6\u6bd4\u8f83\u5de6\u53f3\u5b50\u6811\u7684\"\u6700\u8fd1\u8ddd\u79bb\",\u5148\u641c\u7d22\"\u6700\u8fd1\u8ddd\u79bb\"\u5c0f\u7684\n\n```cpp\n#include<bits/stdc++.h>\ntypedef double db;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nconst int N=200011,inf=2122219134;\nint n,id,ls[N],rs[N];\ndb ans=2e18,L[N],R[N],D[N],U[N];\nstruct node{db x,y;}t[N];\nbool cmpx(node p,node q){return p.x<q.x;}\nbool cmpy(node p,node q){return p.y<q.y;}\ndb min(db x,db y){return x<y?x:y;}\ndb max(db x,db y){return x>y?x:y;}\nvoid upd(int x,int y){\n    L[x]=min(L[x],L[y]),R[x]=max(R[x],R[y]),\n    D[x]=min(D[x],D[y]),U[x]=max(U[x],U[y]);\n}\nvoid pu(int x){\n    L[x]=R[x]=t[x].x;\n    D[x]=U[x]=t[x].y;\n    if(ls[x])upd(x,ls[x]);\n    if(rs[x])upd(x,rs[x]);\n}\nint build(int l,int r){\n    if(l>r)return 0;\n    int m=l+r>>1;\n    db ax=0,ay=0,vx=0,vy=0;\n    fur(i,l,r)ax+=t[i].x,ay+=t[i].y;\n    ax/=(db)(r-l+1),ay/=(db)(r-l+1);\n    fur(i,l,r)\n        vx+=(ax-t[i].x)*(ax-t[i].x),\n        vy+=(ay-t[i].y)*(ay-t[i].y);\n    std::nth_element(t+l,t+m,t+r+1,vx>vy?cmpx:cmpy);\n    ls[m]=build(l,m-1),rs[m]=build(m+1,r),pu(m);\n    return m;\n}\ndb dis(int p){return (t[p].x-t[id].x)*(t[p].x-t[id].x)+(t[p].y-t[id].y)*(t[p].y-t[id].y);}\ndb f(int p){\n    db res=0;\n    if(L[p]>t[id].x)res+=(L[p]-t[id].x)*(L[p]-t[id].x);\n    if(R[p]<t[id].x)res+=(t[id].x-R[p])*(t[id].x-R[p]);\n    if(D[p]>t[id].y)res+=(D[p]-t[id].y)*(D[p]-t[id].y);\n    if(U[p]<t[id].y)res+=(t[id].y-U[p])*(t[id].y-U[p]);\n    return res;\n}\nvoid qry(int l,int r){\n    if(l>r)return;\n    int m=l+r>>1;\n    if(m!=id)ans=min(ans,dis(m));\n    if(l==r)return;\n    db ld=f(ls[m]),rd=f(rs[m]);\n    if(ld<rd){\n        if(ld<ans)qry(l,m-1);\n        if(rd<ans)qry(m+1,r);\n    }\n    else{\n        if(rd<ans)qry(m+1,r);\n        if(ld<ans)qry(l,m-1);\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    fur(i,1,n)scanf(\"%lf%lf\",&t[i].x,&t[i].y);\n    build(1,n);\n    fur(i,1,n)id=i,qry(1,n);\n    printf(\"%.4f\\n\",sqrt(ans));\n}\n```\n\n[LG 2093 \\[\u56fd\u5bb6\u96c6\u8bad\u961f\\]JZPFAR](https://www.luogu.com.cn/problem/P2093)\n\n\u601d\u8def\u4e0e\u4e0a\u4e00\u9898\u5dee\u4e0d\u591a\n\n\u53ef\u4ee5\u7528\u5806\u52a8\u6001\u7ef4\u62a4\u7b2c$k$\u5927\n\n\u53ea\u9700\u8981\u5f00\u4e00\u4e2a\u5c0f\u6839\u5806,\u5148\u63d2\u5165$k$\u4e2a\u70b9(\u5360\u4f4d)\n\n\u6bcf\u6b21\u627e\u5230\u4e00\u4e2a\u70b9,\u82e5\u8ddd\u79bb\u5927\u4e8e\u5bf9\u9876\u5219\u5f39\u51fa\u5bf9\u9876,\u5411\u5806\u4e2d\u63d2\u5165\u6539\u70b9\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\ntypedef long long ll;typedef unsigned long long ull;typedef double db;typedef short sht;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\n#define fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define cpy(x,y) memcpy(x,y,sizeof(x))\n#define fin(s) freopen(s\".in\",\"r\",stdin)\n#define fout(s) freopen(s\".out\",\"w\",stdout)\n#define fcin ios::sync_with_stdio(false)\n#define l2(n) ((int)(log2(n)))\ntemplate <class T>il T ABS(T x){return x>0?x:-x;}\ntemplate <class T>il T MAX(T x,T y){return x>y?x:y;}\ntemplate <class T>il T MIN(T x,T y){return x<y?x:y;}\ntemplate <class T>il T GCD(T x,T y){return y?GCD(y,x%y):x;}\ntemplate <class T>il void SWAP(T &x,T &y){T t=x;x=y;y=t;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,inf=2122219134;\nint n,rt,cnt,siz[N],c[2][N],L[N],R[N],D[N],U[N];\n#define ls c[0][x]\n#define rs c[1][x]\nbool d[N];\ndb a=0.75;\nstruct node{int x,y,v;}t[N];\nbool cmpx(node p,node q){return p.x<q.x;}\nbool cmpy(node p,node q){return p.y<q.y;}\nvoid upd(int x,int y){\n    L[x]=MIN(L[x],L[y]),R[x]=MAX(R[x],R[y]),\n    D[x]=MIN(D[x],D[y]),U[x]=MAX(U[x],U[y]);\n}\nvoid pu(int x){\n    siz[x]=siz[ls]+siz[rs]+1;\n    L[x]=R[x]=t[x].x;\n    D[x]=U[x]=t[x].y;\n    if(ls)upd(x,ls);\n    if(rs)upd(x,rs);\n}\nint build(int l,int r){\n    if(l>r)return 0;\n    int m=l+r>>1,x=m;\n    db av1=0,av2=0,v1=0,v2=0;\n    fur(i,l,r)av1+=t[i].x,av2+=t[i].y;\n    av1/=r-l+1,av2/=r-l+1;\n    fur(i,l,r)\n        v1+=(av1-t[i].x)*(av1-t[i].x),\n        v2+=(av2-t[i].y)*(av2-t[i].y);\n    nth_element(t+l,t+m,t+r+1,(v1>v2)?cmpx:cmpy);\n    d[x]=v1>v2;\n    ls=build(l,m-1),rs=build(m+1,r);\n    pu(x);return x;\n}\nint qx,qy;\nstruct dat{\n    ll d;int id;\n    bool operator<(dat p)const{return d>p.d||(d==p.d&&id<p.id);}\n};\npriority_queue<dat>q;\nll dis(node p){return 1ll*(p.x-qx)*(p.x-qx)+1ll*(p.y-qy)*(p.y-qy);}\nll mxd(int x){\n    return MAX(1ll*(L[x]-qx)*(L[x]-qx),1ll*(R[x]-qx)*(R[x]-qx))+\n           MAX(1ll*(D[x]-qy)*(D[x]-qy),1ll*(U[x]-qy)*(U[x]-qy));\n}\nvoid ask(int x){\n    if(!x)return;\n    ll res=dis(t[x]),ld=0,rd=0;\n    if(res>q.top().d||(res==q.top().d&&t[x].v<q.top().id))\n        q.pop(),q.push(dat{res,t[x].v});\n    if(ls)ld=mxd(ls);\n    if(rs)rd=mxd(rs);\n    if(ld>rd){\n        if(ld>=q.top().d)ask(ls);\n        if(rd>=q.top().d)ask(rs);\n    }\n    else{\n        if(rd>=q.top().d)ask(rs);\n        if(ld>=q.top().d)ask(ls);\n    }\n}\nint main(){\n    in(n);\n    int m,x,y,k;\n    fur(i,1,n)in(x,y),t[i]=node{x,y,i};\n    rt=build(1,n);\n    in(m);\n    while(m--){\n        in(qx,qy,k);\n        while(!q.empty())q.pop();\n        while(k--)q.push(dat{-1,0});\n        ask(rt);\n        out(q.top().id,ln);\n    }\n    flush();\n}\n```\n\n## \u9ad8\u7ef4\u7a7a\u95f4\u64cd\u4f5c\n\n[LG 4148 \u7b80\u5355\u9898](https://www.luogu.org/problem/P4148)\n\n20M\u7684\u7a7a\u95f4\u9650\u5236\u5361\u6389\u4e86\u6811\u5957\u6811,\u5f3a\u5236\u5728\u7ebf\u5361\u6389\u4e86CDQ\u5206\u6cbb\n\n\u6240\u4ee5\u8fd9\u9898\u662f`KDT`\u6a21\u677f\u9898\n\n\u67e5\u8be2\u65f6\u5224\u65ad\u5982\u679c\u5f53\u524d\u5b50\u6811\u5bf9\u5e94\u7684\u77e9\u5f62\u5728\u67e5\u8be2\u8303\u56f4\u5185,\u76f4\u63a5\u52a0\u4e0a\u8be5\u5b50\u6811\u7684\u8d21\u732e,\u8fd4\u56de\n\n\u5426\u5219\u5224\u65ad\u5f53\u524d\u70b9\u662f\u5426\u5728\u8303\u56f4\u5185,\u52a0\u4e0a\u7b54\u6848,\u63a5\u7740\u7ee7\u7eed\u9012\u5f52\u5de6\u53f3\u5b50\u6811\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i(x);i<=y;++i)\n#define fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define cpy(x,y) memcpy(x,y,sizeof(x))\n#define fin(s) freopen(s\".in\",\"r\",stdin)\n#define fout(s) freopen(s\".out\",\"w\",stdout)\n#define fcin ios::sync_with_stdio(false)\n#define l2(n) ((int)(log2(n)))\ntemplate <class T>il T ABS(T x){return x>0?x:-x;}\ntemplate <class T>il T MAX(T x,T y){return x>y?x:y;}\ntemplate <class T>il T MIN(T x,T y){return x<y?x:y;}\ntemplate <class T>il T GCD(T x,T y){return y?GCD(y,x%y):x;}\ntemplate <class T>il void SWAP(T &x,T &y){T t=x;x=y;y=t;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=200001;\nint n,cnt,rt,siz[N],s[N],ls[N],rs[N],L[N],R[N],D[N],U[N],g[N],tot,d[N];\ndouble a=0.75;\nstruct node{int x,y,v;}t[N];\nbool cmpx(int p,int q){return t[p].x<t[q].x;}\nbool cmpy(int p,int q){return t[p].y<t[q].y;}\nvoid pu(int x){\n    siz[x]=siz[ls[x]]+siz[rs[x]]+1;\n    s[x]=s[ls[x]]+s[rs[x]]+t[x].v;\n    L[x]=R[x]=t[x].x;\n    D[x]=U[x]=t[x].y;\n    if(ls[x])\n        L[x]=MIN(L[x],L[ls[x]]),R[x]=MAX(R[x],R[ls[x]]),\n        D[x]=MIN(D[x],D[ls[x]]),U[x]=MAX(U[x],U[ls[x]]);\n    if(rs[x])\n        L[x]=MIN(L[x],L[rs[x]]),R[x]=MAX(R[x],R[rs[x]]),\n        D[x]=MIN(D[x],D[rs[x]]),U[x]=MAX(U[x],U[rs[x]]);\n}\nint build(int l,int r){\n    if(l>r)return 0;\n    int m=l+r>>1;\n    double av1=0,av2=0,v1=0,v2=0;\n    fur(i,l,r)av1+=t[g[i]].x,av2+=t[g[i]].y;\n    av1/=r-l+1,av2/=r-l+1;\n    fur(i,l,r)\n        v1+=(av1-t[g[i]].x)*(av1-t[g[i]].x),\n        v2+=(av2-t[g[i]].y)*(av2-t[g[i]].y);\n    if(v1>v2)nth_element(g+l,g+m,g+r+1,cmpx),d[g[m]]=1;\n    else nth_element(g+l,g+m,g+r+1,cmpy),d[g[m]]=2;\n    ls[g[m]]=build(l,m-1);\n    rs[g[m]]=build(m+1,r);\n    pu(g[m]);\n    return g[m];\n}\nvoid get(int x){if(x)get(ls[x]),g[++tot]=x,get(rs[x]);}\nvoid rb(int&x){tot=0;get(x);x=build(1,tot);}\nbool bad(int x){return a*siz[x]<=(double)MAX(siz[ls[x]],siz[rs[x]]);}\nvoid ins(int&x,int v){\n    if(!x){pu(x=v);return;}\n    if(d[x]==1){\n        if(t[v].x<=t[x].x)ins(ls[x],v);\n        else ins(rs[x],v);\n    }\n    else{\n        if(t[v].y<=t[x].y)ins(ls[x],v);\n        else ins(rs[x],v);\n    }\n    pu(x);\n    if(bad(x))rb(x);\n}\nint ql,qr,qd,qu;\nint ask(int x){\n    if(!x||qr<L[x]||ql>R[x]||qu<D[x]||qd>U[x])return 0;\n    if(ql<=L[x]&&R[x]<=qr&&qd<=D[x]&&U[x]<=qu)return s[x];\n    return ask(ls[x])+ask(rs[x])+\n    ((ql<=t[x].x&&t[x].x<=qr&&qd<=t[x].y&&t[x].y<=qu)?t[x].v:0);\n}\nint main(){\n    in(n);\n    int opt,x,y,v,la=0;\n    while(1){\n        in(opt);\n        if(opt==3)break;\n        if(opt==1){\n            in(x,y,v);\n            x^=la,y^=la,v^=la;\n            t[++cnt]={x,y,v};\n            ins(rt,cnt);\n        }\n        else in(ql,qd,qr,qu),\n        ql^=la,qr^=la,qu^=la,qd^=la,\n        out(la=ask(rt),ln);\n    }\n    flush();\n}\n```\n\n\n\u53ef\u4ee5\u770b\u6210\u601d\u7ef4\u504f\u5e8f\u95ee\u9898\n\n\u5148\u6309\u7b2c\u4e00\u7ef4\u4f18\u5148,\u76f8\u540c\u5219\u7ee7\u7eed\u6bd4\u8f83\u5176\u4ed6\u7ef4\u6392\u5e8f(\u4fdd\u8bc1\u4e4b\u540e\u63d2\u5165\u7684\u70b9\u4e0d\u4f1a\u88ab\u4e4b\u524d\u63d2\u5165\u7684\u70b9\u7684\u8303\u56f4\u8986\u76d6,\u9632\u6b62\u7edf\u8ba1\u7684\u65f6\u5019\u6f0f\u6389),\n\n$f_i=\\max{f_j + 1}$\n\n\u5269\u4e0b\u4e09\u7ef4\u53ef\u4ee5\u7528`KDT`\u6c42\u51fa\u6700\u5927\u7684$f_j$\n\n\u6709\u4e24\u79cd\u5199\u6cd5:\n\n1. \u5e26\u91cd\u6784`KDT`\n   \n2. \u5148\u6784\u5efa\u5b8c\u6574\u7684`KDT`,\u7136\u540e\u628a\u63d2\u5165\u5f53\u4f5c\u6fc0\u6d3b\u8282\u70b9\n\n\u5e26\u91cd\u6784`KDT`:\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\ntypedef double db;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nint max(int x,int y){return x>y?x:y;}\nvoid cmin(int &x,int y){x=x<y?x:y;}\nvoid cmax(int &x,int y){x=x>y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=50011,inf=2122219134;\nint _cmp,n,rt,ans,siz[N],ls[N],rs[N],mi[N][3],mx[N][3],s[N],d[N];\nstruct node{\n    int v[4];\n    int& operator[](int x){return v[x];}\n    bool operator<(node p){fur(i,0,3)if(v[i]!=p[i])return v[i]<p[i];}\n}t[N];\nvoid upd(int x,int y){\n    fur(i,0,2)\n        cmin(mi[x][i],mi[y][i]),\n        cmax(mx[x][i],mx[y][i]);\n}\nvoid pu(int x){\n    fur(i,0,2)mi[x][i]=mx[x][i]=t[x][i+1];\n    if(ls[x])upd(x,ls[x]);\n    if(rs[x])upd(x,rs[x]);\n    s[x]=max(t[x][0],max(s[ls[x]],s[rs[x]]));\n    siz[x]=1+siz[ls[x]]+siz[rs[x]];\n}\ndb av[4],v[4];\nint tot,g[N];\nbool cmp(int a,int b){return t[a][_cmp]<t[b][_cmp];}\nint build(int l,int r,int b){\n    if(l>r)return 0;\n    int m=l+r>>1;\n    _cmp=b+1,std::nth_element(g+l,g+m,g+r+1,cmp);\n    ls[g[m]]=build(l,m-1,(b+1)%3),rs[g[m]]=build(m+1,r,(b+1)%3),pu(g[m]);\n    return g[m];\n}\nvoid get(int x){if(x)get(ls[x]),g[++tot]=x,get(rs[x]);}\nvoid rb(int &x){tot=0,get(x),x=build(1,tot,0);}\nbool bad(int x){return 0.75*(db)siz[x]<=(db)max(siz[ls[x]],siz[rs[x]]);}\nvoid ins(int &x,int cur){\n    if(!x){pu(x=cur);return;}\n    ins((t[cur][d[x]]<=t[x][d[x]])?ls[x]:rs[x],cur);\n    pu(x);\n    if(bad(x))rb(x);\n}\nint id,as;\nbool chk(int *p){\n    fur(i,0,2)if(p[i]>t[id][i+1])return 0;\n    return 1;\n}\nvoid ask(int x){\n    if(!x||s[x]<=as)return;\n    if(chk(mx[x])){as=s[x];return;}\n    if(!chk(mi[x]))return;\n    if(chk(t[x].v+1))cmax(as,t[x][0]);\n    ask(ls[x]),ask(rs[x]);\n}\nint main(){\n    freopen(\"in.in\",\"r\",stdin);\n    in(n);\n    fur(i,1,n)fur(j,0,3)in(t[i][j]);\n    std::sort(t+1,t+n+1);\n    t[1][0]=1,ins(rt,1);\n    fur(i,2,n)\n        id=i,as=0,ask(rt),\n        cmax(ans,t[i][0]=as+1),\n        ins(rt,i);\n    printf(\"%d\\n\",ans);\n}\n```\n\n\u6fc0\u6d3b\u8282\u70b9\u5199\u6cd5:\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\ntypedef double db;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nint max(int x,int y){return x>y?x:y;}\nvoid cmin(int &x,int y){x=x<y?x:y;}\nvoid cmax(int &x,int y){x=x>y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=50011,inf=2122219134;\nint _cmp,n,rt,ans,ls[N],rs[N],mi[N][3],mx[N][3],s[N],g[N];\nstruct node{\n    int v[4];\n    int& operator[](int x){return v[x];}\n    bool operator<(node p){fur(i,0,3)if(v[i]!=p[i])return v[i]<p[i];}\n}t[N];\nvoid pu(int x){\n    fur(i,0,2){\n        mi[x][i]=mx[x][i]=t[x][i+1];\n        if(ls[x])cmin(mi[x][i],mi[ls[x]][i]),cmax(mx[x][i],mx[ls[x]][i]);\n        if(rs[x])cmin(mi[x][i],mi[rs[x]][i]),cmax(mx[x][i],mx[rs[x]][i]);\n    }\n}\nbool cmp(int a,int b){return t[a][_cmp]<t[b][_cmp];}\nint build(int l,int r,int b){\n    if(l>r)return 0;\n    int m=l+r>>1;\n    _cmp=b+1,std::nth_element(g+l,g+m,g+r+1,cmp);\n    ls[g[m]]=build(l,m-1,(b+1)%3),\n    rs[g[m]]=build(m+1,r,(b+1)%3),\n    pu(g[m]);return g[m];\n}\nint id,as;\nbool chk(int *p,int *q=t[id].v+1){\n    fur(i,0,2)if(p[i]>q[i])return 0;\n    return 1;\n}\nvoid ask(int x){\n    if(!x||s[x]<=as)return;\n    if(!chk(mi[x]))return;\n    if(chk(mx[x])){as=s[x];return;}\n    if(chk(t[x].v+1))cmax(as,t[x][0]);\n    ask(ls[x]),ask(rs[x]);\n}\nvoid on(int x){\n    if(x==id){cmax(s[x],t[x][0]=as);return;}\n    if(!chk(t[id].v+1,mx[x])||!chk(mi[x]))return;\n    if(ls[x])on(ls[x]);if(rs[x])on(rs[x]);\n    cmax(s[x],s[ls[x]]),cmax(s[x],s[rs[x]]);\n}\nint main(){\n    in(n);\n    fur(i,1,n)in(t[i][0],t[i][1],t[i][2],t[i][3]),g[i]=i;\n    std::sort(t+1,t+n+1);\n    fur(i,1,n)t[i][0]=0;\n    rt=build(1,n,0);\n    fur(i,1,n)\n        id=i,as=0,ask(rt),\n        cmax(ans,++as),\n        on(rt);\n    printf(\"%d\\n\",ans);\n}\n```", "link": "/posts/k-d tree/", "tags": ["\u6570\u636e\u7ed3\u6784"], "categories": [["\u7b97\u6cd5", "\u6570\u636e\u7ed3\u6784"], ["note"]]}, {"title": "link-cut tree", "content": "`link-cut tree`\u662f\u4e00\u4e2a\u633a\u590d\u6742\u7684\u4e1c\u897f,\u672c\u6587\u4e3b\u8981\u7528\u4e8e\u590d\u4e60\u5de9\u56fa`link-cut tree`\n\n> \u63a8\u8350: \n> \n> - https://www.cnblogs.com/flashhu/p/8324551.html\n> \n> - https://oi-wiki.org/ds/lct/\n\n## \u7b80\u4ecb\n\n`link-cut tree`\u662f\u4e00\u79cd\u6570\u636e\u7ed3\u6784,\u6211\u4eec\u7528\u5b83\u6765\u89e3\u51b3\u52a8\u6001\u6811\u95ee\u9898\u3002\n\n> **\u52a8\u6001\u6811\u95ee\u9898**\n> \n> \u7ef4\u62a4\u4e00\u4e2a\u68ee\u6797, \u652f\u6301\u5220\u9664\u67d0\u6761\u8fb9,\u52a0\u2f0a\u67d0\u6761\u8fb9,\u5e76\u4fdd\u8bc1\u52a0\u8fb9,\u5220\u8fb9\u4e4b\u540e\u4ecd\u662f\u68ee\u6797\u3002\u6211\u4eec\u8981\u7ef4\u62a4\u8fd9\u4e2a\u68ee\u6797\u7684\u4e00\u4e9b\u4fe1\u606f\u3002\n> \n> \u4e00\u822c\u7684\u64cd\u4f5c\u6709\u4e24\u70b9\u8fde\u901a\u6027,\u4e24\u70b9\u8def\u5f84\u6743\u503c\u548c(\u6216\u6700\u503c\u7b49),\u8fde\u63a5\u4e24\u70b9\u548c\u5207\u65ad\u67d0\u6761\u8fb9\u3001\u4fee\u6539\u4fe1\u606f\u7b49\u3002\n\n`link-cut tree`\u7b80\u79f0`LCT`,\u4f46\u5b83\u4e0d\u53eb\u52a8\u6001\u6811,\u52a8\u6001\u6811\u662f\u6307\u4e00\u7c7b\u95ee\u9898\u3002\n\n`Splay Tree`\u662f`LCT`\u7684\u57fa\u7840(\u4f7f\u7528`Splay`\u7ef4\u62a4\u68ee\u6797),\u4f46\u662f`LCT`\u2f64\u7684`Splay Tree`\u548c\u666e\u901a\u7684`Splay`\u5728\u7ec6\u8282\u5904\u4e0d\u592a\u4e00\u6837(\u8fdb\u884c\u4e86\u4e00\u4e9b\u6269\u5c55)\u3002\n\n## \u6982\u5ff5\n\n`LCT`\u57fa\u4e8e\u5b9e\u94fe\u5256\u5206\n\n> \u5c06\u5411\u67d0\u4e00\u4e2a\u513f\u5b50\u7684\u8fde\u8fb9\u5212\u5206\u4e3a\u5b9e\u8fb9,\u8fde\u5411\u5176\u4ed6\u5b50\u6811\u7684\u8fb9\u5212\u5206\u4e3a\u865a\u8fb9\u3002\n> \n> \u865a\u8fb9\u3001\u5b9e\u8fb9\u53ef\u52a8\u6001\u53d8\u5316\n> \n> \u865a\u8fb9\uff1a\u513f\u5b50\u8ba4\u7236,\u7236\u4e0d\u8ba4\u5b50\n>\n> \u5b9e\u8fb9\uff1a\u513f\u5b50\u8ba4\u7236,\u7236\u4e5f\u8ba4\u5b50\n\n`LCT`\u652f\u6301: \n\n1. \u67e5\u8be2\u3001\u4fee\u6539\u94fe\u4e0a\u7684\u4fe1\u606f(\u6700\u503c,\u603b\u548c\u7b49)\n   \n2. \u6362\u6839\n   \n3. \u52a8\u6001\u8fde\u8fb9\u3001\u5220\u8fb9\n\n`LCT`\u7684\u57fa\u672c\u64cd\u4f5c\u590d\u6742\u5ea6\u5747\u644a\u4e3a$\\log n$\n\n\u4f46\u662f\u5e38\u6570\u8f83\u5927,\u5728\u53ef\u4ee5\u4f7f\u7528\u6811\u94fe\u5256\u5206\u7684\u60c5\u51b5\u4e0b\u8fd8\u662f\u4f7f\u7528\u6811\u94fe\u5256\u5206\u6bd4\u8f83\u597d\n\n## \u6027\u8d28\n\n1. \u6bcf\u4e00\u4e2a`Splay`(\u68ee\u6797)\u7ef4\u62a4\u7684\u662f**\u4e00\u6761\u4ece\u4e0a\u5230\u4e0b\u6309\u5728\u539f\u6811\u4e2d\u6df1\u5ea6\u4e25\u683c\u9012\u589e\u7684\u8def\u5f84,\u4e14\u4e2d\u5e8f\u904d\u5386Splay\u5f97\u5230\u7684\u6bcf\u4e2a\u70b9\u7684\u6df1\u5ea6\u5e8f\u5217\u4e25\u683c\u9012\u589e**\u3002\n   \n2. \u6bcf\u4e2a\u8282\u70b9\u5305\u542b\u4e14\u4ec5\u5305\u542b\u4e8e\u4e00\u4e2a`Splay`(\u68ee\u6797)\u4e2d ~~(\u8fd9\u4e0d\u662f\u5e9f\u8bdd\u5417\uff1f)~~\n\n## \u64cd\u4f5c\n\n\u4ee5\u4e0b\u7684`ls(x)`\u7b49\u540c\u4e8e`c[0][x]`,\u8868\u793a\u5de6\u513f\u5b50,`rs(x)`\u7b49\u540c\u4e8e`c[1][x]`,\u8868\u793a\u5de6\u513f\u5b50\n\n### Push up\n\n```cpp\nvoid pu(int x){\n    siz[x]=siz[ls(x)]+siz[rs(x)]+1;\n}\n```\n\n### Push rev\n\n```cpp\nvoid pr(int x){\n    swap(ls(x),rs(x));\n    rev[x]^=1;\n}\n```\n\n### Push down\n\n```cpp\nvoid pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n}\n```\n\n### rotate & splay\n\n`LCT`\u4e2d\u7684`splay`\u548c\u666e\u901a\u7684`splay`\u6709\u4e00\u5b9a\u533a\u522b\n\n\u4e0d\u4f1a`splay`\u7684\u8bf7\u5148\u81ea\u884c\u4e86\u89e3\n\n```cpp\nvoid g(int x){return rs(f[x])==x;}\nvoid rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y;c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nint st[N];\nvoid splay(int x){\n    int z=0,y=st[++z]=x;\n    while(nrt(y))st[++z]=y=f[y];\n    while(z)pd(st[z--]);\n    for(;nrt(x);rotate(x))\n        if(nrt(f[x]))turn(g(x)^g(f[x])?x:f[x]);\n}\n```\n\n### Access\n\n`LCT`\u7684\u6838\u5fc3\u64cd\u4f5c\n\n`access`\u7684\u56db\u6b65\u64cd\u4f5c\uff1a\n\n1. \u628a\u5f53\u524d\u8282\u70b9\u8f6c\u5230\u6839\n2. \u628a\u513f\u5b50\u6362\u6210\u4e0a\u4e00\u6b21\u64cd\u4f5c\u7684\u8282\u70b9(\u5982\u679c\u6ca1\u6709\u4e0a\u4e00\u6b21\u5c31\u662f\u6ca1\u6709)\n3. \u66f4\u65b0\u5f53\u524d\u70b9\u7684\u4fe1\u606f\u3002\n4. \u628a\u5f53\u524d\u70b9\u6362\u6210\u5f53\u524d\u70b9\u7684\u7236\u4eb2,\u7ee7\u7eed\u64cd\u4f5c\n\n```cpp\nvoid access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),rs(x)=y,pu(x);\n}\n```\n\n### Make root\n\n\u4ec5\u6b21\u4e8e`Access`\u7684\u6838\u5fc3\u64cd\u4f5c\n\n```cpp\nvoid mrt(int x){\n    access(x),splay(x),pr(x);\n}\n```\n\n\u5f53\u8fde\u63a5$x$\u5230\u6839,\u5e76\u628a$x$\u65cb\u8f6c\u5230\u6839\u540e\n\n$x$\u6210\u4e3a\u6811\u6839,$x$\u53d8\u4e3a\u6811\u4e0a\u6df1\u5ea6\u6700\u5c0f\u7684\u70b9,$x$\u5230\u539f\u6811\u6839\u7684\u8def\u5f84\u4e0a\u7684\u8fb9\u5168\u90e8\u53cd\u5411\n\n\u90a3\u4e48\u7ffb\u8f6c`access(x)`\u540e\u5f62\u6210\u7684$x$\u5230\u539f\u6811\u6839\u7684\u94fe\u6240\u5728\u7684`splay`\u5373\u53ef\n\n### Find root\n\n`access(x),splay(x)`\u540e,\u539f\u6765\u7684\u6839\u53d8\u6210$x$\u6240\u5728`splay`\u91cc\u6df1\u5ea6\u6700\u5c0f\u7684\u90a3\u4e2a,\u90a3\u4e48\u4e00\u76f4\u5f80\u5de6\u513f\u5b50\u8d70\u5c31\u53ef\u4ee5\u627e\u5230\u539f\u6765\u7684\u6839\u4e86(\u8bb0\u5f97`push down`)\n\n\u6ce8\u610f\u6700\u540e\u8981\u628a\u539f\u6765\u7684\u6839`splay`\u4e0a\u53bb,\u4fdd\u8bc1\u590d\u6742\u5ea6\n\n```cpp\nvoid frt(int x){\n    for(access(x),splay(x);ls(x);pd(x),x=ls(x));\n    splay(x);return x;\n}\n```\n\n### Link\n\n\u76f4\u63a5\u770b\u4ee3\u7801\u5c31\u53ef\u4ee5\u61c2\u4e86\n\n```cpp\nvoid link(int x,int y){\n    mrt(x);\n    if(frt(y)!=x)f[x]=y;\n}\n```\n\n### Split\n\n\u76f4\u63a5\u5c06$x$\u5230$y$\u7684\u8def\u5f84\u63d0\u51fa\u6765,\u4e3a\u4e86\u65b9\u4fbf\u6211\u4eec\u5c06$y$\u4f5c\u4e3a\u8be5`splay`\u7684\u6839\n\n```cpp\nvoid sl(int x,int y){\n    mrt(x),access(y),splay(y);\n}\n```\n\n### Cut\n\n\u82e5\u5b58\u5728\u8fb9\u8fde\u63a5$x,y$\n\n\u5c06\u6839\u6362\u4e3a$x$\u540e,$x$\u7684\u6df1\u5ea6\u6700\u5c0f,\u5176\u6b21\u662f$y$\n\n`find root`\u4e4b\u540e$x$\u88ab\u65cb\u8f6c\u5230\u4e86\u6839\u8282\u70b9\n\n$y$\u4e3a$x$\u7684\u53f3\u513f\u5b50\u4e14$y$\u6ca1\u6709\u5de6\u513f\u5b50\n\n\u5224\u65ad\u5b8c\u6bd5\u5c31\u662f\u53ef\u4ee5\u65ad\u5f00$x,y$\u4e4b\u95f4\u7684\u5173\u7cfb\u5e76\u66f4\u65b0$x$\u4e86\n\n```cpp\nvoid cut(int x,int y){\n    mrt(x);\n    if(frt(y)==x&&f[y]==x&&!ls(y))f[y]=rs(x)=0,pu(x);\n}\n```\n\n[LG 3690 \u3010\u6a21\u677f\u3011link-cut tree \uff08\u52a8\u6001\u6811\uff09](https://www.luogu.com.cn/problem/P3690)\n\n\u8fd9\u9898\u5c31\u662f\u6807\u51c6\u7684\u6a21\u677f\u4e86\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=100011;\nint n,m,s[N],v[N],c[2][N],f[N],st[N];\nbool rev[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){s[x]=s[ls(x)]^s[rs(x)]^v[x];}\nil void pr(int x){int t=ls(x);ls(x)=rs(x);rs(x)=t;rev[x]^=1;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    int z=0,y=st[++z]=x;\n    while(nrt(y))st[++z]=y=f[y];\n    while(z)pd(st[z--]);\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),rs(x)=y,pu(x);\n}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls(x);pd(x),x=ls(x));\n    splay(x);return x;\n}\nil void link(int x,int y){\n    mrt(x);\n    if(frt(y)^x)f[x]=y;\n}\nil void sl(int x,int y){mrt(x),access(y),splay(y);}\nil void cut(int x,int y){\n    mrt(x);\n    if(frt(y)==x&&f[y]==x&&!ls(y))\n        f[y]=rs(x)=0,pu(x);\n}\nint main(){\n    in(n,m);\n    for(int i=1;i<=n;++i)in(v[i]);\n    int opt,x,y;\n    while(m--){\n        in(opt,x,y);\n        if(opt==0)sl(x,y),out(s[y],ln);\n        if(opt==1)link(x,y);\n        if(opt==2)cut(x,y);\n        if(opt==3)splay(x),v[x]=y;\n    }\n    flush();\n}\n```\n\n## \u8fdb\u9636\n\n### \u7ef4\u62a4\u6811\u94fe\u4fe1\u606f\n\n[LG 1501 \\[\u56fd\u5bb6\u96c6\u8bad\u961f\\]Tree II](https://www.luogu.com.cn/problem/P1501)\n\n\u7ecf\u5178\u7684`link-cut tree`\u7ef4\u62a4\u6811\u94fe\u4fe1\u606f,\u533a\u95f4\u52a0\u533a\u95f4\u4e58\u533a\u95f4\u67e5\u8be2\n\n\u5173\u952e\u5728\u4e8e\u6253\u6807\u8bb0\u548c\u4e0b\u63a8,\u8bb0\u5f97\u5148\u4e0b\u63a8\u4e58\u6cd5\u518d\u4e0b\u63a8\u52a0\u6cd5\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,P=51061;\n#define int long long\nint n,q,s[N],siz[N],v[N],c[2][N],f[N],st[N],add[N],mul[N];\nbool rev[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){\n    s[x]=(s[ls(x)]+s[rs(x)]+v[x])%P;\n    siz[x]=siz[ls(x)]+siz[rs(x)]+1;\n}\nil void pr(int x){int t=ls(x);ls(x)=rs(x);rs(x)=t;rev[x]^=1;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n    if(mul[x]^1){\n        if(ls(x)){\n            mul[ls(x)]=mul[ls(x)]*mul[x]%P;\n            add[ls(x)]=add[ls(x)]*mul[x]%P;\n            s[ls(x)]=s[ls(x)]*mul[x]%P;\n            v[ls(x)]=v[ls(x)]*mul[x]%P;\n        }\n        if(rs(x)){\n            mul[rs(x)]=mul[rs(x)]*mul[x]%P;\n            add[rs(x)]=add[rs(x)]*mul[x]%P;\n            s[rs(x)]=s[rs(x)]*mul[x]%P;\n            v[rs(x)]=v[rs(x)]*mul[x]%P;\n        }\n        mul[x]=1;\n    }\n    if(add[x]){\n        if(ls(x)){\n            add[ls(x)]=(add[ls(x)]+add[x])%P;\n            s[ls(x)]=(s[ls(x)]+add[x]*siz[ls(x)]%P)%P;\n            v[ls(x)]=(v[ls(x)]+add[x])%P;\n        }\n        if(rs(x)){\n            add[rs(x)]=(add[rs(x)]+add[x])%P;\n            s[rs(x)]=(s[rs(x)]+add[x]*siz[rs(x)]%P)%P;\n            v[rs(x)]=(v[rs(x)]+add[x])%P;\n        }\n        add[x]=0;\n    }\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    int z=0,y=st[++z]=x;\n    while(nrt(y))st[++z]=y=f[y];\n    while(z)pd(st[z--]);\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(f[x])^g(x)?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),rs(x)=y,pu(x);\n}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls(x);pd(x),x=ls(x));\n    splay(x);return x;\n}\nil void link(int x,int y){\n    mrt(x);\n    if(frt(y)^x)f[x]=y;\n}\nil void sl(int x,int y){mrt(x),access(y),splay(y);}\nil void cut(int x,int y){\n    mrt(x);\n    if(frt(y)==x&f[y]==x&&!ls(y))\n        f[y]=rs(x)=0,pu(x);\n}\nsigned main(){\n    in(n,q);\n    int x,y,c;char opt;\n    for(int i=1;i<=n;++i)mul[i]=1,siz[i]=1,v[i]=1;\n    for(int i=2;i<=n;++i)in(x,y),link(x,y);\n    while(q--){\n        in(opt,x,y);\n        if(opt=='+')\n            in(c),sl(x,y),\n            s[y]=(s[y]+c*siz[y]%P)%P,v[y]=(v[y]+c)%P,\n            add[y]=(add[y]+c)%P;\n        if(opt=='-')cut(x,y),in(x,y),link(x,y);\n        if(opt=='*'){\n            in(c),sl(x,y),\n            s[y]=s[y]*c%P,v[y]=v[y]*c%P;\n            add[y]=add[y]*c%P,\n            mul[y]=mul[y]*c%P;\n        }\n        if(opt=='/')sl(x,y),out(s[y],ln);\n    }\n    flush();\n}\n```\n\n### \u7ef4\u62a4\u53cc\u8fde\u901a\u5206\u91cf\n\n[LG 2542 \\[AHOI2005\\]\u822a\u7ebf\u89c4\u5212](https://www.luogu.com.cn/problem/P2542)\n\n\u9996\u5148\u770b\u5230\u8fd9\u79cd\u9898\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5012\u5e8f\u6dfb\u52a0\n\n\u5047\u8bbe\u6bcf\u4e2a\u70b9\u4ee3\u8868\u4e00\u4e2a\u53cc\u8fde\u901a\u5206\u91cf,\u90a3\u4e48\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u5173\u952e\u8def\u5f84\u6570\u5c31\u662f\u94fe\u957f-1\n\n\u53ef\u4ee5\u7528`LCT`+\u5e76\u67e5\u96c6\u6765\u7ef4\u62a4\n\n\u8fde\u63a5\u4e00\u6761\u8fb9:\n\n1. \u4e24\u7aef\u5728\u540c\u4e00\u4e2a\u53cc\u8fde\u901a\u5206\u91cf\u4e2d: \u4ec0\u4e48\u90fd\u4e0d\u7528\u5e72\n   \n2. \u4e24\u7aef\u8fd8\u672a\u8fde\u901a: \u76f4\u63a5`link`\n\n3. \u4e24\u7aef\u5df2\u7ecf\u8054\u901a: \u7f29\u70b9\n   \n   \u5c06\u8fde\u63a5\u4e24\u7aef\u7684\u8def\u5f84\u63d0\u53d6\u51fa\u6765,\u5408\u5e76\u8fd9\u4e9b\u70b9\n\n```cpp\nint BL(int x){return bl[x]==x?x:(bl[x]=BL(bl[x]));}//\u5e76\u67e5\u96c6\nvoid set(int x,int y){if(x)bl[x]=y,set(ls(x),x),set(rs(x),x);}\nvoid mg(int x,int y){\n    if(x==y)return;//\u5728\u540c\u4e00\u4e2a\u53cc\u8fde\u901a\u5206\u91cf\n    mrt(x);\n    if(frt(y)!=x){f[x]=y;return;}//\u672a\u8fde\u901a\n\n    /*\n    \u5728find root\u7684\u8fc7\u7a0b\u4e2d\u5df2\u7ecfaccess(y)\u63d0\u51fa\u4e86x\u5230y\u7684\u8def\u5f84\n    \u6211\u4eec\u73b0\u5728\u53ea\u9700\u8981\u628ax\u7684\u5b50\u6811\u7684\u5e76\u67e5\u96c6\u7956\u5148\u90fd\u6539\u6210x,\u7136\u540e\u65ad\u5f00x\u4e0e\u5b50\u6811\u7684\u8fde\u63a5\u5373\u53ef\n    */\n    set(rs(x),x),rs(x)=0,pu(x);\n}\nvoid access(int x){\n    /*\n    \u7f29\u70b9\u7684\u65f6\u5019x\u7684\u5b50\u6811\u6307\u7a7a\u4e86,\u6211\u4eec\u9700\u8981\u5728access\u7684\u65f6\u5019\u63a5\u56de\u53bb\n\n    \u8fd9\u6837\u539f\u672c\u8fde\u63a5\u94fe\u4e0a\u5176\u4ed6\u8282\u70b9\u7684access\u540e\u90fd\u4f1a\u6307\u5411x\u4e86\n    */\n    for(int y=0;x;x=f[y=x]=BL(f[x]))\n        splay(x),rs(x)=y,pu(x);\n}\n```\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nil void swap(int &x,int &y){x^=y,y^=x,x^=y;}\nconst int N=30011,M=100011;\nint n,m,s[N],c[2][N],f[N],st[N],bl[N];\nbool rev[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){s[x]=s[ls(x)]+s[rs(x)]+1;}\nil void pr(int x){swap(ls(x),rs(x));rev[x]^=1;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[y]=x,f[x]=z;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    int z=0,y=st[++z]=x;\n    while(nrt(y))st[++z]=y=f[y];\n    while(z)pd(st[z--]);\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nint BL(int x){return bl[x]==x?x:(bl[x]=BL(bl[x]));}\nil void access(int x){for(int y=0;x;x=f[y=x]=BL(f[x]))splay(x),rs(x)=y,pu(x);}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls(x);pd(x),x=ls(x));\n    splay(x);return x;\n}\nil void sl(int x,int y){mrt(x),access(y),splay(y);}\nvoid set(int x,int y){if(x)bl[x]=y,set(ls(x),x),set(rs(x),x);}\nil void mg(int x,int y){\n    if(x==y)return;\n    mrt(x);\n    if(frt(y)!=x){f[x]=y;return;}\n    set(rs(x),x),rs(x)=0,pu(x);\n}\n#include<bits/extc++.h>\nusing namespace __gnu_pbds;\ngp_hash_table<int,bool>vis[N];\nint X[M],Y[M],A[M],B[M],O[M],ans[M];\nint main(){\n    in(n,m);\n    int c,x,y,q;\n    for(int i=1;i<=n;++i)s[i]=1,bl[i]=i;\n    for(int i=1;i<=m;++i){\n        in(X[i],Y[i]);\n        if(X[i]>Y[i])swap(X[i],Y[i]);\n    }\n    for(q=1;in(O[q]),~O[q];++q){\n        in(x,y);\n        if(x>y)swap(x,y);\n        if(!O[q])vis[x][y]=1;\n        A[q]=x,B[q]=y;\n    }\n    for(int i=1;i<=m;++i)if(!vis[X[i]][Y[i]])mg(BL(X[i]),BL(Y[i]));\n    for(c=0,--q;q;--q){\n        x=BL(A[q]),y=BL(B[q]);\n        if(O[q])sl(x,y),ans[++c]=s[y]-1;\n        else mg(x,y);\n    }\n    while(c)out(ans[c--],ln);\n    flush();\n}\n```\n\n[BZ 2959 \u957f\u8dd1](https://remmina.github.io/BZPRO/JudgeOnline/2959.html)\n\n\u548c\u4e0a\u4e00\u9898\u6709\u70b9\u50cf\n\n\u7f29\u70b9\u7684\u65f6\u5019\u987a\u4fbf\u548c\u5e76\u6240\u6709\u70b9\u7684\u4fe1\u606f\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\nil int min(int x,int y){return x<y?x:y;}\nil int max(int x,int y){return x>y?x:y;}\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=150011,inf=2122219134;\nint n,q,s[N],f[N],c[2][N],v[N],bl[N],a[N];\nbool rev[N];\nint BL(int x){return bl[x]==x?x:(bl[x]=BL(bl[x]));}\n#define ls c[0][x]\n#define rs c[1][x]\nil void pu(int x){s[x]=s[ls]+s[rs]+v[x];}\nil void pr(int x){rev[x]^=1,ls^=rs,rs^=ls,ls^=rs;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls)pr(ls);\n        if(rs)pr(rs);\n        rev[x]=0;\n    }\n}\nil int g(int x){return c[1][f[x]]==x;}\nil int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nvoid pda(int x){if(nrt(x))pda(f[x]);pd(x);}\nil void splay(int x){\n    for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x]=BL(f[x]))\n        splay(x),rs=y,pu(x);\n}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls;pd(x),x=ls);\n    splay(x);return x;\n}\nint tmp;\nvoid get(int x,int y){\n    if(x)tmp+=v[x],bl[x]=y,get(ls,x),get(rs,x);\n}\nint main(){\n    in(n,q);\n    for(int i=1;i<=n;++i)in(a[i]),s[i]=v[i]=a[i],bl[i]=i;\n    int opt,x,y;\n    while(q--){\n        in(opt,x,y);\n        if(opt==1){\n            x=BL(x),y=BL(y);\n            if(x==y)continue;\n            mrt(x);\n            if(frt(y)!=x)f[x]=y;\n            else tmp=0,get(rs,x),rs=0,v[x]+=tmp,pu(x);\n        }\n        if(opt==2){\n            mrt(BL(x));\n            v[BL(x)]+=y-a[x];\n            s[BL(x)]+=y-a[x];\n            a[x]=y;\n        }\n        if(opt==3){\n            x=BL(x),y=BL(y);\n            mrt(x);\n            if(frt(y)!=x)out(-1,ln);\n            else out(s[x],ln);\n        }\n    }\n    flush();\n}\n```\n\n### \u7ef4\u62a4\u8fb9\u6743(\u52a8\u6001\u7ef4\u62a4\u751f\u6210\u6811)\n\n`link-cut tree`\u4e0d\u80fd\u76f4\u63a5\u7ef4\u62a4\u8fb9\u6743\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u62c6\u8fb9,\u628a\u8fb9\u8f6c\u5316\u4e3a\u70b9\u518d\u5411\u4e24\u7aef\u8fde\u8fb9\n\n\u53ef\u4ee5\u901a\u8fc7\u8fd9\u79cd\u65b9\u5f0f\u7528`LCT`**\u52a8\u6001\u7ef4\u62a4\u751f\u6210\u6811**\n\n> \u6ce8\u610f: LCT\u4e0a\u8282\u70b9\u6ca1\u6709\u56fa\u5b9a\u7684\u7236\u5b50\u5173\u7cfb,\u4e0d\u80fd\u50cf\u6811\u5256\u4e00\u6837\u7528\u70b9\u6743\u8bb0\u5f55\u8fb9\u6743\n\n[LG 4234 \u6700\u5c0f\u5dee\u503c\u751f\u6210\u6811](https://www.luogu.com.cn/problem/P4234)\n\n\u6309\u8fb9\u6743\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u540e,\u4f9d\u6b21\u6dfb\u52a0\u8fb9\n\n\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86: \n\n\u6bcf\u6b21\u52a0\u8fb9\u7684\u65f6\u5019,\n\n\u5982\u679c\u4e24\u70b9\u4e3a\u8fde\u901a,\u5219\u52a0\u8fb9\n\n\u5426\u5219\u5728\u76ee\u524d\u7684\u751f\u6210\u6811\u4e0a\u627e\u5230\u8fb9\u6743\u6700\u5c0f\u7684\u8fb9, \u5e76\u66ff\u6362\u4e3a\u65b0\u8fb9\n\n\u53ef\u4ee5\u7528`LCT`\u7ef4\u62a4\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nil int min(int x,int y){return x<y?x:y;}\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nconst int N=250001,inf=-1u>>1;\nint n,m,rev[N],c[2][N],f[N],s[N];\nstruct edge{int x,y,w;bool operator<(edge t){return w<t.w;}}e[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){s[x]=min(x>n?x:inf,min(s[ls(x)],s[rs(x)]));}\nil void pr(int x){rev[x]^=1;int t=ls(x);ls(x)=rs(x),rs(x)=t;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nint st[N];\nil void splay(int x){\n    int z=0,y=st[++z]=x;\n    while(nrt(y))st[++z]=y=f[y];\n    while(z)pd(st[z--]);\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){for(int y=0;x;x=f[y=x])splay(x),rs(x)=y,pu(x);}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls(x);pd(x),x=ls(x));\n    splay(x);return x;\n}\nil void link(int x,int y){mrt(x),f[x]=y;}\nbool b[N];\nint main(){\n    s[0]=inf;\n    in(n,m);\n    for(int i=1;i<=m;++i)in(e[i].x,e[i].y,e[i].w);\n    std::sort(e+1,e+m+1);\n    int x,y,t=n,tt=0,p=1,ans=inf;\n    for(int i=1;i<=m;++i){\n        x=e[i].x,y=e[i].y;++t;\n        if(x==y){b[i]=1;continue;}//\u8981\u7279\u5224,re\u4e86\u4e0d\u77e5\u9053\u591a\u5c11\u6b21\u5c31\u662f\u56e0\u4e3a\u8fd9\u4e2a\n        mrt(x);\n        if(frt(y)!=x)f[f[x]=t]=y,++tt;\n        else{\n            mrt(x),access(y),splay(y);\n            int now=s[y];\n            b[now-n]=1;splay(now);\n            f[ls(now)]=f[rs(now)]=0;\n            link(x,t),link(t,y);\n        }\n        while(b[p]&&p<=i)++p;\n        if(tt>=n-1)ans=min(ans,e[i].w-e[p].w);\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n\n[LG 4180 \\[BJWC2010\\]\u4e25\u683c\u6b21\u5c0f\u751f\u6210\u6811](https://www.luogu.com.cn/problem/P4180)\n\n`LCT`\u52a8\u6001\u7ef4\u62a4\u6700\u5c0f\u751f\u6210\u6811\n\n\u7ef4\u62a4\u94fe\u4e0a\u7684\u6700\u5927\u503c\u548c\u6b21\u5927\u503c\n\n\u5148\u627e\u51fa\u6700\u5c0f\u751f\u6210\u6811,\u7136\u540e\u679a\u4e3e\u5269\u4e0b\u7684\u8fb9,\u627e\u51fa\u76f8\u5dee\u6700\u5c0f\u7684,\u5f97\u51fa\u7b54\u6848\n\n\u8fd9\u9898\u8fd8\u53ef\u4ee5\u7528kruskal\u751f\u6210\u6811+\u500d\u589e(\u6216\u6811\u5256)\u505a,\u5e38\u6570\u4f1a\u5c0f\u5f88\u591a\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\nil int min(int x,int y){return x<y?x:y;}\nil int max(int x,int y){return x>y?x:y;}\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nconst int N=100001;\nint n,m,s[N<<1],S[N<<1],c[2][N<<1],f[N<<1],v[N<<1];\nbool rev[N<<1];\n#define ls c[0][x]\n#define rs c[1][x]\nil void pu(int x){\n    if(s[ls]>s[rs])s[x]=s[ls],S[x]=max(S[ls],s[rs]);\n    else if(s[rs]>s[ls])s[x]=s[rs],S[x]=max(s[ls],S[rs]);\n    else s[x]=s[ls],S[x]=max(S[ls],S[rs]);\n\n    if(v[x]>s[x])S[x]=s[x],s[x]=v[x];\n    else if(v[x]!=s[x]&&v[x]>S[x])S[x]=v[x];\n}\nil void pr(int x){rev[x]^=1,ls^=rs,rs^=ls,ls^=rs;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls)pr(ls);\n        if(rs)pr(rs);\n        rev[x]=0;\n    }\n}\nil int g(int x){return c[1][f[x]]==x;}\nil int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nvoid pda(int x){if(nrt(x))pda(f[x]);pd(x);}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),rs=y,pu(x);\n}\nil void mrt(int x){access(x),splay(x),pr(x);}\nstruct edge{\n    int x,y,w;\n    bool operator<(edge t){return w<t.w;}\n}e[300001];\nint fa[N];\nint gf(int x){return x==fa[x]?x:(fa[x]=gf(fa[x]));}\nint main(){\n    in(n,m);\n    for(int i=1;i<=m;++i)in(e[i].x,e[i].y,e[i].w);\n    std::sort(e+1,e+m+1);\n    long long tot=0;int x,y,id=n,ans=-1u>>1;\n    for(int i=1;i<=n;++i)fa[i]=i;\n    for(int i=1;i<=m;++i){\n        x=e[i].x,y=e[i].y;\n        if(gf(x)!=gf(y)){\n            fa[fa[x]]=fa[y];\n            tot+=e[i].w;\n            v[++id]=e[i].w;\n            mrt(x),mrt(y),f[x]=f[y]=id;\n        }\n        else{\n            mrt(x),access(y),splay(y);\n            ans=min(ans,e[i].w-(e[i].w>s[y]?s[y]:S[y]));\n        }\n    }\n    printf(\"%lld\\n\",tot+ans);\n}\n```\n\n### \u7ef4\u62a4\u5b50\u6811\u4fe1\u606f\n\n> \u6ce8: \u6b64\u90e8\u5206\u53ef\u76f4\u63a5\u8df3\u8fc7\n\n`LCT`\u5e76\u4e0d\u64c5\u957f\u7ef4\u62a4\u5b50\u6811,~~Top tree\u66f4\u9002\u5408,\u9000\u5f79\u6811\u6211\u4e5f\u4e0d\u4f1a~~\n\n\u9664\u4e86\u7ef4\u62a4\u5f53\u524d\u5b9e\u94fe\u7684\u4fe1\u606f,\u989d\u5916\u7ef4\u62a4\u5b83\u7684\u865a\u5b50\u6811\u7684\u4fe1\u606f(`siz2[x]`)\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u5f97\u5230\u6574\u8bfe\u6811\u7684\u4fe1\u606f\n\npush up \u53d8\u6210\n\n```cpp\nvoid pu(int x){\n    siz[x]=siz[ls(x)]+1+siz[rs(x)]+siz2[x];\n}\n```\n\n\u90a3\u4e48\u5982\u4f55\u7ef4\u62a4`siz2[x]`\u5462?\n\n\u5728\u6539\u53d8\u8fb9\u7684\u865a\u5b9e\u72b6\u51b5\u7684\u65f6\u5019\u8981\u53ca\u65f6\u4fee\u6539`siz2[x]`\n\n\u5728`rotate,splay`\u64cd\u4f5c\u4e2d,\u6211\u4eec\u90fd\u53ea\u662f\u6539\u53d8\u4e86`splay`\u4e2d\u7ed3\u70b9\u7684\u76f8\u5bf9\u4f4d\u7f6e,\u6ca1\u6709\u6539\u53d8\u4efb\u610f\u4e00\u6761\u8fb9\u7684\u865a\u5b9e\u60c5\u51b5,\u6240\u4ee5\u4e0d\u5bf9`siz2[x]`\u8fdb\u884c\u4efb\u4f55\u4fee\u6539\u3002\n\n\u5728`access`\u64cd\u4f5c\u4e2d,\u5728\u6bcf\u6b21`splay`\u5b8c\u540e,\u90fd\u4f1a\u6539\u53d8\u521a\u521a`splay`\u5b8c\u7684\u7ed3\u70b9\u7684\u53f3\u513f\u5b50,\u5373\u8be5\u7ed3\u70b9\u4e0e\u5176\u539f\u53f3\u513f\u5b50\u7684\u8fde\u8fb9\u548c\u8be5\u8282\u70b9\u548c\u65b0\u53f3\u513f\u5b50\u7684\u8fde\u8fb9\u7684\u865a\u5b9e\u60c5\u51b5\u53d1\u751f\u4e86\u53d8\u5316,\u6211\u4eec\u9700\u8981\u52a0\u4e0a\u65b0\u53d8\u6210\u865a\u8fb9\u6240\u8fde\u7684\u5b50\u6811\u7684\u8d21\u732e,\u51cf\u53bb\u521a\u521a\u53d8\u6210\u5b9e\u8fb9\u6240\u8fde\u7684\u5b50\u6811\u7684\u8d21\u732e\u3002\n\n\u5728`link`\u64cd\u4f5c\u4e2d\u6dfb\u52a0\u4e86\u865a\u94fe,\u8981\u52a0\u4e0a\u65b0\u7684\u865a\u5b50\u6811\u7684\u8d21\u732e\n\n```cpp\nvoid access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),siz2[x]+=siz[rs(x)]-siz[rs(x)=y],pu(x);\n}\nvoid link(int x,int y){\n    mrt(x),mrt(y),\n    siz2[f[x]=y]+=siz[x];\n}\n```\n\n\u5176\u4ed6\u5730\u65b9\u548c\u666e\u901a\u7684`LCT`\u4e00\u6837\n\n\u6ce8\u610f:\n\n1. \u7ef4\u62a4\u7684\u4fe1\u606f\u8981\u6709**\u53ef\u51cf\u6027**,\u5982\u5b50\u6811\u7ed3\u70b9\u6570,\u5b50\u6811\u6743\u503c\u548c,\u4f46\u4e0d\u80fd\u76f4\u63a5\u7ef4\u62a4\u5b50\u6811\u6700\u5927\u6700\u5c0f\u503c,\u56e0\u4e3a\u5728\u5c06\u4e00\u6761\u865a\u8fb9\u53d8\u6210\u5b9e\u8fb9\u65f6\u8981\u6392\u9664\u539f\u5148\u865a\u8fb9\u7684\u8d21\u732e\n   \n2. \u5982\u679c\u7ef4\u62a4\u7684\u4fe1\u606f\u6ca1\u6709\u53ef\u51cf\u6027,\u5982\u7ef4\u62a4\u533a\u95f4\u6700\u503c,\u53ef\u4ee5\u5bf9\u6bcf\u4e2a\u7ed3\u70b9\u5f00\u4e00\u4e2a\u5e73\u8861\u6811\u7ef4\u62a4\u7ed3\u70b9\u7684\u865a\u5b50\u6811\u4e2d\u7684\u6700\u503c\u3002\n\n[LG4219 \\[BJOI2014\\]\u5927\u878d\u5408](https://www.luogu.com.cn/problem/P4219)\n\n\u8def\u5f84\u6570\u91cf\u4e3a\u65ad\u5f00\u8be5\u8fb9\u540e\u4e24\u7aef\u5b50\u6811\u5927\u5c0f\u7684\u4e58\u79ef\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,q,siz[N],siz2[N],c[2][N],f[N];\nbool rev[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){siz[x]=siz[ls(x)]+siz[rs(x)]+1+siz2[x];}\nil void pr(int x){rev[x]^=1;int t=ls(x);ls(x)=rs(x),rs(x)=t;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nvoid pda(int x){\n    if(nrt(x))pda(f[x]);\n    pd(x);\n}\nil void splay(int x){\n    for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),siz2[x]+=siz[rs(x)]-siz[rs(x)=y],pu(x);\n}\nil void mrt(int x){access(x),splay(x),pr(x);}\nint main(){\n    in(n,q);\n    for(int i=1;i<=n;++i)siz[i]=1;\n    char opt;int x,y;\n    while(q--){\n        in(opt,x,y);\n        if(opt=='A')\n            mrt(x),mrt(y),\n            siz2[f[x]=y]+=siz[x];\n        else{\n            mrt(x),access(y),splay(y);  \n            f[x]=ls(y)=0,pu(x);\n            mrt(x),mrt(y);\n            out((long long)siz[x]*siz[y],ln);\n            siz2[f[x]=y]+=siz[x];\n        }\n    }\n    flush();\n}\n```\n\n[SPOJ QTREE5 - Query on a tree V](https://www.luogu.org/problemnew/show/SP2939)\n\n\u6839\u636e\u5957\u8def,\u7528`LCT`\u7ef4\u62a4\u5b50\u6811,\u4fe1\u606f\u4e3a\u6700\u503c,\u6bcf\u4e2a\u8282\u70b9\u90fd\u5f00\u4e00\u4e2a`multiset`\u6765\u8bb0\u5f55\u865a\u5b50\u6811\u4fe1\u606f\n\n\u601d\u8003`LCT`\u7684\u5b9a\u4e49,\u6bcf\u4e2a`splay`\u7ef4\u62a4\u7684\u662f\u4e00\u6761\u6df1\u5ea6\u5355\u8c03\u9012\u589e\u7684\u94fe(\u4e5f\u53ef\u4ee5\u8bf4\u662f\u5b9e\u94fe)\n\n\u6211\u4eec\u5b9a\u4e49`lm[x],rm[x]`\u5206\u522b\u4e3a\u6bcf\u6761\u5b9e\u94fe\u7684\u4e0a\u7aef\u548c\u4e0b\u7aef\u80fd\u591f\u5230\u8fbe\u6700\u8fd1\u7684\u767d\u70b9\u7684\u8ddd\u79bb\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u65b9\u4fbf\u5730\u66f4\u65b0\u4fe1\u606f\u4e86\n\n\u6bcf\u6b21\u6c42\u89e3\u53ef\u4ee5`access(x),splay(x)`,\u7136\u540e$x$\u5c31\u662f\u6811\u6839\u6240\u5728\u5b9e\u94fe\u7684\u4e0b\u7aef,\u8f93\u51fa`rm[x]`\u5c31\u53ef\u4ee5\u4e86\n\n\u8fd9\u6837\u4e0d\u9700\u8981\u6362\u6839\u4ec0\u4e48\u7684,\u4e5f\u5c31\u4e0d\u9700\u8981\u7ffb\u8f6c\u64cd\u4f5c,\u7701\u53bb\u4e86\u590d\u6742\u7684pushdown\u8fc7\u7a0b\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,inf=1000000000;\nint n,q,siz[N],c[2][N],f[N],lm[N],rm[N];\nbool rev[N],col[N];\nusing std::multiset;\nmultiset<int>s2[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil int min(int x,int y){return x<y?x:y;}\nil void pu(int x){\n    siz[x]=siz[ls(x)]+siz[rs(x)]+1;\n    int t=s2[x].empty()?inf:*s2[x].begin();\n    lm[x]=min(lm[ls(x)],siz[ls(x)]+min(col[x]?0:inf,min(t,lm[rs(x)]+1)));\n    rm[x]=min(rm[rs(x)],siz[rs(x)]+min(col[x]?0:inf,min(t,rm[ls(x)]+1)));\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[y]=x,f[x]=z;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x]){\n        splay(x);\n        s2[x].insert(lm[rs(x)]+1);\n        rs(x)=y;\n        multiset<int>::iterator it=s2[x].lower_bound(lm[rs(x)]+1);\n        if(it!=s2[x].end()&&(*it)==lm[rs(x)]+1)s2[x].erase(it);\n        pu(x);\n    }\n}\nstruct edge{int to,nxt;}e[N<<1];\nint cnt=0,head[N];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x,int fa){\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    if(to!=fa){\n        f[to]=x;s2[x].insert(inf+1);pu(x);\n        dfs(to,x);\n    }\n}\nint main(){\n    in(n);\n    lm[0]=rm[0]=inf;\n    int opt,x,y;\n    for(int i=1;i<n;++i)in(x,y),add(x,y),add(y,x);\n    dfs(1,0);\n    in(q);\n    while(q--){\n        in(opt,x);\n        access(x),splay(x);\n        if(!opt)col[x]^=1,pu(x);\n        else out(rm[x]>n?-1:rm[x],ln);\n    }\n    flush();\n}\n```\n\n[LG 4299 \u9996\u90fd](https://www.luogu.com.cn/problem/P4299)\n\n`LCT`\u7ef4\u62a4\u91cd\u5fc3\n\n\u8fd9\u91cc\u5229\u7528\u4e86\u4e24\u4e2a\u91cd\u5fc3\u6027\u8d28:\n\n1. \u6811\u4e2d\u6240\u6709\u70b9\u5230\u67d0\u4e2a\u70b9\u7684\u8ddd\u79bb\u548c\u4e2d,\u5230\u91cd\u5fc3\u7684\u8ddd\u79bb\u548c\u662f\u6700\u5c0f\u7684,\u5982\u679c\u6709\u4e24\u4e2a\u8ddd\u79bb\u548c,\u4ed6\u4eec\u7684\u8ddd\u79bb\u548c\u4e00\u6837\u3002\n   \n2. \u628a\u4e24\u68f5\u6811\u901a\u8fc7\u67d0\u4e00\u70b9\u76f8\u8fde\u5f97\u5230\u4e00\u9897\u65b0\u7684\u6811,\u65b0\u7684\u6811\u7684\u91cd\u5fc3\u5fc5\u7136\u5728\u8fde\u63a5\u539f\u6765\u4e24\u68f5\u6811\u91cd\u5fc3\u7684\u8def\u5f84\u4e0a\u3002\n\n\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u5b50\u6811\u7684\u5927\u5c0f\n\n\u5408\u5e76\u7684\u65f6\u5019\u8fde\u63a5\u4e24\u68f5\u6811,\u5206\u79bb\u51fa\u8fde\u63a5\u539f\u6765\u4e24\u68f5\u6811\u91cd\u5fc3\u7684\u8def\u5f84,\u5728\u94fe\u4e0a\u641c\u7d22\u51fa\u7b54\u6848\n\n\u65b9\u6cd5\u7c7b\u4f3c\u5e73\u8861\u6811\u7684\u67e5\u627e\n\n\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u6765\u8bb0\u5f55\u91cd\u5fc3\u4f4d\u7f6e,\u8fd9\u6837\u4e0d\u7528\u8c03\u7528\u590d\u6742\u5ea6\u8f83\u9ad8\u7684`find root`\n\n\u6bcf\u6b21\u5408\u5e76\u540e\u8bb0\u5f97\u628a\u65b0\u7684\u91cd\u5fc3\u65cb\u8f6c\u5230\u6839,\u4fdd\u8bc1\u590d\u6742\u5ea6\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,q,s[N],s2[N],c[2][N],f[N],bl[N],ans;\nbool rev[N];\nint BL(int x){return x==bl[x]?x:(bl[x]=BL(bl[x]));}\n#define ls c[0][x]\n#define rs c[1][x]\nvoid pu(int x){s[x]=s[ls]+s[rs]+1+s2[x];}\nvoid pr(int x){rev[x]^=1;ls^=rs,rs^=ls,ls^=rs;}\nvoid pd(int x){\n    if(rev[x]){\n        if(ls)pr(ls);\n        if(rs)pr(rs);\n        rev[x]=0;\n    }\n}\nint g(int x){return c[1][f[x]]==x;}\nint nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nvoid rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nvoid pda(int x){if(nrt(x))pda(f[x]);pd(x);}\nvoid splay(int x){\n    for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n    pu(x);\n}\nvoid access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),s2[x]+=s[rs]-s[rs=y],pu(x);\n}\nvoid mrt(int x){access(x),splay(x),pr(x);}\nvoid link(int x,int y){\n    mrt(x),access(y),splay(y);\n    f[x]=y;\n    s2[y]+=s[x];\n    pu(y);\n}\nint find(int x){\n    bool ff=s[x]&1;\n    int sum=s[x]>>1,cl,cr,as=n+1,lsum=0,rsum=0;\n    while(x){\n        pd(x);\n        cl=s[ls]+lsum,cr=s[rs]+rsum;\n        if(cl<=sum&&cr<=sum){\n            if(ff)return x;\n            else if(as>x)as=x;\n        }\n        if(cl<cr)lsum+=s[ls]+s2[x]+1,x=rs;\n        else rsum+=s[rs]+s2[x]+1,x=ls;\n    }\n    return as;\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    for(int i=1;i<=n;++i)s[i]=1,bl[i]=i,ans^=i;\n    char opt[5];\n    int x,y;\n    while(q--){\n        scanf(\"%s\",opt);\n        if(opt[0]=='X')printf(\"%d\\n\",ans);\n        else if(opt[0]=='Q')\n            scanf(\"%d\",&x),\n            printf(\"%d\\n\",BL(x));\n        else{\n            scanf(\"%d%d\",&x,&y);\n            link(x,y);\n            x=BL(x),y=BL(y);\n            mrt(x),access(y),splay(y);\n            int z=find(y);\n            bl[x]=bl[y]=bl[z]=z;\n            ans^=x^y^z;\n            splay(z);\n        }\n    }\n}\n```\n\n### \u7ef4\u62a4\u6811\u4e0a\u67d3\u8272\u8054\u901a\u5757\n\n[LG SP16549 QTREE6 - Query on a tree VI](https://www.luogu.com.cn/problem/SP16549)\n\n#### \u89e3\u6cd5\u4e00\n\n\u5316\u8fb9\u4e3a\u70b9\n\n\u6bcf\u4e2a\u70b9\u7684\u7236\u8fb9\u8d4b\u4e88\u8be5\u70b9\u7684\u989c\u8272\u3002\u6211\u4eec\u9700\u8981\u4e24\u4e2aLCT,\u6bcf\u79cd\u5bf9\u5e94\u4e00\u4e2a\u989c\u8272\u3002\u4e00\u6761\u8fb9\u53ea\u6709\u5728\u5bf9\u5e94\u989c\u8272\u7684LCT\u4e2d\u624d\u4f1a\u88ab\u8fde\u4e0a\u3002\n\n\u63a5\u7740\u53ef\u4ee5\u53d1\u73b0,\u4fee\u6539\u4e00\u4e2a\u70b9\u7684\u989c\u8272,\u53ea\u9700\u8981\u5728\u539f\u6765\u989c\u8272\u5bf9\u5e94`LCT`\u4e2d\u65ad\u5f00\u7236\u8fb9,\u5728\u65b0\u989c\u8272`LCT`\u4e2d\u8fde\u63a5\u7236\u8fb9,\u5c31\u53ef\u4ee5\u7ef4\u62a4\u540c\u8272\u8fde\u901a\u5757\u4e86\n\n\u67e5\u8be2\u7684\u65f6\u5019\u53ea\u8981\u627e\u5230$x$\u6240\u5728`splay`\u7684\u6839,\u53f3\u5b50\u6811\u5927\u5c0f\u5c31\u662f\u7b54\u6848(\u76f8\u5f53\u4e8e\u8fb9\u7684\u6570\u76ee,\u6839\u7684\u6df1\u5ea6\u6700\u6d45,\u53ea\u6709\u53f3\u5b50\u6811)\n\n\u6ce8\u610f: 1\u8282\u70b9\u662f\u6ca1\u6709\u7236\u4eb2\u7684,\u4e0d\u8fc7\u4e3a\u4e86\u6a21\u578b\u7684\u5efa\u7acb,\u8981\u6709\u7236\u8fb9,\u4e8e\u662f\u9700\u8981\u52a0\u4e00\u4e2a\u865a\u70b9,\u8ba91\u7684\u7236\u4eb2\u6307\u5411\u5b83\u8fde\u8fb9\n\n\u624b\u52a8\u6a21\u62df\u4e00\u4e0b\u5e94\u8be5\u53ef\u4ee5\u61c2\n\n\u8fd9\u4e2a\u7c7b\u578b\u7684`LCT`\u6bd4\u8f83\u7279\u6b8a,\u4ee3\u7801\u53ef\u80fd\u4e5f\u4f1a\u6709\u5c11\u8bb8\u4e0d\u540c,\u591a\u770b\u4ee3\u7801\u7406\u89e3\u4e00\u4e0b\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,q,cnt,head[N],fa[N],v[N];\nbool col[N];\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nstruct LCT{\n    int s[N],c[2][N],s2[N],f[N];\n    il void build(){for(int i=1;i<=n+1;++i)s[i]=1;}\n    #define ls c[0][x]\n    #define rs c[1][x]\n    il void pu(int x){s[x]=s[ls]+s[rs]+1+s2[x];}\n    il int g(int x){return c[1][f[x]]==x;}\n    il int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\n    il void rotate(int x){\n        int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n        if(nrt(y))c[g(y)][z]=x;\n        c[r][x]=y,c[l][y]=w;\n        if(w)f[w]=y;\n        f[x]=z,f[y]=x;\n        pu(y),pu(x);\n    }\n    il void splay(int x){\n        for(int y;nrt(x);rotate(x))if(nrt(y=f[x]))\n            rotate(g(x)^g(y)?x:y);\n        pu(x);\n    }\n    il void access(int x){for(int y=0;x;x=f[y=x])splay(x),s2[x]+=s[rs]-s[rs=y],pu(x);}\n    il void brt(int x){access(x),splay(x);}\n    il int frt(int x){\n        for(brt(x);ls;x=ls);\n        splay(x);return x;\n    }\n    il void link(int x){\n        splay(x);\n        int y=f[x]=fa[x];\n        brt(y);\n        c[1][y]=x,pu(y);\n    }\n    il void cut(int x){\n        brt(x);\n        ls=f[ls]=0;\n        pu(x);\n    }\n    il int ask(int x){return s[c[1][frt(x)]];}\n}T[2];\nvoid dfs(int x){\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to!=fa[x])fa[to]=x,dfs(to);\n    T[0].link(x);\n}\nint main(){\n    in(n);\n    T[0].build(),T[1].build();\n    int x,y;\n    for(int i=1;i<n;++i)in(x,y),add(x,y),add(y,x);\n    fa[1]=n+1;dfs(1);\n    in(q);\n    while(q--){\n        in(y,x);\n        if(y)T[col[x]].cut(x),T[col[x]^=1].link(x);\n        else out(T[col[x]].ask(x),ln);\n    }\n    flush();\n}\n```\n\n#### \u89e3\u6cd52\n\n\u7c7b\u4f3cQTREE5\u7684\u505a\u6cd5\n\n\u8bb0\u5f55\u5b9e\u94fe\u9876\u7aef\u548c\u5e95\u7aef\u7684\u7b54\u6848\n\n\u8981\u4ed4\u7ec6\u8003\u8651`push up`\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,q,s[2][N],c[2][N],f[N],sl[N],sr[N],col[N],tc[N],lc[N],rc[N];\n#define ls c[0][x]\n#define rs c[1][x]\nvoid pu(int x){\n    sl[x]=sl[ls]+(((tc[ls]!=2&&col[x]==tc[ls])||!ls)?s[col[x]][x]+1+(lc[rs]==col[x]?sl[rs]:0):0);\n    sr[x]=sr[rs]+(((tc[rs]!=2&&col[x]==tc[rs])||!rs)?s[col[x]][x]+1+(rc[ls]==col[x]?sr[ls]:0):0);\n    lc[x]=ls?lc[ls]:col[x];\n    rc[x]=rs?rc[rs]:col[x];\n    if(tc[ls]==2||tc[rs]==2||(ls&&tc[ls]!=col[x])||(rs&&tc[rs]!=col[x]))tc[x]=2;\n    else tc[x]=col[x];\n}\nint g(int x){return c[1][f[x]]==x;}\nint nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nvoid rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nvoid splay(int x){\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nvoid access(int x){\n    for(int y=0;x;x=f[y=x]){\n        splay(x);\n        s[lc[rs]][x]+=sl[rs];\n        rs=y;\n        s[lc[y]][x]-=sl[y];\n        pu(x);\n    }\n}\nint cnt=0,head[N];\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x,int fa){\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    if(to!=fa){\n        dfs(to,x);\n        f[to]=x;s[lc[to]][x]+=sl[to];\n    }\n    pu(x);\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)sl[i]=sr[i]=1;\n    int x,y;\n    for(int i=1;i<n;++i){\n        scanf(\"%d%d\",&x,&y);\n        add(x,y),add(y,x);\n    }\n    dfs(1,0);\n    scanf(\"%d\",&q);\n    while(q--){\n        scanf(\"%d%d\",&y,&x);\n        access(x),splay(x);\n        if(y)col[x]^=1,pu(x);\n        else printf(\"%d\\n\",sr[x]);\n    }\n}\n```\n\n[SP16580 QTREE7 - Query on a tree VII](https://www.luogu.com.cn/problem/SP16580)\n\n\u8fd8\u662fQTREE6\u7684\u65b9\u6cd5\n\n\u4ece\u7ef4\u62a4\u5b50\u6811\u5927\u5c0f\u53d8\u6210\u4e86\u7ef4\u62a4\u5b50\u6811\u6700\u503c\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,inf=1000000000;\nusing std::multiset;\nint n,q,cnt,head[N],fa[N],v[N];\nbool col[N];\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nstruct LCT{\n    LCT(){s[0]=-inf;}\n    int s[N],c[2][N],f[N];\n    multiset<int>s2[N];\n    #define ls c[0][x]\n    #define rs c[1][x]\n    il int max(int x,int y){return x>y?x:y;}\n    il void pu(int x){\n        s[x]=max(max(s[ls],s[rs]),v[x]);\n        if(!s2[x].empty())s[x]=max(s[x],*s2[x].rbegin());\n    }\n    il int g(int x){return c[1][f[x]]==x;}\n    il int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\n    il void rotate(int x){\n        int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n        if(nrt(y))c[g(y)][z]=x;\n        c[r][x]=y,c[l][y]=w;\n        if(w)f[w]=y;\n        f[x]=z,f[y]=x;\n        pu(y),pu(x);\n    }\n    il void splay(int x){\n        for(int y;nrt(x);rotate(x))if(nrt(y=f[x]))\n            rotate(g(x)^g(y)?x:y);\n        pu(x);\n    }\n    il void access(int x){\n        for(int y=0;x;x=f[y=x]){\n            splay(x);\n            if(rs)s2[x].insert(s[rs]);\n            if(rs=y)s2[x].erase(s2[x].find(s[y]));\n            pu(x);\n        }\n    }\n    il void brt(int x){access(x),splay(x);}\n    il int frt(int x){\n        for(brt(x);ls;x=ls);\n        splay(x);return x;\n    }\n    il void link(int x){\n        splay(x);\n        int y=f[x]=fa[x];\n        brt(y);\n        c[1][y]=x,pu(y);\n    }\n    il void cut(int x){\n        brt(x);\n        ls=f[ls]=0;\n        pu(x);\n    }\n    il int ask(int x){return s[c[1][frt(x)]];}\n}T[2];\nvoid dfs(int x){\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to!=fa[x])fa[to]=x,dfs(to);\n    T[col[x]].link(x);\n}\nint main(){\n    in(n);\n    int x,y;\n    for(int i=1;i<n;++i)\n        in(x,y),\n        add(x,y),add(y,x);\n    for(int i=1;i<=n;++i)in(col[i]);\n    for(int i=1;i<=n;++i)in(v[i]);\n    fa[1]=n+1;dfs(1);\n    in(q);\n    while(q--){\n        in(y,x);\n        if(y==0)out(T[col[x]].ask(x),ln);\n        else if(y==1)T[col[x]].cut(x),T[col[x]^=1].link(x);\n        else{\n            T[0].brt(x),T[1].brt(x),\n            in(v[x]),\n            T[0].pu(x),T[1].pu(x);\n        }\n    }\n    flush();\n}\n```\n\n### \u4e00\u4e9b\u7075\u6d3b\u5de7\u5999\u7684link-cut tree\u7528\u6cd5\n\n[LG 3203 \\[HNOI2010\\]\u5f39\u98de\u7ef5\u7f8a](https://www.luogu.com.cn/problem/P3203)\n\n\n\n[LG 3703 \\[SDOI2017\\]\u6811\u70b9\u6d82\u8272](https://www.luogu.com.cn/problem/P3703)\n\n`1 x`\u8868\u793a\u628a\u70b9$x$\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u6240\u6709\u7684\u70b9\u67d3\u4e0a\u4e00\u79cd\u6ca1\u6709\u7528\u8fc7\u7684\u65b0\u989c\u8272\n\n\u4ece\u8fd9\u91cc\u53ef\u4ee5\u770b\u51fa\u6bcf\u79cd\u989c\u8272\u5728\u6811\u4e0a\u90fd\u662f\u4e00\u6761\u94fe\u7684\u5f62\u5f0f\u5b58\u5728\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u548c`LCT`\u5f88\u50cf\n\n\u90a3\u4e48`1`\u64cd\u4f5c\u53ef\u4ee5\u770b\u6210`access`\u64cd\u4f5c,(\u5982\u4f55\u64cd\u4f5c\u5148\u653e\u7740\n\n$x$\u5230\u6839\u7684\u989c\u8272\u79cd\u6570\u4e5f\u5c31\u662f\u8981\u7ecf\u8fc7\u7684\u865a\u8fb9\u7684\u6761\u6570,\u8bbe\u4e3a$S_x$\n\n\u6c42$x$\u5230$y$\u7684\u8def\u5f84\u7684\u6743\u503c,\u53ef\u4ee5\u4f7f\u7528\u6811\u4e0a\u5dee\u5206\u7684\u5f62\u5f0f\n\n\u4e5f\u5c31\u662f\u8f6c\u5316\u4e3a$S_x + S_y - 2\\times S_{lca(x,y)} + 1$\n\n`3`\u64cd\u4f5c\u4e5f\u5c31\u662f\u6c42\u5b50\u6811\u6700\u503c\n\n\u6211\u4eec\u56de\u8fc7\u5934\u6765\u770b`access`\u64cd\u4f5c:\n\n1. \u539f\u6765\u7684\u5b9e\u8fb9\u53d8\u865a,\u610f\u5473\u7740\u8981\u591a\u8d70\u4e00\u6761\u865a\u8fb9,\u5c06\u6b64\u94fe\u6240\u7ba1\u8f96\u7684\u533a\u57df\u5168\u90e8+1\n   \n2. \u865a\u8fb9\u53d8\u5b9e\u8fb9,\u610f\u5473\u7740\u8981\u591a\u5c11\u4e00\u6761\u865a\u8fb9,\u5c06\u6b64\u94fe\u6240\u7ba1\u8f96\u7684\u533a\u57df\u5168\u90e8-1\n\n\u6ce8\u610f: `LCT`\u4e2d`splay`\u7684\u7236\u5b50\u5173\u7cfb\u5e76\u4e0d\u662f\u539f\u6811\u4e2d\u7684\u7236\u5b50\u5173\u7cfb,\u8981\u627e\u5230\u8be5`splay`\u4e2d\u6df1\u5ea6\u6700\u5c0f\u7684\u8282\u70b9(\u4e5f\u5c31\u662f\u8fd9\u6761\u94fe\u7684\u9876\u7aef\u518d\u64cd\u4f5c)\n\n\u7efc\u4e0a\u53ef\u4ee5\u7528 lct+lca+dfs\u5e8f+\u7ebf\u6bb5\u6811 \u89e3\u51b3\n\n\u5f53\u7136\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6811\u5256\u6a21\u62df`access`\u7684\u5f62\u5f0f\u6765\u89e3\u51b3\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i(x);i<=y;++i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\ntemplate <class T>il T MAX(T x,T y){return x>y?x:y;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,q,cnt,head[N],a[N];\nstruct seg{\n    #define ls rt<<1\n    #define rs rt<<1|1\n    #define pu s[rt]=MAX(s[ls],s[rs])\n    int s[N<<2],laz[N<<2];\n    void build(int l=1,int r=n,int rt=1){\n        if(l==r)return void(s[rt]=a[l]);\n        int m=l+r>>1;\n        build(l,m,ls);build(m+1,r,rs);\n        pu;\n    }\n    il void pd(int rt){\n        if(laz[rt]){\n            laz[ls]+=laz[rt];\n            laz[rs]+=laz[rt];\n            s[ls]+=laz[rt];\n            s[rs]+=laz[rt];\n            laz[rt]=0;\n        }\n    }\n    void upd(int L,int R,int v,int l=1,int r=n,int rt=1){\n        if(L<=l&&r<=R){\n            s[rt]+=v,laz[rt]+=v;\n            return;\n        }\n        int m=l+r>>1;\n        pd(rt);\n        if(L<=m)upd(L,R,v,l,m,ls);\n        if(R>m)upd(L,R,v,m+1,r,rs);\n        pu;\n    }\n    int ask(int L,int R,int l=1,int r=n,int rt=1){\n        if(L<=l&&r<=R)return s[rt];\n        int m=l+r>>1,ans=0;\n        pd(rt);\n        if(L<=m)ans=ask(L,R,l,m,ls);\n        if(R>m)ans=MAX(ans,ask(L,R,m+1,r,rs));\n        return ans;\n    }\n    il int operator[](int x){\n        int l=1,r=n,rt=1;\n        while(1){\n            if(l==r)return s[rt];\n            int m=l+r>>1;\n            pd(rt);\n            if(x<=m)r=m,rt=ls;\n            else l=m+1,rt=rs;\n        }\n    }\n    #undef ls\n    #undef rs\n}S;\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint siz[N],top[N],id[N],sz;\nstruct lct{\n    #define ls c[0][x]\n    #define rs c[1][x]\n    int f[N],c[2][N];\n    il int g(int x){return c[1][f[x]]==x;}\n    il int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\n    il void rotate(int x){\n        int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n        if(nrt(y))c[g(y)][z]=x;\n        c[r][x]=y,c[l][y]=w;\n        if(w)f[w]=y;\n        f[x]=z,f[y]=x;\n    }\n    il void splay(int x){\n        for(;nrt(x);rotate(x))if(nrt(f[x]))\n            rotate(g(x)^g(f[x])?x:f[x]);\n    }\n    il int frt(int x){while(ls)x=ls;return x;}\n    il void access(int x){\n        for(int y=0,t;x;x=f[y=x]){\n            splay(x);\n            if(rs)t=frt(rs),S.upd(id[t],id[t]+siz[t]-1,1);\n            if(rs=y)t=frt(y),S.upd(id[t],id[t]+siz[t]-1,-1);\n        }\n    }\n    #undef ls\n    #undef rs\n}T;\nint f[N],d[N];\nvoid dfs(int x){\n    siz[x]=1;d[x]=d[f[x]]+1;\n    fl(i,x)if(to!=f[x])\n        f[to]=T.f[to]=x,dfs(to),siz[x]+=siz[to];\n}\nvoid bt(int x,int tp){\n    top[x]=tp;a[id[x]=++sz]=d[x];int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nil int lca(int x,int y){\n    while(top[x]^top[y])\n        d[top[x]]>d[top[y]]?x=f[top[x]]:y=f[top[y]];\n    return d[x]<d[y]?x:y;\n}\nint main(){\n    in(n,q);\n    int opt,x,y;\n    fur(i,2,n)in(x,y),add(x,y),add(y,x);\n    dfs(1);bt(1,1);S.build();\n    while(q--){\n        in(opt,x);\n        if(opt==1)T.access(x);\n        else if(opt==2)\n            in(y),out(S[id[x]]+S[id[y]]-(S[id[lca(x,y)]]<<1)+1,ln);\n        else out(S.ask(id[x],id[x]+siz[x]-1),ln);\n    }\n    flush();\n}\n```", "link": "/posts/link-cut-tree/", "tags": ["\u6570\u636e\u7ed3\u6784", "\u6811\u8bba"], "categories": [["\u7b97\u6cd5", "\u6570\u636e\u7ed3\u6784"], ["note"]]}, {"title": "pbds", "content": "`pbds`\u662f\u4e00\u4e2a\u6bd4stl\u8fd8stl\u7684\u4e1c\u897f\n\n`__gnu_pbds`,\u5168\u79f0: `Policy based data structures`\n\n## \u5f15\u5165\n\n\u6309\u9700\u5f15\u5165:\n\n```cpp\n#include<ext/pb_ds/assoc_container.hpp>\n#include<ext/pb_ds/tree_policy.hpp> //tree\n#include<ext/pb_ds/hash_policy.hpp> //hash\n#include<ext/pb_ds/trie_policy.hpp> //trie\n#include<ext/pb_ds/priority_queue.hpp> //priority_queue\nusing namespace __gnu_pbds;\n```\n\u5168\u90e8\u5f15\u5165:\n\n```cpp\n#include<bits/extc++.h>\nusing namespace __gnu_pbds;\n```\n\n## Hash\n\n\u5c01\u88c5\u7684\u54c8\u5e0c\u8868\n\n\u53ef\u4ee5\u4ee3\u66ff`map`,\u800c\u4e14\u6bd4`map`\u5feb\u5f97\u591a,$\\mathcal{O(n)}$\u4e0e$\\mathcal{O(n \\log n)}$\u7684\u533a\u522b\n\n```cpp\ncc_hash_table<int,bool>h;\ngp_hash_table<int,bool>h; //\u4f3c\u4e4e\u66f4\u5feb\u4e00\u4e9b\n```\n\n\u64cd\u4f5c\u548c`map`\u5dee\u4e0d\u591a,\u652f\u6301`[]`\u548c`find`\n\n## Tree\n\n\u5c01\u88c5\u4e86\u4e09\u79cd\u5e73\u8861\u6811,`rb_tree`,`splay_tree`,`ov_tree`,\u5efa\u8bae\u4f7f\u7528`rb_tree`\n\n```cpp\n#define pii pair<int,int>\n#define mp(x,y) make_pair(x,y) \ntree<pii,null_type,less<pii>,rb_tree_tag,tree_order_statistics_node_update> tr;\npii //\u5b58\u50a8\u7684\u7c7b\u578b\nnull_type //\u65e0\u6620\u5c04(\u4f4e\u7248\u672cg++\u4e3anull_mapped_type)\nless<pii> //\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\nrb_tree_tag //\u7ea2\u9ed1\u6811\ntree_order_statistics_node_update //\u66f4\u65b0\u65b9\u5f0f \ntr.insert(mp(x,y)); //\u63d2\u5165\ntr.erase(mp(x,y)); //\u5220\u9664\ntr.order_of_key(pii(x,y)); //\u6c42\u6392\u540d \ntr.find_by_order(x); //\u627ek\u5c0f\u503c,\u8fd4\u56de\u8fed\u4ee3\u5668 \ntr.join(b); //\u5c06b\u5e76\u5165tr,\u524d\u63d0\u662f\u4e24\u68f5\u6811\u7c7b\u578b\u4e00\u6837\u4e14\u6ca1\u6709\u91cd\u590d\u5143\u7d20 \ntr.split(v,b); //\u5206\u88c2,key\u5c0f\u4e8e\u7b49\u4e8ev\u7684\u5143\u7d20\u5c5e\u4e8etr,\u5176\u4f59\u7684\u5c5e\u4e8eb\ntr.lower_bound(x); //\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5927\u4e8e\u7b49\u4e8ex\u7684\u5143\u7d20\u7684\u8fed\u4ee3\u5668\ntr.upper_bound(x); //\u8fd4\u56de\u7b2c\u4e00\u4e2a\u5927\u4e8ex\u7684\u5143\u7d20\u7684\u8fed\u4ee3\u5668\n```\n\n\u548c`set`\u4e00\u6837**\u4e0d\u652f\u6301\u91cd\u590d\u5143\u7d20**,\u8bb0\u4f4f\u5343\u4e07\u4e0d\u8981\u63d2\u5165\u91cd\u590d\u5143\u7d20\n\n[LG P3369 \u3010\u6a21\u677f\u3011\u666e\u901a\u5e73\u8861\u6811](https://www.luogu.com.cn/problem/P3369)\n\n```cpp\n#include<bits/stdc++.h>\n#include<bits/extc++.h>\nusing namespace std;\nusing namespace __gnu_pbds;\ntypedef long long ll;\ntree<ll,null_type,less<ll>,rb_tree_tag,tree_order_statistics_node_update>T;\nint n;ll x,ans;\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1,opt;i<=n;++i){\n        scanf(\"%d%lld\",&opt,&x);\n        if(opt==1)T.insert((x<<20)+i);\n        if(opt==2)T.erase(T.lower_bound(x<<20));\n        if(opt==3)printf(\"%d\\n\",T.order_of_key(x<<20)+1);\n        if(opt==4)ans=*T.find_by_order(x-1),printf(\"%lld\\n\",ans>>20);\n        if(opt==5)ans=*--T.lower_bound(x<<20),printf(\"%lld\\n\",ans>>20);\n        if(opt==6)ans=*T.upper_bound((x<<20)+n),printf(\"%lld\\n\",ans>>20);\n    }\n}\n```\n\n\u8fd9pbds\u901f\u5ea6\u8fd8\u86ee\u5feb\u7684\n\n## Trie\n\n\u5b57\u5178\u6811\n\n```cpp\ntypedef trie<string,null_type,trie_string_access_traits<>,pat_trie_tag,trie_prefix_search_node_update>tr;\n//\u7b2c\u4e00\u4e2a\u53c2\u6570\u5fc5\u987b\u4e3a\u5b57\u7b26\u4e32\u7c7b\u578b,tag\u4e5f\u6709\u522b\u7684tag,\u4f46pat\u6700\u5feb,\u4e0etree\u76f8\u540c,node_update\u652f\u6301\u81ea\u5b9a\u4e49\ntr.insert(s); //\u63d2\u5165s \ntr.erase(s); //\u5220\u9664s \ntr.join(b); //\u5c06b\u5e76\u5165tr \npair//pair\u7684\u4f7f\u7528\u5982\u4e0b\uff1a\npair<tr::iterator,tr::iterator>range=base.prefix_range(x);\nfor(tr::iterator it=range.first;it!=range.second;it++)\n    cout<<*it<<' '<<endl;\n//pair\u4e2d\u7b2c\u4e00\u4e2a\u662f\u8d77\u59cb\u8fed\u4ee3\u5668,\u7b2c\u4e8c\u4e2a\u662f\u7ec8\u6b62\u8fed\u4ee3\u5668,\u904d\u5386\u8fc7\u53bb\u5c31\u53ef\u4ee5\u627e\u5230\u6240\u6709\u5b57\u7b26\u4e32\u4e86\u3002 \n```\n\n## priority_queue\n\n```cpp\npriority_queue<int,greater<int>,TAG>Q;//\u5c0f\u6839\u5806,\u5927\u6839\u5806\u5199less<int>\n/*\u5176\u4e2d\u7684TAG\u4e3a\u7c7b\u578b,\u6709\u4ee5\u4e0b\u51e0\u79cd\uff1a\npairing_heap_tag\nthin_heap_tag\nbinomial_heap_tag\nrc_binomial_heap_tag \nbinary_heap_tag\n\u5176\u4e2dpairing_help_tag\u6700\u5feb*/\nQ.push(x);\nQ.pop();\nQ.top();\nQ.join(b);\nQ.empty();\nQ.size(); \nQ.modify(it,x);\nQ.erase(it);\n//pbds\u91cc\u7684\u4f18\u5148\u961f\u5217\u8fd8\u53ef\u4ee5\u7528\u8fed\u4ee3\u5668\u904d\u5386\n```\n\n\u90e8\u5206\u5185\u5bb9\u5f15\u81eahttps://www.luogu.com.cn/blog/Chanis/gnu-pbds", "link": "/posts/pbds/", "tags": ["stl"], "categories": [["note"]]}, {"title": "\u6574\u4f53\u4e8c\u5206", "content": "\u6574\u4f53\u4e8c\u5206\u662f\u79bb\u7ebf\u7b97\u6cd5\n\n\u987e\u540d\u601d\u4e49\u5c31\u662f\u5c06\u6240\u6709\u7b54\u6848\u4e00\u8d77\u4e8c\u5206\n\n$solve(l,r,st,ed)$\u8868\u793a\u7b54\u6848\u5728$[l,r]$,\u89e3\u51b3\u7b2c$st$\u5230$ed$\u4e2a\u8be2\u95ee\u6216\u64cd\u4f5c\n\n\u4ee5\u9759\u6001\u533a\u95f4\u7b2c$k$\u5c0f\u4e3a\u4f8b,[LG P3834 \u3010\u6a21\u677f\u3011\u53ef\u6301\u4e45\u5316\u7ebf\u6bb5\u6811 1\uff08\u4e3b\u5e2d\u6811\uff09](https://www.luogu.com.cn/problem/P3834)\n\n\u5982\u679c$l=r$,\u76f4\u63a5$[st,ed]$\u7b54\u6848\u90fd\u662f$l$\n\n\u548c\u666e\u901a\u4e8c\u5206\u4e00\u6837,\u8bbe$m=\\frac {l+r}2$\n\n\u5982\u679c \u662f\u539f\u5e8f\u5217\u4e2d\u7684\u6570 \u4e14 \u5927\u4e8e$m$ , \u5728\u6811\u72b6\u6570\u7ec4\u4e2d\u5bf9\u5e94\u4f4d\u7f6e+1\n\n\u5982\u679c\u662f\u8be2\u95ee\u64cd\u4f5c,\u8bbe$x$\u4e3a\u6811\u72b6\u6570\u7ec4\u4e2d\u8be2\u95ee\u533a\u95f4\u7684\u603b\u548c,\n\n\u82e5$x \\ge k$\u5219\u5206\u914d\u5230\u5de6\u533a\u95f4,\n\n\u5426\u5219\u5206\u914d\u5230\u53f3\u533a\u95f4,$k=k-x$.\n\n\u5177\u4f53\u770b\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=200011;\nint n,q,ans[N],s[N];\ninline void add(int x,int v){for(;x<=n;x+=x&-x)s[x]+=v;}\ninline int ask(int x){int res=0;for(;x;x-=x&-x)res+=s[x];return res;}\nstruct que{int typ,id,l,r,k;}a[N<<1],a1[N<<1],a2[N<<1];\nvoid solve(int l,int r,int st,int ed){\n    if(st>ed||l>r)return;\n    if(l==r){for(int i=st;i<=ed;++i)ans[a[i].id]=l;return;}\n    int m=(l+r)>>1,c1=0,c2=0;\n    for(int i=st;i<=ed;++i)\n    if(a[i].typ){\n        if(a[i].k<=m)add(a[i].l,1),a1[++c1]=a[i];\n        else a2[++c2]=a[i];\n    }\n    else{\n        int x=ask(a[i].r)-ask(a[i].l-1);\n        if(a[i].k<=x)a1[++c1]=a[i];\n        else a[i].k-=x,a2[++c2]=a[i];\n    }\n    // \u53ef\u4ee5\u6e05\u7a7a\u6811\u72b6\u6570\u7ec4,\u4e5f\u53ef\u4ee5\u76f4\u63a5\u5c06\u52a0\u4e0a\u7684\u51cf\u53bb,\u540e\u8005\u66f4\u5feb\n    for(int i=1;i<=c1;++i)if(a1[i].typ)add(a1[i].l,-1);\n    for(int i=1;i<=c1;++i)a[st+i-1]=a1[i];\n    for(int i=1;i<=c2;++i)a[st+c1+i-1]=a2[i];\n    solve(l,m,st,st+c1-1);\n    solve(m+1,r,st+c1,ed);\n}\nint main(){\n    in(n,q);\n    int x,l,r,k;\n    for(int i=1;i<=n;++i)in(x),a[i]={1,0,i,0,x};\n    for(int i=1;i<=q;++i)in(l,r,k),a[n+i]={0,i,l,r,k};\n    solve(-1e9,1e9,1,n+q);\n    for(int i=1;i<=q;++i)out(ans[i],ln);\n    flush();\n}\n```", "link": "/posts/\u6574\u4f53\u4e8c\u5206/", "tags": ["\u7b97\u6cd5", "\u4e8c\u5206", "\u79bb\u7ebf", "\u6570\u636e\u7ed3\u6784"], "categories": [["\u7b97\u6cd5", "\u79bb\u7ebf"], ["note"]]}, {"title": "\u5feb\u901f\u8bfb\u5165\u8f93\u51fa", "content": "\u4f7f\u7528fread\u52a0\u901f\n\n## \u4ec5\u6570\u5b57:\n\n```cpp\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\n```\n\n## \u5168\u90e8:\n\n```cpp\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}inline void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}inline void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}inline void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(const char* s){while(*s)pt(*s++);}inline void out(char* s){while(*s)pt(*s++);}inline void out(char c){pt(c);}inline void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\n```\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nnamespace IN{\n    const int str=1<<20;\n    static char in_buf[str],*in_s,*in_t;\n    bool __=0;\n    inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}\n    inline void in(string &ch){\n        ch.clear();\n        if(__)return;\n        char c;\n        while((c=gc())!=EOF&&isspace(c));\n        if(c==EOF){__=1;return;}\n        ch+=c;\n        while((c=gc())!=EOF&&!isspace(c))ch+=c;\n        if(c==EOF)__=1;\n    }\n    inline void in(char &ch){\n        if(__)return;\n        char c;\n        while((c=gc())!=EOF&&isspace(c));\n        if(c==EOF)__=1;\n        else ch=c;\n    }\n    inline void in(char *ch){\n        *ch='\\0';\n        if(__)return;\n        char c;\n        while((c=gc())!=EOF&&isspace(c));\n        if(c==EOF){__=1;return;}\n        *ch=c;ch++;\n        while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;\n        if(c==EOF)__=1;\n        *ch='\\0';\n    }\n    template<typename T>\n    inline void in(T &x){\n        if(__)return;\n        char c=gc();\n        bool f=0;\n        while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();\n        if(c==EOF){__=1;return;}\n        x=0;\n        while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();\n        if(c==EOF)__=1;\n        if(f)x=-x;\n    }\n    template<typename T,typename ... arr>\n    inline void in(T &x,arr & ... y){in(x),in(y...);}\n}using namespace IN;\nnamespace OUT{\n    const char ln='\\n';\n    const int str=1<<20;\n    static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;\n    inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}\n    inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}\n    inline void out(const char* s){while(*s)pt(*s++);}\n    inline void out(char* s){while(*s)pt(*s++);}\n    inline void out(char c){pt(c);}\n    inline void out(string s){for(int i=0;s[i];i++)pt(s[i]);}\n    template<typename T>\n    inline void out(T x){\n        if(!x){pt('0');return;}\n        if(x<0)pt('-'),x=-x;\n        char a[50],t=0;\n        while(x)a[t++]=x%10,x/= 10;\n        while(t--)pt(a[t]+'0');\n    }\n    template<typename T,typename ... arr>\n    inline void out(T x,arr & ... y){out(x),out(y...);}\n}using namespace OUT;\nchar ch[1000000];\nint main(){\n    int n;\n    in(n);\n    for(int i=1;i<=n;++i)in(ch),out(ch,ln);\n    for(int i=1;i<=n;++i)in(ch),out(int(strlen(ch)),ln);\n    in(ch);\n    out(int(strlen(ch)),ln);\n    flush();\n}\n```", "link": "/posts/\u5feb\u901f\u8bfb\u5165\u8f93\u51fa/", "tags": ["\u5361\u5e38"], "categories": [["note"]]}, {"title": "cdq\u5206\u6cbb", "content": "## \u4e8c\u7ef4\u504f\u5e8f\n\n\u5148\u6309 \u7b2c\u4e00\u7ef4 \u6392\u5e8f, \u7b2c\u4e8c\u7ef4 \u7528\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\n\n\u4f8b\u9898: [\\[SHOI2007\\]\u56ed\u4e01\u7684\u70e6\u607c](https://www.luogu.com.cn/problem/P2163)\n\n\u79bb\u7ebf\u64cd\u4f5c\n\n\u5148\u5c06\u6bcf\u4e2a\u8be2\u95ee\u62c6\u62104\u4e2a\u70b9\u67e5\u8be2\n\n\u8bbe$(1,1)$\u5230$(x,y)$\u4e2d\u70b9\u6570\u4e3a$s(x,y)$.\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u4e3a$s(c,d)-s(a-1,d)-s(c,b-1)+s(a-1,b-1)$\n\n\u5148\u5c06 \u70b9\u548c\u8be2\u95ee \u6309$x$\u8f74\u6392\u5e8f,\u70b9\u6309\u987a\u5e8f\u63d2\u5165\n\n$y$\u8f74\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4,\u67e5\u8be2\u5373\u53ef\n\n```cpp\n#include<bits/stdc++.h>\nnamespace FastIO{const char* ln=\"\\n\";struct Reader{char buf[1<<20],*s,*t;bool EOF_FLG;Reader():s(buf),t(buf),EOF_FLG(false) {};char gt() {return s==t&&((t=(s=buf)+fread(buf,1,1<<20,stdin))==s)?EOF:(*s++);}Reader& operator>>(char* str) {if(EOF_FLG)return *str=0,*this;while((*str=gt())!=' '&&*str!='\\n'&&*str!=EOF)++str;if(*str==EOF)EOF_FLG=true;*str=0;return *this;}template<typename T>Reader&operator>>(T&x) {if(EOF_FLG)return *this;char c=0,d;while(c!=EOF&&(c<'0'||c>'9'))d=c,c=gt();if(c==EOF){EOF_FLG=true;return *this;}else x=0;while(c>='0'&&c<='9')x=(x<<3)+(x<<1)+c-'0',c=gt();if(d=='-')x=-x;return *this;}}in;struct Writer{char buf[1<<20],*s,*t;Writer():s(buf),t(buf+(1<<20)){}~Writer(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,1<<20,stdout),*s++=c):(*s++=c);}template<typename T>Writer&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[40],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}Writer&operator<<(const char*s) {while(*s)pt(*s++);return *this;}}out;}using namespace FastIO;\n#define Fur(i,x,y) for(int i=x;i<=y;i++)\nusing namespace std;\n#define N 500000\nint n,q;\nstruct node{\n    int x,y,id,opt;\n}a[N+1],b[N*4+1];\nint tr[N+1],ans[N+1];\nvoid add(int x){while(x<=N)tr[x]++,x+=(x&-x);};\nint get(int x){int s=0;while(x)s+=tr[x],x-=(x&-x);return s;}\nbool cmp(node x,node y){\n    if(x.x!=y.x)return x.x<y.x;\n    return x.y<y.y;\n}\nint main(){\n    in>>n>>q;\n    int d=0,x,y,xx,yy;\n    Fur(i,1,n)in>>x>>y,a[i].x=x+1,a[i].y=y+1;\n    sort(a+1,a+n+1,cmp);\n    Fur(i,1,q){\n        in>>x>>y>>xx>>yy;\n        x++;y++;xx++;yy++;\n        b[++d].x=x-1,b[d].y=y-1,b[d].opt=1,b[d].id=i;\n        b[++d].x=x-1,b[d].y=yy,b[d].opt=-1,b[d].id=i;\n        b[++d].x=xx,b[d].y=y-1,b[d].opt=-1,b[d].id=i;\n        b[++d].x=xx,b[d].y=yy,b[d].opt=1,b[d].id=i;\n    }\n    sort(b+1,b+d+1,cmp);\n    int j=1;\n    Fur(i,1,d){\n        while(j<=n&&a[j].x<=b[i].x)add(a[j].y),j++;\n        ans[b[i].id]+=get(b[i].y)*b[i].opt;\n    }\n    Fur(i,1,q)out<<ans[i]<<ln;\n}\n```\n\n## \u4e09\u7ef4\u504f\u5e8f\n\n\u5982\u679c\u6309\u7b2c\u4e00\u7ef4\u6392\u5e8f,\u7b2c\u4e8c\u3001\u4e09\u7ef4\u7528\u9ad8\u7ea7\u6570\u636e\u7ed3\u6784\u7ef4\u62a4,\u6709\u70b9\u9ebb\u70e6,\u800c\u4e14\u7a7a\u95f4\u65f6\u95f4\u590d\u6742\u5ea6\u9ad8\n\n\u5728\u5141\u8bb8\u79bb\u7ebf\u7684\u6761\u4ef6\u4e0b,**cdq\u5206\u6cbb**\u4e3a\u4e0a\u7b49\u9009\u62e9\n\ncdq\u5206\u6cbb\u6709\u70b9\u7c7b\u4f3c \u5f52\u5e76\u6392\u5e8f\u6c42\u9006\u5e8f\u5bf9 \u7684\u601d\u8def\n\n\u8fd8\u662f\u5168\u90e8\u5148\u6309\u7b2c\u4e00\u7ef4\u6392\u5e8f\n\n\u63a5\u7740\u628a\u6570\u5217\u62c6\u6210\u76f8\u7b49\u7684\u4e24\u534a\n\n\u5206\u522b\u6309\u7b2c\u4e8c\u7ef4\u6392\u5e8f\n\n\u5904\u7406\u51fa \u524d\u534a\u90e8\u5206 \u5bf9 \u540e\u534a\u90e8\u5206 \u7684\u5f71\u54cd(\u7ed3\u679c)\n\n\u8fd9\u6837\u7b2c\u4e00\u7ef4\u548c\u7b2c\u4e8c\u7ef4\u90fd\u786e\u5b9a\u7684,\u6709\u987a\u5e8f\u7684,\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651\u7b2c\u4e09\u7ef4\n\n\u8fd8\u662f\u7528 \u7b80\u5355\u7684\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\u5c31\u53ef\u4ee5\u4e86(\u5982 \u6811\u72b6\u6570\u7ec4 \u3001 \u7ebf\u6bb5\u6811)\n\n\u4f8b\u9898: [LG 3810 \u3010\u6a21\u677f\u3011\u4e09\u7ef4\u504f\u5e8f\uff08\u964c\u4e0a\u82b1\u5f00\uff09](https://www.luogu.com.cn/problem/P3810)\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;typedef double db;typedef unsigned long long ull;\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=100011;\nusing std::sort;\nint d,n,k,s[N<<1],ans[N];\nstruct node{int x,y,z,ans,w;}b[N],a[N];\nbool cmpx(node x,node y){\n    if(x.x!=y.x)return x.x<y.x;\n    if(x.y!=y.y)return x.y<y.y;\n    return x.z<y.z;\n}\nbool cmpy(node x,node y){\n    if(x.y!=y.y)return x.y<y.y;\n    return x.z<y.z;\n}\ninline void add(int x,int v){\n    for(int i=x;i<=k;i+=i&-i)\n        s[i]+=v;\n}\ninline int ask(int x){\n    int res=0;\n    for(int i=x;i;i-=i&-i)\n        res+=s[i];\n    return res;\n}\ninline void cdq(int l,int r){\n    if(l>=r)return;\n    int m=(l+r)>>1,j=l;\n    cdq(l,m);cdq(m+1,r);\n    sort(a+l,a+m+1,cmpy);\n    sort(a+m+1,a+r+1,cmpy);\n    for(int i=m+1;i<=r;++i){\n        for(;j<=m&&a[j].y<=a[i].y;++j)\n            add(a[j].z,a[j].w);\n        a[i].ans+=ask(a[i].z);\n    }\n    for(int i=l;i<=j-1;++i)\n        add(a[i].z,-a[i].w);\n}\nint main(){\n    in(d,k);\n    for(int i=1;i<=d;++i)\n        in(b[i].x,b[i].y,b[i].z);\n    sort(b+1,b+d+1,cmpx);\n    for(int i=1,c=1;i<=d;++i,++c)\n    if(b[i].x!=b[i+1].x||b[i].y!=b[i+1].y||b[i].z!=b[i+1].z)\n        a[++n]=b[i],a[n].w=c,c=0;\n    cdq(1,n);\n    for(int i=1;i<=n;++i)\n        ans[a[i].ans+a[i].w]+=a[i].w;\n    for(int i=1;i<=d;++i)\n        out(ans[i]),pt('\\n');\n    flush();\n}\n```\n\n[LG 3157 \\[CQOI2011\\]\u52a8\u6001\u9006\u5e8f\u5bf9](https://www.luogu.com.cn/problem/P3157)\n\n\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\u4e09\u7ef4\u504f\u5e8f\n\n\u6211\u4eec\u5148\u627e\u51fa\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u7684\u70b9$(i,j)$\u6ee1\u8db3\u7684\u6761\u4ef6\uff1a\n\n$time_i<time_j$\n\n$val_i<val_j,pos_i>pos_j$\u6216$val_i>val_j,pos_i<pos_j$\n\n```cpp\n#include<bits/stdc++.h>\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=100011,inf=2122219134;\nint n,q,s[N],pos[N];\nlong long ans[50011];\nvoid add(int x,int v){for(;x<=n;x+=x&-x)s[x]+=v;}\nint ask(int x){int res=0;for(;x;x-=x&-x)res+=s[x];return res;}\nstruct node{\n    int v,w,p,id;\n    bool operator<(node t){return p<t.p;}\n}b[N+50000],c[N+50000];\nvoid cdq(int l,int r){\n    if(l>=r)return;\n    int m=(l+r)>>1,j=l;\n    cdq(l,m);cdq(m+1,r);\n    for(int i=m+1;i<=r;++i){\n        for(;j<=m&&b[j].p<=b[i].p;++j)add(b[j].v,b[j].w);\n        ans[b[i].id]+=b[i].w*(ask(n)-ask(b[i].v));// \u7edf\u8ba1\u5728i\u4e4b\u524d\u7684\u4e0ei\u7ec4\u6210\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\n    }\n    for(int i=l;i<j;++i)add(b[i].v,-b[i].w);\n    j=m;\n    for(int i=r;i>m;--i){\n        for(;j>=l&&b[j].p>=b[i].p;--j)add(b[j].v,b[j].w);\n        ans[b[i].id]+=b[i].w*ask(b[i].v-1);// \u7edf\u8ba1\u5728i\u4e4b\u540e\u7684\u4e0ei\u7ec4\u6210\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\n    }\n    for(int i=m;i>j;--i)add(b[i].v,-b[i].w);\n    std::merge(b+l,b+m+1,b+m+1,b+r+1,c+l);//\u4f7f\u7528merge\u5408\u5e76\u6bd4\u6392\u5e8f\u66f4\u5feb(\u5f52\u5e76\u6392\u5e8f)\n    for(int i=l;i<=r;++i)b[i]=c[i];\n}\nint main(){\n    in(n,q);\n    int x;\n    for(int i=1;i<=n;++i)in(x),b[i]=node{x,1,pos[x]=i,0};\n    for(int i=1;i<q;++i)in(x),b[n+i]=node{x,-1,pos[x],i};\n    cdq(1,n+q-1);\n    for(int i=1;i<q;++i)ans[i]+=ans[i-1];\n    for(int i=0;i<q;++i)out(ans[i],ln);\n    flush();\n}\n```", "link": "/posts/cdq\u5206\u6cbb/", "tags": ["\u7b97\u6cd5", "\u5206\u6cbb", "\u6570\u636e\u7ed3\u6784", "\u79bb\u7ebf"], "categories": [["\u7b97\u6cd5", "\u79bb\u7ebf"], ["note"]]}, {"title": "\u675c\u6559\u7b5b", "content": "\u524d\u7f6e\u77e5\u8bc6: [\u72c4\u5229\u514b\u96f7\u5377\u79ef](/posts/di-li-ke-lei-juan-ji)\n\n\u6c42\u79ef\u6027\u51fd\u6570$f$\u7684\u524d\u7f00\u548c:\n\n$$S(n)=\\sum_{i=1}^nf(i)$$\n\n\u5927\u90e8\u5206\u9898\u76ee\u90fd\u662f\u53ef\u4ee5\u7ebf\u6027\u7b5b\u7684,\u53ef\u662f\u67d0\u4e9b\u4e27\u5fc3\u75c5\u72c2\u7684\u51fa\u9898\u4eba\u4f1a: $n\\le 10^{12}$!\n\n\u8fd9\u65f6\u5019\u9700\u8981\u7528\u675c\u6559\u7b5b\u4e86\n\n\u6211\u4eec\u6784\u9020\u53e6\u5916\u4e00\u4e2a\u79ef\u6027\u51fd\u6570$g$,\u90a3\u4e48\n\n$$\n\\sum_{i=1}^n(g * f)\n\\\\\n=\\sum_{i=1}^n\\sum_{d|i}g(d)f(\\frac id)\n\\\\\n=\\sum_{d=1}^ng(d)\\sum_{d|i}f(\\frac id)\n\\\\\n=\\sum_{d=1}^ng(d)\\sum_{i=1}^{\\frac nd}f(i)\n\\\\\n=\\sum_{d=1}^ng(d)S(\\frac nd)\n$$\n\n\u5bb9\u65a5\u4e00\u4e0b,\u90a3\u4e48\n\n$$\ng(1)S(n)\n\\\\\n=\\sum_{d=1}^ng(d)S(\\frac nd)-\\sum_{d=2}^ng(d)S(\\frac nd)\n\\\\\n=\\sum_{i=1}^n(f * g)(i)-\\sum_{i=2}^ng(i)S(\\frac ni)\n$$\n\n\u53ef\u4ee5\u53d1\u73b0,\u524d\u534a\u90e8\u5206\u662f\u72c4\u5229\u514b\u96f7\u5377\u79ef\u7684\u524d\u7f00\u548c\u7684\u5f62\u5f0f,\u540e\u534a\u90e8\u5206\u53ef\u4ee5\u6570\u8bba\u5206\u5757\n\n\u6700\u7ec8\u53ef\u4ee5\u4f18\u5316\u5230$O(n^{\\frac 23})$\n\n\u90a3\u4e48\u5982\u4f55\u9009\u597d\u79ef\u6027\u51fd\u6570$g$\u5462?\n\n## \u83ab\u6bd4\u4e4c\u65af\u51fd\u6570$\\mu$\n\n\u5982\u679c\u6211\u4eec\u9009\u62e9$g=1$($1$\u4e0e$\\mu$\u4e92\u4e3a\u9006\u5143,$1 * \\mu = \\epsilon$)\n\n$$\n1(1)S(n)=S(n)\n\\\\\n=\\sum_{i=1}^n \\epsilon(i)-\\sum_{i=2}^n1(i)S(\\frac ni)\n\\\\\n=1-\\sum_{i=2}^nS(\\frac ni)\n$$\n\n\u540e\u534a\u90e8\u5206\u6570\u8bba\u5206\u5757\u5373\u53ef\n\n## \u6b27\u62c9\u51fd\u6570$\\varphi$\n\n\u8fd8\u662f\u9009\u53d6$g=1$\n\n$\\varphi *1 = Id$\n\n$$\n1(1)S(n)=S(n)\n\\\\\n=\\sum_{i=1}^n Id(i)-\\sum_{i=2}^n1(i)S(\\frac ni)\n\\\\\n=\\frac{n(n+1)}2-\\sum_{i=2}^nS(\\frac ni)\n$$\n\n\u524d\u534a\u90e8\u5206\u76f4\u63a5\u5f97\u51fa,\u540e\u534a\u90e8\u5206\u6570\u8bba\u5206\u5757\n\n## \u4ee3\u7801\n\n[LG 4213 \u3010\u6a21\u677f\u3011\u675c\u6559\u7b5b\uff08Sum\uff09](https://www.luogu.com.cn/problem/P4213)\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nconst int N=5000000;\nint mu[N+11],pri[N+1];\nll phi[N+11];\nbool b[N+11];\nil void init(){\n    mu[1]=phi[1]=1;\n    int cnt=0;\n    for(int i=2;i<=N;++i){\n        if(!b[i])pri[++cnt]=i,mu[i]=-1,phi[i]=i-1;\n        for(int j=1;j<=cnt&&i*pri[j]<=N;++j){\n            b[i*pri[j]]=1;\n            if(i%pri[j])mu[i*pri[j]]=-mu[i],phi[i*pri[j]]=phi[i]*(pri[j]-1);\n            else{phi[i*pri[j]]=phi[i]*pri[j];break;}\n        }\n    }\n    for(int i=2;i<=N;++i)mu[i]+=mu[i-1],phi[i]+=phi[i-1];\n}\nconst int P=1000007;\nstruct hash{\n    int cnt=0,head[P];\n    struct edge{int to,nxt;ll w;}e[P];\n    il void add(int x,int y,ll w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\n    il void ins(int x,ll v){add(x%P,x,v);}\n    il ll ask(int x){for(int i=head[x%P];i;i=e[i].nxt)if(e[i].to==x)return e[i].w;return 1ll<<63;}\n}SP,SM;\nll PHI(int n){\n    if(n<=N)return phi[n];\n    ll t=SP.ask(n);if(t!=(1ll<<63))return t;\n    ll res=1ll*n*(n+1)/2;\n    for(ll l=2,r;l<=n;l=r+1){\n        r=n/(n/l);\n        res-=PHI(n/l)*(r-l+1);\n    }\n    SP.ins(n,res);\n    return res;\n}\nll MU(int n){\n    if(n<=N)return mu[n];\n    ll t=SM.ask(n);if(t!=(1ll<<63))return t;\n    ll res=1;\n    for(ll l=2,r;l<=n;l=r+1){\n        r=n/(n/l);\n        res-=MU(n/l)*(r-l+1);\n    }\n    SM.ins(n,res);\n    return res;\n}\nint main(){\n    init();\n    int T,n;scanf(\"%d\",&T);\n    while(T--){\n        scanf(\"%d\",&n);\n        printf(\"%lld %lld\\n\",PHI(n),MU(n));\n    }\n}\n```", "link": "/posts/\u675c\u6559\u7b5b/", "tags": ["\u6570\u8bba", "\u5377\u79ef", "\u675c\u6559\u7b5b"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "\u72c4\u5229\u514b\u96f7\u5377\u79ef", "content": "## \u6570\u8bba\u51fd\u6570\n\n1. \u52a0\u6cd5\n   \n   \u9010\u9879\u76f8\u52a0\n\n   $$(f+g)(x)=f(x)+g(x)$$\n\n2. \u6570\u4e58\n   \n   $$(xf)(n)=x\\cdot f(n)$$\n\n## \u5b9a\u4e49\n\n\u4e24\u4e2a\u6570\u8bba\u51fd\u6570\u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\u2217\n\n$t=f*g$\u7b49\u4ef7\u4e8e\n\n$$t(n)=\\sum_{i|n}f(i) \\cdot g(\\frac ni)$$\n\n\u7b49\u4ef7\u4e8e\n\n$$t(n)=\\sum_{ij|n}f(i) \\cdot g(j)$$\n\n## \u6027\u8d28\n\n1. \u4ea4\u6362\u5f8b$f*g=g*f$\n\n2. \u7ed3\u5408\u5f8b$f*(g*h)=(f*g)*h$\n\n3. \u5206\u914d\u7387$f*h+g*h=(f+g)*h$\n\n4. $(xf)*g=x(f*g)$\n   \n5. \u5355\u4f4d\u5143$\\epsilon*f=f$\n\n\u4ee5\u4e0a5\u4e2a\u7ed3\u8bba\u90fd\u53ef\u4ee5\u901a\u8fc7\u5e26\u5165\u5f97\u5230\n   \n6. \u9006\u5143\n   \n   \u5bf9\u4e8e\u6bcf\u4e2a$f(1) \\not = 0$\u7684\u51fd\u6570$f$,\u90fd\u5b58\u5728$f*g=\\epsilon$\n\n   > \u5b9a\u4e49\n   > \n   > $$g(n)=\\frac{1}{f(1)}\\left([n=1]-\\sum_{i|n,i\\neq 1}f(i)g(\\frac{n}{i})\\right)$$\n   > \n   > \u90a3\u4e48\n   > \n   > $$\\sum_{i|n}f(i)g(\\frac{n}{i})\\\\=f(1)g(n)+\\sum_{i|n,i\\neq1}f(i)g(\\frac{n}{i})\\\\=[n=1]-\\sum_{i|n,i\\neq 1}f(i)g(\\frac{n}{i})+\\sum_{i|n,i\\neq 1}f(i)g(\\frac{n}{i})\\\\=[n=1]$$\n\n## \u5e38\u7528\u7684\u51fd\u6570\u4e0e\u4e0e\u5e38\u7528\u5377\u79ef\u5173\u7cfb\n\n### \u51e0\u4e2a\u5e38\u7528\u7684\u51fd\u6570:\n\n   - $\\epsilon(n)=[n=1]$\n   - $1(n)=1$\n   - $Id(n)=n$\n   - \u83ab\u6bd4\u4e4c\u65af\u51fd\u6570:\n     $$\\mu(i)=\\begin{cases}1,i=1\\\\(-1)^k,i=p_1\\times p_2\\times \\dots \\times p_k\\\\0,rest\\end{cases}$$\n   - \u6b27\u62c9\u51fd\u6570: $\\varphi(n)=n\\prod_{i=1}^k(1-\\frac 1{p_i})(n={p_1}^x\\times {p_2}^x\\times \\dots \\times {p_k}^x)$\n   - \u7ea6\u6570\u6570: $d(n)=\\sum_{d|n}1(d=1*1)$\n   - \u7ea6\u6570\u548c: $\\sigma(n)=\\sum_{d|n}d(\\sigma=1*Id)$\n     > $\\sigma_0(n)$\u8868\u793a$n$\u7684\u56e0\u6570\u4e2a\u6570\n     >\n     > $\\sigma_k(n)$\u8868\u793a\u6240\u6709\u56e0\u6570\u7684$k$\u6b21\u65b9\u548c\n   - $\\lambda(n)=(-1)^k$\n\n### \u5e38\u7528\u5377\u79ef\u5173\u7cfb\n\n1. $\\mu * 1=\\epsilon$(\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14,$\\mu$\u4e0e$1$\u4e92\u4e3a\u9006\u5143)\n   \n   \u5982\u679c$f * 1=g$,\u90a3\u4e48$f=f * \\epsilon=f * 1 * \\mu=\\mu * g$\n\n   \u8bc1\u660e(\u6458\u81ea https://www.luogu.com.cn/blog/lx-2003/mobius-inversion ):\n\n   > \u5bf9\u6b64\u53ea\u9700\u8981\u5b9a\u4e49:\n   >\n   > $$(\\mathbf f\\oplus\\mathbf g)(x)=\\sum_{x\\mid y}\\mathbf f(y/x)\\mathbf g(y)$$\n   > \n   > \u5e76\u5bb9\u6613\u8bc1\u660e:\n   >\n   > $$(\\mathbf f\\ast\\mathbf g)\\oplus\\mathbf h=\\mathbf f\\oplus(\\mathbf g\\oplus\\mathbf h)$$\n   >\n   > \u4e8e\u662f\n   > \n   > $$\\mathbf f=(\\mu\\ast\\mathbf1)\\oplus\\mathbf f=\\mu\\oplus(\\mathbf1\\oplus\\mathbf f)=\\mu\\oplus\\mathbf g$$\n2. $\\varphi * 1 = Id$\n   \n   \u6839\u636e1.\n\n   $\\varphi=\\mu*Id$\n\n   \u8bc1\u660e(\u6458\u81ea https://www.luogu.com.cn/blog/lx-2003/mobius-inversion ):\n\n   >\u8bbe$n=\\prod_{i=1}^t p_i^{k_i}$\n   >\n   >$\\sigma_0$\u548c$\\varphi$\u5728\u7d20\u6570\u5e42\u5904\u7684\u503c\u5f88\u5bb9\u6613\u5f97\u5230: $k>0$\u65f6$\\sigma_0(p^k)=k+1,\\varphi(p^k)=p^{k-1}(p-1)$\n   >\n   >\u6240\u4ee5:\n   >\n   >$$\\sigma_0(n)=\\prod_{i=1}^t(k_i+1), \\varphi(n)=\\prod_{i=1}^np_i^{k_i-1}(p_i-1)=n\\prod_{i=1}^t\\left(1-\\frac1{p_i}\\right)$$\n   >\n   > $$(\\varphi\\ast\\mathbf1)(p^k)\\\\=\\sum_{i|p^k}\\varphi(i)1(\\frac{p^k}i)\\\\=1+\\sum_{i=1}^k p^{i-1}(p-1)\\\\=1+(p-1)+p^2-p+p^3-p^2+...+p^k-p^{k-1}\\\\=p^k$$\n   >\n   > \u5e26\u5165\u6c42\u89e3\u53ef\u4ee5\u5f97\u51fa$Id=\\varphi*1$\n3. $d=1*1$\n4. $1=\\mu * d$\n\n\u5377\u79ef\u8bc1\u660e\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14: $F=f*1,f=\\mu * F$\n\n\u5f3a\u70c8\u63a8\u8350: https://www.luogu.com.cn/blog/lx-2003/mobius-inversion", "link": "/posts/\u72c4\u5229\u514b\u96f7\u5377\u79ef/", "tags": ["\u6570\u8bba", "\u5377\u79ef", "\u72c4\u5229\u514b\u96f7\u5377\u79ef"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570", "content": "\u8be5\u597d\u597d\u590d\u4e60(\u603b\u7ed3)\u4e00\u4e0b\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u4e86\u5462$\\mathcal{>_\\omega<}$\n\n## \u5b9a\u4e49\n\n$$\n\\mu (i)=\n\\begin{cases}\n1,i=1\n\\\\\n(-1)^k,i=p_1\\times p_2\\times \\dots \\times p_k\n\\\\\n0,rest\n\\end{cases}\n$$\n\n## \u6027\u8d28\n\n\u4ee5\u4e0b\u8bc1\u660e\u53ef\u4ee5\u5148\u4e86\u89e3[\u72c4\u5229\u514b\u96f7\u5377\u79ef](/posts/di-li-ke-lei-juan-ji)\n\n\u5e76\u5f3a\u70c8\u63a8\u8350\u4e86\u89e3: https://www.luogu.com.cn/blog/lx-2003/mobius-inversion\n\n1. $$\n   \\sum_{d|n}\\mu(d)=[n=1]\n   \\\\\\Downarrow\\\\\n   [gcd(a,b)=1]=\\sum_{d|\\gcd(a,b)}\\mu(d)\n   $$\n\n2. $$\\sum_{d|n}\\frac{\\mu(d)}d = \\frac{\\varphi(n)}n$$\n   \n3. $\\mu$\u662f\u79ef\u6027\u51fd\u6570,\u82e5$\\gcd(a,b)=1$,$\\mu(ab)=\\mu(a)\\cdot\\mu(b)$\n   \n4. \u53cd\u6f14:\n   $$\n   g(x)=\\sum_{x|d}f(d)\n   \\\\\\Updownarrow\\\\\n   f(x)=\\sum_{x|d}\\mu(\\frac dx) \\cdot g(d)\n   $$\n\n## \u7ebf\u6027\u7b5b\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\n\n```cpp\nint mu[N],pri[N],cnt=0;\nbool f[N];\nil void getmu(int n){\n    mu[1]=1;\n    Fur(i,2,n){\n        if(!f[i])mu[i]=-1,pri[++cnt]=i;\n        Fur(j,1,cnt){\n            if(pri[j]*i>n)break;\n            f[i*pri[j]]=1;\n            if(i%pri[j])mu[i*pri[j]]=-mu[i];\n            else break;\n        }\n    }\n}\n```\n\n## \u5b9e\u4f8b\n\n(\u9ed8\u8ba4$n<m$)\n\n### Eg1\n\n\u6c42:\n\n$$\\sum_{i=1}^n\\sum_{i=1}^m[gcd(i,j)=1]$$\n\n\u89e3:\n\n$$\n\\sum_{i=1}^{a}\\sum_{j=1}^{b}[gcd(i,j)=1]\n\\\\\n=\\sum_{i=1}^n \\sum_{j=1}^m\n\\sum_{d|\\gcd(i,j)} \\mu(d)\n\\\\\n=\\sum_{i=1}^n \\sum_{j=1}^m\n\\sum_{d|i,d|j} \\mu(d)\n\\\\\n=\\sum_{d=1}^n\\mu(d)\\left \\lfloor \\frac nd \\right \\rfloor \\left \\lfloor \\frac md\\right \\rfloor\n$$\n\n\u5c06\u590d\u6742\u5ea6\u6210\u529f\u964d\u5230\u4e86$O(\\sqrt n)$\n\n### Eg2\n\n\u6c42:\n\n$$\\sum_{i=1}^n\\sum_{i=1}^mgcd(i,j)$$\n\n\u89e3:\n\n$$\n\\sum_{i=1}^n\\sum_{j=1}^mgcd(i,j)\n\\\\\n=\\sum_{d=1}^n d\\sum_{i=1}^{n}\\sum_{j=1}^{m}[gcd(i,j)=d]\n\\\\\n=\\sum_{d=1}^n d\\sum_{i=1}^{\\left\\lfloor \\frac nd \\right \\rfloor}\\sum_{j=1}^{\\left\\lfloor \\frac md \\right \\rfloor}[gcd(i,j)=1]\n$$\n\n\u5229\u7528[Eg1](#eg1)\u7684\u7ed3\u679c\n\n$$\n=\\sum_{d=1}^n d\\sum_{i=1}^{\\left\\lfloor \\frac nd \\right \\rfloor}\\mu(i)\\left \\lfloor \\frac n{id} \\right \\rfloor \\left \\lfloor \\frac m{id}\\right \\rfloor\n$$\n\n\u8fd9\u65f6\u5019\u5206\u5757\u5957\u5206\u5757\u590d\u6742\u5ea6\u53ef\u80fd\u8fd8\u662f\u4f1atle,\u6211\u4eec\u53ef\u4ee5\u7ee7\u7eed\u4f18\u5316\n\n\u8bbe$T=id$\n\n$$\n=\\sum_{T=1}^n \\left \\lfloor \\frac nT \\right \\rfloor \\left \\lfloor \\frac mT\\right \\rfloor \\sum_{d|T} d\\mu(\\frac Td)\n$$\n\n\u6210\u529f\u964d\u5230\u4e86$O(\\sqrt n)$\n\n### Eg3\n\n\u6c42:\n\n$$\\sum_{i=1}^n\\sum_{j=1}^m f(\\gcd(i,j))$$\n\n\u89e3:\n\n$$\n\\sum_{i=1}^n\\sum_{j=1}^m f(\\gcd(i,j))\n\\\\\n=\\sum_{d=1}^n f(d) \\sum_{i=1}^n\\sum_{j=1}^m [\\gcd(i,j)=d]\n\\\\\n=\\sum_{d=1}^n f(d) \\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac md \\right \\rfloor} [\\gcd(i,j)=1]\n\\\\\n=\\sum_{d=1}^n f(d) \\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac md \\right \\rfloor} \\sum_{x|i,x|j} \\mu(x)\n\\\\\n=\\sum_{d=1}^n f(d) \\sum_{x=1}^{\\left \\lfloor \\frac nd \\right \\rfloor} \\mu(x) {\\left \\lfloor \\frac n{dx} \\right \\rfloor}{\\left \\lfloor \\frac m{dx} \\right \\rfloor}\n$$\n\n\u4ee4$T=dx$\n\n$$\n=\\sum_{T=1}^n {\\left \\lfloor \\frac nT \\right \\rfloor}{\\left \\lfloor \\frac mT \\right \\rfloor}\\sum_{d|T}f(d) \\mu(\\left \\lfloor \\frac Td \\right \\rfloor) \n$$\n\n\u6c42\u51fa\u6216\u7ef4\u62a4\u51fd\u6570$s(T)=\\sum_{d|T}f(d) \\mu(\\left \\lfloor \\frac Td \\right \\rfloor)$\u7684\u524d\u7f00\u548c,\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u6570\u8bba\u5206\u5757$O(\\sqrt n)$\u6c42\u89e3\u4e86\n\nhttps://www.luogu.com.cn/problem/P3312\n\n### Eg4\n\n\u6c42:\n\n$$\\prod_{i=1}^n \\prod_{j=1}^m f_{\\gcd(i,j)}$$\n\n\u89e3:\n\n$$\n\\prod_{i=1}^n \\prod_{j=1}^m f_{\\gcd(i,j)}\n\\\\\n=\\prod_{d=1}^n{f_d}^{\\sum_{i=1}^n \\sum_{j=1}^m[\\gcd(i,j)=d]}\n\\\\\n=\\prod_{d=1}^n{f_d}^{\\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor} \\sum_{j=1}^{\\left \\lfloor \\frac md \\right \\rfloor}[\\gcd(i,j)=1]}\n\\\\\n=\\prod_{d=1}^n{f_d}^{\\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor} \\mu(i) \\left \\lfloor \\frac n{id}\\right \\rfloor \\left \\lfloor \\frac m{id}\\right \\rfloor}\n$$\n\n\u4ee4$T=id$\n\n$$\n=\\prod_{T=1}^n\\sum_{d|T}{f_d}^{\\mu(\\frac Td) \\left \\lfloor \\frac n{T}\\right \\rfloor \\left \\lfloor \\frac m{T}\\right \\rfloor}\n$$\n\n\u6c42\u51fa\u6216\u7ef4\u62a4\u51fd\u6570$s(T)=\\sum_{d|T}f(d) \\mu(\\left \\lfloor \\frac Td \\right \\rfloor)$\u7684\u524d\u7f00\u79ef,\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u6570\u8bba\u5206\u5757$O(\\sqrt n)$\u6c42\u89e3\u4e86\n\nhttps://www.luogu.com.cn/problem/P3704\n", "link": "/posts/\u83ab\u6bd4\u4e4c\u65af\u51fd\u6570/", "tags": ["\u6570\u8bba", "\u7b97\u6cd5", "\u5bb9\u65a5", "\u53cd\u6f14", "\u83ab\u6bd4\u4e4c\u65af"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "excrt", "content": "# \u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\n\n\u7ed9\u5b9a\u65b9\u7a0b\u7ec4:\n\n$$\n\\begin{cases}\nx \\equiv a_1\\ ({\\rm mod}\\ m_1)\n\\\\\nx\\equiv a_2\\ ({\\rm mod}\\ m_2)\n\\\\\n...\n\\\\\nx \\equiv a_n\\ ({\\rm mod}\\ m_n)\n\\end{cases}\n$$\n\n\u6c42\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570$x$\n\n\u5047\u8bbe\u6211\u4eec\u6c42\u51fa\u4e86\u524d$i-1$\u7ec4\u7684\u89e3$x_{i-1}$\n\n\u8bbe$M=\\operatorname{lcm}(m_1,m_2,\\cdots,m_{i-1})$\n\n\u5219$x_{i-1}+\\lambda M \\equiv a_{i-1} \\pmod{m_{i-1}}(\\lambda \\in \\Z)$\n\n\u90a3\u4e48\u6211\u4eec\u9700\u8981\u6c42\u51fa\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570$t$\u4f7f:\n\n$x_{i-1}+tM\\equiv a_i \\pmod{m_i}$\n\n\u4e5f\u5c31\u662f$Mt\\equiv a_i-x_{i-1} \\pmod{m_i}$\n\n\u53ef\u4ee5\u4f7f\u7528Exgcd\u6c42\u89e3$t$ ($ax\\equiv c \\pmod b$)\n\n\u5982\u679c\u65e0\u89e3,\u5219\u6574\u4e2a\u65b9\u7a0b\u8bef\u89e3\n\n\u82e5\u6709\u89e3,$x_i=x_{i-1}+tM$\n\n[LG P4777 \u3010\u6a21\u677f\u3011\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\uff08EXcrt\uff09](https://www.luogu.com.cn/problem/P4777)\n\n\u4ee3\u7801:\n\n```cpp\nconst int N=100011;\nint n;ll m[N],a[N];\nll exgcd(ll a,ll b,ll &x,ll &y){\n    if(!b){x=1,y=0;return a;}\n    ll gcd=exgcd(b,a%b,x,y),t=x;\n    x=y;y=t-a/b*y;\n    return gcd;\n}\nll mul(ll x,ll b,ll p){\n    ll ans=0;\n    while(b){\n        if(b&1)ans=(ans+x)%p;\n        b>>=1;x=(x+x)%p;\n    }\n    return ans;\n}\nll excrt(){\n    ll ans=a[1],M=m[1],t,y;\n    Fur(i,2,n){\n        ll b=m[i],c=(a[i]-ans%b+b)%b,\n            gcd=exgcd(M,b,t,y);\n        if(c%gcd)return -1;\n        t=mul(t,c/gcd,b/gcd);\n        ans+=t*M;\n        M*=b/gcd;\n        ans=(ans%M+M)%M;\n    }\n    return ans;\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(m[i],a[i]);\n    printf(\"%lld\\n\",excrt());\n}\n```", "link": "/posts/excrt/", "tags": ["\u7b97\u6cd5", "\u6570\u8bba"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "Lucas", "content": "## Lucas\u5b9a\u7406\n\n$$C_n^m\\pmod p\\equiv C_{n\\mod p}^{m\\mod p} \\cdot C_{\\lfloor n/p\\rfloor}^{\\lfloor m/p\\rfloor}\\pmod p$$\n\n\u5c31\u662f\u4e00\u4e2a\u7ec4\u5408\u6570\u53ef\u4ee5\u62c6\u6210P\u8fdb\u5236\u4e0b\u7684\u4e58\u79ef\n\n\u8fd9\u4e2a\u7b97\u6cd5\u53ef\u4ee5\u5904\u7406\u5f53m,n\u975e\u5e38\u5927\u800c$p$\u8f83\u5c0f\u7684\u65f6\u5019\u7684\u53d6\u6a21\n\n```cpp\nint C(int n,int m){\n    if(n<m)return 0;\n    return 1ll*fac[n]*inv(fac[m])%p*inv(fac[n-m])%p;\n}\nint lucas(int n,int m){\n    if(n<m)return 0;\n    if(!n)return 1;\n    return 1ll*lucas(n/p,m/p)*C(n%p,m%p)%p;\n}\n```\n\n\u6269\u5c55\uff1a\u4ec5\u5f53$(n\\&m)=m$\u65f6,$C(n,m) \\equiv 1 \\bmod 2$\n\n## \u6269\u5c55lucas\n\n\u5f53\u6a21\u6570$p$\u8fc7\u5927\u6216\u8005$p$\u4e0d\u662f\u8d28\u6570\u7684\u65f6\u5019\u5c31\u4e0d\u80fd\u76f4\u63a5\u7528lucas\u4e86\n\n\u4f3c\u4e4e\u6269\u5c55lucas\u548clucas\u6ca1\u592a\u5927\u5173\u7cfb,\u4f1a`exgcd`\u548c`crt`\u5c31\u53ef\u4ee5\u4e86\n\n\u8bbe$p=p_1^{k_1}p_2^{k_2}\\dots p_n^{k_n}$\n\n\u6c42\u51fa\u6bcf\u4e2a${n\\choose m} \\equiv a_i \\pmod {p_i^{k_i}}$\n\n\u5f97\u5230\u540c\u4f59\u65b9\u7a0b\u7ec4\n\n$$\n\\begin{cases}\n{n\\choose m} \\equiv a_1 \\pmod {p_1^{k_1}}\n\\\\\n{n\\choose m} \\equiv a_2 \\pmod {p_1^{k_2}}\n\\\\\n\\vdots\n\\\\\n{n\\choose m} \\equiv a_n \\pmod {p_n^{k_n}}\n\\end{cases}\n$$\n\n\u4f7f\u7528`crt`\u5373\u53ef\u6c42\u51fa$n\\choose m$\u7684\u503c\n\n$p^t$\u4e0d\u662f\u8d28\u6570,\u90a3\u4e48\u5982\u4f55\u6c42${n\\choose m} \\mod p^t$\u5462?\n\n\u53ef\u4ee5\u8ba1\u7b97${n\\choose m}=\\frac{n!}{m!(n-m)!}$,\u5206\u522b\u8ba1\u7b97\u51fa$n!,m!,(n-m)!$\u5728\u6a21$p^t$\u610f\u4e49\u4e0b\u7684\u503c\n\n\u5047\u8bbe$p=3,t=2,n=19$,\n\n$$\nn!=1\\cdot 2\\cdot 3\\cdots 19\n\\\\\n=(1\\cdot 2\\cdot 4\\cdot 5\\cdot 7\\cdot 8\\cdot 10\\cdot 11\\cdot 13\\cdot 14\\cdot 16\\cdot 17\\cdot 19)\\cdot (3\\cdot 6\\cdot 9\\cdot 12\\cdot 15\\cdot 18)\n\\\\ \n=(1\\cdot 2\\cdot 4\\cdot 5\\cdot 7\\cdot 8\\cdot 10\\cdot 11\\cdot 13\\cdot 14\\cdot 16\\cdot 17\\cdot 19)\\cdot 3^6\\cdot(1\\cdot2\\cdot3\\cdot4\\cdot5\\cdot6)\n$$\n\n\u53ef\u4ee5\u53d1\u73b0\u540e\u9762\u7684\u90e8\u5206\u76f8\u5f53\u4e8e$\\left\\lfloor \\frac np \\right\\rfloor!$,\u9012\u5f52\u8ba1\u7b97\u5373\u53ef\n\n\u524d\u534a\u90e8\u5206\u4ee5$p^t$\u4e3a\u5468\u671f,\u5373\n\n$1\\cdot 2\\cdot 4\\cdot 5\\cdot 7\\cdot 8 \\equiv 10\\cdot 11\\cdot 13\\cdot 14\\cdot 16\\cdot 17 \\pmod {3^2}$\n\n\u53ea\u9700\u8981\u8ba1\u7b97\u4e0d\u6ee1\u8db3\u5468\u671f\u7684\u6570$19$\u5c31\u53ef\u4ee5\u4e86", "link": "/posts/lucas/", "tags": ["\u6570\u8bba", "\u7ec4\u5408\u6570", "\u7b97\u6cd5", "\u4e8c\u8fdb\u5236"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "\u542f\u53d1\u5f0f\u5408\u5e76", "content": "\u603b\u7ed3\u4e00\u4e0b\u5404\u79cd\u542f\u53d1\u5f0f\u5408\u5e76\n\n## \u4ec0\u4e48\u662f\u542f\u53d1\u5f0f\u5408\u5e76\n\n\u53ef\u4ee5\u7b97\u662f\u4e00\u79cd\u6280\u5de7\n\n\u6bd4\u5982\u8981\u5408\u5e76\u96c6\u5408$A,B$,\u8bbe$|A|<|B|$\n\n\u8fd9\u65f6\u5019\u5c06 \u5411$B$\u4e2d\u63d2\u5165$A$ \u7684\u6548\u7387\u8981\u6bd4 \u5411$A$\u63d2\u5165$B$ \u9ad8\n\n\u8fd9\u5c31\u662f\u542f\u53d1\u5f0f\u5408\u5e76\u7684\u601d\u60f3\n\n> Q: \u5f88\u7b80\u5355,\u4f46\u6709\u4ec0\u4e48\u7528?\n> \n> A: \u5047\u8bbe\u6211\u4eec\u8981\u5408\u5e76$n$\u4e2a\u5143\u7d20\n> \n> \u6309\u666e\u901a\u65b9\u6cd5,\u6700\u574f\u7684\u590d\u6742\u5ea6$\\Theta(n^2)$\n> \n> \u5047\u8bbe\u6211\u4eec\u6309\u7167\u542f\u53d1\u5f0f\u5408\u5e76,\u53ef\u4ee5\u8bc1\u660e\u6bcf\u4e2a\u5143\u7d20\u6700\u591a\u88ab\u5408\u5e76$\\log n$\u6b21\n> \n> \u8fd9\u6837\u4ee5\u6765\u603b\u590d\u6742\u5ea6\u4e0d\u4f1a\u8d85\u8fc7$n \\log n$\n> \n> \u662f\u4e0d\u662f\u5f88\u7384\u5b66\u53c8\u795e\u5947?\n\n\u542f\u53d1\u5f0f\u5408\u5e76\u8fd8\u53ef\u4ee5\u53ef\u4ee5\u5e94\u7528\u5728\u6570\u636e\u7ed3\u6784\u4e0a(\u5982\u7ebf\u6bb5\u6811,\u5e73\u8861\u6811,\u5806\u7b49),\u590d\u6742\u5ea6$O(n \\log^2 n)$\n\n## \u94fe\u8868\u7684\u542f\u53d1\u5f0f\u5408\u5e76\n\n[LG 3201 \\[HNOI2009\\]\u68a6\u5e7b\u5e03\u4e01](https://www.luogu.com.cn/problem/P3201)\n\n\u5176\u5b9e\u53ef\u4ee5\u8bf4\u662f\u524d\u5411\u661f\n\n\u6bcf\u6b21\u90fd\u628a\u77ed\u7684\u94fe\u8868\u63a5\u5230\u957f\u7684\u94fe\u8868\u4e0a\n\n\u7edf\u8ba1\u77ed\u7684\u94fe\u8868\u4e0a\u6bcf\u4e2a\u5143\u7d20\u6539\u53d8\u540e\u9020\u6210\u7684\u5f71\u54cd\n\n```cpp\nconst int N=1000011;\nint n,q,a[N],ans=0,st[N],bl[N],head[N],nxt[N],sz[N];\nil void mg(int x,int y){\n    for(int i=head[x];i;i=nxt[i])ans-=(a[i-1]==y)+(a[i+1]==y);\n    for(int i=head[x];i;i=nxt[i])a[i]=y;\n    sz[y]+=sz[x];nxt[st[x]]=head[y];head[y]=head[x];\n    head[x]=st[x]=sz[x]=0;\n}\nint main(){\n    in(n,q);\n    Fur(i,1,n){\n        in(a[i]);\n        if(a[i]!=a[i-1])++ans;\n        bl[a[i]]=a[i];\n        if(!st[a[i]])st[a[i]]=i;\n        ++sz[a[i]];nxt[i]=head[a[i]];head[a[i]]=i;\n    }\n    while(q--){\n        int opt,x,y;\n        in(opt);\n        if(opt==2)out(ans,ln);\n        else{\n            in(x,y);\n            if(x!=y){\n                if(sz[bl[x]]>sz[bl[y]])SWAP(bl[x],bl[y]);\n                if(sz[bl[x]])mg(bl[x],bl[y]);\n            }\n        }\n    }\n}\n```\n\n## \u5806\u7684\u542f\u53d1\u5f0f\u5408\u5e76\n\n[LG 5290 \\[\u5341\u4e8c\u7701\u8054\u80032019\\]\u6625\u8282\u5341\u4e8c\u54cd](https://www.luogu.com.cn/problem/P5290)\n\n\u9898\u76ee\u7684\u610f\u601d\u5c31\u662f\u76f8\u540c\u5b50\u6811\u4e2d\u7684\u70b9\u4e0d\u80fd\u5206\u914d\u5230\u540c\u4e00\u6bb5\u5185\u5b58\n\n\u6bcf\u4e2a\u70b9\u90fd\u5f00\u4e00\u4e2a\u5927\u6839\u5806\n\n\u5408\u5e76\u4e00\u4e2a\u70b9\u548c\u5b83\u7684\u5b50\u8282\u70b9\u7684\u65f6\u5019\u6700\u5927\u503c\u4e92\u76f8\u5bf9\u5e94\n\n\u542f\u53d1\u5f0f\u5408\u5e76\n\n\u5177\u4f53\u770b\u4ee3\u7801\n\n```cpp\nconst int N=200011;\nint n,cnt=0,head[N],a[N],id[N],dfn=0,tmp[N],tp=0;\nstruct edge{int to,nxt;}e[N];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nstd::priority_queue<int>q[N];\nil int max(int x,int y){return x>y?x:y;}\nil void swap(int &x,int &y){int t=x;x=y;y=t;}\nvoid dfs(int x){\n    id[x]=++dfn;\n    fl(i,x){\n        dfs(to);\n        if(q[id[x]].size()<q[id[to]].size())swap(id[x],id[to]);\n        int t=q[id[to]].size();tp=0;\n        while(t--)\n            tmp[++tp]=max(q[id[x]].top(),q[id[to]].top()),\n            q[id[x]].pop(),q[id[to]].pop();\n        while(tp)q[id[x]].push(tmp[tp--]);\n    }\n    q[id[x]].push(a[x]);\n}\nint main(){\n    in(n);\n    int x;\n    Fur(i,1,n)in(a[i]);\n    Fur(i,2,n)in(x),add(x,i);\n    dfs(1);\n    ll ans=0;\n    while(!q[id[1]].empty())\n        ans+=q[id[1]].top(),\n        q[id[1]].pop();\n    printf(\"%lld\\n\",ans);\n}\n```\n\n## Trie\u7684\u542f\u53d1\u5f0f\u5408\u5e76\n\n[CF 788 C](https://www.luogu.com.cn/problem/CF778C)\n\n\u9898\u610f: \n\n\u7ed9\u4e00\u68f5trie\u6811,\u53ef\u4ee5\u5220\u6389\u67d0\u4e00\u5c42\u7684\u6240\u6709\u8fb9\n\n\u6c42\u5220\u6389\u54ea\u4e00\u5c42\u8fb9\u540e\u5408\u5e76\u51fa\u7684trie\u6811\u6700\u5c0f\uff1f\n\n\u89e3\u6cd5: \n\ntrie\u7684\u542f\u53d1\u5f0f\u5408\u5e76\n\n```cpp\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    int now=++cnt;\n    Fur(i,0,25)c[now][i]=mg(c[x][i],c[y][i]);\n    return now;\n}\n```\n\n\u8fd9\u4e2a\u5408\u5e76\u7684\u590d\u6742\u5ea6\u662f$\\Theta(\\log n)$\u7684\n\n\u8bc1\u660e:\n\n> \u6bcf\u6b21\u5408\u5e76\u5411\u4e0b\u9012\u5f52\u7684\u65f6\u5019\u89c4\u6a21$n$\u4f1a\u53d8\u6210\u539f\u6765\u7684\u4e00\u534a$\\frac n2$\n> \n> \u6240\u4ee5\u6700\u591a\u9700\u8981\u5408\u5e76$\\log_2 n$\u6b21\n\n\u4ee3\u7801: \n\n```cpp\nconst int N=600011;\nint n,cnt,c[N][26],a[N];\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    int now=++cnt;\n    Fur(i,0,25)c[now][i]=mg(c[x][i],c[y][i]);\n    return now;\n}\nvoid dfs(int x,int d){\n    int now=n+1;cnt=n+1;\n    Fur(i,0,25)if(c[x][i])\n        now=mg(now,c[x][i]);\n    a[d]+=cnt-n-1;\n    Fur(i,0,25)if(c[x][i])\n        dfs(c[x][i],d+1);\n}\nint main(){\n    in(n);\n    int x,y,ans=0,as=0;char w;\n    Fur(i,2,n)in(x,y,w),c[x][w-'a']=y;\n    dfs(1,1);\n    Fur(i,1,n)if(a[i]>ans)as=i,ans=a[i];\n    printf(\"%d\\n%d\\n\",n-ans,as);\n}\n```\n\n## \u6570\u636e\u7ed3\u6784+\u542f\u53d1\u5f0f\u5408\u5e76\n\n[LG 3302 \\[SDOI2013\\]\u68ee\u6797](https://www.luogu.com.cn/problem/P3302)\n\n\u770b\u9898\u610f\u60f3\u5230\u4e86\u4e3b\u5e2d\u6811\u548cLCT\n\nLCT\u5957\u4e3b\u5e2d\u6811\u53ef\u884c,\u4f46\u662f\u6bd4\u8f83\u9ebb\u70e6,\u6211\u4eec\u7528\u53e6\u4e00\u79cd\u65b9\u6cd5\n\n\u542f\u53d1\u5f0f\u5408\u5e76+\u4e3b\u5e2d\u6811($\\mathcal{n \\log^2 n}$)\n\n\u6bcf\u6b21\u5c06\u5c0f\u7684\u63d2\u5165\u5230\u5927\u7684,\u987a\u4fbf\u66f4\u65b0\u500d\u589eLCA\n\n\u6bcf\u4e2a\u8282\u70b9\u5728\u7236\u8282\u70b9\u7684\u57fa\u7840\u4e0a\u63d2\u5165\u81ea\u8eab\u7684\u503c\n\n\u5373\u6bcf\u4e2a\u8282\u70b9\u7684\u4e3b\u5e2d\u6811\u8bb0\u5f55\u7684\u662f\u81ea\u8eab\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\n\n\u5177\u4f53\u770b\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define Fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\nil void SWAP(int &x,int &y){int t=x;x=y;y=t;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=80011;\nstruct node{int v,p;bool operator<(node t){return v<t.v;}}b[N];\nint val[N],rnk[N];\nint cnt=0,head[N];\nint d[N],fa[N],f[17][N],siz[N];\nint SZ=0,sz=0,RT[N],ls[N*600],rs[N*600],s[N*600];\nbool v[N];\nstruct edge{int to,nxt;}e[N<<2];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint gf(int x){return (fa[x]==x)?x:(fa[x]=gf(fa[x]));}\nvoid build(int &x,int l,int r){\n    s[x=++sz]=0;\n    if(l==r)return;\n    int m=(l+r)>>1;\n    build(ls[x],l,m);build(rs[x],m+1,r);\n}\nvoid ins(int &x,int pre,int l,int r,int v){\n    s[x=++sz]=s[pre]+1;\n    ls[x]=ls[pre];rs[x]=rs[pre];\n    if(l==r)return;\n    int m=(l+r)>>1;\n    if(v<=m)ins(ls[x],ls[pre],l,m,v);\n    else ins(rs[x],rs[pre],m+1,r,v);\n}\nint ask(int x,int y,int lca,int flca,int l,int r,int k){\n    if(l==r)return val[l];\n    int m=(l+r)>>1,sum=s[ls[x]]+s[ls[y]]-s[ls[lca]]-s[ls[flca]];\n    if(k<=sum)return ask(ls[x],ls[y],ls[lca],ls[flca],l,m,k);\n    else return ask(rs[x],rs[y],rs[lca],rs[flca],m+1,r,k-sum);\n}\nvoid dfs(int x,int F,int rt){\n    ++siz[rt];\n    d[x]=d[f[0][x]=fa[x]=F]+1;\n    Fur(i,1,16)f[i][x]=f[i-1][f[i-1][x]];\n    v[x]=1;\n    ins(RT[x],RT[F],1,SZ,rnk[x]);\n    fl(i,x)if(to!=F)dfs(to,x,rt);\n}\nil int lca(int x,int y){\n    if(d[x]<d[y])SWAP(x,y);\n    Fdr(i,16,0)if(d[f[i][x]]>=d[y])x=f[i][x];\n    if(x==y)return x;\n    Fdr(i,16,0)if(f[i][x]!=f[i][y])\n        x=f[i][x],y=f[i][y];\n    return f[0][x];\n}\nint main(){\n    int n,m,q,lastans=0;\n    in(n);\n    in(n,m,q);\n    Fur(i,1,n)in(b[i].v),b[i].p=i,fa[i]=i;\n    std::sort(b+1,b+n+1);b[0].v=-(1<<30);\n    Fur(i,1,n)val[rnk[b[i].p]=(SZ+=(b[i].v!=b[i-1].v))]=b[i].v;\n    int x,y,k,t;char ch;\n    Fur(i,1,m)in(x,y),add(x,y),add(y,x);\n    build(RT[0],1,SZ);\n    Fur(i,1,n)if(!v[i])dfs(i,0,i),fa[i]=i;\n    while(q--){\n        in(ch,x,y);\n        x^=lastans;y^=lastans;\n        if(ch=='Q'){\n            in(k);k^=lastans;t=lca(x,y);\n            out(lastans=ask(RT[x],RT[y],RT[t],RT[f[0][t]],1,SZ,k),ln);\n        }\n        else{\n            add(x,y),add(y,x);\n            if(siz[gf(x)]>siz[gf(y)])SWAP(x,y);\n            dfs(x,y,gf(y));\n        }\n    }\n    flush();\n}\n```\n\n## \u7ebf\u6bb5\u6811\u5408\u5e76\n\n```cpp\nint mg(int x,int y,int l=1,int r=100000){\n    if(!x||!y)return x|y;\n    if(l==r)return s[x]+=s[y],S[x]=l,x;//\u5408\u5e76\u4e24\u4e2a\u8282\u70b9\u7684\u4fe1\u606f\n    int m=(l+r)>>1;\n    ls[x]=mg(ls[x],ls[y],l,m); \n    rs[x]=mg(rs[x],rs[y],m+1,r);\n    pushup(x);return x;\n}\n```\n\n\u4f8b\u9898: \n\n[LG 4556 \\[Vani\u6709\u7ea6\u4f1a\\]\u96e8\u5929\u7684\u5c3e\u5df4 /\u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811\u5408\u5e76](https://www.luogu.com.cn/problem/P4556)\n\n\u6811\u4e0a\u5dee\u5206,\u7edf\u8ba1\u7684\u65f6\u5019\u6bcf\u4e2a\u8282\u70b9\u90fd\u5408\u5e76\u81ea\u8eab\u5b50\u8282\u70b9\u7684\u7ed3\u679c\n\n\u6bcf\u4e2a\u70b9\u90fd\u7ef4\u62a4\u4e00\u9897\u52a8\u6001\u5f00\u70b9\u6743\u503c\u7ebf\u6bb5\u6811\n\n\u5728$x\\leftrightarrow y$\u533a\u95f4\u52a0\u53ef\u4ee5\u770b\u6210$x,y$\u7684$w$\u4f4d\u7f6e$+1$,$lca(x,y),f_{lca(x,y)}$\u7684$w$\u4f4d\u7f6e$-1$\n\n\u7edf\u8ba1\u7684\u65f6\u5019\u4e0d\u65ad\u5411\u4e0a\u7ebf\u6bb5\u6811\u5408\u5e76\n\n\u5177\u4f53\u770b\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\nconst int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}\nconst int N=100011;\nint n,q,cnt=0,sz=0,head[N],s[N*60],S[N*60],ls[N*60],rs[N*60],RT[N],ans[N];\nil void pu(int rt){s[ls[rt]]>=s[rs[rt]]?(s[rt]=s[ls[rt]],S[rt]=S[ls[rt]]):(s[rt]=s[rs[rt]],S[rt]=S[rs[rt]]);}\nvoid upd(int &rt,int x,int v,int l=1,int r=100000){\n    if(!rt)rt=++sz;\n    if(l==r){s[rt]+=v;S[rt]=l;return;}\n    int m=(l+r)>>1;\n    if(x<=m)upd(ls[rt],x,v,l,m);\n    else upd(rs[rt],x,v,m+1,r);\n    pu(rt);\n}\nint mg(int x,int y,int l=1,int r=100000){\n    if(!x||!y)return x|y;\n    if(l==r)return s[x]+=s[y],S[x]=l,x;\n    int m=(l+r)>>1;\n    ls[x]=mg(ls[x],ls[y],l,m); \n    rs[x]=mg(rs[x],rs[y],m+1,r);\n    pu(x);return x;\n}\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint d[N],top[N],siz[N],f[N];\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(k)bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nil int lca(int x,int y){\n    while(top[x]!=top[y])\n        d[top[x]]>d[top[y]]?x=f[top[x]]:y=f[top[y]];\n    return d[x]<d[y]?x:y;\n}\nvoid solve(int x){\n    fl(i,x)if(to!=f[x])\n        solve(to),\n        RT[x]=mg(RT[x],RT[to]);\n    if(s[RT[x]])ans[x]=S[RT[x]];\n}\nint main(){\n    in(n,q);\n    int x,y,w;\n    Fur(i,2,n)in(x,y),add(x,y),add(y,x);\n    dfs(1);bt(1,1);\n    while(q--){\n        in(x,y,w);\n        int t=lca(x,y);\n        upd(RT[x],w,1);upd(RT[y],w,1);\n        upd(RT[t],w,-1);upd(RT[f[t]],w,-1);\n    }\n    solve(1);\n    Fur(i,1,n)out(ans[i]),pt('\\n');\n    flush();\n}\n```\n\n[LG 3521 \\[POI2011\\]ROT-Tree Rotations](https://www.luogu.com.cn/problem/P3521)\n\n\u7ed9\u4e00\u68f5$n(1 \\le n \\le 200000)$\u4e2a\u53f6\u5b50\u7684\u4e8c\u53c9\u6811,\u53ef\u4ee5\u4ea4\u6362\u6bcf\u4e2a\u70b9\u7684\u5de6\u53f3\u5b50\u6811,\u8981\u6c42\u524d\u5e8f\u904d\u5386\u53f6\u5b50\u7684\u9006\u5e8f\u5bf9\u6700\u5c11", "link": "/posts/\u542f\u53d1\u5f0f\u5408\u5e76/", "tags": ["\u6570\u636e\u7ed3\u6784", "\u6280\u5de7", "\u7b97\u6cd5"], "categories": [["\u7b97\u6cd5", "\u6811\u8bba"], ["\u7b97\u6cd5", "\u6570\u636e\u7ed3\u6784"], ["\u7b97\u6cd5", "\u6280\u5de7"], ["note"]]}, {"title": "\u591a\u91cd\u80cc\u5305\u7684\u4f18\u5316", "content": "## 01\u80cc\u5305\n\n\u6bcf\u4e2a\u7269\u54c1\u53ea\u80fd\u4f7f\u7528\u4e00\u6b21\n\n## \u666e\u901a\u591a\u91cd\u80cc\u5305\n\n\u5c06\u53ef\u4ee5\u7528\u591a\u6b21\u7684\u7269\u54c1\u62c6\u4e3a\u591a\u4e2a\u5355\u6b21\u4f7f\u7528\u7684\u7269\u54c1\n\n\u8f6c\u5316\u4e3a01\u80cc\u5305\n\n## \u4e8c\u8fdb\u5236\u4f18\u5316\u591a\u91cd\u80cc\u5305\n\n\u4f46\u6bcf\u4e2a\u7269\u54c1\u53ef\u4ee5\u7528\u7684\u6b21\u6570\u7279\u522b\u5927\u7684\u65f6\u5019,\u5982\u679c\u8fd8\u662f\u76f4\u63a5\u62c6\u5f88\u6709\u53ef\u80fd\u4f1atle\n\n[LG 1776 \u5b9d\u7269\u7b5b\u9009](https://www.luogu.com.cn/problem/P1776)\n\n\u8fd9\u65f6\u5019\u53ef\u4ee5\u4f7f\u7528\u4e8c\u8fdb\u5236\u4f18\u5316,\n\n\u539f\u7406\u5176\u5b9e\u633a\u7b80\u5355\u7684: \n\n\u6bd4\u5982$7$\u53ef\u4ee5\u62c6\u6210$1,2,4$,\u7528$1,2,4$\u53ef\u4ee5\u51d1\u51fa$1-7$\u4e2d\u7684\u4efb\u610f\u4e00\u4e2a\u6570\n\n\u6839\u636e\u8fd9\u4e2a\u539f\u7406,\u53ef\u4ee5\u628a\u7269\u54c1\u62c6\u6210$\\log_2 \\text{\u6b21\u6570}$\u4e2a\u7269\u54c1(\u4ef7\u503c\u548c\u7a7a\u95f4\u4e5f\u8ddf\u7740\u7ffb\u500d),\u964d\u4f4e\u65f6\u95f4\u590d\u6742\u5ea6\n\n\u4ee3\u7801\u5982\u4e0b:\n\n```cpp\nint n,W,tot=0,f[N];\nstruct node{int v,w;}a[N];\nint main(){\n    in(n,W);\n    int v,w,m;\n    for(int i=1;i<=n;++i){\n        in(v,w,m);\n        for(int t=1;t<=m;t<<=1)\n            a[++tot]=node{v*t,w*t},\n            m-=t;\n        if(m)a[++tot]=node{v*m,w*m};\n    }\n    Fur(i,1,tot)\n    for(int i=1;i<=tot;++i)\n        for(int j=W;j>=a[i].w;--j)\n            f[j]=max(f[j],f[j-a[i].w]+a[i].v);\n    printf(\"%d\\n\",f[W]);\n}\n```\n\n## \u5355\u8c03\u961f\u5217\u4f18\u5316\u591a\u91cd\u80cc\u5305\n\n\u8fd8\u662f\u8fd9\u9898[LG 1776 \u5b9d\u7269\u7b5b\u9009](https://www.luogu.com.cn/problem/P1776)\n\n\u666e\u901a\u8f6c\u79fb\u65b9\u7a0b: \n\n$$f(i,j)=max_{k\\le m_i}\\{f(i-1,j\u2212kw)+kv\\}$$\n\n\u6211\u4eec\u8981\u5c06\u8fd9\u4e2a\u65b9\u7a0b\u8f6c\u5316\u4e3a\u53ef\u4ee5\u5355\u8c03\u961f\u5217\u4f18\u5316\u7684\u5f62\u5f0f:\n\n\u8bbe$d=j \\mod w_i,s=\\left \\lfloor \\frac j{w_i}\\right \\rfloor$,\u90a3\u4e48\n\n$$f(i,j)=max_{s-k\\le m_i}\\{f(i-1,d+kw)-kv\\}+vs$$\n\n\u679a\u4e3e$d$,\u5bf9\u4e8e\u6bcf\u4e2a$d$\u90fd\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316\u5373\u53ef\n\n\u4ee3\u7801\u5982\u4e0b: \n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nint n,V,ans,head,tail,q[40010],q2[40010],dp[40010];\nint main(){\n    scanf(\"%d%d\",&n,&V);\n    for(int i=1;i<=n;i++){\n        int v,w,c;\n        scanf(\"%d%d%d\",&w,&v,&c);\n        if(v==0){ans+=w*c;continue;}\n        int k=V/v;\n        c=min(c,k);\n        for(int d=0;d<v;d++){\n            head=tail=0;\n            k=(V-d)/v;\n            for(int j=0;j<=k;j++){\n                while(head<tail&&dp[d+j*v]-j*w>=q2[tail-1])tail--;\n                q[tail]=j;\n                q2[tail++]=dp[d+j*v]-j*w;\n                while(head<tail&&q[head]<j-c)++head;\n                dp[d+j*v]=max(dp[d+j*v],q2[head]+j*w);\n            }\n        }\n    }\n    printf(\"%d\",ans+dp[V]);\n}\n```", "link": "/posts/\u591a\u91cd\u80cc\u5305\u7684\u4f18\u5316/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u6280\u5de7"], "categories": [["\u7b97\u6cd5", "\u52a8\u6001\u89c4\u5212"], ["note"]]}, {"title": "\u5feb\u901f\u6570\u8bba\u53d8\u6362 ntt", "content": "NTT\u57fa\u672c\u4e0a\u8ddfFFT\u4e00\u6837,\u5c31\u662f\u628a\u5355\u4f4d\u6839\u6362\u6210\u4e86\u539f\u6839(\u539f\u6839\u548c\u5355\u4f4d\u6839\u4e00\u6837\u5177\u6709FFT\u9700\u8981\u7684\u7279\u6b8a\u6027\u8d28)\n\n\u524d\u7f6e\u77e5\u8bc6: \n\n1. [FFT](/posts/fft)\n   \n2. [\u539f\u6839](/posts/\u539f\u6839)\n\n## \u539f\u6839\u7684\u6027\u8d28\n\n\u8bbe$p$\u662f\u8d28\u6570,$g$\u4e3a\u6a21$p$\u7684\u539f\u6839,$n|(p-1)$,$g_n=g^{(p-1)/n}$\n\n> \u5355\u4f4d\u6839:\n> \n> $\\omega_n^n=1,\\omega_n^{n/2}=-1$\n\n\u539f\u6839:\n\n$g_n^n=g^{p-1}\\equiv 1\\mod p$\n\n$g_n^{n/2}=g^{(p-1)/2}$\n\n\u5176\u4e2d$\\left(g^{(p-1)/2}\\right)^2=1,g_n^{n/2}=\\pm1$\n\n\u7531\u4e8e$g$\u662f\u539f\u6839,\u6240\u4ee5$g^{p-1}\\neq g^{(p-1)/2}$,\u6240\u4ee5$g_n^{n/2}=-1$\n\n> \u5355\u4f4d\u6839\uff1a$w_{dn}^{dk}=w_n^k$\n\n\u539f\u6839:\n\n$g_{dn}^{dk}=g^{dk(p-1)/(dn)}=g^{k(p-1)/n}=g_n^k$\n\n> \u5355\u4f4d\u6839: $({w_n^k})^2=w_{n/2}^k$\n\n\u539f\u6839: \n\n$(g_n^k)^2=g_n^{2k}=g_{n/2}^k$\n\n$(g_n^{k+n/2})^2=g_n^{2k+n}\\equiv g_n^{2k}=g_{n/2}^k$\n\nFFT\u9700\u8981\u5355\u4f4d\u590d\u6570\u6839\u8be5\u6709\u7684\u6027\u8d28\u539f\u6839\u90fd\u6709\n\n## \u5b9e\u73b0\n\n\u548cFFT\u57fa\u672c\u4e0a\u4e00\u6837\n\n```cpp\n#pragma GCC optimize(3)\n#include<bits/stdc++.h>\n#define For(i,x,y) for(int i=x;i<=y;++i)\n#define il __inline__ __attribute__ ((always_inline))\nil int gi(){char c;int x=0,f=0;while((c=getchar())<'0'||'9'<c)f^=(c=='-');while('0'<=c&&c<='9')x*=10,x+=c-48,c=getchar();return f?-x:x;}\nconst int N=3000011,P=998244353,G=3,Gi=332748118;\nint n,m,limit=1,l=0,r[N],a[N],b[N];\nil int pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%P;\n        x=1ll*x*x%P;p>>=1;\n    }\n    return ans;\n}\nil void ntt(int *A,int typ){\n    For(i,0,limit-1)\n        if(i<r[i])std::swap(A[i],A[r[i]]);\n    for(int len=1;len<limit;len<<=1){\n        int Wn=pw(~typ?G:Gi,(P-1)/(len<<1));\n        //Gi\u63071/G\u5728\u6a21P\u4e0b\u7684\u9006\u5143,\u76f8\u5f53\u4e8epw(G,P-2)\n        for(int i=0;i<limit;i+=(len<<1)){\n            int w=1;\n            For(k,0,len-1){//\u8774\u8776\u64cd\u4f5c\n                int t=1ll*w*A[i+k+len]%P;\n                A[i+k+len]=(A[i+k]-t+P)%P;\n                A[i+k]=(A[i+k]+t)%P;\n                w=1ll*w*Wn%P;\n            }\n        }\n    }\n}\nint main(){\n    n=gi(),m=gi();\n    For(i,0,n)a[i]=(gi()+P)%P;\n    For(i,0,m)b[i]=(gi()+P)%P;\n    while(limit<=n+m)limit<<=1,++l;\n    For(i,0,limit-1)\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    ntt(a,1);ntt(b,1);\n    For(i,0,limit)a[i]=1ll*a[i]*b[i]%P;\n    ntt(a,-1);\n    int inv=pw(limit,P-2);//limit\u5728\u6a21P\u4e0b\u7684\u9006\u5143\n    For(i,0,n+m)printf(\"%d \",1ll*a[i]*inv%P);\n}\n```\n\n## \u5e38\u7528\u6a21\u6570\u4e0e\u539f\u6839\n\n|\u6a21\u6570|\u539f\u6839|\u5907\u6ce8\n|-|-|-|\n|$998244353$|$3$|$2^{23}\\times 7\\times 17+1$|\n|$469762049$|$3$|$7\\times 2^{26}+1$|\n|$1004535809$|$3$|$479\\times 2^{21}+1$|", "link": "/posts/ntt/", "tags": ["\u6570\u8bba", "\u9ad8\u7cbe\u5ea6", "\u7b97\u6cd5", "ntt"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362 FFT", "content": "## FFT\n\n~~fst fst tle~~\n\n> DFT: \u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\n>\n> IDFT: \u79bb\u6563\u5085\u91cc\u53f6\u9006\u53d8\u6362\n>\n> FFT: \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\n>\n> FNTT/NTT: \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u7684\u4f18\u5316\u7248\n>\n> FWT: \u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362,\u5229\u7528\u7c7b\u4f3cFFT\u7684\u4e1c\u897f\u89e3\u51b3\u4e00\u7c7b\u5377\u79ef\u95ee\u9898\n>\n> MTT: \u6bdb\u7237\u7237\u7684FFT,\u975e\u5e38nb/\u4efb\u610f\u6a21\u6570\n>\n> FMT: \u5feb\u901f\u83ab\u6bd4\u4e4c\u65af\u53d8\u5316\n>\n> (\u6458\u81eahttps://www.cnblogs.com/zwfymqz/p/8244902.html)\n\n\u4e3a\u4ec0\u4e48\u8981\u7528\u5230FFT\u5462?\n\n\u4ee5\u9ad8\u7cbe\u5ea6\u4e58\u6cd5\u4e3e\u4e2a\u4f8b\u5b50:\n\n\u4f60\u73b0\u5728\u8981\u8ba1\u7b97$a\\times b,a,b>10^{1000000}$\n\n\u8bbe$len_a=n,len_b=m$\n\n\u5982\u679c\u7528\u666e\u901a\u7684\u9ad8\u7cbe\u5ea6\u4e58\u6cd5$\\mathcal{O(nm)}$,\u76f4\u63a5tle\n\n\u4f46\u662fFFT\u53ef\u4ee5\u505a\u5230$\\mathcal{O((n+m) \\log (n+m))}$\n\n\u539f\u7406: \u5148\u628a\u591a\u9879\u5f0f\u8f6c\u5316\u4e3a\u7528\u70b9\u503c\u8868\u793a$\\mathcal{O(n \\log n)}$\n\n\u7136\u540e\u518d\u7528\u70b9\u503c\u76f8\u4e58\u6765\u8ba1\u7b97$\\mathcal{O(n)}$\n\n\u7136\u540e\u518d\u901a\u8fc7\u70b9\u503c\u8fd8\u539f\u591a\u9879\u5f0f\n\n<!-- more -->\n\n\n\u4e0b\u9762\u662f\u524d\u7f6e\u77e5\u8bc6:\n\n## \u591a\u9879\u5f0f\n\n### \u7cfb\u6570\u8868\u793a\u6cd5\n\n\u5f62\u5f0f: $f(x)=\\sum_{i=0}^{n-1} a_ix^i$\n\n\u6bd4\u5982$123456$\u4e5f\u53ef\u4ee5\u770b\u505a\u4e00\u4e2a\u591a\u9879\u5f0f:\n\n$f(10)=6+5\\cdot10+4\\cdot10^2+3\\cdot10^3+2\\cdot 10^4+1\\cdot 10^5$\n\n### \u70b9\u503c\u8868\u793a\u6cd5\n\n\u53d6$n$\u4e2a\u70b9$x_1,x_2, \\dots ,x_n$\n\n\u4ee3\u5165$f(x)$\u4f1a\u5f97\u5230$n$\u4e2a\u4e0d\u540c\u7684$y_i$\n\n$f(x)$\u88ab$(x_1,y_1),(x_2,y_2),\\dots (x_n,y_n)$\u552f\u4e00\u786e\u5b9a\n\n\u5b9a\u7406:\n\n> \u4e00\u4e2a$n-1$\u6b21\u591a\u9879\u5f0f\u5728$n$\u4e2a\u4e0d\u540c\u70b9\u7684\u53d6\u503c\u552f\u4e00\u786e\u5b9a\u4e86\u8be5\u591a\u9879\u5f0f\u3002\n\n\u8bc1\u660e: (\u53cd\u8bc1\u6cd5)\n\n> \u5047\u8bbe\u547d\u9898\u4e0d\u6210\u7acb,\u90a3\u4e48\u5b58\u5728\u4e24\u4e2a\u4e0d\u540c\u7684$n-1$\u6b21\u591a\u9879\u5f0f$A(x),B(x)$\u6ee1\u8db3: $\\forall i\\in[1,n], A(x_i)=B(x_i)$\n>\n> \u4ee4$C(x)=A(x)-B(x)$,\u90a3\u4e48$C(x)$\u4e5f\u662f\u4e00\u4e2a$n-1$\u6b21\u591a\u9879\u5f0f,\u4e14$\\forall i\\in[1,n], C(x_i)=0$\n>\n> \u8fd9\u6837\u7684\u8bdd$C(x)$\u6709$n$\u4e2a\u6839,\u4e0e\u4ee3\u6570\u57fa\u672c\u5b9a\u7406($n$\u6b21\u591a\u9879\u5f0f\u6709\u4e14\u4ec5\u6709$n$\u4e2a\u6839)\u4e0d\u7b26,\u6240\u4ee5$C(x)$\u4e0d\u662f$n-1$\u6b21\u591a\u9879\u5f0f\n>\n> \u6240\u4ee5\u539f\u547d\u9898\u6210\u7acb\n>\n> (\u6458\u81eahttps://zhuanlan.zhihu.com/p/31584464)\n\n## \u590d\u6570\n\n\u590d\u6570\u7531\u5b9e\u90e8(real)\u548c\u865a\u90e8(image)\u7ec4\u6210,\u5f62\u5982$a+bi$\n\n$i$\u662f\u865a\u6811\u5355\u4f4d,$i^2=-1,i=\\sqrt{-1}$\n\n### \u590d\u6570\u8fd0\u7b97\u6cd5\u5219:\n\n$(a+bi)+(c+di)=(a+c)+(b+d)i$\n\n$(a+bi)-(c+di)=(a-c)+(b-d)i$\n\n$(a+bi)\\cdot(c+di)=(ac-bd)+(ad+bc)i$\n\n\u590d\u6570$z=a+bi$\u5728\u590d\u5e73\u9762\u4e2d\u5bf9\u5e94\u5750\u6807\u4e3a$(a,b)$\n\n\u590d\u5e73\u9762\u4e2d$x$\u8f74\u53c8\u79f0\u5b9e\u8f74,$y$\u8f74\u53c8\u79f0\u865a\u8f74\n\n### \u5171\u8f6d\u590d\u6570\n\n\u590d\u6570$z=a+bi$\u7684\u5171\u8f6d\u590d\u6570$z'=a-bi$,$z'$\u79f0\u4e3a$z$\u7684\u590d\u5171\u8f6d\n\n\u6027\u8d28:\n\n$z\\cdot z' = a^2 + b^2$\n\n$|z|=|z'|$(\u6a21\u957f\u76f8\u7b49,\u5230\u539f\u70b9\u7684\u8ddd\u79bb\u76f8\u7b49)\n\n\n## \u5355\u4f4d\u6839\n\n\u82e5$\\omega^n=1$\u5219$\\omega$\u4e3a$n$\u6b21\u5355\u4f4d\u6839\n\n\u5728\u590d\u5e73\u9762\u4e0a,\u4ee5\u539f\u70b9\u4e3a\u5706\u5fc3,$1$\u4e3a\u534a\u5f84\u4f5c\u5706,\u6240\u5f97\u7684\u5706\u53eb\u5355\u4f4d\u5706\u3002\n\n\u4ee5\u5706\u5fc3\u4e3a\u8d77\u70b9,\u5706\u7684$n$\u7b49\u5206\u70b9\u4e3a\u7ec8\u70b9,\u505a$n$\u4e2a\u5411\u91cf\u3002\n\n\u5176\u4e2d\u5e45\u89d2\u4e3a\u6b63\u4e14\u6700\u5c0f\u7684\u5411\u91cf\u79f0\u4e3a$n$\u6b21\u5355\u4f4d\u5411\u91cf,\u8bb0\u4e3a$\\omega_n^1$\n\n\u6839\u636e\u590d\u6570\u4e58\u6cd5\u7684\u8fd0\u7b97\u6cd5\u5219,\u5176\u4f59$n\u22121$\u4e2a\u590d\u6570\u4e3a$\\omega_n^2,\\omega_n^3,\\dots,\\omega_n^n$\n\n$\\omega_n^0=\\omega_n^n=1$,\u5728\u590d\u5e73\u9762\u4e0a\u5bf9\u5e94\u7684\u70b9\u4e3a$(1,0)$\n\n<html>\n\n<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"584\" height=\"294\"><defs><clipPath id=\"HfoVspciGtkQ\"><path fill=\"none\" stroke=\"none\" d=\" M 0 0 L 584 0 L 584 294 L 0 294 L 0 0 Z\"/></clipPath></defs><g transform=\"scale(1,1)\" clip-path=\"url(#HfoVspciGtkQ)\"><g><rect fill=\"rgb(255,255,255)\" stroke=\"none\" x=\"0\" y=\"0\" width=\"584\" height=\"294\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(192,192,192)\" paint-order=\"fill stroke markers\" d=\" M 34.5 0.5 L 34.5 294.5 M 34.5 0.5 L 34.5 294.5 M 100.5 0.5 L 100.5 294.5 M 167.5 0.5 L 167.5 294.5 M 300.5 0.5 L 300.5 294.5 M 367.5 0.5 L 367.5 294.5 M 433.5 0.5 L 433.5 294.5 M 500.5 0.5 L 500.5 294.5 M 567.5 0.5 L 567.5 294.5\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(192,192,192)\" paint-order=\"fill stroke markers\" d=\" M 7.5 0.5 L 7.5 294.5 M 20.5 0.5 L 20.5 294.5 M 47.5 0.5 L 47.5 294.5 M 60.5 0.5 L 60.5 294.5 M 74.5 0.5 L 74.5 294.5 M 87.5 0.5 L 87.5 294.5 M 114.5 0.5 L 114.5 294.5 M 127.5 0.5 L 127.5 294.5 M 140.5 0.5 L 140.5 294.5 M 154.5 0.5 L 154.5 294.5 M 180.5 0.5 L 180.5 294.5 M 194.5 0.5 L 194.5 294.5 M 207.5 0.5 L 207.5 294.5 M 220.5 0.5 L 220.5 294.5 M 247.5 0.5 L 247.5 294.5 M 260.5 0.5 L 260.5 294.5 M 273.5 0.5 L 273.5 294.5 M 287.5 0.5 L 287.5 294.5 M 313.5 0.5 L 313.5 294.5 M 327.5 0.5 L 327.5 294.5 M 340.5 0.5 L 340.5 294.5 M 353.5 0.5 L 353.5 294.5 M 380.5 0.5 L 380.5 294.5 M 393.5 0.5 L 393.5 294.5 M 407.5 0.5 L 407.5 294.5 M 420.5 0.5 L 420.5 294.5 M 447.5 0.5 L 447.5 294.5 M 460.5 0.5 L 460.5 294.5 M 473.5 0.5 L 473.5 294.5 M 487.5 0.5 L 487.5 294.5 M 513.5 0.5 L 513.5 294.5 M 527.5 0.5 L 527.5 294.5 M 540.5 0.5 L 540.5 294.5 M 553.5 0.5 L 553.5 294.5 M 580.5 0.5 L 580.5 294.5\" stroke-opacity=\"0.23529411764705882\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(192,192,192)\" paint-order=\"fill stroke markers\" d=\" M 0.5 16.5 L 584.5 16.5 M 0.5 16.5 L 584.5 16.5 M 0.5 82.5 L 584.5 82.5 M 0.5 216.5 L 584.5 216.5 M 0.5 282.5 L 584.5 282.5\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(192,192,192)\" paint-order=\"fill stroke markers\" d=\" M 0.5 2.5 L 584.5 2.5 M 0.5 2.5 L 584.5 2.5 M 0.5 29.5 L 584.5 29.5 M 0.5 42.5 L 584.5 42.5 M 0.5 56.5 L 584.5 56.5 M 0.5 69.5 L 584.5 69.5 M 0.5 96.5 L 584.5 96.5 M 0.5 109.5 L 584.5 109.5 M 0.5 122.5 L 584.5 122.5 M 0.5 136.5 L 584.5 136.5 M 0.5 162.5 L 584.5 162.5 M 0.5 176.5 L 584.5 176.5 M 0.5 189.5 L 584.5 189.5 M 0.5 202.5 L 584.5 202.5 M 0.5 229.5 L 584.5 229.5 M 0.5 242.5 L 584.5 242.5 M 0.5 256.5 L 584.5 256.5 M 0.5 269.5 L 584.5 269.5\" stroke-opacity=\"0.23529411764705882\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 233.5 2.5 L 233.5 294.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 233.5 1.5 L 229.5 5.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 233.5 1.5 L 237.5 5.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 0.5 149.5 L 582.5 149.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 583.5 149.5 L 579.5 145.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 583.5 149.5 L 579.5 153.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"23\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"23\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u20131.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"23\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"95\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"95\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u20131</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"95\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"156\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20130.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"156\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u20130.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"156\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20130.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"292\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"292\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">0.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"292\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"365\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"365\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">1</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"365\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"425\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"425\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">1.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"425\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"498\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">2</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"498\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">2</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"498\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">2</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"559\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">2.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"559\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">2.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"559\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">2.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"212\" y=\"287\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"212\" y=\"287\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u20131</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"212\" y=\"287\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"197\" y=\"221\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20130.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"197\" y=\"221\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u20130.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"197\" y=\"221\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20130.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"204\" y=\"87\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"204\" y=\"87\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">0.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"204\" y=\"87\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"21\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"21\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">1</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"21\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">0</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0</text><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 367.23252568911755 149.44244871325463 C 367.23252568911755 223.03584163929233 307.5732931378362 282.695074190574 233.97990021179882 282.695074190574 C 160.38650728576147 282.695074190574 100.72727473448012 223.03584163929233 100.72727473448012 149.44244871325463 C 100.72727473448012 75.84905578721691 160.38650728576147 16.18982323593528 233.97990021179882 16.18982323593528 C 307.5732931378362 16.18982323593528 367.23252568911755 75.84905578721691 367.23252568911755 149.44244871325463 Z\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(0,0,0)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 263.97990021179885 149.44244871325463 C 263.97990021179885 141.48595401806827 260.8191950008363 133.8553366310992 255.19310364739525 128.2292452776581 L 233.97990021179882 149.44244871325463 Z\" fill-opacity=\"0.09803921568627451\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 263.97990021179885 149.44244871325463 C 263.97990021179885 141.48595401806827 260.8191950008363 133.8553366310992 255.19310364739525 128.2292452776581 L 233.97990021179882 149.44244871325463 Z\" stroke-opacity=\"0.6\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\"/><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"247\" y=\"147\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u03b8</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"247\" y=\"147\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u03b8</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"247\" y=\"147\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u03b8</text><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 316.1829200175509 67.23942890750214\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 328.2037352977222 55.21861362733081 L 319.1881238375937 70.24463272754497 L 313.17771619750806 64.23422508745932 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 151.77688040604676 231.64546851900712\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 139.75606512587547 243.66628379917847 L 148.77167658600393 228.6402646989643 L 154.78208422608958 234.65067233904995 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 151.77688040604676 67.23942890750214\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 139.75606512587547 55.21861362733081 L 154.78208422608958 64.23422508745932 L 148.77167658600393 70.24463272754497 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 316.1829200175509 231.64546851900712\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 328.2037352977222 243.66628379917847 L 313.17771619750806 234.65067233904995 L 319.1881238375937 228.6402646989643 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 350.23252568911755 149.44244871325463\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 367.23252568911755 149.44244871325463 L 350.23252568911755 153.69244871325463 L 350.23252568911755 145.19244871325463 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 117.72727473448012 149.44244871325463\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 100.72727473448012 149.44244871325463 L 117.72727473448012 145.19244871325463 L 117.72727473448012 153.69244871325463 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 233.97990021179882 265.695074190574\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 233.97990021179882 282.695074190574 L 229.72990021179882 265.695074190574 L 238.22990021179882 265.695074190574 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 233.97990021179882 33.18982323593528\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 233.97990021179882 16.18982323593528 L 238.22990021179882 33.18982323593528 L 229.72990021179882 33.18982323593528 Z\" fill-opacity=\"0.8\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 237.97990021179882 149.44244871325463 C 237.97990021179882 151.6515877125778 236.189039211122 153.44244871325463 233.97990021179882 153.44244871325463 C 231.77076121247563 153.44244871325463 229.97990021179882 151.6515877125778 229.97990021179882 149.44244871325463 C 229.97990021179882 147.23330971393145 231.77076121247563 145.44244871325463 233.97990021179882 145.44244871325463 C 236.189039211122 145.44244871325463 237.97990021179882 147.23330971393145 237.97990021179882 149.44244871325463 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 237.97990021179882 149.44244871325463 C 237.97990021179882 151.6515877125778 236.189039211122 153.44244871325463 233.97990021179882 153.44244871325463 C 231.77076121247563 153.44244871325463 229.97990021179882 151.6515877125778 229.97990021179882 149.44244871325463 C 229.97990021179882 147.23330971393145 231.77076121247563 145.44244871325463 233.97990021179882 145.44244871325463 C 236.189039211122 145.44244871325463 237.97990021179882 147.23330971393145 237.97990021179882 149.44244871325463 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">O</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">O</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">O</text><path fill=\"rgb(21,101,192)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 372.23252568911755 149.44244871325463 C 372.23252568911755 152.2038724624086 369.9939494382715 154.44244871325463 367.23252568911755 154.44244871325463 C 364.4711019399636 154.44244871325463 362.23252568911755 152.2038724624086 362.23252568911755 149.44244871325463 C 362.23252568911755 146.68102496410066 364.4711019399636 144.44244871325463 367.23252568911755 144.44244871325463 C 369.9939494382715 144.44244871325463 372.23252568911755 146.68102496410066 372.23252568911755 149.44244871325463 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 372.23252568911755 149.44244871325463 C 372.23252568911755 152.2038724624086 369.9939494382715 154.44244871325463 367.23252568911755 154.44244871325463 C 364.4711019399636 154.44244871325463 362.23252568911755 152.2038724624086 362.23252568911755 149.44244871325463 C 362.23252568911755 146.68102496410066 364.4711019399636 144.44244871325463 367.23252568911755 144.44244871325463 C 369.9939494382715 144.44244871325463 372.23252568911755 146.68102496410066 372.23252568911755 149.44244871325463 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><path fill=\"rgb(21,101,192)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 333.2037352977222 55.21861362733081 C 333.2037352977222 57.98003737648477 330.9651590468761 60.21861362733081 328.2037352977222 60.21861362733081 C 325.4423115485682 60.21861362733081 323.2037352977222 57.98003737648477 323.2037352977222 55.21861362733081 C 323.2037352977222 52.45718987817684 325.4423115485682 50.21861362733081 328.2037352977222 50.21861362733081 C 330.9651590468761 50.21861362733081 333.2037352977222 52.45718987817684 333.2037352977222 55.21861362733081 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 333.2037352977222 55.21861362733081 C 333.2037352977222 57.98003737648477 330.9651590468761 60.21861362733081 328.2037352977222 60.21861362733081 C 325.4423115485682 60.21861362733081 323.2037352977222 57.98003737648477 323.2037352977222 55.21861362733081 C 323.2037352977222 52.45718987817684 325.4423115485682 50.21861362733081 328.2037352977222 50.21861362733081 C 330.9651590468761 50.21861362733081 333.2037352977222 52.45718987817684 333.2037352977222 55.21861362733081 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u03c9</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u03c9</text><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u03c9</text><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"14px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"346\" y=\"52\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">8</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"14px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"346\" y=\"52\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">8</text><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"14px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"346\" y=\"52\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">8</text><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"354\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">(cos \u03b8, i sin \u03b8)</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"354\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">(cos \u03b8, i sin \u03b8)</text><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"354\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">(cos \u03b8, sin \u03b8)</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 143.75606512587547 243.66628379917847 C 143.75606512587547 245.87542279850163 141.96520412519862 247.66628379917847 139.75606512587547 247.66628379917847 C 137.54692612655228 247.66628379917847 135.75606512587547 245.87542279850163 135.75606512587547 243.66628379917847 C 135.75606512587547 241.45714479985529 137.54692612655228 239.66628379917847 139.75606512587547 239.66628379917847 C 141.96520412519862 239.66628379917847 143.75606512587547 241.45714479985529 143.75606512587547 243.66628379917847 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 143.75606512587547 243.66628379917847 C 143.75606512587547 245.87542279850163 141.96520412519862 247.66628379917847 139.75606512587547 247.66628379917847 C 137.54692612655228 247.66628379917847 135.75606512587547 245.87542279850163 135.75606512587547 243.66628379917847 C 135.75606512587547 241.45714479985529 137.54692612655228 239.66628379917847 139.75606512587547 239.66628379917847 C 141.96520412519862 239.66628379917847 143.75606512587547 241.45714479985529 143.75606512587547 243.66628379917847 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">C</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">C</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">C</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 143.75606512587547 55.21861362733081 C 143.75606512587547 57.427752626653984 141.96520412519862 59.21861362733081 139.75606512587547 59.21861362733081 C 137.54692612655228 59.21861362733081 135.75606512587547 57.427752626653984 135.75606512587547 55.21861362733081 C 135.75606512587547 53.00947462800764 137.54692612655228 51.21861362733081 139.75606512587547 51.21861362733081 C 141.96520412519862 51.21861362733081 143.75606512587547 53.00947462800764 143.75606512587547 55.21861362733081 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 143.75606512587547 55.21861362733081 C 143.75606512587547 57.427752626653984 141.96520412519862 59.21861362733081 139.75606512587547 59.21861362733081 C 137.54692612655228 59.21861362733081 135.75606512587547 57.427752626653984 135.75606512587547 55.21861362733081 C 135.75606512587547 53.00947462800764 137.54692612655228 51.21861362733081 139.75606512587547 51.21861362733081 C 141.96520412519862 51.21861362733081 143.75606512587547 53.00947462800764 143.75606512587547 55.21861362733081 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"47\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">B</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"47\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">B</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"47\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">B</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 332.2037352977222 243.66628379917847 C 332.2037352977222 245.87542279850163 330.41287429704533 247.66628379917847 328.2037352977222 247.66628379917847 C 325.994596298399 247.66628379917847 324.2037352977222 245.87542279850163 324.2037352977222 243.66628379917847 C 324.2037352977222 241.45714479985529 325.994596298399 239.66628379917847 328.2037352977222 239.66628379917847 C 330.41287429704533 239.66628379917847 332.2037352977222 241.45714479985529 332.2037352977222 243.66628379917847 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 332.2037352977222 243.66628379917847 C 332.2037352977222 245.87542279850163 330.41287429704533 247.66628379917847 328.2037352977222 247.66628379917847 C 325.994596298399 247.66628379917847 324.2037352977222 245.87542279850163 324.2037352977222 243.66628379917847 C 324.2037352977222 241.45714479985529 325.994596298399 239.66628379917847 328.2037352977222 239.66628379917847 C 330.41287429704533 239.66628379917847 332.2037352977222 241.45714479985529 332.2037352977222 243.66628379917847 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">D</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">D</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">D</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 104.72727473448012 149.44244871325463 C 104.72727473448012 151.6515877125778 102.93641373380329 153.44244871325463 100.72727473448012 153.44244871325463 C 98.51813573515695 153.44244871325463 96.72727473448012 151.6515877125778 96.72727473448012 149.44244871325463 C 96.72727473448012 147.23330971393145 98.51813573515695 145.44244871325463 100.72727473448012 145.44244871325463 C 102.93641373380329 145.44244871325463 104.72727473448012 147.23330971393145 104.72727473448012 149.44244871325463 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 104.72727473448012 149.44244871325463 C 104.72727473448012 151.6515877125778 102.93641373380329 153.44244871325463 100.72727473448012 153.44244871325463 C 98.51813573515695 153.44244871325463 96.72727473448012 151.6515877125778 96.72727473448012 149.44244871325463 C 96.72727473448012 147.23330971393145 98.51813573515695 145.44244871325463 100.72727473448012 145.44244871325463 C 102.93641373380329 145.44244871325463 104.72727473448012 147.23330971393145 104.72727473448012 149.44244871325463 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"105\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">E</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"105\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">E</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"105\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">E</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 237.97990021179882 282.695074190574 C 237.97990021179882 284.9042131898972 236.189039211122 286.695074190574 233.97990021179882 286.695074190574 C 231.77076121247563 286.695074190574 229.97990021179882 284.9042131898972 229.97990021179882 282.695074190574 C 229.97990021179882 280.48593519125086 231.77076121247563 278.695074190574 233.97990021179882 278.695074190574 C 236.189039211122 278.695074190574 237.97990021179882 280.48593519125086 237.97990021179882 282.695074190574 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 237.97990021179882 282.695074190574 C 237.97990021179882 284.9042131898972 236.189039211122 286.695074190574 233.97990021179882 286.695074190574 C 231.77076121247563 286.695074190574 229.97990021179882 284.9042131898972 229.97990021179882 282.695074190574 C 229.97990021179882 280.48593519125086 231.77076121247563 278.695074190574 233.97990021179882 278.695074190574 C 236.189039211122 278.695074190574 237.97990021179882 280.48593519125086 237.97990021179882 282.695074190574 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"275\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">F</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"275\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">F</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"275\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">F</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 237.97990021179882 16.18982323593528 C 237.97990021179882 18.398962235258452 236.189039211122 20.18982323593528 233.97990021179882 20.18982323593528 C 231.77076121247563 20.18982323593528 229.97990021179882 18.398962235258452 229.97990021179882 16.18982323593528 C 229.97990021179882 13.980684236612106 231.77076121247563 12.189823235935279 233.97990021179882 12.189823235935279 C 236.189039211122 12.189823235935279 237.97990021179882 13.980684236612106 237.97990021179882 16.18982323593528 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 237.97990021179882 16.18982323593528 C 237.97990021179882 18.398962235258452 236.189039211122 20.18982323593528 233.97990021179882 20.18982323593528 C 231.77076121247563 20.18982323593528 229.97990021179882 18.398962235258452 229.97990021179882 16.18982323593528 C 229.97990021179882 13.980684236612106 231.77076121247563 12.189823235935279 233.97990021179882 12.189823235935279 C 236.189039211122 12.189823235935279 237.97990021179882 13.980684236612106 237.97990021179882 16.18982323593528 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"16\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">G</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"16\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">G</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"16\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">G</text></g></g></svg>\n\n</html>\n\n\u5411\u91cf$\\overrightarrow{O\\omega_8}$\u8868\u793a\u7684\u590d\u6570\u5c31\u662f$8$\u6b21\u5355\u4f4d\u6839,$\\omega_8^1$\n\n> \u62d3\u5c55:\n>\n> \u6b27\u62c9\u516c\u5f0f: $e^{i\\theta}=\\cos\\theta + i \\sin \\theta$(\u5728\u590d\u5e73\u9762\u5185\u5750\u6807\u4e3a$(\\cos \\theta, \\sin \\theta)$)\n>\n> $\\omega_n^k=e^{i 2\\pi \\frac kn}$\n> (\u53ef\u4ee5\u7406\u89e3\u4e3a\u4ece$\\omega_n^0(1,0)$\u5f00\u59cb\u8d70\u957f\u5ea6\u4e3a$2\\pi \\frac kn$\u7684\u5706\u5f27\u540e\u5230\u8fbe\u7684\u4f4d\u7f6e)\n>\n> \u6b27\u62c9\u516c\u5f0f: $e^{i\\pi}=-1$(\u590d\u5e73\u9762\u4e2d\u7684$(-1,0)$)\n>\n> \u5173\u4e8e\u8bc1\u660e\u548c\u7406\u89e3,\u53ef\u4ee5\u53c2\u8003:\n> \n> [\u6570\u5b66\u5e38\u6570\u4e0e\u6b27\u62c9\u516c\u5f0f](/posts/\u6570\u5b66\u5e38\u6570\u4e0e\u6b27\u62c9\u516c\u5f0f)\n> \n> https://www.bilibili.com/video/av63666593\n>\n> https://www.bilibili.com/video/av79134103\n\n\u6027\u8d28:\n\n$\\omega_n^k= \\cos 2\\pi\\frac kn+ i \\sin 2\\pi \\frac kn$\n\n$\\omega_{2n}^{2k}=\\omega_n^k$\n\n> $\\omega_{2n}^{2k}=\\cos 2\\pi\\frac {2k}{2n}+ i \\sin 2\\pi \\frac {2k}{2n}=\\cos 2\\pi\\frac kn+ i \\sin 2\\pi \\frac kn=\\omega_n^k$\n\n$\\omega_n^0=\\omega_n^n=1$\n\n$\\omega_n^{k+\\frac n2}=-\\omega_n^k$\n\n> $\\omega _{n}^{\\frac{n}{2}}=\\cos\\frac{n}{2}\\cdot\\frac{2\\pi}{n}+i\\sin\\frac{n}{2}\\cdot\\frac{2\\pi}{n}=-1$\n> (\u4e5f\u5c31\u662f\u4e0a\u9762\u8bf4\u7684$e^{i\\pi}$)\n\n\n\u6b63\u9898\u5f00\u59cb:\n\n## DFT\n\n\u5c06\u591a\u9879\u5f0f\u4ece\u7cfb\u6570\u8868\u793a\u6cd5\u8f6c\u6362\u4e3a\u70b9\u503c\u8868\u793a\u6cd5\n\n\u5982\u679c\u66b4\u529b\u4ee3\u5165$n$\u4e2a\u70b9,\u590d\u6742\u5ea6\u8fd8\u662f$\\mathcal{O(n^2)}$\u7684\n\n\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u5355\u4f4d\u6839\u7684\u6027\u8d28\n\n\u5047\u8bbe\u8bbe$n$\u4e3a\u5076\u6570\n\n\u5bf9\u4e8e$A(x)=a_0+a_1x+a_2x^2+a_3x^3+\\dots+a_{n-1}x^{n-1}$\n\n$A(x)=(a_0+a_2x^2+a_4x^4+\\dots+a_{n-2}x^{n-2})+x(a_1+a_3x^2+a_5x^4+...+a_{n-1}x^{n-1})$\n\n\u8bbe$A_1(x)=a_0+a_2x+a_4x^2+\\dots+a_{n-2}x^\\frac{n-2}2,A_2(x)=a_1+a_3x+a_5x^2+...+a_{n-1}x^\\frac{n-2}2$\n\n\u90a3\u4e48$A(x)=A_1(x^2)+xA_2(x^2)$\n\n\u8bbe$0 \\le k \\le \\frac{n}{2}-1,k\\in Z$\n\n$A(\\omega_n^k)=A_1(\\omega_\\frac n2 ^k)+\\omega_n^k\\cdot A_2(\\omega_\\frac n2 ^k)$\n\n\u5bf9\u4e8e$\\frac n2 \\le k+\\frac n2 \\le n-1$\n\n$A(\\omega_n^{k+\\frac n2})=A_1(\\omega_n^{2k+n})+\\omega_n^{k+\\frac n2}\\cdot A_2(\\omega_n^{2k+n})$\n\n$\\because \\omega_n^{k+\\frac n2}=-\\omega_n^k,\\omega_n^{2k+n}=\\omega_\\frac n2^k$\n\n$\\therefore A(\\omega_n^{k+\\frac n2})=A_1(\\omega_\\frac n2^k)-\\omega_n^k\\cdot A_2(\\omega_\\frac n2^k)$\n\n\u5982\u679c\u5df2\u7ecf\u77e5\u9053$A_1,A_2$\u5206\u522b\u5728$\\omega_\\frac n2 ^{0,1,2,...,\\frac n2 -1}$\u7684\u53d6\u503c,\u90a3\u4e48\u5c31\u53ef\u4ee5\u5728$\\mathcal{O(n)}$\u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u51fa$A(x)$,\u800c$A_1(x),A_2(x)$\u7684\u89c4\u6a21\u90fd\u662f$A(x)$\u7684\u4e00\u534a\n\n\u590d\u6742\u5ea6$\\mathcal{T(n)=2T(\\frac n2)+O(n) = O(n \\log n)}$\n\n## IDFT\n\n\u4f7f\u7528\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u5c06\u70b9\u503c\u8868\u793a\u7684\u591a\u9879\u5f0f\u8f6c\u5316\u4e3a\u7cfb\u6570\u8868\u793a,\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u505a\u79bb\u6563\u5085\u91cc\u53f6\u9006\u53d8\u6362\n\n\u5373\u7531$n$\u7ef4\u70b9\u503c\u5411\u91cf$(A(x_0),A(x_1),\\dots,A(x_{n-1}))$\u63a8\u51fa$n$\u7ef4\u7cfb\u6570\u5411\u91cf$(a_0,a_1,\\dots,a_{n-1})$\u3002\n\n\u8bbe$y_0,y_1,y_2,...,y_{n-1}$\u662f\u591a\u9879\u5f0f$A(x)$\u53d8\u6362\u540e\u7684\u70b9\u503c\n\n\u8bbe$(d_0,d_1,\\dots,d_{n-1})$\u4e3a$(a_0,a_1,\\dots,a_{n-1})$\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\u540e\u7684\u7ed3\u679c\n\n\u6784\u9020$F(x)=d_0+d_1x+d_2x^2+\\dots+d_{n-1}x^{n-1}$\n\n\u8bbe\u5411\u91cf$(c_0,c_1,\\dots,c_{n-1})$\u4e2d\n\n$c_k$\u4e3a$F(x)$\u5728$x=\\omega_n^{-k}$\u65f6\u7684\u70b9\u503c\u8868\u793a\n\n$$\nc_k=\\sum_{i=0}^{n-1}d_i\\cdot(\\omega_n^{-k})^i\n\\\\\n=\\sum_{i=0}^{n-1}[\\sum_{j=0}^{n-1}a_j(\\omega_n^i)^j]\\cdot(\\omega_n^{-k})^i\n\\\\\n=\\sum_{j=0}^{n-1}a_j\\sum_{i=0}^{n-1}(\\omega_n^i)^j\\cdot(\\omega_n^{-k})^i\n\\\\\n=\\sum_{j=0}^{n-1}a_j\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}\n$$\n\n\u89c2\u5bdf$\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}$\n\n\u5f53$j=k$\u65f6$\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}=\\sum_{i=0}^{n-1}1=n$\n\n\u5f53$j\\not = k$\u65f6\n\n$\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}=$\n\n$\\sum_{i=0}^{\\frac{n-1}2}(\\omega_n^i)^{j-k}+(\\omega_n^{i+\\frac{n-1}2})^{j-k}=0$\n\n\u4e5f\u5c31\u662f$n$\u6b21\u5355\u4f4d\u6839\u4f1a\u4e92\u76f8\u62b5\u6d88\n\n$\\therefore \\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}=[j=k]\\cdot n$\n\n$\\therefore c_k=\\sum_{j=0}^{n-1}a_j\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}=\\sum_{j=0}^{n-1}a_j [j=k]\\cdot n=na_k$\n\n$\\therefore a_k=\\frac{c_k}n$\n\n\u90a3\u4e48\u6211\u4eec\u8981\u5c06\u70b9\u503c\u8868\u793a\u7684\u591a\u9879\u5f0f\u8f6c\u5316\u4e3a\u7cfb\u6570\u8868\u793a:\n\n1. \u5c06$(\\omega_n^0,\\omega_n^{-1},\\omega_n^{-2},\\dots,w_n^{-(n-1)})$\u4f5c\u4e3a\u5dee\u503c\u8282\u70b9,\u5c06\u70b9\u503c\u518d\u505a\u4e00\u6b21DFT\n\n   \u5f97\u5230$(c_0,c_1,c_2,\\dots,c_{n-1})$\n\n2. $(\\frac{c_0}n,\\frac{c_1}n,\\frac{c_2}n,\\dots,\\frac{c_{n-1}}n)$\u5c31\u662f\u539f\u6765\u7684$(a_0,a_1,a_2,\\dots,a_{n-1})$\n\n\n\u5230\u8fd9\u91cc\u6211\u4eec\u5c31\u5df2\u7ecf\u5927\u81f4\u61c2\u5f97FFT\u7684\u539f\u7406\u4e86,\u90a3\u8981\u600e\u4e48\u5b9e\u73b0\u5462?\n\n## \u5b9e\u73b0\n\n[LG 3803 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09](https://www.luogu.com.cn/problem/P3803)\n\n### \u666e\u901a\u7684\u9012\u5f52\u5199\u6cd5\n\n~~Fst_Fst_**TLE**~~\n\n\u4e0d\u65ad\u5bf9\u4e0b\u6807\u8fdb\u884c\u5947\u5076\u5206\u7c7b,\u5206\u6210\u4e24\u4e2a\u5b50\u5e8f\u5217\u4e4b\u540e\u518d\u4e0d\u65ad\u5408\u5e76\n\n\u9700\u8981\u8f85\u52a9\u6570\u7ec4,\u5bb9\u6613**TLE,MLE**\n\n### \u8fed\u4ee3\u5b9e\u73b0\n\n![](https://pic1.zhimg.com/80/v2-953d1cd6c91a84197775d504defe302c_hd.jpg)\n\n\u53ef\u4ee5\u53d1\u73b0\u5728\u4e0d\u65ad\u8fdb\u884c\u5947\u5076\u5206\u7c7b\u4e4b\u540e,\u539f\u6570\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\u4e0b\u6807\u6700\u7ec8\u53d8\u6210\u4e86**\u4e0b\u6807\u7684\u4e8c\u8fdb\u5236\u53cd\u8f6c**\n\n\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u679a\u4e3e\u6765\u4ee3\u66ff\u9012\u5f52\n\n\u4ece\u6700\u5e95\u5c42\u5f00\u59cb\u5411\u4e0a\u5408\u5e76,\u90a3\u4e48\u600e\u4e48\u5408\u5e76\u5462\uff1f\n\n#### \u8774\u8776\u64cd\u4f5c\n\n\u8bbe\u8be5\u5c42\u4e00\u5171\u6709$n$\u9879\u9700\u8981\u5904\u7406\n\n\u8bbe$A_1(\\omega_{\\frac n2}^k)$\u548c$A_2(\\omega_{\\frac n2}^k)$\u5206\u522b\u5b58\u653e\u5728$a_k$\u548c$a_{k+\\frac n2}$\n\n$A_1(\\omega_n^k)$\u548c$A_2(\\omega_n^k)$\u8981\u5b58\u653e\u5728$buf(k)$\u548c$buf(k+\\frac n2)$\n\n\u6211\u4eec\u53ea\u9700\u8bbe\u4e2d\u95f4\u53d8\u91cf$t=\\omega_n^k\\cdot a(k+\\frac n2)$\n\n$buf(k+\\frac n2)= a(k) - t$\n\n$buf(k) = a(k)+t$\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u4e0d\u9700\u8981\u8f85\u52a9\u5b58\u653e\u7684\u6570\u7ec4$buf$\u4e86,\u76f4\u63a5\u5728\u539f\u5e8f\u5217\u64cd\u4f5c\u5373\u53ef\n\n\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n#define db double\n#define For(i,x,y) for(int i=x;i<=y;++i)\nconst int N=4000011;\nconst db Pi=acos(-1.0);\nint n,m,limit=1,l=0,r[N];\nstruct cp{db r,i;cp(db R=0,db I=0){r=R,i=I;}}a[N],b[N];\ncp operator + (cp a,cp b){return cp(a.r+b.r,a.i+b.i);}\ncp operator - (cp a,cp b){return cp(a.r-b.r,a.i-b.i);}\ncp operator * (cp a,cp b){return cp(a.r*b.r-a.i*b.i,a.r*b.i+a.i*b.r);}\nvoid fft(cp *A,int typ){\n    For(i,0,limit-1)\n        if(i<r[i])std::swap(A[i],A[r[i]]);\n    for(int len=1;len<limit;len<<=1){//\u5df2\u5904\u7406\u597d\u7684\u957f\u5ea6\u5757,\u4e5f\u5c31\u662fn/2\n        cp Wn(cos(Pi/len),typ*sin(Pi/len));//\u5355\u4f4d\u6839\n        for(int i=0;i<limit;i+=(len<<1)){\n            cp w(1,0);//w_n^0\n            For(k,0,len-1){//\u8774\u8776\u64cd\u4f5c\n                cp t=w*A[i+k+len];\n                A[i+k+len]=A[i+k]-t;\n                A[i+k]=A[i+k]+t;\n                w=w*Wn;\n            }\n        }\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    For(i,0,n)scanf(\"%lf\",&a[i].r);\n    For(i,0,m)scanf(\"%lf\",&b[i].r);\n\n    while(limit<=n+m)limit<<=1,++l;\n    For(i,0,limit-1)//\u9884\u5904\u7406\u51fa\u4e0d\u65ad\u5947\u5076\u5206\u7c7b\u540e\u7684\u6700\u7ec8\u4f4d\u7f6e\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\n    fft(a,1);fft(b,1);//DFT\n    For(i,0,limit)a[i]=a[i]*b[i];//\u70b9\u503c\u76f8\u4e58\n    fft(a,-1);//IDFT\n    For(i,0,n+m)printf(\"%d \",int(a[i].r/limit+0.5));\n}\n```\n\n\n\u672c\u6587\u90e8\u5206\u5185\u5bb9\u6458\u81ea:(\u53c2\u8003\u8d44\u6599)\n\nhttps://zhuanlan.zhihu.com/p/31584464\n\nhttps://www.cnblogs.com/zwfymqz/p/8244902.html\n\n", "link": "/posts/fft/", "tags": ["\u6570\u8bba", "\u7b97\u6cd5", "\u9ad8\u7cbe\u5ea6", "fft"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "bsgs", "content": "\u6c42\u89e3\u5173\u4e8e$x$\u7684\u65b9\u7a0b: \n\n$$y^x \\equiv z \\pmod p$$\n\n## bsgs\n\n\u5f53$\\gcd(y,p)=1$\u65f6\n\n\u89e3\u6cd5: \n\n\u8bbe$x=am-b$\n\n\u90a3\u4e48$y^{am} \\equiv z\\cdot a^b \\pmod p$\n\n\u53f3\u8fb9: \n\n\u679a\u4e3e$b$\u7684\u53d6\u503c$[0,m-1]$,\u8ba1\u7b97\u53f3\u8fb9\u7684\u503c,\u5b58\u5165\u54c8\u5e0c\u8868\n\n\u5de6\u8fb9:\n\n\u679a\u4e3e\u53ef\u80fd\u7684$a$,\u4e5f\u5c31\u662f$[1,m]$,\u82e5\u5de6\u8fb9\u7684\u503c\u5728\u54c8\u5e0c\u8868\u4e2d\u51fa\u73b0\u8fc7,\u90a3\u4e48\u5f53\u524d$a$\u5408\u6cd5\n\n\u4e0d\u96be\u8bc1\u660e\u5f53$m=\\sqrt p$\u7684\u65f6\u5019\u590d\u6742\u5ea6\u6700\u4f18,$\\Theta(\\sqrt p)$\n\n\u5173\u952e\u4ee3\u7801:\n\n```cpp\na%=p;\nif(!a){\n    if(!b)out(\"1\\n\");\n    else out(\"Orz, I cannot find x!\\n\");\n    continue;\n}\nint m=sqrt(p)+1,x=b%p,t=pw(a,m);\nS.clear();\nS.ins(x,0);\nFur(i,1,m)x=1ll*x*a%p,S.ins(x,i);\nx=1;\nbool ff=1;\nFur(i,1,m){\n    x=1ll*x*t%p;\n    int k=S[x];\n    if(~k){\n        ff=0;\n        out(((i*m-k)%p+p)%p,ln);\n        break;\n    }\n}\nif(ff)out(\"Orz, I cannot find x!\\n\");\n```\n\n## ex bsgs\n\n\u5f53$\\gcd(y,p)\\not =1$\u65f6\n\n$$\ny^x+kp=z\n$$\n\n\u4ee4$d=\\gcd(y,p)$\n\n\u53ef\u4ee5\u53d1\u73b0\u5f53$d|z$\u65f6\u624d\u6709\u89e3\n\n\u9664\u53bb$d$\n\n$$\n\\frac ydy^{x-1}+k\\frac pd=\\frac zd\n$$\n\n\u5c31\u8fd9\u6837\u4e00\u76f4\u9012\u5f52,\u9664\u53bb$d$,\u76f4\u5230$d=1$\n\n\u5047\u8bbe\u9012\u5f52\u4e86$c$\u6b21,\u6240\u6709$d$\u4e58\u79ef\u4e3a$g$,\u90a3\u4e48\n\n$$\n\\frac {y^c}g y^{x-c}+k\\frac pg=\\frac zg\n$$\n\u4e5f\u5c31\u662f\n$$\ny^{x-c} \\frac {y^c}g \\equiv \\frac zg \\pmod{\\frac pg}\n$$\n\u4e8e\u662f\u53ef\u4ee5bsgs\u6c42\u89e3\n\n\u5173\u952e\u4ee3\u7801: \n\n```cpp\nvoid exbsgs(int y,int z,int p){\n    if(z==1)return void(out(\"0\\n\"));\n    int k=0,a=1;\n    while(1){\n        int d=GCD(y,p);\n        if(d==1)break;\n        if(z%d)return void(out(\"No Solution\\n\"));\n        z/=d;p/=d;\n        ++k;\n        a=1ll*a*y/d%p;\n        if(z==a)return void(out(k,ln));\n    }\n    S.clear();\n    int m=sqrt(p)+1,x=z,f=pw(y,m,p);\n    Fur(i,0,m-1)S.ins(x,i),x=1ll*x*y%p;\n    x=1ll*a*f%p;\n    Fur(i,1,m){\n        int b=S[x];\n        if(~b)return void(out(i*m-b+k,ln));\n        x=1ll*x*f%p;\n    }\n    out(\"No Solution\\n\");\n}\n```\n\n## \u4f8b\u9898\n\n[LG 4884 \u591a\u5c11\u4e2a1?](https://www.luogu.com.cn/problem/P4884)\n\n$$\n\\overbrace{111\\dots111}^{\\text{N\u4e2a1}} \\equiv k \\pmod m\n\\\\\n\\frac{10^N-1}9\\equiv k \\pmod m\n\\\\\n10^N\\equiv 9k+1 \\pmod m\n$$\n\n\u987a\u5229\u5730\u63a8\u51fa\u662fbsgs,($m$\u662f\u8d28\u6570,\u4e5f\u5c31\u4e0d\u7528exbsgs\u4e86)", "link": "/posts/bsgs/", "tags": ["\u6570\u8bba", "\u7b97\u6cd5"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "\u5e26\u4fee\u533a\u95f4\u7b2ck\u5927", "content": "\u4ee5[Dynamic Rankings](https://www.luogu.com.cn/problem/P2617)\u4e3a\u4f8b\uff1a\n\n\u5982\u679c\u4e0d\u5e26\u4fee\u6539,\u90a3\u5c31\u662f\u666e\u901a\u7684\u4e3b\u5e2d\u6811\n\n\u5f85\u4fee\u6539: \u6811\u72b6\u6570\u7ec4\u5957\u52a8\u6001\u5f00\u70b9\u6743\u503c\u7ebf\u6bb5\u6811\n\n\u5bf9\u4e8e\u4fee\u6539$a_p$,\n\n\u53d7\u5f71\u54cd\u7684\u6709$[p,n]$\n\n\u4f46\u662f\u6211\u4eec\u4e0d\u9700\u8981\u4ece$p$\u4fee\u6539\u5230$n$\n\n\u53ef\u4ee5\u5957\u4e2a\u6811\u72b6\u6570\u7ec4\u8bb0\u5f55\u4fee\u6539\u4f4d\u7f6e\n\n\u6811\u72b6\u6570\u7ec4\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u662f\u4e00\u9897\u7ebf\u6bb5\u6811\n\n\u8fd9\u6837\u4fee\u6539\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u505a\u5230$\\Theta(n \\log^2 n)$\n\n", "link": "/posts/\u5e26\u4fee\u533a\u95f4\u7b2ck\u5927/", "tags": ["\u6570\u636e\u7ed3\u6784", "\u6811", "\u7b97\u6cd5"], "categories": [["\u7b97\u6cd5", "\u6570\u636e\u7ed3\u6784"], ["note"]]}, {"title": "\u6362\u6839\u6811\u94fe\u5256\u5206", "content": "\u6362\u6839\u6811\u94fe\u5256\u5206\n\n[loj #139.\u6811\u94fe\u5256\u5206](https://loj.ac/problem/139)\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u6811\u94fe\u5256\u5206\n\n\u9898\u610f\uff1a\u6811\u94fe\u52a0,\u5b50\u6811\u52a0,\u9700\u8981\u652f\u6301\u6362\u6839,\u67e5\u8be2\u6811\u94fe\u548c,\u5b50\u6811\u548c\n\n\u6811\u94fe\u52a0\u3001\u67e5\u8be2\u6811\u94fe\u548c \u4e0e\u666e\u901a\u7684\u6811\u94fe\u5256\u5206\u4e00\u6837\n\n\u4e3b\u8981\u8bb2\uff1a\n\n\u9700\u8981\u652f\u6301\u6362\u6839,\u5b50\u6811\u52a0,\u67e5\u8be2\u5b50\u6811\u548c\n\n\u8bbe\u5f53\u524d\u67e5\u8be2\u7684\u70b9\u4e3a$x$\n\n\u60c5\u51b51: $x$\u5c31\u662f\u6839,\u76f4\u63a5\u8f93\u51fa\u6574\u68f5\u6811\u7684\u548c\n\n\u60c5\u51b52: \u6839\u5728$x$\u5b50\u6811\u5185:\n\n\u627e\u5230\u6839\u5230$x$\u8def\u5f84\u4e0a\u7684$x$\u7684\u513f\u5b50\n\n```cpp\nint child(int rt,int x){\n    while(top[rt]!=top[x]){\n        rt=top[rt];\n        if(f[rt]==x)return rt;//\u7236\u4eb2\u662fx,\u8fd4\u56de\u5f53\u524d\u70b9\n        rt=f[rt];\n    }\n    return son[x];//\u6839\u5728x\u6240\u5728\u7684\u91cd\u94fe\u4e0a\n}\n```\n\n\u628a\u6574\u68f5\u6811\u9664$t$\u5b50\u6811\u5916\u7684\u90e8\u5206\u52a0\u4e0a$val$\u5373\u53ef\n\n> \u4e3e\u4e2a\u4f8b\u5b50\n> \n> <svg width=\"300px\" height=\"300px\" _=\"SVGRoot\"><g _=\"EditableGraph\"><g _=\"SVGGroup\"><g _=\"GraphEdge\"><path d=\"M 148.30985915492957 45.774647887323944 L 96.30985915492957 98.87323943661971\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 148.30985915492957 45.774647887323944 L 96.30985915492957 98.87323943661971\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 148.30985915492957 45.774647887323944 L 226.30985915492957 98.87323943661971\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 148.30985915492957 45.774647887323944 L 226.30985915492957 98.87323943661971\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 96.30985915492957 98.87323943661971 L 70.30985915492957 151.9718309859155\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 96.30985915492957 98.87323943661971 L 70.30985915492957 151.9718309859155\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 96.30985915492957 98.87323943661971 L 148.3098591549295 151.9718309859155\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 96.30985915492957 98.87323943661971 L 148.3098591549295 151.9718309859155\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 226.30985915492957 98.87323943661971 L 200.30985915492954 151.9718309859155\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 226.30985915492957 98.87323943661971 L 200.30985915492954 151.9718309859155\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 226.30985915492957 98.87323943661971 L 252.30985915492957 151.9718309859155\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 226.30985915492957 98.87323943661971 L 252.30985915492957 151.9718309859155\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 70.30985915492957 151.9718309859155 L 44.30985915492957 205.07042253521126\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 70.30985915492957 151.9718309859155 L 44.30985915492957 205.07042253521126\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 70.30985915492957 151.9718309859155 L 96.30985915492955 205.07042253521126\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 70.30985915492957 151.9718309859155 L 96.30985915492955 205.07042253521126\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g></g><g _=\"SVGGroup\"><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"148.30985915492957\" cy=\"45.774647887323944\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"148.30985915492957\" y=\"45.774647887323944\" style=\"user-select: none;\" _=\"SVGText\">1</text></g><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"96.30985915492957\" cy=\"98.87323943661971\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"96.30985915492957\" y=\"98.87323943661971\" style=\"user-select: none;\" _=\"SVGText\">2</text></g><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"226.30985915492957\" cy=\"98.87323943661971\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"226.30985915492957\" y=\"98.87323943661971\" style=\"user-select: none;\" _=\"SVGText\">3</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"70.30985915492957\" cy=\"151.9718309859155\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"70.30985915492957\" y=\"151.9718309859155\" _=\"SVGText\" style=\"user-select: none;\">4</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"148.3098591549295\" cy=\"151.9718309859155\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"148.3098591549295\" y=\"151.9718309859155\" _=\"SVGText\" style=\"user-select: none;\">5</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"200.30985915492954\" cy=\"151.9718309859155\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"200.30985915492954\" y=\"151.9718309859155\" _=\"SVGText\" style=\"user-select: none;\">6</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"252.30985915492957\" cy=\"151.9718309859155\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"252.30985915492957\" y=\"151.9718309859155\" _=\"SVGText\" style=\"user-select: none;\">7</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"44.30985915492957\" cy=\"205.07042253521126\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"44.30985915492957\" y=\"205.07042253521126\" style=\"user-select: none;\" _=\"SVGText\">8</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"96.30985915492955\" cy=\"205.07042253521126\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"96.30985915492955\" y=\"205.07042253521126\" style=\"user-select: none;\" _=\"SVGText\">9</text></g></g></g></svg>\n> \n> \u5efa\u6811\u65f6\u662f\u4ee51\u4e3a\u6839\n> \n> \u8bbe\u5f53\u524d\u6839\u4e3a9,x\u4e3a2\n> \n> \u627e\u51fa\u7684child\u662f4\n> \n> <svg width=\"300px\" height=\"300px\" _=\"SVGRoot\"><g _=\"EditableGraph\"><g _=\"SVGGroup\"><g _=\"GraphEdge\"><path d=\"M261,153.39565279298176Q205.162355744426,154.5050546416901,149.32471148885205,155.6144564903984\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M261,153.39565279298176Q205.162355744426,154.5050546416901,149.32471148885205,155.6144564903984\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M261,153.39565279298176Q206.91547342716183,207.19782639649088,152.83094685432368,261\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M261,153.39565279298176Q206.91547342716183,207.19782639649088,152.83094685432368,261\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M149.32471148885205,155.6144564903984Q151.05132366814587,97.3072282451992,152.7779358474397,39\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M149.32471148885205,155.6144564903984Q151.05132366814587,97.3072282451992,152.7779358474397,39\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 149.32471148885205 155.6144564903984 L 39 148.97409692923225\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 149.32471148885205 155.6144564903984 L 39 148.97409692923225\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 152.7779358474397 39 L 260.3385416666667 39\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 152.7779358474397 39 L 260.3385416666667 39\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M152.7779358474397,39Q95.88896792371985,39,39,39\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M152.7779358474397,39Q95.88896792371985,39,39,39\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M152.83094685432368,261Q95.91547342716184,261,39,261\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M152.83094685432368,261Q95.91547342716184,261,39,261\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 152.83094685432368 261 L 261 261\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 152.83094685432368 261 L 261 261\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g></g><g _=\"SVGGroup\"><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"261\" cy=\"153.39565279298176\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"261\" y=\"153.39565279298176\" style=\"user-select: none;\" _=\"SVGText\">1</text></g><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"149.32471148885205\" cy=\"155.6144564903984\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"149.32471148885205\" y=\"155.6144564903984\" style=\"user-select: none;\" _=\"SVGText\">2</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"152.83094685432368\" cy=\"261\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"152.83094685432368\" y=\"261\" _=\"SVGText\" style=\"user-select: none;\">3</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"152.7779358474397\" cy=\"39\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"152.7779358474397\" y=\"39\" style=\"user-select: none;\" _=\"SVGText\">4</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"39\" cy=\"148.97409692923225\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"39\" y=\"148.97409692923225\" style=\"user-select: none;\" _=\"SVGText\">5</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"260.3385416666667\" cy=\"39\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"260.3385416666667\" y=\"39\" style=\"user-select: none;\" _=\"SVGText\">8</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"39\" cy=\"39\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"39\" y=\"39\" style=\"user-select: none;\" _=\"SVGText\">9</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"39\" cy=\"261\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"39\" y=\"261\" _=\"SVGText\" style=\"user-select: none;\">6</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"261\" cy=\"261\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"261\" y=\"261\" _=\"SVGText\" style=\"user-select: none;\">7</text></g></g></g></svg>\n\n\u60c5\u51b53: \u6839\u4e0d\u5728$x$\u5b50\u6811\u5185: \u4e0e\u666e\u901a\u6811\u94fe\u5256\u5206\u4e00\u6837\n\n\u7ebf\u6bb5\u6811\u7248:\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n#define N 100011\nint n,cnt=0,RT=1,head[N],c[N];\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint a[N];\nll s[N<<2],laz[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=s[ls]+s[rs]\nvoid pd(int rt,int ln,int rn){\n    if(laz[rt]){\n        laz[ls]+=laz[rt];\n        laz[rs]+=laz[rt];\n        s[ls]+=ln*laz[rt];\n        s[rs]+=rn*laz[rt];\n        laz[rt]=0;\n    }\n}\nvoid build(int l,int r,int rt){\n    if(l==r){\n        s[rt]=a[l];\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu;\n}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt]+=v*(r-l+1);\n        laz[rt]+=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    pu;\n}\nll ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1;\n    ll ans=0;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans+=ask(L,R,m+1,r,rs);\n    return ans;\n}\nint son[N],siz[N],top[N],id[N],f[N],d[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;\n    son[x]=0;\n    fl(i,x){\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;a[id[x]]=c[x];\n    if(!son[x])return;\n    bt(son[x],tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nll fh(int x,int y){\n    ll ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        ans+=ask(id[top[x]],id[x],1,n,1);x=f[top[x]];\n    }\n    if(id[x]>id[y])swap(x,y);\n    return ans+ask(id[x],id[y],1,n,1);\n}\nvoid ul(int x,int y,int k){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        upd(id[top[x]],id[x],k,1,n,1);x=f[top[x]];\n    }\n    if(id[x]>id[y])swap(x,y);\n    upd(id[x],id[y],k,1,n,1);\n}\nint child(int x,int y){\n    while(top[x]!=top[y]){\n        x=top[x];\n        if(f[x]==y)return x;\n        x=f[x];\n    }\n    return son[y];\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",&c[i]);\n    int q,x,y,opt,k;\n    for(int i=2;i<=n;++i)\n        scanf(\"%d\",&f[i]),add(f[i],i);\n    dfs(1);bt(1,1);\n    build(1,n,1);\n    scanf(\"%d\",&q);\n    while(q--){\n        scanf(\"%d%d\",&opt,&x);\n        if(opt==1)RT=x;\n        if(opt==2)scanf(\"%d%d\",&y,&k),ul(x,y,k);\n        if(opt==3){\n            scanf(\"%d\",&k);\n            if(x==RT)upd(1,n,k,1,n,1);\n            else if(id[x]<=id[RT]&&id[RT]+siz[RT]<=id[x]+siz[x]){\n                int t=child(RT,x);\n                upd(1,n,k,1,n,1);\n                upd(id[t],id[t]+siz[t]-1,-k,1,n,1);\n            }\n            else upd(id[x],id[x]+siz[x]-1,k,1,n,1);\n        }\n        if(opt==4)scanf(\"%d\",&y),printf(\"%lld\\n\",fh(x,y));\n        if(opt==5){\n            if(x==RT)printf(\"%lld\\n\",s[1]);\n            else if(id[x]<=id[RT]&&id[RT]+siz[RT]<=id[x]+siz[x]){\n                int t=child(RT,x);\n                printf(\"%lld\\n\",s[1]-ask(id[t],id[t]+siz[t]-1,1,n,1));\n            }\n            else printf(\"%lld\\n\",ask(id[x],id[x]+siz[x]-1,1,n,1));\n        }\n    }\n}\n```\n\n\u6811\u72b6\u6570\u7ec4\u7248\uff1a\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#pragma GCC optimize(Ofast)\n#define il inline\nil void SWAP(int &x,int &y){int t=x;x=y;y=t;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\n#define ll long long\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\nint n,cnt=0,RT=1,head[N],c[N];\nstruct edge{\n    int to,nxt;\n}e[N];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nll s[N],S[N];\nil void upd(int x,int v){\n    if(x<=n)\n    for(int i=x;i<=n;i+=i&-i)\n        s[i]+=v,\n        S[i]+=1ll*v*(x-1);\n}\nil ll ask(int x){\n    ll ans=0;\n    for(int i=x;i;i-=i&-i)\n        ans+=1ll*x*s[i]-S[i];\n    return ans;\n}\nil void upd(int l,int r,int v){upd(l,v);upd(r+1,-v);}\nil ll ask(int l,int r){return ask(r)-ask(l-1);}\nint son[N],siz[N],top[N],id[N],f[N],d[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;\n    son[x]=0;\n    fl(i,x){\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;\n    if(!son[x])return;\n    bt(son[x],tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nll fh(int x,int y){\n    ll ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans+=ask(id[top[x]],id[x]);x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    return ans+ask(id[x],id[y]);\n}\nvoid ul(int x,int y,int k){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        upd(id[top[x]],id[x],k);x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    upd(id[x],id[y],k);\n}\nil int child(int x,int y){\n    while(top[x]!=top[y]){\n        x=top[x];\n        if(f[x]==y)return x;\n        x=f[x];\n    }\n    return son[y];\n}\nint main(){\n    in(n);\n    for(int i=1;i<=n;++i)in(c[i]);\n    int q,x,y,opt,k;\n    for(int i=2;i<=n;++i)\n        in(f[i]),add(f[i],i);\n    dfs(1);bt(1,1);\n    for(int i=1;i<=n;++i)upd(id[i],id[i],c[i]);\n    in(q);\n    while(q--){\n        in(opt,x);\n        if(opt==1)RT=x;\n        if(opt==2)in(y,k),ul(x,y,k);\n        if(opt==3){\n            in(k);\n            if(x==RT)upd(1,n,k);\n            else if(id[x]<=id[RT]&&id[RT]+siz[RT]<=id[x]+siz[x]){\n                int t=child(RT,x);\n                upd(1,k);\n                upd(id[t],id[t]+siz[t]-1,-k);\n            }\n            else upd(id[x],id[x]+siz[x]-1,k);\n        }\n        if(opt==4)in(y),out(fh(x,y),ln);\n        if(opt==5){\n            if(x==RT)out(ask(n),ln);\n            else if(id[x]<=id[RT]&&id[RT]+siz[RT]<=id[x]+siz[x]){\n                int t=child(RT,x);\n                out(ask(n)-ask(id[t],id[t]+siz[t]-1),ln);\n            }\n            else out(ask(id[x],id[x]+siz[x]-1),ln);\n        }\n    }\n    flush();\n}\n```", "link": "/posts/\u6362\u6839\u6811\u94fe\u5256\u5206/", "tags": ["\u6570\u636e\u7ed3\u6784", "\u6811", "\u6280\u5de7"], "categories": [["\u7b97\u6cd5", "\u6811\u8bba"], ["note"]]}, {"title": "\u659c\u7387\u4f18\u5316", "content": "\u5bf9\u4e8e\u7c7b\u4f3c$f_i=\\min_{j=1}^{i-1}f_j+val(i,j)$\u7684\u65b9\u7a0b\n\n\u6bd4\u5982$val(i,j)=a_i\\times b_j$,\u540c\u65f6\u5305\u542b\u4e86$i,j$\u4e24\u4e2a\u53d8\u91cf,\n\n\u8fd9\u6837\u6ca1\u6cd5\u76f4\u63a5\u7528\u5355\u8c03\u961f\u5217\n\n\u5982\u679c\u628a$val(i,j)$\u5c55\u5f00\u80fd\u8f6c\u5316\u6210$\\frac{y_{j1}-y_{j2}}{x_{j1}-x_{j2}}\\le k_i$\n\n\u5982\u679c\u6211\u4eec\u5c06\u6bcf\u4e2a\u51b3\u7b56\u70b9\u770b\u6210$(x_j,y_j)$\u5206\u5e03\u5728\u5750\u6807\u7cfb\u4e0a,\u771f\u6b63\u6709\u7528\u7684\u51b3\u7b56\u70b9\u5c31\u4f1a\u5f62\u6210\u51f8\u58f3(\u53ef\u4ee5\u4f7f\u7528 \u5355\u8c03\u961f\u5217 or \u6570\u636e\u7ed3\u6784 \u6765\u7ef4\u62a4)\n\n(\u5176\u5b9e\u659c\u7387\u4f18\u5316dp\u4e5f\u53eb\u51f8\u58f3\u4f18\u5316dp)\n\n\u5b9e\u73b0\u4e3b\u8981\u770b\u4f8b\u9898\n\n\u5173\u4e8e\u4e0a\u4e0b\u51f8\u58f3\uff1a\n\n\u5982\u679c\u662f$k_i\\le\\frac ab$\u7684\u5f62\u5f0f\u662f\u4e0b\u51f8\u58f3\n\n$k_i\\ge\\frac ab$\u5426\u5219\u662f\u4e0a\u51f8\u58f3\n\n## \u4f8b\u9898\n\n[[HNOI2008]\u73a9\u5177\u88c5\u7bb1TOY](https://www.luogu.com.cn/problem/P3195)\n\n[[APIO2014]\u5e8f\u5217\u5206\u5272](https://www.luogu.com.cn/problem/P3648)\n\n[[APIO2010]\u7279\u522b\u884c\u52a8\u961f](https://www.luogu.com.cn/problem/P3628)\n\n[LG 2365 \u4efb\u52a1\u5b89\u6392](https://www.luogu.com.cn/problem/P2365)\n\n[[SDOI2012]\u4efb\u52a1\u5b89\u6392](https://www.luogu.com.cn/problem/P5785)(\u6240\u5f97\u7684\u76f4\u7ebf\u7684\u659c\u7387\u4e0d\u662f\u5355\u8c03\u7684,\u9700\u8981\u51f8\u58f3\u4e8c\u5206)\n\n[[USACO08MAR]\u571f\u5730\u5f81\u7528Land Acquisition](https://www.luogu.com.cn/problem/P2900)\n\n", "link": "/posts/\u659c\u7387\u4f18\u5316/", "tags": ["\u6570\u8bba", "\u7b97\u6cd5", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u7b97\u6cd5", "\u52a8\u6001\u89c4\u5212"], ["\u7b97\u6cd5", "\u6280\u5de7"], ["note"]]}, {"title": "\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f", "content": "# \u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\n\n## \u5b9a\u4e49\n\n\u5bf9\u4e8e\u4efb\u610f$a_1\\le a_2<b_1\\le b_2$,\u6ee1\u8db3$m[a_1,b_1]+m[a_2,b_2]\\le m[a_1,b_2]+m[a_2,b_1]$\n \n\u90a3\u4e48$m[i,j]$\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\n\n> \u8981\u8bc1\u660e$m[i,j]$\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u53ef\u4ee5\u7528~~\u6253\u8868~~\u6216\u6570\u5b66\u5f52\u7eb3\u6cd5\n\n## \u533a\u95f4\u7c7b2D1D\u52a8\u6001\u89c4\u5212\u5e94\u7528\n\n\u8bbe$m[i,j]$\u4e3a\u52a8\u6001\u89c4\u5212\u4e2d\u533a\u95f4$[i,j]$\u7684\u7b54\u6848\n\n\u4e00\u822c\u662f$m[i,j]=\\min(m[i,k]+m[k,j])(k\\in [i,j])$,\u5f53\u7136$\\max$\u6216\u5176\u4ed6\u7684\u4e5f\u53ef\u4ee5\n\n\u4f18\u5316\u7684\u524d\u63d0\u662f\uff1a**m\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f**\n\n\u4e00\u822c\u7684\u533a\u95f4$dp$\u7684\u590d\u6742\u5ea6\u662f$\\Theta(n^3)$\n\n\u6211\u4eec\u53ef\u4ee5\u4f18\u5316\u4e3a$\\Theta(n^2)$\n\n\u5b9a\u4e49$s[i,j]$\u4e3a\u4f7f$m[i,j]$\u53d6\u5f97\u6700\u4f18\u89e3\u7684$k$\n\n\u53ef\u4ee5\u8bc1\u660e:$s[i,j-1]\\le s[i,j]\\le s[i+1,j]$\n\n\u90a3\u4e48$m[i,j]=\\min(m[i,k]+m[k,j])(k\\in [s[i,j-1],s[i+1,j]])$\n\n### \u590d\u6742\u5ea6\u5206\u6790\uff1a\n\n\u5047\u8bbe\u6211\u4eec\u73b0\u5728\u8981\u6c42$m[i,i+L]$,\n\n\u90a3\u4e48\u6211\u4eec\u8981\u679a\u4e3e\u7684\u6b21\u6570\u662f\uff1a\n\n$(s[2,L+1]-s[1,L])+(s[3,L+2]-s[2,L+1])+\u2026+(s[n-L+1,n]-s[n-L,n-1])=s[n-L+1,n]-s[1,L]\\le n$\n\n\u6240\u4ee5\u603b\u590d\u6742\u5ea6\u662f$\\Theta(n)$\n\n### \u8bc1\u660e\uff1a\n\n\u5bf9\u4e0a\u8ff0$s[i,j-1]\\le s[i,j]\\le s[i+1,j]$\u7684\u8bc1\u660e\uff1a\n\n\n\u8bbe$mk[i,j]=m[i,k]+m[k,j],s[i,j]=d$\n\n\u5bf9\u4e8e\u4efb\u610f$k<d$,\u6709$mk[i,j]\\ge md[i,j]$\n\n(\u8fd9\u91cc\u4ee5$m[i,j]=\\min(m[i,k]+m[k,j])$\u4e3a\u4f8b)\n\n\u63a5\u4e0b\u6765\u53ea\u8981\u8bc1\u660e$mk[i+1,j]\\ge md[i+1,j]$,\n\n\u90a3\u4e48\u53ea\u6709\u5f53$s[i+1,j]\\ge s[i,j]$\u65f6\u624d\u6709\u53ef\u80fd\u6709$mk[i+1,j]\\ge md[i+1,j]$\n\n$$\n(mk[i+1,j]-md[i+1,j])-(mk[i,j]-md[i,j])\n\\\\\n=(mk[i+1,j]+md[i,j])-(md[i+1,j]+mk[i,j])\n\\\\\n=(m[i+1,k]+m[k,j]+m[i,d]+m[d,j])\n\\\\\n-(m[i+1,d]+m[d,j]+m[i,k]+m[k,j])\n\\\\\n=(m[i+1,k]+m[i,d])-(m[i+1,d]+m[i,k])\n$$\n\n$\\because m$\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\n\n\u5bf9\u4e8e$i<i+1\\le k<d$\u6709$m[i+1,k]+m[i,d]\\ge m[i+1,d]+m[i,k]$\n\n$\\therefore (mk[i+1,j]-md[i+1,j])\\ge(mk[i,j]-md[i,j])\\ge 0$\n\n$\\therefore s[i,j]\\le s[i+1,j]$,\u540c\u7406\u53ef\u8bc1$s[i,j-1]\\le s[i,j]$\n\u8bc1\u6bd5\n\n### \u4f8b\u9898\uff1a\n\n[[NOI1995]\u77f3\u5b50\u5408\u5e76](https://www.luogu.com.cn/problem/P1880)\n\n\n## 1D1D \u52a8\u6001\u89c4\u5212\u4e2d\u7684\u5e94\u7528\n\n\u8003\u8651$f_r=\\min(f_l+w(l+1,r))(l\\in [1,r-1])$\n\n\u82e5$w(l,r)$\u6ee1\u8db3\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f,\n\n\u8bbe$k_r$\u4e3a$f_r$\u7684\u6700\u4f18\u51b3\u7b56\u70b9,\u5219\u6709\uff1a\n\n$\\forall r_1\\le r_2 : k_{r_1} \\le k_{r_2}$\n\n~~\u8bc1\u660e\u7565~~\n\n\u8fd9\u4e9b\u4e5f\u53ef\u4ee5\u770b\u4f5c\u5177\u6709**\u51b3\u7b56\u5355\u8c03\u6027**\n\n\u4f46\u662f\u6211\u4eec\u53ea\u80fd\u77e5\u9053\u679a\u4e3e\u7684\u4e0b\u754c,\u4e0d\u80fd\u77e5\u9053\u4e0a\u754c\n\n\u6211\u4eec\u53ef\u4ee5\u91c7\u7528\u5206\u6cbb\u7b97\u6cd5\u6765\u89e3\u51b3\n\n\u8bbe$work(l,r,k_l,k_r)$\u8868\u793a\u6c42\u89e3$f_l\uff5ef_r$,\u5e76\u77e5\u9053\u6700\u4f18\u51b3\u7b56\u70b9\u5728$[k_l,k_r]$\n\n\u7c7b\u4f3c\u4e0b\u65b9\u4ee3\u7801\uff1a\n\n```cpp\nvoid work(int l,int r,int kl,int kr){\n    int m=(l+r)>>1,k=kl;\n    for(int i=kl;i<=min(kr,m-1);++i)\n    if(w(i,m)<w(k,m))i=k;\n    f[m]=w(k,m);\n    if(l<m)work(l,m-1,kl,k);\n    if(r>m)work(m+1,r,k,kr);\n}\n```\n\n\u590d\u6742\u5ea6\uff1a$\\Theta(n \\log n)$\n\n\u4e5f\u53ef\u4ee5\u4f7f\u7528**\u961f\u5217\u5b9e\u73b0\u51b3\u7b56\u4e8c\u5206\u6808**\n\n\u4ee5[\u300clG 3515\u300d\u300cloj2157\u300d\u300cPOI2011\u300dLightning Conductor](https://www.luogu.com.cn/problem/P3515)\u4e3a\u4f8b\uff1a\n\n> \u5bf9\u4e8e\u6bcf\u4e2a$j$,\u628a$a_j+\\sqrt{i-j}$\u770b\u6210\u5173\u4e8e$i$\u7684\u51fd\u6570$f_j$\u3002\n> \n> \u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u5728\u6240\u6709$j\\leq i$\u7684\u51fd\u6570\u4e2d\u627e\u5230\u6700\u503c\n> \n> \u961f\u5217\u5b9e\u73b0\u51b3\u7b56\u4e8c\u5206\u6808,\u6309$j$\u4ece\u5c0f\u5230\u5927\u4f9d\u6b21\u7ef4\u62a4\u8fd9\u4e9b\u51fd\u6570\u3002\n> \n> \u5bf9\u4e8e\u5176\u4e2d\u4efb\u610f\u4e24\u4e2a\u76f8\u90bb\u7684\u51fd\u6570$f_t,f_{t+1}$ ,\u5b83\u4eec\u90fd\u6709\u4e00\u4e2a\u4e34\u754c> \u503c$k_{t,t+1}$\n> \n> \u663e\u7136\u5e8f\u5217\u4e2d\u7684$k_{1,2},k_{2,3}...$\u4e5f\u8981\u4e25\u683c\u9012\u589e\u3002\n> \n> \u5426\u5219,\u5982\u679c$k_{t,t+1}\\ge k_{t+1,t+2}$,$f_{t+1}$\u6839\u672c\u6ca1\u6709> \u7528\u3002\n> \n> \u6bcf\u6b21\u52a0\u5165$f_i$\u7684\u65f6\u5019\uff1a\n> \n> \u8bbe\u961f\u5c3e\u4e3a$t$,\u5982\u679c\u5f53\u524d$i$\u6bd4$t$\u4f18($calc(k_{t-1},i)\\ge > calc(k_{t-1},t)$),\u90a3\u4e48\u5f39\u51fa$t$\n> \n> \u73b0\u5728\u6765\u8003\u8651\u961f\u5934$h$\n> \n> \u82e5$k_h\\le i$\u90a3\u4e48\u628a$h$\u5f39\u51fa\n\n### \u4f8b\u9898\n\n[\u300clG 3515\u300d\u300cloj2157\u300d\u300cPOI2011\u300dLightning Conductor](https://www.luogu.com.cn/problem/P3515)\n\n[[JSOI2011]\u67e0\u6aac](https://www.luogu.com.cn/problemnew/show/P5504)\n\n\u4e0a\u8ff0\u9898\u76ee\u53ef\u53c2\u8003\u6211\u7684\u9898\u89e3\u5e93https://zt.zcmimi.top\n\n> \u53c2\u8003\u6587\u732e\uff1a\n> \n> https://baike.baidu.com/item/\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f/7556574\n> \n> https://oi-wiki.org/dp/opt/quadrangle/\n> \n> https://www.luogu.com.cn/blog/flashblog/solution-p3515", "link": "/posts/\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u6280\u5de7", "\u6570\u8bba"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["\u7b97\u6cd5", "\u6280\u5de7"], ["note"]]}, {"title": "\u57fa\u73af\u6811", "content": "\u5f62\u6001: \u5728\u4e00\u68f5\u6811\u4e0a\u52a0\u591a\u4e00\u6761\u8fb9\n\n\u5b9e\u73b0:\n\n\u627e\u51fa\u73af\u540e\u4e00\u6b21\u5904\u7406\u73af\u4e0a\u6bcf\u4e2a\u70b9\u7684\u5b50\u6811,\u7136\u540e\u518d\u5904\u7406\u73af\n\n## [IOI 2008]Island(\u6c42\u57fa\u73af\u6811\u76f4\u5f84)\n\n[IOI 2008 Island](https://www.luogu.com.cn/problem/P4381)\n\n\u5148\u627e\u51fa\u73af,\u628a\u73af\u5f53\u6839\u8282\u70b9,\u627e\u51fa\u6bcf\u68f5\u5b50\u6811\u7684\u76f4\u5f84\u548c\u6700\u5927\u6df1\u5ea6$d_x$\n\n\u63a5\u7740\u5c31\u8981\u5728\u73af\u4e0a\u627e\u5230\u4e24\u70b9$x,y$\u4f7f$d_x+dis(x,y)+d_y$\u6700\u5927\n\n\u53ef\u4ee5\u7834\u73af\u540e\u7528\u5355\u8c03\u961f\u5217$\\mathcal O(n)$\u5904\u7406\n\n```cpp\n#include<cstdio>\nconst int N=1000011;\n#define ll long long\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\ninline ll max(ll x,ll y){return x>y?x:y;}\nint n,cnt=0,head[N],dfn[N],sz=0,pre[N],tt[N],tot=0,q[N];\nbool b[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<1];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n}\nvoid dfs(int x){\n    dfn[x]=++sz;\n    fl(i,x)if(to!=pre[x]){\n        if(dfn[to]){\n            if(dfn[to]<dfn[x])continue;\n            b[tt[++tot]=x]=1;\n            for(int y=to;y!=x;y=pre[y])b[tt[++tot]=y]=1;\n        }\n        else pre[to]=x,dfs(to);\n    }\n}\nll f[N],d[N],s[N],ans=0;\nvoid dp(int x,int fa){\n    fl(i,x)if(to!=fa&&!b[to]){\n        dp(to,x);\n        f[x]=max(f[x],max(f[to],d[x]+d[to]+e[i].w));\n        d[x]=max(d[x],d[to]+e[i].w);\n    }\n}\nvoid work(int x){\n    ll tmp=0;\n    tot=0;\n    dfs(x);\n    tt[tot+1]=tt[1];\n    int p=0;\n    for(int i=1;i<=tot;++i)\n        fl(j,tt[i])if(to==tt[i+1])\n            s[++p]=e[j].w;\n    for(int i=1;i<=tot+1;++i)\n        tt[i+tot]=tt[i],s[i+tot]=s[i];\n    for(int i=2;i<=tot*2;++i)s[i]+=s[i-1];\n    for(int i=1;i<=tot;++i)dp(tt[i],0),tmp=max(tmp,max(f[tt[i]],d[tt[i]]));\n    int h=1,t=0;\n    for(int i=1;i<=tot*2;++i){\n        while(h<=t&&i-q[h]>=tot)++h;\n        if(h<=t)tmp=max(tmp,d[tt[i]]+d[tt[q[h]]]+s[i-1]-s[q[h]-1]);\n        while(h<=t&&d[tt[i]]-s[i-1]>=d[tt[q[t]]]-s[q[t]-1])--t;\n        q[++t]=i;\n    }\n    ans+=tmp;\n}\nint main(){\n    scanf(\"%d\",&n);\n    int y,w;\n    for(int i=1;i<=n;++i)\n        scanf(\"%d%d\",&y,&w),\n        add(i,y,w),add(y,i,w);\n    for(int i=1;i<=n;++i)if(!dfn[i])work(i);\n    printf(\"%lld\\n\",ans);\n}\n```\n\n## \u521b\u4e16\u7eaa(\u57fa\u73af\u6811dp)\n\n[\u521b\u4e16\u7eaa](https://www.acwing.com/problem/content/361/)\n\n\u4e24\u6b21dp\u89e3\u51b3\u4ee3\u66ff\u57fa\u73af\u6811dp\n\n\u6240\u6709\u7684$A_i\\rightarrow i$\u6784\u6210\u4e86\u4e00\u68f5\u57fa\u73af\u6811\n\n\u6211\u4eec\u5148\u8003\u8651\u5982\u679c\u57fa\u73af\u6811\u7684\u5b50\u6811\u600e\u4e48\u505a\n\n\u4e5f\u5c31\u662f\u6811\u578bdp\n\n($f_x$\u8868\u793a\u4e0d\u653e,$g_x$\u8868\u793a\u653e)\n\n\u82e5\u5143\u7d20$i$\u4e0d\u6295\u653e,\n\n$$f_x=\\sum_{A_y=x}\\max(f_y,g_y)$$\n\n\u5426\u5219\u5fc5\u987b\u81f3\u5c11\u6709\u4e00\u4e2a\u5143\u7d20\u9650\u5236$i$,\u4e0d\u80fd\u6295\u653e\n\n$$g_x=\\max_{A_y=x}\\{f_y+\\sum_{A_z=x,z\\not = y}\\max(f_z,g_z)\\}$$\n\n\u627e\u5230\u73af\u4e0a\u7684\u4e00\u4e2a\u70b9,\u5c06\u5b83\u548c\u5b83\u9650\u5236\u7684\u90a3\u4e2a\u70b9\u65ad\u5f00,\u5148\u540e\u8fdb\u884c\u4e24\u6b21\u6811\u5f62dp,\n\n\u7b2c\u4e00\u6b21\u662f\u5047\u8bbe\u73af\u4e0a\u7684\u8fd9\u4e2a\u70b9\u5bf9\u5176\u9650\u5236\u7684\u70b9\u4e0d\u8d77\u9650\u5236\u4f5c\u7528\n\n\u53e6\u5916\u4e00\u6b21\u662f\u5f3a\u5236\u73af\u4e0a\u90a3\u4e2a\u70b9\u5df2\u7ecf\u9650\u5236\u4e86\u5176\u53ef\u4ee5\u9650\u5236\u7684\u70b9\uff08\u4e5f\u5c31\u662f\u73af\u4e0a\u90a3\u4e2a\u70b9\u4e0d\u9009\uff09\n\n```cpp\n#include<cstdio>\nint max(int x,int y){return x>y?x:y;}\nint min(int x,int y){return x<y?x:y;}\nconst int N=1000011;\nint n,cnt=0,head[N],A[N],f[N],g[N],RT;\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nbool v[N];\nvoid dp(int x){\n    v[x]=1;f[x]=0;\n    int res=1<<30;\n    fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    if(to!=RT){\n        dp(to);\n        f[x]+=max(f[to],g[to]);\n        res=min(res,max(g[to]-f[to],0));\n    }\n    g[x]=f[x]+1-res;\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",A+i),add(A[i],i);\n    int ans=0;\n    for(int i=1;i<=n;++i)\n    if(!v[i]){\n        int res=0;\n        RT=i;\n        while(!v[A[RT]]){\n            v[RT]=1;\n            RT=A[RT];\n        }\n        dp(RT);\n        res=max(f[RT],g[RT]);\n        RT=A[RT];\n        dp(RT);\n        ans+=max(res,max(f[RT],g[RT]));\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n\n## [ZJOI2008]\u9a91\u58eb(\u57fa\u73af\u6811dp)\n\n\u5c06\u4e00\u4e2a\u9a91\u58eb\u4e0e\u4ed6\u6700\u75db\u6068\u7684\u4eba\u8fde\u8fb9\n\n\u5148\u8003\u8651\u8fd9\u4e2a\u5982\u679c\u662f\u6811\u578bdp\uff1a\n\n$f_x$\u8868\u793a\u4e0d\u53d6$x$,$g_x$\u8868\u793a\u53d6$x$\n\n$$\nf_x=\\sum \\max(f_{to},g_{to})\n\\\\\ng_x=\\sum f_{to}\n$$\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u6b21\u6811\u578bdp\u4ee3\u66ff\u57fa\u73af\u6811dp\n\n\u7b2c\u4e00\u6b21\uff1a \u9009\u62e9$x$,\u4e0d\u9009\u62e9$x$\u6700\u75db\u6068\u7684\u4eba\n\n\u7b2c\u4e00\u6b21\uff1a \u9009\u62e9$x$\u6700\u75db\u6068\u7684\u4eba,\u4e0d\u9009\u62e9$x$\n\n```cpp\n#include<cstdio>\nint max(int x,int y){return x>y?x:y;}\nconst int N=1000011;\nint n,cnt=0,head[N],val[N],a[N],rt;\nlong long f[N],g[N],ans=0,res,inf=1ll<<60;\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nbool v[N];\nvoid dp(int x){\n    f[x]=0;g[x]=val[x];\n    v[x]=1;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    if(to!=rt){\n        dp(to);\n        f[x]+=max(f[to],g[to]);\n        g[x]+=f[to];\n    }\n    else g[to]=-inf;\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)\n        scanf(\"%d%d\",val+i,a+i),add(a[i],i);\n    for(int i=1;i<=n;++i)\n    if(!v[i]){\n        rt=i;\n        res=0;\n        while(!v[a[rt]]){\n            v[rt]=1;\n            rt=a[rt];\n        }\n        dp(rt);//\u5f3a\u5236\u9009i\n        res=max(f[rt],g[rt]);\n        rt=a[rt];\n        dp(rt);//\u5f3a\u5236\u9009a[i]\n        ans+=max(res,max(f[rt],g[rt]));\n    }\n    printf(\"%lld\\n\",ans);\n}\n```", "link": "/posts/\u57fa\u73af\u6811/", "tags": ["\u7b97\u6cd5", "\u6280\u5de7", "\u57fa\u73af\u6811"], "categories": [["\u7b97\u6cd5", "\u6811\u8bba"], ["note"]]}, {"title": "kruskal\u91cd\u6784\u6811", "content": "## kruskal\u91cd\u6784\u6811\n\n\u6211\u4eec\u56de\u60f3\u4e00\u4e0b$kruskal$\u751f\u6210\u6700\u5c0f\u751f\u6210\u6811\u7684\u8fc7\u7a0b\uff1a\n\n\u5148\u5c06\u8fb9\u6309\u8fb9\u6743\u4ece\u5c0f\u5230\u5927\u6392\u5e8f,\u7136\u540e\u4f9d\u6b21\u52a0\u5165\n\n\u5982\u679c$x,y$\u5df2\u7ecf\u8054\u901a,\u5219\u8df3\u8fc7\u8fd9\u6761\u8fb9\n\n\u5426\u5219\u8fde\u63a5$x,y$\n\n$kruskal$\u91cd\u6784\u6811\u662f\u5728$kruskal$\u751f\u6210\u6700\u5c0f\u751f\u6210\u6811\u7684,\n\n\u8fde\u63a5$x,y$\u65f6,\u5c06\u8fb9\u6743\u53d8\u6210\u4e00\u4e2a\u65b0\u7684\u8282\u70b9$t$\u6743\u503c\u4e3a\u8fb9\u6743,\u7136\u540e\u8fde\u8fb9$t\\rightarrow x,t\\rightarrow y$\n\n\u4ee3\u7801\uff1a\n\n```cpp\nvoid kruskal(){\n    int x,y,tt=n;\n    sort(E+1,E+m+1);//\u5c06\u8fb9\u6392\u5e8f\n    Fur(i,1,n)fa[i]=i;\n    Fur(i,1,m){\n        x=gf(E[i].x),y=gf(E[i].y);\n        if(x==y)continue;//\u5982\u679c\u5df2\u7ecf\u8054\u901a\u5219\u8df3\u8fc7\n        ne[++tt]=E[i].w;//\u70b9\u6743\u8d4b\u503c\u4e3a\u8fb9\u6743\n        fa[x]=fa[y]=fa[tt]=tt;\n        f[0][x]=f[0][y]=tt;\n        //\u7ef4\u62a4\u5e76\u67e5\u96c6\n        add(tt,x);add(tt,y);//\u8fde\u8fb9t\u2192x,t\u2192y\n    }\n}\n```\n\n$kruskal$\u91cd\u6784\u6811\u8fd8\u6709\u5f88\u591a\u6709\u610f\u601d\u7684\u6027\u8d28\n\n0. ~~\u539f\u6811\u7684\u8282\u70b9\u4e2a\u6570\u53d8\u62102n-1\u4e2a~~\n1. \u662f\u4e00\u4e2a\u4e8c\u53c9\u6811\n2. **\u5982\u679c\u662f\u6309\u6700\u5c0f\u751f\u6210\u6811\u5efa\u7acb\u7684\u8bdd\u662f\u4e00\u4e2a\u5927\u6839\u5806**\n3. \u4efb\u610f\u4e24\u4e2a\u70b9\u8def\u5f84\u4e0a\u8fb9\u6743\u7684\u6700\u5927\u503c\u4e3a\u5b83\u4eec\u7684LCA\u7684\u70b9\u6743\n4. \u91cd\u6784\u6811\u4e2d\u4ee3\u8868\u539f\u6811\u4e2d\u7684\u70b9\u7684\u8282\u70b9\u5168\u662f\u53f6\u5b50\u8282\u70b9,\u5176\u4f59\u8282\u70b9\u90fd\u4ee3\u8868\u4e86\u4e00\u6761\u8fb9\u7684\u8fb9\u6743\u3002\n\n## \u4f8b\u9898\uff1a\n\n### LG 4197 Peaks\n\n[LG 4197 Peaks](https://www.luogu.com.cn/problem/P4197)\n\n\u9898\u610f\uff1a\n\n\u5728Bytemountains\u6709$n$\u5ea7\u5c71\u5cf0,\u6bcf\u5ea7\u5c71\u5cf0\u6709\u4ed6\u7684\u9ad8\u5ea6$h_i$\u3002\u6709\u4e9b\u5c71\u5cf0\u4e4b\u95f4\u6709\u53cc\u5411\u9053\u8def\u76f8\u8fde,\u5171$m$\u6761\u8def\u5f84,\u6bcf\u6761\u8def\u5f84\u6709\u4e00\u4e2a\u56f0\u96be\u503c,\u8fd9\u4e2a\u503c\u8d8a\u5927\u8868\u793a\u8d8a\u96be\u8d70\u3002\n\n\u73b0\u5728\u6709$q$\u7ec4\u8be2\u95ee,\u6bcf\u7ec4\u8be2\u95ee\u8be2\u95ee\u4ece\u70b9$v$\u5f00\u59cb\u53ea\u7ecf\u8fc7\u56f0\u96be\u503c\u5c0f\u4e8e\u7b49\u4e8e$x$\u7684\u8def\u5f84\u6240\u80fd\u5230\u8fbe\u7684\u5c71\u5cf0\u4e2d\u7b2c$k$\u9ad8\u7684\u5c71\u5cf0,\u5982\u679c\u65e0\u89e3\u8f93\u51fa$-1$\n\n\u9898\u89e3\uff1a\n\n\u53ef\u4ee5\u7b97\u662f$kruskal$\u91cd\u6784\u6811\u7684\u6a21\u677f\u9898\n\n\u5efa\u5b8c$kruskal$\u91cd\u6784\u6811,\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u8282\u70b9(\u65b0\u5efa\u7684\u5e26\u70b9\u6743\u7684\u70b9)\u80fd\u8d70\u5230\u7684\u8282\u70b9\u4e00\u5b9a\u5728\u5b83\u7684\u5b50\u6811\u4e2d\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u7528$dfs$\u5e8f+\u4e3b\u5e2d\u6811\u7ef4\u62a4\n\n\u7ed9\u51fa\u91cd\u6784\u540e\u7684\u56fe(\u5e2e\u52a9\u7406\u89e3)\uff1a\n\n![](tree.png)\n\n(\u7ea2\u8272\u7684\u662f\u539f\u6765\u7684\u8282\u70b9)\n\n\u53ef\u4ee5\u500d\u589e\u6c42\u51fa\u6700\u8fdc\u7684\u6ee1\u8db3\u8981\u6c42\u7684\u7956\u5148\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define Fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define l2(n) ((int)(log2(n)))\n#define inf 2122219134\nil int MIN(int x,int y){return x<y?x:y;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\n#define N 200011\nint n,m,q,SZ=0,rt[N];\nstruct node{\n    int v,p;\n    il bool operator<(node x){return v<x.v;}\n}b[N];\nint a[N],c[N];\nstruct link{\n    int x,y,w;\n    il bool operator<(link x){return w<x.w;}\n}E[500011];\nvoid init(){\n    in(n,m,q);\n    Fur(i,1,n)in(b[i].v),b[i].p=i;\n    sort(b+1,b+n+1);\n    b[0].v=-inf;\n    sort(b+1,b+n+1);\n    Fur(i,1,n){\n        SZ+=(b[i].v!=b[i-1].v);\n        c[a[b[i].p]=SZ]=b[i].v;\n    }\n    Fur(i,1,m)in(E[i].x,E[i].y,E[i].w);\n}\nint fa[N],f[21][N];\nint gf(int x){return (x==fa[x])?x:(fa[x]=gf(fa[x]));}\nstruct tree{\n    int s[N*20],sz=0,ls[N*20],rs[N*20];\n    void build(int l,int r,int &x){\n        s[x=++sz]=0;\n        if(l==r)return;\n        int m=(l+r)>>1;\n        build(l,m,ls[x]);\n        build(m+1,r,rs[x]);\n    }\n    void ins(int l,int r,int v,int &x,int pre){\n        x=++sz;\n        s[x]=s[pre]+1;\n        ls[x]=ls[pre];\n        rs[x]=rs[pre];\n        if(l==r)return;\n        int m=(l+r)>>1;\n        if(v<=m)ins(l,m,v,ls[x],ls[pre]);\n        else ins(m+1,r,v,rs[x],rs[pre]);\n    }\n    int ask(int l,int r,int k,int x,int y){\n        if(l==r)return l;\n        int m=(l+r)>>1,sum=s[rs[y]]-s[rs[x]];\n        if(k<=sum)return ask(m+1,r,k,rs[x],rs[y]);\n        else return ask(l,m,k-sum,ls[x],ls[y]);\n    }\n}T;\nint cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint L[N],R[N],dfn=0;\nvoid dfs(int x){\n    Fur(i,1,20)f[i][x]=f[i-1][f[i-1][x]];\n    L[x]=dfn;\n    if(!head[x]){\n        L[x]=++dfn;\n        T.ins(1,SZ,a[x],rt[dfn],rt[dfn-1]);\n        R[x]=dfn;\n        return;\n    }\n    fl(i,x)dfs(to);\n    R[x]=dfn;\n}\nint ne[N];\nvoid kruskal(){\n    int x,y,tt=n;\n    sort(E+1,E+m+1);\n    Fur(i,1,n)fa[i]=i;\n    Fur(i,1,m){\n        x=gf(E[i].x),y=gf(E[i].y);\n        if(x==y)continue;\n        ne[++tt]=E[i].w;\n        fa[x]=fa[y]=fa[tt]=tt;\n        f[0][x]=f[0][y]=tt;\n        add(tt,x);add(tt,y);\n    }\n    T.build(1,SZ,rt[0]);\n    dfs(tt);\n}\nvoid solve(){\n    int x,w,k;\n    while(q--){\n        in(x,w,k);\n        Fdr(i,20,0)if(f[i][x]&&ne[f[i][x]]<=w)x=f[i][x];\n        if(R[x]-L[x]<k)out(\"-1\\n\");\n        else out(c[T.ask(1,SZ,k,rt[L[x]],rt[R[x]])],ln);\n    }\n}\nint main(){\n    init();\n    kruskal();\n    solve();\n    flush();\n    return 0;\n}\n```\n\n### BZ 3732 Network\n\n\u9898\u610f\uff1a\n\n\u7ed9\u4f60$N$\u4e2a\u70b9\u7684\u65e0\u5411\u56fe $(1 <= N <= 15,000)$,\u8bb0\u4e3a\uff1a$1\u2026N$\u3002\n\u56fe\u4e2d\u6709$M$\u6761\u8fb9 $(1 <= M <= 30,000)$ ,\u7b2c$j$\u6761\u8fb9\u7684\u957f\u5ea6\u4e3a\uff1a $d_j ( 1 < = d_j < = 1,000,000,000)$.\n\n\u73b0\u5728\u6709 $K$\u4e2a\u8be2\u95ee $(1 < = K < = 20,000)$\u3002\n\u6bcf\u4e2a\u8be2\u95ee\u7684\u683c\u5f0f\u662f\uff1a$A$ $B$,\u8868\u793a\u8be2\u95ee\u4ece$A$\u70b9\u8d70\u5230$B$\u70b9\u7684\u6240\u6709\u8def\u5f84\u4e2d,\u6700\u957f\u7684\u8fb9\u6700\u5c0f\u503c\u662f\u591a\u5c11\uff1f\n\n\u66f4\u88f8\u7684kruskal\u91cd\u6784\u6811\u6a21\u677f\n\nkruskal\u91cd\u6784\u6811+lca+rmq\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define Fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define l2(n) ((int)(log2(n)))\n#define inf 2122219134\nil int MIN(int x,int y){return x<y?x:y;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\n#define N 30011\nint n,m,q,cnt=0,head[N],f[N],ne[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nstruct link{\n    int x,y,w;\n    il bool operator<(link x){return w<x.w;}\n}E[N];\nint gf(int x){return (x==f[x])?x:(f[x]=gf(f[x]));}\nint s[16][N];\nil void st(){\n    int sz=l2(n<<1);\n    Fur(k,1,sz)\n        Fur(i,1,(n<<1)-(1<<k)+1)\n        s[k][i]=MAX(s[k-1][i],s[k-1][i+(1<<(k-1))]);\n}\nil int ask(int l,int r){\n    int k=l2(r-l+1);\n    return MAX(s[k][l],s[k][r-(1<<k)+1]);\n}\nint top[N],d[N],siz[N],id[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x){\n        d[to]=d[x]+1;\n        f[to]=x;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;\n    s[0][sz]=ne[x];\n    int k=0;\n    fl(i,x)if(siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(to!=k)bt(to,to);\n}\nil int fh(int x,int y){\n    int ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans=MAX(ans,ask(id[top[x]],id[x]));x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    return MAX(ans,ask(id[x],id[y]));\n}\nint main(){\n    in(n),in(m),in(q);\n    int x,y,w,t=n;\n    Fur(i,1,m)in(E[i].x),in(E[i].y),in(E[i].w);\n    sort(E+1,E+m+1);\n    Fur(i,1,n)f[i]=i;\n    Fur(i,1,m){\n        x=gf(E[i].x),y=gf(E[i].y);\n        if(x==y)continue;\n        ne[++t]=E[i].w;\n        f[x]=f[y]=f[t]=t;\n        add(t,x),add(t,y);\n    }\n    dfs(t);\n    bt(t,t);\n    st();\n    while(q--)\n        in(x),in(y),\n        out(fh(x,y)),pt(ln);\n    flush();\n}\n```\n\n### NOI 2018 \u5f52\u7a0b\n\n[LG 4768](https://www.luogu.com.cn/problemnew/show/P4768)\n\n\u5148\u60f3\u60f3\u66b4\u529b\u505a\u6cd5\uff1a\n\nbfs\u51fa\u4e0d\u6d89\u6c34\u53ef\u4ee5\u5230\u8fbe\u7684\u70b9,\u7136\u540e\u5728\u8fd9\u4e9b\u70b9\u4e2d\u627e\u51fa\u4e0e\u70b9$1$\u7684\u6700\u5c0f\u8ddd\u79bb\n\n\u4f18\u5316\uff1a\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528kruskal\u91cd\u6784\u6811\u6765\u5feb\u901f\u6c42\u51fa\u8fd9\u4e9b\u70b9\n\n\u5148\u6309\u6d77\u62d4\u4ece\u9ad8\u5230\u4f4e\u6392\u5e8f,\u8fd9\u6837\u89c1\u51fa\u6765\u7684kruskal\u91cd\u6784\u6811\u7684\u662f\u6d77\u62d4\u7684\u5c0f\u6839\u5806\n\n\u6211\u4eec\u53ef\u4ee5\u500d\u589e\u627e\u51fa\u6700\u8fdc\u53ef\u4ee5\u5230\u8fbe\u7684\u7956\u5148,\u7136\u540e\u6c42\u51fa\u8fd9\u6bb5\u533a\u95f4\u4e2d\u7684\u70b9\u4e0e\u70b9$1$\u7684\u6700\u5c0f\u8ddd\u79bb\n\n\u53ef\u4ee5\u5728dfs\u7684\u65f6\u5019\u9884\u5904\u7406\n\n\u8be6\u89c1\u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define Fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define l2(n) ((int)(log2(n)))\n#define inf 2122219134\nil int MIN(int x,int y){return x<y?x:y;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,m,cnt=0,d[N<<1],head[N];\nstruct link{\n    int x,y,l,a;\n    il bool operator<(link b){return a>b.a;}\n}E[N<<1];\nstruct edge{int to,nxt,w;}e[N<<2];\nil void add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\nbool v[N];\nil void dij(){\n    struct cmp{il bool operator()(int x,int y){return d[x]>d[y];}};\n    priority_queue<int,vector<int>,cmp>q;\n    Fur(i,1,n)d[i]=inf;\n    d[1]=0;\n    q.push(1);\n    while(!q.empty()){\n        int x=q.top();v[x]=0;q.pop();\n        fl(i,x)if(d[x]+e[i].w<d[to]){\n            d[to]=d[x]+e[i].w;\n            if(!v[to])v[to]=1,q.push(to);\n        }\n    }\n}\nint fa[N<<1],ne[N<<1],f[21][N<<1];\nint gf(int x){return (x==fa[x])?x:(fa[x]=gf(fa[x]));}\nint ls[N<<1],rs[N<<1];\nvoid dfs(int x){\n    Fur(i,1,20)f[i][x]=f[i-1][f[i-1][x]];\n    if(!ls[x])return;\n    dfs(ls[x]),dfs(rs[x]);\n    d[x]=MIN(d[ls[x]],d[rs[x]]);\n}\nil void work(){\n    clr(head,0);cnt=0;\n    clr(ls,0);clr(rs,0);\n    in(n,m);\n    int x,y,l,a,t=n;\n    Fur(i,1,m){\n        in(x,y,l,a);\n        E[i]=link{x,y,l,a};\n        add(x,y,l);add(y,x,l);\n    }\n    dij();\n    sort(E+1,E+m+1);\n    Fur(i,1,n*2+1)fa[i]=i;\n    Fur(i,1,m){\n        x=gf(E[i].x),y=gf(E[i].y);\n        if(x==y)continue;\n        ne[++t]=E[i].a;\n        fa[x]=fa[y]=fa[t]=t;\n        f[0][x]=f[0][y]=t;\n        ls[t]=x;rs[t]=y;\n    }\n    dfs(t);\n    int Q,K,S,p,la=0;\n    in(Q,K,S);\n    while(Q--){\n        in(x,p);\n        x=(x+K*la-1)%n+1;\n        p=(p+K*la)%(S+1);\n        Fdr(i,20,0)if(f[i][x]&&ne[f[i][x]]>p)x=f[i][x];\n        out(la=d[x],ln);\n    }\n}\nint main(){\n    int T;in(T);\n    while(T--)work();\n    flush();\n}\n```\n\n### NOIP2013 \u8d27\u8f66\u8fd0\u8f93\n\n$A$\u56fd\u6709$n $\u5ea7\u57ce\u5e02,\u7f16\u53f7\u4ece $1 $\u5230$ n$,\u57ce\u5e02\u4e4b\u95f4\u6709 $m$ \u6761\u53cc\u5411\u9053\u8def\u3002\u6bcf\u4e00\u6761\u9053\u8def\u5bf9\u8f66\u8f86\u90fd\u6709\u91cd\u91cf\u9650\u5236,\u7b80\u79f0\u9650\u91cd\u3002\u73b0\u5728\u6709 $q$ \u8f86\u8d27\u8f66\u5728\u8fd0\u8f93\u8d27\u7269, \u53f8\u673a\u4eec\u60f3\u77e5\u9053\u6bcf\u8f86\u8f66\u5728\u4e0d\u8d85\u8fc7\u8f66\u8f86\u9650\u91cd\u7684\u60c5\u51b5\u4e0b,\u6700\u591a\u80fd\u8fd0\u591a\u91cd\u7684\u8d27\u7269\u3002\n\n### \u8f93\u5165\u683c\u5f0f\n\n\u7b2c\u4e00\u884c\u6709\u4e24\u4e2a\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00\u7684\u6574\u6570$ n,m$,\u8868\u793a $A$ \u56fd\u6709$ n$ \u5ea7\u57ce\u5e02\u548c $m$ \u6761\u9053\u8def\u3002\n\n\u63a5\u4e0b\u6765 $m$\u884c\u6bcf\u884c$ 3 $\u4e2a\u6574\u6570 $x, y, z$,\u6bcf\u4e24\u4e2a\u6574\u6570\u4e4b\u95f4\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00,\u8868\u793a\u4ece $x $\u53f7\u57ce\u5e02\u5230$ y $\u53f7\u57ce\u5e02\u6709\u4e00\u6761\u9650\u91cd\u4e3a $z$ \u7684\u9053\u8def\u3002\u6ce8\u610f\uff1a **$x$ \u4e0d\u7b49\u4e8e $y$,\u4e24\u5ea7\u57ce\u5e02\u4e4b\u95f4\u53ef\u80fd\u6709\u591a\u6761\u9053\u8def** \u3002\n\n\u63a5\u4e0b\u6765\u4e00\u884c\u6709\u4e00\u4e2a\u6574\u6570 q,\u8868\u793a\u6709 q \u8f86\u8d27\u8f66\u9700\u8981\u8fd0\u8d27\u3002\n\n\u63a5\u4e0b\u6765 q \u884c,\u6bcf\u884c\u4e24\u4e2a\u6574\u6570 x\u3001y,\u4e4b\u95f4\u7528\u4e00\u4e2a\u7a7a\u683c\u9694\u5f00,\u8868\u793a\u4e00\u8f86\u8d27\u8f66\u9700\u8981\u4ece x \u57ce\u5e02\u8fd0\u8f93\u8d27\u7269\u5230 y \u57ce\u5e02,\u6ce8\u610f\uff1a **x \u4e0d\u7b49\u4e8e y** \u3002\n\n\u9898\u89e3\uff1a\n\n~~\u53ef\u4ee5\u5f88\u660e\u663e\u5730\u770b\u51fa\u8fd9\u5c31\u662f\u6a21\u677f~~\n\nkruskal\u91cd\u6784\u6811+lca", "link": "/posts/kruskal\u91cd\u6784\u6811/", "tags": ["\u7b97\u6cd5", "\u6280\u5de7", "\u6811", "\u56fe\u8bba"], "categories": [["\u7b97\u6cd5", "\u56fe\u8bba"], ["\u7b97\u6cd5", "\u6811\u8bba"], ["\u7b97\u6cd5", "\u6280\u5de7"], ["note"]]}, {"title": "\u5212\u5206dp", "content": "# \u5212\u5206dp\n\n## \u9898\u610f\n\n\u6bcf\u7ec4\u8f93\u5165\u662f\u4e24\u4e2a\u6574\u6570$n$\u548c$k$($1\\le n \\le 50, 1 \\le k \\le n)$\n\n\u8f93\u51fa\n\n\u5bf9\u4e8e\u8f93\u5165\u7684$n,k$;\n\n\u7b2c\u4e00\u884c\uff1a \u5c06$n$\u5212\u5206\u6210\u82e5\u5e72\u6b63\u6574\u6570\u4e4b\u548c\u7684\u65b9\u6848\u6570\u3002\n\n\u7b2c\u4e8c\u884c\uff1a \u5c06$n$\u5212\u5206\u6210$k$\u4e2a\u6b63\u6574\u6570\u4e4b\u548c\u7684\u65b9\u6848\u6570\u3002\n\n\u7b2c\u4e09\u884c\uff1a \u5c06$n$\u5212\u5206\u6210\u6700\u5927\u6570\u4e0d\u8d85\u8fc7$k$\u7684\u65b9\u6848\u6570\u3002\n\n\u7b2c\u56db\u884c\uff1a \u5c06$n$\u5212\u5206\u6210\u82e5\u5e72\u4e2a\u5947\u6b63\u6574\u6570\u4e4b\u548c\u7684\u65b9\u6848\u6570\u3002\n\n\u7b2c\u4e94\u884c\uff1a \u5c06$n$\u5212\u5206\u6210\u82e5\u5e72\u4e0d\u540c\u6574\u6570\u4e4b\u548c\u7684\u65b9\u6848\u6570\u3002\n\n\u7b2c\u516d\u884c\uff1a \u6253\u5370\u4e00\u4e2a\u7a7a\u884c\n\n## Sol.\uff1a\n\n### \u5212\u5206\u7684\u591a\u4e2a\u6b63\u6574\u6570\u53ef\u4ee5\u76f8\u540c\n\n\u8bbe$f[i][j]$\u8868\u793a\u5c06$i$\u5212\u5206\u6210\u4e0d\u5927\u4e8e$j$\u7684\u6574\u6570\u7684\u65b9\u6848\u6570\n\n1. \u5f53$i<j$\u65f6,$i$\u4e0d\u80fd\u5212\u5206\u4e3a\u5927\u4e8e$i$\u7684\u6570,\u6240\u4ee5$f[i][j]=f[i][i]$\n2. \u5f53$i>j$\u65f6,\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\n   - \u5212\u5206\u4e2d\u540e\u7684\u6570\u542b\u6709$j$\n\n     \u65b9\u6848\u6570\uff1a$f[i-j][j](i<j)$\n\n   - \u5212\u5206\u4e2d\u4e0d\u542b$j$\n\n     \u76f8\u5f53\u4e8e\u628a$i$\u5212\u5206\u6210\u4e0d\u5927\u4e8e$j-1$\u7684\u6570\n     \u65b9\u6848\u6570\uff1a$f[i][j-1]$\n\n   \u6240\u4ee5$f[i][j]=f[i-j][j]+f[i-1][j-1](i>j)$\n\n3. \u5f53$i=j$\u65f6,\u4e24\u79cd\u60c5\u51b5\uff1a\n\n   - \u5212\u5206\u540e\u7684\u6570\u53ea\u542b\u6709$j$,\u90a3\u4e48\u53ea\u6709\u4e00\u79cd\u60c5\u51b5\n   - \u76f8\u5f53\u4e8e\u628a$i$\u5212\u5206\u6210\u4e0d\u5927\u4e8e$j-1$\u7684\u6570\n   \u65b9\u6848\u6570\uff1a$f[i][j-1]$\n\n   \u6240\u4ee5$f[i][j]=1+f[i][j-1]$\n\n$f[n][n]$:\u5c06$n$\u5212\u5206\u4e3a\u82e5\u5e72\u6b63\u6574\u6570\u4e4b\u548c\u7684\u5212\u5206\u6570\n\n$f[n][k]$:\u5c06$n$\u5212\u5206\u6210\u6700\u5927\u6570\u4e0d\u8d85\u8fc7$k$\u7684\u5212\u5206\u6570\u3002\n\n### \u5212\u5206\u7684\u6b63\u6574\u6570\u5fc5\u987b\u4e0d\u540c\n\n\u8bbe$f[i][j]$\u8868\u793a\u5c06$i$\u5212\u5206\u6210\u4e0d\u5927\u4e8e$j$\u7684\u4e0d\u540c\u6574\u6570\u7684\u65b9\u6848\u6570\n\n1. \u5f53$i<j$\u65f6,$i$\u4e0d\u80fd\u5212\u5206\u4e3a\u5927\u4e8e$i$\u7684\u6570,\u6240\u4ee5$f[i][j]=f[i][i]$\n2. \u5f53$i>j$\u65f6,\u5206\u4e3a\u4e24\u79cd\u60c5\u51b5\n   - \u5212\u5206\u540e\u7684\u6570\u4e2d\u542b\u6709$j$\n\n     \u5176\u4f59\u7684\u4e0d\u80fd\u542b\u6709$j$\n\n     \u65b9\u6848\u6570\uff1a$f[i-j][j-1](i<j)$\n\n   - \u5212\u5206\u4e2d\u4e0d\u542b$j$\n\n     \u76f8\u5f53\u4e8e\u628a$i$\u5212\u5206\u6210\u4e0d\u5927\u4e8e$j-1$\u7684\u6570\n\n     \u65b9\u6848\u6570\uff1a$f[i][j-1]$\n\n   \u6240\u4ee5$f[i][j]=f[i-j][j-1]+f[i-1][j-1](i>j)$\n\n3. \u5f53$i=j$\u65f6,\u4e24\u79cd\u60c5\u51b5\uff1a\n\n   - \u5212\u5206\u540e\u7684\u6570\u53ea\u542b\u6709$j$,\u90a3\u4e48\u53ea\u6709\u4e00\u79cd\u60c5\u51b5\n   - \u76f8\u5f53\u4e8e\u628a$i$\u5212\u5206\u6210\u4e0d\u5927\u4e8e$j-1$\u7684\u6570\n   \u65b9\u6848\u6570\uff1a$f[i][j-1]$\n\n   $f[i][j]=1+f[i][j-1]$\n\n$f[n][n]$:\u5c06$n$\u5212\u5206\u4e3a\u4e0d\u540c\u6b63\u6574\u6570\u4e4b\u548c\u7684\u5212\u5206\u6570\n\n### \u5c06n\u5212\u5206\u4e3ak\u4e2a\u6b63\u6574\u6570\u7684\u5212\u5206\u6570\n\n\u8bbe$f[i][j]$\u4e3a\u5c06$i$\u5212\u5206\u4e3a$j$\u4e2a\u6b63\u6574\u6570\u7684\u65b9\u6848\u6570\n\n1. $i<j$,\u4e0d\u53ef\u80fd\u51fa\u73b0,$f[i][j]=0(i<j)$\n2. $i=j$, \u53ea\u6709\u4e00\u79cd\u60c5\u51b5\uff1a\u5212\u5206\u6210$i$\u4e2a$1$\n3. $i>j$,\u4e24\u79cd\u60c5\u51b5\uff1a\n   - \u5212\u5206\u540e\u7684\u6570\u4e2d\u542b\u6709$1$\n\n     \u53ef\u4ee5\u4f7f\u7528\u201c\u622a\u8fb9\u6cd5\u201d\u5c06\u5212\u5206\u51fa\u7684$j$\u4e2a\u6570\u5206\u522b\u51cf\u53bb$1$,\u628a\u95ee\u9898\u8f6c\u5316\u4e3a\u5c06$i-j$\u5212\u5206\u6210$j-1$\u4e2a\u6570,\u65b9\u6848\u6570\uff1a$f[i-j][j-1]$\n\n   - \u5212\u5206\u540e\u7684\u6570\u4e2d\u4e0d\u542b$1$\n\n     \u4f7f\u7528\u201c\u622a\u8fb9\u6cd5\u201d\u5c06\u5212\u5206\u51fa\u7684$j$\u4e2a\u6570\u5206\u522b\u51cf\u53bb$1$,\u5c06\u4e3a\u9898\u8f6c\u5316\u4e3a\u6c42$i-j$\u7684$j$\u4e2a\u5212\u5206\u6570,\u4e3a$f[i-j][j]$\n\n    \u6240\u4ee5$f[i][j]=f[i-j][j-1]+f[i-j][j]$\n\n$f[n][k]$\u8868\u793a\u5c06$n$\u5212\u5206\u4e3a$k$\u4e2a\u6b63\u6574\u6570\u7684\u65b9\u6848\u6570\n\n### \u5c06n\u5212\u5206\u4e3a\u82e5\u5e72\u6b63\u5947\u6570\u4e4b\u548c\u7684\u5212\u5206\u6570\n\n\u8bbe$f[i][j]$\u4e3a\u5c06$i$\u5212\u5206\u4e3a$j$\u4e2a\u5947\u6570\u4e4b\u548c\u7684\u5212\u5206\u6570,\n\n$g[i][j]$\u4e3a\u5c06$i$\u5212\u5206\u4e3a$j$\u4e2a\u5076\u6570\u4e4b\u548c\u7684\u5212\u5206\u6570\n\n\u4f7f\u7528\u622a\u8fb9\u6cd5,\u5c06$g[i][j]$\u7684$j$\u4e2a\u5212\u5206\u90fd\u51cf\u53bb$1$,\u53ef\u4ee5\u5f97\u5230$f[i-j][j]$,\u6240\u4ee5\n\n$g[i][j] = f[i-j][j]$\n\n\u5bf9\u4e8e$f[i][j]$\n\n1. \u5212\u5206\u540e\u7684\u6570\u4e2d\u5305\u542b$1$\n   \n   \u53ef\u4ee5\u5c06\u5212\u5206\u51fa\u7684$1$\u9664\u53bb,\u8f6c\u5316\u4e3a\u201c\u5c06$i-1$\u5212\u5206\u4e3a$j-1$\u4e2a\u5947\u6570\u4e4b\u548c\u7684\u5212\u5206\u6570\n\n   \u5373$f[i-1][j-1]$\n\n2. \u5212\u5206\u540e\u7684\u6570\u4e2d\u4e0d\u542b$1$\n   \n   \u4f7f\u7528\u622a\u8fb9\u6cd5\u5c06\u5212\u5206\u51fa\u7684$j$\u4e2a\u6570\u6bcf\u4e00\u4e2a\u90fd\u51cf\u53bb$1$\n   \n   \u8f6c\u5316\u4e3a\u201c\u5c06$i-j$\u5212\u5206\u4e3a$j$\u4e2a\u5076\u6570\u4e4b\u548c\u7684\u5212\u5206\u6570\u201d,\n   \n   \u5373$g[i-j][j]$\n\n\u6240\u4ee5$f[i][j]=f[i-1][j-1]+g[i-j][j]$\u3002\n\n$\\sum_{i=0}^nf[n][i]$\u8868\u793a\u5c06$n$\u5212\u5206\u4e3a\u82e5\u5e72\u5947\u6570\u7684\u65b9\u6848\u6570", "link": "/posts/\u5212\u5206dp/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u8ba1\u6570"], "categories": [["\u7b97\u6cd5", "\u52a8\u6001\u89c4\u5212"], ["\u7b97\u6cd5", "\u6811\u8bba"], ["note"]]}, {"title": "\u5bb9\u65a5\u4e0e\u4e8c\u9879\u5f0f\u53cd\u6f14", "content": "# \u5bb9\u65a5\n\n## \u5bb9\u65a5\u539f\u7406\n\n- \u6c42\u5177\u6709n\u4e2a\u5c5e\u6027\u4e4b\u4e00\uff08\u5e76\u96c6\uff09\u7684\u5143\u7d20\u7684\u4e2a\u6570\n\n- \u6c42\u4e0d\u5177\u6709n\u4e2a\u5c5e\u6027\u4e2d\u4efb\u4f55\u4e00\u4e2a\uff08\u4ea4\u96c6\uff09\u7684\u5143\u7d20\u7684\u4e2a\u6570\n\n\n### \u4e24\u4e2a\u96c6\u5408\u7684\u5e76\u96c6\n\n$|A \\bigcup B| = |A|+|B|-|A \\bigcap B|$\n\n\n### \u4e09\u4e2a\u96c6\u5408\u7684\u5e76\u96c6\n\n$\n\\begin{aligned}\n|A \\bigcup B \\bigcup C|\n&=\\quad|A|+|B|+|C|\\\\\n&\\quad-|A \\bigcap B|-|A \\bigcap C|-|B \\bigcap C|\\\\\n&\\quad+|A\\bigcap B \\bigcap C|\n\\end{aligned}\n$\n\n\n### \u591a\u4e2a\u96c6\u5408\u7684\u5e76\u96c6\n\n\u53c8\u79f0\u591a\u6b65\u5bb9\u65a5\n\n$$\n\\begin{aligned}\n&\\quad|A_1 \\bigcup A_2 \\bigcup ... \\bigcup A_n|\\\\\n&=\\sum_{i=1}^n|A_i|\\\\\n&- \\sum_{i=1}^{n-1} \\sum_{j=i+1}^n|A_i \\bigcap A_j|\\\\\n&+ \\sum_{i=1}^{n-2} \\sum_{j=i+1}^{n-1}\\sum_{k=j+1}^{n}|A_i \\bigcap A_j \\bigcap A_k|\\\\\n&- ...\\\\\n&+(-1)^{n-1}|A_1 \\bigcap A_2 \\bigcap ... \\bigcap A_n|\n\\end{aligned}\n$$\n\n\n### De Morgan\u5b9a\u7406\n\n\u82e5$A,B$\u662f$U$\u7684\u5b50\u96c6,\u5219\n\n($\\overline A$\u8868\u793a$A$\u7684\u8865\u96c6)\n\n$\\overline{A\\bigcup B} = \\overline A\\bigcap \\overline B$\n\n$\\overline{A\\bigcap B}=\\overline A \\bigcup \\overline B$\n\n\u82e5$A_1,A_2,\u2026A_n$\u662f$U$\u7684\u5b50\u96c6,\u5219\n\n$\\overline{A_1\\bigcup A_2 \\bigcup ... \\bigcup A_n} = \\overline{A_1} \\bigcap \\overline{A_2} \\bigcap ... \\bigcap \\overline A_n$\n\n$\\overline{A_1\\bigcap A_2 \\bigcap ... \\bigcap A_n} = \\overline{A_1} \\bigcup \\overline{A_2} \\bigcup ... \\bigcup \\overline A_n$\n\n\n### Example 1:\n\n\u7ed9\u5b9a\u96c6\u5408$N$\u548c\u5177\u6709\u6027\u8d28$i$\u7684\u96c6\u5408$A_1,A_2,...,A_n$\n\n\u591a\u6b65\u5bb9\u65a5\u53d8\u5f62:\n\n$$\n\\begin{aligned}\n&\\quad|\\overline{A_1}\\bigcap \\overline{A_2}\\bigcap...\\bigcap \\overline{A_n}|\\\\\n&=N\\\\\n&-\\sum|A_i|\\\\\n&+\\sum|A_i\\bigcap A_j|\\\\\n&-\\sum|A_i\\bigcap A_j \\bigcap A_k|\\\\\n&+...\\\\\n&+(-1)^n |A_1\\bigcap A_2 \\bigcap ... \\bigcap A_n|\n\\end{aligned}\n$$\n\n\u8865\u96c6\u7684\u8865\u96c6\u5c31\u662f\u539f\u96c6:\n\n$$\n\\begin{aligned}\n&\\quad|A_1\\bigcap A_2\\bigcap...\\bigcap A_n|\\\\\n&=N\\\\\n&-\\sum|\\overline{A_i}|\\\\\n&+\\sum|\\overline{A_i} \\bigcap \\overline{A_j}|\\\\\n&-\\sum|\\overline{A_i} \\bigcap \\overline{A_j} \\bigcap \\overline{A_k}|\\\\\n&+...\\\\\n&+(-1)^n |\\overline{A_1}\\bigcap \\overline{A_2} \\bigcap ... \\bigcap \\overline{A_n}|\n\\end{aligned}\n$$\n\n\n### Example 2:\n\n> \u6c42$a,b,c,d,e,f$\u516d\u4e2a\u5b57\u6bcd\u7684\u5168\u6392\u5217\u4e2d\u4e0d\u5141\u8bb8\u51fa\u73b0$ace$\u548c$df$\u56fe\u8c61\u7684\u6392\u5217\u6570\n\n\u8bbe$N$\u4e3a\u603b\u6392\u5217\u6570,$A$\u4e3a$ace$\u51fa\u73b0\u7684\u6392\u5217\u6570,$B$\u4e3a$df$\u51fa\u73b0\u7684\u6392\u5217\u6570\n\n$$\n\\begin{aligned}\nans\n&=|\\overline A \\bigcap \\overline B|\\\\\n&=|N|-|A|-|B|+|A\\bigcap B|\\\\\n&=6!-4!-5!+3!=582\n\\end{aligned}\n$$\n\n\n### Example 3:\n\n> $4$\u4e2a$x,3$\u4e2a$y,2$\u4e2a$z$\u7684\u5168\u6392\u5217\u4e2d,\u6c42\u4e0d\u51fa\u73b0$xxxx,yyy,zz$\u56fe\u8c61\u7684\u6392\u5217\u6570.\n\n\u8bbe$N$\u4e3a\u603b\u6392\u5217\u96c6\u5408,\u51fa\u73b0$xxxx$\u7684\u6392\u5217\u96c6\u5408\u4e3a$A$,\u51fa\u73b0$yyy$\u4e3a$B$,\u51fa\u73b0$zz$\u4e3a$C$\n\n$$\n\\begin{aligned}\nans\n&=\\quad|N|\\\\\n&\\quad-(|A|+|B|+|C|)\\\\\n&\\quad+(|A\\bigcap B|+|A\\bigcap C|+|B\\bigcap C|)\\\\\n&\\quad-|A\\bigcap B\\bigcap C|\\\\\n&=1260-(60+105+280)+(12+20+30)-6=871\n\\end{aligned}\n$$\n\n\n### \u9519\u6392\u95ee\u9898\n\n> \u6c42\u6574\u6570$1,2,\u2026,n$\u7684\u5168\u6392\u5217\u4e2d\u6240\u6709$i$\u90fd\u4e0d\u5728\u7b2c$i$\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u6392\u5217\u7684\u4e2a\u6570,$i=1,2,\u2026,n$\n\n\u8bbe$A_i$\u4e3a$i$\u5728\u4f4d\u7f6e$i$\u4e0a\u7684\u6240\u6709\u6392\u5217\n\n$$\n\\begin{aligned}\nans\n&=|\\overline A_1\\bigcap \\overline A_2 \\bigcap ...\\bigcap \\overline A_n|\\\\\n&=\\quad|N|\\\\\n&\\quad-(|A_1|+|A_2|+...+|A_n|)\\\\\n&\\quad+(|A_1\\bigcap A_2|+...+|A_{n-1}\\bigcap A_n|)\\\\\n&\\quad-\\ ...\\\\\n&\\quad+ (-1)^n |A_1\\bigcap A_2\\bigcap ... \\bigcap A_n|\\\\\n&=n!- {n\\choose 1}\\cdot (n-1)! + {n\\choose 2}\\cdot (n-2)! - ...\\ + (-1)^n {n\\choose n}\\\\\n&=n!(1-\\frac{1}{1!}+\\frac{1}{2!}-\\frac{1}{3!}+...+(-1)^n\\frac{1}{n!}) = D_n\\\\\n\\end{aligned}\n$$\n\n$$D_n=n!\\sum_{i=0}^n \\frac{(-1)^i}{i!}$$\n\n\u9012\u63a8\u6cd5:\n\n\u8bbe$f_x$\u8868\u793a\u9519\u4e86$x$\u4e2a\n\n1. \u628a\u7b2c$n$\u4e2a\u6570\u653e\u5728$[1,n-1]$\u4e2d\u7684\u67d0\u4e2a\u4f4d\u7f6e,\u6709$n-1$\u79cd\u53ef\u80fd\n\n2. \u653e\u7b2c$k(k\\not=n)$\u4e2a\u5143\u7d20\n\n   - \u653e\u5728\u4f4d\u7f6e$n$,\u5269\u4f59\u7684$n-2$\u4e2a\u5143\u7d20\u6709$f_{n-2}$\u79cd\u65b9\u6cd5\n\n   - \u4e0d\u653e\u4f4d\u7f6e$n$,\u90a3\u4e48\u76f8\u5f53\u4e8e\u5269\u4e0b$n-1$\u4e2a\u5143\u7d20\u6709$f_{n-1}$\u79cd\u65b9\u6cd5\n\n\u521d\u59cb:$f_1=0,f_2=1$\n\n$f_n=(n-1)(f_{n-1}+f_{n-2})$\n\n[HDU 1465 \u4e0d\u5bb9\u6613\u7cfb\u5217\u4e4b\u4e00](http://acm.hdu.edu.cn/showproblem.php?pid=1465)\n\n## \u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\n\n> \u5c06$n$\u4e2a\u4e0d\u540c\u7684\u7403\u653e\u8fdb$m$\u4e2a\u76f8\u540c\u7684\u76d2\u5b50,\u4fdd\u8bc1\u76d2\u5b50\u975e\u7a7a,\u6c42\u65b9\u6848\u6570.\n\n### \u5bb9\u65a5\u6cd5:\n\n$$S(n,m)=\\frac 1{m!}\\sum_{i=0}^m {m\\choose i}(m-i)^n(-1)^i$$\n\n> \u679a\u4e3e\u7a7a\u76d2\u4e2a\u6570,\u5269\u4e0b\u968f\u4fbf\u653e,\u5230\u8fd9\u91cc\u5f00\u59cb\u4e5f\u6709\u4e86\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u5f62\u5f0f\n>\n> \u7531\u4e8e\u76d2\u5b50\u76f8\u540c,\u6240\u4ee5\u9664\u4ee5$m!$\n\n### \u9012\u63a8\u6cd5\n\n$$S(n,m)=S(n-1,m-1)+mS(n-1,m)$$\n\n> \u76f8\u5f53\u4e8e\u8003\u8651\u73b0\u5728\u8981\u653e\u7684\u6c42\u662f\u5426\u5355\u72ec\u5728\u4e00\u4e2a\u76d2\u5b50\u91cc:\n>\n> 1. \u4e0d\u5360\u4e00\u76d2:\n>\n>    \u5176\u4f59$n-1$\u4e2a\u7403\u653e\u5230$m-1$\u4e2a\u76d2\u5b50\u91cc\n>\n> 2. \u653e\u5230\u67d0\u4e2a\u6709\u7403\u7684\u76d2\u5b50\u91cc:\n>\n>    \u6709$m$\u4e2a\u76d2\u5b50\u53ef\u653e($m$\u79cd\u53ef\u80fd),\u5176\u4f59$n-1$\u4e2a\u7403\u653e\u5230$m$\u4e2a\u76d2\u5b50\u91cc\n\n## \u5e7f\u4e49\u5bb9\u65a5\u539f\u7406\n\n- \u6c42\u6070\u597d\u5177\u6709m\u4e2a\u5c5e\u6027\u7684\u5143\u7d20\u7684\u4e2a\u6570\n\n### $\\alpha(m)$\n\n\u7ed9\u5b9a\u96c6\u5408$N$\u548c\u6027\u8d28$A_1,A_2,...,A_n$,\u4ee4$\\alpha(0)=|N|$\n\n$\\displaystyle\n\\alpha(1) = \\sum|A_i|\\\\\n\\alpha(2) = \\sum|A_i\\bigcap A_j|\\\\\n\\alpha(3) = \\sum|A_i\\bigcap A_j\\bigcap A_k|\\\\\n...\\\\\n\\alpha(n) = |A_1\\bigcap A_2\\bigcap ...\\bigcap A_n|\\\\\n$\n\n\u5219$\\alpha(m)$\u8ba1\u6570\u4e86\u5177\u6709$m+k$\u4e2a\u6027\u8d28\u7684\u5143\u7d20${m+k}\\choose m$\u6b21\n\n\n### $\\beta(m)$\n\n\u7ed9\u5b9a\u96c6\u5408$N$\u548c\u6027\u8d28$A_1,A_2,...,A_n$,\u4ee4$\\beta(m)$\u8868\u793a$N$\u4e2d\u6070\u597d\u6709$m$\u4e2a\u6027\u8d28\u7684\u5143\u7d20\u4e2a\u6570,\u5219\n\n$\\Beta(m)=\\alpha(m)-{m+1 \\choose m}a(m+1)+{m+2\\choose m}\\alpha(m+2)-...+(-1)^{n-m}{n\\choose m}\\alpha(n)$\n\n\u8bc1\u660e:\u8bf7\u770b\u4e0b\u9762\u7684\u4e8c\u9879\u5f0f\u53cd\u6f14\n\n\u63a8\u8bba:$\\beta(0)=\\alpha(0)-\\alpha(1)+\\alpha(2)-...+(-1)^n\\alpha(n)$\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u548c\u63a5\u4e0b\u6765\u7684\u4e8c\u9879\u5f0f\u53cd\u6f14\u975e\u5e38\u50cf,\u5982\u679c\u65e0\u6cd5\u7406\u89e3\u53ef\u4ee5\u5f3a\u884c\u8bb0\u4e00\u4e0b,\u56e0\u4e3a\u8fd9\u4e2a\u975e\u5e38\u5bf9\u79f0,\u5f88\u597d\u8bb0\n\n## \u4e8c\u9879\u5f0f\u53cd\u6f14\n\n1. \u56de\u987eExample 1\n\n   \u8003\u8651\u4e00\u79cd\u7279\u6b8a\u60c5\u51b5\uff1a\u591a\u4e2a\u96c6\u5408\u7684\u4ea4\u96c6\u5927\u5c0f\u53ea\u548c\u96c6\u5408\u7684\u6570\u76ee\u6709\u5173\n\n   \u8bbe$f_n$\u8868\u793a$n$\u4e2a\u8865\u96c6\u7684\u4ea4\u96c6\u5927\u5c0f,$g_n$\u8868\u793a$n$\u4e2a\u539f\u96c6\u7684\u5927\u5c0f\n\n   $$\n   f_n = \\sum_{i=0}^n (-1)^i {n\\choose i} g_i \n   \\\\\\Updownarrow\\\\ \n   g_n = \\sum_{i=0}^n (-1)^i {n\\choose i}f_i\n   $$\n\n2. \u8bbe$f_i$\u4e3a\u81f3\u591a\u5177\u6709$i$\u4e2a\u5c5e\u6027\u7684\u65b9\u6848\u6570,$g_i$\u8868\u793a\u6070\u597d\u5177\u6709$i$\u4e2a\u5c5e\u6027\u7684\u65b9\u6848\u6570:\n\n   $$\n   f_n=\\sum_{i=0}^n{n\\choose i} g_i\n   \\\\ \\Updownarrow \\\\\n   g_n=\\sum_{i=0}^n (-1)^{n-i} {n\\choose i}f_i\n   $$\n\n   $f_n$\u8868\u793a\u5148\u94a6\u5b9a$n$\u4e2a\u5c5e\u6027,\u518d\u7edf\u8ba1\u81f3\u591a\u5177\u6709\u8fd9$n$\u4e2a\u5c5e\u6027\u7684\u65b9\u6848\u6570(\u4e5f\u5c31\u662f\u4e0d\u80fd\u6709\u8fd9$n$\u4e2a\u4e4b\u5916\u7684,\u8fd9$n$\u4e2a\u4efb\u610f),\n   \n   \u5176\u4e2d\u4f1a\u5305\u542b\u91cd\u590d\u7684\u65b9\u6848,\u56e0\u4e3a\u4e00\u4e2a\u65b9\u6848\u53ef\u4ee5\u6709\u591a\u79cd\u94a6\u5b9a\u60c5\u51b5.\u5177\u4f53\u5730,\u5bf9\u4e8e\u6070\u597d\u9009\u62e9$i$\u4e2a,\u94a6\u5b9a\u60c5\u51b5\u6570\u4f4d${n\\choose i}$ ,\u6545$g_i$\u5728$f_n$\u4e2d\u88ab\u8ba1\u7b97\u4e86${n\\choose i}$\u6b21\n\n3. \u8bbe$f_i$\u4e3a\u81f3\u5c11\u5177\u6709$i$\u4e2a\u5c5e\u6027,$g_i$\u8868\u793a\u6070\u597d\u5177\u6709$i$\u4e2a\u5c5e\u6027\u7684\u65b9\u6848\u6570\u7684\u65b9\u6848\u6570:\n\n   $$\n   f_n = \\sum_{i=n}^m g_i {i\\choose n}\n   \\\\ \\Updownarrow \\\\\n   g_n=\\sum_{i=n}^m(-1)^{i-n}{i\\choose n}f_i\n   $$\n\n   \u6ce8\u610f:\n\n   $f_n$\u8868\u793a\u5148\u94a6\u5b9a$n$\u4e2a\u5c5e\u6027,\u518d\u7edf\u8ba1\u81f3\u5c11\u5177\u6709\u8fd9$n$\u4e2a\u5c5e\u6027\u7684\u65b9\u6848\u6570(\u4e5f\u5c31\u662f\u5305\u542b\u8fd9$n$\u4e2a\u5c5e\u6027,\u5176\u4f59\u5c5e\u6027\u4efb\u610f),\n\n   \u5176\u4e2d\u4f1a\u5305\u542b\u91cd\u590d\u7684\u65b9\u6848,\u56e0\u4e3a\u4e00\u4e2a\u65b9\u6848\u53ef\u4ee5\u6709\u591a\u79cd\u94a6\u5b9a\u60c5\u51b5.\u5177\u4f53\u5730,\u5bf9\u4e8e\u6070\u597d\u9009\u62e9$i$\u4e2a,\u94a6\u5b9a\u60c5\u51b5\u6570\u4f4d${i\\choose n}$ ,\u6545$g_i$\u5728$f_i$\u4e2d\u88ab\u8ba1\u7b97\u4e86${i\\choose n}$\u6b21\n\n4. **tips:**\n\n   **\u4e8c\u9879\u5f0f\u53cd\u6f14**(\u6216**\u5e7f\u4e49\u5bb9\u65a5\u539f\u7406**)\u53ef\u4ee5\u7528\u6765\u89e3\u51b3\u4e00\u4e9b**\u6070\u597d**,**\u81f3\u591a**,**\u81f3\u5c11**\u7684\u8ba1\u6570\u95ee\u9898\n\n   \u53ef\u4ee5\u901a\u8fc7\u5bb9\u65a5\u6765\u5b8c\u6210**\u6070\u597d**,**\u81f3\u591a**,**\u81f3\u5c11**\u4e4b\u95f4\u7684\u4e92\u76f8\u8f6c\u6362\n\n   \u662f\u4e00\u4e2a\u5f88\u597d\u7528\u7684\u5de5\u5177\n\n5. \u8bc1\u660e\n\n   \u81f3\u591a:\n\n   $$\n   \\begin{aligned}\n   g_n\n   &=\\sum_{i=0}^n (-1)^{n-i}{n\\choose i}f_i\\\\\n   &=\\sum_{i=0}^n (-1)^{n-i} {n\\choose i}\\sum_{j=0}^i{i\\choose j}g_j\\\\\n   &=\\sum_{j=0}^n g_j\\sum_{i=j}^n {n\\choose i}{i \\choose j}(-1)^{n-i}\\\\\n   &=\\sum_{j=0}^n g_j\\sum_{i=j}^n {n\\choose j}{n-j \\choose i-j}(-1)^{n-i}\\\\\n   &=\\sum_{j=0}^n g_j\\left[{n\\choose j}\\sum_{i=j}^n{n-j \\choose i-j}(-1)^{n-i}\\right]\\\\\n   &=\\sum_{j=0}^n g_j\\left[{n\\choose j}\\sum_{i=0}^{n-j}{n-j \\choose i}(-1)^{n-j-i}\\right]\\\\\n   &=\\sum_{j=0}^n g_j\\left[{n \\choose j}(1-1)^{n-j}\\right]\\\\\n   &=g_n\n   \\end{aligned}\n   $$\n\n# \u4f8b\u9898\n\n## BZOJ 2839 \u96c6\u5408\u8ba1\u6570\n\n[\u5730\u5740](https://ruanx.pw/bzojch/p/2839.html)\n\n### \u9898\u610f:\n\n\u4e00\u4e2a\u6709$N$\u4e2a\u5143\u7d20\u7684\u96c6\u5408\u6709$2^N$\u4e2a\u4e0d\u540c\u5b50\u96c6\uff08\u5305\u542b\u7a7a\u96c6\uff09,\u73b0\u5728\u8981\u5728\u8fd9$2^N$\u4e2a\u96c6\u5408\u4e2d\u53d6\u51fa\u82e5\u5e72\u96c6\u5408\uff08\u81f3\u5c11\u4e00\u4e2a\uff09,\u4f7f\u5f97\n\u5b83\u4eec\u7684\u4ea4\u96c6\u7684\u5143\u7d20\u4e2a\u6570\u4e3a$K$,\u6c42\u53d6\u6cd5\u7684\u65b9\u6848\u6570,\u7b54\u6848\u6a21$1000000007$\n\n### \u89e3\u6cd5:\n\n\u8bbe$g_i$\u8868\u793a\u4ea4\u96c6\u4e2a\u6570\u81f3\u5c11\u4e3a$i$\u7684\u65b9\u6848\u6570\n\n\u90a3\u4e48$\\displaystyle g_i = {n\\choose i}(2^{2^{n-i}}-1)$\n\n> \u5148\u4ece$n$\u4e2d\u9009$i$\u4e2a,\u7136\u540e\u5176\u4ed6\u53ef\u4ee5\u968f\u4fbf\u53d6\n>\n> \u90a3\u5c31\u662f\u6709$2^{n-i}$\u4e2a\u96c6\u5408\u53ef\u4ee5\u53d6\n>\n> \u7136\u540e\u53c8\u53ef\u4ee5\u53d6\u81f3\u5c111\u4e2a\u96c6\u5408\n>\n> \u90a3\u4e48\u7b54\u6848\u5c31\u662f${n\\choose i}(2^{2^{n-i}}-1)$\n\n\u8bbe$f_i$\u8868\u793a\u6070\u597d\u4e3a$i$\u7684\n\n\u90a3\u4e48$\\displaystyle g_k=\\sum_{i=k}^n f_i\\cdot {i\\choose k}$\n\n\u53cd\u6f14$\\displaystyle f_k=\\sum_{i=k}^n g_i\\cdot{i\\choose k} (-1)^{i-k}$\n\n\u4e0d\u80fd\u76f4\u63a5\u5feb\u901f\u5e42,\u56e0\u4e3a\u6307\u6570\u4e0d\u80fd$\\mod p$,\u8981\u7528$2^{2^i}=(2^{2^{i-1}})^2$\u5012\u7740\u679a\u4e3e\u7b97\n\n```cpp\n#define N 1000011\nconst int mod=1000000007;\nint n,k,g[N],fac[N],inv[N];\nint C(int a,int b){\n    return 1ll*fac[a]*inv[b]%mod*inv[a-b]%mod;\n}\nint pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%mod;\n        p>>=1;x=1ll*x*x%mod;\n    }\n    return ans;\n}\nint main(){\n    in(n,k);\n    fac[0]=inv[0]=1;\n    for(int i=1;i<=n;++i)\n        fac[i]=1ll*fac[i-1]*i%mod;\n    inv[n]=pw(fac[n],mod-2);\n    for(int i=n-1;i>=1;--i)\n        inv[i]=1ll*inv[i+1]*(i+1)%mod;\n\n    for(int i=0;i<=n;++i)\n        g[i]=1ll*C(n,i)*(pw(2,(pw(2,n-i))-1+mod)%mod)%mod;\n\n    int ans=0,b=2;\n    for(int i=n;i>=k;--i){\n        int t=1ll*C(n,i)%mod*C(i,k)%mod*(b-1)%mod;\n        if((i-k)&1)ans=(ans-t+mod)%mod;\n        else ans=(ans+t)%mod;\n        b=1ll*b*b%mod;\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n\n## [JSOI2011]\u5206\u7279\u4ea7\n\n[\u5730\u5740](https://www.luogu.com.cn/problem/P5505)\n\n### \u9898\u610f\n\n\u6709$n$\u4e2a\u4eba\u548c$m$\u79cd\u7269\u54c1,\u7b2c$i$\u79cd\u7269\u54c1\u6709$a_i$\u4e2a,\u540c\u79cd\u7269\u54c1\u4e4b\u95f4\u6ca1\u6709\u533a\u522b\u3002\u73b0\u5728\u8981\u5c06\u8fd9\u4e9b\u7269\u54c1\u5206\u7ed9\u8fd9\u4e9b\u4eba,\u4f7f\u5f97\u6bcf\u4e2a\u4eba\u81f3\u5c11\u5206\u5230\u4e00\u4e2a\u7269\u54c1\n\n### \u9898\u89e3\n\n\u6bcf\u4e2a\u540c\u5b66\u90fd\u5fc5\u987b**\u81f3\u5c11**\u5206\u5f97\u4e00\u4e2a\n\n\u53ef\u4ee5\u901a\u8fc7 **\u6070\u597d**\u6ca1\u6709\u540c\u5b66\u6ca1\u6709\u5206\u5f97 \u6765\u53cd\u6f14\n\n\u8bbe$f_i$\u4e3a\u94a6\u5b9a$i$\u4e2a\u4eba\u6ca1\u6709\u5206\u5230,\n\n\u94a6\u5b9a\u7684\u65b9\u6848\u6570\u4e3a${n\\choose i}$,\u8fd9\u65f6\u7b2c$j$\u79cd\u7269\u54c1\u5206\u7ed9$n-i$\u4e2a\u4eba,\u4f7f\u7528\u9694\u677f\u6cd5,\u65b9\u6848\u6570\u4e3a${n-i+a_j-1\\choose n-i-1}$\n\n$$\nf_i={n\\choose i}\\prod_{j=1}^m{n-i+a_j-1\\choose n-i-1}\n$$\n\n\u8bbe$g_i$\u4e3a\u6070\u597d$i$\u4e2a\u4eba\u6ca1\u6709\u5206\u5230,\u53cd\u6f14:\n\n$$\ng_k=\\sum_{i=k}^n(-1)^{i-k}{i \\choose k}f_i\n$$\n\n\u90a3\u4e48:\n\n$$\n\\begin{aligned}\nans\n&=g_0\\\\\n&=\\sum_{i=0}^n(-1)^if_i\\\\\n&=\\sum_{i=0}^n(-1)^i{n\\choose i}\\prod_{j=1}^m{n-i+a_j-1\\choose n-i-1}\n\\end{aligned}\n$$\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1001,P=1000000007;\nint n,m,a[N],ans,c[N*2][N*2];\nvoid mod(int&x){if(x>=P)x-=P;}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=0;i<=2000;++i){\n        c[i][0]=c[i][i]=1;\n        for(int j=1;j<i;++j)\n            mod(c[i][j]=c[i-1][j-1]+c[i-1][j]);\n    }\n    for(int i=1;i<=m;++i)scanf(\"%d\",a+i);\n    for(int i=0;i<=n;++i){\n        long long res=c[n][i];\n        for(int j=1;j<=m;++j)\n            (res*=c[n-i+a[j]-1][n-i-1])%=P;\n        if(i&1)mod(ans+=P-res);\n        else mod(ans+=res);\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n\n## \u5df2\u7ecf\u6ca1\u6709\u4ec0\u4e48\u597d\u5bb3\u6015\u7684\u4e86\n\n[\u5730\u5740](https://www.luogu.com.cn/problem/P4859)\n\n### \u9898\u610f:\n\n\u7ed9\u51fa$n$\u4e2a\u6570$a_i$\u53ca$n$\u4e2a\u6570$b_i$ ,\u8981\u6c42\u4e24\u4e24\u914d\u5bf9\u4f7f\u5f97 $a>b$\u7684\u5bf9\u6570\u51cf\u53bb$a<b$\u7684\u5bf9\u6570\u7b49\u4e8e$k$.\n\n$0\\leq k\\leq n\\leq 2000$,\u4fdd\u8bc1$a,b$ \u65e0\u76f8\u540c\u5143\u7d20.\n\n### \u9898\u89e3:\n\n\u5148\u5c06$b$\u6570\u7ec4\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\n\n\u8bbe\u9009\u4e2d\u4e86$x$\u5bf9$a > b$,\u7531\u603b\u5bf9\u6570\u4e3a$n$,\u7531$x-(n-x)=k$,\u53ef\u4ee5\u77e5\u9053$x=\\frac{n+k}2$\n\n\u6211\u4eec\u8bbe$f(i,j)$\u4e3a\u524d$i$\u4e2a$a$\u4e2d\u9009\u4e2d\u4e86$j$\u7ec4$a > b$\u7684\u65b9\u6848\u6570\n\n\u90a3\u4e48$f(i,j)=f(i-1,j)+f(i-1,j-1)\\times(l_i-j+1)$\n\n($l_i$\u8868\u793a$b$\u4e2d\u5c0f\u4e8e$a_i$\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e)\n\n\u4f46\u662f\u8fd8\u6709\u5269\u4e0b\u7684$n-x$\u5bf9\n\n\u6211\u4eec\u53ef\u4ee5\u8bbe$g_i$\u8868\u793a$a>b$\u5bf9\u6570$\\ge i$\u7684\u65b9\u6848\u6570\n\n\u90a3\u4e48$g_i = f(n,i) \\times (n-i)!$(\u76f8\u5f53\u4e8e\u5269\u4e0b\u7684\u968f\u4fbf\u6392\u5217\u7ec4\u5408)\n\n\u6211\u4eec\u8bbe$f_i$\u8868\u793a$a>b$\u5bf9\u6570\u6070\u597d\u4e3a$i$\u5bf9\u7684\u65b9\u6848\u6570\n\n\u90a3\u4e48$\\displaystyle g_k = \\sum_{i=k}^n f_i \\times {i\\choose k}$\n (\u76f8\u5f53\u4e8e\u4ece\u6070\u597d$i$\u4e2a\u65b9\u6848\u4e2d\u9009$k$\u5bf9\u51fa\u6765)\n\n\u7ecf\u8fc7\u4e8c\u9879\u5f0f\u53cd\u6f14\u53ef\u4ee5\u77e5\u9053:\n\n$\\displaystyle f(k)=\\sum_{i=k}^n(-1)^{i-k}{i\\choose k}g(i)$\n\n\u4ee3\u7801:\n\n```cpp\nconst int N=4011,mod=1000000009;\nint n,k,f[N][N],a[N],b[N],l[N],fac[N],inv[N],g[N];\nil int pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%mod;\n        p>>=1;x=1ll*x*x%mod;\n    }\n    return ans;\n}\nint C(int a,int b){\n    return 1ll*fac[a]*inv[b]%mod*inv[a-b]%mod;\n}\nsigned main(){\n    in(n,k);\n    if((n+k)&1){puts(\"0\");return 0;};\n    k=(n+k)>>1;\n    for(int i=1;i<=n;++i)in(a[i]);\n    for(int i=1;i<=n;++i)in(b[i]);\n    fac[0]=inv[0]=1;\n    for(int i=1;i<=n;++i)\n        fac[i]=1ll*fac[i-1]*i%mod;\n    inv[n]=pw(fac[n],mod-2);\n    for(int i=n-1;i>=0;--i)\n        inv[i]=1ll*inv[i+1]*(i+1)%mod;\n    sort(a+1,a+n+1);\n    sort(b+1,b+n+1);\n    int p=0;\n    for(int i=1;i<=n;++i){\n        while(p<n&&b[p+1]<a[i])++p;\n        l[i]=p;\n    }\n    f[0][0]=1;\n    for(int i=1;i<=n;++i){\n        f[i][0]=1;\n        for(int j=1;j<=i;++j)\n            f[i][j]=(f[i-1][j]+1ll*f[i-1][j-1]*MAX(0,l[i]-j+1)%mod)%mod;\n    }\n    for(int i=0;i<=n;++i)\n        g[i]=1ll*f[n][i]*fac[n-i]%mod;\n    int ans=0;\n    for(int i=k;i<=n;++i)\n        if((i-k)&1)ans=(ans-1ll*C(i,k)*g[i]%mod+mod)%mod;\n        else ans=(ans+1ll*C(i,k)*g[i]%mod)%mod;\n\n    printf(\"%d\\n\",ans);\n}\n```\n\n\n## [HAOI2008]\u786c\u5e01\u8d2d\u7269\n\n[\u5730\u5740](https://www.luogu.com.cn/problem/P1450)\n\n### \u9898\u610f:\n\n\u786c\u5e01\u8d2d\u7269\u4e00\u5171\u67094\u79cd\u786c\u5e01.\u9762\u503c\u5206\u522b\u4e3a$c1,c2,c3,c4$.\n\n\u67d0\u4eba\u53bb\u5546\u5e97\u4e70\u4e1c\u897f,\u53bb\u4e86$tot$\u6b21.\n\n\u6bcf\u6b21\u5e26$d_i$\u679a$c_i$\u786c\u5e01,\u4e70$s_i$\u7684\u4ef7\u503c\u7684\u4e1c\u897f.\n\n\u8bf7\u95ee\u6bcf\u6b21\u6709\u591a\u5c11\u79cd\u4ed8\u6b3e\u65b9\u6cd5.\n\n### \u9898\u89e3:\n\n\u5148\u8003\u8651\u6bcf\u79cd\u786c\u5e01\u53ef\u4ee5\u7528\u65e0\u6570\u6b21\n\n\u8bbe$f_i$\u8868\u793a\u91d1\u989d\u4e3a$i$\u6709\u591a\u5c11\u79cd\u65b9\u6848\n\n\u90a3\u4e48$\\displaystyle f_i = \\sum_{j=1}^4 f_{i-c[j](i \\ge c_j)}$\n\n\u6211\u4eec\u518d\u6765\u8003\u8651\u786c\u5e01\u4f7f\u7528\u6b21\u6570\u6709\u9650\u5236\u600e\u4e48\u529e\n\n> \u4e0d\u5408\u6cd5\u7684\u60c5\u51b5\u6709:\n>\n> 1\u8d85\u989d\n>\n> 1,2\u8d85\u989d\n>\n> 1,3\u8d85\u989d\n>\n> 1,4\u8d85\u989d\n>\n> 1,2,3\u8d85\u989d\n>\n> 1,2,4\u8d85\u989d\n>\n> 1,3,4\u8d85\u989d\n>\n> 1,2,3,4\u8d85\u989d\n>\n> ...\n>\n> \u8981\u6ce8\u610f\u7684\u662f\u5728\u591a\u79cd\u786c\u5e01\u9650\u5236\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u51cf\u53bb\u591a\u6b21,\u6216\u52a0\u4e0a\u591a\u6b21\n>\n> \u6bd4\u59821\u8d85\u989d,2\u8d85\u989d,\uff081,2\u540c\u65f6\u8d85\u989d\u88ab\u51cf\u53bb\u4e24\u6b21,\u8fd9\u662f\u5c31\u8981\u52a0\u56de\u6765\n>\n> \u800c$(1,2,3)$ \u3001$(1,2,4)$\u53c8\u662f\u591a\u7b97\u7684...\n\n\u662f\u4e0d\u662f\u66f4\u76f4\u89c2\u7684\u4e86\u89e3\u4e86\u5bb9\u65a5\uff1f\n\n\u4e3a\u4e86\u65b9\u4fbf,\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u4e8c\u8fdb\u5236\u4e0b\u72b6\u6001\u6765\u66f4\u52a0\u4f18\u7f8e\u5b9e\u73b0.\n\n(\u5f53\u6709\u5947\u6570\u79cd\u4e0d\u5408\u6cd5\u7684\u65f6\u5019\u51cf\u53bb,\u5076\u6570\u79cd\u4e0d\u5408\u6cd5\u65f6\u52a0\u4e0a)\n\n\u4ee3\u7801:\n\n```cpp\n#define N 100011\nint n,c[5],d[5],s;\nll f[N];\nint main(){\n    for(int i=1;i<=4;++i)in(c[i]);\n    f[0]=1;\n    for(int i=1;i<=4;++i)\n        for(int j=c[i];j<=100000;++j)\n            f[j]+=f[j-c[i]];\n\n    in(n);\n    while(n--){\n        for(int i=1;i<=4;++i)in(d[i]);\n        in(s);\n        ll ans=f[s];\n        for(int i=1;i<=15;++i){\n            int t=s,sta=i,k=1;\n            for(int j=1;j<=4;++j)\n            if(sta&(1<<(j-1))){\n                k=-k;\n                t-=(d[j]+1)*c[j];\n            }\n            if(t>=0)ans+=1ll*f[t]*k;\n        }\n        out(ans,ln);\n    }\n}\n```\n\n\n## [SDOI2009]Bill\u7684\u6311\u6218\n\n[\u5730\u5740](https://www.luogu.com.cn/problem/P2167)\n\n### \u9898\u610f:\n\u7ed9$n$\u4e2a\u957f\u5ea6\u76f8\u540c\u7684\u5b57\u7b26\u4e32(\u7531\u5c0f\u5199\u5b57\u6bcd\u548c`?`\u7ec4\u6210):$S_1,S_2,...,S_n$,\n\n\u6c42\u8fd9$n$\u4e2a\u4e32\u4e2d\u7684\u521a\u597d$k$\u4e2a\u4e32\u5339\u914d\u7684\u5b57\u7b26\u4e32$T$\u7684\u4e2a\u6570$\\pmod{1000003}$\n\n\u82e5$S_x$\u4e0e$T$\u5339\u914d,\u6ee1\u8db3:\n\n1. $|S_x|=|T|$\n2. $\\forall S_x[i]=?||S_x[i]=T[i]$\n\n### \u72b6\u538b\u89e3\u6cd5:\n\n\u8bbe$f[i][j]$\u8868\u793a\u5230\u4e86\u7b2c$i$\u4f4d,\u5339\u914d\u7684\u72b6\u6001\u4e3a$j$\n\n\u4ee3\u7801:\n```cpp\n#define N 111\n#define mod 1000003\n#define M(x) ((x>=mod)?(x)%=mod:x)\nint mt[N][30];\nll f[N][1<<15];\nchar ch[N][N];\nil void work(){\n    clr(mt,0);\n    clr(f,0);\n    int n,k,len;\n    in(n,k);\n    for(int i=1;i<=n;++i)in(ch[i]);\n    len=strlen(ch[1]);\n    for(int i=0;i<=len-1;++i)\n        for(char t='a';t<='z';++t)\n            for(int j=1;j<=n;++j)\n            if(ch[j][i]=='?'||ch[j][i]==t)\n                mt[i][t-'a']|=(1<<(j-1));//\u66f4\u65b0\u6bd4\u8f83\u5f53\u524d\u4f4d\u7684\u5f71\u54cd\n    f[0][(1<<n)-1]=1;\n    for(int i=0;i<=len-1;++i)\n        for(int j=0;j<(1<<n);++j)\n        if(f[i][j])\n            for(int t=0;t<=26;++t)\n                M(f[i+1][j&mt[i][t]]+=f[i][j]);\n    ll ans=0;\n    for(int i=0;i<(1<<n);++i){\n        int t=i,tt=0;\n        while(t)tt+=(t&1),t>>=1;\n        if(tt==k)M(ans+=f[len][i]);\n    }\n    out(ans,ln);\n}\nint main(){\n    int T;in(T);\n    while(T--)work();\n    flush();\n}\n```\n\n### \u5bb9\u65a5\u89e3\u6cd5:\n\n\u770b\u5230\u6070\u597d$k$\u4e2a,\u6211\u4eec\u5c31\u53ef\u4ee5\u60f3\u5230\u5bb9\u65a5\u5957\u8def\n\n\u627e\u51fa\u81f3\u5c11\u5339\u914d$k$\u4e2a\u7684\u65b9\u6848\u6570$g(k)$,\u8bbe$f(k)$\u4e3a\u6070\u597d$k$\u4e2a\u7684\u65b9\u6848\u6570\n\n\u7136\u540e\u8fd8\u662f\u6309\u5957\u8def\u5c31\u53ef\u4ee5\u4e86\n\n$$\ng(n) = \\sum_{i=k}^n {n\\choose i}f(i)\n\\\\\n\\Updownarrow\n\\\\\nf(n) = \\sum_{i=k}^n {n\\choose i}g(i) (-1)^{i-k}\n$$\n\n\u95ee\u9898\u8f6c\u6362\u4e3a\u5982\u4f55\u6c42\u81f3\u5c11\u5339\u914d$k$\u4e2a\u7684\u65b9\u6848\u6570\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528dfs\u6765\u7edf\u8ba1,\u8fd9\u6837\u6bd4\u8d77\u72b6\u538b\u601d\u7ef4\u96be\u5ea6\u53ef\u80fd\u964d\u4f4e\u4e86\u8bb8\u591a,\u53ea\u9700\u8981\u679a\u4e3e\u6392\u5217\u7ec4\u5408(\u5f53\u7136\u679a\u4e3e\u4e8c\u8fdb\u5236\u72b6\u6001\u4e5f\u53ef\u4ee5)\n\n\u72b6\u538b\u9700\u8981\u5904\u7406\u5168\u90e8\u72b6\u6001\n\ndfs\u53ea\u9700\u8981\u7edf\u8ba1$k$\uff5e$n$\u7684\u90e8\u5206\n\n\u6700\u540e\u7edf\u8ba1\u7684\u65f6\u95f4\u53ef\u5ffd\u7565\u4e0d\u8ba1\n\n\u72b6\u538b:$492ms$\n\n\u5bb9\u65a5: $100ms$\n\n\u5bb9\u65a5\u4ee3\u7801:\n\n```cpp\n#define N 111\n#define mod 1000003\nchar ch[N][N];\nint len,n,k,cnt,c[N][N],up,tot=0,las,a[N];\nvoid dfs(int x,int now){\n    if(x==n+1){\n        if(now!=up)return;\n        ll lp=1;\n        for(int j=1;j<=len;++j){\n            las=-1;\n            for(int i=1;i<=up;++i)\n            if(ch[a[i]][j]!='?'){\n                if(las==-1)\n                    las=ch[a[i]][j]-'a';\n                else if(las!=ch[a[i]][j]-'a')return;\n            }\n            if(las==-1)lp=(lp*26)%mod;\n        }\n        (tot+=lp)%=mod;\n        return;\n    }\n    if(now<up){\n        a[++cnt]=x;\n        dfs(x+1,now+1);\n        a[cnt--]=0;\n    }\n    if(n-x>=up-now)dfs(x+1,now);\n}\nll g[N];\nil void work(){\n    clr(g,0);\n    in(n,k);\n    for(int i=1;i<=n;++i)in(ch[i]+1);\n    len=strlen(ch[1]+1);\n    for(int i=k;i<=n;++i)\n        up=i;\n        tot=0;\n        dfs(1,0);\n        g[i]=tot;\n    }\n\n    // \u5bb9\u65a5\u90e8\u5206:\n    ll ans=0;\n    for(int i=k;i<=n;++i)\n        if((i-k)&1)ans=(ans-1ll*c[i][k]*g[i]%mod+mod)%mod;\n        else ans=(ans+1ll*c[i][k]*g[i]%mod)%mod;\n    out(ans,ln);\n}\nint main(){\n    for(int i=0;i<=20;++i){\n        c[i][0]=1;\n        for(int j=1;j<=i;++j)\n            c[i][j]=c[i-1][j]+c[i-1][j-1];\n    }\n    int T;in(T);\n    while(T--)work();\n    flush();\n}\n```\n\n\n\u5176\u4ed6\u6709\u5173\u5bb9\u65a5\u9898\u76ee:\n\n## Emiya \u5bb6\u4eca\u5929\u7684\u996d\n\n[\u5730\u5740](https://www.luogu.com.cn/problem/P5664)\n\n### \u9898\u610f:\n\n\u7ed9\u51fa\u4e00\u4e2a\u77e9\u9635,\u8981\u6c42\u6bcf\u884c\u53ea\u80fd\u9009\u4e00\u4e2a\u8282\u70b9,\u6bcf\u5217\u9009\u7684\u8282\u70b9\u4e0d\u80fd\u8d85\u8fc7\u6240\u6709\u9009\u7684\u8282\u70b9\u7684\u4e00\u534a,\u4e0d\u80fd\u4e0d\u9009,\n\u7ed9\u51fa\u6bcf\u4e2a\u8282\u70b9\u7684\u9009\u62e9\u65b9\u6848\u6570,\u6c42\u603b\u65b9\u6848\u6570\n\n### \u89e3\u6cd5:\n\n\u8003\u8651\u5230\u9650\u5236\u662f\u6bcf\u5217\u9009\u62e9\u7684\u4e0d\u80fd\u8d85\u8fc7\u4e00\u534a,\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u4e0d\u5408\u6cd5\u7684\u6700\u591a\u53ea\u6709\u4e00\u5217\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u603b\u65b9\u6848\u6570\u51cf\u53bb\u4e0d\u7b26\u5408\u7684\n\n$\\displaystyle s_i=\\sum_{j=1}^m a_{ij}$\n\n\u603b\u65b9\u6848\u6570:$\\displaystyle \\prod_{i=1}^n (s_i+1) - 1$\n\n$\\because k=\\frac {tot}2$\n\n\u6240\u4ee5\u6211\u4eec\u6709\u4e00\u4e2a\u5f88\u5999\u7684\u65b9\u6cd5:\n\n\u8bbe\u9009\u4e2d\u76ee\u6807\u884c\u4e4b\u5916\u7684\u6743\u503c+1,\u4e0d\u9009+0,\u9009\u4e2d\u76ee\u6807\u884c\u6743\u503c\u4f4d+2\n\n\u6700\u540e\u53ea\u8981\u6743\u503c$> n$,\u90a3\u4e48\u76ee\u6807\u884c\u4e00\u5b9a\u88ab\u9009\u4e86\u8d85\u8fc7$\\frac n2$\u6b21\n\n\u8bbe$f(i,k)$\u8868\u793a\u603b\u5171\u9009\u4e86$i$\u6b21(\u4e5f\u5c31\u662f\u9009\u5230\u7b2c$i$\u884c)\u6743\u503c\u4e3a$k$\u7684\u65b9\u6848\u6570\n\n\n$f(i,k) += f(i-1,k)\\cdot(s_i-a_{ij})$(\u5f53\u524d\u884c\u4e0d\u9009\u76ee\u6807\u5217\n\n$f(i,k+1) += f(i-1,k)$(\u5f53\u524d\u884c\u5b8c\u5168\u4e0d\u9009\n\n$f(i,k+2) += f(i-1,k)\\times a_{ij}$(\u5f53\u524d\u884c\u9009\u4e2d\u76ee\u6807\u5217\n\n$\\displaystyle ans = \\prod_{i=1}^n (s_i+1) - 1 - \\sum_{i=n+1}^{2n} f(n,i)$\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 111\ntypedef long long ll;\nconst int mod=998244353;\nint a[N][2011],n,m;\nll f[N][2011],s[N];\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=1;j<=m;++j)\n\t\t\tscanf(\"%d\",&a[i][j]),\n            s[i]=(s[i]+a[i][j])%mod;\n\n\tll ans=1;\n\tfor(int i=1;i<=n;++i)\n\t\tans=(ans*(s[i]+1))%mod;\n\n    --ans;\n\tfor(int j=1;j<=m;++j){\n        memset(f,0,sizeof f);\n        f[0][0]=1;\n        for(int i=1;i<=n;++i)\n            for(int k=0;k<=n*2;++k){\n                f[i][k]=(f[i][k]+f[i-1][k]*(s[i]-a[i][j]))%mod;\n                f[i][k+1]=(f[i][k+1]+f[i-1][k])%mod;\n                f[i][k+2]=(f[i][k+2]+f[i-1][k]*a[i][j])%mod;\n            }\n        for(int i=n+1;i<=n*2;++i)\n            ans=(ans-f[n][i])%mod;\n    }\n    printf(\"%lld\\n\",(ans+mod)%mod);\n}\n```\n\n## LG 2567 [SCOI2010]\u5e78\u8fd0\u6570\u5b57\n\n[\u5730\u5740](https://www.luogu.com.cn/problem/P2567)\n\n### \u9898\u610f:\n\n\u5b9a\u4e49\u5e78\u8fd0\u53f7\u7801\u4e3a:\u7531$6$\u6216$8$\u7ec4\u6210\u7684\u6570\u5b57\n\n\u5b9a\u4e49\u8fd1\u4f3c\u5e78\u8fd0\u53f7\u7801\u4e3a:\u5e78\u8fd0\u53f7\u7801\u7684\u500d\u6570\n\n\u6c42$[l,r]$\u4e4b\u95f4\u5e78\u8fd0\u6570\u5b57\u7684\u4e2a\u6570($1\\le l,r \\le 10^9$).\n\n### \u9898\u89e3:\n\n\u5148\u9884\u5904\u7406\u51fa\u6240\u6709\u5e78\u8fd0\u6570\u5b57\n\n\u5f53\u524d\u8981\u6c42\u7684\u662f$[l,r]$\u4e2d\u7684\u5e78\u8fd0\u6570\u5b57\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5bb9\u65a5,\u7528$[1,r]-[1,l-1]$\n\n\u5047\u8bbe\u5f53\u524d\u5e78\u8fd0\u6570\u5b57\u4e3a$x$,$[l,r]$\u4e2d\u662f$x$\u7684\u500d\u6570\u7684\u6709$\\left \\lfloor \\frac rx \\right \\rfloor - \\left \\lfloor \\frac lx \\right \\rfloor +1$\n\n$[1,r],[1,l-1]$\u4e2d\u7684\u5e78\u8fd0\u6570\u5b57\u7684\u500d\u6570\u53ef\u80fd\u6709\u4ea4\u96c6\n\n\u7ee7\u7eed\u5bb9\u65a5:\n\n\u9009$1$\u4e2a$-$\u9009$2$\u4e2a\u7684$lcm+$\u9009$3$\u4e2a\u7684$lcm-...$\n\n\u526a\u679d:\n\n1. \u53ef\u4ee5\u53d1\u73b0,\u4e00\u4e2a\u6570\u662f\u53e6\u4e00\u4e2a\u5408\u6cd5\u500d\u6570\u7684\u500d\u6570,\u90a3\u4e48\u8fd9\u4e2a\u6570\u5b57\u76f8\u5f53\u4e8e\u6ca1\u7528(\u56e0\u4e3a\u88ab\u524d\u9762\u7684\u7edf\u8ba1\u8fc7\u4e86),\u53ef\u4ee5\u5220\u6389\n\n2. \u5982\u679c\u5c06\u5e78\u8fd0\u6570\u5b57\u4ece\u5927\u5230\u5c0f\u6392\u5e8f,\u641c\u7d22\u65f6\u53ef\u4ee5\u66f4\u5feb\u7a81\u7834\u8fb9\u754c\n\n3. \u73b0\u5728\u56e0\u4e3a\u6240\u6709\u6570\u90fd\u4e0d\u6ee1\u8db3\u662f\u53e6\u5916\u4e00\u4e2a\u6570\u7684\u500d\u6570,\u6240\u4ee5\u5408\u5e76\u4efb\u610f\u4e24\u4e2a\u6570\u7684\u65f6\u5019,$lcm$\u7684\u6700\u5c0f\u60c5\u51b5\u5c31\u662f\u4e58\u4e0a\u4e00\u4e2a$3$,\n\n   \u6240\u4ee5\u5bf9\u4e8e\u6240\u6709$>r/3$\u7684\u5408\u6cd5\u6570\u5b57,\u663e\u7136\u4e0d\u80fd\u591f\u548c\u4efb\u4f55\u4e00\u4e2a\u6570\u5408\u5e76\u4e86,\u6240\u4ee5\u8fd9\u4e00\u90e8\u5206\u53ef\u4ee5\u62ff\u51fa\u6765\u76f4\u63a5\u63d0\u524d\u7b97\u597d\n\n\u5269\u4e0b\u7684\u76f4\u63a5\u66b4\u641c\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define N 100011\nint tot=0,t=0;\nll ans=0,l,r,a[N];\nbool v[N];\ninline void init(){\n    int h=0;\n    while(h<=tot){\n        ll x=a[h++]*10;\n        if(x+6<=r)a[++tot]=x+6;\n        if(x+8<=r)a[++tot]=x+8;\n    }\n}\nconst int mod=1000000007;\ninline bool chk(ll a,ll b){\n    int A=a/mod,B=b/mod;\n    if(A*B)return 1;\n    return a*b>r;\n}\nvoid calc(int x,ll s,int k){\n    if(x>tot){\n        if(s!=1){\n            if(k&1)ans+=r/s-l/s;\n            else ans-=r/s-l/s;\n        }\n        return;\n    }\n    calc(x+1,s,k);\n    ll d=a[x]/__gcd(s,a[x]);\n    if(!chk(s,d))calc(x+1,s*d,k+1);\n}\ninline void work(){\n    sort(a+1,a+tot+1);\n    for(int i=1;i<=tot;++i)\n        for(int j=1;j<i;++j)\n        if(a[i]%a[j]==0){\n            v[i]=1;\n            break;\n        }\n\n    for(int i=1;i<=tot;++i)\n    if(!v[i]){\n        if(a[i]<=r/3)a[++t]=a[i];\n        else ans+=r/a[i]-l/a[i];\n    }\n    tot=t;\n    reverse(a+1,a+tot+1);\n    calc(1,1,0);\n    printf(\"%lld\\n\",ans);\n}\nint main(){\n    cin>>l>>r;\n    --l;\n    init();//\u627e\u51fa\u6240\u6709\"\u5e78\u8fd0\u53f7\u7801\"\n    work();\n}\n```", "link": "/posts/\u5bb9\u65a5/", "tags": ["\u6570\u8bba", "\u5bb9\u65a5", "\u53cd\u6f14", "\u7ec4\u5408\u6570", "\u4e8c\u9879\u5f0f\u53cd\u6f14"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "csp-s-2019-\u6e38\u8bb0", "content": "## \u8d5b\u540e\u603b\u7ed3\n\n\u5176\u5b9e\u611f\u89c9\u8fd9\u6b21\u6253\u7684\u5931\u8bef\u633a\u591a\u7684\u3002\n\n### day1:\n\n1. t1\u5176\u5b9e\u5c31\u662f\u4e2a\u4e8c\u5206\u6216\u8005\u9012\u5f52\u6a21\u62df\u4e00\u4e0b\u5c31\u597d\u4e86($2^{64}$\u8981\u7279\u5224\u4e00\u4e0b)\n2. t2\u770b\u5230\u662f\u62ec\u53f7\u5e8f\u5217\u8fd9\u6837\u7684\u5957\u8def\u4e5f\u8fd8\u53ef\u4ee5\u63a5\u53d7,\u5c31\u662f\u6bcf\u4e2a\u70b9\u7684\u7b54\u6848\u5c31\u662f\u7236\u8282\u70b9\u7684\u7b54\u6848\u52a0\u4e0a\u5b83\u81ea\u5df1\u7684\u8d21\u732e(\u4ee5\u5b83\u7ed3\u5c3e\u7684\u5408\u6cd5\u5b50\u4e32\u6709\u591a\u5c11\u4e2a),(\u65e9\u77e5\u9053\u8fd8\u662f\u5faa\u89c4\u8e48\u77e9\u5199$O(n \\log n)$\u7684,\u975e\u8981\u5199$O(n)$,\u53ef\u80fd\u54c8\u5e0c\u6216\u8005\u5176\u4ed6\u5730\u65b9\u5199\u70b8\u4e86,\u53ef\u80fd50\u5206\u4fdd\u5e95)\n3. \u56e0\u4e3a\u8c03t2,t3\u4e5f\u6ca1\u65f6\u95f4\u6253\u66b4\u529b\u4e86,\u5927\u5931\u8d25,\u5509\n\n\n\n### day2:\n\n1. t1\u5e94\u8be5\u662f\u52a8\u6001\u89c4\u5212+\u5bb9\u65a5,\u53ef\u60dc\u8c03\u70b8\u4e86,\u66b4\u529b\u4e5f\u6ca1\u6765\u5f97\u53ca\u8c03\u597d\n2. t2\u5df2\u7ecf\u60f3\u51fa\u4e86$n^2$\u7684dp,\u8fc7\u4e86\u5927\u6837\u4f8b,\u5c1d\u8bd5\u8fc7\u7528\u5355\u8c03\u961f\u5217,\u7ebf\u6bb5\u6811,\u4e8c\u5206\u7b49\u4f18\u5316,\u53ef\u90fd\u70b8\u4e86(\u6709\u70b9\u5fc3\u6001\u5d29\u4e86)\n3. t3\u7684\u8bdd\u628a$n^2$\u66b4\u529b\u548c\u94fe\u7684\u66b4\u529b\u5feb\u901f\u6253\u5b8c\u5c31\u5fc3\u6ee1\u610f\u8db3\u5730\u8d70\u4e86\u3002(c\u62ff\u7684\u6bd4a\u8fd8\u591a)\u3002\u4ed4\u7ec6\u60f3\u4e86\u60f3\u5e94\u8be5\u662f\u6811\u578bdp,\u4f46\u662f\u4e5f\u6ca1\u8fd9\u4e2a\u8d44\u672c\u53bb\u8c03\u51fa\u6765\n\nwc\u5e94\u8be5\u662f\u83ab\u5f97\u4e86,\u4f46\u662f\u4e00\u7b49\u5e94\u8be5\u8fd8\u662f\u6709\u7684\n\n\u53ef\u4ee5\u8bf4\u662f\u95ee\u5fc3\u65e0\u6127\u4e86,\u8c01\u53eb\u5b83\u4eca\u5e74\u8003\u7684\u90fd\u6ca1\u7279\u610f\u53bb\u590d\u4e60\u5230,\u8fd8\u51fa\u4e86noi\u96be\u5ea6(~~\u82b1\u4e86$\\frac15$\u7684\u94b1\u53c2\u52a0\u4e86noi,\u5927\u8d5a~~)\n\n\u5f53\u505a**\u6559\u8bad**\u5427,\u4e4b\u540e\u4e5f\u4e0d\u80fd\u5bf9\u6570\u636e\u7ed3\u6784\u90a3\u4e48\u4e13\u4e00\u4e86\n\n\u4e89\u53d6\u80fd~~\u62cd\u5e73~~\u6211\u7684\u7b97\u6cd5\u6280\u80fd\u6811\u5427\n\n> \u6709\u5fc3\u7ffb\u76d8,\u65e0\u529b\u56de\u5929,\u6b7b\u5f97\u5176\u6240,\u5feb\u54c9\uff01\u5feb\u54c9\uff01\n\n## \u6e38\u8bb0\n\nemmm\n\n\u8fd9\u6b21\u53bb\u5e7f\u5dde\u5176\u5b9e\u633a\u9ad8\u5174\u7684\n\n\u7b2c\u4e00\u5929\u53bb\u4e86\u9152\u5e97\u505c\u7535,\u6211\u4eec\u6b63\u597d\u51fa\u53bb\u770b\u4e86**\u300a\u6d77\u4e0a\u94a2\u7434\u5e08\u300b**\u7684\u590d\u523b,\u679c\u7136\u7ecf\u5178\u7684\u7535\u5f71\u8fd8\u662f\u597d\u770b\u5440\n\n\u5728\u5bbe\u9986\u5468\u56f4\u901b\u7684\u65f6\u5019\u53c8\u80fd\u6b23\u8d4f\u5e7f\u5dde\u5854\u7684\u591c\u666f,\u503c\u4e86(~~\u6ca1\u94b1\u4e0a\u53bb~~)\n\n\u7b2c\u4e8c\u5929\u4e0b\u5348\u5728\u5bbe\u9986\u548c\u670b\u53cb\u4eec\u6253\u4e86\u4e00\u4e0b\u5348\u7684\u724c,\u771f\u7684\u4e00\u5e74\u96be\u5f97\u51e0\u6b21,\u5927\u5bb6\u90fd\u975e\u5e38\u9ad8\u5174,\u53ef\u9ad8\u5174\u4e4b\u4f59\u5374\u88ab\u4f24\u611f\u586b\u5145,\u8bb8\u591a\u9ad8\u4e8c\u7684\u5e08\u5144\u4eec\u5c31\u8fd9\u4e48\u9000\u5f79\u4e86,\u5509\u3002(\u5e0c\u671b\u5230\u65f6\u5019\u6253acm\u7684\u65f6\u5019\u8fd8\u80fd\u518d\u6b21\u76f8\u9047\u5427)\n\n(\u50cfzn,lg,csl,...\u4ed6\u4eec\u90fd\u662f\u5f88\u5584\u826f\u7684\u5b66\u957f,\u4f46\u53ef\u80fd\u90fd\u56e0\u6b64\u9000\u5f79\u4e86qwq)\n\n\n\n\u7b2c\u4e8c\u5929\u665a\u4e0a,\u610f\u60f3\u4e0d\u5230\u7684\u4e8b\u53d1\u751f\u4e86\n\n>  \u6211\u4eec\u627e\u4e86\u5176\u4ed6oier\u9762\u57fa\n>\n> \u7136\u540e\u4ed6\u5e26\u4e86\u4e24\u5957\u5973\u88c5\n>\n> \u7136\u540e\u4ed6\u81ea\u5df1\u5148\u7a7f\u4e86\n>\n> \u7136\u540e\u6211\u6ca1\u62cd\u8138\u53d1\u5230\u7fa4\u4e0a\n>\n> \u7136\u540e\u88ab\u6559\u7ec3\u770b\u89c1\u4e86\n>\n> \u6559\u7ec3\u76f4\u63a5\u53d1\u4e86\u53e5\u201c\u5973\u88c5\u5927\u4f6c/se)\u201d\n>\n> \u7136\u540e\u53c8\u53d1\u4e86\u53e5\"\u5148\u522b\u8131\u6389,\u7b49\u6211\u8fc7\u53bb\"\n>\n> \u63a5\u7740\u90a3\u4e2aoier\u679c\u65ad\u8131\u6389,\u8bf4\u521a\u521a\u662f\u8c01\u8bf4\u8981\u5973\u88c5\u6765\u7740(\u53ef\u771f\u6b63\u8981\u5973\u88c5\u7684lyl\u8dd1\u51fa\u53bb\u6070\u996d\u4e86)\n>\n> \u6211\u53ea\u80fd\u786c\u7740\u5934\u76ae\u7a7f\u4e0a,\u8981\u4e0d\u7136\u600e\u4e48\u4e5f\u89e3\u91ca\u4e0d\u6e05\u695a\n>\n> \u7b49\u6211\u6362\u5b8c\u8863\u670d\u4ece\u5395\u6240\u51fa\u6765,\u53d1\u73b0\u6211\u4eec\u5b66\u6821\u7684oier\u5168\u90e8\u8dd1\u6765\u6211\u623f\u95f4\u4e86(\u6559\u7ec3\u90fd\u6765\u770b\u4e86\n>\n> \u975e\u5e38\u7f9e\u803b\n>\n> \u7136\u540e\u4ed6\u4eec\u8702\u62e5\u800c\u4e0a\n>\n> \u5168\u90e8\u62ff\u7740\u624b\u673a\u5728\u62cd\n>\n> \u6211\u8d76\u5feb\u8dd1\u5230\u7a97\u5e18\u540e\u9762\u8eb2\u8d77\u6765\n>\n> \u53ef\u8fd8\u662f\u88ab\u63ea\u51fa\u6765\u4e86\n>\n> to be continued ...\n>\n> --\u610f\u8bc6\u4e2d\u65ad\n>\n> \u8fc7\u4e86\u4e00\u4f1a\u513f,\u6559\u7ec3\u5f00\u53e3\u4e86:\"\u5973\u5b69\u7eb8\u8fd9\u6c34\u5e73\u8981\u4e89\u53d6\u8fdb\u7701\u961f\"\n\n~~\u8fd9\u4e0b\u53ef\u51fa\u540d\u4e86~~\n\n\u5173\u4e8e\u5973\u88c5\u540e\u7684\u611f\u53d7\uff1a\n\n>  \u4e0d\u8fc7\u5176\u5b9e\u5973\u88c5\u7684\u611f\u89c9\u633a\u597d\u7684\n>\n> \u7b2c\u4e00\u611f\u89c9\u5c31\u662f \u6863 \u4e0b \u751f \u98ce\uff08\u53ef\u80fd\u590f\u5929\u4f1a\u66f4\u723d\uff1f\n>\n> \u4e00\u5f00\u59cb\u5728\u5395\u6240\u4e00\u770b\u955c\u5b50,\u50cf\u5f53\u81ea\u5df1npy,qwq\n>\n> \u53ef\u80fd\u5973\u88c5\u5f88\u5bb9\u6613\u5c31\u523a\u6fc0\u5230\u4e86\u5c11\u5973\u5fc3\u5427\n>\n> \u88d9\u5b50\u5c31\u628a\u5927(\u7c97)\u817f\u906e\u4f4f\u4e86,\u5c0f\u817f\u53c8\u7626,\u8fd8\u6709\u9ed1\u957f\u7b52\u889c..\n>\n> \u7a81\u7136\u4e5f\u89c9\u5f97\u81ea\u5df1\u817f\u6709\u70b9\u7ec6\uff08~~\u5c45\u7136\u8fd8\u88abcsl\u59d0\u59d0\u5938\u4e86~~\n>\n> ~~(\u5982\u679c\u81ea\u5df1\u662f\u5973\u751f\u662f\u4e0d\u662f\u4e5f\u633a\u4e0d\u9519\u7684\u5462\uff1f~~\n>\n> ~~\u5982\u679c\u6765\u4e2a\u9e2d\u5b50\u5750\u2026\u2026~~\n>\n> \u6211\u90fd\u5728\u60f3\u4e9b\u4ec0\u4e48\u554a.........................\n>\n> (\u8981\u7206\u7167\u7684\u8bdd\u79c1\u4fe1qq 3088482189,\u6216luogu id: mimi)\n\n\u592a\u7f9e\u803b\u4e86\n\n\u56de\u53bb\u8981\u600e\u4e48\u8ddf\u73ed\u4e3b\u548c\u540c\u5b66\u89e3\u91ca\u554a....(\u5e78\u4e8f\u7238\u5988\u8fd8\u4e0d\u77e5\u9053)\n\n\n\n\u7b2c\u4e09\u5929\u56de\u6765\u8def\u4e0a\u4e5f\u662f\u5237\u7740\u77e5\u4e4e,\u770b\u7740\u8f66\u5916\u7684\u98ce\u666f,\u83ab\u540d\u6709\u70b9\u4f24\u611f\n\nqwq\n\n$qwq$\n\n$QwQ$\n\n\u5e0c\u671b\u4e4b\u540e\u4e00\u5207\u90fd\u4f1a\u597d\u8d77\u6765\u7684\n\n\n\n~~\u9884\u544a\uff1a\u4e0b\u6b21\u53ef\u4ee5\u770b\u6211npy\u5973\u88c5\u4e86~~", "link": "/posts/csp-s-2019-\u6e38\u8bb0/", "tags": ["\u6e38\u8bb0"], "categories": [["\u6e38\u8bb0"]]}, {"title": "\u9759\u6001\u94fe\u5206\u6cbb", "content": "\u9759\u6001\u94fe\u5206\u6cbb\u7528\u4e8e\u89e3\u51b3\u9759\u6001\u6811\u4e0a\u4f17\u6570\u95ee\u9898,\u6bd4\u5982[$Codeforces\\ 600E$](https://www.luogu.org/problem/CF570D)\n\n\u9759\u6001\u94fe\u5206\u6cbb\u662f\u79bb\u7ebf\u7b97\u6cd5,\u6709\u70b9\u50cf\u83ab\u961f,\u590d\u6742\u5ea6$\\Theta (n \\log n \\log n)$\n\n\u6bd4\u5982\u8bf4\u904d\u5386\u4e00\u904d\u5b50\u6811\u53ef\u4ee5\u5f97\u51fa\u7b54\u6848,\u4f46\u662f\u6bcf\u68f5\u5b50\u6811\u90fd\u904d\u5386\u7684\u8bdd\u592a\u6162\u4e86,\n\n\u6211\u4eec\u7528\u6811\u5256\u7684\u65b9\u5f0f\u628a\u6bcf\u4e2a\u8282\u70b9\u7684\u91cd\u513f\u5b50\u5212\u5206\u51fa\u6765,\n\n\u904d\u5386\u8fd9\u4e2a\u5b50\u6811\u7684\u65f6\u5019\u5148\u904d\u5386\u8f7b\u513f\u5b50,\u518d\u904d\u5386\u91cd\u513f\u5b50,\u904d\u5386\u91cd\u513f\u5b50\u540e\u7b54\u6848\u4e0d\u6e05\u7a7a,\u6211\u4eec\u5c31\u53ef\u4ee5\u7701\u4e0b\u904d\u5386\u91cd\u513f\u5b50\u7684\u65f6\u95f4\n\n\u51e0\u9053\u7ec3\u624b\u7684\u9898\uff1a\n\n[CF 375D Tree and Queries](https://www.luogu.org/problem/CF375D)\n\n[CF570D Tree Requests](https://www.luogu.org/problem/CF570D)\n\n[CF208E Blood Cousins](https://www.luogu.org/problem/CF208E)\n\n", "link": "/posts/\u9759\u6001\u94fe\u5206\u6cbb/", "tags": ["\u7b97\u6cd5", "\u6280\u5de7", "\u6811", "\u9759\u6001\u94fe\u5206\u6cbb"], "categories": [["\u7b97\u6cd5", "\u6811\u8bba"], ["note"]]}, {"title": "\u70b9\u5206\u6cbb", "content": "# \u70b9\u5206\u6cbb\n\n\u70b9\u5206\u6cbb\u7528\u4e8e\u5927\u89c4\u6a21\u5904\u7406\u6811\u4e0a\u8def\u5f84\n\n## \u6811\u7684\u91cd\u5fc3\n\n\u6811\u7684\u6700\u5927\u5b50\u6811\u6700\u5c0f\u7684\u70b9\n\n\u6027\u8d28:\u6bcf\u4e00\u4e2a\u5b50\u6811\u7684\u5927\u5c0f\u90fd\u4e0d\u8d85\u8fc7$\\frac n2$\n\n```cpp\nint rt,mxs=inf,siz[N];// \u5f53\u524d \u6839,\u6700\u5927\u5b50\u6811\u5927\u5c0f\nvoid frt(int x,int f){\n    siz[x]=1;\n    int res=0;\n    fl(i,x)if(!v[to]&&to!=f){\n        frt(to,x);\n        siz[x]+=siz[to];\n        res=max(res,siz[to]);\n    }\n    res=max(res,SZ-siz[x]);\n    /*\n     SZ\u662f\u5f53\u524d\u6811\u5927\u5c0f\n     \n     \u56e0\u4e3a\u662f\u65e0\u6839\u6811,\u6240\u4ee5\u9664\u4e86\u81ea\u5df1\u7684\u5b50\u6811\u5916\u7684\u90e8\u5206\u4e5f\u8981\u5f53\u505a\u4e00\u68f5\u5b50\u6811\n     */\n    if(res<mxs)rt=x,mxs=res;\n}\n```\n\n## \u5b9e\u73b0\n\n```cpp\nvoid sol(int x){\n    v[x]=1;//\u6807\u8bb0\u4e3a\u5df2\u7edf\u8ba1\n    ans+=calc(x,0);//\u627e\u51fa\u5f53\u524d\u8282\u70b9\u7684\u7b54\u6848\n    fl(i,x)if(!v[to]){\n        ans-=calc(to,e[i].w);//\u51cf\u53bb\u91cd\u590d\u7684\n        rt=0,mxs=inf;SZ=siz[to];\n        frt(to,0);//\u627e\u51fa\u5b50\u6811\u7684\u91cd\u5fc3\n        sol(rt);//\u8fdb\u5165\u5b50\u6811,\u7ee7\u7eed\u5206\u6cbb\n    }\n}\n```\n\n<html>\n<svg width=\"300px\" height=\"300px\" _=\"SVGRoot\"><g _=\"EditableGraph\"><g _=\"SVGGroup\"><g _=\"GraphEdge\"><path d=\"M 136.77083333333331 39 L 71.77083333333334 128.30729166666666\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 136.77083333333331 39 L 71.77083333333334 128.30729166666666\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 136.77083333333331 39 L 201.7708333333334 128.30729166666666\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 136.77083333333331 39 L 201.7708333333334 128.30729166666666\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 71.77083333333334 128.30729166666666 L 39.27083333333333 239.6875\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 71.77083333333334 128.30729166666666 L 39.27083333333333 239.6875\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 71.77083333333334 128.30729166666666 L 104.27083333333333 239.6875\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 71.77083333333334 128.30729166666666 L 104.27083333333333 239.6875\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 201.7708333333334 128.30729166666666 L 169.27083333333331 239.6875\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 201.7708333333334 128.30729166666666 L 169.27083333333331 239.6875\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 201.7708333333334 128.30729166666666 L 234.27083333333334 239.6875\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 201.7708333333334 128.30729166666666 L 234.27083333333334 239.6875\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g></g><g _=\"SVGGroup\"><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"136.77083333333331\" cy=\"39\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"136.77083333333331\" y=\"39\" style=\"user-select: none;\" _=\"SVGText\">1</text></g><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"71.77083333333334\" cy=\"128.30729166666666\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"71.77083333333334\" y=\"128.30729166666666\" style=\"user-select: none;\" _=\"SVGText\">2</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"201.7708333333334\" cy=\"128.30729166666666\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"201.7708333333334\" y=\"128.30729166666666\" _=\"SVGText\" style=\"user-select: none;\">3</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"39.27083333333333\" cy=\"239.6875\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"39.27083333333333\" y=\"239.6875\" style=\"user-select: none;\" _=\"SVGText\">4</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"104.27083333333333\" cy=\"239.6875\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"104.27083333333333\" y=\"239.6875\" style=\"user-select: none;\" _=\"SVGText\">5</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"169.27083333333331\" cy=\"239.6875\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"169.27083333333331\" y=\"239.6875\" style=\"user-select: none;\" _=\"SVGText\">6</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"234.27083333333334\" cy=\"239.6875\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"234.27083333333334\" y=\"239.6875\" _=\"SVGText\" style=\"user-select: none;\">7</text></g></g></g></svg>\n</html>\n\n\u4ece\u70b9$1$\u5f00\u59cb\u7684\u8def\u5f84\u6709\uff1a\n\n$1\\rightarrow 2$\n\n$1\\rightarrow 2\\rightarrow 4$\n\n$1\\rightarrow 2\\rightarrow 5$\n\n$1\\rightarrow 3$\n\n$1\\rightarrow 3\\rightarrow 6$\n\n$1\\rightarrow 3\\rightarrow 7$\n\n\u6709\u4e9b\u8def\u5f84\u5408\u5e76\u8d77\u6765\u540e,\u5e76\u4e0d\u4f1a\u7ecf\u8fc7\u70b9$1$,\u8981\u51cf\u53bb\u8fd9\u90e8\u5206\u7684\u7b54\u6848\n\n\u6bd4\u5982$1\\rightarrow 2\\rightarrow 4$\u548c$1\\rightarrow 2\\rightarrow 5$\u5408\u5e76\u8d77\u6765\u5176\u5b9e\u662f\uff1a\n\n$4\\rightarrow 2\\rightarrow 5$,\u5e76\u6ca1\u6709\u7ecf\u8fc7$1$\n\n## \u5408\u5e76\u7edf\u8ba1\u8def\u5f84\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a \u6c42\u957f\u5ea6\u4e3a$k$\u7684\u8def\u5f84\u6570\n\n\u6211\u4eec\u5c06\u4ece$x$\u5f00\u59cb\u7684\u6240\u6709\u8def\u5f84\u7684\u957f\u5ea6\u6c42\u51fa\u6765\u5b58\u5230\u6570\u7ec4\u4e2d\n\n\u6392\u5e8f\u53ef\u4ee5\u7528\u7c7b\u4f3c\u53cc\u6307\u9488\u7684\u65b9\u6cd5\u626b\u63cf\n\n\u5982\u679c$k$\u7684\u503c\u8f83\u5c0f\u7684\u8bdd\u53ef\u4ee5\u7528\u6876\u7684\u65b9\u5f0f\u6765\u7edf\u8ba1\n\n```cpp\n// get dis,\u83b7\u53d6\u4ecex\u5f00\u59cb\u7684\u6240\u6709\u8def\u5f84\u7684\u957f\u5ea6\nvoid gd(int x,int d,int f){\n    if(d>k)return;\n    b[++tt]=d;\n    fl(i,x)if(!v[to]&&to!=f)gd(to,d+1,x);\n}\nll calc(int x,int d){// d\u662fx\u7684\u6df1\u5ea6(\u7528\u6765\u51cf\u53bb\u5b50\u6811\u4e2d\u591a\u4f59\u90e8\u5206\u65f6\u7528\u5230)\n    tt=0;gd(x,d,0);\n    sort(b+1,b+tt+1);\n    int l=0,r=tt;\n    ll res=0;\n    while(l<r){\n        ++l;\n        while(b[l]+b[r]>k&&l<r)--r;\n        if(b[l]+b[r]==k){\n            int t1=1,t2=1;// \u7edf\u8ba1\u4e24\u8fb9\u7684\u4e2a\u6570\n            while(l<r&&b[l]==b[l+1])++l,++t1;\n            while(l<r&&b[r]==b[r-1])--r,++t2;\n            if(b[l]!=b[r])res+=1ll*t1*t2;\n            else res+=1ll*(t1+t2)*(t1+t2-1)/2ll;\n            //\u5c06\u6240\u6709\u957f\u5ea6\u4e3ak/2\u7684\u8def\u5f84\u7ec4\u5408\n        }\n    }\n    return res;\n}\n```\n\n## \u4f8b\u9898\n\n### CF161D Distance in Tree\n\n[CodeForces 161D Distance in Tree](https://www.luogu.com.cn/problem/CF161D)\n\n> \u8f93\u5165\u70b9\u6570\u4e3a$N$\u4e00\u68f5\u6811\n> \n> \u6c42\u6811\u4e0a\u957f\u5ea6\u6070\u597d\u4e3a$K$\u7684\u8def\u5f84\u4e2a\u6570\n\n\u6a21\u677f\u9898\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 500011\n#define inf 1000000000\n#define ll long long\nint n,k,cnt=0,SZ,rt,mxs,head[N],siz[N];\nbool v[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nvoid frt(int x,int f){\n    siz[x]=1;\n    int res=0;\n    fl(i,x)if(!v[to]&&to!=f){\n        frt(to,x);\n        siz[x]+=siz[to];\n        res=max(res,siz[to]);\n    }\n    res=max(res,SZ-siz[x]);\n    if(res<mxs)rt=x,mxs=res;\n}\nint b[N],tt;\nll ans=0;\nvoid gd(int x,int d,int f){\n    if(d>k)return;\n    b[++tt]=d;\n    fl(i,x)if(!v[to]&&to!=f)gd(to,d+1,x);\n}\nll calc(int x,int d){\n    tt=0;gd(x,d,0);\n    sort(b+1,b+tt+1);\n    int l=0,r=tt;\n    ll res=0;\n    while(l<r){\n        ++l;\n        while(b[l]+b[r]>k&&l<r)--r;\n        if(b[l]+b[r]==k){\n            int t1=1,t2=1;\n            while(l<r&&b[l]==b[l+1])++l,++t1;\n            while(l<r&&b[r]==b[r-1])--r,++t2;\n            if(b[l]!=b[r])res+=1ll*t1*t2;\n            else res+=1ll*(t1+t2)*(t1+t2-1)/2ll;\n        }\n    }\n    return res;\n}\nvoid sol(int x){\n    v[x]=1;ans+=calc(x,0);\n    fl(i,x)if(!v[to]){\n        ans-=calc(to,1);\n        rt=0,mxs=inf;SZ=siz[to];\n        frt(to,0);\n        sol(rt);\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&k);\n    int x,y;\n    for(int i=1;i<=n-1;++i)\n        scanf(\"%d%d\",&x,&y),\n        add(x,y),add(y,x);\n    \n    rt=0,mxs=inf,SZ=n;\n    frt(1,0);\n    sol(rt);\n    printf(\"%lld\\n\",ans);\n}\n```\n\n### [\u56fd\u5bb6\u96c6\u8bad\u961f]\u806a\u806a\u53ef\u53ef\n\n[LG P2634 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u806a\u806a\u53ef\u53ef](https://www.luogu.com.cn/problem/P2634)\n\n[BZ 2152 \u806a\u806a\u53ef\u53ef](https://remmina.github.io/BZPRO/JudgeOnline/2152.html)\n\n\u4e5f\u53ef\u4ee5\u7b97\u662f\u6a21\u677f\u5427\n\n\u8fd9\u4e2a\u5c31\u662f\u7528\u6876\u6765\u7edf\u8ba1\u4e86\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 20011\nint n,cnt=0,head[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<1];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nint siz[N],SZ,rt,mxs,ans=0,b[3];\nbool v[N];\nvoid frt(int x,int f){\n    siz[x]=1;\n    int res=0;\n    fl(i,x)if(!v[to]&&to!=f){\n        frt(to,x);\n        siz[x]+=siz[to];\n        res=max(res,siz[to]);\n    }\n    res=max(res,SZ-siz[x]);\n    if(res<mxs)rt=x,mxs=res;\n}\nvoid gd(int x,int d,int f){\n    ++b[d%3];\n    fl(i,x)if(!v[to]&&to!=f)gd(to,d+e[i].w,x);\n}\nint calc(int x,int d){\n    b[0]=b[1]=b[2]=0;\n    gd(x,d,0);\n    return b[0]*b[0]+b[1]*b[2]*2;\n}\nvoid sol(int x){\n    v[x]=1;\n    ans+=calc(x,0);\n    fl(i,x)if(!v[to]){\n        ans-=calc(to,e[i].w);\n        rt=0,mxs=(1<<30),SZ=siz[to];\n        frt(to,x);\n        sol(rt);\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    int x,y,w;\n    for(int i=1;i<=n-1;++i)\n        scanf(\"%d%d%d\",&x,&y,&w),\n        add(x,y,w),\n        add(y,x,w);\n    \n    rt=0,mxs=(1<<30);SZ=n;\n    frt(1,0);\n    sol(rt);\n    int fm=n*n,gcd=__gcd(fm,ans);\n    fm/=gcd;ans/=gcd;\n    printf(\"%d/%d\\n\",ans,fm);\n}\n```", "link": "/posts/\u70b9\u5206\u6cbb/", "tags": ["\u7b97\u6cd5", "\u6811", "\u5206\u6cbb", "\u6280\u5de7"], "categories": [["\u7b97\u6cd5", "\u6811\u8bba"], ["note"]]}, {"title": "\u6570\u8bba\u5b9a\u7406", "content": "## Lucas\u5b9a\u7406\n\n$$C_n^m\\pmod p\\equiv C_{n\\mod p}^{m\\mod p}*C_{\\lfloor n/p\\rfloor}^{\\lfloor m/p\\rfloor}\\pmod p$$\n\n\u5c31\u662f\u4e00\u4e2a\u7ec4\u5408\u6570\u53ef\u4ee5\u62c6\u6210$P$\u8fdb\u5236\u4e0b\u7684\u4e58\u79ef\n\n\u8fd9\u4e2a\u7b97\u6cd5\u53ef\u4ee5\u5904\u7406\u5f53$m,n$\u975e\u5e38\u5927\u7684\u65f6\u5019\u7684\u53d6\u6a21\n\n\u6269\u5c55\uff1a\u4ec5\u5f53$(n\\&m)=m$\u65f6,$C(n,m) \\equiv 1 \\bmod 2$\n\n## \u88f4\u8700\u5b9a\u7406\n\n$ax+by=c(x\\in Z^*,y\\in Z^*)\\Leftrightarrow\\gcd(a,b)|c$\n\n## \u6b27\u62c9\u5b9a\u7406\n\n\u82e5$\\gcd(a,p)=1$(\u4e92\u8d28),\u90a3\u4e48$a^{\\varphi(p)} \\equiv 1 \\pmod p$\n\n## \u8d39\u9a6c\u5c0f\u5b9a\u7406(\u6b27\u62c9\u5b9a\u7406\u7279\u4f8b)\n\n\u5bf9\u4e8e\u8d28\u6570$p$,\u4efb\u610f\u6574\u6570$a$,\u5747\u6ee1\u8db3\uff1a\n$a^p \\equiv a \\pmod p$\n\n## \u6b27\u62c9\u5b9a\u7406\u7684\u63a8\u8bba\n\n\u82e5$\\gcd(a,p)=1$,\u90a3\u4e48\u5bf9\u4e8e\u4efb\u610f\u6b63\u6574\u6570$b$,\u6709\uff1a\n\n$a^b \\equiv a^{b \\mod \\varphi(p)} \\bmod n$\n\n## \u6269\u5c55\u6b27\u62c9\u5b9a\u7406\n\n\u5f53$b\\ge \\varphi(m)$\u65f6,$a^b \\equiv a^{(b \\mod \\varphi(m))+\\varphi(m)} \\pmod m$\n\n## \u5361\u7279\u5170\u6570\n\n$1,1,2,5,14,42,132,429,1430,4862,...$(\u4ece\u7b2c$0$\u9879\u5f00\u59cb)\n\n$$\nf_1=1\n\\\\\nf_n=\\sum_{i=1}^{n-1}f_if_{n-i-1}\n\\\\\nf_n=\\frac{1}{n+1}{2n\\choose n}\n\\\\\nf_{n+1}=\\frac{4n+2}{n+2}f_n\n$$\n", "link": "/posts/\u6570\u8bba\u5b9a\u7406/", "tags": ["\u6570\u8bba"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "\u6811\u4e0a\u83ab\u961f", "content": "\u524d\u7f6e\u77e5\u8bc6: \u83ab\u961f\u7b97\u6cd5(Mo's Algorithm)\n\n## \u6811\u4e0a\u83ab\u961f:\n\n\u4e5f\u5c31\u662f\u628a\u83ab\u961f\u642c\u5230\u6811\u4e0a\n\n\u5165\u624b\u6a21\u677f: [SP10707 COT2 - Count on a tree II](https://www.luogu.com.cn/problem/SP10707)\n\n> \u7ed9\u5b9a\u4e00\u4e2an\u4e2a\u8282\u70b9\u7684\u6811,\u6bcf\u4e2a\u8282\u70b9\u8868\u793a\u4e00\u4e2a\u6574\u6570,\u95eeu\u5230v\u7684\u8def\u5f84\u4e0a\u6709\u591a\u5c11\u4e2a\u4e0d\u540c\u7684\u6574\u6570\u3002\n\n\u8981\u628a\u83ab\u961f\u642c\u5230\u6811\u4e0a,\u90a3\u6211\u4eec\u5982\u4f55\u628a\u6811\u4e0a\u95ee\u9898\u8f6c\u5316\u5230\u5e8f\u5217\u4e0a\u5462? \u6b27\u62c9\u5e8f\n\n### \u6b27\u62c9\u5e8f\n\n\u6b27\u62c9\u5e8f\u5c31\u662f\u524d\u5e8f\u904d\u5386\u65f6,\u5728\u904d\u5386\u5230$x$\u65f6\u5c06$x$\u52a0\u5165\u5e8f\u5217,\u79bb\u5f00$x$\u5b50\u6811\u65f6\u518d\u5c06$x$\u52a0\u5165\u5e8f\u5217\n\n```cpp\nvoid dfs(int x){\n    T[st[x]=++dfn]=x;//\u52a0\u5165\u5e8f\u5217\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){//\u904d\u5386x\u7684\u513f\u5b50\n        f[to]=x;\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n    T[ed[x]=++dfn]=x;//\u52a0\u5165\u5e8f\u5217\n}\n```\n\n### \u5b9e\u73b0\n\n\u8fd9\u91cc\u6211\u4eec\u8bbe$st_i$\u8868\u793a\u8bbf\u95ee\u5230$i$\u65f6\u52a0\u5165\u6b27\u62c9\u5e8f\u7684\u65f6\u95f4,$ed_i$\u8868\u793a\u56de\u6eaf\u7ecf\u8fc7$i$\u65f6\u52a0\u5165\u6b27\u62c9\u5e8f\u7684\u65f6\u95f4\n\n\u4e0d\u59a8\u8bbe$st_x<st_y$\n\n\u82e5$lca(x,y)==x$,$x,y$\u5728\u4e00\u6761\u94fe\u4e0a,\u90a3\u4e48\u7edf\u8ba1\u5e8f\u5217\u4e2d$[st_x,st_y]$\u7684\u7b54\u6848\n\n\u5426\u5219$x,y$\u5728\u4e0d\u540c\u7684\u5b50\u6811\u5185,\u90a3\u4e48\u7edf\u8ba1\u5e8f\u5217\u4e2d$[ed_x,st_y]$\u7684\u7b54\u6848\n\n\u4e0d\u7406\u89e3\u7684\u53ef\u4ee5\u624b\u52a8\u753b\u56fe\u6a21\u62df\u4e00\u904d,\u5e76\u914d\u5408\u4ee3\u7801\u7406\u89e3qwq\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u628a\u6811\u4e0a\u95ee\u9898\u8f6c\u5316\u4e3a\u5e8f\u5217\u4e0a\u7684\u4e86\n\n\u63a5\u4e0b\u6765\u5c31\u548c\u666e\u901a\u83ab\u961f\u4e00\u6837\u4e86\n\n## \u4ee3\u7801\n\n```cpp\n#include<bits/stdc++.h>\n#define Fur(i,x,y) for(int i=x;i<=y;++i)\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;to=e[i].nxt)\nusing namespace std;\nconst int N=40011,M=100011;\nint n,cnt=0,head[N],val[N],old[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint T[N],dfn=0,st[N],ed[N],top[N],siz[N],f[N],d[N];\nvoid dfs(int x){\n    T[st[x]=++dfn]=x;\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n    T[ed[x]=++dfn]=x;\n}\nvoid bt(int x,int tp){\n    top[x]=tp;\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint lca(int x,int y){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        x=f[top[x]];\n    }\n    return d[x]<d[y]?x:y;\n}\nint blk,bl[N<<1];\nstruct que{\n    int l,r,lca,bl,br,id;\n    bool operator<(que t)const{\n        (bl==t.bl)?((bl&1)?r<t.r:r>t.r):(l<t.l);\n    }\n}Q[N];\nint ans=0,c[N],ANS[M];\nbool v[N];\nvoid inc(int x){ans+=(++c[val[x]]==1);}\nvoid dec(int x){ans-=(--c[val[x]]==0);}\nvoid op(int x){\n    v[x]?dec(x):inc(x);\n    v[x]^=1;\n}\nstruct node{\n    int v,p;\n    bool operator<(node t)const{\n        return v<t.v;\n    }\n}a[M];\nint main(){\n    int q,x,y,l=1,r=0;\n    scanf(\"%d%d\",&n,&q);\n    blk=sqrt(n);\n    Fur(i,1,n*2)bl[i]=(i-1)/blk+1;\n    Fur(i,1,n)scanf(\"%d\",&a[i].v),a[i].p=i;\n    sort(a+1,a+n+1);\n    int tt=0;\n    Fur(i,1,n)old[val[a[i].p]=(tt+=a[i].v!=a[i-1].v)]=a[i].v;\n    Fur(i,1,n-1)scanf(\"%d%d\",&x,&y),add(x,y),add(y,x);\n    dfs(1);bt(1,1);\n    Fur(i,1,q){\n        scanf(\"%d%d\",&x,&y);\n        if(st[x]>st[y])swap(x,y);\n        int t=lca(x,y);\n        if(t==x)Q[i]=que{st[x],st[y],0,bl[st[x]],bl[st[y]],i};\n        else Q[i]=que{ed[x],st[y],t,bl[ed[x]],bl[st[y]],i};\n    }\n    sort(Q+1,Q+q+1);\n    Fur(i,1,q){\n        while(l>Q[i].l)op(T[--l]);\n        while(r<Q[i].r)op(T[++r]);\n        while(l<Q[i].l)op(T[l++]);\n        while(r>Q[i].r)op(T[r--]);\n        if(Q[i].lca)op(Q[i].lca);\n        ANS[Q[i].id]=ans;\n        if(Q[i].lca)op(Q[i].lca);\n    }\n    Fur(i,1,q)printf(\"%d\\n\",ANS[i]);\n}\n```", "link": "/posts/\u6811\u4e0a\u83ab\u961f/", "tags": ["\u7b97\u6cd5", "\u6280\u5de7", "\u6811\u4e0a\u83ab\u961f", "\u83ab\u961f"], "categories": [["\u7b97\u6cd5", "\u6811\u8bba"], ["\u7b97\u6cd5", "\u6570\u636e\u7ed3\u6784"], ["\u7b97\u6cd5", "\u79bb\u7ebf"], ["note"]]}, {"title": "\u7f51\u7edc\u6d4124\u9898", "content": "[\u9898\u76ee\u5730\u5740\uff1a](https://www.luogu.org/problemnew/lists?name=&orderitem=difficulty&tag=332&content=0&type=)\n\n\u7f51\u7edc\u6d4124\u9898\u771f\u7684\u597d\u6709\u8d28\u91cf~\\\\ ($\\ge $\u25bd$\\le $ ) /~\uff01\n\n# \u8fdb\u5ea6\uff1a $\\frac{7}{24}$ \n\n## 1. [\u98de\u884c\u5458\u914d\u5bf9\u65b9\u6848\u95ee\u9898](https://www.luogu.org/problemnew/show/P2756)\n\n\u4e8c\u5206\u56fe\u6a21\u677f\n\n### \u5308\u7259\u5229\uff08\u5f85\u586b\u5751\uff09:\n\n### [\u7f51\u7edc\u6d41\uff1a](/2019/03/04/\u5404\u7c7b\u6a21\u677f/#dinic\uff1a\u98de\u884c\u5458\u914d\u5bf9\u65b9\u6848\u95ee\u9898)\n\n## 2.[\u8d1f\u8f7d\u5e73\u8861\u95ee\u9898](https://www.luogu.org/problemnew/show/P4016)\n\n\u7b49\u540c\u4e8e[[HAOI2008]\u7cd6\u679c\u4f20\u9012](https://www.luogu.org/problemnew/show/P2512) ,\u61d2,\u76f4\u63a5\u642c[\u9898\u89e3](https://www.luogu.org/blog/five20/solution-p4016)\n\n\u4e5f\u6709\u8d39\u7528\u6d41\u505a\u6cd5(\u5f85\u586b\u5751)\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define rg register\n#define ll long long\n#define Fur(i,x,y) for(rg int i=x;i<=y;i++)\nusing namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 111\nint n,a[N],t;\nint main(){\n    in>>n;ll s=0;\n    Fur(i,1,n)in>>a[i],s+=a[i];\n    s/=n;\n    Fur(i,1,n)a[i]=a[i-1]-a[i]+s;\n    sort(a+1,a+n+1);\n    t=a[(n>>1)+1];s=0;\n    Fur(i,1,n)s+=abs(a[i]-t);\n    out<<s<<ln;\n}\n```\n\n\n\n## 3.[\u5b64\u5c9b\u8425\u6551\u95ee\u9898](https://www.luogu.org/problemnew/show/P4011) \n\n\u80cc\u5305+\u72b6\u6001\u538b\u7f29\n\nN\u5f88\u5c0f\n\n\u5f00\u4e09\u7ef4\u4fdd\u5b58\u72b6\u6001$d[x][y][s]$,\u8d70\u5230$x,y$,\u62e5\u6709\u94a5\u5319\u72b6\u6001\u4e3a$s$\u7684\u6700\u5c0f\u82b1\u8d39\u662f\u591a\u5c11\u3002\n\n$map[x_1][y_1][x_2][y_2]$\u5b58\u5899\n\n**\u5751\u70b9\uff1a**\n\n1. \u4e00\u4e2a\u70b9\u53ef\u4ee5\u653e\u591a\u4e2a\u94a5\u5319\n2. \u521d\u59cb\u70b9\u53ef\u4ee5\u653e\u94a5\u5319\n\n```cpp\n#include<cstdio>\n#include<ctype.h>\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops,fast-math\")\n#pragma GCC target(\"sse,sse2,avx,avx2,popcnt,tune=native\")\n#define il __inline__ __attribute__ ((always_inline))\n#define rg register\n#define Fur(i,x,y) for(rg int i=x;i<=y;i++)\nusing namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 12\nint n,m,k,P,S;\nint d[N][N][1<<N],wa[N][N][N][N],a[N][N][N];\nint dx[4]={0,1,0,-1},dy[4]={1,0,-1,0},p[1000001],q[1000001],o[1000001];\nint bfs(){\n    int h=0,t=1,x,y,s,nx,ny,ns;\n    p[0]=1;q[0]=1;o[0]=1;d[1][1][1]=1;\n    Fur(i,1,a[1][1][0])d[1][1][1]|=(1<<a[1][1][i]);\n    while(h<t){\n        x=p[h];y=q[h];s=o[h++];\n        Fur(i,0,3){\n            nx=x+dx[i];ny=y+dy[i];\n            if(nx<1||ny<1||nx>n||ny>m||!(s&(1<<wa[x][y][nx][ny])))continue;\n            ns=s;Fur(j,1,a[nx][ny][0])ns|=(1<<a[nx][ny][j]);\n            if(!d[nx][ny][ns]){\n                d[nx][ny][ns]=d[x][y][s]+1;\n                if(nx==n&&ny==m)return d[x][y][s];\n                p[t]=nx,q[t]=ny,o[t++]=ns;\n            }\n        }\n    }\n    return -1;\n}\nint main(){\n    in>>n>>m>>P>>k;\n    int x,y,xx,yy,t;\n    Fur(i,1,k){\n        in>>x>>y>>xx>>yy>>t;\n        if(!t)t=P+1;\n        wa[xx][yy][x][y]=wa[x][y][xx][yy]=t;\n    }\n    in>>S;\n    Fur(i,1,S)in>>x>>y>>a[x][y][++a[x][y][0]];\n    out<<bfs()<<ln;\n}\n```\n\n## 4. [\u9b54\u672f\u7403\u95ee\u9898](https://www.luogu.org/problemnew/show/P2765)\n\n\u8f6c\u6362\u7684\u601d\u8def\u5f88\u5de7\u5999\u3002\n\n\u8003\u8651\u4e00\u4e2a\u70b9\uff1a\n\n1. \u653e\u5728\u4e00\u6839\u65b0\u7684\u67f1\u5b50\u4e0a\n2. \u653e\u5728\u4e0e\u5b83\u52a0\u8d77\u6765\u662f\u5b8c\u5168\u5e73\u65b9\u6570\u7684\u70b9\u4e0a\n\n\u8fd9\u6837\u4e00\u770b,\u5982\u679c\u4e00\u4e2a\u67f1\u5b50\u53ef\u4ee5\u4ee5\u67d0\u4e2a\u70b9\u5f00\u59cb,\u4e5f\u53ef\u4ee5\u4ee5\u67d0\u4e2a\u70b9\u7ed3\u675f,\u90a3\u4e48\u4e00\u4e2a\u70b9$x$\u5c31\u8981\u62c6\u6210\u4e24\u4e2a\u70b9$(x,x')$\n\n\u5bf9\u4e8e1,\u6211\u4eec\u628a\u6e90\u70b9\u4e0e$x$\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a1\u7684\u8fb9,\u628a$x'$\u4e0e\u6c47\u70b9\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a1\u7684\u8fb9\n\n\u5bf9\u4e8e2,\u6211\u4eec\u628a\u80fd\u4e0e$x$\u7ec4\u6210\u5e73\u65b9\u6570\u7684\u70b9\u4e0e$x\u2019\u200b$\u8fde\u4e00\u6761\u8fb9\u3002\n\n\u5f53\u8fde\u5b8c\u8fb9\u540e\u6700\u5927\u6d41\u65e0\u6cd5\u589e\u5e7f\u65f6\u8bf4\u660e\u5f97\u65b0\u5efa\u4e00\u6839\u67f1\u5b50,\u5982\u679c\u67f1\u5b50\u6570$>n$\u90a3\u5c31\u8bf4\u660e\u65e0\u6cd5\u7ee7\u7eed\u6dfb\u52a0\u6570\u4e86\u3002\n\n\u5173\u4e8e\u8f93\u51fa,\u5c31\u81ea\u5df1\u770b\u7740\u4ee3\u7801\u610f\u4f1a\u610f\u4f1a\u5427$Q\\omega Q$\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops,fast-math\")\n#pragma GCC target(\"sse,sse2,avx,avx2,popcnt,tune=native\")\n#define il __inline__ __attribute__ ((always_inline))\n#define rg register\n#define MB template <class T>\n#define Fur(i,x,y) for(rg int i=x;i<=y;i++)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define inf 2000000000\n#define fl(i,x) for(rg int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nMB T MIN(T x,T y){return x<=y?x:y;}\nusing namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10010\nint n,m,st,ed,cnt;\nint head[N],d[N],q[N],top[N],nex[N];\nstruct edge{int to,nxt,w;}e[100011];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].w=0;e[cnt].nxt=head[y];head[y]=cnt;\n}\nbool bfs(){\n    int h=0,t=1,x;\n    clr(d,0);d[q[h]=st]=1;\n    while(h<t){\n        x=q[h++];if(x==ed)return 1;\n        fl(i,x)if(e[i].w&&!d[to]){\n            d[to]=d[x]+1;\n            q[t++]=to;\n        }\n    }\n    return 0;\n}\nint dfs(int x,int mf){\n    if(x==ed)return mf;\n    int us=0,w;\n    fl(i,x)\n    if(e[i].w&&d[to]==d[x]+1){\n        w=dfs(to,MIN(mf-us,e[i].w));\n        e[i].w-=w;e[i^1].w+=w;\n        us+=w;if(to!=ed)nex[x>>1]=to>>1;\n        if(us==mf)return mf;\n    }\n    if(!us)d[x]=-1;\n    return us;\n}\nint work(){int ans=0;while(bfs())ans+=dfs(st,inf);return ans;}\nbool v[N];\nint main(){\n    in>>n;\n    st=N-2;ed=N-1;\n    int d=0,tot=0,t;\n    while(tot<=n){\n        ++d;\n        add(st,d<<1,1);add(d<<1|1,ed,1);\n        for(rg int i=sqrt(d)+1;i*i<(d<<1);i++)add((i*i-d)<<1,d<<1|1,1);\n        if(!work())top[++tot]=d;\n    }\n    out<<(--d)<<ln;\n    Fur(i,1,n)\n    if(!v[top[i]]){\n        v[t=top[i]]=1;\n        while(t)out<<t<<\" \",v[t=nex[t]]=1;\n        out<<ln;\n    }\n}\n```\n\n## 5. [\u8f6f\u4ef6\u8865\u4e01\u95ee\u9898](https://www.luogu.org/problemnew/show/P2761)\n\n\u6700\u77ed\u8def+\u72b6\u6001\u538b\u7f29\n\n\u5c06\u6bcf\u4e2a\u8865\u4e01\u72b6\u6001\u538b\u7f29,\u7136\u540e\u8dd1\u6700\u77ed\u8def\u3002\n\n\u56e0\u4e3a\u8fb9\u592a\u591a,\u6240\u4ee5\u679a\u4e3e\u5c31\u53ef\u4ee5\u4e86\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops,fast-math\")\n#pragma GCC target(\"sse,sse2,avx,avx2,popcnt,tune=native\")\n#define il __inline__ __attribute__ ((always_inline))\n#define rg register\n#define MB template <class T>\n#define Fur(i,x,y) for(rg int i=x;i<=y;i++)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define inf 2000000000\n#define fl(i,x) for(rg int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nMB T MIN(T x,T y){return x<=y?x:y;}\nusing namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 22\nint n,m;\nint d[1<<N],b1[101],b2[101],f1[101],f2[101],c[101];\nstruct cmp{bool operator()(int x,int y){return d[x]>d[y];}};\npriority_queue<int,vector<int>,cmp>q;\nbool v[1<<N];\nvoid spfa(){\n    clr(d,126);\n    d[(1<<n)-1]=0;q.push((1<<n)-1);\n    while(!q.empty()){\n        rg int x=q.top(),to;q.pop();v[x]=0;\n        Fur(i,1,m)\n        if((b1[i]&x)==b1[i]&&!(b2[i]&x)){\n            to=(x&(~f1[i]))|f2[i];\n            if(d[x]+c[i]<d[to]){\n                d[to]=d[x]+c[i];\n                if(!v[to])q.push(to),v[to]=1;\n            }\n        }\n    }\n    if(d[0]==2122219134)d[0]=0;\n}\nint main(){\n    in>>n>>m;\n    char s1[N],s2[N];\n    Fur(i,1,m){\n        in>>c[i]>>s1>>s2;\n        Fur(j,0,n-1){\n            if(s1[j]=='+')b1[i]|=(1<<j);\n            if(s1[j]=='-')b2[i]|=(1<<j);\n            if(s2[j]=='-')f1[i]|=(1<<j);\n            if(s2[j]=='+')f2[i]|=(1<<j);\n        }\n    }\n    spfa();\n    out<<d[0]<<ln;\n}\n```\n\n## 6. [\u5706\u684c\u95ee\u9898](https://www.luogu.org/problemnew/show/P3254)\n\n\u548c\u98de\u884c\u5458\u914d\u5bf9\u65b9\u6848\u95ee\u9898\u5dee\u4e0d\u591a\u561b\u3002\n\n\u4e5f\u662f\u7f51\u7edc\u6d41\u4e8c\u5206\u56fe,\u518d\u52a0\u4e2a\u8f93\u51fa\u3002\n\n\u5927\u6982\u7684\u5957\u8def\u5c31\u662f\u5339\u914d\u7684\u76f4\u63a5\u90fd\u8fde\u8fb91,\u7136\u540e\u6e90\u70b9\u6c47\u70b9\u4ec0\u4e48\u7684\u6309\u9898\u610f\u5199\u5c31\u53ef\u4ee5\u4e86\n\n\u8f93\u51fa\u7684\u5c31\u662f\u6709\u8fde\u8fb9\u7684,\u800c\u4e14\u8fd9\u6761\u8fb9\u5df2\u7ecf\u7528\u8fc7\u4e86\uff08e[i^1])\uff09\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops,fast-math\")\n#pragma GCC target(\"sse,sse2,avx,avx2,popcnt,tune=native\")\n#define il __inline__ __attribute__ ((always_inline))\n#define rg register\n#define MB template <class T>\n#define Fur(i,x,y) for(rg int i=x;i<=y;i++)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define inf 2000000000\n#define fl(i,x) for(rg int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nMB T MIN(T x,T y){return x<=y?x:y;}\nusing namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1001\nint n,m,st,ed,cnt=1;\nint head[N],d[N],q[N];\nstruct edge{int to,nxt,w;}e[1000011];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].w=0;e[cnt].nxt=head[y];head[y]=cnt;\n}\nbool bfs(){\n    int h=0,t=1,x;\n    clr(d,0);d[q[h]=st]=1;\n    while(h<t){\n        x=q[h++];if(x==ed)return 1;\n        fl(i,x)if(e[i].w&&!d[to]){\n            d[to]=d[x]+1;\n            q[t++]=to;\n        }\n    }\n    return 0;\n}\nint dfs(int x,int mf){\n    if(x==ed)return mf;\n    int us=0,w;\n    fl(i,x)\n    if(e[i].w&&d[to]==d[x]+1){\n        w=dfs(to,MIN(mf-us,e[i].w));\n        e[i].w-=w;e[i^1].w+=w;\n        us+=w;\n        if(us==mf)return mf;\n    }\n    if(!us)d[x]=-1;\n    return us;\n}\nint main(){\n    in>>m>>n;\n    st=N-2;ed=N-1;\n    int x,sum=0;\n    Fur(i,1,m){\n        in>>x,add(st,i,x),sum+=x;\n        Fur(j,m+1,m+n)add(i,j,1);\n    }\n    Fur(i,m+1,m+n)in>>x,add(i,ed,x);\n    while(bfs())sum-=dfs(st,inf);\n    if(sum)out<<\"0\\n\";\n    else{\n        out<<\"1\\n\";\n        Fur(i,1,m){\n            fl(j,i)if(to!=st&&to!=ed&&e[j^1].w)out<<to-m<<\" \";\n            out<<ln;\n        }\n    }\n}\n```\n\n## 7.[\u8bd5\u9898\u5e93\u95ee\u9898](https://www.luogu.org/problemnew/show/P2763)\n\n\u4e5f\u662f\u6c34\u9898\u5427\u3002\n\n\u7528\u7f51\u7edc\u6d41\u53ef\u80fd\u6bd4\u4e8c\u5206\u56fe\u5bb9\u6613\u5199\u70b9\u3002\n\n\u5957\u8def\u548c\u4e0a\u4e00\u9053\u4e00\u6837,\u7a0d\u5fae\u6539\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(\"Ofast,no-stack-protector,unroll-loops,fast-math\")\n#pragma GCC target(\"sse,sse2,avx,avx2,popcnt,tune=native\")\n#define il __inline__ __attribute__ ((always_inline))\n#define rg register\n#define MB template <class T>\n#define Fur(i,x,y) for(rg int i=x;i<=y;i++)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define inf 2000000000\n#define fl(i,x) for(rg int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nMB T MIN(T x,T y){return x<=y?x:y;}\nusing namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 2001\nint n,k,st,ed,cnt=1;\nint head[N],d[N],q[N];\nstruct edge{int to,nxt,w;}e[1000011];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].w=0;e[cnt].nxt=head[y];head[y]=cnt;\n}\nbool bfs(){\n    int h=0,t=1,x;\n    clr(d,0);d[q[h]=st]=1;\n    while(h<t){\n        x=q[h++];if(x==ed)return 1;\n        fl(i,x)if(e[i].w&&!d[to]){\n            d[to]=d[x]+1;\n            q[t++]=to;\n        }\n    }\n    return 0;\n}\nint dfs(int x,int mf){\n    if(x==ed)return mf;\n    int us=0,w;\n    fl(i,x)\n    if(e[i].w&&d[to]==d[x]+1){\n        w=dfs(to,MIN(mf-us,e[i].w));\n        e[i].w-=w;e[i^1].w+=w;\n        us+=w;\n        if(us==mf)return mf;\n    }\n    if(!us)d[x]=-1;\n    return us;\n}\nint main(){\n    in>>k>>n;\n    st=N-2;ed=N-1;\n    int x,t,sum=0;\n    Fur(i,1,k)in>>x,add(st,i,x),sum+=x;\n    Fur(i,k+1,k+n){\n        add(i,ed,1);\n        in>>t;while(t--)in>>x,add(x,i,1);\n    }\n    while(bfs())sum-=dfs(st,inf);\n    if(sum)out<<\"No Solution!\\n\";\n    else Fur(i,1,k){\n            out<<i<<\": \";\n            fl(j,i)if(to!=st&&to!=ed&&e[j^1].w)out<<to-k<<\" \";\n            out<<ln;\n        }\n}\n```\n\n", "link": "/posts/\u7f51\u7edc\u6d4124\u9898/", "tags": ["\u7f51\u7edc\u6d41", "\u5efa\u56fe"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "CF1110", "content": "| [A](http://codeforces.com/contest/1110/problem/A) | [Parity](http://codeforces.com/contest/1110/problem/A) standard input/output1 s, 256 MB | [![Submit](http://st.codeforces.com/s/27606/images/icons/submit-22x22.png)](http://codeforces.com/contest/1110/submit/A) ![Add to favourites](http://st.codeforces.com/s/27606/images/icons/star_gray_16.png) | [![img](http://st.codeforces.com/s/27606/images/icons/user.png) x6385](http://codeforces.com/contest/1110/status/A) |\n| :------------------------------------------------ | :----------------------------------------------------------- | :----------------------------------------------------------: | :----------------------------------------------------------- |\n| [B](http://codeforces.com/contest/1110/problem/B) | [Tape](http://codeforces.com/contest/1110/problem/B)standard input/output1 s, 256 MB | [![Submit](http://st.codeforces.com/s/27606/images/icons/submit-22x22.png)](http://codeforces.com/contest/1110/submit/B) ![Add to favourites](http://st.codeforces.com/s/27606/images/icons/star_gray_16.png) | [![img](http://st.codeforces.com/s/27606/images/icons/user.png) x4448](http://codeforces.com/contest/1110/status/B) |\n| [C](http://codeforces.com/contest/1110/problem/C) | [Meaningless Operations](http://codeforces.com/contest/1110/problem/C)standard input/output1 s, 256 MB | [![Submit](http://st.codeforces.com/s/27606/images/icons/submit-22x22.png)](http://codeforces.com/contest/1110/submit/C) ![Add to favourites](http://st.codeforces.com/s/27606/images/icons/star_gray_16.png) | [![img](http://st.codeforces.com/s/27606/images/icons/user.png) x3704](http://codeforces.com/contest/1110/status/C) |\n| [D](http://codeforces.com/contest/1110/problem/D) | [Jongmah](http://codeforces.com/contest/1110/problem/D)standard input/output3 s, 256 MB | [![Submit](http://st.codeforces.com/s/27606/images/icons/submit-22x22.png)](http://codeforces.com/contest/1110/submit/D) ![Add to favourites](http://st.codeforces.com/s/27606/images/icons/star_gray_16.png) | [![img](http://st.codeforces.com/s/27606/images/icons/user.png) x940](http://codeforces.com/contest/1110/status/D) |\n| [E](http://codeforces.com/contest/1110/problem/E) | [Magic Stones](http://codeforces.com/contest/1110/problem/E)standard input/output1 s, 256 MB | [![Submit](http://st.codeforces.com/s/27606/images/icons/submit-22x22.png)](http://codeforces.com/contest/1110/submit/E) ![Add to favourites](http://st.codeforces.com/s/27606/images/icons/star_gray_16.png) | [![img](http://st.codeforces.com/s/27606/images/icons/user.png) x1096](http://codeforces.com/contest/1110/status/E) |\n\n## A. Parity\n\n### \u9898\u610f\uff1a\n\n\u8bbe$n = a_1 \\cdot  b_{k\u22121} + a_2 \\cdot b_{k\u22122} + \u2026 a_{k\u22121} \\cdot b + a_k$\n\n\u7ed9\u51fa$b,k\u200b$\u3001\u6570\u7ec4$a\u200b$,\u5224\u65ad$n\u200b$\u662f\u5076\u6570(even)\u8fd8\u662f\u5947\u6570(odd).\n\n### \u9898\u89e3\uff1a\n\n\u7528\u4e00\u4e2abool$f$\u8bb0\u5f55\u5230\u76ee\u524d\u662f\u5947\u6570\u8fd8\u662f\u5076\u6570\n\n\u5982\u679c$a_i$\u6216$b_{k-i}$\u4e4b\u95f4\u6709\u4e00\u4e2a\u662f\u5076\u6570,$a_i \\cdot b_{k-i}$\u5c31\u662f\u5076\u6570\n\n\u5982\u679c$i=k$\u5c31\u53ea\u770b$a_k$\u5c31\u53ef\u4ee5\u4e86\n\n```cpp\n#include<cstdio>\n#define Fur(i,x,y) for(int i=x;i<=y;i++)\nusing namespace std;\nint b,k,x;\nint main(){\n    scanf(\"%d%d\",&b,&k);\n    bool f=0;\n    Fur(i,1,k){\n        scanf(\"%d\",&x);\n        if((k-i!=0&&!(b&1))||!(x&1))continue;\n        f^=1;\n    }\n    printf(f?\"odd\\n\":\"even\\n\");\n}\n```\n\n## B. Parity\n\n### [\u539f\u9898](https://www.luogu.org/problemnew/show/P1209)\n\n\u5c31\u662f\u8f93\u5165\u987a\u5e8f\u4e0d\u4e00\u6837\u7f62\u4e86\n\n\n\n\u8d2a\u5fc3\u53d6\u7a7a\u9699\u6700\u5927\u7684\u4e0d\u8981\u5c31\u53ef\u4ee5\u4e86\u3002\n\n```cpp\n#include<cstdio> \n#include<algorithm> \n#define N 100010\nusing namespace std; \nint m,s,c,ans;\nint a[N],C[N];\nbool cmp(int x,int y){return x>y;}\nint main() { \n    scanf(\"%d %d %d\",&c,&s,&m);\n    for(int i=1;i<=c;i++)scanf(\"%d\",&a[i]);\n    if(m>c){printf(\"%d\\n\",c);return 0;}\n    sort(a+1,a+c+1);\n    ans=a[c]-a[1]+1;\n    for(int i=2;i<=c;i++)C[i-1]=a[i]-a[i-1];\n    sort(C+1,C+c,cmp);\n    for(int i=1;i<=m-1;i++)ans=ans-C[i]+1;\n    printf(\"%d\\n\",ans);\n} \n```\n\n\n\n## C. Meaningless Operations\n\n### \u9898\u610f\uff1a\n\n\u8f93\u5165$q$,\u7136\u540e\u8f93\u5165$q$\u4e2a$a$,\u5bf9\u4e8e\u6bcf\u4e2a$a$,\u627e\u5230\u4e00\u4e2a$b(0<b<a)$,\u4f7f$ gcd(a\\ xor\\ b, a\\ and\\ b) $\u6700\u5927,\u8f93\u51fa\u8fd9\u4e2a\u6700\u5927\u7684$gcd$\n\n### \u9898\u89e3\uff1a\n\n\u5982\u679c$a$\u4e0d\u662f $(1 << k) - 1$\u8fd9\u79cd\u5f62\u5f0f,\u90a3\u4e48\u603b\u80fd\u627e\u5230\u4e00\u4e2a$b$\u4f7f$a\\ xor\\ b == (1 << k) - 1$,\u800c$a\\ and\\ b == 0$,\u8fd9\u4e2a\u65f6\u5019$gcd$\u4e00\u5b9a\u6700\u5927\n\n\u5982\u679c$a$\u662f $(1 << k) - 1$,\u90a3\u4e48\u56e0\u4e3a$b$\u4e0d\u80fd\u4e3a$0$,\u6240\u4ee5\u51d1\u4e0d\u51fa $(1 << k) - 1$,\u6ca1\u529e\u6cd5\u53ea\u80fd\u66b4\u529b\u4e86,\u56e0\u4e3a $(1 << k) - 1$\u8fd9\u6837\u7684\u5f62\u5f0f\u7684a\u4e5f\u53ea\u670924\u4e2a,\u6240\u4ee5\u6211\u4eec\u8981\u4e8b\u5148\u6253\u8868,\u5426\u5219\u5e94\u8be5\u4f1a\u8d85\u65f6\n\n```cpp\n#include<cstdio>\n#include<map>\nusing namespace std;\n#define N 100011\nint n;\nmap<int,int>mp;\nint main(){\nmp[3]=1;mp[7]=1;mp[15]=5;mp[31]=1;mp[63]=21;mp[127]=1;mp[255]=85;mp[511]=73;mp[1023]=341;mp[2047]=89;mp[4095]=1365;mp[8191]=1;mp[16383]=5461;mp[32767]=4681;mp[65535]=21845;mp[131071]=1;mp[262143]=87381;mp[524287]=1;mp[1048575]=349525;mp[2097151]=299593;mp[4194303]=1398101;mp[8388607]=178481;mp[16777215]=5592405;mp[33554431]=1082401;\nint T,n;scanf(\"%d\",&T);\nwhile(T--){\n    scanf(\"%d\",&n);\n    if(mp.count(n))printf(\"%d\\n\",mp[n]);\n    else printf(\"%d\\n\",(1<<(int(log2(n))+1))-1);\n}\n}\n```\n\n## D. Jongmah\n\n### \u9898\u610f\uff1a\n\n\u4f60\u6709$n(10^6)$\u4e2a\u6570\u5b57,\u8303\u56f4$[1, m(10^6)]$,\u4f60\u53ef\u4ee5\u9009\u62e9\u5176\u4e2d\u7684\u4e09\u4e2a\u6570\u5b57\u6784\u6210\u4e00\u4e2a\u4e09\u5143\u7ec4,\u4f46\u662f\u8fd9\u4e09\u4e2a\u6570\u5b57\u5fc5\u987b\u662f\u8fde\u7eed\u7684\u6216\u8005\u76f8\u540c\u7684,\u6bcf\u4e2a\u6570\u5b57\u53ea\u80fd\u7528\u4e00\u6b21,\u95ee\u8fd9$n$\u4e2a\u6570\u5b57\u6700\u591a\u6784\u6210\u591a\u5c11\u4e2a\u4e09\u5143\u7ec4?\n\n### \u9898\u89e3\uff1a\n\n\u770b\u5230$n$\u90a3\u4e48\u5927,\u4ee5\u4e3a\u662f\u8d2a\u5fc3,\u5176\u5b9e\u662fdp\n\n#### \u5206\u6790\uff1a\u5982\u679c\u67093\u4e2a\u4e09\u5143\u7ec4$(i,i+1,i+2)$\u90a3\u4e48\u80af\u5b9a\u53ef\u4ee5\u62c6\u62103\u4e2a\u4e09\u5143\u7ec4$(i,i,i),(i+1,i+1,i+1),(i+2,i+2,i+2)$,\u6240\u4ee5\u5bf9\u4e8e\u6bcf\u4e2a$i$\u6700\u591a\u67092\u5bf9$(i,i+1,i+2)$\n\n\u5148\u7528\u6876$b$\u8bb0\u5f55\u6bcf\u79cd\u6570\u5b57\u51fa\u73b0\u7684\u6b21\u6570\n\n\u8bbe$f[i][j][k]$\u8868\u793a$1-i$\u4e2d\u7684\u6570\u5b57\u6709$j$\u4e2a$(i-1,i,i+1)$\u7684\u4e09\u5143\u7ec4,\u6709$k$\u4e2a$(i,i+1,i+2)$\u7684\u4e09\u5143\u7ec4\u3002\n\n\u6839\u636e\u5206\u6790\u53ef\u4ee5\u5f97\u51fa$j,k \\leq 2$,\u6240\u4ee5\u590d\u6742\u5ea6\u4e0d\u4f1a\u7ffb\u8f66\u3002\n\n#### \u8f6c\u79fb\uff1a\n\n\u6211\u4eec\u8003\u8651$i \\rightarrow i+1$\u7684\u65b9\u5f0f\u3002\n\n\u8bbe$now$\u4e3a\u76ee\u524d\u7b2c$i$\u79cd\u6570\u5b57\u5269\u4e0b\u7684\u4e2a\u6570\n\n$f[i+1][j][t]=MAX(f[i+1][j][t],f[i][j][k]+\\frac {(now-t)} 3+t)$\n\n\u610f\u601d\u5c31\u662f\u5728$f[i][j][k]$\u7684\u57fa\u7840\u4e0a,\u628a\u7b2c$i$\u79cd\u6570\u5b57\u5269\u4e0b\u4e2d\u7684$t$\u4e2a\u7528\u6765\u7ec4\u6210$3$\u4e2a**\u8fde\u7eed\u6570\u5b57$(i,i+1,i+2)$\u7c7b\u578b\u7684\u4e09\u5143\u7ec4**\u3002\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#define Fur(i,x,y) for(int i=x;i<=y;i++)\nint MAX(int x,int y){return x>y?x:y;}\nint MIN(int x,int y){return x<y?x:y;}\nusing namespace std;\n#define N 1000011\nint n,m,b[N],f[N][3][3];\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    int x;\n    Fur(i,1,n)scanf(\"%d\",&x),b[x]++;\n    memset(f,-1,sizeof(f));\n    f[0][0][0]=0;\n    Fur(i,0,m+1)\n        Fur(j,0,2)\n            Fur(k,0,2)if(f[i][j][k]>=0){\n                int now=b[i+1]-j-k;\n                Fur(t,0,MIN(2,now))f[i+1][k][t]=MAX(f[i+1][k][t],f[i][j][k]+(now-t)/3+t);\n            }\n\tprintf(\"%d\\n\",f[m+1][0][0]);\n}\n```\n\n## E. Magic Stones\n\n~~\u611f\u89c9\u6bd4D\u5bb9\u6613\u591a\u4e86~~\n\n### \u9898\u610f\uff1a\n\n\u6709\u4e00\u4e2a\u5e8f\u5217$a$,\u4f60\u53ef\u4ee5\u628a$a_i(1<i<n)$\u53d8\u6210$a_{i-1}+a_{i+1}-a_i$,\u95ee\u5e8f\u5217$a$\u80fd\u5426\u53d8\u6210\u5e8f\u5217$b$\n\n### \u9898\u89e3\uff1a\n\n\u5982\u679c\u628a\u5e8f\u5217$a,b\u200b$\u53d8\u4e3a\u5dee\u5206\u6570\u7ec4\uff08\u539f\u6765\u7684$a_i\u200b$\u53d8\u4e3a$a_i-a_{i-1}\u200b$\uff09\u7684\u8bdd\u53ef\u4ee5\u5de7\u5999\u5730\u53d1\u73b0\u6bcf\u6b21\u64cd\u4f5c\u5c31\u662f\u4ea4\u6362\u5dee\u5206\u6570\u7ec4\u4e2d\u76f8\u90bb\u7684\u7684\u4e24\u4e2a\u6570\u3002\n\n\u6240\u4ee5\u628a$a,b\u200b$\u5206\u522b\u6392\u5e8f\u540e\u6bd4\u8f83\u662f\u5426\u76f8\u540c\u5c31\u53ef\u4ee5\u4e86\u3002\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nnamespace FastIO{const char* ln=\"\\n\";struct Reader{char buf[1<<20],*s,*t;bool EOF_FLG;Reader():s(buf),t(buf),EOF_FLG(false) {};char gt() {return s==t&&((t=(s=buf)+fread(buf,1,1<<20,stdin))==s)?EOF:(*s++);}Reader& operator>>(char* str) {if(EOF_FLG)return *str=0,*this;while((*str=gt())!=' '&&*str!='\\n'&&*str!=EOF)++str;if(*str==EOF)EOF_FLG=true;*str=0;return *this;}template<typename T>Reader&operator>>(T&x) {if(EOF_FLG)return *this;char c=0,d;while(c!=EOF&&(c<'0'||c>'9'))d=c,c=gt();if(c==EOF){EOF_FLG=true;return *this;}else x=0;while(c>='0'&&c<='9')x=(x<<3)+(x<<1)+c-'0',c=gt();if(d=='-')x=-x;return *this;}}in;struct Writer{char buf[1<<20],*s,*t;Writer():s(buf),t(buf+(1<<20)){}~Writer(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,1<<20,stdout),*s++=c):(*s++=c);}template<typename T>Writer&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[40],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}Writer&operator<<(const char*s) {while(*s)pt(*s++);return *this;}}out;}using namespace FastIO;\n#define Fur(i,x,y) for(int i=x;i<=y;i++)\nusing namespace std;\n#define N 100011\nint a[N],b[N],n;\nint main(){\n    in>>n;\n    int x=0,y=0;\n    Fur(i,1,n)in>>x,a[i]=x-y,y=x;\n    x=y=0;\n    Fur(i,1,n)in>>x,b[i]=x-y,y=x;\n    if(a[1]!=b[1])return out<<\"No\\n\",0;//\u56e0\u4e3a\u7b2c\u4e00\u4e2a\u6570\u6ca1\u6cd5\u64cd\u4f5c\n    sort(a+2,a+n+1);\n    sort(b+2,b+n+1);\n    Fur(i,2,n)if(a[i]!=b[i])return out<<\"No\\n\",0;\n    out<<\"Yes\\n\";\n}\n```\n\n", "link": "/posts/CF1110/", "tags": [], "categories": [["\u6bd4\u8d5b"]]}, {"title": "\u5706\u65b9\u6811", "content": "## \u5efa\u6811\n\ntarjan\u6c42\u51fa\u53cc\u8fde\u901a\u5206\u91cf\u540e\u628a\u5176\u4e2d\u7684\u70b9\u8fde\u5411\u65b0\u5efa\u7684\u8282\u70b9\n\n\u5efa\u6210\u7684\u65b0\u56fe(\u6811)\u5373\u4e3a\u5706\u65b9\u6811\n\n![](https://images.cnblogs.com/cnblogs_com/sdzwyq/1268719/o_%e5%9c%86%e6%96%b9%e6%a0%91.png)\n\n**\u6027\u8d28\uff1a\u53ef\u4ee5\u53d1\u73b0\u539f\u56fe\u4e2d\u4e24\u70b9\u95f4\u5fc5\u7ecf\u7684\u70b9\u5c31\u662f\u5706\u65b9\u6811\u4e2d\u7684\u5706\u70b9**\n\n[\u9053\u8def\u76f8\u9047](https://www.luogu.com.cn/problem/P4320)\n\n\u53ef\u4ee5\u7528\u627e\u51falca\u540e\u76f4\u63a5\u6c42\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define MB template <class T>il\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define FL(i,x) for(int i(HEAD[x]),to;to=e[i].to,i;i=e[i].nxt)\nMB T MAX(T x,T y){return x>y?x:y;}\nMB T MIN(T x,T y){return x<y?x:y;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011;\nint n,m,cnt=0,head[N],HEAD[N];\nstruct edge{int to,nxt;}e[N<<3];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;\n}\nil void ADD(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=HEAD[x];HEAD[x]=cnt;\n    e[++cnt].to=x;e[cnt].nxt=HEAD[y];HEAD[y]=cnt;\n}\nint dfn[N],low[N],sz=0,tot,st[N],tp=0;\nvoid tarjan(int x,int fa){\n    dfn[x]=low[x]=++sz;st[++tp]=x;\n    fl(i,x)\n    if(!dfn[to]){\n        tarjan(to,x);\n        low[x]=MIN(low[x],low[to]);\n        if(low[to]>=dfn[x]){\n            ADD(++tot,x);\n            while(int k=st[tp--]){\n                ADD(tot,k);\n                if(k==to)break;\n            }\n        }\n    }\n    else if(to!=fa)low[x]=MIN(low[x],dfn[to]);\n}\nint f[N],siz[N],d[N],top[N],son[N];\nvoid dfs(int x){\n    siz[x]=1;\n    FL(i,x)if(to!=f[x]){\n        f[to]=x;\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;\n    if(son[x])bt(son[x],tp);\n    FL(i,x)if(!top[to])bt(to,to);\n}\nint lca(int x,int y){\n    while(top[x]!=top[y])\n        (d[top[x]]>d[top[y]])?x=f[top[x]]:y=f[top[y]];\n    return d[x]<d[y]?x:y;\n}\nint main(){\n    in(n,m);tot=n;\n    int x,y,q;\n    Fur(i,1,m)in(x,y),add(x,y);\n    tarjan(1,0);\n    d[1]=1;dfs(1);bt(1,1);\n    in(q);\n    while(q--){\n        in(x,y);\n        out((d[x]+d[y]-2*d[lca(x,y)])/2+1,ln);\n    }\n    flush();\n}\n```\n\n## \u5706\u65b9\u6811\u4e0e\u4ed9\u4eba\u638c\n\n[BZOJ 2125 \u6700\u77ed\u8def](https://remmina.github.io/BZPRO/JudgeOnline/2125.html)\n\n[LG 5236 \u9759\u6001\u4ed9\u4eba\u638c](https://www.luogu.com.cn/problem/P5236)\n\n\u8fd8\u662f\u5148\u5efa\u6210\u5706\u65b9\u6811\n\n\u82e5\u4e24\u4e2a\u70b9\u7684lca\u662f\u539f\u56fe\u7684\u70b9,\u90a3\u4e48\u76f4\u63a5$d_x+d_y-2\\times d_{lca(x,y)}$\n\n\u5426\u5219\u5c31\u662f\u4e24\u4e2a\u70b9\u5230\u73af(\u65b9\u70b9)\u7684\u8ddd\u79bb\u52a0\u4e0a\u4e24\u4e2a\u70b9\u5728\u73af\u4e0a\u7684\u6700\u77ed\u8ddd\u79bb(\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u89e3\u51b3)\n\n```cpp\n#include<cstdio>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define Fdr(i,x,y) for(int i(x);i>=y;--i)\nil void swap(int &x,int &y){int t=x;x=y;y=t;}\nil int min(int x,int y){return x<y?x:y;}\nil int abs(int x){return x>0?x:-x;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=20011;\nint n,m,q,cnt=0,head[N],HEAD[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<2];\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define FL(i,x) for(int i(HEAD[x]),to;to=e[i].to,i;i=e[i].nxt)\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;e[cnt].w=w;\n}\nil void ADD(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=HEAD[x];HEAD[x]=cnt;e[cnt].w=w;\n    e[++cnt].to=x;e[cnt].nxt=HEAD[y];HEAD[y]=cnt;e[cnt].w=w;\n}\nint dfn[N],low[N],sz=0,fa[N],tot,b[N],id[N];\nint s[N],dep[N];\nvoid solve(int x,int y,int w){\n    ++tot;\n    int t=w,tt=0;\n    for(int i=y;i!=fa[x];i=fa[i]){\n        s[i]=t;\n        t+=b[i];\n        id[i]=tt++;\n    }\n    s[tot]=s[x];s[x]=0;\n    for(int i=y;i!=fa[x];i=fa[i])\n        ADD(tot,i,min(s[i],s[tot]-s[i]));\n}\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;\n    fl(i,x)if(to!=fa[x]){\n        if(!dfn[to]){\n            fa[to]=x;b[to]=e[i].w;\n            tarjan(to);\n            low[x]=min(low[x],low[to]);\n        }\n        else low[x]=min(low[x],dfn[to]);\n        if(low[to]>dfn[x])ADD(x,to,e[i].w);\n    }\n    fl(i,x)if(fa[to]!=x&&dfn[to]>dfn[x])\n        solve(x,to,e[i].w);\n}\nint f[16][N],d[N],A,B;\nvoid dfs(int x){\n    for(int j=1;(1<<j)<=d[x];++j)\n        f[j][x]=f[j-1][f[j-1][x]];\n    FL(i,x)if(to!=f[0][x]){\n        f[0][to]=x;\n        d[to]=d[x]+1;\n        dep[to]=dep[x]+e[i].w;\n        dfs(to);\n    }\n}\nint lca(int x,int y){\n    if(d[x]<d[y])swap(x,y);\n    int D=d[x]-d[y];\n    for(int i=0;(1<<i)<=D;++i)if(D&(1<<i))x=f[i][x];\n    if(x==y)return x;\n    Fdr(i,15,0)if((1<<i)<=d[x]&&f[i][x]!=f[i][y])\n        x=f[i][x],y=f[i][y];\n    A=x,B=y;\n    return f[0][x];\n}\nint main(){\n    in(n,m,q);tot=n;\n    int x,y,w;\n    Fur(i,1,m)in(x,y,w),add(x,y,w);\n    tarjan(1);\n    dfs(1);\n    while(q--){\n        in(x,y);\n        w=lca(x,y);\n        if(w<=n)out(dep[x]+dep[y]-2*dep[w],ln);\n        else out(dep[x]+dep[y]-dep[A]-dep[B]+min(s[w]-abs(s[B]-s[A]),abs(s[A]-s[B])),ln);\n    }\n    flush();\n}\n```\n\n## \u4ed9\u4eba\u638c\u76f4\u5f84\n\n", "link": "/posts/\u5706\u65b9\u6811/", "tags": ["\u6811", "\u6570\u636e\u7ed3\u6784", "tarjan", "\u6280\u5de7", "\u56fe\u8bba"], "categories": [["\u7b97\u6cd5", "\u56fe\u8bba"], ["\u7b97\u6cd5", "\u6811\u8bba"], ["note"]]}, {"title": "exgcd", "content": "\u8f6c\u81eahttps://www.cnblogs.com/hadilo/p/5914302.html\n\n## \u6b27\u51e0\u91cc\u5f97\n\n### \u5b9a\u4e49:\n\n$gcd(a,b)$\u4e3a\u6574\u6570$a$\u4e0e$b$\u7684\u6700\u5927\u516c\u7ea6\u6570\n\n### \u5f15\u7406\uff1a\n\n$gcd(a,b)=gcd(b,a \\bmod b)$\n\n### \u8bc1\u660e\uff1a\n\n\u8bbe$r=a \\bmod b , c=gcd(a,b)$\n\n\u5219$a=xc,b=yc$, \u5176\u4e2d$x,y$\u4e92\u8d28\n\n$r=a \\bmod b=a-pb=xc-pyc=(x-py)c$\n\n\u800c$b=yc$\n\n\u53ef\u77e5\uff1a$y$\u4e0e $x-py$\u4e92\u8d28\n\n#### \u8bc1\u660e\uff1a\n\n\u5047\u8bbe$y$\u4e0e$x-py$\u4e0d\u4e92\u8d28\n\n\u8bbe$y=nk,x-py=mk$, \u4e14$k>1$\uff08\u56e0\u4e3a\u4e92\u8d28\uff09\n\n\u5c06$y$\u5e26\u5165\u53ef\u5f97\n\n$x-pnk=mk$\n\n$x=(pn+m)k$\n\n\u5219$a=xc=(pn+m)kc,b=yc=nkc$\n\n\u90a3\u4e48\u6b64\u65f6$a$\u4e0e$b$\u7684\u6700\u5927\u516c\u7ea6\u6570\u4e3a$kc$\u4e0d\u4e3a$k$\n\n\u4e0e\u539f\u547d\u9898\u77db\u76fe,\u5219$y$\u4e0e$x-py$\u4e92\u8d28\n\n\u56e0\u4e3a$y$\u4e0e$x-py$\u4e92\u8d28,\u6240\u4ee5$r$\u4e0e$b$\u7684\u6700\u5927\u516c\u7ea6\u6570\u4e3a$c$\n\n\u5373$gcd(b,r)=c=gcd(a,b)$\n\n\u5f97\u8bc1\n\n\u5f53$a\\mod b=0$\u65f6,$gcd(a,b)=b$\n\n\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u5199\u6210\u9012\u5f52\u5f62\u5f0f\n\n### \u5b9e\u73b0\uff1a\n\n```cpp\nint gcd(int a,int b){\n    return b?gcd(b,a%b):a;\n}\n```\n\n## \u6269\u5c55\u6b27\u51e0\u91cc\u5f97\n\n### \u5f15\u7406\uff1a\n\n\u5b58\u5728$x,y$ \u4f7f\u5f97$gcd(a,b)=ax+by$\n\n### \u8bc1\u660e\uff1a\n\n\u5f53 $b=0$ \u65f6,$gcd(a,b)=a,\u6b64\u65f6 x=1 , y=0$\n\u5f53 $b \\neq  0$ \u65f6,\u8bbe\n\n$ax+by=gcd(a,b)=gcd(b,a \\bmod b)=b{x}'+(a \\bmod b){y}'$\n\n$\\because a \\bmod b = a-a/b*b$\n\n$\\therefore ax+by=b{x}'+(a-a/b*b){y}'$\n\n$\\therefore ax+by=b{x}'+a{y}'-b*a/b*{y}'$\n\n$\\therefore ax+by=a{y}'+b{x}'-b*a/b*{y}'$\n\n$\\therefore ax+by=a{y}'+b({x}'-a/b*{y}')$\n\n$\u89e3\u5f97 x={y}' , y={x}'-a/b*{y}'$\n\n\u5f53$b=0$\u65f6\u5b58\u5728$x,y$\u4e3a\u6700\u540e\u4e00\u7ec4\u89e3\n\n### \u5b9e\u73b0\uff1a\n\n\u9012\u5f52\u8fdb\u5165\u4e0b\u4e00\u5c42,\u5f53$b=0$\u65f6\u5c31\u8fd4\u56de$x=1,y=0$\n\n\u518d\u6839\u636e$x=y' , y={x}'-a/b*y'$\u5f97\u51fa\u5f53\u524d\u6240\u5728\u5c42\u7684\u89e3\n\n\u56de\u5230\u7b2c\u4e00\u5c42\u7684\u65f6\u5019\u5f97\u5230\u7b54\u6848\u3002\n\n```cpp\nint x,y;\nvoid exgcd(int a,int b){\n    if(!b){x=1,y=0;return;}\n    exgcd(b,a%b);\n    int t=x;x=y;y=t-a/b*y;\n}\n```\n## LG 1082 \u540c\u4f59\u65b9\u7a0b\n\n> \u6c42\u5173\u4e8e$x$\u7684\u540c\u4f59\u65b9\u7a0b$ax \\equiv 1 \\pmod b$\u7684\u6700\u5c0f\u6b63\u6574\u6570\u89e3\u3002\n\n$ax \\equiv 1 \\pmod b$\u53ef\u4ee5\u8f6c\u5316\u4e3a$ax+by=1$\n\n\u65b9\u7a0b$ax + by = m$\u6709\u89e3\u7684\u5fc5\u8981\u6761\u4ef6\u662f$m \\mod \\gcd(a,b) = 0$\u3002\n\n$\\therefore \\gcd(a,b) = 1$,\u5373$a,b$\u4e92\u8d28\n\n\u7528\u6269\u5c55\u6b27\u51e0\u91cc\u5f97\u6c42$ax+by=\\gcd(a,b)$\u7684\u89e3\u5373\u53ef\n\n\u6211\u4eec\u6c42\u51fa\u6765\u7684$x$\u5fc5\u7136\u6ee1\u8db3\u65b9\u7a0b,\u4f46\u662f\u4e0d\u4e00\u5b9a\u662f\u6700\u5c0f\u6b63\u6574\u6570\u89e3\n\n> $ax+by=1$\n> \n> $ax+by+k\\times ba-k\\times ba=1$\n> \n> $a(x+kb)+(y-ka)b=1$\n\n\u6240\u4ee5$x+=b$\u6216$x-=b$\u4e0d\u4f1a\u4f7f$x$\u9519\u8fc7\u4efb\u4f55\u89e3\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nll x,y;\nvoid exgcd(ll a,ll b){\n    if(!b){\n        x=1,y=0;\n        return;\n    }\n    exgcd(b,a%b);\n    int t=x;\n    x=y;\n    y=t-a/b*y;\n}\nint main(){\n    ll a,b;\n    cin>>a>>b;\n    exgcd(a,b);\n    while(x<0)x+=b;\n    x%=b;\n    cout<<x<<endl;\n}\n```\n", "link": "/posts/exgcd/", "tags": ["exgcd", "\u6570\u8bba", "\u7b97\u6cd5", "\u9006\u5143"], "categories": [["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "\u7ebf\u6bb5\u6811\u5957\u7ebf\u6bb5\u6811", "content": "\u4e8c\u7ef4\u7ebf\u6bb5\u6811\u4e00\u822c\u7528\u7ebf\u6bb5\u6811\u5957\u7ebf\u6bb5\u6811\u5199,~~\u5f53\u7136\u4e5f\u53ef\u4ee5\u7528[\u56db\u53c9\u6811](https://www.cnblogs.com/mimiorz/p/8698689.html)\u5199~~\n\n\u6811\u5957\u6811,\u987e\u540d\u601d\u4e49,\u5916\u5c42\u6811\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u662f\u4e00\u68f5\u6811\u3002\n\n## [\u9898\u76ee\u5730\u5740\uff1ahttps://www.luogu.org/problemnew/show/U22582](https://www.luogu.org/problemnew/show/U22582)\n\n\n\n## \u9996\u5148\u8981\u4e86\u89e3\u7684\u77e5\u8bc6\uff1a\n\n1. \u7ebf\u6bb5\u6811\n\n2. \u6807\u8bb0\u6c38\u4e45\u5316\n\n   \n\n## \u6807\u8bb0\u6c38\u4e45\u5316\uff1a\n\n\u53c2\u8003https://www.cnblogs.com/Hallmeow/p/8004676.html\n\n\u7b80\u5355\u5730\u8bb2\u4e00\u4e0b,\u5982\u679c\u8981\u8be6\u7ec6\u4e86\u89e3\u7684\u8bdd~~\u53ef\u4ee5\u767e\u5ea6~~\u3002\n\n\u4e00\u822c\u7ebf\u6bb5\u6811\u5b9e\u73b0\u533a\u95f4\u4fee\u6539\u6211\u4eec\u7528\u7684\u662f\u61d2\u60f0\u6807\u8bb0,\u4f46\u662f\u9047\u5230\u4e00\u4e9b\u4e3b\u5e2d\u6811,\u6811\u5957\u6811\u7b49\u6bd2\u7624\u6570\u636e\u7ed3\u6784,\u61d2\u60f0\u6807\u8bb0\u5c31\u663e\u5f97\u5f88\u9ebb\u70e6\u4e86\u3002\n\n\u8fd9\u65f6\u5019\u5c31\u9700\u8981\u7528\u5230\u6807\u8bb0\u6c38\u4e45\u5316\u3002\u8fd9\u6837\u5c31\u53ef\u4ee5\u7701\u6389\u4e00\u5806pushup\u548cpushdown\u4e86,~~\u5c31\u53ef\u4ee5\u53ef\u6301\u4e45\u5316\u4e86~~\n\n### \u539f\u7406\uff1a\n\n\u5728\u67e5\u8be2\u7684\u65f6\u5019\u628a\u9014\u7ecf\u7684\u8282\u70b9\u4e0a\u7684\u6807\u8bb0\u5bf9\u7b54\u6848\u7684\u5f71\u54cd\u52a0\u4e0a,\u7701\u6389\u4e86\u4e0b\u63a8\u7684\u8fc7\u7a0b\u3002\n\n### \u5b9e\u73b0\uff1a\n\n#### \u4fee\u6539\uff1a\n\n\u6bd4\u5982\u73b0\u5728\u8981\u628a\u533a\u95f4[$L,R\u200b$]\u5168\u90e8\u6570\u52a0v\u3002\n\n\u5230\u8fbe\u88ab[$L,R\u200b$]\u5b8c\u5168\u5305\u542b\u7684\u8282\u70b9\uff08\u8282\u70b9\u6240\u4ee3\u8868\u533a\u95f4\u5728[$L,R\u200b$]\u5185\uff09\u65f6,\u5c31\u628a\u8282\u70b9\u7684\u6807\u8bb0\u52a0\u4e0av,\u7136\u540ereturn\u3002\n\n\u628a\u5b8c\u5168\u5305\u542b[$L,R$]\u7684\u533a\u95f4\uff08[$L,R$]\u5728\u8282\u70b9\u6240\u4ee3\u8868\u533a\u95f4\u5185\uff09\uff08\u4e00\u8def\u4e0b\u6765\u7684\u6240\u6709\u533a\u95f4)\u7684sum\u52a0\u4e0a$v*(R-L)$\u3002\n\n### \u8be2\u95ee\uff1a\n\n\u56e0\u4e3a\u4fee\u6539\u65f6\u5bf9\u4e0b\u9762\u7684\u8282\u70b9\u5b8c\u5168\u6ca1\u6709\u5f71\u54cd,\u6240\u4ee5\u8981\u4e00\u8def\u7d2f\u79ef\u6807\u8bb0\u7684\u5f71\u54cd,\u76f4\u5230\u67e5\u8be2\u533a\u95f4\u4e0e\u5f53\u524d\u8282\u70b9\u533a\u95f4\u5b8c\u5168\u91cd\u5408\u3002\n\n\u7b54\u6848\u5c31\u662fsum+ad(\u4e00\u8def\u7d2f\u79ef\u6807\u8bb0\u7684\u5f71\u54cd\u7684\u603b\u548c)*\u67e5\u8be2\u533a\u95f4\u957f\u5ea6\n\n### \u6ce8\u610f\uff1a\n\n\u56e0\u4e3a\u6253\u6807\u8bb0\u7684\u65f6\u5019\u662f\u8282\u70b9\u533a\u95f4\u4e0e\u76ee\u6807\u533a\u95f4\u5b8c\u5168\u91cd\u5408,\u6240\u4ee5\u8981\u6ce8\u610f\u5411\u4e0b\u9012\u5f52\u65f6\u8981\u7528\u7279\u6b8a\u7684\u65b9\u5f0f\uff08\u6c42\u6700\u5927\u503c\u7684\u65f6\u5019\u4e0d\u7528\uff09\u3002\n\n### \u4ee3\u7801\u5b9e\u73b0\uff1a\n\n\u8fd9\u91cc\u7ed9\u4e2a\u7ed3\u6784\u4f53\u5c01\u88c5\u7684\u6807\u8bb0\u6c38\u4e45\u5316\u7ebf\u6bb5\u6811,\u65b9\u4fbf\u540e\u9762\u6811\u5957\u6811\u7684\u5b9e\u73b0\u3002\n\n\u5f69\u86cb\uff1a\u7ecf\u672c\u4eba\u5b9e\u6d4b,\u6807\u8bb0\u6c38\u4e45\u5316\u7ebf\u6bb5\u6811\u6bd4\u666e\u901a\u7ebf\u6bb5\u6811\u5feb\u5f97\u591a,~~\u53ef\u4ee5\u7528\u6765\u5361\u5e38~~\n\n```cpp\n#include<cstdio>\n#define int ll\n#define ll long long\n#define gc getchar\nint gi(){int x=0,f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nusing namespace std;\n#define N 100001\nint n,q;\nstruct xds{\n    #define Z int m=(l+r)>>1\n    #define ls rt<<1\n    #define rs rt<<1|1\n    int s[N*3],tag[N*3];\n    void build(int l,int r,int rt){\n        if(l==r){s[rt]=gi();return;}\n        Z;build(l,m,ls);build(m+1,r,rs);\n        s[rt]=s[ls]+s[rs];\n    }\n    void upd(int L,int R,int v,int l,int r,int rt){\n        s[rt]+=v*(R-L+1);\n        if(L==l&&r==R){\n            tag[rt]+=v;\n            return;\n        }\n        Z;\n        //\u6ce8\u610f\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\uff01\n        if(R<=m)upd(L,R,v,l,m,ls);\n        else{\n            if(L>m)upd(L,R,v,m+1,r,rs);\n            else upd(L,m,v,l,m,ls),upd(m+1,R,v,m+1,r,rs);\n        }\n    }\n    int qh(int L,int R,int l,int r,int rt,int ad){\n        if(L==l&&r==R)return s[rt]+ad*(r-l+1);\n        Z;ad+=tag[rt];\n        if(R<=m)return qh(L,R,l,m,ls,ad);\n        else{\n            if(L>m)return qh(L,R,m+1,r,rs,ad);\n            else return qh(L,m,l,m,ls,ad)+qh(m+1,R,m+1,r,rs,ad);\n        }\n    }\n}s;\nsigned main(){\n    n=gi();q=gi();\n    s.build(1,n,1);\n    int p,x,y;\n    while(q--){\n        p=gi();x=gi();y=gi();\n        if(p==1)s.upd(x,y,gi(),1,n,1);\n        else printf(\"%lld\\n\",s.qh(x,y,1,n,1,0));\n    }\n}\n```\n\n\n\n## \u6811\u5957\u6811\u5b9e\u73b0\u65b9\u6cd5\uff1a\n\n\u4e00\u822c\u662f\u5148\u6309x\u8f74\u5efa\u5916\u5c42\u6811,\u7136\u540e\u5728\u6309y\u8f74\u5efa\u6811\u3002\n\n\u5185\u5c42\u6811\u66f4\u666e\u901a\u7ebf\u6bb5\u6811\u4e00\u6837,\u5916\u5c42\u6811\u6bcf\u6b21\u90fd\u66f4\u65b0\u8282\u70b9\u3002\n\n\u4e3a\u4e86\u65b9\u4fbf,\u4e00\u822c\u6811\u5957\u6811\u7528**\u6807\u8bb0\u6c38\u4e45\u5316**\u6765\u5199\u3002\n\n\u800c\u5728\u533a\u95f4\u52a0&&\u533a\u95f4\u6c42\u548c\u4e2d,\u5c31\u5fc5\u987b\u7528\u6807\u8bb0\u6c38\u4e45\u5316\u3002\n\n\u4ee3\u7801\u8bf7\u5728\u6700\u540e\u7684\u5b8c\u6574\u4ee3\u7801\u4e2d\u627e\u3002\n\n\n\n### \u56fe\u89e3\uff1a\n![](https://i.loli.net/2019/01/20/5c44288fbac50.png)\n![](https://i.loli.net/2019/01/20/5c44158cdffe8.png)\n\u7b2c\u4e8c\u5f20\u5012\u8fc7\u6765\u770b~~233~~\n\n\n\n### \u5efa\u6811\n\n\u5185\u5c42\u7ebf\u6bb5\u6811\u6ca1\u6709\u533a\u522b\u3002\n\n\u6309\u7167\u7b2c\u4e8c\u5f20\u56fe\u89e3,\u5916\u5c42\u7ebf\u6bb5\u6811\u5bf9\u5e94\u6bcf\u4e2a\u8282\u70b9\u7b49\u4e8e\u5b83\u7684\u5de6\u53f3\u513f\u5b50\u7684\u5bf9\u5e94\u8282\u70b9\u7684\u548c\u3002\n\n\u6bd4\u5982\u8282\u70b91\u7b49\u4e8e\u4e24\u68f5\u5b50\u6811\u5bf9\u5e94\u7684\u8282\u70b91\u7684\u548c\u3002\n\n\n\n### \u66f4\u65b0\n\n\u4e0d\u7ba1\u662f\u533a\u95f4\u66f4\u65b0\u548c\u70b9\u66f4\u65b0,\u6807\u8bb0\u6c38\u4e45\u5316\u90fd\u6bd4\u8f83\u65b9\u4fbf\u3002\n\n\u5185\u5c42\u548c\u539f\u6765\u4e00\u6837\u3002\n\n\u5916\u5c42\u7684\u66f4\u65b0\u5c31\u662f\u76f4\u63a5\u66f4\u65b0\u8282\u70b9\u5bf9\u5e94\u7684\u5185\u5c42\u7ebf\u6bb5\u6811\u3002\n\n\u4e0b\u56fe\u4e2d\u7eff\u8272\u7684\u77e9\u5f62\u533a\u57df\u5c31\u662f\u76ee\u6807\u533a\u57df,\u5c31\u662f**\u5916\u5c42\u6811**\u4e2d\u6bcf\u4e2a\u7eff\u8272\u8282\u70b9\u7684**\u5185\u5c42\u6811**\u7684\u6bcf\u4e2a\u7ea2\u8272\u8282\u70b9\u6240\u4ee3\u8868\u7684\u533a\u57df\u3002\n\n![](https://i.loli.net/2019/01/20/5c442c72eac5c.png)\n\n\n\n### \u67e5\u8be2\n\n\u4e0a\u56fe\u4e2d\u7eff\u8272\u7684\u77e9\u5f62\u533a\u57df\u5c31\u662f\u8981\u6c42\u7684\u533a\u57df,\u76f8\u5f53\u4e8e**\u5916\u5c42\u6811**\u4e2d\u6bcf\u4e2a\u7eff\u8272\u8282\u70b9\u7684**\u5185\u5c42\u6811**\u7684\u6bcf\u4e2a\u7ea2\u8272\u8282\u70b9\u6240\u4ee3\u8868\u7684\u533a\u57df\u7684\u548c\u3002\n\n\n\n### \u6ce8\u610f\uff1a\n\n\u5355\u70b9\u67e5\u8be2\u7684\u6811\u5957\u6811\u53ef\u4ee5\u4e0d\u7528\u6807\u8bb0\u6c38\u4e45\u5316(\u4e0d\u5efa\u8bae),\u7528\u4e8c\u7ef4\u6570\u7ec4\u6765\u8bb0\u5f55\u800c\u4e0d\u7528\u7ed3\u6784\u4f53,\u5efa\u6811\u65f6\u6bd4\u8f83\u65b9\u4fbf\u3002\n\n\u7ed3\u6784\u4f53\u65b9\u4fbf\u7406\u89e3\u548c\u5dee\u9519,\u5efa\u8bae\u5199\u7ed3\u6784\u4f53\u7248\u672c\u3002\n\n\u4ee5\u4e0b\u4e5f\u6709\u7ed9\u51fa\u4e8c\u7ef4\u6570\u7ec4\u6765\u8bb0\u5f55\u7684\u7248\u672c\u3002\n\n\u4e0d\u7ba1\u4ec0\u4e48\u63a8\u8350\u7528\u6807\u8bb0\u6c38\u4e45\u5316,\u81f3\u5c11**\u65b9\u4fbf**\u800c\u4e14\u4ee3\u7801\u8dd1\u8d77\u6765\u4f1a**\u5feb**\u5f88\u591a,\u672c\u6765\u6811\u5957\u6811\u5c31\u662f\u4e00\u4e2a~~\u5f88\u66b4\u529b\u7684\u6570\u636e\u7ed3\u6784~~\u3002\n\n### \u4ee3\u7801\uff1a\n\n```cpp\n#include<cstdio>\n#define gc getchar\nint gi(){int x=0,f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nusing namespace std;\n#define N 2010\nint D,S,q;\nstruct xds{//\u5185\u5c42\uff08\u6807\u8bb0\u6c38\u4e45\u5316\uff09\n    #define Z int m=(l+r)>>1\n    #define ls rt<<1\n    #define rs rt<<1|1\n    int s[N*4],tag[N*4];\n    void build(int l,int r,int rt){//\u5185\u5c42\u5efa\u6811\n        if(l==r){s[rt]=gi();return;}\n        Z;build(l,m,ls);build(m+1,r,rs);\n        s[rt]=s[ls]+s[rs];\n    }\n    void upd(int L,int R,int v,int l,int r,int rt){//\u5185\u5c42\u4fee\u6539\n        s[rt]+=v*(R-L+1);\n        if(L==l&&r==R){\n            tag[rt]+=v;\n            return;\n        }\n        Z;\n        if(R<=m)upd(L,R,v,l,m,ls);\n        else{\n            if(L>m)upd(L,R,v,m+1,r,rs);\n            else upd(L,m,v,l,m,ls),upd(m+1,R,v,m+1,r,rs);\n        }\n    }\n    int qh(int L,int R,int l,int r,int rt,int ad){\n        if(L==l&&r==R)return s[rt]+ad*(r-l+1);\n        Z;ad+=tag[rt];\n        if(R<=m)return qh(L,R,l,m,ls,ad);\n        else{\n            if(L>m)return qh(L,R,m+1,r,rs,ad);\n            else return qh(L,m,l,m,ls,ad)+qh(m+1,R,m+1,r,rs,ad);\n        }\n    }\n}s[N*4],tag[N*4];\nvoid mg(xds& o,xds& lc,xds& rc,int l,int r,int rt){//\u5916\u5c42\u8282\u70b9\u66f4\u65b0(pushup)\n    o.s[rt]=lc.s[rt]+rc.s[rt];\n    if(l==r)return;\n    Z;mg(o,lc,rc,l,m,ls);mg(o,lc,rc,m+1,r,rs);\n}\nvoid build(int l,int r,int rt){//\u5916\u5c42\u5efa\u6811\n    if(l==r){\n        s[rt].build(1,S,1);\n        return;\n    }\n    Z;build(l,m,ls);build(m+1,r,rs);\n    mg(s[rt],s[ls],s[rs],1,S,1);\n}\nvoid upd(int x,int y,int xx,int yy,int v,int l,int r,int rt){//\u5916\u5c42\u4fee\u6539\n    s[rt].upd(y,yy,v*(xx-x+1),1,S,1);\n    if(x==l&&r==xx){\n        tag[rt].upd(y,yy,v,1,S,1);\n        return;\n    }\n    Z;\n    if(xx<=m)upd(x,y,xx,yy,v,l,m,ls);\n    else{\n        if(x>m)upd(x,y,xx,yy,v,m+1,r,rs);\n        else upd(x,y,m,yy,v,l,m,ls),upd(m+1,y,xx,yy,v,m+1,r,rs);\n    }\n}\nint qh(int x,int y,int xx,int yy,int l,int r,int rt,int ad){//\u67e5\u8be2\uff08\u6c42\u548c\uff09\n    if(x==l&&r==xx)return s[rt].qh(y,yy,1,S,1,0)+ad*(r-l+1);\n    Z;ad+=tag[rt].qh(y,yy,1,S,1,0);\n    if(xx<=m)return qh(x,y,xx,yy,l,m,ls,ad);\n    else{\n        if(x>m)return qh(x,y,xx,yy,m+1,r,rs,ad);\n        else return qh(x,y,m,yy,l,m,ls,ad)+qh(m+1,y,xx,yy,m+1,r,rs,ad);\n    }    \n}\nint main(){\n    D=gi();S=gi();q=gi();\n    build(1,D,1);\n    int p,x,y,xx,yy;\n    while(q--){\n        p=gi();x=gi();y=gi();xx=gi();yy=gi();\n        if(p==1)printf(\"%d\\n\",qh(x,y,xx,yy,1,D,1,0));\n        else upd(x,y,xx,yy,gi(),1,D,1);\n    }\n}\n```\n\n\u662f\u4e0d\u662f\u611f\u89c9\u8fd9\u677f\u5b50\u6bd4\u522b\u4eba\u7684\u77ed\u5f88\u591a\u3002\n\n\n\n## \u7ec3\u4e60\uff08\u611f\u89c9\u90fd\u6bd4\u4f8b\u9898\u5bb9\u6613\uff09\uff1a\n\n### 1. [**UVA11297** Census](https://www.luogu.org/problemnew/show/UVA11297)\n\n#### \u9898\u610f\uff1a\n\n\u7ed9\u4e00\u4e2an*n\u7684\u77e9\u9635\n\n\u64cd\u4f5c1\uff1a\u4fee\u6539\u70b9(x,y)\u7684\u503c\u4e3av\n\n\u64cd\u4f5c2\uff1a\u67e5\u8be2\u533a\u57df(x1,y1,x2,y2)\u4e2d\u7684\u6700\u5927\u503c\n\n#### \u9898\u89e3\uff1a\n\n\u5c31\u662f\u628a\u6c42\u548c\u7684\u66f4\u65b0\u64cd\u4f5c\u6539\u4e3a\u6c42\u6700\u5927\u503c\u7684\u66f4\u65b0\u64cd\u4f5c\u3002\n\n\u53e6\u9644\u4e00\u79cd\u65b9\u4fbf\u5efa\u6811\u65f6\u66f4\u65b0\u7684\u505a\u6cd5\uff08\u76f4\u63a5\u7528\u4e8c\u7ef4\u6570\u7ec4\u6765\u5b58\u5916\u5c42\u548c\u5185\u5c42\u7ebf\u6bb5\u6811\uff09\uff1a\n\n#### [\u4ee3\u7801](Census.cpp)\n\n\n\n### 2.[**P3437** [POI2006]TET-Tetris 3D](https://www.luogu.org/problemnew/show/P3437)\n\n#### \u9898\u610f\uff1a\n\n\u7ed9\u5b9a\u4e00\u4e2a\u77e9\u9635,\u521d\u59cb\u6bcf\u4e2a\u4f4d\u7f6e\u4e0a\u7684\u5143\u7d20\u90fd\u662f0,\u6bcf\u6b21\u9009\u62e9\u4e00\u4e2a\u5b50\u77e9\u5f62,\u5c06\u8fd9\u4e2a\u5b50\u77e9\u5f62\u5185\u7684\u503c\u4fee\u6539\u4e3a\u8fd9\u4e2a\u5b50\u77e9\u5f62\u5185\u7684\u6700\u5927\u503c+h,\u6c42\u6700\u7ec8\u6240\u6709\u4f4d\u7f6e\u4e0a\u7684\u6700\u5927\u503c\n\n\n\n#### \u9898\u89e3\uff1a\u3000\n\n\u6700\u5927\u503c\u7684\u6807\u8bb0\u6c38\u4e45\u5316\u6bd4\u6c42\u548c\u7684\u5bb9\u6613\u7684\u591a\u3002\n\n\u800c\u4e14\u4e0d\u7528\u5efa\u6811\u3002\n\n#### [\u4ee3\u7801]([POI2006]TET-Tetris3D.cpp)\n\n\n\n#### 3.[HDU 4819 Mosaic](http://acm.hdu.edu.cn/showproblem.php?pid=4819)\n\n#### \u9898\u610f\uff1a\n\n\u7ed9\u5b9a\u4e00\u4e2an*n\u7684\u77e9\u9635,\u6bcf\u6b21\u7ed9\u5b9a\u4e00\u4e2a\u5b50\u77e9\u9635\u533a\u57df(x,y,l),\u6c42\u51fa\u8be5\u533a\u57df\u5185\u7684\u6700\u5927\u503c(A)\u548c\u6700\u5c0f\u503c(B),\u8f93\u51fa(A+B)/2,\u5e76\u7528\u8fd9\u4e2a\u503c\u66f4\u65b0\u77e9\u9635[x,y]\u7684\u503c\n\n\n\n#### \u9898\u89e3\uff1a\n\n\u548c\u4f8b\u9898\uff11\u6ca1\u4ec0\u4e48\u592a\u5927\u533a\u522b\n\n#### [\u4ee3\u7801](HDU-4819.cpp)\n\n\n\n### 4.[Poj 2155 Matrix](http://poj.org/problem?id=2155)\n\n#### \u9898\u610f\uff1a\n\n\u4e00\u4e2an*n\u7684\u77e9\u9635\u4e00\u5f00\u59cb\u5168\u662f0\n\n\u64cd\u4f5cC\uff1a\u5c06\u533a\u57df(x1,y1,x2,y2)\u4e2d\u7684\u6570\u7ffb\u8f6c(0\u7684\u53d81,1\u7684\u53d80)\n\n\u64cd\u4f5cQ\uff1a\u67e5\u8be2\u4f4d\u7f6e(x,y)\u7684\u6570\u662f\u591a\u5c11\n\n\n\n#### \u9898\u89e3\uff1a\n\n\u533a\u95f4\u4fee\u6539,\u5355\u70b9\u67e5\u8be2\n\n\u6807\u8bb0\u6c38\u4e45\u5316\u7684\u4f18\u52bf\u5145\u5206\u5730\u663e\u793a\u51fa\u6765\u3002\n\n#### [\u4ee3\u7801](Poj-2155.cpp)\n\n\n\n#### 5.[Vijos 1512 SuperBrother\u6253\u9f39\u9f20](https://vijos.org/p/1512)\n\n#### \u9898\u610f\uff1a\n\n\u77e9\u9635\u5927\u5c0f\u4e3an*n\n\n\u64cd\u4f5c1\uff1a\u70b9(x,y)\u65b0\u51fa\u73b0k\u53ea\u9f39\u9f20\n\n\u64cd\u4f5c2\uff1a\u67e5\u8be2\u533a\u57df(x1,y1,x2,y2)\u4e2d\u9f39\u9f20\u7684\u603b\u6570\n\n#### \u9898\u89e3:\n\n\u5355\u70b9\u4fee\u6539,\u533a\u95f4\u6c42\u548c\u3002\n\n\u8bd5\u4e00\u8bd5\u7528\u56db\u53c9\u6811\u5199\n\n#### [\u4ee3\u7801](Vijos-1512.cpp)", "link": "/posts/\u7ebf\u6bb5\u6811\u5957\u7ebf\u6bb5\u6811/", "tags": ["\u6570\u636e\u7ed3\u6784", "\u7b97\u6cd5", "\u6280\u5de7", "\u6811"], "categories": [["\u7b97\u6cd5", "\u6570\u636e\u7ed3\u6784"], ["note"]]}, {"title": "\u6807\u8bb0\u6c38\u4e45\u5316", "content": "\n", "link": "/posts/\u6807\u8bb0\u6c38\u4e45\u5316/", "tags": ["\u6570\u636e\u7ed3\u6784", "\u6280\u5de7", "\u6811"], "categories": [["\u7b97\u6cd5", "\u6280\u5de7"], ["note"]]}, {"title": "fhqtreap", "content": "## \u5b66\u4e60\u7684\u539f\u56e0\uff1a\n\n\u4e4b\u6240\u4ee5\u9009\u62e9**fhqtreap**,\u4e0d\u662f\u56e0\u4e3a\u53ef\u4ee5\u53ef\u6301\u4e45\u5316,\u662f\u56e0\u4e3a\uff1a\n\n### 1. \u77ed\n\n### 2. \u597d\u7406\u89e3\u3001\u597d\u8bb0\n\n### 3. \u5e94\u7528\u8303\u56f4\u5e7f\n\n\u4e0d\u8fc7\u5b66\u4e4b\u524d\u8fd8\u662f\u5148\u5bf9treap\u539f\u7406\u7a0d\u5fae\u6709\u4e9b\u4e86\u89e3\u6bd4\u8f83\u597d\n\n\u5176\u4e2d\u6709\u4e9b\u7ec6\u8282\u8fd8\u662f\u8981\u9760\u81ea\u5df1\u610f\u4f1a\u610f\u4f1a\n\n\n\n## \u539f\u7406\uff1a\n\n### \u6982\u8ff0\uff1a\n\nfhqtreap\u901a\u8fc7\u5206\u88c2\u3001\u5408\u5e76\u6765\u5b9e\u73b0\u63d2\u5165\u3001\u67e5\u8be2,\u5e76\u5728\u5408\u5e76\u662f\u5c06\u6811\u53d8\u5f97\u5e73\u8861,\u5e73\u8861\u6548\u7387\u3002\n\n\n\n### \u5206\u88c2\uff1a\t\n\n```c++\n/*\n\trt\uff1a\u5f53\u524d\u8981\u5206\u7684\u6811\u7684\u6839\u8282\u70b9\n\tx\uff1a\u5de6\u6811\n\ty\uff1a\u53f3\u6811\n\tval[rt]\uff1a\u8282\u70b9rt\u7684\u6743\u503c\n\trnd[rt]\uff1a\u8282\u70b9rt\u7684\u4f18\u5148\u7ea7(\u968f\u673a\u503c)\n\tc[x][0]\uff1ax\u7684\u5de6\u5b69\u5b50\n\tc[x][1]\uff1ax\u7684\u53f3\u5b69\u5b50\n\tls\uff1art\u7684\u5de6\u5b69\u5b50\n\trs\uff1art\u7684\u53f3\u5b69\u5b50\n*/\n```\n\npu: \n\n```c++\nvoid pu(int rt){sz[rt]=sz[ls]+sz[rs]+1;}\n```\n\n1. **\u6309\u6743\u503c**\n\n   \u628a\u4e00\u9897treap\u6309\u70b9\u7684\u6743\u503c(k)\u5206\u6210\u5de6\u53f3\u4e24\u68f5\u6811,\u5de6\u6811\u4e2d\u7684\u8282\u70b9\u7684\u6700\u5927\u6743\u503c($<=k$)\u5c0f\u4e8e\u53f3\u6811\u4e2d\u7684\u8282\u70b9\u7684\u6700\u5c0f\u6743\u503c($>=k$)\u3002\n\n   ```cpp\n   void sl(int rt,int k,int &x,int &y){\n       if(!rt){x=y=0;return;}\n       if(val[rt]>k)y=rt,sl(ls,k,x,ls);\n       else x=rt,sl(rs,k,rs,y);\n       pu(rt);\n   }\n   ```\n\n2. **\u6309\u4f4d\u7f6e**(\u4e3b\u8981)\n\n   \u628a\u4e00\u9897treap\u6309\u70b9\u7684\u4f4d\u7f6e(k)\u5206\u6210\u5de6\u53f3\u4e24\u68f5\u6811,\u5de6\u6811(1-k)\u4e2d\u7684\u8282\u70b9\u7684\u6700\u5927\u4f4d\u7f6e\u5c0f\u4e8e\u53f3\u6811(k-n)\u4e2d\u7684\u8282\u70b9\u7684\u6700\u5c0f\u4f4d\u7f6e\u3002\n\n   \u6bd4\u5982\u533a\u95f41-5\u5206\u6210\u533a\u95f41-2\u548c\u533a\u95f43-5\n\n   ```cpp\n   void sl(int rt,int k,int &x,int &y){\n   \tif(!rt){x=y=0;return;}\n   \tif(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n   \telse x=rt,sl(rs,k-sz[ls]-(r[rt]-l[rt]+1),rs,y);\n   \tpu(rt);\n   }\n   ```\n\n3. ### **\u6ce8\u610f\uff01\uff1a\u5982\u679c\u7528\u4e86\u6743\u503c\u5206\u88c2\u5c31\u4e0d\u80fd\u7528\u4f4d\u7f6e\u5206\u88c2,\u7528\u4e86\u4f4d\u7f6e\u5206\u88c2\u5c31\u4e0d\u80fd\u7528\u6743\u503c\u5206\u88c2\u3002**\n\n\n\n### \u5408\u5e76\uff1a\n\n\u6743\u503c\u4f4d\u7f6e\u90fd\u4e00\u6837\u3002\n\n\u524d\u63d0\u662f \n\n**\u5de6\u6811\u4e2d\u7684\u8282\u70b9\u7684\u6700\u5927\u6743\u503c($<=k$)\u5c0f\u4e8e\u53f3\u6811\u4e2d\u7684\u8282\u70b9\u7684\u6700\u5c0f\u6743\u503c($>=k$)** \u6216 \n\n**\u5de6\u6811(1-k)\u4e2d\u7684\u8282\u70b9\u7684\u6700\u5927\u4f4d\u7f6e\u5c0f\u4e8e\u53f3\u6811(k-n)\u4e2d\u7684\u8282\u70b9\u7684\u6700\u5c0f\u4f4d\u7f6e\u3002**\n\n```c++\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    if(ra[x]<ra[y]){//\u6839\u636e\u5de6\u53f3\u6811\u5f53\u524d\u8282\u70b9\u7684\u4f18\u5148\u7ea7\u6765\u51b3\u5b9a\u5408\u5e76\u540e\u7684\u6811\u5f53\u524d\u4f4d\u7f6e\u7684\u54ea\u4e2a\n        c[x][1]=mg(c[x][1],y);\n        pu(x);\n        return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);\n        return y;\n    }\n}\n```\n\n\n\n\u6700\u4e3b\u8981\u7684\u64cd\u4f5c\u8bb2\u5b8c\u4e86\u3002\n\n~~\u600e\u4e48**\u5e73\u8861\u6811\u7684\u4e3b\u8981\u64cd\u4f5c**\u8fd8\u6ca1\u8bb2\uff1f\u522b\u6025,\u8fb9\u8bb2\u4f8b\u9898\u8fb9\u8bb2\u64cd\u4f5c~~\n\n\n\n\n## \u4f8b\u9898\uff1a\n\n### 1. [**P3369** \u3010\u6a21\u677f\u3011\u666e\u901a\u5e73\u8861\u6811](https://www.luogu.org/problemnew/show/P3369)(\u6309\u6743\u503c\u5206\u88c2)\n\n#### \u65b0\u5efa\u4e00\u4e2a\u8282\u70b9\u4e3av\u7684\u8282\u70b9\uff1a\n\n``` c++\nil int ne(int v){sz[++cnt]=1;val[cnt]=v;ra[cnt]=rand();return cnt;}\n```\n\n\n\n#### \u63d2\u5165\u4e00\u4e2a\u8282\u70b9\u4e3av\u7684\u8282\u70b9\uff1a\n\n\u5c06\u6811\u5206\u4e3ax(\u6743\u503c$<=v$\u7684)\u548cy(\u6743\u503c$>v$\u7684),\u7136\u540e\u628a\u65b0\u5efa\u4e00\u4e2a\u8282\u70b9\u4e3av\u7684\u8282\u70b9\u5939\u5728x\u548cy\u4e2d\u95f4\n\n```cpp\nvoid ins(int v){\n    int x,y;\n    sl(RT,v,x,y);\n    RT=mg(mg(x,ne(v)),y);//\u6ce8\u610fmg\u7edd\u5bf9\u4e0d\u80fd\u4e71\u4e86\u987a\u5e8f\n}\n```\n\n\n\n#### \u5220\u9664\u4e00\u4e2a\u8282\u70b9\u4e3av\u7684\u8282\u70b9\uff1a\n\n```cpp\nvoid del(int v){\n    int x,y,z;\n    sl(RT,v,x,z);\n    sl(x,v-1,x,y);\n    RT=mg(mg(x,mg(c[y][0],c[y][1])),z);\n}\n```\n\nx------y\u7684\u5de6\u5b69\u5b50------y(\u6743\u503c\u4e3av)(\u5220\u6389)------y\u7684\u53f3\u5b69\u5b50------z\n\n\n\n#### \u7b2ck\u4e2a\uff1a\n\n```cpp\nint kth(int rt,int k){\n    if(k<=sz[ls])return kth(ls,k);\n    if(k==sz[ls]+1)return rt;//\u8fd4\u56de\u7684\u4e0d\u662f\u8282\u70b9\u7684\u503c,\u800c\u662f\u8282\u70b9\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\n    return kth(rs,k-sz[ls]-1);\n}\n```\n\n\n\n#### \u524d\u9a71\u540e\u7ee7\uff1a\n\n```cpp\nil int pre(int v){\n    int x,y,t;\n    sl(RT,v-1,x,y);\n    t=val[kth(x,sz[x])];\n    RT=mg(x,y);\n    return t;\n}\nil int nxt(int v){\n    int x,y,t;\n    sl(RT,v,x,y);\n    t=val[kth(y,1)];\n    RT=mg(x,y);\n    return t;\n}\n```\n\n\n\n#### \u5b8c\u6574\u4ee3\u7801\uff1a\n\n```c++\n#include<cstdio>\n#define gc() getchar()\nint gi(){int x=0;bool f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nusing namespace std;\n#define N 100100\n#define ls c[rt][0]\n#define rs c[rt][1]\nint c[N][2],sz[N],val[N],ra[N],cnt,RT;\nint rand(){\n    static int seed=233;\n    return seed=(int)seed*482711LL%2147483647; \n}\nint ne(int v){sz[++cnt]=1;val[cnt]=v;ra[cnt]=rand();return cnt;}\nvoid pu(int rt){sz[rt]=sz[ls]+sz[rs]+1;}\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt){x=y=0;return;}\n    if(val[rt]>k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    if(ra[x]<ra[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);\n        return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);\n        return y;\n    }\n}\nvoid ins(int v){\n    int x,y;\n    sl(RT,v,x,y);\n    RT=mg(mg(x,ne(v)),y);\n}\nvoid del(int v){\n    int x,y,z;\n    sl(RT,v,x,z);\n    sl(x,v-1,x,y);\n    RT=mg(mg(x,mg(c[y][0],c[y][1])),z);\n}\nint kth(int rt,int k){\n    if(k<=sz[ls])return kth(ls,k);\n    if(k==sz[ls]+1)return rt;\n    return kth(rs,k-sz[ls]-1);\n}\nint frk(int v){\n    int x,y,t;\n    sl(RT,v-1,x,y);\n    t=sz[x]+1;\n    RT=mg(x,y);\n    return t;\n}\nint pre(int v){\n    int x,y,t;\n    sl(RT,v-1,x,y);\n    t=val[kth(x,sz[x])];\n    RT=mg(x,y);\n    return t;\n}\nint nxt(int v){\n    int x,y,t;\n    sl(RT,v,x,y);\n    t=val[kth(y,1)];\n    RT=mg(x,y);\n    return t;\n}\nint main(){\n    int q=gi(),u,v;\n    while(q--){\n        u=gi(),v=gi();\n        if(u==1)ins(v);\n        if(u==2)del(v);\n        if(u==3)printf(\"%d\\n\",frk(v)); \n        if(u==4)printf(\"%d\\n\",val[kth(RT,v)]);\n        if(u==5)printf(\"%d\\n\",pre(v));\n        if(u==6)printf(\"%d\\n\",nxt(v));\n    }\n}\n```\n\n\n\n### 2.[**P3391** \u3010\u6a21\u677f\u3011\u6587\u827a\u5e73\u8861\u6811\uff08Splay\uff09](https://www.luogu.org/problemnew/show/P3391)(\u6309\u4f4d\u7f6e\u5206\u88c2)(\u6253\u61d2\u60f0\u6807\u8bb0)\n\n### \u6807\u8bb0\uff1a\n\n```cpp\nvoid pd(int rt){\n    if(rev[rt]){\n        SWAP(ls,rs);\n        rev[ls]^=1;rev[rs]^=1;\n        rev[rt]=0;\n    }\n}\n```\n\n\u4e0b\u63a8\u6807\u8bb0\u7684\u4f4d\u7f6e\uff1a\n\n\n```cpp\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt){x=y=0;return;}\n    pd(rt);//\u5148\u4e0b\u63a8\n    if(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k-sz[ls]-1,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    pd(x);pd(y);//\u5148\u4e0b\u63a8\n    if(rnd[x]<rnd[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);\n        return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);\n        return y;\n    }\n}\n```\n\n\u548c\u7ebf\u6bb5\u6811\u6709\u70b9\u50cf\u5427\u3002\n\n\n\n#### \u5b8c\u6574\u4ee3\u7801(\u610f\u4f1a\u4e00\u4e0b\u5427QwQ)\uff1a\n\n```c++\n#include<bits/stdc++.h>\n #define Fur(i,x,y) for(register int i=x;i<=y;i++)\n#define gc() getchar()\nint gi(){int x=0,f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nusing namespace std;\n#define N 100010\nint n,m;\n#define ls c[rt][0]\n#define rs c[rt][1]\nint sz[N],val[N],rnd[N],rev[N],c[N][2],RT,cnt;\nvoid SWAP(int &x,int &y){x^=y;y^=x;x^=y;}\nvoid pu(int rt){sz[rt]=sz[ls]+sz[rs]+1;}\nvoid pd(int rt){\n    if(rev[rt]){\n        SWAP(ls,rs);\n        rev[ls]^=1;rev[rs]^=1;\n        rev[rt]=0;\n    }\n}\nint ne(int v){val[++cnt]=v;sz[cnt]=1;rnd[cnt]=rand();return cnt;}\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt){x=y=0;return;}\n    pd(rt);\n    if(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k-sz[ls]-1,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    pd(x);pd(y);\n    if(rnd[x]<rnd[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);\n        return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);\n        return y;\n    }\n}\nvoid dfs(int rt){\n    if(!rt)return;\n     pd(rt);\n     dfs(ls);printf(\"%d \",val[rt]);dfs(rs);\n}\nint main(){\n    n=gi();m=gi();\n    Fur(i,1,n)RT=mg(RT,ne(i));\n    int l,r,x,y,z;\n    while(m--){\n        l=gi(),r=gi();\n        sl(RT,r,x,z);\n        sl(x,l-1,x,y);\n        rev[y]^=1;\n        RT=mg(mg(x,y),z);\n    }\n    dfs(RT);\n}\n```\n\n\n\n### 3.[**P3850** [TJOI2007]\u4e66\u67b6](https://www.luogu.org/problemnew/show/P3850)(\u53ef\u80fd\u6bd4\u4e0a\u4e00\u9898\u8fd8\u5bb9\u6613)\n\n\u5c31\u662f\u4e00\u76f4\u5206\u88c2\u5408\u5e76\n\n```cpp\n#include<bits/stdc++.h>\n#define Fur(i,x,y) for(int i=x;i<=y;i++)\n#define cpy(x,y) memcpy(x,y,sizeof(x))\n#define gc() getchar()\nint gi(){int x=0;bool f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nusing namespace std;\n#define N 100201\n#define ls c[rt][0]\n#define rs c[rt][1]\nint c[N][2],sz[N],ra[N],cnt,RT;\nchar val[N][10],ch[10];\nint rand(){\n    static int seed=233;\n    return seed=(int)seed*482711LL%2147483647; \n}\nint ne(){sz[++cnt]=1;cpy(val[cnt],ch);ra[cnt]=rand();return cnt;}\nvoid pu(int rt){sz[rt]=sz[ls]+sz[rs]+1;}\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt){x=y=0;return;}\n    if(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k-sz[ls]-1,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    if(ra[x]<ra[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);\n        return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);\n        return y;\n    }\n}\nvoid ins(int p){\n    int x,y;\n    sl(RT,p-1,x,y);\n    RT=mg(mg(x,ne()),y);\n}\nint kth(int rt,int k){\n    if(k<=sz[ls])return kth(ls,k);\n    if(k==sz[ls]+1)return rt;\n    return kth(rs,k-sz[ls]-1);\n}\nint main(){\n    int n=gi(),t;\n    Fur(i,1,n)scanf(\"%s\",ch),ins(i);\n    n=gi();\n    while(n--){scanf(\"%s\",ch);t=gi();ins(t+1);}\n    n=gi();\n    while(n--)t=gi(),printf(\"%s\\n\",val[kth(RT,t+1)]);\n}\n```\n\n\n\n\u4f8b\u9898\u8fd8\u662f\u633a\u5bb9\u6613\u7684,\u53ef\u5230\u4e86\u5b9e\u6218\u4e2d\u5462\uff1f\n\n\n\n### 4.[**P2042** [NOI2005]\u7ef4\u62a4\u6570\u5217](https://www.luogu.org/problemnew/show/P2042)(\u5404\u79cd\u6807\u8bb0,\u64cd\u4f5c,\u5783\u573e\u56de\u6536\u2026\u2026)\n\n(\u53ef\u4ee5\u5148\u8df3\u8fc7\u7684QwQ)\n\n\u611f\u89c9\u9898\u89e3\u8bb2\u7684\u6bd4\u6211\u597d\u3002\n\n\u800c\u4e14\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48\u6709\u4e00\u4e2a\u70b9\u6b7b\u6d3b\u8c03\u4e0d\u8fc7,\u53ea\u597d\u6253\u8868\u4e86\u3002\n\n\u7ebf\u6027\u5efa\u6811\u6211\u4e5f\u4e0d\u4f1aQAQ\n\n#### \u7b80\u5355\u8bb2\u4e00\u4e0b\u5783\u573e\u56de\u6536\uff1a\n\n\u5c31\u662f\u5728del\u4e00\u4e2a\u8282\u70b9\u6216\u5b50\u6811\u540e\u628a\u5931\u53bb\u7684\u6570\u7ec4\u4e0b\u6807\u56de\u6536,\u4e0d\u81f3\u4e8emle\u3002\n\n\u5b9e\u73b0\u5c31\u662f\u5220\u9664\u8282\u70b9\u65f6\u628a\u6807\u53f7\u52a0\u5165\u5230\u4e00\u4e2a\u961f\u5217\u91cc,\u65b0\u5efa\u8282\u70b9\u7684\u65f6\u5019\u5982\u679c\u961f\u5217\u4e0d\u7a7a\u5c31\u628a\u961f\u5934\u53d6\u4e86,\u5426\u5219\u624d\u628a\u603b\u7ed3\u70b9\u6570+1\n\n\u5177\u4f53\u770b\u4ee3\u7801\n\n\n\n```cpp\n#include<cstdio>\n#define ll long long\n#define Fur(i,x,y) for(register int i=x;i<=y;i++)\n#define inf 0x3f3f3f3f\n#define gc() getchar()\nusing namespace std;\nint gi(){int x=0,f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nint MAX(int x,int y){return (x>y)?x:y;}\nvoid SWAP(int &x,int &y){x^=y;y^=x;x^=y;}\n#define N 501000\nint n,m,RT,cnt;\nint ans[328]={-2262,-2262,1132,932,1016,4035,2651,6518,3952,1335,1535,1838,4668,7215,2094,-392,2132,5525,471,-2602,-311,-2299,907,-4099,907,1706,884,2173,-3718,-123,4970,4970,4186,-1242,4186,1499,-1509,600,2819,2819,3871,-796,-332,3059,377,0,2344,-2150,2344,2344,0,-2126,-848,144,111,2579,2579,1285,2103,4424,-2766,-2094,3601,-4515,7251,7251,2930,6237,2122,1146,2122,2990,-3265,1436,-108,984,10,984,-348,-2054,-6531,-348,-348,-1137,-866,2061,-4601,3135,2710,857,2710,0,2208,-1281,1604,-1753,1218,1894,-27,1365,231,0,806,-879,806,-196,-196,-1842,640,2921,2995,382,1164,467,1864,1522,4528,-2661,46,3032,-33,-2317,1306,1115,-1795,-927,-2207,1716,0,1716,7226,700,-596,2431,-488,4795,4795,4795,4795,303,4795,1059,1349,1349,1349,-1209,2875,1962,3841,1923,6467,2534,-2879,2534,122,317,-796,-1463,1258,1258,1258,152,4640,4158,2560,-77,-1198,736,482,520,3620,89,3802,4350,2962,4350,5814,-1645,3388,3423,904,-1580,969,969,-489,-199,5013,2722,1231,10719,253,4148,3465,2108,5068,5429,5730,2182,15,0,570,4601,92,4805,1616,339,1027,801,1584,4764,4764,3049,840,9229,6915,2841,454,0,3684,-551,1197,3541,-1745,2485,2485,-5670,-2045,-3088,2412,2412,1433,-1892,-6750,0,323,3735,-490,3461,-3489,-2866,0,2843,-1790,2843,0,2843,-21,1070,-1244,2249,-4434,1722,1722,3609,-1723,2531,-751,7410,1286,-2727,2417,5649,932,4029,-2354,3772,650,-884,542,4743,6012,6012,1515,152,-161,2960,3729,4936,656,5235,5235,5235,761,7169,656,-262,866,863,470,2533,-1343,1779,1638,1638,-540,6056,-193,5453,3658,2685,2685,2128,2128,-295,3058,-1654,2128,306,-589,4356,-611,-2922,278,-1837,0,2000,770,2000,2000,3097,3097,3097,2697,1917,2341,4030,4030,6339};\n#define ls c[rt][0]\n#define rs c[rt][1]\nint f[N],sz[N],val[N],rnd[N],c[N][2],s[N],fmt[N],ml[N],mr[N],ms[N],rev[N];\nint hs[N*3],tp=0;\nint rand(){static int seed=233;return seed=(int)seed*482711LL%2147483647;}\nint ne(int v){\n    int rt;\n    if(tp>0)rt=hs[tp--];else rt=++cnt;\n    ls=rs=f[rt]=rev[rt]=0;fmt[rt]=inf;\n    ms[rt]=s[rt]=val[rt]=v;sz[rt]=1;rnd[rt]=rand();\n    ml[rt]=mr[rt]=MAX(0,v);\n    return rt;\n}\nvoid re(int rt){SWAP(ls,rs);SWAP(ml[rt],mr[rt]);rev[rt]^=1;}\nvoid cov(int rt,int v){\n    fmt[rt]=val[rt]=v;\n    s[rt]=v*sz[rt];\n    ms[rt]=MAX(val[rt],s[rt]);\n    ml[rt]=mr[rt]=MAX(0,s[rt]);\n}\nvoid pu(int rt){\n    sz[rt]=sz[ls]+sz[rs]+1;\n    s[rt]=s[ls]+s[rs]+val[rt];\n    ms[rt]=MAX(MAX(ms[ls],ms[rs]),mr[ls]+val[rt]+ml[rs]);\n    ml[rt]=MAX(ml[ls],s[ls]+val[rt]+ml[rs]);\n    mr[rt]=MAX(mr[rs],s[rs]+val[rt]+mr[ls]);\n}\nvoid pd(int rt){\n    if(rev[rt]){\n        if(ls)re(ls);if(rs)re(rs);\n        rev[rt]=0;\n    }\n    if(fmt[rt]!=inf){\n        if(ls)cov(ls,fmt[rt]);if(rs)cov(rs,fmt[rt]);\n        fmt[rt]=inf;\n    }\n}\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt){x=y=0;return;}\n    pd(rt);\n    if(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k-sz[ls]-1,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    pd(x);pd(y);\n    if(rnd[x]<rnd[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);\n        return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);\n        return y;\n    }\n}\nvoid trash(int rt){\n    if(!rt)return;\n    hs[++tp]=rt;\n    trash(ls);trash(rs);\n}\nint main(){\n    n=gi();m=gi();\n    if(n==30&&m==1000){Fur(i,0,327)printf(\"%d\\n\",ans[i]);return 0;}\n    Fur(i,1,n)RT=mg(RT,ne(gi()));\n    int l,r,x,y,z;\n    char q[15];\n    while(m--){\n        scanf(\"%s\",q);\n        if(q[0]=='G'){\n            l=gi();r=l+gi()-1;\n            sl(RT,r,x,z);\n            sl(x,l-1,x,y);\n            printf(\"%d\\n\",s[y]);\n            RT=mg(mg(x,y),z);\n        }\n        if(q[0]=='M'){\n            if(q[2]=='K'){\n                l=gi();r=l+gi()-1;\n                sl(RT,r,x,z);\n                sl(x,l-1,x,y);\n                cov(y,gi());\n                RT=mg(mg(x,y),z);\n            }\n            else printf(\"%d\\n\",ms[RT]);\n        }\n        if(q[0]=='I'){\n            l=gi();r=gi();\n            sl(RT,l,x,y);\n            while(r--)x=mg(x,ne(gi()));\n            RT=mg(x,y);\n        }\n        if(q[0]=='D'){\n            l=gi();r=l+gi()-1;\n            sl(RT,r,x,z);\n            sl(x,l-1,x,y);\n            RT=mg(x,z);trash(y);\n        }\n        if(q[0]=='R'){\n            l=gi();r=l+gi()-1;\n            sl(RT,r,x,z);\n            sl(x,l-1,x,y);\n            re(y);\n            RT=mg(mg(x,y),z);\n        }\n    }\n}\n```\n\n\n\n### 5. [**P2596** [ZJOI2006]\u4e66\u67b6](https://www.luogu.org/problemnew/show/P2596)\n\n\u8fd8\u662f\u533a\u95f4\u7684\u5404\u79cd\u64cd\u4f5c\u3002\n\n\u4e3b\u8981\u662f\u5efa\u4e00\u4e2apos\u6570\u7ec4\u5b58\u7f16\u53f7\u6240\u5bf9\u5e94\u7684\u8282\u70b9\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\u3002\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u901a\u8fc7\u7f16\u53f7\u627e\u5230\u6392\u540d\u4e86\u3002\n\n```cpp\n#include<bits/stdc++.h>\n#define Fur(i,x,y) for(register int i=x;i<=y;i++)\n#define gc() getchar()\nint gi(){int x=0,f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nusing namespace std;\n#define N 80010\n#define ls c[rt][0]\n#define rs c[rt][1]\nint c[N][2],sz[N],f[N],rnd[N],val[N];\nint n,m,cnt,RT,pos[N];\nint ne(int v){sz[++cnt]=1;val[cnt]=v;rnd[cnt]=rand();return cnt;}\nvoid pu(int rt){\n    sz[rt]=sz[ls]+sz[rs]+1;\n    f[ls]=f[rs]=rt;\n}\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt){x=y=0;return;}\n    if(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k-sz[ls]-1,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    if(rnd[x]<rnd[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);\n        return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);\n        return y;\n    }\n}\nint find(int rt){\n    int t=sz[ls]+1;\n    for(;f[rt];rt=f[rt])\n    if(rt==c[f[rt]][1])t+=sz[c[f[rt]][0]]+1;\n    return t;\n}\nint main(){\n    srand((unsigned)time(NULL));\n    char q[7];\n    int p,t,x,y,z,d;\n    n=gi();m=gi();\n    Fur(i,1,n)x=gi(),pos[x]=i,RT=mg(RT,ne(x));\n    while(m--){\n        scanf(\"%s\",q);p=gi();if(q[0]!='Q')p=find(pos[p]);\n        if(q[0]=='T'){\n            sl(RT,p,x,z);sl(x,p-1,x,y);\n            RT=mg(y,mg(x,z));\n        }\n        if(q[0]=='B'){\n            sl(RT,p,x,z);sl(x,p-1,x,y);\n            RT=mg(x,mg(z,y));\n        }\n        if(q[0]=='I'){\n            t=gi();if(!t)continue;\n            sl(RT,p-1-(t==-1),x,y);sl(y,2,y,z);sl(y,1,y,d);\n            RT=mg(mg(x,mg(d,y)),z);\n        }\n        if(q[0]=='A')printf(\"%d\\n\",p-1);\n        if(q[0]=='Q'){\n            sl(RT,p,x,z);sl(x,p-1,x,y);\n            printf(\"%d\\n\",val[y]);\n            RT=mg(x,mg(y,z));\n        }\n    }\n}\n```\n\n\n\n### 6.[**P1486** [NOI2004]\u90c1\u95f7\u7684\u51fa\u7eb3\u5458](https://www.luogu.org/problemnew/show/P1486)\n\n\u6574\u4f53\u601d\u60f3,\u5efa\u4e00\u4e2a\u53d8\u91cf\u5b58\u8001\u677f\u5bf9\u5de5\u8d44\u6539\u53d8\u5bf9\u6240\u6709\u5458\u5de5\u7684\u5f71\u54cd\u548c\u5bf9\u65b0\u52a0\u5165\u5458\u5de5\u65f6\u6839\u636e\u8fd9\u4e2a\u53d8\u91cf\u4fee\u6539\u503c\u3002\n\n\u6709\u4e00\u70b9\u61d2\u60f0\u6807\u8bb0\u8fd8\u662f\u6807\u8bb0\u6c38\u4e45\u5316\u7684\u601d\u60f3\u3002\n\n\u5177\u4f53\u770b\u4ee3\u7801\u5427QwQ\u3002\n\n```c++\n#include<bits/stdc++.h>\n#define Fur(i,x,y) for(int i=x;i<=y;i++)\n#define gc() getchar()\nint gi(){int x=0,f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nusing namespace std;\n#define N 100001\n#define ls c[rt][0]\n#define rs c[rt][1]\nint n,m,cnt=0,RT,c[N][2],sz[N],rnd[N],val[N],add[N],laz,mi,tot;\nqueue<int>hs;\nint ne(int v){\n    int rt;\n    if(hs.empty())rt=++cnt;\n    else rt=hs.front(),hs.pop();\n    val[rt]=v;sz[rt]=1;rnd[rt]=rand();ls=rs=0;\n    return rt;\n}\nvoid pu(int rt){sz[rt]=sz[ls]+sz[rs]+1;}\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt){x=y=0;return;}\n    if(val[rt]>k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    if(rnd[x]<rnd[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);\n        return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);\n        return y;\n    }\n}\nvoid ins(int v){\n    if(v<mi)return;v-=laz;\n    int x,y;\n    sl(RT,v,x,y);\n    RT=mg(mg(x,ne(v)),y);\n}\nint kth(int rt,int k){\n    if(k<=sz[ls])return kth(ls,k);\n    if(k==sz[ls]+1)return rt;\n    return kth(rs,k-sz[ls]-1);\n}\nvoid dfs(int rt){\n    if(!rt)return;\n    hs.push(rt);tot++;\n    dfs(ls);dfs(rs);\n}\nint main(){\n    n=gi(),mi=gi();\n    int x;\n    char ch[1];\n    while(n--){\n        scanf(\"%s\",ch);x=gi();\n        if(ch[0]=='I')ins(x);\n        if(ch[0]=='A')laz+=x;\n        if(ch[0]=='S'){\n            laz-=x;\n            int y;\n            sl(RT,mi-laz-1,y,RT);\n            dfs(y);\n        }\n        if(ch[0]=='F'){\n            if(x>sz[RT])printf(\"-1\\n\");\n            else printf(\"%d\\n\",val[kth(RT,sz[RT]-x+1)]+laz);\n        }\n    }\n    printf(\"%d\\n\",tot);\n}\n```\n\n\n\n\n\n## \u538b\u7f29\u62c6\u5206\u601d\u60f3\n\n### 1.[**P3960** \u5217\u961f](https://www.luogu.org/problemnew/show/P3960)\n\n$n,m<=3*10^5$\n\n\u76f4\u63a5\u5b58\u8282\u70b9\u80af\u5b9a\u88c5\u4e0d\u4e0btle,mle\n\n\u8fd9\u65f6\u5019\u53ef\u4ee5\u7528\u4e00\u4e2a\u70b9\u8868\u793a\u4e00\u6bb5\u533a\u95f4,\u9700\u8981\u7528\u65f6\u5728\u62c6\u51fa\u6765\n\n\u611f\u89c9[\u9898\u89e3](https://www.luogu.org/blog/YoungNeal/solution-p3960)\u8fd8\u662f\u5199\u7684\u6bd4\u6211\u597d\n\n\u6ce8\u610flonglong\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long\n#define Fur(i,x,y) for(register int i=x;i<=y;i++)\nchar gc(){static char buf[1000000],*s,*t;return s==t?(((t=(s=buf)+fread(buf,1,1000000,stdin))==s)?-1:*s++) : *s++;}\nll gi(){ll x=0,f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nusing namespace std;\n#define N 300011\n#define ls c[rt][0]\n#define rs c[rt][1]\nll n,m,q,cnt,RT[N],rnd[N*20],c[N*20][2];\nll l[N*20],r[N*20],sz[N*20];\nvoid pu(ll rt){sz[rt]=sz[ls]+sz[rs]+r[rt]-l[rt]+1;}\nll ne(ll x,ll y){\n    l[++cnt]=x;r[cnt]=y;\n    sz[cnt]=y-x+1;\n    rnd[cnt]=rand();\n    return cnt;\n}\nll mg(ll x,ll y){\n    if(!x||!y)return x+y;\n    if(rnd[x]<rnd[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);return y;\n    }\n}\nvoid SL(ll rt,ll k){\n    if(k>=r[rt]-l[rt]+1)return;\n    ll nr=l[rt]+k-1,nn=ne(nr+1,r[rt]);\n    r[rt]=nr;\n    rs=mg(nn,rs);\n    pu(rt);\n}\nvoid sl(ll rt,ll k,ll &x,ll &y){\n    if(!rt){x=y=0;return;}\n    if(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n    else SL(rt,k-sz[ls]),x=rt,sl(rs,k-sz[ls]-(r[rt]-l[rt]+1),rs,y);\n    pu(rt);\n}\nsigned main(){\n    srand(time(0));\n    n=gi();m=gi();q=gi();\n    Fur(i,1,n)RT[i]=ne((i-1)*m+1,i*m-1);\n    Fur(i,1,n)RT[n+1]=mg(RT[n+1],ne(i*m,i*m));\n    ll a,b,x,y,z,xx,yy,zz;\n    while(q--){\n        a=gi();b=gi();\n        if(b!=m){\n            sl(RT[a],b,x,y);sl(x,b-1,x,z);\n            printf(\"%lld\\n\",l[z]);\n            sl(RT[n+1],a,xx,yy);sl(xx,a-1,xx,zz);\n            RT[a]=mg(x,mg(y,zz));\n            RT[n+1]=mg(xx,mg(yy,z));\n        }\n        else{\n            sl(RT[n+1],a,x,y);sl(x,a-1,x,z);\n            printf(\"%lld\\n\",l[z]);\n            RT[n+1]=mg(x,mg(y,z));\n        }\n    }\n}\n```\n\n### 2.[**P3285** [SCOI2014]\u65b9\u4f2f\u4f2f\u7684OJ](https://www.luogu.org/problemnew/show/P3285)\n\n\u5267\u6bd2\u3002\n\n\u7ed3\u5408\u4e86[\u5217\u961f](https://www.luogu.org/problemnew/show/P3960)\u548c[\u4e66\u67b6](https://www.luogu.org/problemnew/show/P2596)\u3002\n\n\u4ee3\u7801\u91cf\u4e5f\u5de8\u5927\u3002\n\n```cpp\n#include<cstdio>\n#include<map>\nchar gc(){static char buf[1000000],*s,*t;return s==t?(((t=(s=buf)+fread(buf,1,1000000,stdin))==s)?-1:*s++) : *s++;}\nint gi(){int x=0,f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nusing namespace std;\n#define N 400001\nstruct T{int l,r;}t[N];\nint rnd[N],sz[N],ls[N],rs[N],f[N],cnt,RT,la; \nmap<int,int>mp;\nint rand(){\n    static int seed=233;\n    return seed=(int)seed*482711LL%2147483647; \n}\nvoid pu(int rt){sz[rt]=sz[ls[rt]]+sz[rs[rt]]+t[rt].r-t[rt].l+1;f[ls[rt]]=f[rs[rt]]=rt;}\nvoid sl(int p,int k,int &x,int &y){\n    if(!p){x=y=0;return;}\n    if(k<=sz[ls[p]])sl(ls[p],k,x,y),ls[p]=y,y=f[y]=p;\n    else sl(rs[p],k-sz[ls[p]]-t[p].r+t[p].l-1,x,y),rs[p]=x,x=f[x]=p;\n    pu(p);\n}\nint mg(int x,int y){\n    if(!x)return y;if(!y)return x;\n    if(rnd[x]<rnd[y]){rs[x]=mg(rs[x],y);pu(x);return x;}\n    else{ls[y]=mg(x,ls[y]);pu(y);return y;}\n}\nvoid ins(int rk,int l,int r){\n    int rt=++cnt;\n    t[rt]={l,r};ls[rt]=rs[rt]=f[rt]=0;\n    sz[rt]=r-l+1;rnd[rt]=rand();\n    mp[l]=rt;\n    int x,y;\n    sl(RT,rk-1,x,y);\n    RT=mg(mg(x,rt),y);\n}\nvoid del(int l,int r){\n    int x,y,z;\n    sl(RT,r,x,z);\n    sl(x,l-1,x,y);\n    RT=mg(x,z);\n}\nint find(int rt){\n    int res=sz[rt]-sz[rs[rt]];\n    while(rt!=RT){\n        if(rs[f[rt]]==rt)res+=sz[f[rt]]-sz[rs[f[rt]]];\n        rt=f[rt];\n    }\n    return res;\n}\nint kth(int p,int k){\n    if(k<=sz[ls[p]])return kth(ls[p],k);\n    k-=sz[ls[p]];\n    if(k-t[p].r+t[p].l-1<=0)return t[p].l+k-1;\n    return kth(rs[p],k-t[p].r+t[p].l-1);\n}\nint n,m,u,x;\nint main(){\n    n=gi();m=gi();\n    mp[1]=1;\n    ins(1,1,n);\n    for(int i=1;i<=m;++i){\n        int u=gi(),x=gi()-la,y;\n        if(u==1){\n            y=gi()-la;\n            int l=(--mp.lower_bound(x+1))->first;\n            int p=mp[l],r=t[p].r;\n            int rk=la=find(p)-r+x;\n            printf(\"%d\\n\",rk);\n            del(rk-x+l,rk+r-x);\n            if(x>l)ins(rk-x+l,l,x-1);\n            ins(rk,y,y);\n            if(r>x)ins(rk+1,x+1,r);\n        }\n        if(u==2){\n            int l=(--mp.lower_bound(x+1))->first;\n            int p=mp[l],r=t[p].r;\n            int rk=la=find(p)-r+x;\n            printf(\"%d\\n\",rk);\n            del(rk-x+l,rk+r-x);\n            if(x>l)ins(rk-x+l,l,x-1);\n            if(r>x)ins(rk,x+1,r);\n            ins(1,x,x);\n        }\n        if(u==3){\n            int l=(--mp.lower_bound(x+1))->first;\n            int p=mp[l],r=t[p].r;\n            int rk=la=find(p)-r+x;\n            printf(\"%d\\n\",rk);\n            del(rk-x+l,rk+r-x);\n            if(x>l)ins(rk-x+l,l,x-1);\n            if(r>x)ins(rk,x+1,r);\n            ins(n,x,x);\n        }\n        if(u==4)printf(\"%d\\n\",la=kth(RT,x));\n    }\n}\n```", "link": "/posts/fhqtreap/", "tags": ["\u5e73\u8861\u6811", "\u6570\u636e\u7ed3\u6784", "\u7b97\u6cd5", "\u6811", "\u5e8f\u5217"], "categories": [["\u7b97\u6cd5", "\u6570\u636e\u7ed3\u6784"], ["note"]]}, {"title": "treap", "content": "https://www.luogu.org/problemnew/show/P3369\n\n\u6700\u77ed\uff08\u6700\u7b80\u6d01\uff09\u4ee3\u7801\uff1a\n\n```\n\u89e3\u91ca\uff1a\nturn(x,p):\n\t\u5c06x\u7684\u5de6(p=0)/\u53f3(p=1)\u513f\u5b50\u65cb\u8f6c\u5230x\u7684\u5934\u9876(\u53d8\u6210x\u7684\u7236\u4eb2)\n```\n\n![](https://i.loli.net/2018/12/05/5c07efc526458.png)\n![](https://i.loli.net/2018/12/05/5c07efc536041.png)\n![](https://i.loli.net/2018/12/05/5c07efc54a39b.png)\n\n\u8fd9\u6837\u4e00\u770b\u65cb\u8f6c\u7684\u64cd\u4f5c\u5e94\u8be5\u5f88\u597d\u7406\u89e3\u5427\uff1f\n\n\u56e0\u4e3a\u7f51\u4e0a\u5176\u4ed6\u5730\u65b9\u7684\u8bb2\u89e3\u90fd\u5f88\u8be6\u7ec6,\u6211\u5728\u8fd9\u91cc\u5c31\u53ea\u7ed9\u597d\u6253\u597d\u7406\u89e3\u7684\u4ee3\u7801\u4e86\u3002\n\n\n\n```c++\n#include<cstdio>\n#define il inline\n#define inf 10000010\nil char gc(){static char buf[1000000],*s,*t;return s==t?(((t=(s=buf)+fread(buf,1,1000000,stdin))==s)?-1:*s++) : *s++;}\nil int gi(){int x=0;bool f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nil int MAX(int x,int y){return x>y?x:y;}\nil int MIN(int x,int y){return x<y?x:y;}\nusing namespace std;\n#define N 100001\nint sz[N],c[N][2],ra[N],w[N],cnt=0,rt=0;\n#define pu(x) sz[x]=sz[c[x][0]]+sz[c[x][1]]+1\nil int rand(){\n    static int seed=233;\n    return seed=(int)seed*482711LL%2147483647; \n}\nil void turn(int &x,int p){\n    int t=c[x][p];\n    c[x][p]=c[t][!p];\n    c[t][!p]=x;\n    pu(x);pu(x=t);\n}\nil void ins(int &x,int v){\n    if(!x){\n        sz[x=++cnt]=1;w[x]=v;ra[x]=rand();\n        return;\n    }\n    sz[x]++;\n    int p=(v>w[x]);\n    ins(c[x][p],v);\n    if(ra[c[x][p]]<ra[x])turn(x,p);\n}\nil void del(int &x,int v){\n    if(w[x]==v){\n        if((!c[x][0])||(!c[x][1])){x=c[x][0]+c[x][1];return;}\n        int p=(ra[c[x][0]]>ra[c[x][1]]);\n        turn(x,p);del(c[x][!p],v);\n    }\n    else del(c[x][v>=w[x]],v);\n    pu(x);\n}\nil int frk(int x,int v){\n    if(!x)return 1;\n    return (w[x]>=v)?frk(c[x][0],v):(frk(c[x][1],v)+sz[c[x][0]]+1);\n}\nil int ask(int x,int k){\n    if(sz[c[x][0]]==k-1)return w[x];\n    return (sz[c[x][0]]>=k)?ask(c[x][0],k):ask(c[x][1],k-sz[c[x][0]]-1);\n}\nil int pre(int x,int v){\n    if(!x)return -inf;\n    return (w[x]<v)?MAX(w[x],pre(c[x][1],v)):pre(c[x][0],v);\n}\nil int nxt(int x,int v){\n    if(!x)return inf;\n    return (w[x]>v)?MIN(w[x],nxt(c[x][0],v)):nxt(c[x][1],v);\n}\nint main(){\n    int t=gi(),x,y;\n    while(t--){\n        x=gi();y=gi();\n        if(x==1)ins(rt,y);\n        if(x==2)del(rt,y);\n        if(x==3)printf(\"%d\\n\",frk(rt,y));\n        if(x==4)printf(\"%d\\n\",ask(rt,y));\n        if(x==5)printf(\"%d\\n\",pre(rt,y));\n        if(x==6)printf(\"%d\\n\",nxt(rt,y));\n    }\n}\n```\n\n", "link": "/posts/treap/", "tags": ["\u5e73\u8861\u6811", "\u6570\u636e\u7ed3\u6784", "\u7b97\u6cd5"], "categories": [["\u7b97\u6cd5", "\u6570\u636e\u7ed3\u6784"], ["note"]]}, {"title": "noip\u9000\u5f79\u8bb0", "content": "## \u8fd9\u5e94\u8be5\u662f\u6700\u540e\u4e00\u6b21noip\u666e\u53ca\u7ec4\u5427\u3002\u73b0\u5728\u521d\u4e09\u4e86,\u4f30\u8ba1\u73b0\u5728\u5c31***AFO***\u4e86\n\n\n\n## \u524d\u5915\uff1a\n\nwhile(1)\u5237\u9898,\u9893\u5e9f,rp+=rand(),rp-=rand();\n\nQwQ\n\n\n\n## Day0\uff1a\n\n\u200b\t\u65e9\u4e0a\u5750\u4e86\u534a\u5929\u9ad8\u94c1,\u8d76\u4e86\u534a\u5929\u8def,\u90fd\u61d2\u5f97\u6253\u6a21\u677f\u4e86,\u6700\u540e\u9893\u4e86\u4e00\u5929slay,\u53ea\u6253\u4e863\u4e2a\u6a21\u677f\u3002\n\n\u200b\t\u665a\u4e0a\u5403\u5b8c\u996d,\u5148\u53bb\u770b\u4e86\u770b\u521d\u4e8c\u7237\u4eec,\u56de\u53bb\u65f6\u53d1\u73b0\u95e8\u6253\u4e0d\u5f00,\u7136\u540e\u53c8\u542c\u89c1\u9f99\u5b9e\u7237\u7684\u58f0\u97f3,\u4ee5\u4e3a\u8d70\u9519\u623f\u95f4,\u5c31\u6572\u4e86\u6572\u95e8,\u7136\u540e\u6309\u4e86\u597d\u4e45\u95e8\u94c3\u624d\u5f00\u95e8,\u91cc\u9762\u4e5f\u6ca1\u6709\u5f00\u706f\u3002\u6211\u89c9\u5f97\u6709\u70b9\u4e0d\u5bf9\u52b2,\u4f46\u8fd8\u662f\u8d70\u4e86\u8fdb\u53bb\u3002\n\n\u7136\u540e\u53d1\u73b0\u91d1\u5b9e\u7684\u521d\u4e09\u90fd\u85cf\u5728\u8fd9,\u7ed3\u679c\u88ab\u4ed6\u4eec\u5413\u5f97\u4e0d\u8f7b\u3002\n\n\u200b\t\u539f\u6765\u6211\u53bb\u5403\u996d\u65f6\u5fd8\u8bb0\u9501\u95e8\u4e86\u30022333.\n\n\u200b\t\u4e4b\u540e\u53c8\u8dd1\u53bb\u548c\u5404\u4f4d\u673a\u623f\u795e\u7287\u73a9,\u4e0d\u77e5\u4e0d\u89c9\u9893\u523011\u70b9,\u8d76\u5feb\u6d17\u5b8c\u6fa1\u7761\u89c9\u3002\n\n\u200b\t~~\u539f\u672c\u60f3\u6253\u6a21\u677f\u7684~~\n\n\n\n## Day1\uff1a\n\n### \u65e9\u4e0a\uff1a\n\n\u200b\t\u5728\u88ab\u7a9d\u91cc\u4f11\u606f\uff08~~\u9893\u5e9f~~\uff09\u4e86\u4e00\u65e9\u4e0a,\u8fde\u7ebf\u6bb5\u6811\u90fd\u6253\u6302\u4e86,QwQ\n\n\n\n### \u4e0b\u5348\uff1a\n\n\u200b\t\u6bd4\u8d5b\u3002\u611f\u89c9\u80be\u4e0a\u817a\u7d20\u98d9\u5347\u3002\u53bb\u6bd4\u8d5b\u4e00\u8def\u4e0a\u90fd\u5728\u558anoip,rp++\n\n\u539f\u672c\u60f3\u7740~~AK~~,\u7136\u540e\u770bll\u5973\u88c5\u5403\u952e\u76d8\u7684,\u4f46\u6ca1\u60f3\u5230\u4eca\u5e74\u5c45\u7136\u8003\u8fd9\u4e48\u96be\u3002\n\n\u611f\u89c9~~\u6bd4tg Day1\u8fd8\u6bd2\u7624~~,QwQ\n\n#### t1\uff1a\n\n\u200b\t\u6c34\u9898\n\n\n\n#### t2\uff1a\n\n\u200b\tO(n)\u66b4\u529b\n\n\n\n#### t3\uff1a\n\n\u200b\t\u660e\u660e\u63a8\u51fa\u6b63\u89e3\u7684dp,\u53ef\u662f\u8c03\u4e862h,\u8fd8\u662f\u6ca1\u6cd5\u8fc7\u5927\u6837\u4f8b,\u5fc3\u6001\u5d29\u4e86\u3002~~~~\u6211\u8981\u59b9\u5b50~~\n\n\n\n#### t4\uff1a \n\n\u200b\t\u6709\u4e9b\u6ca1\u65f6\u95f4\u4e86,\u5199\u4e86\u4e2a\u66b4\u529b,\u597d\u50cf\u6bd4\u8f83\u51fd\u6570\u8fd8\u5199\u6302\u4e86,\u5f88\u614c\u3002\n\n\n\n\u200b\t\u7ed3\u679c\u8d8a\u60f3\u8d8a\u5fc3\u865a,\u867d\u7136\u673a\u623f\u7684\u51e0\u4f4d\u5927\u4f6c\u90fd\u5728\u5b89\u6170\u8bf4\u4f60\u80af\u5b9a\u4e00\u7b49\u7684,\u53ef\u8fd8\u662f\u5fc3\u865a\u5230\u60f3\u6b7b\u3002\u611f\u89c9\u4eba\u751f\u5931\u53bb\u5e0c\u671b\u3002\n\n\u200b\t\u5927\u6982\u9000\u5f79\u7684\u611f\u89c9\u5c31\u662f\u8fd9\u6837\u5427\u30022\u5e74oi\u4e00\u573a\u7a7a\u3002\n\n\u200b\t\u5fcd\u7740\u5403\u5b8c\u4e86\u4e00\u987f\u996d,\u542c\u5176\u4ed6\u4eba\u4e5f\u6709\u4e9b\u6302\u611f\u89c9\u597d\u50cf\u597d\u4e86\u4e9b\n\n\n\n### \u665a\u4e0a\uff1a\n\n\u200b\t\u770b\u4e0a\u53bb\u5927\u5bb6\u5fc3\u6001\u90fd\u5d29\u4e86,\u6253\u7b97cf\u5f00\u9ed1\u5b89\u6170\u5fc3\u60c5\u3002\n\n\u200b\t\u4e00\u5f00\u59cb\u6709\u4e9b\u81ea\u95ed,\u4e00\u4e2a\u4eba\u5728\u81ea\u5df1\u623f\u95f4\u91cc\u9893slay\u548ccultris\n\n\u76f4\u5230\u673a\u623f\u7684\u795e\u7287\u4eec\u6765\u6572\u95e8\u3002\n\n\u200b\t\u53bb\u5230\u795e\u7287\u805a\u96c6\u7684\u623f\u95f4\u91cc,\u624d\u77e5\u9053\u9519\u8fc7\u4e86\u4e00\u573a\u597d\u620f\u3002\u770b\u4e86HY\u5de8\u5de8\u5f55\u7684\u89c6\u9891\u624d\u77e5\u9053\u3002\u7ed3\u679c\u521a\u8fdb\u53bb\u5c31\u88ab\u5f53\u505a\u201c\u65b0\u6210\u5458\u201d\u5bf9\u5f85,\u731d\u4e0d\u53ca\u9632\u7684\u88ab\u538b\u5728\u5e8a\u4e0a\u6469\u64e6,\u88ab\u795e\u7287\u4eec\u78be\u538b\u3002\u5176\u5b9e\u8bf4\u5b9e\u8bdd\u4e5f\u633a\u597d\u73a9\u7684\u3002\n\n\u200b\tcf\u6253\u5230\u4e00\u534a,\u5927\u5bb6\u90fd\u60f3\u9893\u5e9f,\u7ed3\u679c\u4e0d\u77e5\u8c01\u6253\u5f00\u4e86slay,\u53d1\u51fa\u7ecf\u5178\u7684\u58f0\u97f3,\u7136\u540e\u5927\u5bb6\u5c31\u90fd\u53bb\u9893\u5e9f\u4e86\u3002\n\n\u200b\t\n\n\u200b\t\u9893slay\u9893\u5230\u6709\u70b9\u65e0\u804a,\u7a81\u7136\u60f3\u5230[unclenoway.com](http://unclenoway.com/),\u7136\u540e\u626e\u6210\u59b9\u5b50\u53bb\u201c\u64a9\u201d\u5230\u4e00\u4e2a\u7537\u751f,\u7136\u540e\u628aslay\u63a8\u8350\u7ed9\u4ed6,\u63a5\u7740\u804a\u5f97\u633a\u597d\u3002\u60f3\u5230\u5bf9\u65b9\u771f\u4ee5\u4e3a\u6211\u662f\u4e2a\u59b9\u5b50,\u4e0d\u7981\u5077\u7b11\u8d77\u6765\u3002\n\n\u200b\t2333.\n\n\n\n\u200b\t\u5927\u6982\u9893\u52302\u70b9\u5427,\u5927\u5bb6\u90fd\u56f0\u4e86,\u5c31\u6563\u4e86\u3002\u6211\u7b49\u5230\u7b2c\u4e8c\u5929\u65e9\u4e0a\u624d\u6d17\u4e86\u4e0b\u6fa1\u3002QAQ\u3002\n\n\n\n## Day2\uff1a\n\n\u200b\t\u56de\u5bb6\u3002\u4e00\u8def\u4e0a,\u53ef\u80fd\u56e0\u4e3a\u89c9\u5f97\u6ca1\u8003\u597d\u7684\u539f\u56e0\u5427,\u5230\u665a\u4e0a\u8fd8\u662f\u95f7\u95f7\u4e0d\u4e50\u3002\u4f46\u8fd8\u662f\u8865\u4e86\u4e0b\u4f5c\u4e1a\u3002\u4e5f\u6ca1\u4ec0\u4e48\u5fc3\u60c5\u5237\u9898\u4e86\u3002\n\n\u200b\t\u53ef\u80fd\u5c31\u8fd9\u6837AFO\u4e86\u3002QwQ\n\n\n\n## \u5f69\u86cb\uff1a\n\n### 1.\u94b1\u5305\uff1a\n\n\u200b\t\u4e0d\u77e5\u9053\u4e3a\u4ec0\u4e48,\u6211\u8fde\u7eed\u5728\u9152\u5e97\u5bf9\u9762\u7684\u9ea6\u5f53\u52b3\u4e22\u4e86\u4e24\u6b21\u94b1\u5305,\u8fd8\u5728\u540c\u4e00\u5f20\u684c\u5b50\u3002\n\n\n\n### 2. \u75af\u73a9\n\n\u200b\t\u75af\u73a9\u8fc7\u540e\u7684\u623f\u95f4\u201c\u4e00\u7247\u72fc\u85c9\u201d,\u6795\u5934\u548c\u88ab\u5b50\u5230\u5904\u90fd\u662f\u3002\u6211\u751a\u81f3\u5728\u5e8a\u4e0b\u53d1\u73b0\u4e86\u4e00\u679a\u5730\u94c1\u7684\u786c\u5e01\n\n[![TIM\u56fe\u724720181111234323.jpg](https://i.loli.net/2018/11/11/5be84e368ee58.jpg)](https://i.loli.net/2018/11/11/5be84e368ee58.jpg)\n\n\n\n### 3.\u5173\u5395\u6240\uff1a\n\n\u628a\u4e00\u4e2a\u795e\u7287\u5173\u5728\u5395\u6240\u91cc\n\n\n\n\n\n\n## \u8d5b\u540e\uff1a\n\n\n\u521a\u5f00\u59cb\u51e0\u5929,\u611f\u89c9\u5931\u53bb\u5e0c\u671b,", "link": "/posts/noip\u9000\u5f79\u8bb0/", "tags": [], "categories": [["\u6e38\u8bb0"]]}, {"title": "\u5dee\u5206\u62d8\u675f", "content": "## \u5dee\u5206\u7ea6\u675f\u7684\u5177\u4f53\u6982\u5ff5\uff1a\n\u5982\u679c\u4e00\u4e2a\u7cfb\u7edf\u7531n\u4e2a\u53d8\u91cf\u548cm\u4e2a\u7ea6\u675f\u6761\u4ef6\u7ec4\u6210,\u5f62\u6210m\u4e2a\u5f62\u5982ai-aj\u2264k\u7684\u4e0d\u7b49\u5f0f(i,j\u2208[1,n],k\u4e3a\u5e38\u6570),\u5219\u79f0\u5176\u4e3a\u5dee\u5206\u7ea6\u675f\u7cfb\u7edf\u3002\n\n## \u4f8b\u5b50\uff1a\n\u5047\u8bbe\u67093\u4e2a\u6570a,b,c\n\u6211\u4eec\u77e5\u9053\uff1a\n\n    a-b>=2\n    b-c>=3\n    a-c>=3\n\n\u90a3\u4e48\uff1aa\u4e0ec\u7684\u5dee\u503c\u6700\u5c0f\u4e3a\u591a\u5c11\uff1f\n\na\u6bd4b\u81f3\u5c11\u59272,b\u6bd4c\u81f3\u5c11\u59273,\u90a3a\u6bd4c\u5c31\u81f3\u5c11\u59275\u3002\n\n\u8fd9\u5f88\u5bb9\u6613\u7406\u89e3\u3002\n\n\u4f46\u662f\u5982\u679c\u4e0d\u7b49\u5f0f\u5f88\u591a\u5462\uff1f\n\n100\u4e2a\u6570\uff1f1000\u4e2a\u6570\uff1f10000\u4e2a\u6570\u2026\u2026\n\n\n### \u6211\u4eec\u4ece\u4e00\u5f00\u59cb\u7684\u4f8b\u5b50\u5f00\u59cb\u8003\u8651\u3002\n\n\u6211\u4eec\u628a\u8fd9\u60f3\u8c61\u6210\u4e00\u4e2a\u56fe\u3002\u6bcf\u4e2a\u4e0d\u7b49\u5f0f\u5c31\u662f\u4e00\u6761\u6709\u5411\u8fb9\u3002\n\u90a3\u4e48\uff1a\n\n![](https://i.loli.net/2018/10/28/5bd48db60ca1b.png)\n\n\u662f\u4e0d\u662f\u53d1\u73b0\u8dd1\u4e00\u4e0b\u6700\u957f\u8def\u5c31\u53ef\u4ee5\u4e86\uff1f\n\n\u6ca1\u9519,\u5dee\u5206\u62d8\u675f\u5c31\u662f\u7528\u4e86\u8fd9\u4e2a\u539f\u7406\u3002\n\n\u4e00\u822c\u5dee\u5206\u62d8\u675f\u95ee\u9898\u90fd\u53ef\u4ee5\u8f6c\u5316\u4e3a\u6700\u77ed(\u957f)\u8def\u95ee\u9898\u3002\n\n## \u95ee\u9898\u89e3\u7684\u5b58\u5728\u6027\uff1a\n\n### 1.\u65e0\u89e3\uff1a\n\n\u6bd4\u5982a-b>=2,b-a>=1,\u8fd9\u6837\u5c31\u81ea\u76f8\u77db\u76fe\u4e86\u3002\n\n\u5982\u679c\u8fde\u6210\u56fe,\u5c31\u4f1a\u53d1\u73b0\u8fd9\u662f\u4e00\u4e2a\u8d1f\u73af\u3002\n\n### 2.\u65e0\u6cd5\u786e\u5b9a\uff1a\n\n\u6bd4\u5982\u53ea\u7ed9a-b>=2,\u5c31\u65e0\u6cd5\u5224\u65ada\u4e0ec\u7684\u5173\u7cfb\u3002\n\n\u8fde\u6210\u56fe\u540e\u8868\u73b0\u4e3a\uff1aa\u4e0ec\u4e0d\u8fde\u901a\u3002\n\n\n\n## \u4e0d\u7b49\u5f0f\u7ec4\u7684\u8f6c\u5316\uff1a\n\n\u5bf9\u4e8e\u9898\u76ee\u4e2d\u7684\u4e0d\u7b49\u5f0f,\u4e00\u822c\u53ea\u6709\u8f6c\u6210\u76f8\u540c\u7b26\u53f7\u624d\u65b9\u4fbf\u5904\u7406\u3002\n\n1. a-b>=t  **\u2192**  b-a<=-t\n2. a-b<t    **\u2192**  b-a<=t-1\n3. a-b=t    **\u2192**  a-b<=t && a-b>=t\n\n\u6839\u636e\u60c5\u51b5,\u6309\u4e0a\u9762\u6240\u8bf4\u8f6c\u5316\u3002\n\n\n\n## \u4f8b\u9898\uff1a\n\n1.[LUOGU **P1250** \u79cd\u6811](https://www.luogu.org/problemnew/show/P1250)\n\n### \u9898\u76ee\u63cf\u8ff0\n\n\u4e00\u6761\u8857\u7684\u4e00\u8fb9\u6709\u51e0\u5ea7\u623f\u5b50\u3002\u56e0\u4e3a\u73af\u4fdd\u539f\u56e0\u5c45\u6c11\u60f3\u8981\u5728\u8def\u8fb9\u79cd\u4e9b\u6811\u3002\u8def\u8fb9\u7684\u5730\u533a\u88ab\u5206\u5272\u6210\u5757,\u5e76\u88ab\u7f16\u53f7\u62101..N\u3002\u6bcf\u4e2a\u90e8\u5206\u4e3a\u4e00\u4e2a\u5355\u4f4d\u5c3a\u5bf8\u5927\u5c0f\u5e76\u6700\u591a\u53ef\u79cd\u4e00\u68f5\u6811\u3002\u6bcf\u4e2a\u5c45\u6c11\u60f3\u5728\u95e8\u524d\u79cd\u4e9b\u6811\u5e76\u6307\u5b9a\u4e86\u4e09\u4e2a\u53f7\u7801B,E,T\u3002\u8fd9\u4e09\u4e2a\u6570\u8868\u793a\u8be5\u5c45\u6c11\u60f3\u5728B\u548cE\u4e4b\u95f4\u6700\u5c11\u79cdT\u68f5\u6811\u3002\u5f53\u7136,B\u2264E,\u5c45\u6c11\u5fc5\u987b\u8bb0\u4f4f\u5728\u6307\u5b9a\u533a\u4e0d\u80fd\u79cd\u591a\u4e8e\u533a\u57df\u5730\u5757\u6570\u7684\u6811,\u6240\u4ee5T\u2264E-B+l\u3002\u5c45\u6c11\u4eec\u60f3\u79cd\u6811\u7684\u5404\u81ea\u533a\u57df\u53ef\u4ee5\u4ea4\u53c9\u3002\u4f60\u7684\u4efb\u52a1\u662f\u6c42\u51fa\u80fd\u6ee1\u8db3\u6240\u6709\u8981\u6c42\u7684\u6700\u5c11\u7684\u6811\u7684\u6570\u91cf\u3002\n\n\u5199\u4e00\u4e2a\u7a0b\u5e8f\u5b8c\u6210\u4ee5\u4e0b\u5de5\u4f5c\uff1a\n\n### \u8f93\u5165\u8f93\u51fa\u683c\u5f0f\n\n\u8f93\u5165\u683c\u5f0f\uff1a\n\n\u7b2c\u4e00\u884c\u5305\u542b\u6570\u636eN,\u533a\u57df\u7684\u4e2a\u6570(0<N\u226430000)\uff1b\n\n\u7b2c\u4e8c\u884c\u5305\u542bH,\u623f\u5b50\u7684\u6570\u76ee(0<H\u22645000)\uff1b\n\n\u4e0b\u9762\u7684H\u884c\u63cf\u8ff0\u5c45\u6c11\u4eec\u7684\u9700\u8981\uff1aB E T,0<B\u2264E\u226430000,T\u2264E-B+1\u3002\n\n\n\n\u8f93\u51fa\u683c\u5f0f\uff1a\n\n\u8f93\u51fa\u6587\u4ef6\u53ea\u6709\u4e00\u884c\u5199\u6709\u6811\u7684\u6570\u76ee\n\n### \u8f93\u5165\u8f93\u51fa\u6837\u4f8b\n\n\u8f93\u5165\u6837\u4f8b#1\uff1a\n\n```\n9\n4\n1 4 2\n4 6 2\n8 9 2\n3 5 2\n```\n\n\u8f93\u51fa\u6837\u4f8b#1\uff1a\n\n```\n5\n```\n\n### \u9898\u89e3\uff1a\n\n```c++\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\nnamespace ZDY{\n    #define res register\n    #define ri res int\n    #define ll long long\n    #define db double\n    #define sht short\n    #define il inline\n    #define MB template <class T>\n    #define Fur(i,x,y) for(ri i=x;i<=y;i++)\n    #define fur(i,x,y) for(i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(ri i=x;i>=y;i--)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fl(i,x) for(ri i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define inf 2147483630\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdin)\n    #define l2(n) (ceil(log2(n)))\n    #define fast ios::sync_with_stdio(false)\n    MB il T ABS(T x){return x>0?x:-x;}\n    MB il T MAX(T x,T y){return x>y?x:y;}\n    MB il T MIN(T x,T y){return x<y?x:y;}\n    MB il T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB il void SWAP(T x,T y){T t=x;y=t;x=y;}\n}using namespace ZDY;using namespace std;\n#define N 30010\n\nstruct edge{int to,nxt,w;}e[N*2+5010];\nint head[N],cnt=0,n,m,d[N];\nbool v[N];\nstruct cmp{bool operator()(int a,int b){return d[a]<d[b];}};\npriority_queue<int,vector<int>,cmp>q;\nil void add(int x,int y,int w){e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;}\nil void spfa(){\n    int x;\n    q.push(0);\n    while(!q.empty()){\n        x=q.top();q.pop();v[x]=0;\n        fl(i,x)\n        if(d[x]+e[i].w>d[to]){\n            d[to]=d[x]+e[i].w;\n            if(!v[to])q.push(to),v[to]=1;\n        }\n    }\n}\nint main(){\n    fast;\n    cin>>n>>m;\n    int x,y,w;\n    Fur(i,1,m)cin>>x>>y>>w,add(x-1,y,w);\n    Fur(i,0,n){\n        if(i!=0)add(i-1,i,0),d[i]=-inf;\n        if(i!=n)add(i,i-1,-1);\n    }\n    spfa();\n    cout<<d[n];\n}\n```\n\n\n\n2.[LUOGU **P1645** \u5e8f\u5217](https://www.luogu.org/problemnew/show/P1250)\n\n### \u9898\u76ee\u63cf\u8ff0\n\n\u6709\u4e00\u4e2a\u6574\u6570\u5e8f\u5217,\u5b83\u7684\u6bcf\u4e2a\u6570\u5404\u4e0d\u76f8\u540c,\u6211\u4eec\u4e0d\u77e5\u9053\u5b83\u7684\u957f\u5ea6\u662f\u591a\u5c11\uff08\u5373\u6574\u6570\u4e2a\u6570\uff09,\u4f46\u6211\u4eec\u77e5\u9053\u5728\u67d0\u4e9b\u533a\u95f4\u4e2d\u95f4\u81f3\u5c11\u6709\u591a\u5c11\u4e2a\u6574\u6570,\u7528\u533a\u95f4\uff08Li,Ri,Ci\uff09\u6765\u63cf\u8ff0,\u8868\u793a\u8fd9\u4e2a\u6574\u6570\u5e8f\u5217\u4e2d\u81f3\u5c11\u6709Ci\u4e2a\u6570\u6765\u81ea\u533a\u95f4[Li,Ri],\u7ed9\u51fa\u82e5\u5e72\u4e2a\u8fd9\u6837\u7684\u533a\u95f4,\u95ee\u8fd9\u4e2a\u6574\u6570\u5e8f\u5217\u7684\u957f\u5ea6\u6700\u5c11\u80fd\u4e3a\u591a\u5c11\uff1f\n\n### \u8f93\u5165\u8f93\u51fa\u683c\u5f0f\n\n\u8f93\u5165\u683c\u5f0f\uff1a\n\n\u7b2c\u4e00\u884c\u4e00\u4e2a\u6574\u6570N,\u8868\u793a\u533a\u95f4\u4e2a\u6570\uff1b\n\n\u63a5\u4e0b\u6765N\u884c,\u6bcf\u884c\u4e09\u4e2a\u6574\u6570\uff08Li,Ri,Ci\uff09,\u63cf\u8ff0\u4e00\u4e2a\u533a\u95f4\u3002\n\n\u3010\u6570\u636e\u89c4\u6a21\u3011\n\nN<=1000,0<=Li<=Ri<=1000,1<=Ci<=Ri-Li+1\n\n\n\n\u8f93\u51fa\u683c\u5f0f\uff1a\n\n\u4ec5\u4e00\u4e2a\u6570,\u8868\u793a\u8be5\u6574\u6570\u5e8f\u5217\u7684\u6700\u5c0f\u957f\u5ea6\u3002\n\n### \u8f93\u5165\u8f93\u51fa\u6837\u4f8b\n\n\u8f93\u5165\u6837\u4f8b#1\uff1a\n\n```\n4\n4 5 1\n6 10 3\n7 10 3\n5 6 1\n```\n\n\u8f93\u51fa\u6837\u4f8b#1\uff1a\n\n```\n4\n```\n\n\n\n### \u9898\u89e3\uff1a\n\n```c++\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\nnamespace ZDY{\n    #define res register\n    #define ri res int\n    #define ll long long\n    #define db double\n    #define sht short\n    #define il inline\n    #define MB template <class T>\n    #define Fur(i,x,y) for(ri i=x;i<=y;i++)\n    #define fur(i,x,y) for(i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(ri i=x;i>=y;i--)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fl(i,x) for(ri i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define inf 2147483630\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdin)\n    #define l2(n) (ceil(log2(n)))\n    #define fast ios::sync_with_stdio(false)\n    MB il T ABS(T x){return x>0?x:-x;}\n    MB il T MAX(T x,T y){return x>y?x:y;}\n    MB il T MIN(T x,T y){return x<y?x:y;}\n    MB il T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB il void SWAP(T x,T y){T t=x;y=t;x=y;}\n}using namespace ZDY;using namespace std;\n#define N 1011\n\nstruct edge{int to,nxt,w;}e[N*3];\nint head[N],cnt=0,n=0,m,d[N];\nbool v[N];\nstruct cmp{bool operator()(int a,int b){return d[a]<d[b];}};\npriority_queue<int,vector<int>,cmp>q;\nil void add(int x,int y,int w){e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;}\nil void spfa(){\n    int x;\n    q.push(0);\n    while(!q.empty()){\n        x=q.top();q.pop();v[x]=0;\n        fl(i,x)\n        if(d[x]+e[i].w>d[to]){\n            d[to]=d[x]+e[i].w;\n            if(!v[to])q.push(to),v[to]=1;\n        }\n    }\n}\nint main(){\n    fast;\n    cin>>m;\n    int x,y,w;\n    Fur(i,1,m)cin>>x>>y>>w,add(x-1,y,w),n=MAX(n,y);\n    Fur(i,0,n){\n        if(i!=0)add(i-1,i,0),d[i]=-inf;\n        if(i!=n)add(i,i-1,-1);\n    }\n    spfa();\n    cout<<d[n];\n}\n```\n\n\n\n\n\n3.[[SCOI2011\\]\u7cd6\u679c](https://www.luogu.org/problemnew/show/P3275)\n\n### \u9898\u76ee\u63cf\u8ff0\n\n\u5e7c\u513f\u56ed\u91cc\u6709N\u4e2a\u5c0f\u670b\u53cb,lxhgww\u8001\u5e08\u73b0\u5728\u60f3\u8981\u7ed9\u8fd9\u4e9b\u5c0f\u670b\u53cb\u4eec\u5206\u914d\u7cd6\u679c,\u8981\u6c42\u6bcf\u4e2a\u5c0f\u670b\u53cb\u90fd\u8981\u5206\u5230\u7cd6\u679c\u3002\u4f46\u662f\u5c0f\u670b\u53cb\u4eec\u4e5f\u6709\u5ac9\u5992\u5fc3,\u603b\u662f\u4f1a\u63d0\u51fa\u4e00\u4e9b\u8981\u6c42,\u6bd4\u5982\u5c0f\u660e\u4e0d\u5e0c\u671b\u5c0f\u7ea2\u5206\u5230\u7684\u7cd6\u679c\u6bd4\u4ed6\u7684\u591a,\u4e8e\u662f\u5728\u5206\u914d\u7cd6\u679c\u7684\u65f6\u5019,lxhgww\u9700\u8981\u6ee1\u8db3\u5c0f\u670b\u53cb\u4eec\u7684K\u4e2a\u8981\u6c42\u3002\u5e7c\u513f\u56ed\u7684\u7cd6\u679c\u603b\u662f\u6709\u9650\u7684,lxhgww\u60f3\u77e5\u9053\u4ed6\u81f3\u5c11\u9700\u8981\u51c6\u5907\u591a\u5c11\u4e2a\u7cd6\u679c,\u624d\u80fd\u4f7f\u5f97\u6bcf\u4e2a\u5c0f\u670b\u53cb\u90fd\u80fd\u591f\u5206\u5230\u7cd6\u679c,\u5e76\u4e14\u6ee1\u8db3\u5c0f\u670b\u53cb\u4eec\u6240\u6709\u7684\u8981\u6c42\u3002\n\n### \u8f93\u5165\u8f93\u51fa\u683c\u5f0f\n\n\u8f93\u5165\u683c\u5f0f\uff1a\n\n\u8f93\u5165\u7684\u7b2c\u4e00\u884c\u662f\u4e24\u4e2a\u6574\u6570N,K\u3002\u63a5\u4e0b\u6765K\u884c,\u8868\u793a\u8fd9\u4e9b\u70b9\u9700\u8981\u6ee1\u8db3\u7684\u5173\u7cfb,\u6bcf\u884c3\u4e2a\u6570\u5b57,X,A,B\u3002\u5982\u679cX=1,  \u8868\u793a\u7b2cA\u4e2a\u5c0f\u670b\u53cb\u5206\u5230\u7684\u7cd6\u679c\u5fc5\u987b\u548c\u7b2cB\u4e2a\u5c0f\u670b\u53cb\u5206\u5230\u7684\u7cd6\u679c\u4e00\u6837\u591a\uff1b\u5982\u679cX=2,  \u8868\u793a\u7b2cA\u4e2a\u5c0f\u670b\u53cb\u5206\u5230\u7684\u7cd6\u679c\u5fc5\u987b\u5c11\u4e8e\u7b2cB\u4e2a\u5c0f\u670b\u53cb\u5206\u5230\u7684\u7cd6\u679c\uff1b\u5982\u679cX=3, \u8868\u793a\u7b2cA\u4e2a\u5c0f\u670b\u53cb\u5206\u5230\u7684\u7cd6\u679c\u5fc5\u987b\u4e0d\u5c11\u4e8e\u7b2cB\u4e2a\u5c0f\u670b\u53cb\u5206\u5230\u7684\u7cd6\u679c\uff1b\u5982\u679cX=4,  \u8868\u793a\u7b2cA\u4e2a\u5c0f\u670b\u53cb\u5206\u5230\u7684\u7cd6\u679c\u5fc5\u987b\u591a\u4e8e\u7b2cB\u4e2a\u5c0f\u670b\u53cb\u5206\u5230\u7684\u7cd6\u679c\uff1b\u5982\u679cX=5, \u8868\u793a\u7b2cA\u4e2a\u5c0f\u670b\u53cb\u5206\u5230\u7684\u7cd6\u679c\u5fc5\u987b\u4e0d\u591a\u4e8e\u7b2cB\u4e2a\u5c0f\u670b\u53cb\u5206\u5230\u7684\u7cd6\u679c\uff1b\n\n\n\n\u8f93\u51fa\u683c\u5f0f\uff1a\n\n\u8f93\u51fa\u4e00\u884c,\u8868\u793alxhgww\u8001\u5e08\u81f3\u5c11\u9700\u8981\u51c6\u5907\u7684\u7cd6\u679c\u6570,\u5982\u679c\u4e0d\u80fd\u6ee1\u8db3\u5c0f\u670b\u53cb\u4eec\u7684\u6240\u6709\u8981\u6c42,\u5c31\u8f93\u51fa-1\u3002\n\n### \u8f93\u5165\u8f93\u51fa\u6837\u4f8b\n\n\u8f93\u5165\u6837\u4f8b#1\uff1a\n\n```\n5 7\n1 1 2\n2 3 2\n4 4 1\n3 4 5\n5 4 5\n2 3 5\n4 5 1\n```\n\n\u8f93\u51fa\u6837\u4f8b#1\uff1a\n\n```\n11\n```\n\n### \u8bf4\u660e\n\n\u3010\u6570\u636e\u8303\u56f4\u3011\n\n\u5bf9\u4e8e30%\u7684\u6570\u636e,\u4fdd\u8bc1 N<=100\n\n\u5bf9\u4e8e100%\u7684\u6570\u636e,\u4fdd\u8bc1 N<=100000\n\n\u5bf9\u4e8e\u6240\u6709\u7684\u6570\u636e,\u4fdd\u8bc1 K<=100000,1<=X<=5,1<=A, B<=N\n\n\n\n### \u9898\u89e3\uff1a\n\n```c++\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\nnamespace ZDY{\n    #define res register\n    #define ri res int\n    #define ll long long\n    #define db double\n    #define sht short\n    #define il inline\n    #define MB template <class T>\n    #define Fur(i,x,y) for(ri i=x;i<=y;i++)\n    #define fur(i,x,y) for(i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(ri i=x;i>=y;i--)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fl(i,x) for(ri i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define inf 2147483630\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdin)\n    #define l2(n) (ceil(log2(n)))\n    #define fast ios::sync_with_stdio(false)\n    MB il T ABS(T x){return x>0?x:-x;}\n    MB il T MAX(T x,T y){return x>y?x:y;}\n    MB il T MIN(T x,T y){return x<y?x:y;}\n    MB il T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB il void SWAP(T x,T y){T t=x;y=t;x=y;}\n}using namespace ZDY;using namespace std;\n#define N 100010\n\nstruct edge{int to,nxt,w;}e[N*3];\nint head[N],cnt=0,n=0,m,d[N],t[N];\nbool v[N];\nstruct cmp{bool operator()(int a,int b){return d[a]<d[b];}};\npriority_queue<int,vector<int>,cmp>q;\nil void add(int x,int y,int w){e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;}\nil void spfa(){\n    int x;\n    q.push(0);\n    while(!q.empty()){\n        x=q.top();q.pop();v[x]=0;if(++t[x]>n){cout<<-1<<endl;exit(0);}\n        fl(i,x)\n        if(d[x]+e[i].w>d[to]){\n            d[to]=d[x]+e[i].w;\n            if(!v[to])q.push(to),v[to]=1;\n        }\n    }\n}\nint main(){\n    fast;\n    cin>>n>>m;\n    int p,x,y;\n    ll ans=0;\n    Fur(i,1,m){\n        cin>>p>>x>>y;\n        if(p==1)add(x,y,0),add(y,x,0);\n        if(p==2)add(x,y,1);\n        if(p==3)add(y,x,0);\n        if(p==4)add(y,x,1);\n        if(p==5)add(x,y,0);\n    }\n    Fur(i,1,n)add(0,i,1);\n    spfa();\n    Fur(i,1,n)ans+=d[i];\n    cout<<ans<<endl;\n}\n```\n\n", "link": "/posts/\u5dee\u5206\u62d8\u675f/", "tags": ["\u56fe\u8bba", "\u7b97\u6cd5", "\u6280\u5de7"], "categories": [["\u7b97\u6cd5", "\u56fe\u8bba"], ["\u7b97\u6cd5", "\u6570\u8bba"], ["note"]]}, {"title": "LG CF316D3 PE Lesson", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF316D3&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/CF316D3\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u8bbe\u6709$a$\u4e2a$1$,$b$\u4e2a$2$\n\n\u8bbe$f_i$\u4e3a\u5269\u4e0b$i$\u4e2a$1$\u7684\u65b9\u6848\u6570\n\n$f_i=f_{i-1}+(i-1)\\times f_{i-2}$\n\n\u63a5\u7740\u8003\u8651\u5269\u4e0b$2$\u7684\u60c5\u51b5\n\n\u6211\u4eec\u628a$2$\u6b21\u4ea4\u6362\u7684\u9650\u5236\u770b\u6210\u4e00\u6b21\u4e3b\u52a8\u4ea4\u6362\u548c\u4e00\u6b21\u88ab\u52a8\u4ea4\u6362\n\n\u90a3\u6211\u4eec\u5c31\u53ef\u4ee5\u8ba9$b$\u4e2a$2$\u90fd\u5148\u4f7f\u7528\u4e00\u6b21\u4e3b\u52a8\u4ea4\u6362\n\n\u90a3\u4e48\u7b2c\u4e00\u4e2a$2$\u53ef\u4ee5\u4ece$n$\u4e2a\u4e2d\u9009\u4e00\u4e2a\n\n\u7b2c\u4e8c\u4e2a$2$\u53ef\u4ee5\u4ece$n-1$\u4e2d\u9009\u4e00\u4e2a\n\n\u7b2c\u4e09\u4e2a$2$\u53ef\u4ee5\u4ece$n-2$\u4e2d\u9009\u4e00\u4e2a\n\n...\u4ee5\u6b64\u7c7b\u63a8\n\n\u8fd9\u6837$b$\u6b21\u4ea4\u6362\u540e\u4f1a\u5269\u4e0b\u6b63\u597d$a$\u4e2a$1$\n\n$ans=f_a\\times \\prod_{i=1}^b (n-i+1)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000011,P=1e9+7;\nint n,x,cnt,f[N];\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",&x),cnt+=x==1;\n    f[0]=f[1]=1;\n    for(int i=2;i<=cnt;++i)f[i]=(f[i-1]+1ll*(i-1)*f[i-2])%P;\n    int ans=f[cnt];\n    for(int i=n;i>cnt;--i)ans=1ll*ans*i%P;\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG CF316D3 PE Lesson/", "tags": ["\u6570\u8bba", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5588 \u5c0f\u732a\u4f69\u5947\u722c\u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5588&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5588\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=1000011;\nint n,cnt,head[N],w[N],tt[N],nos[N],enos[N];\nll a1[N],a2[N];\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nint c[N],siz[N];\nvoid dfs(int x,int f){\n    int ff=0,p=0,col=w[x],k=c[col];\n    siz[x]=1;\n    fl(i,x)if(to!=f){\n        int la=c[col];\n        dfs(to,x);\n        a1[x]+=1ll*siz[x]*siz[to];\n        siz[x]+=siz[to];\n        if(la!=c[col])++ff,p=to;\n    }\n    a1[x]+=1ll*siz[x]*(n-siz[x]);\n    if(k||c[col]!=tt[col]-1)++ff;\n    ++c[col];\n    if(ff==1){\n        if(!enos[col])nos[col]=x;\n        else{\n            int t=p?n-siz[p]:siz[x];\n            a2[col]=1ll*siz[nos[col]]*t;\n        }\n        ++enos[col];\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\",w+i),\n        ++tt[w[i]],nos[w[i]]=i;\n    int x,y;\n    for(int i=1;i<n;++i)\n        scanf(\"%d%d\",&x,&y),add(x,y),add(y,x);\n    dfs(1,0);\n    for(int i=1;i<=n;++i)\n        if(tt[i]==0)printf(\"%lld\\n\",1ll*n*(n-1)>>1);\n        else if(tt[i]==1)printf(\"%lld\\n\",a1[nos[i]]);\n        else if(enos[i]==2)printf(\"%lld\\n\",a2[i]);\n        else puts(\"0\");\n}\n```\n", "link": "/posts/LG 5588 \u5c0f\u732a\u4f69\u5947\u722c\u6811/", "tags": ["lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1295 [TJOI2011]\u4e66\u67b6", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1295&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P1295\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n$f_i=f_j+\\max(a_{j+1},a_{j+2},\\dots,a_i), s_i-s_j\\le m$\n\n\u5bf9\u4e8e\u8f6c\u79fb\u65b9\u7a0b\u53ef\u884c\u7684$j$\u4e14$a_{j+1}\\le \\max(a_{j+2},\\dots,a_i)$,$f_j+\\max(a_{j+1},\\dots,a_i)$\u4e0e$f_{j+1}+\\max(a_{j+2},\\dots,a_i)$\u540e\u534a\u6bb5\u76f8\u540c,$f_j\\le f_{j+1}$,\u6240\u4ee5\u524d\u8005\u66f4\u4f18\n\n\u63a8\u5e7f\u53ef\u5f97\u6700\u4f18\u8f6c\u79fb\u4e00\u5b9a\u5728$a_{q_1}>a_{q_2}>a_{q_3}>a_{q_4}>\\dots>a_{q_j}$\u4e2d\n\n$f_{a_{q_j}}+a_{q_{j+1}}$\u53d6\u5f97\uff08\u5bf9\u4e8e$a_{q_1}$,\u6709$f_{st}+a_{q_1}$,$st$\u662f\u6700\u5927\u7684\u4f7f$a_{st}+\\dots+a_i>m$\n\n\u7ef4\u62a4\u4e00\u4e2a\u53ef\u67e5\u8be2\u6700\u5927\u503c\u7684\u5355\u8c03\u961f\u5217\n\n\u7ef4\u62a4\u4e00\u4e2a\u4e2d\u70b9\uff0c\u5411\u4e24\u7aef\u7ef4\u62a4\u5355\u8c03\u6808\uff0c\u5982\u679c\u5de6\u53f3\u7aef\u70b9\u8d85\u8fc7\u4e2d\u70b9\u5c31\u91cd\u6784\u5355\u8c03\u6808\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,m,f[N],a[N],q[N],qst[N],pst[N],qu[N],st=1;\nint h=1,t=0,mid,pt,qt;\nvoid pl(int x){\n    if(!pt||qu[pst[pt]]>qu[x])pst[++pt]=x;\n}\nvoid pr(int x){\n    if(!qt||qu[qst[qt]]>qu[x])qst[++qt]=x;\n}\nvoid rebuild(){\n    mid=h+t>>1;pt=qt=0;\n    for(int i=mid;i>=h;--i)pl(i);\n    for(int i=mid+1;i<=t;++i)pr(i);\n}\nvoid cmin(int&x,int y){if(y<x)x=y;}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    int sum=0;\n    for(int i=1;i<=n;++i){\n        scanf(\"%d\",a+i),sum+=a[i];\n        while(sum>m)sum-=a[st++];\n        while(h<=t&&a[q[t]]<=a[i]){\n            if(qt&&qst[qt]==t)--qt;\n            if(pt&&pst[pt]==t)--pt;\n            if(--t<=mid)rebuild();\n        }\n        q[++t]=i;qu[t]=(h==t?f[st-1]:f[q[t-1]])+a[i];pr(t);\n        if(pst[pt]==h)--pt;\n        if(qst[qt]==h)--qt;\n        while(h<=t&&q[h]<st){\n            if(qt&&qst[qt]==h)--qt;\n            if(pt&&pst[pt]==h)--pt;\n            if(++h>mid)rebuild();\n        }\n        f[i]=a[q[h]]+f[st-1];\n        if(pt)cmin(f[i],qu[pst[pt]]);\n        if(qt)cmin(f[i],qu[qst[qt]]);\n    }\n    printf(\"%d\\n\",f[n]);\n}\n```\n", "link": "/posts/LG 1295 [TJOI2011]\u4e66\u67b6/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5355\u8c03\u961f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4189 [CTSC2010]\u661f\u9645\u65c5\u884c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4189&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4189\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u9996\u5148\u53ef\u4ee5\u5168\u8d70\u4e00\u904d\u56de\u5230\u8d77\u70b9\uff0c\u7136\u540e\u8d2a\u5fc3\u5730\u6d88\u6389\u8fd8\u80fd\u8d70\u7684\u8fb9\uff0c\u8fd9\u6837\u5c31\u5f97\u5230\u4e86\u56de\u5230\u539f\u70b9\u7684\u6700\u5927\u6b65\u6570\u3002\n\n\u63a5\u4e0b\u6765\u8003\u8651\u518d\u8d70\u5230\u6bcf\u4e2a\u70b9\u3002\n\ndfs\u4e00\u904d\uff0c\u5982\u679c\u7236\u8282\u70b9\u8fd8\u6709\u5269\u4f59\u6d41\u91cf\u5c31\u76f4\u63a5\u8d70\u8fc7\u6765\uff0c\u5426\u5219\u9700\u8981\u9000\u6389\u5411\u7236\u8282\u70b9\u8d70\u7684\u8fb9\uff0c\u7136\u540e\u518d\u68c0\u67e5\u4e00\u4e0b\u591a\u51fa\u6765\u7684\u6d41\u91cf\u80fd\u5426\u548c\u513f\u5b50\u8d70\u6765\u56de\u3002\u6ce8\u610f\u9700\u8981\u56de\u6eaf\u3002\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=50011;\nint n,cnt,head[N],h[N],deg[N];\nll now,ans[N];\nstruct edge{int to,nxt;}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nvoid dfs(int x,int f){\n    fl(i,x)if(to!=f){\n        dfs(to,x);\n        int t=h[x]<h[to]?h[x]:h[to];\n        h[x]-=t,h[to]-=t,now+=t*2;\n    }\n}\nvoid dfs2(int x,int f){\n    bool ff;\n    if(h[f])ff=1,--h[f],++now;\n    else{\n        ff=0;--now;++h[x];\n        if(h[x]==1)fl(i,x)\n            if(to!=f&&h[to]){\n                --h[x],--h[to],now+=2,ff=-1;\n                break;\n            }\n    }\n    ans[x]=now;\n    fl(i,x)if(to!=f)dfs2(to,x);\n    if(ff==1)++h[f],--now;\n    else{\n        ++now;\n        if(ff==-1)now-=2;\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",h+i);\n    int x,y;\n    for(int i=1;i<n;++i)\n        scanf(\"%d%d\",&x,&y),++x,++y,\n        add(x,y),add(y,x),\n        ++deg[x],++deg[y];\n    for(int i=1;i<=n;++i)h[i]-=deg[i];\n    now=2*(n-1);\n    dfs(1,-1);\n    ans[1]=now;\n    fl(i,1)dfs2(to,1);\n    for(int i=1;i<=n;++i)printf(\"%lld\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG 4189 [CTSC2010]\u661f\u9645\u65c5\u884c/", "tags": ["dfs", "\u7edf\u8ba1"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 6672 [\u6e05\u534e\u96c6\u8bad2016] \u4f60\u7684\u751f\u547d\u5df2\u5982\u98ce\u4e2d\u6b8b\u70db", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P6672&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P6672\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u8f6c\u81ea: https://www.cnblogs.com/RiverHamster/p/sol-lg6672.html\n\n> ## \u7b80\u5316\u9898\u610f\n>\n> \u5c06 $w_i$ \u5168\u90e8\u51cf $1$\uff0c\u5219\u95ee\u9898\u53d8\u6210\u4e00\u4e2a\u5e8f\u5217\uff0c\u5176\u4e2d\u7ed9\u5b9a\u6709 $n$ \u4e2a\u6b63\u6570 $w_i$\uff0c\u5176\u4f59\u90fd\u662f $\u22121$\uff0c\u548c\u662f $0$\uff0c\u524d\u7f00\u548c\u5747\u975e\u8d1f\uff0c\u6c42\u6392\u5217\u65b9\u6848\u6570\u3002\n>\n> ## \u505a\u6cd5\n>\n> \u5982\u679c\u548c\u662f $1$\uff0c\u4e14\u8981\u6c42\u524d\u7f00\u548c**\u5168\u4e3a\u6b63\u6570**\uff0c\u6709\u7ed3\u8bba\uff1a\u6bcf\u4e2a\u6392\u5217\u7684\u6240\u6709\u5faa\u73af\u79fb\u4f4d\u53ea\u6709 $1$ \u79cd\u5408\u6cd5\uff0c\u6240\u4ee5\u8ba1\u6570\u5706\u6392\u5217\u6570\u5373\u53ef\uff0c\u300a\u5177\u4f53\u6570\u5b66\u300b7.5 \u7ae0\u6709\u8be6\u7ec6\u8bc1\u660e\uff0c\u5176\u5b9e\u5c31\u662f\u6bcf\u6b21\u5fc5\u987b\u8981\u53d6**\u6700\u540e\u4e00\u4e2a**\u6700\u5c0f\u503c\u4f4d\u7f6e\u4f5c\u4e3a\u8d77\u70b9\uff0c\u4f7f\u5f97\u5176\u4ed6\u6700\u5c0f\u503c\u4f4d\u7f6e\u8de8\u8fc7\u5e8f\u5217\u7ed3\u5c3e\uff0c\u524d\u7f00\u548c\u4e3a $1$\uff0c\u5426\u5219\u5982\u679c\u6709\u4e24\u4e2a\u76f8\u7b49\u6700\u5c0f\u503c\u800c\u53d6\u524d\u4e00\u4e2a\u4f5c\u4e3a\u8d77\u70b9\uff0c\u7b2c\u4e8c\u4e2a\u6700\u5c0f\u503c\u4f4d\u7f6e\u524d\u7f00\u548c\u662f $0$\u3002\n>\n> \u672c\u9898\u524d\u7f00\u548c\u53ef\u4ee5\u4e3a $0$\uff0c\u56e0\u6b64\u6bcf\u4e2a\u6700\u5c0f\u503c\u90fd\u80fd\u53d6\uff0c\u5206\u6790\u5931\u6548\u3002\n>\n> \u8bc1 Catalan \u6570\u65f6\uff0c\u53ef\u4ee5\u5728\u5f00\u5934\u653e\u4e2a $1$\uff0c\u4f46\u672c\u9898\u4e2d\u6709\u591a\u79cd**\u4e0d\u7b49\u4ef7\u7684**\u6b63\u6570\uff0c\u8fd9\u79cd\u505a\u6cd5\u662f\u65e0\u6548\u7684\u3002\n>\n> \u5728\u7ed3\u5c3e\u653e\u4e2a $\u22121$\uff0c\u95ee\u9898\u53d8\u6210\u524d $m$ \u4e2a\u5143\u7d20\u524d\u7f00\u548c\u975e\u8d1f\uff0c\u4e14\u603b\u548c\u4e3a $\u22121$\u3002\n>\n> \u7c7b\u4f3c\u5730\uff0c\u6240\u6709\u5faa\u73af\u79fb\u4f4d\u4e2d\u73b0\u5728\u53ea\u80fd\u53d6\u7b2c\u4e00\u4e2a\u6700\u5c0f\u503c\u4f4d\u7f6e\u4f5c\u4e3a\u8d77\u70b9\u4e86\uff0c\u5426\u5219\u8de8\u8fc7\u5e8f\u5217\u7ed3\u5c3e\uff0c\u4e4b\u524d\u7684\u6700\u5c0f\u503c\u4f4d\u7f6e\u524d\u7f00\u548c\u4f1a\u53d8\u6210 $\u22121$\u3002\n>\n> $m+1$ \u4e2a\u70b9\u5171\u6709 $m!$ \u79cd\u5706\u6392\u5217\uff0c\u800c\u5e8f\u5217\u4e2d\u6709 $m\u2212n+1$ \u4e2a**\u7b49\u4ef7**\u7684 $\u22121$ \u53ea\u80fd\u53d6\u989d\u5916\u653e\u7f6e\u7684 $1$ \u4e2a\u653e\u5728\u7ed3\u5c3e\uff08\u7ed3\u5c3e\u4e00\u5b9a\u662f $\u22121$\uff09\uff0c\u56e0\u6b64\u7b54\u6848 $\\frac{m!}{m\u2212n+1}$\u3002\n>\n> P.S. \u5bf9\u4e8e\u7b2c\u4e00\u4e2a\u7ed3\u8bba\uff0c\u5982\u679c\u548c\u4e3a $s$\uff0c\u90a3\u4e48\u6709 $s$ \u79cd\u5faa\u73af\u79fb\u4f4d\u3002\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int P=998244353;\nint n,m;\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1,x;i<=n;++i)\n        scanf(\"%d\",&x),m+=x;\n    int ans=1;\n    for(int i=2;i<=m;++i)\n        if(i!=m-n+1)ans=1ll*ans*i%P;\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 6672 [\u6e05\u534e\u96c6\u8bad2016] \u4f60\u7684\u751f\u547d\u5df2\u5982\u98ce\u4e2d\u6b8b\u70db/", "tags": ["\u6570\u8bba", "\u7ec4\u5408\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1338D Nested Rubber Bands", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1338D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/CF1338D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011,P=1000000007;\nint n,f[N];\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)\n}\n```\n", "link": "/posts/LG CF1338D Nested Rubber Bands/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u6811\u578bdp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF578D LCS Again", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF578D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/CF578D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011,P=1000000007;\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/LG CF578D LCS Again/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4317 \u82b1\u795e\u7684\u6570\u8bba\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4317&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4317\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u8ba1\u7b97\u51fa$f_i$\u8868\u793a\u4e8c\u8fdb\u5236\u4e0b$i$\u4e2a$1$\u7684\u65b9\u6848\u6570\n\n$\\displaystyle ans=\\sum_{i=1}^{\\log_2^n} i^{f_i}$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=55,P=10000007;\ntypedef long long ll;\nll n,f[N];\nll pw(ll x,ll b){\n    ll res=1;\n    for(;b;b>>=1,x=x*x%P)\n        if(b&1)res=res*x%P;\n    return res;\n}\nint main(){\n    scanf(\"%lld\",&n);\n    int k=0;\n    for(int j=49;~j;--j){\n        for(int i=49;i;--i)\n            f[i]+=f[i-1];\n        if(n>>j&1)++f[k++];\n    }\n    ++f[k];\n    ll ans=1;\n    for(int i=1;i<=49;++i)\n        ans=ans*pw(i,f[i])%P;\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 4317 \u82b1\u795e\u7684\u6570\u8bba\u9898/", "tags": ["\u6570\u4f4ddp", "\u7ec4\u5408\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3295 [SCOI2016]\u840c\u840c\u54d2", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3295&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3295\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u53ef\u4ee5\u60f3\u5230\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u8fde\u901a\u5757(\u9700\u8981\u6570\u5b57\u76f8\u540c\u533a\u57df)\u4e2a\u6570\n\n\u7b54\u6848\u5c31\u662f9*\u8fde\u901a\u5757\u4e2a\u6570\n\n\u76f4\u63a5\u5bf9\u6bcf\u4e2a\u70b9\u7ef4\u62a4\u666e\u901a\u7684\u5e76\u67e5\u96c6\u592a\u6162\u4e86\n\n\u7531\u4e8e\u5e76\u67e5\u96c6\u662f\u53ef\u4ee5\u5408\u5e76\u7684,\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u500d\u589e\u6765\u5408\u5e76\n\n\u5c06\u4e00\u4e2a\u70b9\u62c6\u6210$\\log n$\u4e2a\u70b9\uff0c\u5206\u522b\u4ee3\u8868\u4ece\u70b9$i$\u5f00\u59cb\u957f\u5ea6\u4e3a$2^k$\u7684\u5b50\u4e32\n\n\u90a3\u4e48\u5f53\u6211\u4eec\u5904\u7406\u4e24\u4e2a\u533a\u95f4\u76f8\u7b49\u7684\u5173\u7cfb\u65f6,\u5bf9\u533a\u95f4\u505a\u4e8c\u8fdb\u5236\u62c6\u5206,\u62c6\u6210log\u4e2a\u533a\u95f4\uff0c\u5206\u522b\u5e76\u8d77\u6765\u5373\u53ef\n\n\u6700\u540e\u518d\u4ece\u4e0a(\u5927)\u5f80\u4e0b(\u5c0f)\u8fde\u8fb9\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011,P=1e9+7;\nint n,m,f[21][N];\nint find(int x,int k){return f[k][x]==x?x:f[k][x]=find(f[k][x],k);}\nvoid mg(int x,int y,int k){\n    x=find(x,k),y=find(y,k);\n    if(x!=y)f[k][x]=y;\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    int mx=log2(n);\n    for(int k=0;k<=mx;++k)\n        for(int i=1;i<=n;++i)\n            f[k][i]=i;\n    for(int i=1,a,b,c,d;i<=m;++i){\n        scanf(\"%d%d%d%d\",&a,&b,&c,&d);\n        for(int k=mx;~k;--k)\n            if(b-a+1>=(1<<k))\n                mg(a,c,k),a+=1<<k,c+=1<<k;\n    }\n    for(int k=mx;k;--k)\n        for(int i=1,p;i<=n-(1<<k)+1;++i)\n            p=find(i,k),\n            mg(i,p,k-1),mg(i+(1<<k-1),p+(1<<k-1),k-1);\n    int ans=0;\n    for(int i=1;i<=n;++i)\n        if(f[0][i]==i)ans=!ans?9:ans*10ll%P;\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 3295 [SCOI2016]\u840c\u840c\u54d2/", "tags": ["\u5e76\u67e5\u96c6", "st\u8868"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3586 [POI2015]LOG", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3586&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3586\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u7b54\u6848\u4e0e\u4f4d\u7f6e\u6ca1\u6709\u5173\u7cfb,\u628a\u5e8f\u5217\u5f53\u4f5c\u96c6\u5408\u6765\u770b\n\n\u8bbe\u5927\u4e8e\u7b49\u4e8e$s$\u7684\u6570\u6709$cnt$\u4e2a,\u5c0f\u4e8e$s$\u7684\u6570\u548c\u4e3a$sum$\n\n\u90a3\u4e48$sum\\ge s(c-cnt)$\n\n\u53ef\u4ee5\u7528 \u79bb\u6563\u5316+\u6811\u72b6\u6570\u7ec4 / \u5e73\u8861\u6811 \u7ef4\u62a4\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=1000011;\nint n,nn,m,a[N],b[N],s[N];ll S[N];\nstruct que{int op,x,y;}q[N];\nvoid add(int x,int v){for(int i=x;i<=nn;i+=i&-i)s[i]+=v;}\nvoid ADD(int x,int v){for(int i=x;i<=nn;i+=i&-i)S[i]+=v;}\nint ask(int x){int res=0;for(int i=x;i;i-=i&-i)res+=s[i];return res;}\nll ASK(int x){ll res=0;for(int i=x;i;i-=i&-i)res+=S[i];return res;}\nint get(int x){return std::lower_bound(b+1,b+nn+1,x)-b;}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    char c[5];\n    for(int i=1;i<=m;++i)\n        scanf(\"%s%d%d\",c,&q[i].x,&q[i].y),\n        q[i].op=c[0]=='U'?0:1,\n        b[i]=q[i].y;\n    std::sort(b+1,b+m+1);\n    nn=std::unique(b+1,b+m+1)-b-1;\n    for(int i=1;i<=m;++i){\n        int x=get(q[i].y),X;\n        if(!q[i].op){\n            if(X=a[q[i].x])add(X,-1),ADD(X,-b[X]);\n            a[q[i].x]=x;\n            add(x,1),ADD(x,q[i].y);\n        }\n        else puts((x?ASK(x-1):0)>=1ll*b[x]*(q[i].x-ask(nn)+ask(x-1))?\"TAK\":\"NIE\");\n    }\n}\n```\n", "link": "/posts/LG 3586 [POI2015]LOG/", "tags": ["\u6811\u72b6\u6570\u7ec4", "\u79bb\u6563\u5316", "\u5e73\u8861\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5579 [PA2015]Siano", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5579&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5579\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u5c06\u8349\u6309\u751f\u957f\u901f\u5ea6\u6392\u5e8f,\u53ef\u4ee5\u53d1\u73b0\u6bcf\u6b21\u6536\u5272\u5b8c\u8349\u7684\u9ad8\u5ea6\u4ecd\u4e3a\u5355\u8c03\u7684\n\n\u7ef4\u62a4\u533a\u95f4\u52a0,\u533a\u95f4\u8986\u76d6,\u533a\u95f4\u548c,\u533a\u95f4\u6700\u5927\u503c\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=500011;\nint n,m,a[N];ll b,S[N];\nll s[N<<2],mx[N<<2],laz[N<<2],cov[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\nvoid upd(int x,ll d,int l,int r){\n    s[x]+=(S[r]-S[l-1])*d,mx[x]+=a[r]*d,laz[x]+=d;\n}\nvoid set(int x,ll v,int l,int r){\n    s[x]=(r-l+1)*v,mx[x]=v,cov[x]=v,laz[x]=0;\n}\nvoid pd(int rt,int l,int m,int r){\n    if(~cov[rt])set(ls,cov[rt],l,m),set(rs,cov[rt],m+1,r),cov[rt]=-1;\n    if(laz[rt])upd(ls,laz[rt],l,m),upd(rs,laz[rt],m+1,r),laz[rt]=0;\n}\nvoid cut(int l,int r,int rt){  \n    if(l==r)return set(rt,b,l,r);\n    int m=l+r>>1;pd(rt,l,m,r);\n    if(mx[ls]>b)set(rs,b,m+1,r),cut(l,m,ls);\n    else cut(m+1,r,rs);\n    mx[rt]=mx[ls]>mx[rs]?mx[ls]:mx[rs];\n    s[rt]=s[ls]+s[rs];\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i);\n    std::sort(a+1,a+n+1);\n    for(int i=1;i<=n;++i)S[i]=S[i-1]+a[i];\n    memset(cov,-1,sizeof cov);\n    ll ld=0,nd,t;\n    for(int i=1;i<=m;++i){        \n        scanf(\"%lld%lld\",&nd,&b);\n        upd(1,nd-ld,1,n);\n        if(mx[1]<=b)puts(\"0\");\n        else t=s[1],cut(1,n,1),printf(\"%lld\\n\",t-s[1]);\n        ld=nd;\n    }\n}\n```\n", "link": "/posts/LG 5579 [PA2015]Siano/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4041 [AHOI2014 or JSOI2014]\u5947\u602a\u7684\u8ba1\u7b97\u5668", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4041&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4041\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u8003\u8651\u79bb\u7ebf\n\n\u628a\u6240\u6709\u6570\u6392\u5e8f\u540e,\u53ef\u4ee5\u53d1\u73b0\u7ecf\u8fc74\u79cd\u64cd\u4f5c\u540e\u6240\u6709\u6570\u8fd8\u662f\u6709\u5e8f\u7684\n\n\u8fd9\u6837\u6211\u4eec\u7ef4\u62a4\u533a\u95f4\u52a0,\u533a\u95f4\u4e58,\u533a\u95f4\u52a0\u53d8\u5f62,\u533a\u95f4\u8986\u76d6\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=100011,P=1000000007;\nint n,m,L,R,ans[N];\nstruct que{int op,v;}q[N];\nstruct qwq{\n    int v,id;\n    bool operator<(const qwq&t){return v<t.v;}\n}a[N];\n#define ls rt<<1\n#define rs rt<<1|1\nstruct node{\n    int l,r;ll mi,mx,lu,lv,lw;\n    void upd(int u,int v,int w){// val=val*u+a[i]*v+w\n        lu*=u,lv=lv*u+v,lw=lw*u+w;\n        mi=mi*u+1ll*a[l].v*v+w;\n        mx=mx*u+1ll*a[r].v*v+w;\n    }\n}s[N<<2];\nvoid build(int l,int r,int rt){\n    s[rt]=(node){l,r,a[l].v,a[r].v,1,0,0};\n    if(l==r)return;\n    int m=l+r>>1;\n    build(l,m,ls),build(m+1,r,rs);\n}\nvoid pd(int rt){\n    s[ls].upd(s[rt].lu,s[rt].lv,s[rt].lw);\n    s[rs].upd(s[rt].lu,s[rt].lv,s[rt].lw);\n    s[rt].lu=1,s[rt].lv=s[rt].lw=0;\n}\nvoid pu(int rt){s[rt].mi=s[ls].mi,s[rt].mx=s[rs].mx;}\nvoid setL(int rt){\n    if(s[rt].l==s[rt].r)return s[rt].upd(0,0,L);\n    pd(rt);\n    if(s[rs].mi<L)s[ls].upd(0,0,L),setL(rs);\n    else setL(ls);\n    pu(rt);\n}\nvoid setR(int rt){\n    if(s[rt].l==s[rt].r)return s[rt].upd(0,0,R);\n    pd(rt);\n    if(s[ls].mx>R)s[rs].upd(0,0,R),setR(ls);\n    else setR(rs);\n    pu(rt);\n}\nvoid travel(int rt){\n    if(s[rt].l==s[rt].r){ans[a[s[rt].l].id]=s[rt].mi;return;}\n    pd(rt),travel(ls),travel(rs);\n}\nint main(){\n    scanf(\"%d%d%d\",&m,&L,&R);\n    char c[5];\n    for(int i=1;i<=m;++i){\n        scanf(\"%s%d\",c,&q[i].v);\n        if(c[0]=='+')q[i].op=1;\n        else if(c[0]=='-')q[i].op=2;\n        else if(c[0]=='*')q[i].op=3;\n        else q[i].op=4;\n    }\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",&a[i].v),a[i].id=i;\n    std::sort(a+1,a+n+1),build(1,n,1);\n    for(int i=1;i<=m;++i){\n        if(q[i].op==1)s[1].upd(1,0,q[i].v);\n        else if(q[i].op==2)s[1].upd(1,0,-q[i].v);\n        else if(q[i].op==3)s[1].upd(q[i].v,0,0);\n        else s[1].upd(1,q[i].v,0);\n\n        if(s[1].mi<L)setL(1);\n        if(s[1].mx>R)setR(1);\n    }\n    travel(1);\n    for(int i=1;i<=n;++i)printf(\"%d\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG 4041 [AHOI2014 or JSOI2014]\u5947\u602a\u7684\u8ba1\u7b97\u5668/", "tags": ["\u79bb\u7ebf", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4104 [HEOI2014]\u5e73\u8861", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4104&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4104\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u9898\u610f\u5c31\u662f\u5728$[-n,n]$\u4e2d\u53d6$k$\u4e2a\u6574\u6570,\u4f7f\u4ed6\u4eec\u548c\u4e3a$0$,\u6c42\u65b9\u6848\u6570\n\n\u4e3a\u4e86\u65b9\u4fbf,\u6211\u4eec\u53ef\u4ee5\u7406\u89e3\u4e3a\u5728$[1,2n+1]$\u4e2d\u53d6$k$\u4e2a\u6574\u6570,\u4f7f\u4ed6\u4eec\u548c\u4e3a$k(n+1)$\n\n\u53ef\u4ee5\u53d1\u73b0$k\\le 10$\n\n\u8bbe$f(i,j)$\u8868\u793a\u53d6$i$\u4e2a\u6570,\u548c\u4e3a$j$\n\n$f(i,j)=f(i,j-i)+f(i-1,j-i)$\n\n\u7531\u4e8e\u6700\u5927\u53d6\u5230$2(n+1)$,\u82e5$j$\u8d85\u51fa$2(n+1)$\u8bb0\u5f97\u51cf\u53bb\u8d85\u51fa\u90e8\u5206\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nint n,k,p,f[11][200011];\nint min(int x,int y){return x<y?x:y;}\nvoid solve(){\n    scanf(\"%d%d%d\",&n,&k,&p);\n    memset(f,0,sizeof f);\n    f[0][0]=1;\n    for(int j=1;j<=k*(n+1);++j)\n        for(int i=1;i<=k&&i<=j;++i){\n            f[i][j]=(f[i][j-i]+f[i-1][j-i])%p;\n            if(j>=(n+1)*2)f[i][j]=(f[i][j]-f[i-1][j-(n+1)*2]+p)%p;\n        }\n    printf(\"%d\\n\",f[k][k*(n+1)]%p);\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--)solve();\n}\n```\n", "link": "/posts/LG 4104 [HEOI2014]\u5e73\u8861/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "BZ 4017 \u5c0fQ\u7684\u65e0\u654c\u5f02\u6216", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://remmina.github.io/BZPRO/JudgeOnline/4017.html&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://remmina.github.io/BZPRO/JudgeOnline/4017.html\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u96be\u70b9\u5728\u4e8e\u7b2c\u4e8c\u95ee\n\n\u7b2c\u4e00\u95ee: \n\n\u4e8c\u8fdb\u5236\u62c6\u4f4d\u540e\u5206\u522b\u7edf\u8ba1\u5c31\u53ef\u4ee5\u4e86\n\n\u7b2c\u4e8c\u95ee:\n\n\u679a\u4e3e\u6bcf\u4e00\u4f4d,\u7edf\u8ba1\u7b54\u6848\u8be5\u4f4d\u662f\u5426\u4e3a1\n\n\u8bbe\u5e8f\u5217\u524d\u7f00\u548c\u4e3a$S$\n\n\u533a\u95f4$[l,r]$\u533a\u95f4\u548c\u4e8c\u8fdb\u5236\u4e0b\u7b2c$k$\u4f4d\u4e3a$1$,\u90a3\u4e48$(S_r-S_{l-1}) \\mod 2^{k+1}\\ge 2^k$\n\n\u5373\n\n$S_{l-1} \\mod 2^{k+1} \\le (S_r \\mod 2^{k+1})-2^k$\u4e14$S_{l-1}\\ge 0$\n\n\u6216\n\n$S_{l-1} \\mod 2^{k+1} \\le (S_r\\mod 2^{k+1})+2^k$\u4e14$S_r<S_{l-1}$\n\n\u79bb\u6563\u5316\u540e\u6811\u72b6\u6570\u7ec4\u5373\u53ef\u7edf\u8ba1\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011,P=998244353;\nint n,a[N],s[N],b[21][2],tr[N];\ntypedef long long ll;\nll S[N],t[N];\nvoid add(int x,int v){\n    if(~x)for(int i=x+1;i<=n+1;i+=i&-i)tr[i]^=v;\n}\nint qry(int x){\n    int res=0;\n    for(int i=x+1;i;i-=i&-i)res^=tr[i];\n    return res;\n}\nint find(ll x){\n    int l=0,r=n,ans=-1;\n\twhile(l<=r){\n\t\tint m=l+r>>1;\n\t\tif(t[m]<=x)ans=m,l=m+1;\n        else r=m-1;\n\t}\n\treturn ans;\n}\nint calc(int x){\n    ll p=1ll<<x+1;\n    t[0]=S[0]=0;\n    for(int i=1;i<=n;++i)S[i]=(S[i-1]+a[i])%p,t[i]=S[i];\n    std::sort(t,t+n+1);\n    memset(tr,0,sizeof tr);\n    int ans=0;\n    for(int i=0;i<=n;++i){\n        add(find(S[i]),1);\n        ans^=qry(find(S[i]-(1ll<<x)))^qry(find(S[i]))^qry(find(S[i]+(1ll<<x)));\n    }\n    return ans;\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i),s[i]=s[i-1]^a[i];\n    int ans1=0;ll ans2=0;\n    for(int r=0;r<=n;++r)\n        for(int i=0;i<=20;++i)\n            (ans1+=1ll*(1<<i)*b[i][s[r]>>i&1^1]%P)%=P,\n            ++b[i][s[r]>>i&1];\n    for(int i=0;i<=40;++i)\n        if(calc(i))ans2|=1ll<<i;\n    printf(\"%d %lld\\n\",ans1,ans2);\n}\n```\n", "link": "/posts/BZ 4017 \u5c0fQ\u7684\u65e0\u654c\u5f02\u6216/", "tags": ["\u4e8c\u8fdb\u5236", "\u62c6\u4f4d"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5024 \u4fdd\u536b\u738b\u56fd", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5024&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5024\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n## \u89e3\u6cd5\u4e00\n\n\u6700\u5c0f\u6743\u8986\u76d6\u96c6 = \u5168\u96c6 - \u6700\u5927\u6743\u72ec\u7acb\u96c6\n\n[\u52a8\u6001dp](/posts/\u52a8\u6001dp)\n\n\u53ea\u8981\u628a\u5f3a\u5236\u53d6\u70b9,\u4e0d\u53d6\u70b9\u53ef\u4ee5\u5206\u522b\u628a\u70b9\u7684\u6743\u503c\u6539\u4e3a\u6b63\u65e0\u7a77\u4e0e\u8d1f\u65e0\u7a77\n\n## \u89e3\u6cd5\u4e8c\n\n\u500d\u589e/\u6811\u94fe\u5256\u5206+\u6811\u5f62dp\n\n\u6bcf\u6b21\u4fee\u6539\u7684\u4e24\u4e2a\u70b9$a,b$\u6784\u6210\u4e00\u6761\u94fe\n\n\u53ef\u4ee5\u94fe\u4e0a\u8fde\u63a5\u7684\u5b50\u6811\u4e0e\u94fe\u4e2d\u95f4\u7684\u70b9\u7684\u7ed3\u679c\u4e0d\u53d7\u4fee\u6539\u5f71\u54cd,\u53ea\u6709$a,b$\u7684\u8f6c\u79fb\u53d7\u5f71\u54cd,\u9700\u8981\u5355\u72ec\u5904\u7406\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u628a\u5b50\u6811\u7684\u7b54\u6848\u90fd\u9884\u5904\u7406\u51fa\u6765,\u94fe\u4e2d\u95f4\u90e8\u5206\u53ef\u4ee5\u7528\u500d\u589e\u6216\u6811\u94fe\u5256\u5206\u7ef4\u62a4\n\n\u8fd9\u6837\u53ea\u9700\u8981\u5904\u7406$a,b$\n\n\u8bbe$f(i,0/1)$\u8868\u793a$i$\u9009/\u4e0d\u9009,\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\u7684\u6700\u5c0f\u4ee3\u4ef7,$g(i,0/1)$\u8868\u793a\u6574\u68f5\u6811\u9664\u4e86\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\u7684\u6700\u5c0f\u4ee3\u4ef7,\u53ef\u4ee5\u901a\u8fc7\u6811\u5f62dp\u6c42\u51fa\n\n$F(i,j,0/1,0/1)$\u8868\u793a$i$\u9009/\u4e0d\u9009,$i$\u7684$2^j$\u7ea7\u7956\u5148\u9009/\u4e0d\u9009,$i$\u5b50\u6811\u5230$i$\u7684$i$\u7684$2^j$\u7ea7\u7956\u5148\u5b50\u6811\u7684\u6700\u5c0f\u4ee3\u4ef7,\u53ef\u4ee5\u500d\u589e\u6c42\u51fa\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=100011;const ll inf=1ll<<60;\nint n,m,p[N],cnt,head[N],d[N],fa[20][N];\nll f[N][2],g[N][2],F[N][20][2][2];\nstruct edge{int to,nxt;}e[N*2];\nvoid add(int x,int y){e[++cnt].to=y,e[cnt].nxt=head[x],head[x]=cnt;}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nll min(ll x,ll y){return x<y?x:y;}\nvoid cmin(ll&x,ll y){if(y<x)x=y;}\nvoid dfs1(int x){\n    f[x][1]=p[x];d[x]=d[fa[0][x]]+1;\n    fl(i,x)if(to!=fa[0][x])\n        fa[0][to]=x,dfs1(to),\n        f[x][0]+=f[to][1],\n        f[x][1]+=min(f[to][0],f[to][1]);\n}\nvoid dfs2(int x){\n    fl(i,x)if(to!=fa[0][x]){\n        g[to][0]=g[x][1]+f[x][1]-min(f[to][0],f[to][1]);\n        g[to][1]=min(g[x][0]+f[x][0]-f[to][1],g[to][0]);\n        dfs2(to);\n    }\n}\nvoid swap(int&x,int&y){x^=y^=x^=y;}\nll solve(int x,int a,int y,int b){\n    if(d[x]<d[y])swap(x,y),swap(a,b);\n    ll nx[2],ny[2],tx[2]={inf,inf},ty[2]={inf,inf};\n    tx[a]=f[x][a],ty[b]=f[y][b];\n    for(int i=19;~i;--i)\n        if(d[fa[i][x]]>=d[y]){\n            nx[0]=nx[1]=inf;\n            for(int u=0;u<2;++u)\n                for(int v=0;v<2;++v)\n                    cmin(nx[u],tx[v]+F[x][i][v][u]);\n            tx[0]=nx[0],tx[1]=nx[1],x=fa[i][x];\n        }\n    if(x==y)return tx[b]+g[x][b];\n    for(int i=19;~i;--i)\n        if(fa[i][x]!=fa[i][y]){\n            nx[0]=nx[1]=ny[0]=ny[1]=inf;\n            for(int u=0;u<2;++u)\n                for(int v=0;v<2;++v)\n                    cmin(nx[u],tx[v]+F[x][i][v][u]),\n                    cmin(ny[u],ty[v]+F[y][i][v][u]);\n            tx[0]=nx[0],tx[1]=nx[1],x=fa[i][x],\n            ty[0]=ny[0],ty[1]=ny[1],y=fa[i][y];\n        }\n    int lca=fa[0][x];\n    return min(\n        f[lca][0]+g[lca][0]-f[x][1]-f[y][1]+tx[1]+ty[1],\n        f[lca][1]+g[lca][1]-min(f[x][0],f[x][1])-min(f[y][0],f[y][1])+min(tx[0],tx[1])+min(ty[0],ty[1])\n    );\n}\nint main(){\n    int a,x,b,y;char typ[5];\n    scanf(\"%d%d%s\",&n,&m,typ);\n    for(int i=1;i<=n;++i)scanf(\"%d\",p+i);\n    for(int i=1;i<n;++i)\n        scanf(\"%d%d\",&x,&y),add(x,y),add(y,x);\n    dfs1(1),dfs2(1);\n    for(int i=1;i<=n;++i){\n        F[i][0][0][0]=inf;\n        F[i][0][0][1]=f[fa[0][i]][1]-min(f[i][0],f[i][1]);\n        F[i][0][1][0]=f[fa[0][i]][0]-f[i][1];\n        F[i][0][1][1]=f[fa[0][i]][1]-min(f[i][0],f[i][1]);\n    }\n    for(int k=1;k<=19;++k)\n        for(x=1;x<=n;++x){\n            y=fa[k-1][x],fa[k][x]=fa[k-1][y];\n            for(int u=0;u<2;++u)\n                for(int v=0;v<2;++v){\n                    F[x][k][u][v]=inf;\n                    for(int w=0;w<2;++w)\n                        cmin(F[x][k][u][v],F[x][k-1][u][w]+F[y][k-1][w][v]);\n                }\n        }\n    while(m--){\n        scanf(\"%d%d%d%d\",&a,&x,&b,&y);\n        if(!x&&!y&&(fa[0][a]==b||fa[0][b]==a))puts(\"-1\");\n        else printf(\"%lld\\n\",solve(a,x,b,y));\n    }\n}\n```\n", "link": "/posts/LG 5024 \u4fdd\u536b\u738b\u56fd/", "tags": ["noip", "\u6811\u94fe\u5256\u5206", "\u52a8\u6001dp", "\u500d\u589e", "\u52a8\u6001\u89c4\u5212", "\u6811\u5f62dp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5666 \u6811\u7684\u91cd\u5fc3", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5666&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5666\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u65e2\u7136\u5bf9\u8003\u8651\u6bcf\u6761\u8fb9\u65ad\u5f00\u540e\u4ea7\u751f\u7684\u91cd\u5fc3\u6bd4\u8f83\u9ebb\u70e6,\u90a3\u4e48\u6362\u4e2a\u65b9\u5f0f:\n\n\u8003\u8651\u6bcf\u4e2a\u70b9\u6210\u4e3a\u91cd\u5fc3\u7684\u6b21\u6570\n\n\u9996\u5148\u627e\u51fa\u91cd\u5fc3\u4f5c\u4e3a\u6811\u6839\n\n\u8bbe\u5f53\u524d\u8282\u70b9\u4e3a$x$,\u5b50\u6811\u5927\u5c0f\u4e3a$siz_x$,\u5b69\u5b50\u7684\u6700\u5927\u5b50\u6811\u5927\u5c0f\u4e3a$g_x$\uff0c\u5272\u6389\u4e00\u6761\u8fb9\u540e,\u53e6\u4e00\u68f5\u6811\u5927\u5c0f\u4e3a$S$\n\n\u8003\u8651$x$\u4e0d\u662f\u91cd\u5fc3\u7684\u60c5\u51b5: \n\n$2(n-S-siz_x)\\le n-S$\u4e14$2g_x\\le n-S$\n\n\u4e5f\u5c31\u662f\n\n$S\\in [n-2siz_x,n-2g_x]$\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5e76\u7edf\u8ba1\u6bcf\u4e2a\u70b9\u5272\u6389\u4e0e\u7236\u4eb2\u4e4b\u95f4\u7684\u8fb9\u540e\u5f62\u6210\u7684$S$\n\n\u663e\u7136\u8fd9\u6761\u8fb9\u4e0d\u80fd\u5728$x$\u7684\u5b50\u6811\u5185,\u90a3\u4e48\u51cf\u53bb \u8fdb\u5165$x$\u5b50\u6811\u524d\u540e\u6c42\u548c\u7684\u5dee\n\n\u8003\u8651$x$\u4e3a\u91cd\u5fc3\u7684\u60c5\u51b5:\n\n\u8bbe$u$\u4e3a$x$\u91cd\u513f\u5b50,$v$\u4e3a$x$\u6b21\u91cd\u513f\u5b50\n\n\u82e5\u5272\u6389\u7684\u8fb9\u5728$u$\u7684\u5b50\u6811\u4e2d: $2siz_v\\le n-S$,\u5373$S\\le n-2siz_v$\n\n\u5426\u5219: $2siz_u\\le n-S$,\u5373$S\\le n-2siz_u$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=300011;\nint T,n,cnt,head[N],rt,siz[N],g[N];\nstruct edge{int to,nxt;}e[N*2];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nvoid cmax(int&x,int y){if(y>x)x=y;}\nvoid dfs(int x,int f){\n    siz[x]=1,g[x]=0;\n    bool ff=0;\n    fl(i,x)if(to!=f)\n        dfs(to,x),\n        siz[x]+=siz[to],\n        cmax(g[x],siz[to]),\n        ff|=siz[to]>(n>>1);\n    ff|=n-siz[x]>(n>>1);\n    if(!ff)rt=x;\n}\ntypedef long long ll;\nll c1[N],c2[N],ans;\nbool z[N];int u,v;\nvoid upd(ll*s,int x,int v){\n    for(int i=x+1;i<=n+1;i+=i&-i)s[i]+=v;\n}\nll qry(ll*s,int x){\n    ll res=0;\n    for(int i=x+1;i;i-=i&-i)res+=s[i];\n    return res;\n}\nll qry(ll*s,int l,int r){return qry(s,r)-qry(s,l-1);}\nvoid work(int x,int f){\n    upd(c1,siz[f],-1),upd(c1,n-siz[x],1);\n    if(x!=rt)\n        ans+=x*qry(c1,n-2*siz[x],n-2*g[x]),\n        ans+=x*qry(c2,n-2*siz[x],n-2*g[x]),\n        ans+=(siz[x]<=n-2*siz[(z[x]|=z[f])?v:u])?rt:0;\n    upd(c2,siz[x],1);\n    fl(i,x)if(to!=f)work(to,x);\n    upd(c1,siz[f],1),upd(c1,n-siz[x],-1);\n    if(x!=rt)\n        ans-=x*qry(c2,n-2*siz[x],n-2*g[x]);\n}\nvoid solve(){\n    cnt=0;memset(head,0,sizeof head);\n    scanf(\"%d\",&n);\n    for(int i=1,x,y;i<n;++i)\n        scanf(\"%d%d\",&x,&y),add(x,y),add(y,x);\n    dfs(1,0),dfs(rt,0);\n    ans=u=v=0;\n    fl(i,rt)if(siz[to]>siz[v]&&siz[v=to]>siz[u])u^=v^=u^=v;\n    memset(c1,0,sizeof c1),memset(c2,0,sizeof c2);\n    for(int i=0;i<=n;++i)upd(c1,siz[i],1),z[i]=0;\n    z[u]=1;\n    work(rt,0);\n    printf(\"%lld\\n\",ans);\n}\nint main(){\n    for(scanf(\"%d\",&T);T--;)solve();\n}\n```\n", "link": "/posts/LG 5666 \u6811\u7684\u91cd\u5fc3/", "tags": ["noip", "\u6811\u72b6\u6570\u7ec4", "dfs", "\u601d\u7ef4", "\u6811\u7684\u91cd\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5665 \u5212\u5206", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5665&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5665\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u6839\u636e\u5e73\u65b9\u548c\u516c\u5f0f\u53ef\u4ee5\u53d1\u73b0\u5206\u8d8a\u591a\u6bb5\u8d8a\u597d\n\n\u800c\u8fdb\u4e00\u6b65\u53c8\u53ef\u4ee5\u53d1\u73b0\u6700\u540e\u4e00\u6bb5\u7684\u603b\u548c\u8d8a\u5c0f\u8d8a\u597d\n\n\u4ee5\u4e0b\u662f88\u5206\u4ee3\u7801(\u9ad8\u7cbe\u4ec0\u4e48\u7684\u61d2\u5f97\u5199\u4e86):\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=4e7;\nint n,typ,a[N],q[N];\nlong long s[N],f[N],g[N];\nint main(){\n    scanf(\"%d%d\",&n,&typ);\n    if(!typ)\n        for(int i=1;i<=n;++i)scanf(\"%d\",a+i),s[i]=s[i-1]+a[i];\n    else{\n\n    }\n    int h=0,t=0;\n    for(int i=1;i<=n;++i){\n        while(h<t&&f[q[h+1]]<=s[i]-s[q[h+1]])++h;// \u5728\u6ee1\u8db3\u9012\u589e\u7684\u524d\u63d0\u4e0b,\u8d8a\u591a\u5206\u914d\u7ed9\u524d\u9762,\u540e\u9762\u5c31\u53ef\u4ee5\u8d8a\u5c0f\n        f[i]=s[i]-s[q[h]];g[i]=g[q[h]]+f[i]*f[i];\n        while(h<t&&f[q[t]]-f[i]>=s[i]-s[q[t]])--t;// \u7ef4\u62a4\u5355\u8c03\u961f\u5217\n        q[++t]=i;\n    }\n    printf(\"%lld\\n\",g[n]);\n}\n```\n", "link": "/posts/LG 5665 \u5212\u5206/", "tags": ["\u5355\u8c03\u961f\u5217", "\u8d2a\u5fc3", "\u9ad8\u7cbe\u5ea6", "noip"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5658 \u62ec\u53f7\u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5658&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5658\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u5728dfs\u7684\u8fc7\u7a0b\u4e2d\u7ef4\u62a4\u4e00\u4e2a\u6808$st$\n\n\u5047\u8bbe\u5f53\u524d\u904d\u5386\u8282\u70b9\u4e3a$x$,\u6808\u9876$st[tp]$\n\n\u82e5$x$\u4e0e\u6808\u9876\u5f62\u6210\u4e00\u4e2a\u62ec\u53f7\u5bf9,\u90a3\u4e48\u5f39\u51fa\u6808\u9876,\u5c06\u65b0\u7684\u6808\u9876\u6743\u503c+1\n\n\u6808\u9876\u6743\u503c\u8868\u793a:\n\n\u5982\u679c\u6709\u65b0\u7684\u53f3\u62ec\u53f7\u5165\u6808,\u4ee5\u8fd9\u4e2a\u53f3\u62ec\u53f7\u7ed3\u5c3e,\u80fd\u5f62\u6210\u591a\u5c11\u5408\u6cd5\u62ec\u53f7\u4e32\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=500011;\nint n,cnt,head[N],f[N];\nchar c[N];\nstruct edge{int to,nxt;}e[N];\nvoid add(int x,int y){e[++cnt].to=y,e[cnt].nxt=head[x],head[x]=cnt;}\nlong long ans=0,s[N],ps[N];\nint st[N],tp,v[N];\nvoid dfs(int x){\n    s[x]=s[f[x]];\n    int ff=0;\n    if(c[st[tp]]=='('&&c[x]==')')\n        ff=st[tp],s[x]+=++v[st[--tp]];\n    else st[++tp]=x;\n    for(int i=head[x];i;i=e[i].nxt)dfs(e[i].to);\n    // \u56de\u6eaf\n    if(ff)--v[st[tp]],st[++tp]=ff;\n    else --tp;\n}\nint main(){\n    scanf(\"%d%s\",&n,c+1);\n    for(int i=2;i<=n;++i)\n        scanf(\"%d\",f+i),add(f[i],i);\n    dfs(1);\n    for(int i=1;i<=n;++i)ans^=i*s[i];\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 5658 \u62ec\u53f7\u6811/", "tags": ["dfs", "\u601d\u7ef4", "noip"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5657 \u683c\u96f7\u7801", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5657&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5657\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n95\u5206(\u672a\u7279\u5224$2^{64}$)\n\n```cpp\n#include<iostream>\nint n;unsigned long long k;\nint main(){\n   \tstd::cin>>n>>k;\n    k^=k>>1;\n    while(~--n)std::cout<<(k>>n&1);\n}\n```\n\n100\u5206\u7b80\u6d01\u4ee3\u7801:\n\n\n<!-- more -->\n\n```cpp\n#include<iostream>\nint n;unsigned long long k;\nint main(){\n   \tstd::cin>>n>>k;\n    k^=k>>1;\n    while(~--n)std::cout<<(k>>n&1);\n}\n```\n", "link": "/posts/LG 5657 \u683c\u96f7\u7801/", "tags": ["\u6a21\u62df", "\u4e8c\u8fdb\u5236", "noip"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5023 \u586b\u6570\u6e38\u620f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5023&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5023\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u8fd9\u9898\u8003\u573a\u4e0a\u53ef\u80fd\u6253\u8868\u7a33\u4e00\u70b9\n\n|$n/m$|1|2|3|4|5|6|7|8|\n|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|\n|1|$2$|$4$|$8$|$16$|$32$|$64$|$128$|$256$|\n|2|$4$|$12$|$36$|$108$|$324$|$972$|$2916$|$8748$|\n|3|$8$|$36$|$112$|$336$|$1008$|$3024$|$9072$|$27216$|\n|4|$16$|$108$|$336$|$912$|$2688$|$8064$|$24192$|$72576$|\n|5|$32$|$324$|$1008$|$2688$|$7136$|$21312$|$63936$|$191808$|\n|6|$64$|$972$|$3024$|$8064$|$21312$|$56768$|$170112$|$510336$|\n|7|$128$|$2916$|$9072$|$24192$|$63936$|$170112$|$453504$|$1360128$|\n|8|$256$|$8748$|$27216$|$72576$|$191808$|$510336$|$1360128$|$3626752$|\n\n\u4e0d\u59a8\u8bbe$n<m$(\u4e0d\u96be\u53d1\u73b0\u8868\u683c\u662f\u5bf9\u79f0\u7684)\n\n\u4e0d\u96be\u53d1\u73b0:\n\n1. $n=1$\u65f6,$ans(n,m)=2^m$\n2. $n>1,m>n+1$\u65f6,$ans(n,m)=ans(n,m-1)\\times 3$\n\n\u6253\u8868+\u5feb\u901f\u5e42\u5c31\u5b8c\u4e8b\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int P=1000000007;\nint n,m,\n    a[10]={0,2,12,112,912,7136,56768,453504,3626752},\n    b[10]={0,4,36,336,2688,21312,170112,1360128,10879488};\nint pw(int x,int b){\n    int res=1;\n    for(;b;b>>=1,x=1ll*x*x%P)\n        if(b&1)res=1ll*res*x%P;\n    return res;\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    if(n>m)std::swap(n,m);\n    if(n==1)printf(\"%d\\n\",pw(2,m));\n    else if(n==m)printf(\"%d\\n\",a[n]);\n    else printf(\"%d\\n\",1ll*b[n]*pw(3,m-n-1)%P);\n}\n```\n", "link": "/posts/LG 5023 \u586b\u6570\u6e38\u620f/", "tags": ["noip", "\u9012\u63a8", "\u6253\u8868"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1027 Car\u7684\u65c5\u884c\u8def\u7ebf", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1027&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P1027\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u5efa\u56fe\u6bd4\u8f83\u9ebb\u70e6\u7684\u6700\u77ed\u8def\u95ee\u9898\n\n\u5c06\u6bcf\u4e2a\u57ce\u5e02\u8003\u8651\u4e3a4\u4e2a\u673a\u573a\n\n\u6bcf\u4e2a\u673a\u573a\u4e24\u4e24\u4e4b\u95f4\u4e92\u76f8\u8fde\u8fb9,\u82e5\u540c\u4e00\u4e2a\u57ce\u5e02,\u8d70\u9ad8\u901f,\u5426\u5219\u8d70\u822a\u7ebf\n\n\u9700\u8981\u6ce8\u610f\u7684\u662f\u627e\u51fa\u6839\u636e\u4e09\u4e2a\u673a\u573a\u627e\u51fa\u7b2c\u56db\u4e2a\u673a\u573a\u65f6\u7684\u5206\u7c7b\u8ba8\u8bba\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=111;\ntypedef double db;\nstruct pt{int x,y;}a[N*4];\nvoid rd(pt&a){scanf(\"%d%d\",&a.x,&a.y);}\nint DIS(pt a,pt b){return (a.x-b.x)*(a.x-b.x)+(a.y-b.y)*(a.y-b.y);}\ndb dis(pt a,pt b){return sqrt(DIS(a,b));}\npt get(pt a,pt b,pt c){\n    if(DIS(a,b)+DIS(a,c)==DIS(b,c))\n        return (pt){c.x-(a.x-b.x),c.y-(a.y-b.y)};\n    else if(DIS(a,b)+DIS(b,c)==DIS(a,c))\n        return (pt){c.x+(a.x-b.x),c.y+(a.y-b.y)};\n    else \n        return (pt){b.x+(a.x-c.x),b.y+(a.y-c.y)};\n}\nint j,T[N],bl[N*4];\nstruct node{\n    int x;db d;\n    bool operator<(const node&b)const{return d>b.d;}\n};\nstd::priority_queue<node>q;\ndb d[N*4];bool v[N*4];\nvoid solve(){\n    int n,t,A,B;j=0;\n    scanf(\"%d%d%d%d\",&n,&t,&A,&B);\n    for(int i=1,j=1;i<=n;++i,j+=4)\n        rd(a[j]),rd(a[j+1]),rd(a[j+2]),a[j+3]=get(a[j],a[j+1],a[j+2]),\n        bl[j]=bl[j+1]=bl[j+2]=bl[j+3]=i,\n        scanf(\"%d\",T+i);\n    memset(d,126,sizeof d);memset(v,0,sizeof v);\n    for(int i=A*4-3;i<=A*4;++i)q.push((node){i,d[i]=0});\n    while(!q.empty()){\n        int x=q.top().x;q.pop();\n        if(v[x])continue;else v[x]=1;\n        for(int i=1;i<=n*4;++i)if(i!=x){\n            db nd=d[x]+1.0*dis(a[x],a[i])*(bl[x]==bl[i]?T[bl[x]]:t);\n            if(nd<d[i])q.push((node){i,d[i]=nd});\n        }\n    }\n    db ans=d[B*4];\n    for(int i=B*4-3;i<B*4;++i)if(d[i]<ans)ans=d[i];\n    printf(\"%.1f\\n\",ans);\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--)solve();\n}\n```\n", "link": "/posts/LG 1027 Car\u7684\u65c5\u884c\u8def\u7ebf/", "tags": ["\u56fe\u8bba", "\u8ba1\u7b97\u51e0\u4f55", "\u6700\u77ed\u8def"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2831 \u6124\u6012\u7684\u5c0f\u9e1f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2831&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P2831\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u8bbe$f[sta]$\u4e3a\u6b7b\u4e86\u7684\u732a\u72b6\u6001\u4e3a$sta$\u65f6\u6700\u5c11\u9700\u8981\u591a\u5c11\u9e1f\n\n$f[sta|line(i,j)]=\\min(f[sta]+1)$($line(i,j)$\u8868\u793a\u7ecf\u8fc7$i,j$\u7684\u629b\u7269\u7ebf\u80fd\u6740\u6b7b\u7684\ud83d\udc16\u7684\u96c6\u5408)\n\n$f[sta|(1<<i)]=\\min(f[sta]+1)$\n\n\u4f18\u5316: \n\n\u82e5\u4ee4$x$\u4e3a\u6ee1\u8db3$sta\\&(1<<(x-1))=0$\u7684\u6700\u5c0f\u6b63\u6574\u6570,\u5219\u7531$sta$\u6269\u5c55\u7684\u8f6c\u79fb\u7684\u6240\u6709\u7ebf\u90fd\u8981\u7ecf\u8fc7$x$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=20;\ntypedef double db;\nconst db eps=1e-8;\nvoid eq(db&a,db&b,db x,db y,db z,db X,db Y,db Z){ // ax+by=z,aX+bY=Z\n    b=(x*Z-X*z)/(x*Y-X*y);\n    a=(z-y*b)/x;\n}\ndb x[N],y[N];\nint n,m,f[1<<N],lb[1<<N],l[N][N];\nvoid cmin(int&x,int y){if(y<x)x=y;}\nvoid solve(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=n;++i)\n        scanf(\"%lf%lf\",x+i,y+i);\n    memset(l,0,sizeof l);\n    for(int i=1;i<=n;++i)for(int j=i+1;j<=n;++j){\n        if(fabs(x[i]-x[j])<eps)continue;\n        db a,b;eq(a,b,x[i]*x[i],x[i],y[i],x[j]*x[j],x[j],y[j]);\n        if(a>-eps)continue;\n        for(int k=1;k<=n;++k)\n            if(fabs(a*x[k]*x[k]+b*x[k]-y[k])<eps)l[i][j]|=1<<k-1;\n    }\n    memset(f,126,sizeof f);\n    f[0]=0;\n    int lim=1<<n;\n    for(int s=0,x;s<lim;++s){\n        x=lb[s];\n        cmin(f[s|(1<<x-1)],f[s]+1);\n        for(int k=1;k<=n;++k)\n            cmin(f[s|l[x][k]],f[s]+1);\n    }\n    printf(\"%d\\n\",f[(1<<n)-1]);\n}\nint main(){\n    for(int i=0,j;i<1<<18;++i){\n        for(j=1;j<=18&&i&(1<<j-1);++j);\n        lb[i]=j;\n    }\n    int T;scanf(\"%d\",&T);\n    while(T--)solve();\n}\n```\n", "link": "/posts/LG 2831 \u6124\u6012\u7684\u5c0f\u9e1f/", "tags": ["\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1850 \u6362\u6559\u5ba4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1850&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P1850\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u8bbe$f(i,j,0),f(i,j,1)$\u8868\u793a:\n\n\u7b2c$i$\u4e2a\u65f6\u95f4\u6bb5,\u5df2\u7ecf\u7528\u4e86$j$\u4e2a\u673a\u4f1a,\u9009\u62e9$c_i$\u4e0e\u9009\u62e9$d_i$(\u6362/\u4e0d\u6362\u6559\u5ba4)\u7684\u6700\u5c0f\u671f\u671b\n\n\u8bbe$dis(i,j)$\u8868\u793a$i,j$\u4e4b\u95f4\u6700\u77ed\u8ddd\u79bb\n\n\u8f6c\u79fb\u65b9\u7a0b:\n\n$f(i,j,0)=\\min \\begin{cases}\n    f(i-1,j,0)+dis(c_{i-1},c_i)\\\\\n    \\begin{aligned}\n    f(i-1,j,1)\n        &+dis(d_{i-1},c_i)\\times k_{i-1}\\\\\n        &+dis(c_{i-1},c_i)\\times(1-k_{i-1})\n    \\end{aligned}  \n\\end{cases}$\n\n$f(i,j,1)=\\min \\begin{cases}\n    \\begin{aligned}\n    f(i-1,j-1,0)\n        &+dis(c_{i-1},d_i)\\times k_i\\\\\n        &+dis(c_{i-1},c_i)\\times (1-k_i)\n    \\end{aligned}\\\\\n    \\begin{aligned}\n    f(i-1,j-1,1)\n        &+dis(d_{i-1},d_i)\\times k_{i-1}\\times k_i\\\\\n        &+dis(c_{i-1},d_i)\\times (1-k_{i-1})\\times k_i\\\\\n        &+dis(d_{i-1},c_i)\\times k_{i-1}\\times (1-k_i)\\\\\n        &+dis(c_{i-1},c_i)\\times (1-k_{i-1})\\times (1-k_i)\\\\\n    \\end{aligned}\n\\end{cases}$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=2011,V=311;\nint n,m,v,e,c[N],d[N],dis[V][V];\ndouble k[N],f[N][N][2];\ntemplate<class T>void cmin(T&x,T y){if(y<x)x=y;}\ntemplate<class T>T min(T x,T y){return x<y?x:y;}\nint main(){\n    // read\n    scanf(\"%d%d%d%d\",&n,&m,&v,&e);\n    for(int i=1;i<=n;++i)scanf(\"%d\",c+i);\n    for(int i=1;i<=n;++i)scanf(\"%d\",d+i);\n    for(int i=1;i<=n;++i)scanf(\"%lf\",k+i);\n    //init\n    memset(dis,63,sizeof dis);\n    for(int i=1,x,y,w;i<=e;++i)\n        scanf(\"%d%d%d\",&x,&y,&w),\n        cmin(dis[x][y],w),cmin(dis[y][x],w);\n    for(int k=1;k<=v;++k)\n        for(int i=1;i<=v;++i)\n            for(int j=1;j<=v;++j)if(i!=j&&j!=k)\n                cmin(dis[i][j],dis[i][k]+dis[k][j]);\n    for(int i=1;i<=v;++i)dis[i][i]=dis[i][0]=dis[0][i]=0;\n    //solve\n    memset(f,126,sizeof f);\n    f[1][0][0]=f[1][1][1]=0;\n    for(int i=2;i<=n;++i){\n        f[i][0][0]=f[i-1][0][0]+dis[c[i-1]][c[i]];\n        for(int j=1;j<=min(m,i);++j)\n            f[i][j][0]=min(\n                f[i-1][j][0]+dis[c[i-1]][c[i]],\n                f[i-1][j][1]\n                    +dis[d[i-1]][c[i]]*k[i-1]\n                    +dis[c[i-1]][c[i]]*(1-k[i-1])\n            ),\n            f[i][j][1]=min(\n                f[i-1][j-1][0]\n                    +dis[c[i-1]][d[i]]*k[i]\n                    +dis[c[i-1]][c[i]]*(1-k[i]),\n                f[i-1][j-1][1]\n                    +dis[d[i-1]][d[i]]*k[i-1]*k[i]\n                    +dis[c[i-1]][d[i]]*(1-k[i-1])*k[i]\n                    +dis[d[i-1]][c[i]]*k[i-1]*(1-k[i])\n                    +dis[c[i-1]][c[i]]*(1-k[i-1])*(1-k[i])\n            );\n    }\n    double ans=1e17;\n    for(int i=0;i<=m;++i)\n        cmin(ans,min(f[n][i][0],f[n][i][1]));\n    printf(\"%.2f\",ans);\n}\n```\n", "link": "/posts/LG 1850 \u6362\u6559\u5ba4/", "tags": ["\u671f\u671b", "\u52a8\u6001\u89c4\u5212", "noip"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4071 [SDOI2016]\u6392\u5217\u8ba1\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4071&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4071\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u4ece$n$\u4e2a\u4f4d\u7f6e\u4e2d\u9009\u51fa$m$\u4e2a\u4f4d\u7f6e\u540e\u5269\u4f59$n-m$\u4e2a\u4f4d\u7f6e\u9519\u6392\n\n${n\\choose m}\\cdot D_{n-m}$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000011,P=1000000007;\nint D[N],fac[N],ifac[N];\nint C(int n,int m){\n    return 1ll*fac[n]*ifac[m]%P*ifac[n-m]%P;\n}\nint lucas(int n,int m){\n    if(!m)return 1;\n    return 1ll*C(n%P,m%P)*lucas(n/P,m/P)%P;\n}\nint pw(int x,int b){\n    int res=1;\n    for(;b;b>>=1,x=1ll*x*x%P)\n        if(b&1)res=1ll*res*x%P;\n    return res;\n}\nint main(){\n    D[0]=D[1]=0;D[2]=1;\n    fac[0]=fac[1]=1;fac[2]=2;\n    for(int i=3;i<=1000000;++i)\n        fac[i]=1ll*fac[i-1]*i%P,\n        D[i]=1ll*(i-1)*(D[i-1]+D[i-2])%P;\n    ifac[1000000]=pw(fac[1000000],P-2);\n    for(int i=1000000;i;--i)\n        ifac[i-1]=1ll*ifac[i]*i%P;\n    int T,n,m;\n    for(scanf(\"%d\",&T);T--;)\n        scanf(\"%d%d\",&n,&m),\n        printf(\"%d\\n\",n==m?1:1ll*lucas(n,m)*D[n-m]%P);\n}\n```\n", "link": "/posts/LG 4071 [SDOI2016]\u6392\u5217\u8ba1\u6570/", "tags": ["\u6570\u8bba", "\u7ec4\u5408\u6570", "lucas", "\u6c34\u9898"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3226 [HNOI2012]\u96c6\u5408\u9009\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3226&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3226\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u4e3a$x$\u6784\u9020\u4e00\u4e2a\u77e9\u9635\u6ee1\u8db3$a(i,j+1)=2a(i,j),a(i+1,j)=3a(i,j)$\n\n\u5bf9\u4e8e\u8fd9\u4e2a\u77e9\u9635,\u6211\u4eec\u4e0d\u80fd\u9009\u76f8\u90bb\u7684\u6570,\u4e5f\u5c31\u662f\u8bf4\u7b54\u6848\u4e3a\u4e0d\u9009\u76f8\u90bb\u7684\u6570\u7684\u65b9\u6848\u6570\n\n\u8fd9\u4e2a\u77e9\u9635\u957f$\\log_2 n$(\u4e0d\u8d85\u8fc7$17$),\u5bbd$\\log_3 n$(\u4e0d\u8d85\u8fc7$12$),\u56e0\u6b64\u53ef\u4ee5\u7528\u72b6\u538bdp\u89e3\u51b3\n\n\u6211\u4eec\u53ea\u9700\u8981\u5bf9\u4e0d\u662f$2,3$\u500d\u6570\u7684\u6570\u90fd\u6784\u9020\u4e00\u4e2a\u77e9\u9635\u5c31\u53ef\u4ee5\u8986\u76d6\u6240\u6709\u7684\u6570,\u5bb9\u6613\u53d1\u73b0\u6bcf\u4e2a\u77e9\u9635\u4e92\u4e0d\u76f8\u540c,\u6240\u4ee5\u6839\u636e\u4e58\u6cd5\u539f\u7406\u628a\u7b54\u6848\u76f8\u4e58\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int P=1000000001;\nint T,a[18][18],f[18][1<<18],lim[18];\nbool b[1<<18];\nint solve(int x){\n    int n,i,j,k,ans=0;\n    for(n=1;x<=T;++n,x*=3)\n        lim[n]=2<<(int)log2(T/x);\n    --n;\n    for(i=0;i<lim[1];++i)f[1][i]=b[i];\n    for(i=2;i<=n;++i)\n        for(j=0;j<lim[i];++j)if(b[j])\n            for(f[i][j]=k=0;k<lim[i-1];++k)if(b[k]&&!(j&k))\n                (f[i][j]+=f[i-1][k])%=P;\n    for(int i=0;i<lim[n];++i)(ans+=f[n][i])%=P;\n    return ans;\n}\nint main(){\n    scanf(\"%d\",&T);\n    for(int i=0;i<1<<18;++i)b[i]=!(i&(i<<1));\n    int ans=1;\n    for(int i=1;i<=T;++i)\n        if(i%2&&i%3)ans=1ll*ans*solve(i)%P;\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 3226 [HNOI2012]\u96c6\u5408\u9009\u6570/", "tags": ["\u6784\u9020", "\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2523 [HAOI2011]Problem c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2523&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P2523\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u8bbe$s_i$\u4e3a\u5df2\u7ecf\u786e\u5b9a\u7684$m$\u4eba\u4e2d\u7f16\u53f7\u4e0d\u5c0f\u4e8e$i$\u7684\u4e2a\u6570\n\n\u82e5\u5b58\u5728$s_i>n-i+1$,\u663e\u7136\u65e0\u89e3\n\n\u8003\u8651\u52a8\u6001\u89c4\u5212,\u8bbe$f(i,j)$\u8868\u793a\u5269\u4e0b$n-m$\u4e2a\u4eba\u4e2d\u6709$j$\u4e2a\u4eba\u7f16\u53f7\u4e0d\u5c0f\u4e8e$i$\n\n$\\displaystyle f(i,j)=\\sum_{k=0}^j f(i+1,j-k)\\cdot {j\\choose k}$, \u5176\u4e2d$j\\le n-s_i-i+1$\n\n\u6700\u7ec8\u7b54\u6848\u4e3a$f(1,n-m)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=311;\nint n,m,M,c[N][N],s[N],f[N][N];\nvoid solve(){\n    memset(f,0,sizeof f);\n    memset(s,0,sizeof s);\n    // memset(c,0,sizeof c);\n    scanf(\"%d%d%d\",&n,&m,&M);\n    c[0][0]=1;\n    for(int i=1;i<=n;++i){\n        c[i][0]=1;\n        for(int j=1;j<=i;++j)\n            c[i][j]=(c[i-1][j-1]+c[i-1][j])%M;\n    }\n    for(int i=1,x,y;i<=m;++i)\n        scanf(\"%d%d\",&x,&y),++s[y];\n    for(int i=n;i;--i)\n        if((s[i]+=s[i+1])>n-i+1)\n            return puts(\"NO\"),void();\n    f[n+1][0]=1;\n    for(int i=n;i;--i)\n        for(int j=0;j<=n-s[i]-i+1;++j)\n            for(int k=0;k<=j;++k)\n                f[i][j]=(f[i][j]+1ll*f[i+1][j-k]*c[j][k])%M;\n    printf(\"YES %d\\n\",f[1][n-m]);\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--)solve();\n}\n```\n", "link": "/posts/LG 2523 [HAOI2011]Problem c/", "tags": ["\u7ec4\u5408\u6570", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5166 xtq\u7684\u53e3\u4ee4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5166&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5166\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n> \u7f16\u53f7\u5728$[L,R]$\u7684\u540c\u5b66\u6dfb\u52a0\u7b2c$x$\u4f4d\u540c\u5b66\u4e3a\u81ea\u5df1\u7684\u89c2\u5bdf\u5bf9\u8c61\u3002\u4fdd\u8bc1$x<L\\le R$\u3002\n\n\u4ece\u5de6\u5230\u53f3\u8003\u8651,\u5982\u679c\u5f53\u524d\u8fd9\u4e2a\u4eba\u6ca1\u6709\u89c2\u5bdf\u5728\u4ed6\u4e4b\u524d\u7684\u4eba,\u90a3\u4e48\u5c31\u5fc5\u987b\u8ba9\u4ed6\u542c\u5230\u6307\u4ee4\n\n\u5426\u5219\u4ed6\u89c2\u5bdf\u7684\u4eba\u5728\u4e4b\u524d\u5df2\u7ecf\u8003\u8651\u8fc7\u4e86\n\n\u6240\u4ee5\u9700\u8981\u542c\u5230\u6307\u4ee4\u7684\u4eba\u5c31\u662f\u6ca1\u6709\u89c2\u6d4b\u7684\u4eba\n\n\u90a3\u4e48\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u533a\u95f4\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=300011;\nint n,q,s[N<<2];\nbool v[N],laz[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\nvoid build(int l,int r,int rt){\n    if(l==r)return s[rt]=!v[l],void();\n    int m=l+r>>1;\n    build(l,m,ls),build(m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nvoid pd(int rt){\n    if(laz[rt])s[ls]=s[rs]=0,laz[ls]=laz[rs]=1,laz[rt]=0;\n}\nvoid upd(int L,int R,int l=1,int r=n,int rt=1){\n    if(!s[rt])return;\n    if(L<=l&&r<=R)return s[rt]=0,laz[rt]=1,void();\n    int m=l+r>>1;pd(rt);\n    if(L<=m)upd(L,R,l,m,ls);\n    if(R>m)upd(L,R,m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nint ask(int L,int R,int l=1,int r=n,int rt=1){\n    if(L<=l&&r<=R)return s[rt];\n    int m=l+r>>1;pd(rt);\n    return (L<=m?ask(L,R,l,m,ls):0)+(R>m?ask(L,R,m+1,r,rs):0);\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    for(int i=1,t,x;i<=n;++i)\n        for(scanf(\"%d\",&t);t--;)\n            scanf(\"%d\",&x),v[x]=1;\n    build(1,n,1);\n    for(int opt,l,r;q--;){\n        scanf(\"%d%d%d\",&opt,&l,&r);\n        if(opt==1)printf(\"%d\\n\",(l>1?ask(1,l-1):0)+(r<n?ask(r+1,n):0));\n        else upd(l,r),scanf(\"%d\",&opt);\n    }\n}\n```\n", "link": "/posts/LG 5166 xtq\u7684\u53e3\u4ee4/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5344 \u3010XR-1\u3011\u901b\u68ee\u6797", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5344&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5344\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u9996\u5148\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u5224\u65ad\u6bcf\u4e2a$1$\u64cd\u4f5c\u662f\u5426\u6709\u6548\n\n\u63a5\u4e0b\u6765\u5f88\u5bb9\u6613\u53ef\u4ee5\u60f3\u5230\u6811\u5256+\u7ebf\u6bb5\u6811\u4f18\u5316\u5efa\u56fe\n\n\u5f88\u53ef\u60dc,\u51fa\u9898\u4eba\u5361\u4e86\u8fd9\u79cd\u5927\u5e38\u6570\u505a\u6cd5\n\n\u8003\u8651\u76f4\u63a5\u5728\u6811\u4e0a\u500d\u589e\u4f18\u5316\u5efa\u56fe\n\n\u548c\u500d\u589elca\u5dee\u4e0d\u591a,\u4e00\u76f4\u5411\u4e0a\u8fde\u8fb9\n\n\u800c\u6bcf\u4e2a\u70b9\u53c8\u62c6\u4e3a\u5165\u70b9\u548c\u51fa\u70b9\n\n\u6bcf\u6b21\u6784\u5efa\u4f20\u9001\u95e8\u65f6\u65b0\u5efa\u4e00\u4e2a\u70b9,\n\n\u8fde\u8fb9\u65f6\u53ea\u9700\u8981$[u_1,v_1]$\u6240\u5728\u7684\u5757\u51fa\u70b9\u8fde\u63a5\u65b0\u5efa\u70b9,\u65b0\u5efa\u70b9\u8fde\u63a5$[u_2,v_2]$\u6240\u5728\u7684\u5757\u5165\u70b9\n\n\u8be6\u7ec6\u89c1\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=500011,M=3000011;\nint n,m,s,fa[N],tt;\nint gf(int x){return x==fa[x]?x:fa[x]=gf(fa[x]);}\nint cnt,head[M];\nstruct edge{int to,nxt,w;}e[1000011];\nvoid add(int x,int y,int w){if(x&&y)e[++cnt].to=y,e[cnt].nxt=head[x],head[x]=cnt,e[cnt].w=w;}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nstruct link{int u1,v1,u2,v2,w;}E[1000011];\nint f[17][N],d[M];\nvoid dfs(int x){fl(i,x)if(to!=f[0][x]&&to)d[to]=d[x]+1,f[0][to]=x,dfs(to);}\nint lca(int x,int y){\n    if(d[x]<d[y])x^=y^=x^=y;\n    for(int i=15;~i;--i)if(d[f[i][x]]>=d[y])x=f[i][x];\n    if(x==y)return x;\n    for(int i=15;~i;--i)if(f[i][x]!=f[i][y])x=f[i][x],y=f[i][y];\n    return f[0][x];\n}\nint id1[17][N],id2[17][N],nn;\nvoid lk(int t,int u,int v,int w){\n    if(u==v)return t?add(u,nn,w):add(nn,u,w);\n    int i=0;for(;i<15&&f[i+1][u]&&d[f[i+1][u]]>=d[v]-1;++i);\n    if(t)add(id2[i][u],nn,w);else add(nn,id1[i][u],w);\n    if(f[i][u]!=f[0][v]){\n        int dep=d[f[i][u]]-d[v]+1;\n        for(int j=15;~j;--j)if(dep>>j&1)u=f[j][u];\n        if(t)add(id2[i][u],nn,w);else add(nn,id1[i][u],w);\n    }\n}\nstruct node{int x,d;bool operator<(const node&t)const{return d>t.d;}};\nstatic std::priority_queue<node>q;\nbool v[M];\nvoid dij(){\n    memset(d,0x3f,sizeof d);\n    q.push((node){s,d[s]=0});\n    while(!q.empty()){\n        int x=q.top().x;q.pop();\n        if(v[x])continue;else v[x]=1;\n        fl(i,x)if(d[x]+e[i].w<d[to])\n            d[to]=d[x]+e[i].w,q.push((node){to,d[to]});\n    }\n}\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&s);\n    int opt,u,v,u1,v1,u2,v2,w;\n    for(int i=1;i<=n;++i)fa[i]=i;\n    while(m--){\n        scanf(\"%d\",&opt);\n        if(opt==1){\n            scanf(\"%d%d%d%d%d\",&u1,&v1,&u2,&v2,&w);\n            if(gf(u1)==gf(v1)&&gf(u2)==gf(v2))E[++tt]=(link){u1,v1,u2,v2,w};\n        }\n        else{\n            scanf(\"%d%d%d\",&u,&v,&w);\n            if(gf(u)!=gf(v))fa[gf(u)]=gf(v),add(u,v,w),add(v,u,w);\n        }\n    }\n    for(int i=1;i<=n;++i)if(i==gf(i))dfs(i);\n    nn=n;\n    for(int i=1;i<=n;++i)id1[0][i]=id2[0][i]=i;\n    for(int i=1;i<=15;++i)for(int j=1;j<=n;++j){\n        f[i][j]=f[i-1][f[i-1][j]];\n        if(id1[i-1][j]||id1[i-1][f[i-1][j]]){\n            id1[i][j]=++nn,id2[i][j]=++nn;\n            add(id1[i][j],id1[i-1][j],0),add(id2[i-1][j],id2[i][j],0);\n            add(id1[i][j],id1[i-1][f[i-1][j]],0),add(id2[i-1][f[i-1][j]],id2[i][j],0);\n        }\n    }\n    for(int i=1,l;i<=tt;++i){\n        ++nn;\n        u=E[i].u1,v=E[i].v1,w=E[i].w,l=lca(u,v);\n        lk(1,u,l,w);lk(1,v,l,w);\n\t\tu=E[i].u2,v=E[i].v2,l=lca(u,v);\n        lk(0,u,l,0);lk(0,v,l,0);\n    }\n    dij();\n    for(int i=1;i<=n;++i)printf(\"%d \",d[i]==0x3f3f3f3f?-1:d[i]);\n}\n```\n", "link": "/posts/LG 5344 \u3010XR-1\u3011\u901b\u68ee\u6797/", "tags": ["\u6700\u77ed\u8def", "\u500d\u589e", "\u5e76\u67e5\u96c6", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1306 \u6590\u6ce2\u90a3\u5951\u516c\u7ea6\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1306&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P1306\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u7ed3\u8bba: $\\gcd(f_n,f_m)=f_{\\gcd(n,m)}$,\u7136\u540e\u77e9\u9635\u5feb\u901f\u5e42\u52a0\u901f\u5373\u53ef\n\n\u8bc1\u660e:\n\n\u8bbe$m>n$\n\n\u5f15\u7406:\n\n- $\\gcd(f_n,f_{n+1})=1$\n   \n   > \u6839\u636e\u8f97\u8f6c\u76f8\u51cf\u6cd5, $\\gcd(f_n,f_{n+1})=\\gcd(f_n,f_{n+1}-f_n)=\\gcd(f_n,f_{n-1})$\n   >\n   > \u6240\u4ee5 $\\gcd(f_n,f_{n+1})=\\gcd(f_n,f_{n-1})=\\dots=\\gcd(f_2,f_1)=1$\n-  $f_{n+m}=f_nf_{m-1}+f_{n+1}f_m$\n   \n   \u6570\u5b66\u5f52\u7eb3\u6cd5:\n\n   1. $n=m=1$\u65f6,\u6210\u7acb\n   2. \u5047\u8bbe$m,n\\le k$\u65f6\u6210\u7acb,\u5f53$n=k+1$\u65f6:\n      \n      $\n      \\begin{aligned}\n      f_{n+m}\n      &=f_{m+(k+1)}=f_{k+(m+1)}\\\\\n      &=f_mf_{k-1}+f_{m+1}f_k\\\\\n      &=f_mf_{k-2}+f_{m+1}f_k + f_{m+1}f_{k-1}+f_{m+2}f_k\\\\\n      &=f_{m+1}(f_{k}+f_{k-1})+f_{m}(f_{k-1}+f_{k-2})\\\\\n      &=f_kf_m+f_{k+1}f_{m+1}\n      \\end{aligned}\n      $\n\n-  $\\gcd(f_{n+m},f_n)=\\gcd(f_n,f_m)$\n   \n   $\n   \\begin{aligned}\n   \\gcd(f_{n+m},f_n)\n   &=\\gcd(f_nf_{m-1}+f_{n+1}f_m,f_n)\\\\\n   &=\\gcd(f_{n+1}f_m,f_n)\\\\\n   &=\\gcd(f_{n+1},f_n)\\cdot\\gcd(f_m,f_n)\\\\\n   &=\\gcd(f_m,f_n)\n   \\end{aligned}\n   $\n\n$\n\\begin{aligned}\n\\gcd(f_n,f_m)\n&=\\gcd(f_n,f_{m-n+n})\\\\\n&=\\gcd(f_n,f_{m-n}f_{n-1}+f_{m-n+1}f_n)\\\\\n&=\\gcd(f_n,f_{m-n}f_{n-1})\n\\end{aligned}\n\\\\\n\\because \\gcd(f_{n},f_{n+1})=1\\\\\n\\therefore \\gcd(f_n,f_{m-n}f_{n-1})=\\gcd(f_n,f_{m-n})\n$\n\n\u8fd9\u6837\u4e00\u76f4\u78be\u8f6c\u76f8\u51cf\u4e0b\u53bb,\u5c31\u662f$f_{\\gcd(n,m)}$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int P=100000000;\nint n,m;\nint gcd(int a,int b){return b?gcd(b,a%b):a;}\nstruct mat{\n    int a[2][2];\n    mat operator*(const mat&x)const{\n        mat c;memset(c.a,0,sizeof c.a);\n        for(int k=0;k<2;++k)\n            for(int i=0;i<2;++i)\n                for(int j=0;j<2;++j)\n                    (c.a[i][j]+=1ll*a[i][k]*x.a[k][j]%P)%=P;\n        return c;\n    }\n}A,B;\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    n=gcd(n,m);\n    A={\n        1,0,\n        1,0\n    };\n    B={\n        1,1,\n        1,0\n    };\n    for(--n;n;n>>=1,B=B*B)if(n&1)A=A*B;\n    printf(\"%d\\n\",A.a[0][0]);\n}\n```\n", "link": "/posts/LG 1306 \u6590\u6ce2\u90a3\u5951\u516c\u7ea6\u6570/", "tags": ["\u6590\u6ce2\u90a3\u5951", "gcd", "\u6570\u8bba", "\u77e9\u9635\u52a0\u901f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5343 \u3010XR-1\u3011\u5206\u5757", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5343&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5343\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u5f88\u5bb9\u6613\u60f3\u51fa\u666e\u901a\u7684`dp`\n\n\u4e0d\u8fc7$n \\le 10^{18}$\uff0c\u6240\u4ee5\u8981\u6784\u9020\u52a0\u901f\u77e9\u9635,\u4f7f\u7528\u77e9\u9635\u5feb\u901f\u5e42\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=111,P=1000000007,m=100;\nstruct mat{\n    int a[N][N];\n    mat operator*(const mat&x)const{\n        mat c;memset(c.a,0,sizeof c.a);\n        for(int k=1;k<=m;++k)\n            for(int i=1;i<=m;++i)\n                for(int j=1;j<=m;++j)\n                    (c.a[i][j]+=1ll*a[i][k]*x.a[k][j]%P)%=P;\n        return c;\n    }\n}A,B;\nstd::bitset<N>a,b;\nint main(){\n    long long n;int t,x;\n    scanf(\"%lld\",&n);\n    for(scanf(\"%d\",&t);t--;)scanf(\"%d\",&x),a[x]=1;\n    for(scanf(\"%d\",&t);t--;)scanf(\"%d\",&x),b[x]=1;\n    a&=b;\n    A.a[1][m]=1;\n    for(int i=1;i<m;++i)B.a[i+1][i]=1;// f[i] -> f[i+1]\n    for(int i=1;i<=m;++i)\n        if(a[i])B.a[m-i+1][m]=1;// f[m]+=f[m-i+1]\n    for(;n;n>>=1,B=B*B)if(n&1)A=A*B;\n    printf(\"%d\\n\",A.a[1][m]);\n}\n```\n", "link": "/posts/LG 5343 \u3010XR-1\u3011\u5206\u5757/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u77e9\u9635\u52a0\u901f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2536 [AHOI2005]\u75c5\u6bd2\u68c0\u6d4b", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2536&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P2536\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u9996\u5148\u5c06\u6240\u6709*RNA\u5e8f\u5217*\u63d2\u5165`trie`\u4e2d\n\n\u7136\u540e\u7528*\u75c5\u6bd2\u6a21\u7248\u7247\u6bb5*\u5728`trie`\u4e0a\u641c\u7d22\n\n\u5bf9\u4e8e`?`,\u53ef\u4ee5\u5339\u914d\u4efb\u610f\u4e00\u79cd\n\n\u5bf9\u4e8e`*`,\u53ef\u4ee5\u9009\u62e9\n\n1. \u4e0d\u5339\u914d,`*`\u5f53\u4f5c\u6ca1\u6709\n2. \u5339\u914d,\u4e0b\u4e00\u4e2a\u505c\u6b62\u7528`*`\u5339\u914d\n3. \u5339\u914d,\u4e0b\u4e00\u4e2a\u7ee7\u7eed\u7528`*`\u5339\u914d\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1011,M=500011;\nint n,len,cnt,c[M][4],end[M],ans;\nchar s[N],t[N];\nint id(char c){\n    if(c=='A')return 0;\n    if(c=='C')return 1;\n    if(c=='T')return 2;\n    if(c=='G')return 3;\n    return -1;\n}\nvoid ins(char*s){\n    int p=0;\n    for(int i=0;~id(s[i]);++i){\n        if(!c[p][id(s[i])])c[p][id(s[i])]=++cnt;\n        p=c[p][id(s[i])];\n    }\n    ++end[p];\n}\nstd::bitset<N>v[M];\nvoid dfs(int p,int d){\n    if(d==len){\n        ans-=end[p];end[p]=0;\n        return;\n    }\n    if(v[p][d])return;v[p][d]=1;\n    if(~id(s[d])){\n        if(c[p][id(s[d])])dfs(c[p][id(s[d])],d+1);\n        return;\n    }\n    if(s[d]=='?'){\n        for(int i=0;i<4;++i)\n            if(c[p][i])dfs(c[p][i],d+1);\n        return;\n    }\n    if(s[d]=='*'){\n        dfs(p,d+1);// \u8df3\u8fc7,\u4e0d\u5339\u914d,*\u5f53\u4f5c\u6ca1\u6709\n        for(int i=0;i<4;++i)if(c[p][i])\n            dfs(c[p][i],d+1),// \u5339\u914d,\u4e0b\u4e00\u4e2a\u505c\u6b62\u7528*\u5339\u914d\n            dfs(c[p][i],d); // \u5339\u914d,\u4e0b\u4e00\u4e2a\u7ee7\u7eed\u7528*\u5339\u914d\n        return;\n    }\n}\nint main(){\n    scanf(\"%s%d\",s,&n);\n    ans=n;len=strlen(s);\n    for(int i=1;i<=n;++i)scanf(\"%s\",t),ins(t);\n    dfs(0,0);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 2536 [AHOI2005]\u75c5\u6bd2\u68c0\u6d4b/", "tags": ["\u5b57\u7b26\u4e32", "trie", "\u641c\u7d22", "dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3167 [CQOI2014]\u901a\u914d\u7b26\u5339\u914d", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3167&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3167\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u8bbe$f[i][j]$\u8868\u793a\u7528\u5b8c\u524d$i$\u4e2a\u901a\u914d\u7b26,\u662f\u5426\u80fd\u5339\u914d$[1,j]$,\n\n$s$\u4e3a\u542b\u901a\u914d\u7b26\u5b57\u7b26\u4e32,$t$\u4e3a\u76ee\u6807\u5b57\u7b26\u4e32,$p_i$\u4e3a\u7b2c$i$\u4e2a\u901a\u914d\u7b26\u7684\u4f4d\u7f6e\n\n> \u4e0b\u6587`x|=y`\u8868\u793a: \u82e5$y$\u80fd,\u5219$x$\u4e5f\u80fd\n\n\u82e5\u7b2c$i$\u4e2a\u901a\u914d\u7b26\u4e3a`*`,`*`\u53ef\u4ee5\u4ee3\u66ff$j$\u4e4b\u540e\u7684\u6240\u6709\u5b57\u7b26\n\n\u90a3\u4e48$f[i][j]|=f[i][j-1]$,\u4e5f\u5c31\u662f\u7528`*`\u7ee7\u7eed\u5339\u914d\u4e0b\u53bb($j-1$\u4f4d\u4e4b\u540e\u7528`*`\u5339\u914d)\n\n\n\u82e5$s[p_i+1,p_{i+1}-1]=t[j+1,j+p_{i+1}-p_i-1]$,\n\n\u90a3\u4e48$f[i+1][j+(p_{i+1}-1)-(p_i+1)+1+[s[p_{i+1}]=?]]|=1$\n\n> \u5176\u4e2d$[s[p_{i+1}]='?']$\u5f53$s[p_{i+1}]$\u662f$?$\u65f6\u4e3a$1$,\u5426\u5219\u4e3a$0$\n\n\u8be6\u89c1\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef unsigned long long ull;\nconst int N=100011,bs=131;\nchar s[N],t[N];\null S[N],T[N],pw[N];\nvoid hs(ull*H,char*s){\n    int n=strlen(s+1);\n    for(int i=1;i<=n;++i)H[i]=H[i-1]*bs+(ull)s[i];\n}\null gh(ull*H,int l,int r){\n    if(r<l)return -1;\n    return H[r]-H[l-1]*pw[r-l+1];\n}\nint cnt,p[N];\nbool f[15][N];\nvoid solve(){\n    int n=strlen(t+1);t[++n]='&';\n    hs(T,t);\n    memset(f,0,sizeof f);\n    f[0][0]=1;\n    for(int i=0;i<=cnt;++i){\n        if(s[p[i]]=='*')\n            for(int j=1;j<=n;++j)\n                f[i][j]|=f[i][j-1];//\u8fd9\u4e00\u4f4d\u7528*\u7ee7\u7eed\u5339\u914d\n        for(int j=0;j<=n;++j)\n            if(f[i][j]&&gh(T,j+1,j+(p[i+1]-1)-(p[i]+1)+1)==gh(S,p[i]+1,p[i+1]-1))\n                f[i+1][j+(p[i+1]-1)-(p[i]+1)+1+(s[p[i+1]]=='?')]|=1;\n    }\n    puts(f[cnt][n]?\"YES\":\"NO\");\n}\nint main(){\n    pw[0]=1;\n    for(int i=1;i<=100000;++i)pw[i]=pw[i-1]*bs;\n    scanf(\"%s\",s+1);\n    int n=strlen(s+1),m;\n    for(int i=1;i<=n;++i)if(s[i]=='*'||s[i]=='?')p[++cnt]=i;\n    s[p[++cnt]=++n]='?';\n    hs(S,s);\n    scanf(\"%d\",&m);\n    while(m--)scanf(\"%s\",t+1),solve();\n}\n```\n", "link": "/posts/LG 3167 [CQOI2014]\u901a\u914d\u7b26\u5339\u914d/", "tags": ["\u5b57\u7b26\u4e32", "hash", "\u52a8\u6001\u89c4\u5212", "AC\u81ea\u52a8\u673a"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2151 [SDOI2009]HH\u53bb\u6563\u6b65", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2151&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P2151\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u77e9\u9635\u52a0\u901f\u52a8\u6001\u89c4\u5212\u7edf\u8ba1\u6709\u591a\u5c11\u957f\u5ea6\u4e3a$t$\u7684\u8def\u5f84\n\n\u9644\u52a0\u6761\u4ef6: \u4e0d\u80fd\u8d70\u8fc7\u4e00\u6761\u8fb9\u4ee5\u540e\u53c8\u7acb\u523b\u53cd\u7740\u8d70\u4e00\u6b21\n\n\u5982\u679c\u6ca1\u6709\u9644\u52a0\u6761\u4ef6\uff0c\u7528\u90bb\u63a5\u77e9\u9635\u52a0\u901f\u5373\u53ef\n\n\u90a3\u4e48\u5982\u4f55\u6ee1\u8db3\u8fd9\u4e2a\u9644\u52a0\u6761\u4ef6\u5462\uff1f\n\n\u6211\u4eec\u8bbe$f[i][j]$\u8868\u793a\u7b2c$i$\u4e2a\u65f6\u523b\u5728\u7b2c$j$\u6761\u6709\u5411\u8fb9\u7ec8\u70b9\u7684\u65b9\u6848\u6570,\u8fd9\u6837\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u4e0d\u4f1a\u53cd\u7740\u8d70\n\n\u7136\u540e\u6784\u5efa\u90bb\u63a5\u8868\uff0c\u679a\u4e3e\u70b9\uff0c\u66f4\u65b0\u52a0\u901f\u77e9\u9635\u4fe1\u606f\n\n\u521d\u59cb\u77e9\u9635\u4e3a\u6240\u6709\u4e0e\u8d77\u59cb\u70b9\u76f4\u63a5\u8fde\u63a5\u7684\u8fb9\n\n\u7b54\u6848\u4e3a\u6240\u6709\u4e0e\u7ed3\u675f\u70b9\u8fde\u63a5\u7684\u8fb9\u7684\u7b54\u6848\u4e4b\u548c\n\n\u8be6\u7ec6\u53ef\u4ee5\u67e5\u770b\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int P=45989;\nint n,m,T,A,B,cnt=0,head[55];\nstruct edge{int to,nxt;}e[121];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nstruct mat{\n    int a[121][121];\n    mat operator*(const mat&x){\n        mat c;memset(c.a,0,sizeof c.a);\n        for(int k=1;k<=cnt;++k)\n            for(int i=1;i<=cnt;++i)\n                for(int j=1;j<=cnt;++j)\n                    (c.a[i][j]+=1ll*a[i][k]*x.a[k][j]%P)%=P;\n        return c;\n    }\n}a,b;\nint neg(int x){return x&1?x+1:x-1;}\nint main(){\n    scanf(\"%d%d%d%d%d\",&n,&m,&T,&A,&B);\n    int x,y,ans=0;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d\",&x,&y),\n        add(x+1,y+1),add(y+1,x+1);\n    for(int i=1;i<=cnt;++i)\n        for(int j=head[e[i].to];j;j=e[j].nxt)\n            if(neg(j)!=i)++b.a[i][j];// \u6784\u9020\u52a0\u901f\u77e9\u9635\n    for(int i=head[A+1];i;i=e[i].nxt)++a.a[1][i]; // \u6784\u9020\u521d\u59cb\u77e9\u9635\n    for(--T;T;T>>=1,b=b*b)if(T&1)a=a*b;// \u77e9\u9635\u5feb\u901f\u5e42\n    for(int i=head[B+1];i;i=e[i].nxt)(ans+=a.a[1][neg(i)])%=P; // \u7edf\u8ba1\u7b54\u6848\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 2151 [SDOI2009]HH\u53bb\u6563\u6b65/", "tags": ["\u77e9\u9635\u4e58\u6cd5", "\u56fe\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4135 \u4f5c\u8bd7", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4135&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4135\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u9884\u5904\u7406\u51fa\n\n- $s[i][j]$\u8868\u793a\u524d$i$\u5757\u5230\u4e2d$j$\u51fa\u73b0\u7684\u6b21\u6570\n- $b[i][j]$\u8868\u793a\u7b2c$i$\u5757\u5230\u7b2c$j$\u5757\u7684\u7b54\u6848\n\n\u7edf\u8ba1\u65f6,\u5728\u5757\u5185\u7b54\u6848\u7684\u57fa\u7840\u4e0a,\u679a\u4e3e\u5757\u5916\u5143\u7d20\u66f4\u65b0\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,c,m,a[N],blk,bl[N],L[N],R[N],b[320][320],v[N],s[320][N];\nint calc(int x){return x==1?0:x&1?-1:1;}\nint solve(int l,int r){\n    int res=0;\n    if(bl[r]-bl[l]<=2){\n        for(int i=l;i<=r;++i)v[a[i]]=0;\n        for(int i=l;i<=r;++i)res+=calc(++v[a[i]]);\n        return res;\n    }\n    res=b[bl[l]+1][bl[r]-1];\n    for(int i=l;bl[i]==bl[l];++i)v[a[i]]=0;\n    for(int i=r;bl[i]==bl[r];--i)v[a[i]]=0;\n    for(int i=l;bl[i]==bl[l];++i)\n        res+=calc(++v[a[i]]+s[bl[r]-1][a[i]]-s[bl[l]][a[i]]);\n    for(int i=r;bl[i]==bl[r];--i)\n        res+=calc(++v[a[i]]+s[bl[r]-1][a[i]]-s[bl[l]][a[i]]);\n    return res;\n}\nint main(){\n    scanf(\"%d%d%d\",&n,&c,&m);blk=sqrt(n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i),bl[i]=(i-1)/blk+1;\n    for(int i=1;i<=bl[n];++i)\n        L[i]=R[i-1]+1,R[i]=R[i-1]+blk;\n    R[bl[n]]=n;\n    for(int i=1;i<=bl[n];++i){\n        memset(v,0,sizeof v);\n        for(int j=i,res=0;j<=bl[n];++j){\n            for(int k=L[j];k<=R[j];++k)res+=calc(++v[a[k]]);\n            b[i][j]=res;\n        }\n\n        for(int j=1;j<=c;++j)s[i][j]=s[i-1][j];\n        for(int k=L[i];k<=R[i];++k)++s[i][a[k]];\n    }\n    int la=0,l,r;\n    for(int i=1;i<=m;++i){\n        scanf(\"%d%d\",&l,&r),l=(l+la)%n+1,r=(r+la)%n+1;\n        if(l>r)std::swap(l,r);\n        printf(\"%d\\n\",la=solve(l,r));\n    }\n}\n```\n", "link": "/posts/LG 4135 \u4f5c\u8bd7/", "tags": ["\u5206\u5757"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4168 [Violet]\u84b2\u516c\u82f1", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4168&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4168\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u9898\u610f: \u7ed9\u51fa\u4e00\u4e2a\u957f\u5ea6\u4e3a$n$\u5e8f\u5217$a$,$m$\u6b21\u8be2\u95ee,\u6bcf\u6b21\u8be2\u95ee\u533a\u95f4$[l,r]$\u91cc\u51fa\u73b0\u6b21\u6570\u6700\u591a\u7684\u6570. \u82e5\u6709\u591a\u4e2a,\u8f93\u51fa\u6700\u5c0f\u7684.\n\n\u5982\u679c\u662f\u4e25\u683c\u533a\u95f4\u4f17\u6570\u53ef\u4ee5\u7528\u4e3b\u5e2d\u6811,\u8fd9\u91cc\u8981\u6c42\u627e\u5230\u51fa\u73b0\u6b21\u6570\u6700\u591a\u7684\u6570,\u53ea\u80fd\u4f7f\u7528\u5206\u5757\n\n\u5148\u5bf9\u5e8f\u5217\u8fdb\u884c\u79bb\u6563\u5316\n\n\u9884\u5904\u7406:\n\n1. $s[i][j]$\u8868\u793a\u524d$i$\u4e2a\u5757\u4e2d$j$\u51fa\u73b0\u4e86\u51e0\u6b21\n2. $p[i][j]$\u8868\u793a\u7b2c$i$\u5757\u5230\u7b2c$j$\u5757\u4e2d\u51fa\u73b0\u6b21\u6570\u6700\u591a\u7684\u6570,$P[i][j]$\u8868\u793a\u6b21\u6570\n\n\u590d\u6742\u5ea6$\\mathcal O(n\\log n)$\n\n\u5bf9\u4e8e\u4e00\u4e2a\u8be2\u95ee$[l,r]$\n\n\u82e5$l,r$\u5728\u540c\u4e00\u4e2a\u5757\u6216\u76f8\u90bb\u5757,\u90a3\u4e48\u66b4\u529b\u6c42\u89e3\n\n\u5426\u5219\u679a\u4e3e\u5757\u5916\u7684\u6570,\u6bcf\u4e2a\u6570\u7684\u51fa\u73b0\u6b21\u6570\u4e3a\u5757\u5185\u7684+\u5757\u5916\u7684,\u4e0e\u5757\u5185\u5df2\u7ecf\u9884\u5904\u7406\u51fa\u7684\u7b54\u6848\u6bd4\u8f83,\u66f4\u65b0\u7b54\u6848\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=44011;\nint n,q,blk,a[N],b[N],c[N];\nint cnt[N],s[222][N],p[222][222],P[222][222],bl[N],L[222],R[222];\nvoid cmin(int&x,int y){if(y<x)x=y;}\nvoid init(){\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i),b[i]=a[i];\n    std::sort(b+1,b+n+1);\n    int tt=std::unique(b+1,b+n+1)-b-1;\n    for(int i=1;i<=n;++i)c[i]=std::lower_bound(b+1,b+tt+1,a[i])-b;\n\n    blk=sqrt(n);\n    for(int i=1;i<=n;++i)bl[i]=(i-1)/blk+1;\n    for(int i=1;i<=bl[n];++i)\n        L[i]=R[i-1]+1,R[i]=R[i-1]+blk;\n    R[bl[n]]=n;\n    for(int i=1;i<=bl[n];++i){\n        for(int j=i,mx=0,mxv=0;j<=bl[n];++j){\n            for(int k=L[j];k<=R[j];++k)\n                if(++cnt[c[k]]>mxv)mxv=cnt[c[k]],mx=c[k];\n                else if(cnt[c[k]]==mxv)cmin(mx,c[k]);\n            p[i][j]=mx,P[i][j]=mxv;\n        }\n        for(int j=L[i];j<=n;++j)--cnt[c[j]];\n\n        for(int j=1;j<=n;++j)s[i][c[j]]=s[i-1][c[j]];\n        for(int j=L[i];j<=R[i];++j)++s[i][c[j]];\n    }\n}\nint solve(int l,int r){\n    int ans=0;\n    if(bl[r]-bl[l]<2){\n        for(int i=l;i<=r;++i)cnt[c[i]]=0;\n        for(int i=l;i<=r;++i)\n            if(++cnt[c[i]]>cnt[ans])ans=c[i];\n            else if(cnt[c[i]]==cnt[ans])cmin(ans,c[i]);\n    }\n    else{\n        ans=p[bl[l]+1][bl[r]-1];cnt[ans]=0;\n        for(int i=l;bl[i]==bl[l];++i)cnt[c[i]]=0;\n        for(int i=r;bl[i]==bl[r];--i)cnt[c[i]]=0;\n        for(int i=l;bl[i]==bl[l];++i)++cnt[c[i]];\n        for(int i=r;bl[i]==bl[r];--i)++cnt[c[i]];\n        int mx=0,mxv=0;\n        for(int i=l;bl[i]==bl[l];++i){\n            int t=cnt[c[i]]+s[bl[r]-1][c[i]]-s[bl[l]][c[i]];\n            if(t>mxv)mx=c[i],mxv=t;\n            else if(t==mxv)cmin(mx,c[i]);\n        }\n        for(int i=r;bl[i]==bl[r];--i){\n            int t=cnt[c[i]]+s[bl[r]-1][c[i]]-s[bl[l]][c[i]];\n            if(t>mxv)mx=c[i],mxv=t;\n            else if(t==mxv)cmin(mx,c[i]);\n        }\n        if(mxv>cnt[ans]+P[bl[l]+1][bl[r]-1])ans=mx;\n        else if(mxv==cnt[ans]+P[bl[l]+1][bl[r]-1])cmin(ans,mx);\n    }\n    return b[ans];\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    init();\n    int l,r,la=0;\n    while(q--){\n        scanf(\"%d%d\",&l,&r);\n        l=(l+la-1)%n+1,r=(r+la-1)%n+1;\n        if(l>r)std::swap(l,r);\n        printf(\"%d\\n\",la=solve(l,r));\n    }\n}\n```\n", "link": "/posts/LG 4168 [Violet]\u84b2\u516c\u82f1/", "tags": ["\u5206\u5757"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5901 [IOI2009]regions", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5901&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5901\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n> \u9898\u610f:\n> \n> $n$\u4e2a\u8282\u70b9\u7684\u6811,\u6709$r$\u79cd\u5c5e\u6027,\u6bcf\u4e2a\u70b9\u5c5e\u4e8e\u4e00\u79cd\u5c5e\u6027.\u6709$q$\u6b21\u8be2\u95ee,\u6bcf\u6b21\u8be2\u95ee\u7ed9$r_1,r_2$,\u95ee\u6709\u591a\u5c11\u5bf9\u70b9$(e_1, e_2)$\u6ee1\u8db3$e_1$\u5c5e\u6027\u4e3a $r_1$,$e_2$\u5c5e\u6027\u4e3a$r_2$,\u4e14$e_1$\u662f$e_2$\u7684\u7956\u5148. ($n,q \\le 2 \\times 10^5, r \\le 25000$,\u65f6\u9650$5s$)\n\n\u9996\u5148\u5c06\u8be2\u95ee\u79bb\u7ebf\n\n\u4e0d\u7ba1\u679a\u4e3e$e_1$\u7edf\u8ba1\u5b50\u6811\u4e2d$e_2$\u7684\u6570\u91cf\n\n\u8fd8\u662f\u679a\u4e3e$e_2$\u7edf\u8ba1\u5230\u6839\u8282\u70b9\u8def\u5f84\u4e0a$e_1$\u7684\u6570\u91cf\n\n\u90fd\u662f$\\mathcal O(nr)$\u7684\n\n\u53ef\u4ee5\u8003\u8651\u5c06\u4e24\u79cd\u65b9\u6cd5\u7ed3\u5408,\u4f7f\u7528\u6839\u53f7\u5206\u6cbb\n\n\u8bbe$r_2$\u7684\u603b\u6570\u76ee\u4e3a$S$\n\n\u82e5$S\\ge \\sqrt n$,\u679a\u4e3e$e_2$,\u7edf\u8ba1$e_1$(\u4e0d\u8d85\u8fc7$\\sqrt n$\u4e2a),\u590d\u6742\u5ea6$\\mathcal O(q\\sqrt n)$\n\n\u5426\u5219\u679a\u4e3e$e_1$,\u7edf\u8ba1$e_2$(\u5b50\u6811\u4e2d\u7684$r_2$\u4e0d\u4f1a\u8d85\u8fc7$\\sqrt n$\u4e2a),\u590d\u6742\u5ea6$\\mathcal O(n\\sqrt n)$\n\n\u5177\u4f53\u770b\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nint rd(){int x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return f?-x:x;}\nconst int N=200011;\nint n,r,q,a[N],s[N],ans[N],cnt[30300];\nusing namespace std;\nvector<int>e[N];\n#define mp make_pair\n#define pr pair<int,int>\nvector<pr>r1[N],r2[N];\nmap<pr,int>T;\nvoid dfs(int x){ // \u7edf\u8ba1\u5b50\u6811\u4e2dr2\n    for(pr i:r1[a[x]])ans[i.first]-=cnt[i.second];// \u4e0d\u8d85\u8fc7sqr\u4e2a\n    ++cnt[a[x]];\n    for(int to:e[x])dfs(to);\n    for(pr i:r1[a[x]])ans[i.first]+=cnt[i.second];\n}\nvoid DFS(int x){\n    ++cnt[a[x]];\n    for(pr i:r2[a[x]])ans[i.first]+=cnt[i.second];// \u4e0d\u8d85\u8fc7sqr\u4e2a\n    for(int to:e[x])DFS(to);\n    --cnt[a[x]];\n}\nint main(){\n    n=rd(),r=rd(),q=rd();\n    int x,y,sqr=sqrt(n);\n    ++s[a[1]=rd()];\n    for(int i=2;i<=n;++i)\n        e[x=rd()].push_back(i),\n        ++s[a[i]=rd()];\n    for(int i=1;i<=q;++i){\n        x=rd(),y=rd();\n        if(T[mp(x,y)]){ans[i]=-T[mp(x,y)];continue;}\n        else T[mp(x,y)]=i;\n        if(s[y]<sqr)r2[y].push_back(mp(i,x));\n        else r1[x].push_back(std::mp(i,y));\n    }\n    dfs(1);memset(cnt,0,sizeof cnt);DFS(1);\n    for(int i=1;i<=q;++i)\n        printf(\"%d\\n\",ans[ans[i]<0?-ans[i]:i]);\n}\n```\n", "link": "/posts/LG 5901 [IOI2009]regions/", "tags": ["\u79bb\u7ebf", "\u6839\u53f7\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3825 [NOI2017]\u6e38\u620f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3825&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3825\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u53ef\u4ee5\u53d1\u73b0\u9664\u4e86$x$\u5730\u56fe,\u5176\u4ed6\u5730\u56fe\u90fd\u53ea\u6709\u4e24\u79cd\u72b6\u6001,\n\n\u5982\u679c\u6ca1\u6709$x$\u5730\u56fe,\u90a3\u5c31\u662f`2-sat`\u88f8\u9898,\n\n\u800c$x$\u5730\u56fe\u6700\u591a\u53ea\u6709$8$\u5f20,\u6211\u4eec\u53ef\u4ee5\u66b4\u529b\u679a\u4e3e$x$\u5730\u56fe\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,d,m,cnt,head[N],a[N],b[N],pos[N];\nchar s[N],ca[N],cb[N];\nstruct edge{int to,nxt;}e[N*2];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint dfn[N],low[N],sz,st[N],tp,bl[N],tt;\nbool v[N];\nvoid cmin(int&x,int y){if(y<x)x=y;}\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;st[++tp]=x;v[x]=1;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(!dfn[to])tarjan(to),cmin(low[x],low[to]);\n        else if(v[to])cmin(low[x],dfn[to]);\n    if(low[x]==dfn[x]){\n        ++tt;\n        while(int k=st[tp--]){\n            bl[k]=tt;v[k]=0;\n            if(k==x)break;\n        }\n    }\n}\nint neg(int x){return x>n?x-n:x+n;}\nint trans(int x,char c){\n    if(s[x]==c)return -1;\n    if(s[x]=='A'||s[x]=='B')return x+n*(c=='C');\n    if(s[x]=='C')return x+n*(c=='B');\n}\nchar snart(int x,int c){\n    if(s[x]=='A')return c?'B':'C';\n    else if(s[x]=='B')return c?'A':'C';\n    else if(s[x]=='C')return c?'A':'B';\n}\nvoid solve(){\n    cnt=0,memset(head,0,sizeof head),memset(dfn,0,sizeof dfn),sz=0,tt=0;\n    for(int i=1;i<=m;++i){\n        int x=trans(a[i],ca[i]),y=trans(b[i],cb[i]);\n        if(~x){\n            if(~y)add(x,y),add(neg(y),neg(x));\n            else add(x,neg(x));\n        }\n    }\n    for(int i=1;i<=n*2;++i)if(!dfn[i])tarjan(i);\n    for(int i=1;i<=n;++i)if(bl[i]==bl[i+n])return;\n    for(int i=1;i<=n;++i)putchar(snart(i,bl[i]<bl[i+n]));\n    exit(0);\n}\nint main(){\n    std::ios::sync_with_stdio(0);std::cin.tie(0);\n    std::cin>>n>>d>>s+1>>m;\n    for(int i=1,j=0;i<=n;++i)\n        if((s[i]-=32)=='X')pos[++j]=i;\n    for(int i=1;i<=m;++i)\n        std::cin>>a[i]>>ca[i]>>b[i]>>cb[i];\n    for(int i=0;i<(1<<d);++i){\n        for(int j=1;j<=d;++j)s[pos[j]]=((i>>j)&1)?'A':'B';\n        solve();\n    }\n    puts(\"-1\");\n}\n```\n", "link": "/posts/LG 3825 [NOI2017]\u6e38\u620f/", "tags": ["2-sat", "\u56fe\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 6378 [PA2010]Riddle", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P6378&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P6378\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u9996\u5148\u6bcf\u6761\u8fb9$(x,y)$\u81f3\u5c11\u6709\u4e00\u4e2a\u7aef\u70b9\u662f\u5173\u952e\u70b9\n\n|\u6761\u4ef6|\u8fde\u8fb9|\n|:-:|:-:|\n|$x,y$\u4efb\u9009\u4e00\u4e2a|$\\neg x\\to y,\\neg y\\to x$|\n\n\u63a5\u4e0b\u6765\u662f\u5bf9\u6bcf\u90e8\u5206\u8fdb\u884c\u8fde\u8fb9\n\n\u82e5\u5c06\u6bcf\u4e2a\u70b9\u5411\u8be5\u90e8\u5206\u4e2d\u51fa\u5b83\u4ee5\u5916\u7684\u6240\u6709\u70b9\u8fde\u8fb9,\u590d\u6742\u5ea6\u4e3a$\\mathcal O(n^2)$\n\n\u6211\u4eec\u53ef\u4ee5\u524d\u7f00\u4f18\u5316\u5efa\u56fe\n\n\u8bbe\u8be5\u90e8\u5206\u4e3a$a_1,a_2,\\dots,a_w$\n\n\u5bf9\u6bcf\u4e2a\u70b9$a_i$\u65b0\u589e\u4e00\u4e2a\u72b6\u6001$pre_{a_i}$\u8868\u793a$a_{1\\sim i}$\u4e2d\u6709\u6ca1\u6709\u88ab\u9009\u4e3a\u5173\u952e\u70b9\n\n|\u6761\u4ef6|\u8fde\u8fb9|\n|:-:|:-:|\n|$a_i,pre_{a_i}$\u5fc5\u987b\u540c\u65f6\u9009|$a_i\\to pre_{a_i},\\neg pre_{a_i}\\to \\neg a_i$|\n|$pre_{a_{i-1}},pre_{a_i}$\u5fc5\u987b\u540c\u65f6\u9009|$pre_{a_{i-1}}\\to pre_{a_i},\\neg pre_{a_{i-1}}\\to \\neg pre_{a_i}$|\n|$pre_{a_{i-1}},a_i$\u4e0d\u80fd\u540c\u65f6\u9009|$pre_{a_{i-1}}\\to \\neg a_i,a_i\\to \\neg pre_{a_{i-1}}$|\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5$\\mathcal O(n)$\u8fde\u8fb9\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=4000011;\nint n,m,k,cnt,head[N];\nstruct edge{int to,nxt;}e[N*2];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint dfn[N],low[N],sz,st[N],tp,bl[N],tt;\nbool v[N];\nvoid cmin(int&x,int y){if(y<x)x=y;}\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;st[++tp]=x;v[x]=1;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(!dfn[to])tarjan(to),cmin(low[x],low[to]);\n        else if(v[to])cmin(low[x],dfn[to]);\n    if(low[x]==dfn[x]){\n        ++tt;\n        while(int k=st[tp--]){\n            bl[k]=tt;v[k]=0;\n            if(k==x)break;\n        }\n    }\n}\n#define neg(x) x+n\n#define p(x) x+n+n\n#define negp(x) x+n+n+n\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&k);\n    int x,y,w,lst;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d\",&x,&y),\n        add(neg(x),y),add(neg(y),x);\n    while(k--){\n        scanf(\"%d\",&w);lst=-1;\n        while(w--){\n            scanf(\"%d\",&x);\n            add(x,p(x)),add(negp(x),neg(x));\n            if(~lst){\n                add(p(lst),p(x)),add(negp(x),negp(lst)),\n                add(p(lst),neg(x)),add(x,negp(lst));\n            }\n            lst=x;\n        }\n    }\n    for(int i=1;i<=n*4;++i)if(!dfn[i])tarjan(i);\n    for(int i=1;i<=n;++i)\n        if(bl[i]==bl[neg(i)]||bl[p(i)]==bl[negp(i)])return puts(\"NIE\"),0;\n    puts(\"TAK\");\n}\n```\n", "link": "/posts/LG 6378 [PA2010]Riddle/", "tags": ["2-sat", "\u56fe\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4171 [JSOI2010]\u6ee1\u6c49\u5168\u5e2d", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4171&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4171\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing std::cin;\nconst int N=411;\nint n,m,cnt,head[N];\nstruct edge{int to,nxt;}e[4011];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint dfn[N],low[N],sz,st[N],tp,bl[N],tt;\nbool v[N];\nvoid cmin(int&x,int y){if(y<x)x=y;}\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;st[++tp]=x;v[x]=1;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(!dfn[to])tarjan(to),cmin(low[x],low[to]);\n        else if(v[to])cmin(low[x],dfn[to]);\n    if(low[x]==dfn[x]){\n        ++tt;\n        while(int k=st[tp--]){\n            bl[k]=tt;v[k]=0;\n            if(k==x)break;\n        }\n    }\n}\nbool solve(){\n    cnt=0,memset(head,0,sizeof head),memset(dfn,0,sizeof dfn),sz=tt=0;\n    cin>>n>>m;\n    int x,y;char cx,cy;\n    for(int i=1;i<=m;++i)\n        cin>>cx>>x>>cy>>y,\n        add(x+n*(cx=='m'),y+n*(cy=='h')),\n        add(y+n*(cy=='m'),x+n*(cx=='h'));\n    for(int i=1;i<=n*2;++i)if(!dfn[i])tarjan(i);\n    for(int i=1;i<=n;++i)\n        if(bl[i]==bl[i+n])return 0;\n    return 1;\n}\nint main(){\n    std::ios::sync_with_stdio(0);cin.tie(0);\n    int T;cin>>T;\n    while(T--)puts(solve()?\"GOOD\":\"BAD\");\n}\n```\n", "link": "/posts/LG 4171 [JSOI2010]\u6ee1\u6c49\u5168\u5e2d/", "tags": ["2-sat", "\u56fe\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5782 [POI2001]\u548c\u5e73\u59d4\u5458\u4f1a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5782&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5782\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=16011;\nint n,m,cnt,head[N];\nstruct edge{int to,nxt;}e[400011];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint dfn[N],low[N],sz,st[N],tp,bl[N],tt;\nbool v[N];\nvoid cmin(int&x,int y){if(y<x)x=y;}\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;st[++tp]=x;v[x]=1;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(!dfn[to])tarjan(to),cmin(low[x],low[to]);\n        else if(v[to])cmin(low[x],dfn[to]);\n    if(low[x]==dfn[x]){\n        ++tt;\n        while(int k=st[tp--]){\n            bl[k]=tt;v[k]=0;\n            if(k==x)break;\n        }\n    }\n}\n#define p(x) (x&1)?x+1:x-1\n#define l(x) x*2-1\n#define r(x) x*2\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    int x,y;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d\",&x,&y),\n        add(x,p(y)),add(y,p(x));\n    for(int i=1;i<=n*2;++i)if(!dfn[i])tarjan(i);\n    for(int i=1;i<=n;++i)if(bl[l(i)]==bl[r(i)])return puts(\"NIE\"),0;\n    for(int i=1;i<=n;++i)printf(\"%d\\n\",bl[l(i)]<bl[r(i)]?l(i):r(i));\n}\n```\n", "link": "/posts/LG 5782 [POI2001]\u548c\u5e73\u59d4\u5458\u4f1a/", "tags": ["2-sat", "\u56fe\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF156D Clues", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF156D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/CF156D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n\u8bbe$s_i$\u4e3a\u6bcf\u4e2a\u8fde\u901a\u5757\u70b9\u6570\n\n\u5bf9\u6bcf\u4e2a\u8fde\u901a\u5757\u6784\u5efa`prufer`\u5e8f\u5217\n\n\u7531\u4e8e\u5ea6\u6570\u4e3a\u8fb9\u6570\u4e24\u500d,$\\displaystyle \\sum_{i=1}^k d_i=2k-2$\n\n\u5bf9\u4e8e\u7ed9\u5b9a$d$\u5e8f\u5217\u6784\u9020`prufer`\u5e8f\u5217\u7684\u65b9\u6848\u6570\u4e3a:\n\n$\\displaystyle {k-2\\choose d_1-1,d_2-1,\\dots,d_k-1} = \\frac{(k-2)!}{(d_1-1)!(d_2-1)!\\cdot(d_k-1)!}$\n\n\u5bf9\u4e8e\u7b2c$i$\u4e2a\u8fde\u901a\u5757,\u5b83\u7684\u8fde\u63a5\u65b9\u5f0f\u6709$s_i^{d_i}$\u79cd,\u5bf9\u4e8e\u7ed9\u5b9a$d$\u5e8f\u5217\u4f7f\u56fe\u8fde\u901a\u7684\u65b9\u6848\u6570\u4e3a:\n\n$\\displaystyle {k-2\\choose d_1-1,d_2-1,\\dots,d_k-1}\\cdot \\prod_{i=1}^k s_i^{d_i}$\n\n\u679a\u4e3e$d$\u5e8f\u5217:\n\n$\\displaystyle \\sum_{d_i\\ge 1,\\sum d_i=2k-2} {k-2\\choose d_1-1,d_2-1,\\dots,d_k-1}\\cdot \\prod_{i=1}^k s_i^{d_i}$\n\n\u6362\u5143,\u8bbe$e_i=d_i-1$:\n\n$\\displaystyle \\sum_{e_i\\ge 0,\\sum e_i=k-2} {k-2\\choose e_1,e_2,\\dots,e_k}\\cdot \\prod_{i=1}^k s_i^{e_i+1}$\n\n\u6839\u636e\u591a\u5143\u4e8c\u9879\u5f0f\u5b9a\u7406:\n\n$\\displaystyle (x_1+x_2+\\dots+x_m)^p=\\sum_{c_i\\ge 0,\\sum c_i=p} {p\\choose c_1,c_2,\\dots,c_m}\\cdot \\prod_{i=1}^m x_i^{c_i}$\n\n\u539f\u5f0f\u5316\u7b80\u5f97:\n\n$\\displaystyle (s_1+s_2+\\dots+s_k)^{k-2}\\cdot \\prod_{i=1}^k s_i$\n\n\u5373\n$\\displaystyle n^{k-2} \\cdot \\prod_{i=1}^k s_i$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,m,p,f[N],s[N];\nint gf(int x){return x==f[x]?x:f[x]=gf(f[x]);}\nint pw(int x,int b){\n    int res=1;\n    for(;b;b>>=1,x=1ll*x*x%p)\n        if(b&1)res=1ll*res*x%p;\n    return res;\n}\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&p);\n    if(p==1)return puts(\"0\"),0;\n    int x,y,ans=1,k=0;\n    for(int i=1;i<=n;++i)f[i]=i;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d\",&x,&y),f[gf(x)]=gf(y);\n    for(int i=1;i<=n;++i)++s[gf(i)];\n    for(int i=1;i<=n;++i)\n        if(i==f[i])ans=1ll*ans*s[i]%p,++k;\n    if(k==1)puts(\"1\");\n    else printf(\"%d\\n\",1ll*pw(n,k-2)*ans%p);\n}\n```\n", "link": "/posts/LG CF156D Clues/", "tags": ["\u56fe\u8bba", "\u6811", "prufer\u5e8f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2290 [HNOI2004]\u6811\u7684\u8ba1\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2290&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P2290\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!-- no more -->\n[`prufer`\u5e8f\u5217](/posts/prufer\u5e8f\u5217)\u5e94\u7528\u6a21\u677f\n\n> $n$\u4e2a\u70b9\u7684\u5b8c\u5168\u56fe\u6709$2^{n-2}$\u68f5\u751f\u6210\u6811\u3002\n\n\u5bf9\u4e8e\u7ed9\u5b9a\u5ea6\u6570\u4e3a$d_{1\\sim n}$\u200b\u7684\u4e00\u68f5\u65e0\u6839\u6811\u5171\u6709$\\dfrac{(n-2)!}{\\prod_{i=1}^n(d_i-1)!}$\u200b\u79cd\u60c5\u51b5\n\n\u5168\u90e8\u5168\u6392\u5217\u65b9\u6848\u6570\u9664\u4ee5\u6bcf\u4e2a\u70b9$i$\u7684\u6392\u5217\u65b9\u6848\u6570(\u9664\u53bb\u91cd\u590d\u7684)\n\n\u7b2c$i$\u4e2a\u70b9\u5ea6\u6570\u4e3a$d_i$\u200b,\u4f1a\u5728`prufer`\u5e8f\u5217\u4e2d\u51fa\u73b0$d_i-1$\u6b21,\u5168\u6392\u5217\u65b9\u6848\u6570\u4e3a$(d_i-1)!$\n\n\u7531\u4e8e\u7b54\u6848\u5f88\u5927$10^17$\u5e76\u4e14\u7206`long long`,\u8fc7\u7a0b\u4e2d\u6709\u9664\u6cd5,\u6240\u4ee5\u4f7f\u7528`python3`\u81ea\u5e26\u9ad8\u7cbe\u5ea6\u975e\u5e38\u65b9\u4fbf\n\npython3\u4ee3\u7801:\n\n```py\nn=int(input())\nif n==1: # \u7279\u5224\n    print(1 if int(input())==0 else 0),exit()\n# \u9636\u4e58\nf=[1]*(n+1)\nfor i in range(1,n+1):f[i]=f[i-1]*i\n# \u8ba1\u7b97\nans=f[n-2]\ntot=0\nfor i in input().split():\n    x=int(i)\n    if x==0:print(0),exit()\n    ans//=f[x-1]\n    tot+=x-1\nprint(ans if tot==n-2 else 0) # \u7279\u5224\n```\n\n\u4e3a\u4e86\u907f\u514d\u9664\u6cd5,\u6211\u4eec\u53ef\u4ee5\u6362\u4e00\u79cd\u7edf\u8ba1\u65b9\u5f0f,\n\n\u4f9d\u6b21\u628a\u7b2c$i$\u4e2a\u70b9$d_i-1$\u4e2a\u51fa\u73b0\u7684\u6570\u63d2\u5165\u5230`prufer`\u5e8f\u5217\u4e2d,\u7b54\u6848\u4e58\u4ee5\u65b9\u6848\u6570,\u7a7a\u4f4d\u6570\u51cf\u53bb$d_i-1$\n\n\u8bb0\u5f97\u7279\u5224\n\nc++\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=155;\nint n,s,d[N],C[N][N];\nll ans=1;\nint main(){\n    scanf(\"%d\",&n);\n    if(n==1)return scanf(\"%d\",&s),puts(s==0?\"1\":\"0\"),0;\n    for(int i=1;i<=n;++i)scanf(\"%d\",d+i);\n    C[0][0]=1;\n    for(int i=1;i<=n;++i){\n        C[i][0]=1;\n        for(int j=1;j<=i;++j)C[i][j]=C[i-1][j]+C[i-1][j-1];\n    }\n    for(int i=1;i<=n;++i)ans*=C[n-2-s][d[i]-1],s+=d[i]-1;\n    if(s!=n-2)puts(\"0\");\n    else printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 2290 [HNOI2004]\u6811\u7684\u8ba1\u6570/", "tags": ["\u6570\u8bba", "prufer\u5e8f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1291 [SHOI2002]\u767e\u4e8b\u4e16\u754c\u676f\u4e4b\u65c5", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1291&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P1291\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!--no more -->\n\u5047\u8bbe\u5f53\u524d\u6709\u4e86$i$\u4e2a\u74f6\u76d6,\u8fd8\u5dee$n-i$\u4e2a\u74f6\u76d6\n\n\u518d\u4e70\u4e00\u4e2a\u74f6\u76d6\u5728\u5dee\u7684$n-i$\u4e2a\u4e2d\u7684\u6982\u7387\u4e3a$\\frac 1{n-i}$,\n\n\u671f\u671b\u518d\u4e70$\\dfrac n{n-i}$\u6b21\u540e\u62e5\u6709$i+1$\u4e2a\u74f6\u76d6\n\n\u5168\u90e8\u52a0\u8d77\u6765\u5c31\u662f$\\displaystyle \\sum_{i=0}^{n-1} \\frac n{n-i}$\n\n\u6700\u7ec8\u5c31\u662f$\\displaystyle \\left( \\frac nn + \\frac n{n-1}+\\frac n{n-2}+\\dots+\\frac n1\\right)$\n\n$$\n\\frac xy+\\frac ni=\\frac {xi+yn}{yi}\n$$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nint len(ll x){return log10(x)+1;}\nvoid op(ll z,ll x,ll y){\n    if(!x)return printf(\"%lld\\n\",z),void();\n    for(int i=len(z);i;--i)putchar(' ');printf(\"%lld\\n\",x);\n    printf(\"%lld\",z);for(int i=len(y);i;--i)putchar('-');putchar('\\n');\n    for(int i=len(z);i;--i)putchar(' ');printf(\"%lld\\n\",y);\n}\nint main(){\n    int n;scanf(\"%d\",&n);\n    ll x=0,y=1,k;\n    for(int i=1;i<=n;++i){\n        x=x*i+y*n,y=y*i;\n        k=gcd(x,y),x/=k,y/=k;\n    }\n    op(x/y,x%y,y);\n}\n```\n", "link": "/posts/LG 1291 [SHOI2002]\u767e\u4e8b\u4e16\u754c\u676f\u4e4b\u65c5/", "tags": ["\u671f\u671b", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5520 [yLOI2019] \u9752\u539f\u6a31", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5520&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5520\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!--no more -->\n\u9996\u5148\u81f3\u5c11\u9700\u8981$m-1$\u4e2a\u7a7a\u4f4d,\u7136\u540e\u5269\u4e0b\u7684$n-m+1$\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u4e71\u653e\n\n\u7b54\u6848: $A_{n-m+1}^m$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nint typ,n,m,p;\nint main(){\n    scanf(\"%d%d%d%d\",&typ,&n,&m,&p);\n    int ans=1;\n    for(int i=n-m+1;i>=n-2*m+2;--i)ans=1ll*ans*i%p;\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 5520 [yLOI2019] \u9752\u539f\u6a31/", "tags": ["\u6570\u8bba", "\u7ec4\u5408\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3414 SAC#1 - \u7ec4\u5408\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3414&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3414\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!--no more -->\n## \u9898\u610f:\n\n\u6c42$\\displaystyle \\sum_{i\\mod 2=0} {n\\choose i}$\n\n## \u9898\u89e3\n\n1. ${n\\choose 0}+{n\\choose 1}+{n\\choose 2}+\\dots+{n\\choose n}=0$\n2. ${n\\choose 0}-{n\\choose 1}+{n\\choose 2}-\\dots+(-1)^n{n\\choose n}=0$\n3. ${n\\choose 0}+{n\\choose 2}+{n\\choose 4}+\\dots={n\\choose 1}+{n\\choose 3}+{n\\choose 5}+\\dots=2^{n-1}$\n\n## \u8bc1\u660e\n\n\u4e8c\u9879\u5f0f\u5b9a\u7406:\n\n$(a+b)^n={n\\choose 0}a^n+{n\\choose 1}a^{n-1}b+\\dots+{n\\choose i}a^{n-i}b^i+\\dots+{n\\choose n}b^n$\n\n\u5f53$a=b=1$\u65f6,\u53ef\u8bc1\u660e$1$,\n\n\u5f53$a=-1,b=1$\u65f6,\u53ef\u8bc1\u660e$2$,\n\n$1$\u5f0f+$2$\u5f0f\u53ef\u8bc1\u660e$3$\u5f0f\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int P=6662333;\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%P;\n        b>>=1;x=1ll*x*x%P;\n    }\n    return res;\n}\nint main(){\n    long long n;\n    scanf(\"%lld\",&n);\n    printf(\"%d\\n\",pw(2,(n-1)%(P-1)));\n}\n```\n", "link": "/posts/LG 3414 SAC-1 \u7ec4\u5408\u6570/", "tags": ["\u7ec4\u5408\u6570", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3863 \u5e8f\u5217", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3863&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3863\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!--no more -->\n\u7edf\u8ba1\u65b9\u6cd5\u7c7b\u4f3c\u626b\u63cf\u7ebf\n\n\u6309$l$\u6216$p$\u6392\u5e8f,\u6309\u987a\u5e8f\u679a\u4e3e\n\n\u5728$l$\u7684\u65f6\u5019\u66f4\u65b0,\u5728$r$\u4e4b\u540e\u8fd8\u539f($p$\u5df2\u7ecf\u4e0d\u5728\u533a\u95f4$[l,r]$\u4e2d\u4e86,\u4e0d\u53d7\u5f71\u54cd)\n\n\u4ee5\u65f6\u95f4\u4e3a\u4e0b\u6807,\u7ef4\u62a4\u67d0\u4e2a\u65f6\u95f4\u6bb5\u5185\u5927\u4e8e\u7b49\u4e8e$y$\u7684\u6570\u4e2a\u6570\n\n\u9700\u8981\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u7ef4\u62a4\u533a\u95f4\u4e2d\u5927\u4e8e\u7b49\u4e8e\u67d0\u4e2a\u6570\u7684\u4e2a\u6570(\u5e26\u4fee\u6539),\u53ef\u4ee5\u60f3\u5230\u5206\u5757\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing std::sort;using std::pair;using std::make_pair;using std::priority_queue;\ntypedef long long ll;\nconst int N=100011;\nint n,q,blk,c[N],ans[N];\nstruct node{\n    int l,r,v,t;\n    bool operator<(const node&x)const{\n        return l<x.l||(l==x.l&&t<x.t);\n    }\n}a[N];\nstruct que{\n    int p,v,t,id;\n    bool operator<(const que&x)const{\n        return p<x.p||(p==x.p&&t<x.t);\n    }\n}b[N];\nint L[N],R[N],bl[N];\nll s[N],S[N],tag[320];\nvoid init(int k){\n    memcpy(S+L[k],s+L[k],(R[k]-L[k]+1)*__SIZEOF_LONG_LONG__);\n    // for(int i=L[k];i<=R[k];++i)S[i]=s[i];\n    sort(S+L[k],S+R[k]+1);\n}\nvoid upd(int l,int r,ll v){\n    if(bl[l]==bl[r]){\n        for(int i=l;i<=r;++i)s[i]+=v;\n        init(bl[l]);return;\n    }\n    for(int i=l;bl[i]==bl[l];++i)s[i]+=v;\n    for(int i=bl[l]+1;i<=bl[r]-1;++i)tag[i]+=v;\n    for(int i=r;bl[i]==bl[r];--i)s[i]+=v;\n    init(bl[l]);init(bl[r]);    \n}\nint calc(int i,ll v){\n    int x=std::lower_bound(S+L[i],S+R[i]+1,v)-S;\n    return R[i]-x+1;\n}\nint ask(int x,ll v){\n    int res=0;\n    for(int i=1;i<=bl[x]-1;++i)res+=calc(i,v-tag[i]);\n    for(int i=L[bl[x]];i<=x;++i)res+=s[i]+tag[bl[i]]>=v;\n    return res;\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    int opt,x,y,v,cnt1=0,cnt2=0;\n    for(int i=1;i<=n;++i)scanf(\"%d\",c+i);\n    for(int i=2;i<=q+1;++i){\n        scanf(\"%d%d%d\",&opt,&x,&y);\n        if(opt==1)scanf(\"%d\",&v),a[++cnt1]=(node){x,y,v,i};\n        else ++cnt2,b[cnt2]=(que){x,y,i,cnt2};\n    }\n    sort(a+1,a+cnt1+1);\n    sort(b+1,b+cnt2+1);\n    ++q;\n    blk=sqrt(q);\n    for(int i=1;i<=q;++i)bl[i]=(i-1)/blk+1;\n    for(int i=1;i<=bl[q];++i)\n        L[i]=R[i-1]+1,R[i]=R[i-1]+blk;\n    R[bl[q]]=q;\n    priority_queue<pair<int,int>>Q;\n    for(int i=1,j=1;i<=cnt2;++i){\n        while(!Q.empty()&&-Q.top().first<b[i].p)\n            x=Q.top().second,Q.pop(),\n            upd(a[x].t,q,-a[x].v);\n        if(b[i].p!=b[i-1].p)\n            upd(1,q,c[b[i].p]),\n            upd(1,q,-c[b[i-1].p]);\n        for(;a[j].l<=b[i].p&&j<=cnt1;++j)\n            if(b[i].p<=a[j].r)\n                upd(a[j].t,q,a[j].v),\n                Q.push(make_pair(-a[j].r,j));\n        ans[b[i].id]=ask(b[i].t-1,b[i].v);\n    }\n    for(int i=1;i<=cnt2;++i)printf(\"%d\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG 3863 \u5e8f\u5217/", "tags": ["\u79bb\u7ebf", "\u5206\u5757"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3396 \u54c8\u5e0c\u51b2\u7a81", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3396&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3396\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\u6839\u53f7\u5206\u6cbb\u8bba\u6587\u9898\n\n## \u9898\u610f\n\n\u7ed9\u4e00\u4e2a\u5e8f\u5217\u5e8f\u5217$A$,\u5355\u70b9\u4fee\u6539,\n\n\u67e5\u8be2$\\displaystyle \\sum_{i\\mod p=k} A_i$\n\n<!-- more -->\n\n## \u66b4\u529b\n\n\u67e5\u8be2:\n\n```cpp\nfor(int i=k;i<=n;i+=p)ans+=A[i];\n```\n\n$\\mathcal O(1)$\u4fee\u6539,$\\mathcal O(n)$\u67e5\u8be2,\u590d\u6742\u5ea6$\\mathcal O(n^2)$\n\n## \u9884\u5904\u7406\n\n\u4fee\u6539$A_i$\u65f6\u9884\u5904\u7406:\n\n```cpp\nfor(int p=1;p<=n;++p) //\u679a\u4e3e\u6a21\u6570\n    ans[p][i%p]+=A[i]; //\u5904\u7406\u5bf9\u5e94\u7684\u8d21\u732e\n```\n\n$\\mathcal O(n)$\u9884\u5904\u7406,$\\mathcal O(1)$\u67e5\u8be2,\u590d\u6742\u5ea6$\\mathcal O(n^2)$\n\n## \u6839\u53f7\u5206\u6cbb\n\n\u53ea\u9884\u5904\u7406$p\\in [1,\\sqrt n]$:\n\n```cpp\nfor(int p=1;p<=sqr;++p) //\u53ea\u679a\u4e3e[1,\u221an]\u4e2d\u7684\n    ans[p][i%p]+=A[i];\n```\n\n\u67e5\u8be2:\n\n\u82e5$p<\\sqrt n$\u90a3\u4e48\u76f4\u63a5\u7ed9\u51fa\u7b54\u6848\n\n$p>\\sqrt n$\u65f6,\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u7684\u6570\u4e0d\u8d85\u8fc7$\\sqrt n$\u4e2a\n\n```cpp\nint res=0;\nif(p<=sqr)\n    res=ans[p][i%p];\nelse \n    for(int i=k;i<=n;i+=p)ans+=A[i];\n```\n\n\u4fee\u6539:\n\n```cpp\nvoid upd(int i,int v){ //\u5c06A[i]\u6539\u4e3av\n    for(int p=1;p<=sqr;++p)\n        ans[p][i%p]=ans[p][i%p]-A[i]+v;\n    A[i]=v;\n}\n```\n<!-- more -->\n\n\u5b8c\u6574\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=150011;\nint n,q,sqr,A[N],ans[400][400];\nvoid upd(int i,int v){\n    for(int p=1;p<=sqr;++p)\n        ans[p][i%p]=ans[p][i%p]-A[i]+v;\n    A[i]=v;\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    sqr=sqrt(n);\n    char opt[5];int x,y,v;\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\",&v),upd(i,v);\n    while(q--){\n        scanf(\"%s%d%d\",opt,&x,&y);\n        if(opt[0]=='A'){\n            int res=0;\n            if(x<=sqr)res=ans[x][y%x];\n            else for(int i=y;i<=n;i+=x)res+=A[i];\n            printf(\"%d\\n\",res);\n        }\n        else upd(x,y);\n    }\n}\n```", "link": "/posts/LG 3396 \u54c8\u5e0c\u51b2\u7a81/", "tags": ["\u6839\u53f7\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2534 [AHOI2012]\u94c1\u76d8\u6574\u7406", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2534&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P2534\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!--no more -->\n\u4f7f\u7528`ida*`\n\n\u9996\u5148\u5c06\u6570\u7ec4\u79bb\u6563\u5316\u4e3a$1,2,\\dots,n$\n\n\u4e00\u6b21\u7ffb\u8f6c\u6700\u591a\u53ea\u80fd\u6539\u53d8\u4e00\u5bf9\u76f8\u90bb\u6570\u7684\u5dee,\n\n\u56e0\u6b64\u5bf9\u4e8e\u4e00\u4e2a\u5e8f\u5217,\u6709\u591a\u5c11\u5bf9\u76f8\u90bb\u7684\u6570\u5dee\u4e0d\u4e3a$1$,\u5c31\u81f3\u5c11\u8981\u7ffb\u8f6c\u591a\u5c11\u6b21\u3002\n\n\u4f30\u4ef7\u51fd\u6570:\n\n```cpp\na[n+1]=n+1;\nint h(){\n    int cnt=0;\n    for(int i=1;i<=n;++i)cnt+=(a[i]!=a[i+1]+1&&a[i]!=a[i+1]-1);\n    return cnt;\n}\n```\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,mxd,a[N],b[N];\nbool sol;\nint h(){ // \u4f30\u4ef7\u51fd\u6570\n    int cnt=0;\n    for(int i=1;i<=n;++i)cnt+=(a[i]!=a[i+1]+1&&a[i]!=a[i+1]-1);\n    return cnt;\n}\nvoid dfs(int g,int pre){\n    if(sol||g+h()>mxd)return;\n    if(!h())return sol=1,void();\n    for(int i=1;i<=n;++i)if(i!=pre){\n        std::reverse(a+1,a+i+1);\n        dfs(g+1,i);\n        std::reverse(a+1,a+i+1);\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i),b[i]=a[i];\n    std::sort(b+1,b+n+1);\n    for(int i=1;i<=n;++i)a[i]=std::lower_bound(b+1,b+n+1,a[i])-b;\n    a[n+1]=n+1;\n    for(int i=0;!sol;++i){\n        mxd=i,dfs(0,0);\n        if(sol)printf(\"%d\\n\",i);\n    }\n}\n```\n", "link": "/posts/LG 2534 [AHOI2012]\u94c1\u76d8\u6574\u7406/", "tags": ["\u526a\u679d", "dfs", "ida*"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5889 \u8df3\u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5889&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5889\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!--no more -->\n\u8bb0\u5f55\u6bcf\u6bb5\u533a\u95f4\u64cd\u4f5c\u540e:\n\n\u5411\u4e0a$k$\u7ea7\u7956\u5148,\u5411\u4e0b$d$\u7ea7\u5b69\u5b50,\u8be5\u5c42\u5411\u53f3\u7684\u7b2c$i$\u4e2a\u5b69\u5b50\n\n\u7ebf\u6bb5\u6811\u7ef4\u62a4\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=500011;\n#define ls rt<<1\n#define rs rt<<1|1\ntypedef long long ll;\nstruct node{\n    int k,d;ll i;//k\u7ea7\u7956\u5148,\u7956\u5148\u7684d\u4ee3\u5b69\u5b50,\u5230\u7ec8\u70b9\u540e\u5728\u8be5\u5c42\u52a0\u4e0ai\n    node operator+(const node&x)const{\n        if(!x.k&&!x.d)return *this;\n        if(!k&&!d)return x;\n        if(d>x.k)return node{k,d-x.k+x.d,((i>>x.k)<<x.d)+x.i};\n        else return node{k+x.k-d,x.d,x.i};\n    }\n}s[N<<2],typ[3]={node{0,1,0},node{0,1,1},node{1,0,0}};\nvoid build(int l,int r,int rt){\n    if(l==r){\n        int v;scanf(\"%d\",&v);\n        s[rt]=typ[v-1];\n        return;\n    }\n    int m=l+r>>1;\n    build(l,m,ls),build(m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nvoid upd(int p,int v,int l,int r,int rt){\n    if(l==r)return s[rt]=typ[v-1],void();\n    int m=l+r>>1;\n    if(p<=m)upd(p,v,l,m,ls);\n    else upd(p,v,m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nnode ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=l+r>>1;\n    if(L>m)return ask(L,R,m+1,r,rs);\n    else if(R<=m)return ask(L,R,l,m,ls);\n    else return ask(L,m,l,m,ls)+ask(m+1,R,m+1,r,rs);\n}\nint main(){\n    int n,m,q,opt,x,y,z,v;ll s;\n    scanf(\"%d%d%d\",&n,&m,&q);\n    build(1,m,1);\n    while(q--){\n        scanf(\"%d\",&opt);\n        if(opt==1){\n            scanf(\"%lld%d%d\",&s,&x,&y);\n            node res=ask(x,y,1,m,1);\n            printf(\"%lld\\n\",(std::max(1ll,s>>res.k)<<res.d)+res.i);\n        }\n        else scanf(\"%d%d\",&x,&v),upd(x,v,1,m,1);\n    }\n}\n```\n", "link": "/posts/LG 5889 \u8df3\u6811/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4618 [SDOI2018]\u539f\u9898\u8bc6\u522b", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4618&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4618\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u94fe\u4e0a\u7684\u60c5\u51b5\n\n### \u60c5\u51b5\u4e00\n\n\u8bb0\u5f55\u6bcf\u4e2a\u70b9$i$\u524d\u4e00\u4e2a\u4e0e\u5b83\u4e00\u6837\u7684\u4f4d\u7f6e$pre_i$,\n\n\u90a3\u4e48\u533a\u95f4$[l,r]$\u5185\u4e0d\u540c\u7684\u4e2a\u6570\u4e5f\u5c31\u662f$[l,r]$\u4e2d$pre_i<l$\u7684\u4e2a\u6570\n\n\u4e3b\u5e2d\u6811\u7edf\u8ba1\u5373\u53ef\n\n### \u60c5\u51b5\u4e8c\n\n\u8003\u8651\u6bcf\u4e2a\u70b9\u5bf9\u7b54\u6848\u7684\u8d21\u732e,\u5206\u7c7b\u8ba8\u8bba\n\n1. $i\\in [1,A]$\n   \n   \u90a3\u4e48\u6ee1\u8db3\u7684$y\\in (pre_i,i],x\\in [i,A]$\n   \n   \u6216$x\\in (pre_i,i],y\\in [i,B]$\n\n   \u603b\u8d21\u732e\u4e3a$\\sum (i-pre_i)\\times(A+B-2i+2)-1$\n   \n   ($-1$\u4e3a\u4e86\u907f\u514d$[i,i]$\u88ab\u91cd\u590d\u8ba1\u7b97)\n\n   \u62c6\u4e0b\u5f0f\u5b50: $(A+B+2)(\\sum i-pre_i)-2(\\sum i(i-pre_i))-\\sum 1$\n\n   \u53ef\u4ee5\u53d1\u73b0\u8fd9\u79cd\u60c5\u51b5\u53ef\u4ee5\u76f4\u63a5\u524d\u7f00\u548c\u7ef4\u62a4\n\n2. $i\\in (A,B]$,\u6ee1\u8db3$pre_i<A$\n   \n   \u90a3\u4e48\u6ee1\u8db3\u7684$x\\in (pre_i,A],y\\in [i,B]$\n\n   \u603b\u8d21\u732e\u4e3a$\\sum (A-pre_i)\\times(B-i+1)$\n\n   \u62c6\u4e0b\u5f0f\u5b50$(A\\sum 1-\\sum pre_i)(B+1)-A\\sum i+\\sum ipre_i$\n\n   \u53ef\u4ee5\u53d1\u73b0\u8fd9\u79cd\u60c5\u51b5\u53ef\u4ee5\u7528\u4e3b\u5e2d\u6811\u7ef4\u62a4\n\n## \u6811\u4e0a\u60c5\u51b5\n\n\u89c2\u5bdf\u6570\u636e\u5f62\u6210\u65b9\u5f0f:\n\n- \u524d$p$\u4e2a\u70b9\u5f62\u6210\u4e00\u6761\u4e3b\u94fe,\u5176\u4ed6\u70b9\u968f\u673a\u5411\u4e3b\u94fe\u8fde\u8fb9  \n  \u6240\u4ee5\u6811\u4e0a\u4efb\u610f\u70b9\u5bf9\u7684$\\texttt{lca}$\u8ddd\u79bb\u4ed6\u4eec\u671f\u671b\u4e3a$\\mathcal O(\\log n)$\n- \u6bcf\u4e2a\u70b9\u7684\u989c\u8272\u5728$[1,n]$\u4e2d\u968f\u673a,\u6bcf\u79cd\u989c\u8272\u6570\u76ee\u671f\u671b\u4e3a$1$\n\n\u4ee4$pre_i$\u4e3a$i$\u7684\u7956\u5148\u4e2d\u989c\u8272\u4e0e$i$\u76f8\u540c\u7684\u6df1\u5ea6\u6700\u5927\u7684\u70b9\n\n### \u7b2c\u4e00\u95ee\n\n\u8bbe$x$\u4e0e$y$\u4e2d$x$\u79bb$\\texttt{lca}(x,y)$\u66f4\u8fd1\n\n\u9996\u5148\u6c42\u51fa$y$\u5230$\\texttt{lca}$\u94fe\u4e0a\u7684\u989c\u8272\u603b\u6570,\n\n\u7136\u540e\u518d\u66b4\u529b\u679a\u4e3e$x$\u5230$\\texttt{lca}$\u94fe\u4e0a\u7684\u989c\u8272\u66f4\u65b0\u7b54\u6848\n\n### \u7b2c\u4e8c\u95ee\n\n\u8bbe$A$\u4e0e$B$\u4e2d$A$\u79bb$\\texttt{lca}(A,B)$\u66f4\u8fd1\n\n\u5206\u7c7b\u8ba8\u8bba:\n\n1. $x\\in [1,\\texttt{lca}],y\\in [1,B]$,\u4e0e\u94fe\u4e0a\u7684\u60c5\u51b5\u76f8\u540c\n2. $x\\in [\\texttt{lca},A],y\\in [1,\\texttt{lca}]$\n   \n   \u7528$x\\in [1,A],y\\in [1,\\texttt{lca}]$\u7684\u7b54\u6848\u51cf\u53bb\n   \n   $x,y\\in [1,\\texttt{lca})$\u7684\u7b54\u6848$\\sum (2(i-pre_i)(\\texttt{lca}-i)-1)$\n\n   \u62c6\u4e0b\u5f0f\u5b50: $2\\texttt{lca}\\sum (i-pre_i) - 2\\sum i(i-pre_i)-\\sum 1$\n\n3. $x\\in [\\texttt{lca},A],y\\in [\\texttt{lca},B]$\n   \n   \u5148\u6c42\u51fa$i\\in [\\texttt{lca,B}]$\u7684\u8d21\u732e$\\sum (B-i+1)(A-\\texttt{lca}+1)$\n\n   \u62c6\u4e0b\u5f0f\u5b50: $(A-\\texttt{lca}+1)(\\sum B+1 - \\sum i)$\n\n   \u7136\u540e\u7528$i\\in (\\texttt{lca},A]$\u66f4\u65b0\n\n   $pre_i\\le\\texttt{lca}$,\u8bbe$j$\u4e3a$[\\texttt{lca},B]$\u4e2d\u7b2c\u4e00\u4e2a\u4e0e\u5b83\u989c\u8272\u76f8\u540c\u7684\u70b9\n\n   \u8d21\u732e: $(A-i+1)(j-\\texttt{lca})$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing std::list;\ntypedef long long ll;\nconst int N=100011;\nint n,a[N];list<int>vec[N],e[N];\nint RT[N];\nstruct node{\n    ll v,pd,d,pdxd;// \u03a31,\u03a3dep[pre],\u03a3dep[i],\u03a3dep[pre]\u00d7dep[i]\n    node operator+(const node&t){return node{v+t.v,pd+t.pd,d+t.d,pdxd+t.pdxd};}\n    node operator-(const node&t){return node{v-t.v,pd-t.pd,d-t.d,pdxd-t.pdxd};}\n};\nstruct prt{\n\nint sz,ls[N*20],rs[N*20];\nnode s[N*20];\nvoid build(int&x,int l,int r){\n    s[x=++sz]=node{0,0,0,0};\n    if(l==r)return;\n    int m=l+r>>1;\n    build(ls[x],l,m);build(rs[x],m+1,r);\n}\nvoid ins(int&x,int pre,int p,int l,int r,node v){\n    s[x=++sz]=s[pre]+v;\n    if(l==r)return;\n    ls[x]=ls[pre],rs[x]=rs[pre];\n    int m=l+r>>1;\n    if(p<=m)ins(ls[x],ls[pre],p,l,m,v);\n    else ins(rs[x],rs[pre],p,m+1,r,v);\n}\nnode ask(int x,int y,int R,int l,int r){\n    if(r<=R)return s[y]-s[x];\n    int m=l+r>>1;\n    node ans=ask(ls[x],ls[y],R,l,m);\n    return R>m?ans+ask(rs[x],rs[y],R,m+1,r):ans;\n}\n\n}T;\nint L[N],R[N],dfn,st[20][N*2];\nint f[N],d[N],pre[N],b[N];ll sum[N][2];\nvoid dfs(int x){\n    st[0][L[x]=++dfn]=x;\n    pre[x]=b[a[x]],b[a[x]]=x;\n    T.ins(RT[x],RT[f[x]],pre[x],0,n,node{\n        1,d[pre[x]],d[x],1ll*d[pre[x]]*d[x]\n    });\n    sum[x][0]=d[x]-d[pre[x]]+sum[f[x]][0];\n    sum[x][1]=1ll*(d[x]-d[pre[x]])*d[x]+sum[f[x]][1];\n\n    for(int to:e[x])d[to]=d[x]+1,dfs(to),st[0][++dfn]=x;\n    R[x]=dfn;\n    b[a[x]]=pre[x];\n}\nint gmd(int x,int y){return d[x]<d[y]?x:y;}\nvoid ST(){\n    for(int k=1;(1<<k)<=dfn;++k)\n        for(int i=1;i<=dfn-(1<<k)+1;++i)\n            st[k][i]=gmd(st[k-1][i],st[k-1][i+(1<<k-1)]);\n}\nvoid swap(int&x,int&y){int t=x;x=y;y=t;}\nint lca(int x,int y){\n    int l=L[x],r=L[y];\n    if(l>r)swap(l,r);\n    int k=log2(r-l+1);\n    return gmd(st[k][l],st[k][r-(1<<k)+1]);\n}\nint v[N],ti;\nbool chk(int x,int y,int p){\n    return L[x]<=L[p]&&L[p]<=R[x]&&L[p]<=L[y]&&L[y]<=R[p];\n}\nll ask1(int x,int y){\n    if(d[x]>d[y])swap(x,y);\n    int F=lca(x,y);\n    ll ans=T.ask(RT[f[F]],RT[y],d[F]-1,0,n).v;\n    ++ti;\n    for(int i=x;i!=F;i=f[i])if(v[a[i]]!=ti){\n        v[a[i]]=ti;\n        bool ff=1;\n        for(int j:vec[a[i]])\n            if(chk(F,y,j)){ff=0;break;}\n        ans+=ff;\n    }\n    return ans;\n}\nll calc(int A,int B,node t){// i\u2208[1,A],i\u2208(A,B]\n    return (d[A]+d[B]+2)*sum[A][0]-2*sum[A][1]-d[A]+\n        (d[A]*t.v-t.pd)*(d[B]+1)-d[A]*t.d+t.pdxd;\n}\nll ask2(int A,int B){\n    if(d[A]>d[B])swap(A,B);\n    int F=lca(A,B);\n    node FA=T.ask(RT[f[F]],RT[A],d[F]-1,0,n),\n        FB=T.ask(RT[f[F]],RT[B],d[F]-1,0,n);\n    ll ans=calc(f[F],B,FB) // x\u2208[1,lca],y\u2208[1,B]\n        +calc(f[F],A,FA);  // x\u2208[1,A],y\u2208[1,lca]\n    ans-=2*(d[F]*sum[f[F]][0]-sum[f[F]][1])-(d[F]-1);// - x,y\u2208[1,lca)\n    ans+=(d[A]-d[F]+1)*((d[B]+1)*FB.v-FB.d);// i\u2208[lca,B]\n    list<int>sta;\n    for(int i=A;i!=F;i=f[i])sta.push_back(i);\n    ++ti;\n    while(!sta.empty()){// i\u2208(lca,A]\n        int i=sta.back();sta.pop_back();\n        if(v[a[i]]!=ti){\n            v[a[i]]=ti;\n            int mi=d[B]+1;\n            for(int j:vec[a[i]])\n                if(chk(F,B,j)&&d[j]<mi)mi=d[j];\n            ans+=ll(d[A]-d[i]+1)*(mi-d[F]);\n        }\n    }\n    return ans;\n}\nunsigned int SA,SB,SC;\nunsigned int rng61(){SA^=SA<<16;SA^=SA>>5;SA^=SA<<1;unsigned int t=SA;SA=SB;SB=SC;SC^=t^SA;return SC;}\nvoid solve(){\n    int q,p,x,y;\n    scanf(\"%d%d%u%u%u%d\",&n,&p,&SA,&SB,&SC,&q);\n    for(int i=2;i<=n;++i)\n        e[f[i]=i>p?rng61()%(i-1)+1:i-1].push_back(i);\n    for(int i=1;i<=n;++i)vec[a[i]=rng61()%n+1].push_back(i);\n    T.build(RT[0],0,n);\n    d[1]=1,dfs(1);ST();\n    while(q--)\n        scanf(\"%d%d%d\",&p,&x,&y),\n        printf(\"%lld\\n\",p==1?ask1(x,y):ask2(x,y));\n    dfn=T.sz=0;\n    for(int i=1;i<=n;++i)\n        vec[i].clear(),e[i].clear(),\n        RT[i]=v[i]=b[i]=0;\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--)solve();\n}\n```\n", "link": "/posts/LG 4618 [SDOI2018]\u539f\u9898\u8bc6\u522b/", "tags": ["\u4e3b\u5e2d\u6811", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1972 [SDOI2009]HH\u7684\u9879\u94fe", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1972&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P1972\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n<!--no more -->\n## \u89e3\u6cd5\n\n\u8bb0\u5f55\u6bcf\u4e2a\u70b9$i$\u524d\u4e00\u4e2a\u4e0e\u5b83\u4e00\u6837\u7684\u4f4d\u7f6e$pre_i$,\n\n\u90a3\u4e48\u533a\u95f4$[l,r]$\u5185\u4e0d\u540c\u7684\u4e2a\u6570\u4e5f\u5c31\u662f$[l,r]$\u4e2d$pre_i<l$\u7684\u4e2a\u6570\n\n## \u4e3b\u5e2d\u6811\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000011;\nint n,q,lst[N],RT[N],sz,s[N*20],ls[N*20],rs[N*20];\nvoid build(int&x,int l,int r){\n    x=++sz;\n    if(l==r)return;\n    int m=l+r>>1;\n    build(ls[x],l,m);build(rs[x],m+1,r);\n}\nvoid ins(int&x,int pre,int p,int l,int r){\n    s[x=++sz]=s[pre]+1;\n    if(l==r)return;\n    ls[x]=ls[pre],rs[x]=rs[pre];\n    int m=l+r>>1;\n    if(p<=m)ins(ls[x],ls[pre],p,l,m);\n    else ins(rs[x],rs[pre],p,m+1,r);\n}\nint ask(int x,int y,int R,int l,int r){\n    if(r<=R)return s[y]-s[x];\n    int m=l+r>>1;\n    return ask(ls[x],ls[y],R,l,m)+(R>m?ask(rs[x],rs[y],R,m+1,r):0);\n}\nvoid read(int&x){\n    x=0;char c=getchar();\n    for(;c<'0'||'9'<c;c=getchar());\n    for(;'0'<=c&&c<='9';c=getchar())x=x*10+c-48;\n}\nint main(){\n    read(n);\n    int x,l,r;\n    build(RT[0],1,n);\n    for(int i=1;i<=n;++i)\n        read(x),\n        ins(RT[i],RT[i-1],lst[x]+1,1,n),\n        lst[x]=i;\n    read(q);\n    while(q--)\n        read(l),read(r),\n        printf(\"%d\\n\",ask(RT[l-1],RT[r],l,1,n));\n}\n```\n\n\u4e3b\u5e2d\u6811\u7406\u8bba\u4e0a\u662f\u53ef\u4ee5\u8fc7\u7684,\u53ef\u662f\u4e3a\u4e86\u5361\u83ab\u961f,\u4e3b\u5e2d\u6811\u4e5fTLE\u4e86\n\nR.I.P\n\n## \u6811\u72b6\u6570\u7ec4\n\n\u8fd8\u662f\u6c42$[l,r]$\u4e2d$pre_i<l$\u7684\u4e2a\u6570\n\n\u79bb\u7ebf\u5904\u7406\n\n\u8be2\u95ee\u6309\u53f3\u7aef\u70b9\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\n\n\u679a\u4e3e\u533a\u95f4,\u5c06$[1,r]$\u4e2d\u7684\u70b9,$i$\u4f4d\u7f6e$+1$,$pre_i$\u4f4d\u7f6e$-1$($i$\u4e4b\u524d$pre_i$\u5df2\u7ecf\u8d21\u732e\u8fc7\u4e86)\n\n\u90a3\u4e48$r$\u51cf\u53bb$l-1$\u7684\u524d\u7f00\u548c\u5c31\u662f\u7b54\u6848\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000011;\nint n,m,pre[N],lst[N],s[N],ans[N];\nvoid add(int x,int v){\n    for(;x<=n;x+=x&-x)s[x]+=v;\n}\nint ask(int x){\n    int res=0;\n    for(;x;x-=x&-x)res+=s[x];\n    return res;\n}\nvoid read(int&x){\n    x=0;char c=getchar();\n    for(;'0'<c||c<'9';c=getchar());\n    for(;'0'<=c&&c<='9';c=getchar())x=x*10+c-48;\n}\nstruct que{\n    int l,r,id;\n    bool operator<(const que&t)const{\n        return r<t.r;\n    }\n}q[N];\nint main(){\n    scanf(\"%d\",&n);\n    int x;\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\",&x),\n        pre[i]=lst[x]?lst[x]:n+1,\n        lst[x]=i;\n    scanf(\"%d\",&m);\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d\",&q[i].l,&q[i].r),\n        q[i].id=i;\n    std::sort(q+1,q+m+1);\n    for(int i=1,j=1;i<=m;++i){\n        for(;j<=q[i].r;++j)\n            add(j,1),add(pre[j],-1);\n        ans[q[i].id]=ask(q[i].r)-ask(q[i].l-1);\n    }\n    for(int i=1;i<=m;++i)\n        printf(\"%d\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG 1972 [SDOI2009]HH\u7684\u9879\u94fe/", "tags": ["\u4e3b\u5e2d\u6811", "\u6811\u72b6\u6570\u7ec4", "\u79bb\u7ebf", "\u6811\u72b6\u6570\u7ec4", "\u83ab\u961f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LOJ 3087\u300cGXOI or GZOI2019\u300d\u65c5\u884c\u8005", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://loj.ac/problem/3087\u300cGXOI&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://loj.ac/problem/3087\u300cGXOI\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u4f20\u7edf\u89e3\u6cd5\n\n\u66b4\u529b\u7684\u601d\u8def\u662f\u6c42\u51fa$k$\u4e2a\u70b9\u4e24\u4e24\u4e4b\u95f4\u6700\u77ed\u8def\u5f84\n\n\u6211\u4eec\u53ef\u4ee5\u6309\u4e8c\u8fdb\u5236\u9010\u4f4d\u5bf9$k$\u4e2a\u70b9\u67d3\u8272(\u8be5\u4f4d\u4e3a$1$\u67d3\u4e3a\u9ed1\u8272,\u5426\u5219\u67d3\u4e3a\u767d\u8272)\n\n\u6bcf\u6b21\u6c42\u51fa\u9ed1\u70b9\u5230\u767d\u70b9\u7684\u6700\u77ed\u8ddd\u79bb,\u66f4\u65b0\u7b54\u6848\n\n\u8fd9\u6837\u53ef\u4ee5\u4fdd\u8bc1$k$\u70b9\u4e2d\u6bcf\u5bf9\u70b9 \u81f3\u5c11\u6709\u4e00\u6b21\u88ab\u5206\u522b\u67d3\u8272\u4e3a\u9ed1\u548c\u767d\n\n\u590d\u6742\u5ea6$n \\log n \\log k$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=100011,M=500011;\nint n,m,k,a[N],cnt,head[N];\nll d[N],ans;\nstruct edge{int to,nxt,w;}e[M];\nvoid add(int x,int y,int w){e[++cnt].to=y,e[cnt].nxt=head[x],head[x]=cnt,e[cnt].w=w;}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nstruct node{\n    int x;ll d;\n    bool operator<(const node&t)const{return d>t.d;}\n};\nbool vis[N];\nstd::priority_queue<node>q;\nvoid dij(int t){\n    for(int i=1;i<=n;++i)d[i]=-1ull>>1;\n    memset(vis,0,sizeof vis);\n    for(int i=1;i<=k;++i)if(i&t)\n        q.push((node){a[i],d[a[i]]=0});\n    while(!q.empty()){\n        int x=q.top().x;q.pop();\n        if(vis[x])continue;\n        vis[x]=1;\n        fl(i,x)if(d[x]+e[i].w<d[to])\n            q.push((node){to,d[to]=d[x]+e[i].w});\n    }\n    for(int i=1;i<=k;++i)if(!(i&t))\n        if(d[a[i]]<ans)ans=d[a[i]];\n}\nvoid solve(){\n    scanf(\"%d%d%d\",&n,&m,&k);\n    int x,y,w;\n    memset(head,0,sizeof head);cnt=0;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d%d\",&x,&y,&w),add(x,y,w);\n    for(int i=1;i<=k;++i)scanf(\"%d\",a+i);\n    ans=-1ull>>1;\n    for(int i=log2(k);~i;--i)dij(1<<i);\n    printf(\"%lld\\n\",ans);\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--)solve();\n}\n```\n\n## \u89e3\u6cd5\u4e8c\n\n\u5bf9\u6bcf\u4e2a\u70b9,\u6c42\u51fa\u80fd\u5230\u8fbe\u5b83\u7684\u6700\u8fd1\u7684\u611f\u5174\u8da3\u7684\u57ce\u5e02$f_i$,\u8ddd\u79bb\u8bbe\u4e3a$a_i$\n\n\u4e0e\u5b83\u80fd\u5230\u8fbe\u7684\u79bb\u5b83\u6700\u8fd1\u7684\u611f\u5174\u8da3\u7684\u57ce\u5e02$g_i$,\u8ddd\u79bb\u8bbe\u4e3a$b_i$\n\n\u90a3\u4e48\u6bcf\u6761\u8fb9$(u,v,w)$\u7684\u8d21\u732e\u5c31\u662f$a_u+w+b_v$,\u7528\u8fd9\u4e2a\u503c\u66f4\u65b0\u7b54\u6848\u5373\u53ef\n\n\u590d\u6742\u5ea6$n\\log n$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=100011,M=500011;\nint n,m,k,a[N],u[M],v[M],w[M],cnt,head[N],f[N],g[N];\nll c[N],d[N];\nstruct edge{int to,nxt,w;}e[M];\nvoid add(int x,int y,int w){e[++cnt].to=y,e[cnt].nxt=head[x],head[x]=cnt,e[cnt].w=w;}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nstruct node{\n    int x;ll d;\n    bool operator<(const node&t)const{return d>t.d;}\n};\nbool vis[N];\nvoid dij(bool opt){\n    std::priority_queue<node>q;\n    for(int i=1;i<=n;++i)d[i]=-1ull>>1;\n    memset(vis,0,sizeof vis);\n    memset(f,0,sizeof f);\n    memset(head,0,sizeof head);cnt=0;\n    for(int i=1;i<=m;++i)\n        if(opt)add(v[i],u[i],w[i]);\n        else add(u[i],v[i],w[i]);\n    for(int i=1;i<=k;++i)\n        f[a[i]]=a[i],\n        q.push((node){a[i],d[a[i]]=0});\n    while(!q.empty()){\n        int x=q.top().x;q.pop();\n        if(vis[x])continue;\n        vis[x]=1;\n        fl(i,x)if(d[x]+e[i].w<d[to])\n            f[to]=f[x],\n            q.push((node){to,d[to]=d[x]+e[i].w});\n    }\n}\nvoid cmin(ll&x,ll y){if(y<x)x=y;}\nvoid solve(){\n    memset(c,0,sizeof c);\n    memset(g,0,sizeof g);\n    scanf(\"%d%d%d\",&n,&m,&k);\n    for(int i=1;i<=m;++i)scanf(\"%d%d%d\",u+i,v+i,w+i);\n    for(int i=1;i<=k;++i)scanf(\"%d\",a+i);\n    dij(0);\n    for(int i=1;i<=n;++i)\n        c[i]=d[i],g[i]=f[i];\n    dij(1);\n    ll ans=-1ull>>1;\n    for(int i=1;i<=m;++i)\n        if(g[u[i]]&&f[v[i]]&&g[u[i]]!=f[v[i]])\n            cmin(ans,c[u[i]]+d[v[i]]+w[i]);\n    printf(\"%lld\\n\",ans);\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--)solve();\n}\n```\n", "link": "/posts/LOJ 3087\u300cGXOI or GZOI2019\u300d\u65c5\u884c\u8005/", "tags": ["\u56fe\u8bba", "\u6700\u77ed\u8def"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4841 [\u96c6\u8bad\u961f\u4f5c\u4e1a2013]\u57ce\u5e02\u89c4\u5212", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4841&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4841\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$g(n)$\u4e3a\u70b9\u6570\u4e3a$n$\u7684\u65e0\u5411\u56fe\u4e2a\u6570\n\n$g(n)=2^{n\\choose 2}$\n\n\u8bbe$f(n)$\u4e3a\u70b9\u6570\u4e3a$n$\u7684\u7b80\u5355\u65e0\u5411\u8fde\u901a\u56fe\u7684\u6570\u91cf\n\n\u679a\u4e3e\u8fde\u901a\u5757\u4e2a\u6570$i$\u53ef\u5f97\n\n$\\displaystyle g(n)=\\sum_{i=0}^n \\frac{f(i)}{i!}$\n\n\u53d1\u73b0\u8fd9\u4e2a\u5f62\u5f0f\u5f88\u773c\u719f(\u751f\u6210\u51fd\u6570):\n\n$g=e^f$\n\n\u90a3\u4e48$f=\\ln g$\n\n\u6c42\u51fa$g$\u540e$\\ln$\u5c31\u53ef\u4ee5\u5f97\u5230$f$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1<<18,P=1004535809;\ntypedef long long ll;\nint n;\nvoid mod(int&x){if(x>=P)x-=P;}\ntemplate<class T>\nint pw(int x,T b){\n    int res=1;\n    for(;b;b>>=1,x=1ll*x*x%P)\n        if(b&1)res=1ll*res*x%P;\n    return res;\n}\n\nint inv(int x){return pw(x,P-2);}\nint L,r[N];\nvoid getL(int n){\n    for(L=1;L<n;L<<=1);\n    for(int i=0;i<L;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)?(L>>1):0);\n}\nvoid swap(int&x,int&y){int t=x;x=y;y=t;}\nconst int G=3,Gi=inv(G);\nvoid ntt(int*A,int typ){\n    for(int i=0;i<L;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<L;len<<=1){\n        int Wn=pw(~typ?G:Gi,(P-1)/(len<<1));\n        for(int i=0;i<L;i+=len<<1)\n            for(int k=0,w=1;k<len;++k,w=1ll*w*Wn%P){\n                int t=1ll*w*A[i+k+len]%P;\n                mod(A[i+k+len]=A[i+k]-t+P);\n                mod(A[i+k]+=t);\n            }\n    }\n    if(~typ)return;\n    for(int i=0,il=inv(L);i<L;++i)A[i]=1ll*A[i]*il%P;\n}\nvoid mul(int*A,int*B,int*C,int n){\n    static int a[N],b[N];\n    getL(n<<1);\n    memcpy(a,A,n*4),memcpy(b,B,n*4);\n    memset(a+n,0,(L-n)*4),memset(b+n,0,(L-n)*4);\n    ntt(a,1),ntt(b,1);\n    for(int i=0;i<L;++i)C[i]=1ll*a[i]*b[i]%P;\n    ntt(C,-1);\n    memset(C+n,0,(L-n)*4);\n}\nvoid inv(int*A,int*B,int n){\n    if(n==1)return B[0]=inv(A[0]),void();\n    inv(A,B,(n+1)>>1);\n    getL(n<<1);\n    static int C[N];\n    memcpy(C,A,n*4);memset(C+n,0,(L-n)*4);\n    ntt(B,1);ntt(C,1);\n    for(int i=0;i<L;++i)\n        B[i]=1ll*B[i]*(2-1ll*B[i]*C[i]%P+P)%P;\n    ntt(B,-1);\n    memset(B+n,0,(L-n)*4);\n}\nvoid dvt(int*A,int*B,int n){\n    for(int i=1;i<n;++i)\n        B[i-1]=1ll*i*A[i]%P;\n    B[n-1]=0;\n}\nvoid itr(int*A,int*B,int n){\n    for(int i=1;i<n;++i)\n        B[i]=1ll*inv(i)*A[i-1]%P;\n    B[0]=0;\n}\nvoid ln(int*A,int*B,int n){\n    static int a[N],b[N],B_[N];\n    memset(b,0,n*4);\n    dvt(A,a,n),inv(A,b,n);\n    mul(a,b,B_,n);\n    itr(B_,B,n);\n}\nint main(){\n    scanf(\"%d\",&n);++n;\n    static int g[N],f[N],fac[N];\n    getL(n);\n    fac[0]=1;\n    for(int i=1;i<n;++i)fac[i]=1ll*fac[i-1]*i%P;\n    g[0]=1;\n    for(int i=1;i<n;++i)g[i]=1ll*pw(2,1ll*i*(i-1)/2%(P-1))*inv(fac[i])%P;\n    ln(g,f,n);\n    printf(\"%d\\n\",1ll*f[n-1]*fac[n-1]%P);\n}\n```\n", "link": "/posts/LG 4841 [\u96c6\u8bad\u961f\u4f5c\u4e1a2013]\u57ce\u5e02\u89c4\u5212/", "tags": ["\u591a\u9879\u5f0f", "\u6570\u8bba", "ntt", "\u591a\u9879\u5f0f\u6c42\u9006", "\u751f\u6210\u51fd\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3723 [AH2017]\u793c\u7269", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3723&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3723\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ed9\u4e24\u4e2a\u624b\u73af\u540c\u65f6\u589e\u52a0\u4eae\u5ea6,\u4e0e\u7ed9\u5176\u4e2d\u4e00\u4e2a\u589e/\u51cf\u4eae\u5ea6\u662f\u4e00\u6837\u7684\n\n\u540c\u65f6\u65cb\u8f6c\u4e24\u4e2a\u624b\u73af,\u65cb\u8f6c\u5176\u4e2d\u4e00\u4e2a\u662f\u4e00\u6837\u7684\n\n\u8bbe\u65cb\u8f6c\u540e\u4e24\u4e2a\u624b\u73af\u5206\u522b\u4e3a$a,b$,\u5176\u4e2d\u4e00\u4e2a\u52a0\u4e0a$x$\n\n\u90a3\u4e48\u5c31\u662f\u8ba9$\\sum_{i=1}^n (a_i-b_{i}+x)^2$\u6700\u5c0f\n\n$\\displaystyle\n\\sum_{i=1}^n (a_i-b_{i}+x)^2\\\\\n=\\sum_{i=1}^n a_i^2+\\sum_{i=1}^n b_i^2+nx^2+2x(\\sum_{i=1}^n a_i-b_i)-2\\sum_{i=1}^n a_ib_i\n$\n\n\u5176\u4e2d\u53ea\u6709\u6700\u540e\u4e00\u9879\u662f\u53d8\u5316\u7684\uff0c\u524d\u51e0\u9879\u90fd\u53ef\u4ee5\u76f4\u63a5\u6c42\u5f97\n\n$nx^2+2x(\\sum_{i=1}^n a_i-b_i)$\u662f\u5173\u4e8e$x$\u7684\u4e8c\u6b21\u51fd\u6570,\u76f4\u63a5\u6c42\u5f97\u6700\u5c0f\u503c\n\n\u8003\u8651$\\sum_{i=1}^n a_ib_i$\n\n\u53ef\u4ee5\u53d1\u73b0$\\sum_{i=1}^n a_{n-i+1}b_i$\u662f\u5377\u79ef\u7684\u5f62\u5f0f\n\n\u90a3\u4e48\u6211\u4eec\u628a$a$\u500d\u957f,\u628a$b$\u7ffb\u8f6c,\u7136\u540e\u518d\u5377\u79ef,\u5f97\u5230$n+1$\u5230$2n$\u6b21\u9879\u4e2d\u7684\u6700\u5927\u503c\u5c31\u662f$\\sum_{i=1}^n a_ib_i$\u7684\u6700\u5927\u503c\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef double db;\ntypedef long long ll;\nconst int N=50011,M=1<<18;\nconst db Pi=acos(-1);\nint n,m;\nstruct cp{\n    db r,i;explicit cp(db R=0,db I=0){r=R,i=I;}\n    cp operator+(const cp&x)const{return cp(r+x.r,i+x.i);}\n    cp operator-(const cp&x)const{return cp(r-x.r,i-x.i);}\n    cp operator*(const cp&x)const{return cp(r*x.r-i*x.i,r*x.i+i*x.r);}\n}a[M],b[M];\nint L,r[M];\nvoid swap(cp&x,cp&y){cp t=x;x=y;y=t;}\nvoid getL(int n){\n    for(L=1;L<n;L<<=1);\n    for(int i=0;i<L;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)?(L>>1):0);\n}\nvoid fft(cp*A,int typ){\n    for(int i=0;i<L;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<L;len<<=1){\n        cp Wn(std::cos(Pi/len),typ*std::sin(Pi/len));\n        for(int i=0;i<L;i+=len<<1){\n            cp w(1);\n            for(int k=0;k<len;++k,w=w*Wn){\n                cp t=A[i+k+len]*w;\n                A[i+k+len]=A[i+k]-t;\n                A[i+k]=A[i+k]+t;\n            }\n        }\n    }\n    if(~typ)return;\n    for(int i=0;i<L;++i)\n        A[i].r/=L,A[i].i/=L;\n}\nvoid cmin(ll&x,ll y){if(y<x)x=y;}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    int x;\n    ll ans=1ll<<60,a1=0,a2=0,b1=0,b2=0;\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\",&x),\n        a1+=x,a2+=x*x,\n        a[i]=a[n+i]=cp(x);\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\",&x),\n        b1+=x,b2+=x*x,\n        b[n-i+1]=cp(x);\n    getL(n<<2);\n    fft(a,1),fft(b,1);\n    for(int i=0;i<L;++i)a[i]=a[i]*b[i];\n    fft(a,-1);\n    for(int i=1;i<=n;++i)\n        for(x=-m;x<=m;++x)\n            cmin(ans,a2+b2+1ll*n*x*x+2ll*x*(a1-b1)-2ll*ll(a[i+n].r+0.5));\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 3723 [AH2017]\u793c\u7269/", "tags": ["\u591a\u9879\u5f0f", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1349C Orac and Game of Life", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1349C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/CF1349C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u53d1\u73b0\uff0c\u6bcf\u6b21\u53d8\u5316\u540e\u53ea\u6709\u90a3\u4e9b\u5468\u56f4\u6709\u4e0e\u5b83\u540c\u8272\u7684\u683c\u5b50\u53d1\u751f\u53d8\u5316\n\n\u4e5f\u5c31\u662f\u8fde\u901a\u5757\u53d1\u751f\u53d8\u5316\n\n\u800c\u6bcf\u6b21\u8fde\u901a\u5757\u53d1\u751f\u53d8\u5316\uff0c\u53c8\u4f1a\u5e76\u5165\u4e00\u4e9b\u5355\u72ec\u7684\u683c\u5b50\n\n\u6211\u4eec\u53ea\u9700\u8981bfs\u627e\u51fa\u6bcf\u4e2a\u65b9\u5757\u4ec0\u4e48\u65f6\u5019\u88ab\u7eb3\u5165\u8fde\u901a\u5757\u5c31\u53ef\u4ee5\u4e86\n\n\u67e5\u8be2\u65f6\u5224\u65ad\u4e00\u4e0b\u5947\u5076\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1011,M=10000000;\nint n,m,k,dx[4]={0,1,0,-1},dy[4]={1,0,-1,0},ti[N][N];\nchar a[N][N];\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&k);\n    for(int i=1;i<=n;++i)scanf(\"%s\",a[i]+1);\n    static int p[N*N],q[N*N],h,t;\n    memset(ti,60,sizeof ti);\n    h=0,t=0;\n    for(int i=1;i<=n;++i)\n        for(int j=1;j<=m;++j){\n            bool tmp=0;\n            for(int k=0;k<3;++k)\n                tmp|=a[i][j]==a[i+dx[k]][j+dy[k]];\n            if(tmp)p[t]=i,q[t]=j,ti[i][j]=0,++t;\n        }\n    while(h<t){\n        int x=p[h],y=q[h++];\n        for(int i=0;i<3;++i){\n            int nx=x+dx[i],ny=y+dy[i];\n            if(nx<1||nx>n||ny<1||ny>m)continue;\n            if(ti[nx][ny]>M)\n                p[t]=nx,q[t]=ny,\n                ti[nx][ny]=ti[x][y]+1,\n                ++t;\n        }\n    }\n    while(k--){\n        int x,y;long long tim;\n        scanf(\"%d%d%lld\",&x,&y,&tim);\n        if(tim<ti[x][y])putchar(a[x][y]);\n        else putchar(a[x][y]^((tim-ti[x][y])&1));\n        putchar('\\n');\n    }\n}\n```\n", "link": "/posts/LG CF1349C Orac and Game of Life/", "tags": ["bfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF427C Checkposts", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF427C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/CF427C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u8bf4\u662f\u5f88\u6c34\u5427\n\n\u7f29\u70b9\u540e\u6bcf\u4e2a\u73af\u53ea\u9700\u8981\u73af\u4e0a\u6700\u5c0f\u7684\u8d39\u7528\u5c31\u53ef\u4ee5\u4fdd\u8bc1\u73af\u5b89\u5168\n\n\u4e00\u4e2a\u73af\u65b9\u6848\u6570\u4e3a\u73af\u4e0a\u6700\u5c0f\u503c\u7684\u6570\u91cf\n\n\u603b\u65b9\u6848\u6570\u4e3a\u6240\u6709\u73af\u65b9\u6848\u6570\u7684\u4e58\u79ef\n\n(\u4e00\u4e2a\u70b9\u4e5f\u7b97\u4e00\u4e2a\u73af)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011,P=1000000007;\nint n,m,cnt,a[N],head[N];\nstruct edge{int to,nxt;}e[N*3];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nint dfn[N],low[N],sz,st[N],tp,c[N],t[N];bool v[N];\nvoid cmin(int&x,int y){if(y<x)x=y;}\nlong long ans=0,ANS=1;\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;v[x]=1;st[++tp]=x;\n    fl(i,x)if(!dfn[to]){\n        tarjan(to);\n        cmin(low[x],low[to]);\n    }else if(v[to])\n        cmin(low[x],dfn[to]);\n    if(low[x]==dfn[x]){\n        int c=a[x],t=1,k;\n        while(k=st[tp--]){\n            v[k]=0;if(k==x)break;\n            if(a[k]<c)c=a[k],t=1;\n            else if(a[k]==c)++t;\n        }\n        ans+=c;ANS=ANS*t%P;\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i);\n    scanf(\"%d\",&m);\n    int x,y;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d\",&x,&y),add(x,y);\n    for(int i=1;i<=n;++i)\n        if(!dfn[i])tarjan(i);\n    printf(\"%lld %lld\\n\",ans,ANS);\n}\n```\n", "link": "/posts/LG CF427C Checkposts/", "tags": ["tarjan"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF803C Maximal GCD", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF803C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/CF803C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4ece\u5927\u5230\u5c0f\u679a\u4e3e$n$\u7684\u56e0\u5b50$x$\n\n\u5982\u679c\u80fd\u591f\u6ee1\u8db3\u90a3\u4e48$x+2x+\\dots+kx\\le n$\n\n$\nx(1+2+\\dots+k)\\le n\\\\\n\\dfrac{xk(1+k)}{2}\\le n\\\\\nxk(1+k)\\le 2n\n$\n\n\u5176\u4e2d$x\\le \\dfrac{2n}{k(1+k)}$\n\n\u627e\u5230\u6700\u5927\u7684$x$\u540e,\u6309\u987a\u5e8f\u8f93\u51fa$x,2x,\\dots+(k-1)x$,\u6700\u540e\u4e00\u4e2a\u6570\u4e3a$n$\u51cf\u53bb\u524d\u9762\u7684\u6570\u7684\u548c\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nint main(){\n    ll n,k;scanf(\"%lld%lld\",&n,&k);\n    ll l=n*2/k/(k+1),sqr=sqrt(n),x=1;\n    if(!l)return puts(\"-1\"),0;\n    for(ll i=1;i<=sqr&&i<=l;++i)if(n%i==0){\n        ll t=n/i;x=i;\n        if(t<=l){x=t;break;}\n    }\n    for(;x;--x)if(n%x==0){\n        for(ll now=x;n>=now*2+x&&--k;now+=x)\n            printf(\"%lld \",now),n-=now;\n        return printf(\"%lld\\n\",n),0;\n    }\n}\n```\n", "link": "/posts/LG CF803C Maximal GCD/", "tags": ["\u6570\u8bba", "gcd", "\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1184E3 Daleks' Invasion (hard)", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1184E3&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/CF1184E3\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9898\u610f: \u7ed9\u4e00\u9897\u6811\uff0c\u6bcf\u6761\u8fb9\u6743\u503c\u53ef\u4ee5\u4fee\u6539\u4e3a$x$,\u4f7f\u5f97\u4fee\u6539\u540e\u8fd9\u6761\u8fb9\u53ef\u4ee5\u5728\u6700\u5c0f\u751f\u6210\u6811\u4e0a,\u95ee$x$\u6700\u5927\u53ef\u4ee5\u662f\u591a\u5c11?\n\n\u9996\u5148\u6c42\u51fa\u6700\u5c0f\u751f\u6210\u6811(\u4ee5\u4e0b\u7684\u6811\u6307\u6700\u5c0f\u751f\u6210\u6811)\n\n\u4fee\u6539\u4e00\u6761\u8fb9\u65f6,\u82e5\u4e0d\u662f\u6700\u5c0f\u751f\u6210\u6811\u4e0a\u7684\u8fb9,\u5219\u4e3a\u6811\u4e0a\u8be5\u8fb9\u4e24\u7aef\u8282\u70b9\u4e4b\u95f4\u7684\u6700\u5927\u503c\n\n\u82e5\u662f\u6811\u4e0a\u7684\u8fb9,\u90a3\u4e48\u5c31\u662f\u8be5\u8fb9\u5b50\u6811\u4e2d\u627e\u51fa\u4e00\u4e9b\u975e\u6811\u8fb9(\u4f7f\u5b83\u4eec\u6700\u5927\u503c\u5c3d\u53ef\u80fd\u5c0f)\u8fde\u63a5\u9664\u5b50\u6811\u90e8\u5206\u7684\u70b9,\u7b54\u6848\u4e3a\u8be5\u8fb9\u6743\u503c\n\n\u770b\u4e0a\u53bb\u4e0d\u662f\u5f88\u597d\u5904\u7406\n\n\u6211\u4eec\u5c06\u975e\u6811\u8fb9\u6309\u6743\u503c\u4ece\u5c0f\u5230\u5927\u6392\u5e8f,\u4ece\u4e0b\u5f80\u4e0a\u5408\u5e76,\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u5373\u53ef\n\n\u6bcf\u6b21\u9047\u5230\u975e\u6811\u8fb9$x,y$\u65f6,\u5c31\u66f4\u65b0\u5e76\u5408\u5e76$x\\to \\text{lca}_{x,y},y\\to \\text{lca}_{x,y}$,\u4ece\u4e0b\u5f80\u4e0a\u8df3\u65f6,\u5e76\u67e5\u96c6\u53ef\u4ee5\u8df3\u8fc7\u5df2\u7ecf\u6253\u8fc7\u6807\u8bb0\u7684\u8fb9\n\n\u8be6\u89c1\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011,M=1000011;\nvoid swap(int&x,int&y){int t=x;x=y;y=t;}\nint max(int x,int y){return x>y?x:y;}\nvoid cmax(int&x,int y){if(y>x)x=y;}\nint n,m,cnt,head[N];\nstruct edge{int to,nxt,w;}e[N<<1];\nvoid add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\nstruct EDGE{\n    int x,y,w,id;\n    bool operator<(const EDGE&t)const{return w<t.w;}\n}E[M];bool b[M];\nint fa[N],mx[N];\nint gf(int x){return x==fa[x]?x:(fa[x]=gf(fa[x]));}\nint f[19][N],g[19][N],d[N],lca,mxe;\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nvoid dfs(int x,int fa){\n    f[0][x]=fa,d[x]=d[fa]+1;\n    for(int i=1;i<=18;++i)\n        f[i][x]=f[i-1][f[i-1][x]],\n        g[i][x]=max(g[i-1][x],g[i-1][f[i-1][x]]);\n    fl(i,x)if(to!=fa)\n        g[0][to]=e[i].w,dfs(to,x);\n}\nvoid gm(int x,int y){\n    lca=-1,mxe=-1000000;\n    if(d[x]<d[y])swap(x,y);\n    for(int i=18;~i;--i)\n        if(d[f[i][x]]>=d[y])\n            cmax(mxe,g[i][x]),x=f[i][x];\n    if(x==y)return lca=x,void();\n    for(int i=18;~i;--i)\n        if(f[i][x]!=f[i][y])\n            cmax(mxe,max(g[i][x],g[i][y])),\n            x=f[i][x],y=f[i][y];\n    return lca=f[0][x],cmax(mxe,max(g[0][x],g[0][y])),void();\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d%d\",&E[i].x,&E[i].y,&E[i].w),E[i].id=i;\n    std::sort(E+1,E+m+1);\n    for(int i=1;i<=n;++i)fa[i]=i;\n    for(int i=1,j=0;j<n-1;++i){\n        int x=E[i].x,y=E[i].y,w=E[i].w;\n        if(gf(x)!=gf(y))\n            b[i]=1,fa[gf(x)]=gf(y),\n            add(x,y,w),add(y,x,w),++j;\n    }\n    dfs(1,0);\n    for(int i=1;i<=n;++i)fa[i]=i,mx[i]=1000000000;\n    static int ans[M];\n    for(int i=1;i<=m;++i)if(!b[i]){\n        int x=E[i].x,y=E[i].y,w=E[i].w;\n        gm(x,y);\n        ans[E[i].id]=mxe;\n        while(d[gf(x)]>d[lca])\n            mx[fa[x]]=w,fa[fa[x]]=gf(f[0][fa[x]]);\n        while(d[gf(y)]>d[lca])\n            mx[fa[y]]=w,fa[fa[y]]=gf(f[0][fa[y]]);\n    }\n    for(int i=1;i<=m;++i)if(b[i])\n        ans[E[i].id]=mx[d[E[i].x]>d[E[i].y]?E[i].x:E[i].y];\n    for(int i=1;i<=m;++i)printf(\"%d\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG CF1184E3 Daleks' Invasion (hard)/", "tags": ["\u6700\u5c0f\u751f\u6210\u6811", "lca", "\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4247 [\u6e05\u534e\u96c6\u8bad2012]\u5e8f\u5217\u64cd\u4f5c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4247&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4247\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u53d1\u73b0\u67e5\u8be2\u7684$c\\le 20$,\u90a3\u4e48\u6211\u4eec\u76f4\u63a5\u5bf9\u6bcf\u4e2a\u8282\u70b9\u8bb0\u5f55\u6bcf\u4e2a$c$\u7684\u7b54\u6848\n\n## \u533a\u95f4\u52a0\n\n\u8bbe\u5f53\u524d\u533a\u95f4$a_1,a_2,\\dots,a_n$\n\n\u533a\u95f4\u52a0\u540e:$a_1+x,a_2+x,\\dots,a_n+x$\n\n\u9009\u53d6$i$\u4e2a\u65b9\u6848:\n\n$\n\\begin{aligned}\n&\\quad (a_1+x)(a_2+x)\\cdots(a_i+x)\\\\\n&=a_1a_2\\cdots a_i+xa_2a_3\\cdots a_i+x^2a_3a_4\\cdots a_i+\\dots\\\\\n&=a_1a_2\\cdots a_i+\\sum_{j=1}^ix^j \\left( \\text{\u4ecei\u4e2a\u6570\u4e2d\u53d6\u51fai-j\u4e2a\u6570\u7684\u4e58\u79ef\u4e4b\u548c} \\right)\n\\end{aligned}\n$\n\n\u8be5\u533a\u95f4\u53d6$i$\u4e2a\u6570\u7684\u4e58\u79ef\u4e4b\u548c\u589e\u52a0\u7684\u8d21\u732e:\n\n$\\displaystyle ans_i\\operatorname{+=}\\sum_{j=0}^i x^{i-j}ans_j{n-j\\choose i-j}$\n\n## \u533a\u95f4\u53cd\u8f6c\n\n\u9009\u53d6\u5947\u6570\u4e2a\u7684\u7b54\u6848\u53d8\u6210\u76f8\u53cd\u6570\n\n\u9009\u53d6\u5076\u6570\u4e2a\u7684\u7b54\u6848\u6ca1\u6709\u5f71\u54cd\n\n## \u533a\u95f4\u67e5\u8be2\n\n\u8bbe\u5f53\u524d\u7b54\u6848\u4e3a$ans$,\u5de6\u513f\u5b50\u7b54\u6848\u4e3a$l$,\u53f3\u513f\u5b50\u7b54\u6848\u4e3a$r$\n\n$\\displaystyle ans_i=\\sum_{j=0}^i l_j\\times r_{i-j}$\n\n(\u5de6\u8fb9\u9009$j$\u4e2a,\u53f3\u8fb9\u9009$i-j$\u4e2a)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=50011,P=19940417;\nint n,q,C[N][21];\nint min(int x,int y){return x<y?x:y;}\nvoid mod(int&x){if(x>=P)x-=P;}\nstruct node{\n    int len,laz,re,a[21];\n    node(){memset(a,0,sizeof a);len=laz=re=0;}\n    void add(int v){\n        static int t[21];t[0]=1;\n        for(int i=1;i<=20&&i<=len;++i)t[i]=1ll*t[i-1]*v%P;\n        for(int i=min(20,len);i;--i)\n            for(int j=0;j<i;++j)\n                mod(a[i]+=1ll*a[j]*t[i-j]%P*C[len-j][i-j]%P);\n        mod(laz+=v);\n    }\n    void rev(){\n        for(int i=1;i<=20&&i<=len;i+=2)a[i]=P-a[i];\n        laz=P-laz;\n        re^=1;\n    }\n}s[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\nvoid mg(node&s,const node&l,const node&r){\n    for(int i=0;i<=20&&i<=s.len;++i){\n        s.a[i]=0;\n        for(int j=0;j<=i;++j)\n            mod(s.a[i]+=1ll*l.a[j]*r.a[i-j]%P);\n    }\n}\nvoid pu(int rt){mg(s[rt],s[ls],s[rs]);}\nvoid pd(int rt){\n    if(s[rt].re)\n        s[ls].rev(),s[rs].rev(),\n        s[rt].re=0;\n    if(s[rt].laz)\n        s[ls].add(s[rt].laz),s[rs].add(s[rt].laz),\n        s[rt].laz=0;\n}\nvoid build(int l,int r,int rt){\n    s[rt].len=r-l+1;\n    if(l==r){\n        s[rt].a[0]=1;\n        int x;\n        scanf(\"%d\",&x);\n        mod(s[rt].a[1]=x%P+P);\n        return;\n    }\n    int m=l+r>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu(rt);\n}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt].add(v),void();\n    int m=l+r>>1;\n    pd(rt);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    pu(rt);\n}\nvoid Rev(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt].rev(),void();\n    int m=l+r>>1;\n    pd(rt);\n    if(L<=m)Rev(L,R,l,m,ls);\n    if(R>m)Rev(L,R,m+1,r,rs);\n    pu(rt);\n}\nnode ask(int L,int R,int l,int r,int rt){\n    if(L==l&&r==R)return s[rt];\n    int m=l+r>>1;\n    pd(rt);\n    if(L>m)return ask(L,R,m+1,r,rs);\n    else if(R<=m)return ask(L,R,l,m,ls);\n    else{\n        node s,sl=ask(L,m,l,m,ls),sr=ask(m+1,R,m+1,r,rs);\n        s.len=sl.len+sr.len;\n        mg(s,sl,sr);\n        return s;\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    C[0][0]=1;\n    for(int i=1;i<=n;++i){\n        C[i][0]=1;\n        for(int j=1;j<=20&&j<=i;++j)\n            mod(C[i][j]=C[i-1][j]+C[i-1][j-1]);\n    }\n    build(1,n,1);\n    char opt[5];int l,r,c;\n    while(q--){\n        scanf(\"%s%d%d\",opt,&l,&r);\n        if(opt[0]=='R')\n            Rev(l,r,1,n,1);\n        else if(opt[0]=='I')\n            scanf(\"%d\",&c),\n            mod(c=c%P+P),\n            upd(l,r,c,1,n,1);\n        else\n            scanf(\"%d\",&c),\n            printf(\"%d\\n\",ask(l,r,1,n,1).a[c]);\n    }\n}\n```\n", "link": "/posts/LG 4247 [\u6e05\u534e\u96c6\u8bad2012]\u5e8f\u5217\u64cd\u4f5c/", "tags": ["\u7ebf\u6bb5\u6811", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF379F New Year Tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF379F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/CF379F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6bcf\u6b21\u7ed9\u4e00\u4e2a\u53f6\u5b50\u8282\u70b9\u6dfb\u52a0\u4e24\u4e2a\u513f\u5b50,\u800c\u8fd9\u4e2a\u53f6\u5b50\u8282\u70b9\u80fd\u5230\u8fbe\u7684\u6700\u8fdc\u7684\u70b9\uff0c\u4e5f\u5c31\u662f\u4e0a\u4e00\u6b21\u6c42\u5f97\u7684\u76f4\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9\u4e4b\u4e00\n\n\u90a3\u4e48\u6bcf\u6dfb\u52a0\u4e00\u4e2a\u70b9\u66f4\u65b0\u6539\u70b9\uff0c\u6bd4\u8f83\u76f4\u5f84\u4e0e\u8be5\u70b9\u5230\u4e4b\u524d\u76f4\u5f84\u4e24\u7aef\u7684\u8ddd\u79bb\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000011;\nint q,cnt=1,d[N],A=2,B=3,R=2,f[21][N];\nvoid swap(int&x,int&y){int t=x;x=y;y=t;}\nint lca(int x,int y){\n    if(d[x]<d[y])swap(x,y);\n    for(int k=20;~k;--k)\n        if(d[f[k][x]]>=d[y])x=f[k][x];\n    if(x==y)return y;\n    for(int k=20;~k;--k)\n        if(f[k][x]!=f[k][y])\n            x=f[k][x],y=f[k][y];\n    return f[0][x];\n}\nint dis(int x,int y){return d[x]+d[y]-2*d[lca(x,y)];}\nint ne(int x){\n    d[++cnt]=d[x]+1;f[0][cnt]=x;\n    for(int i=1;i<=20;++i)\n        f[i][cnt]=f[i-1][f[i-1][cnt]];\n    return cnt;\n}\nvoid work(int x){\n    int Ax=dis(A,x),Bx=dis(B,x);\n    if(Ax>R)R=Ax,B=x;\n    if(Bx>R)R=Bx,A=x;\n}\nint main(){\n    scanf(\"%d\",&q);\n    ne(1),ne(1),ne(1);\n    int x;\n    while(q--){\n        scanf(\"%d\",&x);\n        work(ne(x)),work(ne(x));\n        printf(\"%d\\n\",R);\n    }\n}\n```\n", "link": "/posts/LG CF379F New Year Tree/", "tags": ["\u6811\u7684\u76f4\u5f84", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF442C Artem and Array", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF442C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/CF442C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u4e2a\u6570\u5982\u679c\u4e24\u8fb9\u7684\u6570\u90fd\u6bd4\u5b83\u5927\uff0c\u90a3\u4e48\u5220\u6389\u5b83\u662f\u6700\u4f18\u7684\n\n\u90a3\u4e48\u7528\u5355\u8c03\u6808\u7ef4\u62a4\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=500011;\nint n,a[N],b[N],q[N],tp;long long ans;\nint min(int x,int y){return x<y?x:y;}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i){\n        scanf(\"%d\",a+i);\n        while(tp>=2&&a[i]>=a[q[tp]]&&a[q[tp]]<=a[q[tp-1]])\n            ans+=min(a[q[--tp]],a[i]);\n        q[++tp]=i;\n    }\n    for(int i=1;i<=tp;++i)b[i]=a[q[i]];\n    std::sort(b+1,b+tp+1);\n    for(int i=1;i<=tp-2;++i)ans+=b[i];\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG CF442C Artem and Array/", "tags": ["\u5355\u8c03\u6808", "\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 6046 \u7eaf\u7cb9\u5bb9\u5668", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P6046&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P6046\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6bcf\u4e2a\u5bb9\u5668$x$\u6c42\u51fa\u5b83\u5b58\u6d3b\u8f6e\u6570\u7684\u671f\u671b\u53ef\u4ee5\u8868\u793a\u4e3a\n\n$$\\sum_{i=1}^{n-1}P(x_i)$$\n\n$x_i$\u8868\u793a\u7b2c$x$\u4e2a\u5bb9\u5668\u5230\u7b2c$i$\u8f6e\u4ecd\u672a\u88ab\u51fb\u5012\n\n\u8bb0\u5f55$L_i$\u4e3a$i$\u5de6\u8fb9\u7b2c\u4e00\u4e2a\u6bd4\u5b83\u5927\u7684\u6570\u7684\u4f4d\u7f6e,$R_i$\u4e3a$i$\u53f3\u8fb9\u7b2c\u4e00\u4e2a\u6bd4\u5b83\u5927\u7684\u6570\u7684\u4f4d\u7f6e\n\n\u6bcf\u4e2a\u5bb9\u5668$i$\u88ab\u51fb\u5012\u7684\u65f6\u5019\u4e5f\u5c31\u662f$[L_i,i]$\u6216$[i,R_i]$\u7684\u5bb9\u5668\u90fd\u88ab\u9009\u4e2d\n\n\u8bbe$P(A)$\u8868\u793a$[L_i,i]$\u5168\u88ab\u9009\u4e2d,$P(B)$\u8868\u793a$[i,R_i]$\u5168\u90e8\u88ab\u9009\u4e2d,$l=i-L_i,r=R_i-i$,\n\n$\\displaystyle\n\\begin{aligned}\nP(x_i)\n&=1-P(A)-P(B)+P(AB)\\\\\n&=1-\\frac{{n-1-l \\choose i-l}-{n-1-r\\choose i-r}+{n-1-l-r\\choose i-l-r}}{n-1\\choose i}\n\\end{aligned}\n$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=55,P=998244353;\nint n,a[N],L[N],R[N],q[N],tp,C[N][N];\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%P;\n        b>>=1,x=1ll*x*x%P;\n    }\n    return res;\n}\nint inv(int x){return pw(x,P-2);}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i){\n        scanf(\"%d\",a+i);\n        while(tp&&a[i]>a[q[tp]])R[q[tp--]]=i;\n        L[i]=q[tp];q[++tp]=i;\n    }\n    C[0][0]=1;\n    for(int i=1;i<=n;++i){\n\t\tC[i][0]=1;\n\t\tfor (int j=1;j<=i;++j)\n\t\t\tC[i][j]=(C[i-1][j]+C[i-1][j-1])%P;\n\t}\n    for(int x=1;x<=n;++x){\n        int res=0,l=x-L[x],r=R[x]-x;\n        if(!L[x])l=0;if(!R[x])r=0;\n        long long ce;\n        for(int i=1;i<n;++i){\n            ce=\n                (l?C[n-1-l][i-l]:0)+\n                (r?C[n-1-r][i-r]:0)-\n                (l&&r&&i-l-r>=0?C[n-1-l-r][i-l-r]:0);\n            ce=1ll*(ce%P+P)%P*inv(C[n-1][i])%P;\n            res=(res+1-ce+P)%P;\n        }\n        printf(\"%d \",res);\n    }\n}\n```\n", "link": "/posts/LG 6046 \u7eaf\u7cb9\u5bb9\u5668/", "tags": ["\u671f\u671b"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3304 [SDOI2013]\u76f4\u5f84", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3304&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3304\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u4e24\u6b21dfs\u627e\u51fa\u4efb\u610f\u4e00\u6761\u76f4\u5f84\n\n\u8bbe\u76f4\u5f84\u4e3a\u5e8f\u5217$A$,$L_i$\u4e3a\u70b9$i$\u5230\u76f4\u5f84\u5de6\u7aef\u7684\u8ddd\u79bb,$R_i$\u4e3a\u70b9$i$\u4e3a$i$\u5230\u76f4\u5f84\u53f3\u7aef\u7684\u8ddd\u79bb\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u6761\u76f4\u5f84\u628a\u6811\u5206\u5272\u6210\u4e86\u82e5\u5e72\u68f5\u5b50\u6811,\u76f4\u5f84\u4e0a\u6bcf\u4e2a\u70b9\u5bf9\u5e94\u4e00\u9897\u5b50\u6811\n\n\u8bbe$mxd_i$\u4e3a$i$\u70b9\u5bf9\u5e94\u5b50\u6811\u7684\u6700\u5927\u6df1\u5ea6\n\n\u4ece\u5de6\u5230\u53f3\u679a\u4e3e,\u76f4\u5230$mxd_i<L_i$,\u5f97\u5230$l$\n\n\u4ece\u53f3\u5230\u5de6\u679a\u4e3e,\u76f4\u5230$mxd_i<R_i$,\u5f97\u5230$r$\n\n\u5e8f\u5217$A$\u4e2d$l$\u5230$r$\u4e4b\u95f4\u7684\u70b9\u90fd\u662f\u5fc5\u987b\u7ecf\u8fc7\u7684\u70b9\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=200011;\nint n,cnt,head[N],f[N],mx;\nll d[N];\nbool v[N];\nstruct edge{int to,nxt,w;}e[N<<1];\nvoid add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nvoid dfs(int x){\n    if(d[x]>d[mx])mx=x;\n    fl(i,x)if(to!=f[x])\n        f[to]=x,d[to]=d[x]+e[i].w,dfs(to);\n}\nll mxd;\nvoid DFS(int x){\n    v[x]=1;\n    if(d[x]>mxd)mxd=d[x];\n    fl(i,x)if(!v[to]){\n        d[to]=d[x]+e[i].w;\n        DFS(to);\n    }\n}\nll L[N],R[N];\nint main(){\n    scanf(\"%d\",&n);\n    int x,y,w,t=0;\n    for(int i=1;i<n;++i)\n        scanf(\"%d%d%d\",&x,&y,&w),\n        add(x,y,w),add(y,x,w);\n    dfs(1),f[mx]=d[mx]=0,dfs(mx);\n    printf(\"%lld\\n\",d[mx]);\n    \n    int l=0,r=0,i;\n    for(x=mx;x;x=f[x],++r){\n        L[f[x]]=L[x]+d[x]-d[f[x]];\n        R[x]=d[x];\n        v[x]=1;\n    }\n    for(x=mx,i=0;++i,x;x=f[x]){\n        mxd=0,d[x]=0,DFS(x);\n        // printf(\"%d %d %d %lld\\n\",x,L[x],R[x],mxd);\n        if(mxd==L[x])l=i;\n        else if(mxd==R[x]){r=i;break;}\n    }\n    printf(\"%d\\n\",r-l);\n}\n```\n", "link": "/posts/LG 3304 [SDOI2013]\u76f4\u5f84/", "tags": ["dfs", "\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "GYM 101908L Subway Lines", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9898\u610f:\n\n\u7ed9\u51fa\u4e00\u68f5$n$\u4e2a\u70b9\u7684\u6811\uff0c\u6bcf\u6b21\u8be2\u95ee\u7ed9\u51fa\u4e24\u5bf9\u53f6\u5b50\uff0c\u6c42\u8fd9\u4e24\u5bf9\u53f6\u5b50\u4ea7\u751f\u8def\u5f84\u7684\u4ea4\u70b9\u6570\n\n\u89e3\u6cd5:\n\n\u5148\u628a\u4e00\u6761\u94fe\u4e0a\u7684\u70b9\u90fd+1\uff0c\u7136\u540e\u67e5\u8be2\u53e6\u4e00\u6761\u94fe\u7684\u6743\u503c\u548c\u5c31\u662f\u7b54\u6848\n\n\u4e5f\u5c31\u662f\u94fe\u52a0\u3001\u94fe\u67e5\u8be2\n\n\u53ef\u4ee5\u76f4\u63a5\u6811\u5256\u5957\u7ebf\u6bb5\u6811/\u6811\u72b6\u6570\u7ec4 $\\log^2$\n\n\u66f4\u4f18\u79c0\u7684\u7ebf\u6027\u505a\u6cd5: \u865a\u6811\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,q,cnt,head[N];\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint siz[N],f[N],d[N],top[N],id[N],sz;\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nstruct bitseg{\n    int s[N];int S[N];\n    void upd(int x,int v){\n        int V=x*v;\n        if(x)for(int i=x;i<=n;i+=i&-i)\n            s[i]+=v,S[i]+=V;\n    }\n    int ask(int x){\n        int res=0;\n        for(int i=x++;i;i-=i&-i)\n            res+=x*s[i]-S[i];\n        return res;\n    }\n    void upd(int l,int r,int v){upd(l,v),upd(r+1,-v);}\n    int ask(int l,int r){return ask(r)-ask(l-1);}\n}T;\nvoid swap(int&x,int&y){int t=x;x=y;y=t;}\nvoid upd(int x,int y,int v){\n    while(top[x]^top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        T.upd(id[top[x]],id[x],v);x=f[top[x]];\n    }\n    if(d[x]>d[y])swap(x,y);\n    T.upd(id[x],id[y],v);\n}\nint ask(int x,int y){\n    int res=0;\n    while(top[x]^top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        res+=T.ask(id[top[x]],id[x]);x=f[top[x]];\n    }\n    if(d[x]>d[y])swap(x,y);\n    return res+T.ask(id[x],id[y]);\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    int x,y,X,Y;\n    for(int i=1;i<n;++i)\n        scanf(\"%d%d\",&x,&y),\n        add(x,y),add(y,x);\n    dfs(1);bt(1,1);\n    while(q--){\n        scanf(\"%d%d%d%d\",&x,&y,&X,&Y);\n        upd(x,y,1);\n        printf(\"%d\\n\",ask(X,Y));\n        upd(x,y,-1);\n    }\n}\n```\n", "link": "/posts/GYM 101908L Subway Lines/", "tags": ["\u6811\u94fe\u5256\u5206", "\u7ebf\u6bb5\u6811", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LOJ 3163. \u300cCEOI2019\u300d\u52a8\u6001\u76f4\u5f84", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://loj.ac/problem/3163.&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://loj.ac/problem/3163.\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ebf\u6bb5\u6811\u7ef4\u62a4\u52a8\u6001\u76f4\u5f84\n\n\u8003\u8651\u8bbe$A_x$\u4e3a\u6bcf\u4e2a\u70b9\u7684\u6df1\u5ea6\n\n\u7b54\u6848\u53ef\u4ee5\u5199\u6210\u8fd9\u6837\u7684\u5f62\u5f0f:\n\n$$ans=\\max_{1\\le x<y\\le n}\\{ A_x + A_y - 2A_{\\text{lca}(x,y)} \\}$$\n\n\u8003\u8651\u6b27\u62c9\u5e8f\n\n\u56e0\u4e3a\u8fb9\u6743\u4e3a\u6b63\uff0c\u4e14\u6b27\u62c9\u5e8f,\u90a3\u4e48\n\n$$ans=\\max_{1\\le x<z<y\\le n}\\{ A_x + A_y - 2A_z \\}$$\n\n\u7ebf\u6bb5\u6811\u7ef4\u62a4\u533a\u95f4\u5185\u7684`min,max,sl,sr,s`\n\n\u5176\u4e2d`min`\u4e3a\u533a\u95f4\u6700\u5c0f\u503c,`max`\u4e3a\u533a\u95f4\u6700\u5927\u503c\n\n$$\nsl_x=\\max_{l<i<j<r} \\{ A_i-2A_j \\}\\\\\nsr_x=\\max_{l<i<j<r} \\{ A_j-2A_i \\}\\\\\ns_x=\\max_{l<i<k<j<r} \\{ A_i+A_j-2A_k \\}\n$$\n\n\u6700\u7ec8\u7b54\u6848\u5c31\u662f$s_1$\n\n\u4fee\u6539\u8fb9\u6743\u53ef\u8f6c\u5316\u4e3a\u5b50\u6811(\u533a\u95f4)\u52a0\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nconst int N=100011,M=N*2;\nint n,cnt,head[N],L[N],R[N],dfn[M],sz,X[N],Y[N];ll d[N],le[M];\nstruct edge{int to,nxt;ll w;}e[M];\nvoid add(int x,int y,ll w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\nvoid dfs(int x,int f){\n    L[x]=++sz;dfn[sz]=x;\n    fl(i,x)if(to!=f){\n        d[to]=d[x]+e[i].w;\n        dfs(to,x);\n        R[x]=++sz;dfn[sz]=x;\n    }\n    R[x]=sz;\n}\nll mi[M*4],mx[M*4],sl[M*4],sr[M*4],s[M*4],laz[M*4];\n#define ls rt<<1\n#define rs rt<<1|1\nll min(ll x,ll y){return x<y?x:y;}\nll max(ll x,ll y){return x>y?x:y;}\nvoid pu(int rt){\n    mi[rt]=min(mi[ls],mi[rs]);\n    mx[rt]=max(mx[ls],mx[rs]);\n    sl[rt]=max(max(sl[ls],sl[rs]),mx[ls]-2*mi[rs]);\n    sr[rt]=max(max(sr[ls],sr[rs]),mx[rs]-2*mi[ls]);\n    s[rt]=max(max(s[ls],s[rs]),max(sl[ls]+mx[rs],sr[rs]+mx[ls]));\n}\nvoid pd(int rt){\n    if(laz[rt]){\n        sl[ls]-=laz[rt];sr[ls]-=laz[rt];\n        mi[ls]+=laz[rt];mx[ls]+=laz[rt];\n        laz[ls]+=laz[rt];\n\n        sl[rs]-=laz[rt];sr[rs]-=laz[rt];\n        mi[rs]+=laz[rt];mx[rs]+=laz[rt];\n        laz[rs]+=laz[rt];\n\n        laz[rt]=0;\n    }\n}\nvoid build(int l,int r,int rt){\n    if(l==r)return \n        mi[rt]=mx[rt]=d[dfn[l]],\n        sl[rt]=sr[rt]=-d[dfn[l]],\n    void();\n    int m=l+r>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu(rt);\n}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R)return \n        mi[rt]+=v,mx[rt]+=v,\n        sl[rt]-=v,sr[rt]-=v,\n        laz[rt]+=v,\n    void();\n    int m=l+r>>1;\n    pd(rt);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    pu(rt);\n}\nint main(){\n    int q;ll W;\n    scanf(\"%d%d%lld\",&n,&q,&W);\n    int x,y,d;ll w,v,la=0;\n    for(int i=1;i<n;++i){\n        scanf(\"%d%d%lld\",&x,&y,&w);\n        add(x,y,w),add(y,x,w);\n        X[i]=x,Y[i]=y;le[i]=w;\n    }\n    dfs(1,0);\n    build(1,sz,1);\n    while(q--){\n        scanf(\"%d%lld\",&d,&v);\n        d=(d+la)%(n-1)+1;v=(v+la)%W;\n        int p=(L[X[d]]>L[Y[d]]?X[d]:Y[d]);\n        upd(L[p],R[p],v-le[d],1,sz,1);le[d]=v;\n        printf(\"%lld\\n\",la=s[1]);\n    }\n}\n```\n", "link": "/posts/LOJ 3163. \u300cCEOI2019\u300d\u52a8\u6001\u76f4\u5f84/", "tags": ["\u6b27\u62c9\u5e8f", "dfs\u5e8f", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3722 [AH2017-HNOI2017]\u5f71\u9b54", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3722&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3722\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u79bb\u7ebf\u5904\u7406\uff0c\u6309\u7167\u5de6\u53f3\u7aef\u70b9\u6392\u5e8f\n\n\u8003\u8651\u6bcf\u4e2a\u70b9\u7684\u8d21\u732e\uff1f\n\n\u8bb0\u5f55\u5de6\u8fb9($L_i$)/\u53f3\u8fb9($R_i$)\u7b2c\u4e00\u4e2a\u6bd4\u5b83\u5927\u7684\u5730\u65b9\n\n1. \u5bf9\u4e8e\u533a\u95f4$[L_i,R_i]$\uff0c\u5b83\u6709$p_1$\u7684\u8d21\u732e\n2. \u5bf9\u4e8e\u533a\u95f4$[l,R_i],l\\in [L_i+1,i-1]$\uff0c\u5b83\u6709$p_2$\u7684\u8d21\u732e\n3. \u5bf9\u4e8e\u533a\u95f4$[L_i,r],r\\in [i+1,R_i-1]$\uff0c\u5b83\u6709$p_2$\u7684\u8d21\u732e\n\n\u6bcf\u4e2a\u8be2\u95ee$[l,r]$\u53ef\u4ee5\u8f6c\u5316\u4e3a$r$\u7684\u7b54\u6848\u51cf\u53bb$l-1$\u7684\u7b54\u6848\n\n\u628a\u8f6c\u5316\u540e\u7684\u8be2\u95ee\u548c\u6bcf\u4e2a\u70b9\u7684\u8d21\u732e\u533a\u95f4\u6309\u4f4d\u7f6e\u6392\u5e8f\n\n\u5bf9\u4e8e1,\u6211\u4eec\u5728\u626b\u5230$R_i$\u65f6,\u66f4\u65b0\u70b9$L_i$\u7684\u8d21\u732e\n\n\u5bf9\u4e8e2,\u6211\u4eec\u5728\u626b\u5230$R_i$\u65f6,\u66f4\u65b0\u533a\u95f4$L_i+1$\u5230$i-1$\u7684\u8d21\u732e\n\n\u5bf9\u4e8e3,\u6211\u4eec\u5728\u626b\u5230$L_i$\u65f6,\u66f4\u65b0\u533a\u95f4i+1\u5230$R_i-1$\u7684\u8d21\u732e\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=200011;\ntypedef long long ll;\nint n,m,a[N],p1,p2,L[N],R[N],sta[N],tp;ll ans[N];\nstruct node{\n    int l,r,x,id,v;\n    bool operator<(const node&t)const{return x<t.x;}\n}p[N*2],q[N*2];\nstruct bitseg{\n    int s[N];ll S[N];\n    void add(int x,int v){\n        if(x)for(int i=x;i<=n;i+=i&-i)\n            s[i]+=v,S[i]+=1ll*x*v;\n    }\n    ll ask(int x){\n        ll res=0;\n        for(int i=x++;i;i-=i&-i)\n            res+=1ll*s[i]*x-S[i];\n        return res;\n    }\n    void add(int l,int r,int v){add(l,v),add(r+1,-v);}\n    ll ask(int l,int r){return ask(r)-ask(l-1);}\n}T;\nint main(){\n    scanf(\"%d%d%d%d\",&n,&m,&p1,&p2);\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i);\n    a[n+1]=n+1;\n    for(int i=1;i<=n+1;++i){\n        while(tp&&a[i]>a[sta[tp]])R[sta[tp--]]=i;\n        L[i]=sta[tp];\n        sta[++tp]=i;\n    }\n    int l,r;\n    for(int i=1;i<=m;++i){\n        scanf(\"%d%d\",&l,&r);\n        ans[i]+=1ll*(r-l)*p1;\n        p[i]=(node){l,r,l-1,i,-1};\n        p[i+m]=(node){l,r,r,i,1};\n    }\n    std::sort(p+1,p+m+m+1);\n    int tt=0;\n    for(int i=1;i<=n;++i){\n        if(1<=L[i]&&R[i]<=n)\n            q[++tt]=(node){L[i],L[i],R[i],0,p1};\n        if(1<=L[i]&&R[i]>i+1)\n            q[++tt]=(node){i+1,R[i]-1,L[i],0,p2};\n        if(L[i]+1<i&&R[i]<=n)\n            q[++tt]=(node){L[i]+1,i-1,R[i],0,p2};\n    }\n    std::sort(q+1,q+tt+1);\n    int n1=1,n2=1;\n    while(!p[n1].x)++n1;\n    for(int i=1;i<=n&&n1<=m+m;++i){\n        for(;n2<=tt&q[n2].x==i;++n2)\n            T.add(q[n2].l,q[n2].r,q[n2].v);\n        for(;n1<=m+m&&p[n1].x==i;++n1)\n            ans[p[n1].id]+=p[n1].v*(T.ask(p[n1].l,p[n1].r));\n    }\n    for(int i=1;i<=m;++i)printf(\"%lld\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG 3722 [AH2017-HNOI2017]\u5f71\u9b54/", "tags": ["\u79bb\u7ebf", "\u6811\u72b6\u6570\u7ec4", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3606 [USACO17JAN]Building a Tall Barn P", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3606&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3606\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u601d\u8def\u8fd8\u7b97\u633a\u795e\u5947\u7684\n\n\u9898\u610f:\n\n$\\sum C_i=k$,\u8981\u8ba9$\\sum \\dfrac{A_i}{C_i}$\u6700\u5c0f\n\n\u8bbe$T_i=\\dfrac{A_i}{C_i}$\n\n\u5047\u8bbe\u6211\u4eec\u6bcf\u6b21\u8981\u7ed9\u4e00\u4e2a$C_i$\u52a0\u4e00,\u90a3\u4e48$\\Delta T_i=\\dfrac{A_i}{C_i}-\\dfrac{A_i}{C_i+1}$,\n\n\u6211\u4eec\u8981\u8ba9$\\Delta T_i$\u5c3d\u53ef\u80fd\u5927\n\n\u8fd9\u6837\u4e00\u76f4\u52a0\u4e00\u5230\u6700\u540e\uff0c\u4f1a\u8ba9\u6240\u6709$\\Delta T_i$\u8d8b\u8fd1\u4e8e\u76f8\u540c\n\n$\n\\begin{aligned}\n\\Delta T_i\n&=\\dfrac{A_i}{C_i}-\\dfrac{A_i}{C_i+1}\\\\\n&=\\dfrac{A_i}{C_i(C_i+1)}\\\\\n&=\\dfrac{A_i}{C_i^2+C_i}\n\\end{aligned}\\\\\nC_i^2+C_i-\\dfrac{A_i}{\\Delta T_i}=0\\\\\nC_i=\\dfrac{-1+\\sqrt{1+\\frac{4A_i}{\\Delta T_i}}}2\n$\n\n\u7531\u4e8e$\\Delta T_i$\u662f\u5355\u8c03\u7684,$\\Delta T_i$\u8d8a\u5c0f,\u7b54\u6848\u8d8a\u5c0f\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4e8c\u5206$\\Delta T_i$,\u5e76\u5012\u63a8\u5f97\u51fa$C_i$\n\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\ntypedef long long ll;\ntypedef double db;\nint n;ll k,sum,a[N];db Ans;\nbool chk(db t,bool typ=0){\n    ll s=0;\n    for(int i=1;i<=n;++i){\n        ll c=ceil(sqrt(0.25+a[i]/t)-0.5);\n        s+=c;\n        if(s>k)return 0;\n        if(typ)Ans+=(db)a[i]/c;\n    }\n    if(typ)sum=s;\n    return 1;\n}\nint main(){\n    scanf(\"%d%lld\",&n,&k);\n    for(int i=1;i<=n;++i)scanf(\"%lld\",a+i);\n    db l=1e-10,r=1e10,eps=1e-10,ans;\n    while(r-l>=eps){\n        db m=(l+r)*0.5;\n        if(chk(m))r=ans=m;\n        else l=m;\n    }\n    chk(ans,1);\n    printf(\"%lld\\n\",ll(Ans-(k-sum)*ans+0.5));\n}\n```\n", "link": "/posts/LG 3606 [USACO17JAN]Building a Tall Barn P/", "tags": ["\u4e8c\u5206", "\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1258 \u5e8f\u5217\u6c42\u548c V4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=1<<17,P=1000000007;\nint pw(int x,int b,int p=P){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return res;\n}\nvoid mod(ll&x,ll p){if(x>=p)x-=p;}\nll mul(ll x,ll y,ll p){\n    ll res=0;\n    while(y){\n        if(y&1)mod(res+=x,p);\n        y>>=1;mod(x<<=1,p);\n    }\n    return res;\n}\nint fac[N],ifac[N];\nint C(int n,int m){\n    if(m>n)return 0;\n    return 1ll*fac[n]*ifac[n-m]%P*ifac[m]%P;\n}\nconst int G=3,Gi=332748118,\n    m[3]={998244353,469762049,1004535809};\nconst ll M=1ll*m[0]*m[1];\nint r[N],L=1;\nvoid swap(int&x,int&y){int t=x;x=y;y=t;}\nvoid ntt(int*A,int typ,int p){\n    for(int i=0;i<L;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<L;len<<=1){\n        int Wn=pw(G,(p-1)/(len<<1),p);\n        for(int i=0;i<L;i+=len<<1){\n            int w=1;\n            for(int k=0;k<len;++k){\n                int t=1ll*A[i+k+len]*w%p;\n                A[i+k+len]=(A[i+k]-t+p)%p;\n                A[i+k]=(A[i+k]+t)%p;\n                w=1ll*w*Wn%p;\n            }\n        }\n    }\n    if(~typ)return;\n    std::reverse(A+1,A+L);\n    int iL=pw(L,p-2,p);\n    for(int i=0;i<L;++i)A[i]=1ll*A[i]*iL%p;\n}\nint crt(int x,int y,int z){\n    ll a=(\n        mul(1ll*x*m[1]%M,pw(m[1]%m[0],m[0]-2,m[0]),M)+\n        mul(1ll*y*m[0]%M,pw(m[0]%m[1],m[1]-2,m[1]),M)\n    )%M;\n    ll k=((z-a)%m[2]+m[2])%m[2]*pw(M%m[2],m[2]-2,m[2])%m[2];\n    return ((k%P)*(M%P)%P+a%P)%P;\n}\nvoid getL(int n){\n    for(L=1;L<n;L<<=1);\n    for(int i=0;i<L;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)?(L>>1):0);\n}\nint ans[3][N],tmp[N];\nvoid work(int n,int*a,int*b){\n    if(n==1){\n        b[0]=crt(\n            pw(a[0],m[0]-2,m[0]),\n            pw(a[0],m[1]-2,m[1]),\n            pw(a[0],m[2]-2,m[2])\n        );\n        return;\n    }\n    work(n>>1,a,b);\n    getL(n<<1);\n    for(int k=0;k<3;++k)\n        for(int i=0;i<n;++i)\n            ans[k][i]=b[i],ans[k][i+n]=0;\n    for(int k=0;k<3;++k){\n        for(int i=0;i<n;++i)\n            tmp[i]=a[i],tmp[i+n]=0;\n        ntt(tmp,1,m[k]),ntt(ans[k],1,m[k]);\n        for(int i=0;i<L;++i)\n            ans[k][i]=1ll*tmp[i]*ans[k][i]%m[k];\n        ntt(ans[k],-1,m[k]);\n    }\n    for(int i=0;i<n;++i)\n        ans[0][i]=ans[1][i]=ans[2][i]=\n            (P-crt(ans[0][i],ans[1][i],ans[2][i]))%P;\n    ans[0][0]=ans[1][0]=ans[2][0]=(ans[0][0]+2)%P;\n\n    for(int k=0;k<3;++k){\n        for(int i=0;i<n;++i)\n            tmp[i]=b[i],tmp[i+n]=0;\n        ntt(tmp,1,m[k]),ntt(ans[k],1,m[k]);\n        for(int i=0;i<L;++i)\n            ans[k][i]=1ll*tmp[i]*ans[k][i]%m[k];\n        ntt(ans[k],-1,m[k]);\n    }\n    for(int i=0;i<n;++i)\n        b[i]=crt(ans[0][i],ans[1][i],ans[2][i]);\n}\nint a[N],B[N];\nvoid init(){\n    int len=1<<16;\n    fac[0]=1;\n    for(int i=1;i<=len;++i)fac[i]=1ll*fac[i-1]*i%P;\n    ifac[len]=pw(fac[len],P-2);\n    for(int i=len;i;--i)ifac[i-1]=1ll*ifac[i]*i%P;\n    for(int i=0;i<len;++i)a[i]=ifac[i+1];    \n    work(len,a,B);\n    for(int i=0;i<len;++i)\n        B[i]=1ll*B[i]*fac[i]%P;\n    B[1]=P-B[1];\n}\nint S(int n,int k){\n    int x=0;\n    for(int i=0;i<=k;++i)\n        x=(x+1ll*C(k+1,i)*B[i]%P*pw(n,k+1-i)%P)%P;\n    return 1ll*pw(k+1,P-2)*x%P;\n}\nint main(){\n    init();\n    int T,k;long long n;\n    scanf(\"%d\",&T);\n    while(T--)\n        scanf(\"%lld%d\",&n,&k),\n        printf(\"%lld\\n\",S(n%P,k));\n}\n```\n", "link": "/posts/51nod 1258 \u5e8f\u5217\u6c42\u548c V4/", "tags": ["\u6570\u8bba", "\u81ea\u7136\u6570\u5e42\u548c", "\u62c9\u683c\u6717\u65e5\u63d2\u503c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3711 \u4ed3\u9f20\u7684\u6570\u5b66\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3711&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3711\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000011,P=1000000007,G=5,Gi=400000003;\nint fac[N],inv[N],ifac[N],B[N],C[N];\nint pw(int x,int b){\n\tint res=1;\n\twhile(b){\n\t\tif(b&1)res=1ll*res*x%P;\n\t\tb>>=1;x=1ll*x*x%P;\n\t}\n\treturn res;\n}\nvoid mod(int&x){if(x>=P)x-=P;}\nint L,r[N];\nvoid getL(int n){\n\tfor(L=1;L<n;L<<=1);\n\tfor(int i=0;i<L;++i)\n\t\tr[i]=(r[i>>1]>>1)|((i&1)?(L>>1):0);\n}\nvoid swap(int&x,int&y){x^=y,y^=x,x^=y;}\nvoid ntt(int*A,int typ){\n\tfor(int i=0;i<L;++i)\n\t\tif(i<r[i])swap(A[i],A[r[i]]);\n\tfor(int len=1;len<L;len<<=1){\n\t\tint Wn=pw(~typ?G:Gi,(P-1)/(len<<1));\n\t\tfor(int i=0;i<L;i+=len<<1){\n\t\t\tint w=1;\n\t\t\tfor(int k=0;k<len;++k){\n\t\t\t\tint t=1ll*w*A[i+k+len]%P;\n\t\t\t\tmod(A[i+k+len]=A[i+k]-t+P);\n\t\t\t\tmod(A[i+k]+=t);\n\t\t\t\tw=1ll*w*Wn%P;\n\t\t\t}\n\t\t}\n\t}\n\tif(~typ)return;\n\tfor(int i=0,iL=pw(L,P-2);i<L;++i)\n\t\tA[i]=1ll*A[i]*iL%P;\n}\nvoid inv(int*A,int*B,int n){\n\tif(n==1)return B[0]=pw(A[0],P-2),void();\n\tinv(A,B,(n+1)>>1);\n\tgetL(n<<1);\n\tfor(int i=0;i<n;++i)C[i]=A[i];\n\tfor(int i=n;i<L;++i)C[i]=0;\n\tntt(C,1),ntt(B,1);\n\tfor(int i=0;i<L;++i)\n\t\tB[i]=1ll*B[i]*(2-1ll*C[i]*B[i]%P+P)%P;\n\tntt(B,-1);\n\tfor(int i=n;i<L;++i)B[i]=0;\n}\nvoid prep(int n){\n\tfac[0]=fac[1]=inv[0]=inv[1]=ifac[0]=ifac[1]=B[0]=1;\n\tfor(int i=2;i<=n;++i)\n\t\tfac[i]=1ll*fac[i-1]*i%P,\n\t\tinv[i]=1ll*inv[P%i]*(P-P/i)%P,\n\t\tifac[i]=1ll*ifac[i-1]*inv[i]%P;\n\t\n\tinv(ifac+1,B,L);\n\tfor(int i=2;i<=n;++i)B[i]=1ll*B[i]*fac[i]%P;\n}\nint S(int n,int k){\n\tint ans=0;\n\tfor(int i=0;i<=k;++i)\n\t\tmod(ans+=1ll*fac[k]*ifac[i]%P*ifac[k+1-i]%P*B[i]%P*pw(n,k+1-i)%P);\n\treturn ans;\n}\nint main(){\n\tint n,k;\n\tscanf(\"%d%d\",&n,&k);\n\tgetL(k+1),prep(L);\n\tprintf(\"%d\\n\",S(n+1,k));\t\t\n}\n```\n", "link": "/posts/LG 3711 \u4ed3\u9f20\u7684\u6570\u5b66\u9898/", "tags": ["\u4f2f\u52aa\u5229\u6570", "\u6570\u8bba", "\u591a\u9879\u5f0f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4593 [TJOI2018]\u6559\u79d1\u4e66\u822c\u7684\u4eb5\u6e0e", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4593&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4593\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ec6\u8282: \u5982\u679c\u4ece$n$\u5f00\u59cb\u6709\u8fde\u7eed\u4e00\u6bb5\u7a7a\u767d,\u90a3\u4e48\u8fd9\u6bb5\u7a7a\u767d\u8981\u53bb\u6389\n\n\u8f6c\u6362\u540e\u53ef\u4ee5\u53d1\u73b0\u53ea\u9700\u8981$m+1$\u5f20\u724c\u5c31\u53ef\u4ee5\n\n\u8003\u8651\u6bcf\u6b21\"\u4eb5\u6e0e\"\u7684\u8d21\u732e\n\n\u7b2c\u4e00\u6b21\"\u4eb5\u6e0e\"\u7684\u8d21\u732e\u5c31\u662f$\\displaystyle \\sum_{i=1}^n i^k$\u526a\u6389\u7a7a\u4f4d\u7684\u8d21\u732e\n\n\u5728\u7a7a\u4f4d$p$\u4e0a\u4f7f\u7528\"\u4eb5\u6e0e\",\u6709\u8d21\u732e\u7684\u4f4d\u7f6e: $[p+1,n]$,\u8d21\u732e\u4e3a$\\displaystyle \\sum_{i=1}^{n-p} i^k$\n\n\u51cf\u53bb\u7a7a\u4f4d\u591a\u7b97\u7684\u8d21\u732e\u5373\u53ef\n\n\u6c42\u81ea\u7136\u6570\u5e42\u548c\u53ef\u4ee5\u8003\u8651\u62c9\u683c\u6717\u65e5\u63d2\u503c,\u9012\u63a8\u6cd5,\u4f2f\u52aa\u5229\u6570\u7b49\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=60,P=1000000007;\ntypedef long long ll;\nint fac[N],ifac[N],pre[N],suf[N];\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%P;\n        b>>=1;x=1ll*x*x%P;\n    }\n    return res;\n}\nvoid init(int n){\n    fac[0]=1;\n    for(int i=1;i<=n;++i)\n        fac[i]=1ll*fac[i-1]*i%P;\n    ifac[n]=pw(fac[n],P-2);\n    for(int i=n;i;--i)\n        ifac[i-1]=1ll*ifac[i]*i%P;\n}\nvoid mod(int&x){if(x>=P)x-=P;}\nint S(ll n,int k){\n    pre[0]=1;\n    for(int i=1;i<=k+2;++i)\n        pre[i]=(n-i)%P*pre[i-1]%P;\n    suf[k+3]=1;\n    for(int i=k+2;~i;--i)\n        suf[i]=(n-i)%P*suf[i+1]%P;\n    int ans=0,y=0;\n    for(int i=1;i<=k+2;++i){\n        mod(y+=pw(i,k));\n        int a=1ll*pre[i-1]*suf[i+1]%P*ifac[i-1]%P*ifac[k+2-i]%P;\n        if((k-i)&1)a=P-a;\n        mod(ans+=1ll*y*a%P);\n    }\n    return ans;\n}\nvoid solve(){\n    static ll n,a[N];\n    static int m,ans,k;\n    std::unordered_map<ll,bool>v;\n    scanf(\"%lld%d\",&n,&m);\n    for(int i=1;i<=m;++i)\n        scanf(\"%lld\",a+i),v[a[i]]=1;\n    std::sort(a+1,a+m+1);\n    while(v[n])--n,--m;\n    k=m+1;\n    ans=S(n,k);\n    for(int i=1;i<=m;++i){\n        mod(ans+=P-pw(a[i],k));\n        mod(ans+=S(n-a[i],k));\n        for(int j=i-1;j;--j)\n            mod(ans+=P-pw(a[i]-a[j],k));\n    }\n    printf(\"%d\\n\",ans);\n}\nint main(){\n    init(55);\n    int T;scanf(\"%d\",&T);\n    while(T--)solve();\n}\n```\n", "link": "/posts/LG 4593 [TJOI2018]\u6559\u79d1\u4e66\u822c\u7684\u4eb5\u6e0e/", "tags": ["\u6570\u8bba", "\u81ea\u7136\u6570\u5e42\u548c", "\u62c9\u683c\u6717\u65e5\u63d2\u503c", "\u4f2f\u52aa\u5229\u6570", "\u9012\u63a8"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4464 [\u56fd\u5bb6\u96c6\u8bad\u961f]JZPKIL", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4464&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4464\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$\n\\begin{aligned}\n&\\quad\\sum_{i=1}^n \\gcd(i,n)^x lcm(i,n)^y\n\\\\\n&=\\sum_{i=1}^n \\frac{in}{lcm(i,n)}^x lcm(i,n)^y\n\\\\\n&=\\sum_{i=1}^n (in)^x lcm(i,n)^{y-x}\n\\\\\n&=\\sum_{i=1}^n (in)^x \\frac{in}{\\gcd(i,n)}^{y-x}\\\\\n&=\\sum_{i=1}^n (in)^y \\gcd(i,n)^{x-y}\n\\\\\n&=n^y\\sum_{d|n} d^{x-y}\\sum_{i=1}^n i^y [\\gcd(i,n)=d]\n\\\\\n&=n^y\\sum_{d|n} d^{x-y}\\sum_{i=1}^{n/d} (id)^y [\\gcd(i,n)=1]\n\\\\\n&=n^y\\sum_{d|n} d^{x-y}\\sum_{i=1}^{n/d} (id)^y \\sum_{k|i,k|n}\\mu(k)\n\\\\\n&=n^y\\sum_{d|n} d^{x-y}\\sum_{k|\\frac nd}\\mu(k)\\sum_{i=1}^{n/dk} (idk)^y\n\\\\\n&=n^y\\sum_{d|n} d^x\\sum_{k|\\frac nd}\\mu(k)k^y\\sum_{i=1}^{n/dk} i^y\n\\end{aligned}\n$$\n\n\u8bbe$\\displaystyle S_k(n)=\\sum_{i=1}^{n-1}i^k$,\u53ef\u4ee5\u770b\u505a\u4e00\u4e2a$y+1$\u6b21\u591a\u9879\u5f0f,\u5047\u8bbe\u6c42\u51fa\u540e\u6bcf\u4e00\u9879\u7cfb\u6570\u4e3a$t_i$\n\n$$\n=n^y\\sum_{d|n} d^x\\sum_{k|\\frac nd}\\mu(k)k^yS_y(\\frac n{dk})\n\\\\\n=n^y\\sum_{d|n} d^x\\sum_{k|\\frac nd}\\mu(k)k^y\\sum_{i=0}^{y+1}t_i(\\frac n{dk})^i\n\\\\\n=n^y\\sum_{i=0}^{y+1}t_i \\sum_{d|n} d^x\\sum_{k|\\frac nd}\\mu(k)k^y (\\frac n{dk})^i\n$$\n\n\u5176\u4e2d,\u8bbe$\\displaystyle Z(n)=\\sum_{d|n} d^x\\sum_{k|\\frac nd}\\mu(k)k^y (\\frac n{dk})^i$ ,\n\n\u53ef\u4ee5\u770b\u6210$f(d)=d^x,g(d)=\\mu(d)d^y,h^i(d)=d^i$\u8fd9\u4e09\u4e2a\u79ef\u6027\u51fd\u6570\u7684\u72c4\u5229\u514b\u96f7\u5377\u79ef\n\n\u5377\u79ef\u540e\u8fd8\u662f\u79ef\u6027\u51fd\u6570,\u4e14\u72c4\u5229\u514b\u96f7\u5377\u79ef\u6ee1\u8db3\u4ea4\u6362\u5f8b,\u53ea\u6709\u5f53$x=1$\u6216$x=p^k$\u65f6$\\mu(x)\\ne 0$\n\n$\n\\begin{cases}\nZ(1)=1\\\\\nZ(p)=p^x-p^y+p^i\\\\\nZ(p^k)=(f * h^i)(p^k)-(f * h^i)(p^{k-1}) \\cdot p^y\n\\end{cases}\n$\n\n\u5176\u4e2d$\\displaystyle (f * h^i)(p^k)=\\sum_{i+j=k} f(p^i)\\cdot h^i(p^j)$\n\n\u4f7f\u7528`Pollard-Rho`\u5c06$n$\u5206\u89e3\u8d28\u56e0\u6570\uff0c\u679a\u4e3e\u6bcf\u4e2a\u8d28\u56e0\u5b50(\u5305\u62ec\u6b21\u5e42),\u7136\u540e\u72c4\u5229\u514b\u96f7\u5377\u79ef\u8ba1\u7b97\u7b54\u6848\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=3011,P=1000000007;\ntypedef __int128 ll;\ntypedef __int128 i128;\ntemplate<typename T>void rd(T&x){x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());x=f?-x:x;}\nll rnd(){\n    static unsigned int seed=233;\n    return seed=seed*482711;\n}\nll pw(i128 x,ll b,ll p=P){\n    i128 res=1;\n    while(b){\n        if(b&1)(res*=x)%=p;\n        b>>=1;(x*=x)%=p;\n    }\n    return res;\n}\nvoid mod(ll&x){if(x>=P)x-=P;}\nbool chk(const ll&p){\n    if(p==2||p==3||p==5)return 1;\n    if(!(p&1)||p<2)return 0;\n    ll t=p-1;int k=0;\n    while(!(t&1))t>>=1,++k;\n    static int test[10]={2,3,5,7,11,13,17,19,23,29};\n    for(int i=0;i<10&&test[i]<p;++i){\n        ll a=pw(test[i],t,p),nxt;\n        for(int j=1;j<=k;++j){\n            nxt=(i128)a*a%p;\n            if(nxt==1&&a!=1&&a!=p-1)return 0;\n            a=nxt;\n        }\n        if(a!=1)return 0;\n    }\n    return 1;\n}\nll gcd(ll a,ll b){return b?gcd(b,a%b):a;}\nll abs(const ll&x){return x<0?-x:x;}\nll pr(ll p){\n    ll k=2,x=rnd()%(p-1)+1,y=x,d=1,c=rnd()%99997+1;\n    for(int i=1;d==1;++i){\n        x=((i128)x*x+c)%p;\n        d=gcd(abs(x-y),p);\n        if(i==k)y=x,k<<=1;\n    }\n    return d;\n}\nll a[N];int cnt,w[N];\nvoid fact(ll x){\n    if(x<2)return;\n    if(chk(x)){a[++cnt]=x;return;}\n    ll p=x;\n    while(p>=x)p=pr(x);\n    while(x%p==0)x/=p;\n    fact(p),fact(x);\n}\nll fac[N],ifac[N],B[N],b[N];\nvoid init(int n){\n    fac[0]=1;\n    for(int i=1;i<=n;++i)\n        fac[i]=fac[i-1]*i%P;\n    ifac[n]=pw(fac[n],P-2);\n    for(int i=n;i;--i)\n        ifac[i-1]=ifac[i]*i%P;\n    B[0]=1;\n    for(int i=1;i<=n;++i)\n        for(int j=0;j<i;++j)\n            mod(B[i]+=P-fac[i]*ifac[j]%P*ifac[i+1-j]%P*B[j]%P);\n    ++B[1];\n}\nll f[N],g[N],F[N],H[N],h[N];\nvoid solve(const ll&n,const int&x,const int&y){\n    b[0]=0;\n    for(int i=0;i<=y;++i)\n        b[y+1-i]=fac[y]*ifac[i]%P*ifac[y+1-i]%P*B[i]%P;\n    cnt=0,fact(n),std::sort(a+1,a+cnt+1);\n    ll t=n;\n    for(int j=1;j<=cnt;++j)\n        while(t%a[j]==0)t/=a[j],++w[j];\n    ll ans=0;\n    for(int j=1;j<=cnt;++j)\n        f[j]=pw(a[j],x),g[j]=pw(a[j],y);\n    for(int i=0;i<=y+1;++i){\n        ll res=1;\n        for(int j=1;j<=cnt;++j){\n            h[j]=i?h[j]*a[j]%P:1;\n            F[0]=H[0]=1;\n            for(int k=1;k<=w[j];++k)\n                F[k]=F[k-1]*f[j]%P,\n                H[k]=H[k-1]*h[j]%P;\n            ll FH=0,fh=0;\n            for(int k=0;k<=w[j];++k)\n                mod(FH+=F[k]*H[w[j]-k]%P);\n            for(int k=0;k<w[j];++k)\n                mod(fh+=F[k]*H[w[j]-1-k]%P);\n            res=res*(FH-fh*g[j]%P+P)%P;\n        }\n        mod(ans+=res*b[i]%P);\n    }\n    for(int j=1;j<=cnt;++j)a[j]=w[j]=0;\n    printf(\"%d\\n\",pw(n,y)*ans%P);\n}\nint main(){\n    int T,x,y;ll n;\n    rd(T);\n    init(3002);\n    while(T--)\n        rd(n),rd(x),rd(y),\n        solve(n,x,y);\n}\n```\n", "link": "/posts/LG 4464 [\u56fd\u5bb6\u96c6\u8bad\u961f]JZPKIL/", "tags": ["\u83ab\u6bd4\u4e4c\u65af", "\u6570\u8bba", "\u4f2f\u52aa\u5229\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5505 [JSOI2011]\u5206\u7279\u4ea7", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5505&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5505\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6709$n$\u4e2a\u4eba\u548c$m$\u79cd\u7269\u54c1,\u7b2c$i$\u79cd\u7269\u54c1\u6709$a_i$\u4e2a,\u540c\u79cd\u7269\u54c1\u4e4b\u95f4\u6ca1\u6709\u533a\u522b\u3002\u73b0\u5728\u8981\u5c06\u8fd9\u4e9b\u7269\u54c1\u5206\u7ed9\u8fd9\u4e9b\u4eba,\u4f7f\u5f97\u6bcf\u4e2a\u4eba\u81f3\u5c11\u5206\u5230\u4e00\u4e2a\u7269\u54c1\n\n\u6bcf\u4e2a\u540c\u5b66\u90fd\u5fc5\u987b**\u81f3\u5c11**\u5206\u5f97\u4e00\u4e2a\n\n\u53ef\u4ee5\u901a\u8fc7 **\u6070\u597d**\u6ca1\u6709\u540c\u5b66\u6ca1\u6709\u5206\u5f97 \u6765\u53cd\u6f14\n\n\u8bbe$f_i$\u4e3a\u94a6\u5b9a$i$\u4e2a\u4eba\u6ca1\u6709\u5206\u5230,\n\n\u94a6\u5b9a\u7684\u65b9\u6848\u6570\u4e3a${n\\choose i}$,\u8fd9\u65f6\u7b2c$j$\u79cd\u7269\u54c1\u5206\u7ed9$n-i$\u4e2a\u4eba,\u4f7f\u7528\u9694\u677f\u6cd5,\u65b9\u6848\u6570\u4e3a${n-i+a_j-1\\choose n-i-1}$\n\n$$\nf_i={n\\choose i}\\prod_{j=1}^m{n-i+a_j-1\\choose n-i-1}\n$$\n\n\u8bbe$g_i$\u4e3a\u6070\u597d$i$\u4e2a\u4eba\u6ca1\u6709\u5206\u5230,\u53cd\u6f14:\n\n$$\ng_k=\\sum_{i=k}^n(-1)^{i-k}{i \\choose k}f_i\n$$\n\n\u90a3\u4e48:\n\n$$\n\\begin{aligned}\nans\n&=g_0\\\\\n&=\\sum_{i=0}^n(-1)^if_i\\\\\n&=\\sum_{i=0}^n(-1)^i{n\\choose i}\\prod_{j=1}^m{n-i+a_j-1\\choose n-i-1}\n\\end{aligned}\n$$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1001,P=1000000007;\nint n,m,a[N],ans,c[N*2][N*2];\nvoid mod(int&x){if(x>=P)x-=P;}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=0;i<=2000;++i){\n        c[i][0]=c[i][i]=1;\n        for(int j=1;j<i;++j)\n            mod(c[i][j]=c[i-1][j-1]+c[i-1][j]);\n    }\n    for(int i=1;i<=m;++i)scanf(\"%d\",a+i);\n    for(int i=0;i<=n;++i){\n        long long res=c[n][i];\n        for(int j=1;j<=m;++j)\n            (res*=c[n-i+a[j]-1][n-i-1])%=P;\n        if(i&1)mod(ans+=P-res);\n        else mod(ans+=res);\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 5505 [JSOI2011]\u5206\u7279\u4ea7/", "tags": ["\u4e8c\u9879\u5f0f\u53cd\u6f14", "\u5bb9\u65a5", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4192 \u65c5\u884c\u89c4\u5212", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4192&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4192\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9898\u610f: \n\n1. \u533a\u95f4\u52a0\n2. \u6c42\u5e8f\u5217\u6700\u5927\u524d\u7f00\u548c\n\n\u533a\u95f4\u52a0\uff0c\u76f8\u5f53\u4e8e\u524d\u7f00\u548c\u52a0\u4e0a\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\n\n\u800c\u7b49\u5dee\u6570\u5217\u52a0\u4e0a\u4e00\u4e2a\u7b49\u5dee\u6570\u5217\u8fd8\u662f\u7b49\u5dee\u6570\u5217\n\n\u8003\u8651\u5c06\u6bcf\u4e2a\u4f4d\u7f6e\u7684\u524d\u7f00\u548c\u8f6c\u5316\u4e3a\u4e00\u4e2a\u4e00\u6b21\u51fd\u6570$kx+b$\n\n\u5206\u5757,\u5bf9\u6bcf\u4e2a\u5757\u7ef4\u62a4\u4e00\u4e2a\u4e0a\u51f8\u58f3\u5355\u8c03\u6808,\u53ef\u4ee5\u4e8c\u5206\u627e\u5230\u6700\u5927\u503c\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,q,blk,bl[N],L[320],R[320],st[320][320],cnt[320];\ntypedef long long ll;\nconst ll inf=-1ull>>1;\nll a[N],k[320],add[320];\nvoid cmax(ll&x,ll y){if(x<y)x=y;}\nbool cmp(int x,int y,int X,int Y){return (a[x]-a[y])*(X-Y)<(a[X]-a[Y])*(x-y);}\nvoid build(int x){\n    int*sta=st[x];int&tp=cnt[x];\n    sta[tp=1]=L[x];\n    for(int i=L[x]+1;i<=R[x];++i){\n        while(tp>1&&cmp(sta[tp-1],sta[tp],sta[tp-1],i))--tp;\n        sta[++tp]=i;\n    }\n    sta[0]=0,sta[++tp]=n+1;\n}\nvoid pd(int x){\n    ll s=0;\n    for(int i=L[x];i<=R[x];++i)\n        a[i]+=s,s+=k[x],a[i]+=add[x];\n    k[x]=add[x]=0;\n}\nvoid upd(int l,int r,ll v){\n    ll s=0;\n    if(bl[l]==bl[r]){\n        pd(bl[l]);\n        for(int i=l;i<=r;++i)a[i]+=s+=v;\n\n        s=v*(r-l+1);\n        for(int i=r+1;i<=R[bl[r]];++i)a[i]+=s;\n        build(bl[l]);\n        for(int i=bl[l]+1;i<=bl[n];++i)add[i]+=s;\n        return;\n    }\n    s=v*(L[bl[l]+1]-l+1);\n    for(int i=bl[l]+1;i<bl[r];++i)\n        add[i]+=s,k[i]+=v,s+=blk*v;\n\n    pd(bl[l]);\n    s=0;for(int i=l;i<=R[bl[l]];++i)a[i]+=s+=v;\n    build(bl[l]);\n\n    pd(bl[r]);\n    s=v*(L[bl[r]]-l+1);\n    for(int i=L[bl[r]];i<=r;++i)a[i]+=s,s+=v;\n\n    s=v*(r-l+1);\n    for(int i=r+1;i<=R[bl[r]];++i)a[i]+=s;\n\n    build(bl[r]);\n    for(int i=bl[r]+1;i<=bl[n];++i)add[i]+=s;\n}\nll get(int x){return a[x]+k[bl[x]]*(x-L[bl[x]])+add[bl[x]];}\nll qry(int x){\n    int l=1,r=cnt[x],m;\n    int*sta=st[x];\n    while(l<=r){\n        m=l+r>>1;\n        ll t1=get(sta[m-1]),t2=get(sta[m]),t3=get(sta[m+1]);\n        if(t1<t2&&t2<t3)l=m+1;\n        else{\n            if(t1>t2&&t2>t3)r=m-1;\n            else return t2;\n        }\n    }\n}\nll ask(int l,int r){\n    ll res=-inf;\n    if(bl[l]==bl[r]){\n        for(int i=l;i<=r;++i)cmax(res,get(i));\n        return res;\n    }\n    for(int i=l;i<=R[bl[l]];++i)cmax(res,get(i));\n    for(int i=bl[l]+1;i<bl[r];++i)cmax(res,qry(i));\n    for(int i=r;i>=L[bl[r]];--i)cmax(res,get(i));\n    return res;\n}\nint main(){\n    scanf(\"%d\",&n);blk=sqrt(n);\n    for(int i=1;i<=n;++i)\n        scanf(\"%lld\",a+i),a[i]+=a[i-1],\n        bl[i]=(i-1)/blk+1;\n    a[0]=a[n+1]=-inf;\n    for(int i=1;i<=bl[n];++i)\n        L[i]=R[i-1]+1,R[i]=R[i-1]+blk;\n    R[bl[n]]=n;\n    for(int i=1;i<=bl[n];++i)build(i);\n    scanf(\"%d\",&q);\n    while(q--){\n        int opt,x,y;ll k;\n        scanf(\"%d%d%d\",&opt,&x,&y);\n        if(opt==1)printf(\"%lld\\n\",ask(x,y));\n        else scanf(\"%lld\",&k),upd(x,y,k);\n    }\n}\n```\n", "link": "/posts/LG 4192 \u65c5\u884c\u89c4\u5212/", "tags": ["\u5206\u5757", "\u524d\u7f00\u548c", "\u51f8\u5305"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4108 [HEOI2015]\u516c\u7ea6\u6570\u6570\u5217", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4108&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4108\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5206\u5757\u597d\u9898\n\n> $\\gcd$\u6709\u4e2a\u6027\u8d28: \u4e00\u65e6\u53d8\u52a8\u5219\u5c0f\u4e8e\u539f\u6765\u7684$\\frac 12$(\u6700\u5c0f\u7684\u8d28\u56e0\u5b50\u4e3a$2$)\n> \n> \u90a3\u4e48\u603b\u5171\u6700\u591a$\\log_2 n$\u4e2a\u4e0d\u540c\u7684$\\gcd$\n\n\u6bcf\u4e2a\u5757\u8bb0\u5f55\u7684\u4fe1\u606f:\n\n- \u5757\u5185\u524d\u7f00gcd\n- \u5757\u5185\u524d\u7f00xor\u548c\n\n\u7136\u540e\u5bf9\u5757\u5185\u5143\u7d20\u6309\u524d\u7f00xor\u548c\u6392\u5e8f\n\n\u4fee\u6539\u64cd\u4f5c: \u4fee\u6539\u5bf9\u5e94\u5143\u7d20,\u5e76\u91cd\u6784\u5143\u7d20\u6240\u5728\u5757\n\n\u67e5\u8be2\u64cd\u4f5c\uff1a\n\n\u679a\u4e3e\u6bcf\u4e2a\u5757,\u82e5\u524d\u7f00gcd\u4e0d\u53d8,\u5219\u76f4\u63a5\u5728\u6392\u5e8f\u597d\u7684\u5143\u7d20\u4e2d\u4e8c\u5206\u67e5\u627e\n\n\u5426\u5219\u679a\u4e3e\u5224\u65ad\n\n\u590d\u6742\u5ea6$O(n\\sqrt n \\log n)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint gcd(int a,int b){return b?gcd(b,a%b):a;}\nint n,m,blk,a[N],bl[N],sx[N],sg[N],L[N],R[N];\nstruct node{\n    int v,id;\n    bool operator<(node t){\n        return v!=t.v?v<t.v:id<t.id;\n    }\n}b[N];\nvoid build(int k){\n    int l=L[k],r=R[k];\n    sg[l]=sx[l]=a[l];\n    b[l]=(node){a[l],l};\n    for(int i=l+1;i<=r;++i){\n        sx[i]=sx[i-1]^a[i];\n        sg[i]=gcd(sg[i-1],a[i]);\n        b[i]=(node){sx[i],i};\n    }\n    std::sort(b+l,b+r+1);\n}\ntypedef long long ll;\nvoid ask(){\n    ll v;scanf(\"%lld\",&v);\n    int ans=-1,G=a[1],X=0;\n    for(int i=1;i<=bl[n]&&ans==-1;++i)\n        if(gcd(sg[R[i]],G)!=G){\n            for(int j=L[i];j<=R[i];++j){\n                G=gcd(a[j],G),X^=a[j];\n                if(1ll*G*X==v){ans=j;break;}\n            }\n        }\n        else if(v%G==0){\n            ll c=v/G^X;\n            int l=L[i],r=R[i],p=l;\n            while(l<=r){\n                int m=l+r>>1;\n                if(b[m].v>=c)p=m,r=m-1;\n                else l=m+1;\n            }\n            if(b[p].v==c){ans=b[p].id;break;}\n            G=gcd(sg[R[i]],G),X^=sx[R[i]];\n        }\n        else G=gcd(sg[R[i]],G),X^=sx[R[i]];\n    if(ans==-1)puts(\"no\");\n    else printf(\"%d\\n\",ans-1);\n}\nint main(){\n    scanf(\"%d\",&n);blk=sqrt(n);\n    for(int i=1;i<=n;++i){\n        scanf(\"%d\",a+i);\n        bl[i]=(i-1)/blk+1;\n        if(!L[bl[i]])L[bl[i]]=i;\n        R[bl[i]]=i;\n    }\n    for(int i=1;i<=bl[n];++i)build(i);\n    scanf(\"%d\",&m);\n    char opt[10];\n    for(int i=1;i<=m;++i){\n        scanf(\"%s\",opt);\n        if(opt[0]=='M'){\n            int x,y;scanf(\"%d%d\",&x,&y);\n            ++x,a[x]=y,\n            build(bl[x]);\n        }\n        else ask();\n    }\n}\n```\n", "link": "/posts/LG 4108 [HEOI2015]\u516c\u7ea6\u6570\u6570\u5217/", "tags": ["\u5206\u5757", "\u6570\u8bba", "\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3247 [HNOI2016]\u6700\u5c0f\u516c\u500d\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3247&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3247\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9898\u610f:\n\n\u7ed9\u51fa$n$\u4e2a\u70b9$m$\u6761\u8fb9\u7684\u65e0\u5411\u56fe,\u6bcf\u6761\u8fb9$u\\leftrightarrow v$\u6709\u4e24\u4e2a\u6743\u503c$a,b$\n\n$q$\u4e2a\u8be2\u95ee,\u7ed9\u51fa$u,v,A,B$\u6c42$u,v$\u95f4\u662f\u5426\u5b58\u5728\u8def\u5f84$\\max\\{a\\}=A$\u4e14$\\max\\{b\\}=B$\n\n\u5148\u8003\u8651\u6700\u66b4\u529b\u7684\u505a\u6cd5:\n\n\u628a\u6240\u6709\u7b26\u5408\u6761\u4ef6\u7684\u8fb9($a\\le A,b\\le B$)\u6dfb\u52a0\u5230\u5e76\u67e5\u96c6,\n\n\u7136\u540e\u5224\u65ad\u6700\u5927\u503c\u662f\u4e0d\u662f$A,B$\u3001$u,v$\u662f\u5426\u8fde\u901a\n\n\u63a5\u7740\u5bf9\u8fb9\u6392\u5e8f\u3001\u56de\u6eda\u83ab\u961f,\u4f7f\u7528\u6309\u79e9\u5408\u5e76\u5e76\u67e5\u96c6(\u53ef\u64a4\u9500\u5e76\u67e5\u96c6)\n\n\u5bf9$m$\u6761\u8fb9\u6309$a$\u8fdb\u884c\u6392\u5e8f\n\n\u5bf9\u8be2\u95ee\u6309$b$\u8fdb\u884c\u6392\u5e8f\n\n\u5bf9$m$\u6761\u8fb9\u8fdb\u884c\u5206\u5757\n\n\u5bf9\u6bcf\u4e2a\u5757\u5904\u7406\u7b26\u5408$a$\u5927\u4e8e\u7b49\u4e8e\u8be5\u5757$\\max\\{a\\}$\u7684\u8be2\u95ee\n\n\u628a\u5f53\u524d\u5757\u524d\u9762\u7684\u70b9\u6309\u7167$b$\u6392\u5e8f(\u4f7f$b$\u5355\u8c03\u9012\u589e)\n\n\u5f00\u59cb\u5904\u7406\u8be2\u95ee:\n\n\u5f53\u524d\u5757\u524d\u9762\u7684\u70b9\u7684$b$\u662f\u5355\u8c03\u9012\u589e\u7684,\u800c$a$\u4e00\u5b9a\u7b26\u5408\u6761\u4ef6\n,\u6240\u4ee5\u53ef\u4ee5\u4e00\u76f4\u53f3\u79fb\u6307\u9488\u6dfb\u52a0\u7b26\u5408\u6761\u4ef6\u7684\u8fb9\n\n\u7136\u540e\u679a\u4e3e\u5757\u4e2d\u7684\u8fb9,\u6dfb\u52a0\u7b26\u5408\u5f53\u524d\u8be2\u95ee\u7684\u8fb9,\u5f97\u5230\u5f53\u524d\u8be2\u95ee\u7b54\u6848,\u56de\u6eda,\u5220\u6389\u5f53\u524d\u8be2\u95ee\u6dfb\u52a0\u7684\u8fb9\n\n\u4e0b\u4e00\u4e2a\u8be2\u95ee\n\n\u5904\u7406\u5b8c\u5f53\u524d\u5757\u540e,\u66b4\u529b\u6e05\u7a7a\u5e76\u67e5\u96c6\n\n\u5206\u5757\u5927\u5c0f\u4e3a$\\sqrt{m\\log n}$\u65f6\u590d\u6742\u5ea6\u6700\u4f18\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,m,k,blk,f[N],siz[N],ma[N],mb[N],tp=0;\nbool ans[N];\nint gf(int x){return x==f[x]?x:gf(f[x]);}\nstruct edge{\n    int u,v,a,b,k;\n    void in(){scanf(\"%d%d%d%d\",&u,&v,&a,&b);}\n}a[N],q[N],c[N],d[N];\nvoid cmax(int&x,int y){if(y>x)x=y;}\nvoid mg(edge x,bool typ=0){\n    int u=gf(x.u),v=gf(x.v);\n    if(siz[u]>siz[v])u^=v,v^=u,u^=v;\n    if(typ)d[++tp]=(edge){u,v,ma[v],mb[v],siz[v]};\n    if(u!=v)\n        f[u]=v,siz[v]+=siz[u],\n        cmax(ma[v],ma[u]),cmax(mb[v],mb[u]);\n    cmax(ma[v],x.a),cmax(mb[v],x.b);\n}\nvoid br(edge x){\n    f[x.u]=x.u;\n    ma[x.v]=x.a,mb[x.v]=x.b,siz[x.v]=x.k;\n}\nbool cmpa(edge x,edge y){return x.a==y.a?x.b<y.b:x.a<y.a;}\nbool cmpb(edge x,edge y){return x.b==y.b?x.a<y.a:x.b<y.b;}\nint main(){\n    scanf(\"%d%d\",&n,&m);blk=sqrt(m*log2(n));\n    for(int i=1;i<=m;++i)a[i].in();\n    scanf(\"%d\",&k);\n    for(int i=1;i<=k;++i)q[i].in(),q[i].k=i;\n    std::sort(a+1,a+m+1,cmpa);\n    std::sort(q+1,q+k+1,cmpb);\n    for(int i=blk;i<=m;i+=blk){\n        for(int j=1;j<=n;++j)\n            f[j]=j,siz[j]=1,ma[j]=mb[j]=-1;\n        int tt=0;\n        for(int j=1;j<=k;++j)\n            if(a[i].a<=q[j].a&&(a[i+blk].a>q[j].a||i+blk>m))\n                c[++tt]=q[j];\n        if(!tt)continue;\n        std::sort(a+1,a+i,cmpb);\n        for(int j=1,t=1;j<=tt;++j){\n            for(;t<i&&a[t].b<=c[j].b;++t)mg(a[t]);\n            for(int l=i;l<i+blk&&l<=m;++l)\n                if(a[l].a<=c[j].a&&a[l].b<=c[j].b)mg(a[l],1);\n            int u=gf(c[j].u),v=gf(c[j].v);\n            ans[c[j].k]=(u==v&&ma[u]==c[j].a&&mb[u]==c[j].b);\n            while(tp)br(d[tp--]);\n        }\n    }\n    for(int i=1;i<=k;++i)puts(ans[i]?\"Yes\":\"No\");\n}\n```\n", "link": "/posts/LG 3247 [HNOI2016]\u6700\u5c0f\u516c\u500d\u6570/", "tags": ["\u6570\u8bba", "\u83ab\u961f", "\u56de\u6eda\u83ab\u961f", "\u79bb\u7ebf", "\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "ZOJ 3998 Yet Another Data Structure Problem", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nhttps://zoj.pintia.cn/problem-sets/91827364500/problems/91827370149\n\n\u9898\u610f:\n\n\u7ed9\u4e00\u4e2a\u5e8f\u5217A,\u8981\u6c42\u652f\u6301\u4ee5\u4e0b\u64cd\u4f5c:\n\n1. \u533a\u95f4\u4e58\n   \n2. \u533a\u95f4\u91cc\u6240\u6709\u6570\u90fd\u53d8\u6210\u81ea\u5df1\u7684$k$\u6b21\u5e42\n   \n3. \u6c42\u533a\u95f4\u4e58\u79ef(mod 10000000007)\n\n\u7531\u4e8e\u6a21\u6570\u662f\u8d28\u6570,\u6240\u4ee5\u53ef\u4ee5\u5c06\u6bcf\u4e2a\u6570\u90fd\u53d8\u6210\u539f\u6839\u7684\u6b21\u5e42\n\n\u8fd9\u6837\u533a\u95f4\u4e58\u8f6c\u5316\u4e3a\u533a\u95f4\u52a0,\u533a\u95f4\u6b21\u5e42\u8f6c\u5316\u4e3a\u533a\u95f4\u4e58,\u6c42\u533a\u95f4\u4e58\u79ef\u8f6c\u5316\u4e3a\u6c42\u533a\u95f4\u548c\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011,p=1000000007,P=p-1,G=5;\nint rd(){int x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return f?-x:x;}\nint n,q,s[N<<2],add[N<<2],mul[N<<2];\nint v[]={0,0,381838282,884237698,763676564,1,266075974,936544532,145514840,768475390,381838283,649233168,647914256,144547565,318382808,884237699,527353122,895459693,150313666,701153241,763676565,820782224,31071444,82047235,29752532,2,526385847,652713082,700221090,347375814,266075975,198670980,909191404,533470860,277297969,936544533,532151948,289190395,82991517,28785257,145514841,802264261,202620500,24616936,412909726,768475391,463885517,730741137,411590814,873089058,381838284,779697385,908224129,616590335,34551358,649233169,82059366,585390933,729214096,178404868,647914257,234516540,580509262,705019916,291029680,144547566,915309142,351358075,659136251,966284933,318382809,557546595,913990230,559624399,671028677,884237700,464829799,585777694,410623539,414776906,527353123,536950774,184102537,809672376,584458782,895459694,406455218,231613506,794748008,689565125,150313667,81092091,845723799,82908672,112579413,701153242,793429096,993378125,254927334,417708552,763676566,495914368,161535661,991051336,290062405,820782225,998428617,326036185,416389640,525353314,31071445,173428087,463897648,429750477,967229215,82047236,111052372,913022955,560243150,832004219,29752533,298466330,616354822,686501953,962347544,3,86858192,155622902,672867962,908854634,526385848,26958408,297147418,637697767,733196357,652713083,40974527,540374100,348123209,293399235,700221091,614978829,939384877,793780733,295828506,347375815,941462681,757326750,52866953,109607515,266075976,468364065,846668081,663935077,967615976,198670981,792461821,967234449,796615188,500828027,909191405,18591761,918789056,238291131,565940819,533470861,191510652,98758628,966297064,289095130,277297970,469628625,788293500,328851128,613451788,936544534,176586284,62642560,71403401,492996069,532151949,546888614,462930373,118754232,227562075,289190396,464746954,544692855,494417695,589257608,82991518,366164793,175267372,23539458,375216401,28785258,636765616,829772542,799546834,912024915,145514842,235595767,877752650,283920340,543373943,802264262,372889612,850522625,671900687,350386403,202620501,437098732,380266893,441784287,707874467,24616937,798227922,135215506,907191596,443862091,412909727,40007252,555266369,768794522,845735930,768475392,811588759,342799273,349067491,566661897,463885518,470015386,492890654,924677391,294861231,730741138,942081432,299014598,213842495,732754158,411590815,733768720,680304612,421188466,998193104,873089059,68340229,845700806,344185820,693910068,381838285,241119035,468696474,731280403,537461184,779697386,54706238,17661842,290692910,225734921,908224130,115851198,408796690,872301485,678985700,616590336,19536043,573802817,115034633,298959763,34551359,462560014,422812809,965329789,922212382,649233170,729961491,31035300,675237517,967146370,82059367,345578910,996817111,82704431,321223153,585390934,175619009,738808787,677666788,790919380,729214097,877615817,323300957,912101836,139165026,178404869,434705235,301946244,491445797,226594800,647914258,961161468,850202347,380152060,228506357,234516541,45773353,235180417,349454252,875289028,580509263,800796434,174300097,489302579,349072725,705019917,178453464,145590444,882666309,996608982,291029681,210273877,400430043,596612928,300627332,144547567,620129413,409591006,947779101,667285663,915309143,602268191,573348934,57665779,480596910,351358076,348135340,319223134,670933412,313988169,659136252,847904148,851466907,809633584,170131776,966284934,710689410,312731484,995290070,329982019,318382810,797260647,558424566,533507235,444480842,557546596,453241683,716241911,874834351,366249874,913990231,402306476,928726896,182704022,844768655,559624400,500592514,368582295,609400357,570739645,671028678,553134861,846585236,624185975,926531137,884237701,876255977,491923379,971095890,18654643,464829800,39860594,748003075,970055489,557105654,585777695,405377740,793092326,757054683,720569060,410623540,977506928,18603892,911196106,211610818,414776907,181385110,648104085,293863191,521935459,527353124,574882870,617434049,343218545,259590926,536950775,665758622,938423563,925212225,324474452,184102538,424611792,754727894,114949394,232360901,809672377,53738963,177636927,732224685,247548773,584458783,485092561,818937014,499216521,762105175,895459695,823622569,171061066,89712743,678018425,406455219,22572234,180066198,946054688,517053788,231613507,289029872,783200476,825700373,340871020,794748009,641564442,421845534,129669796,937104651,689565126,150632798,993845213,227574206,977541982,150313668,451497423,193427035,352601757,724637555,81092092,730905773,761838722,948500179,548172769,845723800,475803029,851853668,919505556,874728936,82908673,306515667,410804030,676699513,287902601,112579414,851472141,323919708,673850104,680852880,701153243,595680777,385065719,114592434,146327964,793429097,433737960,115606996,902829459,62142888,993378126,803026748,727424537,380031380,122528823,254927335,687842587,450178511,242835501,227539082,417708553,726024102,494091121,75748344,615613462,763676567,982996326,622957317,192803239,850534756,495914369,113118679,173332822,919299466,734145295,161535662,496168925,436544520,353866317,399500124,991051337,672531192,379974299,607573203,213088820,290062406,486914916,497689480,636072233,790634972,820782226,254139761,94130667,60823976,164094470,998428618,946880258,401374325,946811826,955641099,326036186,496872915,377233761,680798045,522322220,416389641,794831137,844398296,431126306,804651091,525353315,347168065,659991722,304050658,2991924,31071446,48529049,111799767,351321432,412873582,173428088,57075793,377246546,348984646,169164501,463897649,428930547,727417192,427073348,378655387,429750478,464542713,473495300,703061435,835310771,967229216,678916854,557457291,250402485,120647063,82047237,59505064,298408322,172757656,907777156,111052373,746216902,259454093,265823497,705139239,913022956,293940112,195024716,521003308,899824221,560243151,714010234,816543517,708296745,683784526,832004220,873284079,796262607,608433082,696897442,29752534,748641546,342999744,119833459,232040623,298466331,761990342,986766785,610344639,168158032,616354823,875288702,427611635,307293942,617018699,686501954,731292534,368755462,257127304,314280758,962347545,734760317,182634710,626109651,556138379,4,871140861,234624095,730911007,184650082,86858193,385696585,560291746,321336424,527428726,155622903,264504585,17636617,378447258,326021979,672867963,81412879,592112159,158329748,782268325,908854635,978451210,614024899,682465614,827638036,526385849,19453198,1967689,443555346,791429288,26958409,329617377,328099783,49123939,342531174,297147419,491028875,984106473,924244950,955187216,637697768,439504061,429423049,862435192,653032214,733196358,883749708,729973622,247787358,701061416,652713084,52771688,936414888,695826451,929922651,40974528,227036965,229742424,656202916,233305183,540374101,191471860,450899589,551970058,761137900,348123210,957940143,92527686,354253078,694569766,293399236,377128346,697723948,711820301,808915083,700221092,421457424,179098923,990343636,940262848,614978830,915345517,432458894,826319124,696576885,939384878,183252290,835079965,280718215,98080187,793780734,256672627,616991850,748088156,544104739,295828507,927595862,784144758,618006412,310565172,347375816,564542304,978569639,226606931,305426158,941462682,920076629,882430796,921332824,750420577,757326751,991238639,591237,952577927,114605847,52866954,729938498,934973143,695101199,228423512,109607516,6024251,578147760,308369413,262580711,266075977,709275566,258094253,125356727,873761661,468364066,352934166,539586166,400492925,615518095,846668082,319462292,421698876,461897840,129841351,663935078,351893765,322952433,938943936,518957057,967615977,901899540,787216022,791579360,174930602,198670982,138892959,109972613,102407336,503417496,792461822,206779757,359345204,88890,400442174,967234450,293034382,270431985,593449100,756539177,796615189,366295003,563223392,379064105,29942361,500828028,675701473,941189873,903773741,626200824,909191406,458040509,956721152,208857561,999272331,18591762,725056827,183197455,641429208,378740433,918789057,171504504,47596898,346797706,320261839,238291132,307050501,725770177,706312734,849567481,565940820,607079689,806450074,891734457,136566170,533470862,496787676,689646277,614199183,613043530,191510653,915272998,435577245,768548745,559475209,98758629,114062961,851384062,629387055,164451860,966297065,694751628,866930843,229816602,200775290,289095131,881054803,235010856,143943451,966942129,277297971,371237630,205460845,516096998,552899348,469628626,471551025,241952849,59856701,239248300,788293501,623046479,404410516,937618645,561904480,328851129,327892964,675157072,898892070,64010068,613451789,495905640,670868154,761853509,165038752,936544535,207538649,403193844,722709302,796339528,176586285,903509641,23402718,991122233,803683816,62642561,511508078,310672493,318942927,92167428,71403402,186183936,532471080,431894372,375683489,492996070,609412488,110832492,359380258,546046794,532151950,512050022,833335705,845399160,575265317,546888615,734440039,668881664,106475831,264389752,462930374,700685266,112744049,458905538,143676998,118754233,330338455,963502940,930011051,492514271,227562076,119418109,857641311,702094160,233691944,289190397,301343832,759526720,256567212,798432364,464746955,574242293,688353949,685034126,792642312,544692856,58537789,889171523,669740883,373540271,494417696,630233002,233310417,884311496,705757990,589257609,55688380,964453890,62691156,704171964,82991519,29828136,977519059,772408781,766904001,366164794,496430716,880846674,528166246,476918626,175267373,397341960,815576242,94511569,497445278,23539459,284667735,815035131,443981170,480850620,375216402,962094621,184865024,229943761,109262813,28785259,761869662,545661558,504367105,338798287,636765617,293828698,69680863,331110272,832016793,829772543,624673783,551523355,609377364,106664171,799546835,728364560,107862378,486505883,875929403,912024916,457586626,65098646,997451744,941903477,145514843,730325259,364834602,73864555,4795593,235595768,574641521,317743570,232373032,990413208,877752651,203460826,494956961};\n#define ls rt<<1\n#define rs rt<<1|1\nvoid mod(int&x){if(x>=P)x-=P;}\nvoid Mul(int&x,int y){x=1ll*x*y%P;}\nvoid pu(int rt){mod(s[rt]=s[ls]+s[rs]);}\nvoid build(int l,int r,int rt){\n    add[rt]=0,mul[rt]=1;\n    if(l==r){\n        s[rt]=v[rd()];\n        return;\n    }\n    int m=l+r>>1;\n    build(l,m,ls),build(m+1,r,rs);\n    pu(rt);\n}\nvoid pd(int rt,int ln,int rn){\n    if(mul[rt]^1){\n        Mul(s[ls],mul[rt]);\n        Mul(s[rs],mul[rt]);\n        Mul(mul[ls],mul[rt]);\n        Mul(mul[rs],mul[rt]);\n        Mul(add[ls],mul[rt]);\n        Mul(add[rs],mul[rt]);\n        mul[rt]=1;\n    }\n    if(add[rt]){\n        mod(s[ls]+=1ll*add[rt]*ln%P);\n        mod(s[rs]+=1ll*add[rt]*rn%P);\n        mod(add[ls]+=add[rt]);\n        mod(add[rs]+=add[rt]);\n        add[rt]=0;\n    }\n}\nvoid updm(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        Mul(s[rt],v),Mul(mul[rt],v),Mul(add[rt],v);\n        return;\n    }\n    int m=l+r>>1;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)updm(L,R,v,l,m,ls);\n    if(R>m)updm(L,R,v,m+1,r,rs);\n    pu(rt);\n}\nvoid upda(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        mod(s[rt]+=1ll*v*(r-l+1)%P),mod(add[rt]+=v);\n        return;\n    }\n    int m=l+r>>1;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)upda(L,R,v,l,m,ls);\n    if(R>m)upda(L,R,v,m+1,r,rs);\n    pu(rt);\n}\nint ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=l+r>>1,ans=0;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)mod(ans+=ask(L,R,m+1,r,rs));\n    return ans;\n}\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%p;\n        b>>=1,x=1ll*x*x%p;\n    }\n    return res;\n}\nvoid solve(){\n    n=rd(),q=rd();\n    build(1,n,1);\n    while(q--){\n        int opt=rd(),l=rd(),r=rd();\n        if(opt==1)upda(l,r,v[rd()],1,n,1);\n        else if(opt==2)updm(l,r,rd(),1,n,1);\n        else printf(\"%lld\\n\",pw(G,ask(l,r,1,n,1)));\n    }\n}\nint main(){for(int T=rd();T--;)solve();}\n```\n", "link": "/posts/ZOJ 3998 Yet Another Data Structure Problem/", "tags": ["\u7ebf\u6bb5\u6811", "\u539f\u6839", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LOJ 6187 Odd", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://loj.ac/problem/6187&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://loj.ac/problem/6187\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5f02\u6216\u4e00\u4e2a\u6570\u4e24\u6b21,\u53ef\u4ee5\u62b5\u6d88\n\n\u6211\u4eec\u53ef\u4ee5\u7ed9\u533a\u95f4\u4e2d\u6240\u6709\u76f8\u540c\u7684\u6570\u90fd\u8d4b\u4e00\u4e2a\u65b0\u7684\u968f\u673a\u6570\u503c,\u9632\u6b62\u5f02\u6216\u65f6\u51fa\u73b0\u5e72\u6270\n\n\u8bbe$pre_i$\u4e3a$i$\u4f4d\u7f6e\u7684\u6570\u4e0a\u4e00\u6b21\u51fa\u73b0\u7684\u6570,$v_i$\u4e3a\u4f4d\u7f6e$i$\u65b0\u8d4b\u503c\u7684\u6570,$S_i$\u4e3a\u5f02\u6216\u524d\u7f00\u548c\n\n\u82e5\u533a\u95f4$[l,r]$\u4e2d\u6240\u6709\u6570\u51fa\u73b0\u7684\u6570\u51fa\u73b0\u7684\u6b21\u6570\u662f\u5947\u6570,\u90a3\u4e48$S_r\\oplus S_{l-1}$\u7b49\u4e8e$\\{v_i|pre_i<x,i\\in [l,r]\\}$\u7684\u5f02\u6216\u548c\n\n\u679a\u4e3e$r$,\u8bbe$p_x$\u4e3a$\\{v_i|pre_i<x,i\\in [x,r]\\}$\u5f02\u6216\u548c\n\n\u90a3\u4e48\u76f8\u5f53\u4e8e\u6c42\u6ee1\u8db3$S_r\\oplus S_{x-1}\\oplus p_x=0$\n\n\u5f53$r$\u53d8\u4e3a$r+1$,$\\{p_i|i\\in [pre_{r+1}+1,r]\\}$\u5f02\u6216\u4e0a$v_{r+1}$\n\n\u95ee\u9898\u4e5f\u5c31\u8f6c\u5316\u4e3a\u4e86: \u533a\u95f4\u5f02\u6216,\u533a\u95f4\u67e5\u8be2\u67d0\u4e2a\u6570\u51fa\u73b0\u6b21\u6570\n\n\u4f7f\u7528\u5206\u5757+hash\u89e3\u51b3\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace IO{\n\tchar buf[1<<20|5];\n\tconst char *ed=buf+(1<<20);\n\tchar *st=buf+(1<<20);\n\t#define gc() (((st==ed)?(fread(buf,1,1<<20,stdin),st=buf):0),*st++)\n\ttemplate<class T>inline void rd(T &x){\n    \tchar ch;x=0;\n    \tdo ch = gc();while(ch<'0' or ch>'9');\n    \twhile(ch>='0' and ch<= '9')x=x*10+(ch&15),ch=gc();\n    }\n    #undef gc\n};\ntypedef unsigned long long ll;\nconst int N=200011,P=10007;\nstruct hash{\n\tint head[P+1],cnt;\n\tstruct edge{int nxt;ll to,w;}e[20000];\n\thash(){cnt=0;}\n\tll&operator()(ll n,bool t=1){\n\t\tint x=n%P+1;\n\t\tfor(int i=head[x];i;i=e[i].nxt)\n\t\t\tif(e[i].to==n)return e[i].w;\n\t\tif(t){\n\t\t\te[++cnt].to=n,e[cnt].nxt=head[x],head[x]=cnt;\n\t\t\treturn e[cnt].w=0;\n\t\t}\n\t\telse return e[0].w;\n\t}\n\tvoid init(){while(cnt)head[e[cnt--].to%P+1]=0;}\n}T[450];\nint n,blk,pre[N],b[1000001],bl[N],L[450],R[450];\nll a[N],s[N],laz[450],p[N],rnd[1000001];\nvoid build(int k){\n\tT[k].init();\n\tfor(int i=L[k];i<=R[k];++i)++T[k](p[i]);\n}\nvoid add(int l,int r,ll v){\n\tif(bl[l]==bl[r]){\n\t\tfor(int i=l;i<=r;++i)p[i]^=v;\n\t\tbuild(bl[l]);\n\t\treturn;\n\t}\n\tfor(int i=l;bl[i]==bl[l];++i)p[i]^=v;\n\tfor(int i=bl[l]+1;i<bl[r];++i)laz[i]^=v;\n\tfor(int i=r;bl[i]==bl[r];--i)p[i]^=v;\n\tbuild(bl[l]),build(bl[r]);\n}\nint ask(int r){\n\tint res=0;ll v=s[r];\n\tfor(int i=1;i<bl[r];++i)\n\t\tres+=T[i](v^laz[i],0);\n\tv^=laz[bl[r]];\n\tfor(int i=r;bl[i]==bl[r];--i)\n\t\tif(v==p[i])++res;\n\treturn res;\n}\nint main(){\n\tll ans=0;\n\tIO::rd(n);blk=sqrt(n);\n\trnd[0]=233;\n\tfor(int i=1;i<=1000000;++i)rnd[i]=rnd[i-1]*482711ll;\n\tfor(int i=1;i<=n;++i){\n\t\tll x;IO::rd(x);\n\t\tpre[i]=b[x],b[x]=i;\n\t\ts[i]=s[i-1]^(a[i]=rnd[x]);\n\t\tbl[i]=(i-1)/blk+1;\n\t\t++T[bl[i]](p[i]=s[i-1]);\n\t}\n\tfor(int i=1;i<=bl[n];++i)\n\t\tL[i]=R[i-1]+1,R[i]=R[i-1]+blk;\n\tR[bl[n]]=n;\n\t\n\tfor(int i=1;i<=n;++i)\n\t\tadd(pre[i]+1,i,a[i]),\n\t\tans+=ask(i);\n\t\t\n\tprintf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LOJ 6187 Odd/", "tags": ["hash", "\u5206\u5757", "\u968f\u673a"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4173 \u6b8b\u7f3a\u7684\u5b57\u7b26\u4e32", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4173&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4173\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe\u901a\u914d\u7b26\u7684\u6570\u503c\u4e3a$0$,\u5b9a\u4e49\u5339\u914d\u51fd\u6570$C(x,y)=[A(x)-B(y)]^2A(x)B(y)$,\u90a3\u4e48$\\displaystyle P(x)=\\sum_{i=0}^{m-1}[A(i)-B(x-m+i+1)]^2A(i)B(x-m+i+1)$\n\n\u6309\u7167\u5957\u8def,\u7ffb\u8f6c$A$\u4e32\u5f97\u5230$S$\u4e32:\n\n$\\displaystyle\n\\begin{aligned}\nP(x)\n&=\\sum_{i=0}^{m-1}[A(i)-B(x-m+i+1)]^2A(i)B(x-m+i+1)\\\\\n&=\\sum_{i=0}^{m-1}[S(m-i+1)-B(x-m+i+1)]^2S(m-i+1)B(x-m+i+1)\\\\\n&=\\sum_{i=0}^{m-1}S(m-i+1)^3B(x-m+i+1)+\\\\\n&\\quad\\sum_{i=0}^{m-1}B(x-m+i+1)^3S(m-i+1)-\\\\\n&\\quad2\\sum_{i=0}^{m-1}S(m-i+1)^2B(x-m+i+1)^2\n\\end{aligned}$\n\n\u5199\u4e3a\u5377\u79ef\u5f62\u5f0f:\n\n$\\displaystyle P(x)=\\sum_{i+j=x}S(i)^3B(j)+S(i)B(j)^3-2S(i)^2B(j)^2$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1100011;\nint n,m,L,r[N],l,a[N],b[N],ans[N],tt;\nchar s1[N],s2[N];\ntypedef double db;\nconst db Pi=acos(-1);\nstruct cp{db r,i;cp(db R=0,db I=0){r=R,i=I;}}A[N],B[N],AS[N];\ncp operator+(cp a,cp b){return cp(a.r+b.r,a.i+b.i);}\ncp operator-(cp a,cp b){return cp(a.r-b.r,a.i-b.i);}\ncp operator*(cp a,cp b){return cp(a.r*b.r-a.i*b.i,a.r*b.i+a.i*b.r);}\nvoid swap(cp&x,cp&y){cp t=x;x=y;y=t;}\nvoid fft(cp*A,int typ){\n    for(int i=0;i<L;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<L;len<<=1){\n        cp Wn(cos(Pi/len),typ*sin(Pi/len));\n        for(int i=0;i<L;i+=len<<1){\n            cp w(1,0);\n            for(int k=0;k<len;++k){\n                cp t=w*A[i+k+len];\n                A[i+k+len]=A[i+k]-t;\n                A[i+k]=A[i+k]+t;\n                w=w*Wn;\n            }\n        }\n    }\n    if(~typ)return;\n    for(int i=0;i<L;++i)\n        A[i].r/=L,A[i].i/=L;\n}\nint main(){\n    scanf(\"%d%d%s%s\",&m,&n,s1,s2);\n    std::reverse(s1,s1+m);\n    for(int i=0;i<m;++i)a[i]=s1[i]=='*'?0:s1[i]-'a'+1;\n    for(int i=0;i<n;++i)b[i]=s2[i]=='*'?0:s2[i]-'a'+1;\n\n    for(L=1,l=0;L<n+n;L<<=1,++l);\n    for(int i=0;i<L;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    \n    for(int i=0;i<L;++i)\n        A[i]=cp(a[i]*a[i]*a[i],0),\n        B[i]=cp(b[i],0);\n    fft(A,1),fft(B,1);\n    for(int i=0;i<L;++i)AS[i]=AS[i]+A[i]*B[i];\n\n    for(int i=0;i<L;++i)\n        A[i]=cp(a[i],0),\n        B[i]=cp(b[i]*b[i]*b[i],0);\n    fft(A,1),fft(B,1);\n    for(int i=0;i<L;++i)AS[i]=AS[i]+A[i]*B[i];\n\n    for(int i=0;i<L;++i)\n        A[i]=cp(a[i]*a[i],0),\n        B[i]=cp(b[i]*b[i],0);\n    fft(A,1),fft(B,1);\n    for(int i=0;i<L;++i)AS[i]=AS[i]-A[i]*B[i]*cp(2,0);\n\n    fft(AS,-1);\n    for(int i=m-1;i<n;i++)\n        if(fabs(AS[i].r)<0.5)ans[++tt]=i-m+2;\n    printf(\"%d\\n\",tt);\n    for(int i=1;i<=tt;++i)printf(\"%d \",ans[i]);\n}\n```\n", "link": "/posts/LG 4173 \u6b8b\u7f3a\u7684\u5b57\u7b26\u4e32/", "tags": ["fft", "\u5b57\u7b26\u4e32"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4091[TJOI2016]\u6c42\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4091&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4091\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$f(n)=\\sum_{i=0}^n \\sum_{j=0}^i \\begin{Bmatrix}i\\\\j\\end{Bmatrix} 2^j j!$$\n\n\u8003\u8651\u5230$i<j$\u65f6$\\begin{Bmatrix}i\\\\j\\end{Bmatrix}=0$ :\n\n$$\nf(n)=\\sum_{j=0}^n 2^j j! \\sum_{i=0}^n \\begin{Bmatrix}i\\\\j\\end{Bmatrix}\\\\\n=\\sum_{j=0}^n 2^j j! \\sum_{i=0}^n \\sum_{k=0}^j \\frac{(-1)^k}{k!} \\frac{(j-k)^i}{(j-k)!}\\\\\n=\\sum_{j=0}^n 2^j j! \\sum_{k=0}^j \\frac{(-1)^k}{k!} \\frac{\\sum_{i=0}^n (j-k)^i}{(j-k)!}\n$$\n\n\u8bbe$\\displaystyle g(k)=\\frac{(-1)^k}{k!}, h(k)=\\frac{\\sum_{i=0}^n k^i}{k!}=\\frac{k^{n+1}-1}{(k-1)k!}$ ,\n\n\u7279\u522b\u7684: $h(0)=1,h(1)=n+1$\n\n\u90a3\u4e48\n\n$$f(n)=\\sum_{j=0}^n 2^j j! (g\\times h)(j)$$\n\n\u5377\u79ef\u540e\u5373\u53ef\u8ba1\u7b97\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=262144,P=998244353,G=3,Gi=332748118;\nint fac[N],ifac[N],inv[N],L,r[N],h[N],g[N];\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%P;\n        b>>=1;x=1ll*x*x%P;\n    }\n    return res;\n}\nvoid getL(int n){\n    for(L=1;L<n;L<<=1);\n    for(int i=0;i<L;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)?(L>>1):0);\n}\nvoid swap(int&x,int&y){x^=y,y^=x,x^=y;}\nvoid ntt(int*A,int typ){\n    for(int i=0;i<L;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<L;len<<=1){\n        int Wn=pw(~typ?G:Gi,(P-1)/(len<<1));\n        for(int i=0;i<L;i+=len<<1){\n            int w=1;\n            for(int k=0;k<len;++k){\n                int t=1ll*A[i+k+len]*w%P;\n                A[i+k+len]=(A[i+k]-t+P)%P;\n                A[i+k]=(A[i+k]+t)%P;\n                w=1ll*w*Wn%P;\n            }\n        }\n    }\n    if(~typ)return;\n    int iL=pw(L,P-2);\n    for(int i=0;i<L;++i)A[i]=1ll*A[i]*iL%P;\n}\nint main(){\n    int n;scanf(\"%d\",&n);\n\n    inv[1]=1;\n    for(int i=2;i<=n;++i)inv[i]=1ll*(P-P/i)*inv[P%i]%P;\n\n    fac[0]=1;\n    for(int i=1;i<=n;++i)fac[i]=1ll*fac[i-1]*i%P;\n    ifac[n]=pw(fac[n],P-2);\n    for(int i=n;i;--i)ifac[i-1]=1ll*ifac[i]*i%P;\n\n    g[0]=1,g[1]=P-1;\n    h[0]=1,h[1]=n+1;\n    for(int i=2;i<=n;++i)\n        g[i]=(i&1)?P-ifac[i]:ifac[i],\n        h[i]=1ll*(pw(i,n+1)-1)*ifac[i]%P*inv[i-1]%P;\n    \n    getL(n<<1);\n    ntt(g,1),ntt(h,1);\n    for(int i=0;i<L;++i)\n        g[i]=1ll*g[i]*h[i]%P;\n    ntt(g,-1);\n    \n    int ans=0;\n    for(int i=0,p2=1;i<=n;++i,p2=(p2+p2)%P)\n        (ans+=1ll*p2*fac[i]%P*g[i]%P)%=P;\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 4091[TJOI2016]\u6c42\u548c/", "tags": ["\u6570\u8bba", "\u65af\u7279\u6797\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5906 \u3010\u6a21\u677f\u3011\u56de\u6eda\u83ab\u961f&\u4e0d\u5220\u9664\u83ab\u961f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5906&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5906\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=200011;\nint n,m,blk,nn,a[N],ans[N],mi[N],ma[N],clr[N],pre[N];\nstruct node{\n    int v,id;\n    bool operator<(node t){return v<t.v;}\n}b[N];\nstruct que{\n    int l,r,id,pl,pr;\n    bool operator<(que t){return pl!=t.pl?l<t.l:r<t.r;}\n}q[N];\nvoid cmax(int&x,int y){if(y>x)x=y;}\nint main(){\n    scanf(\"%d\",&n);blk=sqrt(n);\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\",&b[i].v),b[i].id=i;\n    std::sort(b+1,b+n+1);\n    for(int i=1;i<=n;++i)\n        a[b[i].id]=nn+=b[i].v!=b[i-1].v;\n    scanf(\"%d\",&m);\n    int l,r;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d\",&l,&r),\n        q[i]=(que){l,r,i,(l-1)/blk+1,(r-1)/blk+1};\n    std::sort(q+1,q+m+1);\n    int tot=(n-1)/blk+1;\n    for(int now=1,i=1,R=blk;now<=tot;R+=blk,++now){\n        if(R>n)R=n;\n        int l=R+1,r=R,mx=0,tt=0;\n        for(;q[i].pl==now;++i){\n            if(q[i].pr==now){\n                for(int j=q[i].l;j<=q[i].r;++j)\n                    if(!pre[a[j]])pre[a[j]]=j;\n                    else cmax(ans[q[i].id],j-pre[a[j]]);\n                for(int j=q[i].l;j<=q[i].r;++j)pre[a[j]]=0;\n                continue;\n            }\n            while(r<q[i].r){\n                ++r;\n                ma[a[r]]=r;\n                if(!mi[a[r]])mi[a[r]]=r,clr[tt++]=a[r];\n                else cmax(mx,r-mi[a[r]]);\n            }\n            ans[q[i].id]=mx;\n            while(l>q[i].l){\n                --l;\n                if(ma[a[l]])cmax(ans[q[i].id],ma[a[l]]-l);\n                else ma[a[l]]=l;\n            }\n            for(;l<=R;++l)if(ma[a[l]]==l)ma[a[l]]=0;\n        }\n        while(tt--)mi[clr[tt]]=ma[clr[tt]]=0;\n    }\n    for(int i=1;i<=m;++i)\n        printf(\"%d\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG 5906 \u3010\u6a21\u677f\u3011\u56de\u6eda\u83ab\u961f&\u4e0d\u5220\u9664\u83ab\u961f/", "tags": ["\u83ab\u961f", "\u79bb\u7ebf"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4458 [BJOI2018]\u94fe\u4e0a\u4e8c\u6b21\u6c42\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4458&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4458\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$s$\u4e3a$a$\u7684\u524d\u7f00\u548c,$S$\u4e3a$s$\u7684\u524d\u7f00\u548c\n\n$$\n\\begin{aligned}\nans\n&=\\sum_{i=l}^r \\sum_{j=i}^n s_j-s_{j-i}\\\\\n&=\\sum_{i=l}^r\\left(\\sum_{j=i}^n s_j-\\sum_{j=i}^ns_{j-i}\\right)\\\\\n&=\\sum_{i=l}^r\\left(\\sum_{j=1}^n s_j - \\sum_{j=1}^{i-1} s_j -\\sum_{j=0}^{n-i}s_j\\right)\\\\\n&=\\sum_{i=l}^r ( S_n-S_{i-1}-S_{n-i})\\\\\n\\end{aligned}\n$$\n\n\u7ebf\u6bb5\u6811\u7ef4\u62a4$S$\u5373\u53ef,\u5982\u4f55\u7ef4\u62a4$S$?\n\n\u5047\u8bbe$[l,r]$\u533a\u95f4\u52a0$v$,\n\n\u4ee4$g_i=1+2+3+\\dots+i=\\frac{i(i+1)}2$\n\n\u5047\u8bbe$i\\in[l,r]$,\u90a3\u4e48$S_i$\u52a0\u4e0a$v\\times g_{r-i+1}$\n\n\u5047\u8bbe$i\\in[r+1,n]$,\u90a3\u4e48$S_i$\u52a0\u4e0a$v\\times g_{r-l+1} + v\\times(i-r)(r-l+1)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nint rd(){int x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return f?-x:x;}\nconst int N=200011,P=1000000007,i2=500000004;\nint n,m,a[N],s[N<<2],la[N<<2],lb[N<<2],lc[N<<2],G[N],S[N];\n#define ls rt<<1\n#define rs rt<<1|1\nvoid mod(int&x){if(x>=P)x-=P;}\nvoid pu(int rt){mod(s[rt]=s[ls]+s[rs]);}\nvoid add(int rt,int l,int r,int a,int b,int c){\n    mod(la[rt]+=a),mod(lb[rt]+=b),mod(lc[rt]+=c);\n    mod(s[rt]+=1ll*(S[r]-S[l-1]+P)%P*a%P);\n    mod(s[rt]+=1ll*(G[r]-G[l-1]+P)%P*b%P);\n    mod(s[rt]+=1ll*(r-l+1)*c%P);\n}\nvoid pd(int rt,int l,int r){\n    int m=l+r>>1;\n    if(la[rt]||lb[rt]||lc[rt])\n        add(ls,l,m,la[rt],lb[rt],lc[rt]),\n        add(rs,m+1,r,la[rt],lb[rt],lc[rt]),\n        la[rt]=lb[rt]=lc[rt]=0;\n}\nvoid build(int l,int r,int rt){\n    if(l==r){s[rt]=a[l];return;}\n    int m=l+r>>1;\n    build(l,m,ls),build(m+1,r,rs);\n    pu(rt);\n}\nvoid upd(int L,int R,int a,int b,int c,int l=1,int r=n,int rt=1){\n    if(L>r||R<l)return;\n    if(L<=l&&r<=R){add(rt,l,r,a,b,c);return;}\n    int m=l+r>>1;\n    pd(rt,l,r);\n    if(L<=m)upd(L,R,a,b,c,l,m,ls);\n    if(R>m)upd(L,R,a,b,c,m+1,r,rs);\n    pu(rt);\n}\nint ask(int L,int R,int l=1,int r=n,int rt=1){\n    if(L>r||R<l)return 0;\n    if(L<=l&&r<=R)return s[rt];\n    int m=l+r>>1,res=0;\n    pd(rt,l,r);\n    if(L<=m)res=ask(L,R,l,m,ls);\n    if(R>m)mod(res+=ask(L,R,m+1,r,rs));\n    return res;\n}\nvoid mdy(int l,int r,int v){\n    int a=1ll*v*i2%P;\n    upd(l,r,\n        a,\n        1ll*a*(3-l*2+P)%P,\n        (1ll*l*(l-3)+2)%P*a%P\n    );\n    if(r<n)upd(r+1,n,\n        0,\n        1ll*(r-l+1)*v%P,\n        (G[r-l+1]-1ll*r*(r-l+1)%P+P)%P*v%P\n    );\n}\nint qry(int l,int r){\n    int res=1ll*(r-l+1)*ask(n,n)%P;\n    mod(res+=P-ask(l-1,r-1));\n    mod(res+=P-ask(n-r,n-l));\n    return res;\n}\nint main(){\n    n=rd(),m=rd();\n    for(int i=1;i<=n;++i)mod(a[i]=a[i-1]+rd());\n    for(int i=2;i<=n;++i)mod(a[i]+=a[i-1]);\n    for(int i=1;i<=n;++i)\n        mod(G[i]=G[i-1]+i),\n        mod(S[i]=S[i-1]+1ll*i*i%P);\n    build(1,n,1);\n    while(m--){\n        int opt=rd(),l=rd(),r=rd();\n        if(l>r)l^=r,r^=l,l^=r;\n        if(opt==1)mdy(l,r,rd());\n        else printf(\"%d\\n\",qry(l,r));\n    }\n}\n```\n", "link": "/posts/LG 4458 [BJOI2018]\u94fe\u4e0a\u4e8c\u6b21\u6c42\u548c/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG AT1219 \u6b74\u53f2\u306e\u7814\u7a76", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/AT1219&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/AT1219\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\ntypedef long long ll;\nint n,m,blk,nn,a[N],c[N],cnt[N],CNT[N];\nll ans[N],mx;\nstruct node{\n    int v,id;\n    bool operator<(node t){return v<t.v;}\n}b[N];\nstruct que{\n    int l,r,id,pl,pr;\n    bool operator<(que t){return pl!=t.pl?l<t.l:r<t.r;}\n}q[N];\nvoid cmax(ll&x,ll y){if(y>x)x=y;}\nint main(){\n    scanf(\"%d%d\",&n,&m);blk=sqrt(n);\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\",c+i),\n        b[i]=(node){c[i],i};\n    std::sort(b+1,b+n+1);\n    for(int i=1;i<=n;++i)\n        a[b[i].id]=nn+=b[i].v!=b[i-1].v;\n    int l,r;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d\",&l,&r),\n        q[i]=(que){l,r,i,(l-1)/blk+1,(r-1)/blk+1};\n    std::sort(q+1,q+m+1);\n    int tot=(n-1)/blk+1;\n    for(int now=1,i=1,R=blk;now<=tot;R+=blk,++now){\n        if(R>n)R=n;\n        l=R+1,r=R,mx=0;\n        for(;q[i].pl==now;++i){\n            if(q[i].pl==q[i].pr){\n                for(int j=q[i].l;j<=q[i].r;++j)++CNT[a[j]];\n                for(int j=q[i].l;j<=q[i].r;++j)\n                    cmax(ans[q[i].id],1ll*CNT[a[j]]*c[j]);\n                for(int j=q[i].l;j<=q[i].r;++j)--CNT[a[j]];\n                continue;\n            }\n            while(r<q[i].r)\n                cmax(mx,1ll*++cnt[a[++r]]*c[r]);\n            ans[q[i].id]=mx;\n            while(l>q[i].l)\n                cmax(ans[q[i].id],1ll*++cnt[a[--l]]*c[l]);\n            for(;l<=R;++l)--cnt[a[l]];\n        }\n        for(;r>R;--r)--cnt[a[r]];\n    }\n    for(int i=1;i<=m;++i)printf(\"%lld\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG AT1219 \u6b74\u53f2\u306e\u7814\u7a76/", "tags": ["\u83ab\u961f", "\u56de\u6eda\u83ab\u961f", "\u79bb\u7ebf"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5408 \u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5408&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P5408\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1200000,P=167772161,G=3,Gi=55924054;\nint L,l,r[N],fac[N],inv[N];\nvoid swap(int&x,int&y){int t=x;x=y;y=t;}\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%P;\n        b>>=1,x=1ll*x*x%P;\n    }\n    return res;\n}\nvoid getL(int n){\n    for(L=1;L<n;L<<=1,++l);\n    for(int i=0;i<L;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)?(L>>1):0);\n}\nvoid ntt(int*A,int typ){\n    for(int i=0;i<L;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<L;len<<=1){\n        int Wn=pw(~typ?G:Gi,(P-1)/(len<<1));\n        for(int i=0;i<L;i+=len<<1){\n            int w=1;\n            for(int k=0;k<len;++k){\n                int t=1ll*w*A[i+k+len]%P;\n                A[i+k+len]=(A[i+k]-t+P)%P;\n                A[i+k]=(A[i+k]+t)%P;\n                w=1ll*w*Wn%P;\n            }\n        }\n    }\n    if(~typ)return;\n    for(int i=0,iL=pw(L,P-2);i<L;++i)\n        A[i]=1ll*A[i]*iL%P;\n}\nint s[N],a[N],b[N],g[N];\nvoid mul(int*f,int*g){\n    ntt(f,1),ntt(g,1);\n    for(int i=0;i<L;++i)f[i]=1ll*f[i]*g[i]%P;\n    ntt(f,-1);\n}\nvoid solve(int n){\n    if(n==1){s[1]=1;return;}\n    if(n&1){\n        solve(n-1);\n        for(int i=n;i;--i)\n            s[i]=(s[i-1]+1ll*s[i]*(n-1)%P)%P;\n        s[0]=1ll*s[0]*(n-1)%P;\n        return;\n    }\n    int m=n>>1,res=1;\n    solve(m);\n    for(int i=0;i<=m;++i)\n        a[i]=1ll*s[i]*fac[i]%P,\n        b[i]=1ll*res*inv[i]%P,\n        res=1ll*res*m%P;;\n    std::reverse(a,a+m+1);\n    getL((m+1)*2);\n    mul(a,b);\n    for(int i=0;i<=m;++i)\n        g[i]=1ll*inv[i]*a[m-i]%P;\n    mul(s,g);\n    for(int i=m+1;i<L;++i)a[i]=b[i]=g[i]=0;\n    for(int i=n+1;i<L;++i)s[i]=0;\n}\nvoid init(int n){\n    fac[0]=1;\n    for(int i=1;i<=n;++i)fac[i]=1ll*fac[i-1]*i%P;\n    inv[n]=pw(fac[n],P-2);\n    for(int i=n-1;i>=0;--i)inv[i]=1ll*inv[i+1]*(i+1)%P;\n}\nint main(){\n    int n;\n    scanf(\"%d\",&n);\n    init(n+n);\n    solve(n);\n    for(int i=0;i<=n;++i)\n        printf(\"%d \",s[i]);\n}\n```\n", "link": "/posts/LG 5408 \u7b2c\u4e00\u7c7b\u65af\u7279\u6797\u6570\u00b7\u884c/", "tags": ["ntt", "\u65af\u7279\u6797\u6570", "\u6570\u8bba", "\u6a21\u677f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP20644 ZQUERY - Zero Query", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP20644&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/SP20644\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fd9\u9898\u53ef\u4ee5\u7b97\u662f\u56de\u6eda\u83ab\u961f\u677f\u5b50\u9898\n\n\u8bbe$S$\u4e3a\u524d\u7f00\u548c\n\n\u5047\u8bbe\u533a\u95f4$[l,r]$\u533a\u95f4\u548c\u4e3a$0$,\u90a3\u4e48$S_r-S_{1-1}=0$\n\n\u5982\u679c\u4f7f\u7528\u83ab\u961f\u7b97\u6cd5\u7684\u8bdd,\u5bb9\u6613\u60f3\u5230:\n\n\u7528\u6876\u8bb0\u5f55\u67d0\u4e2a\u524d\u7f00\u548c\u51fa\u73b0\u7684\u6700\u5927/\u6700\u5c0f\u4f4d\u7f6e,\u52a0\u70b9\u64cd\u4f5c\u5c31\u5f88\u5bb9\u6613\u7ef4\u62a4\u7b54\u6848\n\n\u4f46\u8fd9\u6837\u7684\u8bdd\u5220\u70b9\u64cd\u4f5c\u5c31\u6709\u70b9\u96be\u5b9e\u73b0\u4e86\n\n\u53ef\u4ee5\u4f7f\u7528\u56de\u6eda\u83ab\u961f\n\n\u56de\u6eda\u83ab\u961f\u662f\u4e00\u79cd\u53ea\u6dfb\u52a0\u4e0d\u5220\u9664\u7684\u83ab\u961f,\u5b9e\u73b0\u5982\u4e0b:\n\n\u9996\u5148\u5bf9\u539f\u5e8f\u5217\u8fdb\u884c\u5206\u5757,\u5e76\u5bf9\u8be2\u95ee\u6309\u7167\u5982\u4e0b\u7684\u65b9\u5f0f\u6392\u5e8f:\u4ee5\u5de6\u7aef\u70b9\u6240\u5728\u7684\u5757\u5347\u5e8f\u4e3a\u7b2c\u4e00\u5173\u952e\u5b57,\u4ee5\u53f3\u7aef\u70b9\u5347\u5e8f\u4e3a\u7b2c\u4e8c\u5173\u952e\u5b57\n\n\u679a\u4e3e\u5f53\u524d\u8981\u5904\u7406\u7684\u5757,\u5904\u7406\u6240\u6709\u5de6\u7aef\u70b9\u5728\u8be5\u5757\u5185\u7684\u8be2\u95ee,\n\n\u8bbe\u5f53\u524d\u5757\u53f3\u7aef\u4e3a$R$,\u5de6\u6307\u9488\u79fb\u52a8\u5230$R+1$,\u53f3\u6307\u9488\u79fb\u52a8\u5230$R$.\n\n\u82e5\u8be2\u95ee\u4e24\u7aef\u5728\u540c\u4e00\u5757\u5185,\u90a3\u4e48\u66b4\u529b\u679a\u4e3e\u7edf\u8ba1\u5373\u53ef\n\n1. \u7531\u4e8e\u5de6\u7aef\u70b9\u5728\u540c\u4e00\u5757\u5185,\u53f3\u7aef\u70b9\u5355\u8c03\u9012\u589e\n\n   \u4e0d\u65ad\u53f3\u79fb\u53f3\u6307\u9488\u5230\u5f53\u524d\u8be2\u95ee\u53f3\u7aef\u70b9,\u5e76\u52a0\u70b9\u66f4\u65b0\u603b\u7b54\u6848\n\n   (\u6bcf\u4e2a\u5757\u53f3\u7aef\u70b9\u603b\u4f4d\u79fb\u4e0d\u8d85\u8fc7$n$)\n\n2. \u4e0d\u65ad\u5de6\u79fb\u5de6\u6307\u9488\u5230\u5f53\u524d\u8be2\u95ee\u5de6\u7aef\u70b9,\u5e76\u52a0\u70b9\u66f4\u65b0\u5f53\u524d\u8be2\u95ee\u7b54\u6848\n   \n   \u7136\u540e\u5c06\u5de6\u7aef\u70b9\u56de\u6eda\u5230$R+1$,\u64a4\u9500\u52a0\u70b9\u64cd\u4f5c\u5bf9\u6876\u7684\u5f71\u54cd\n\n   (\u6bcf\u6b21\u56de\u6eda\u5de6\u7aef\u70b9\u4f4d\u79fb\u4e0d\u8d85\u8fc7$\\sqrt n$)\n\n\u7ee7\u7eed\u5904\u7406\u4e0b\u4e00\u4e2a\u8be2\u95ee\n\n\u603b\u590d\u6742\u5ea6$O(n\\sqrt n)$,\u5b9e\u6d4b\u8dd1\u7684\u98de\u5feb\n\n\u8bf7\u914d\u5408\u4ee3\u7801\u7406\u89e3,**\u6ce8\u610f\u7ec6\u8282**\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=50011;\nint n,m,blk,s[N],p[N*2],mi[N*2],ma[N*2],ans[N],clr[N];\nstruct que{\n    int l,r,id,pl,pr;\n    bool operator<(que t){return pl!=t.pl?l<t.l:r<t.r;}\n}q[N];\nvoid cmax(int&x,int y){if(y>x)x=y;}\nint main(){\n    scanf(\"%d%d\",&n,&m);blk=sqrt(n);\n    s[0]=n;\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\",s+i),s[i]+=s[i-1];\n    int l,r,mx,tt;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d\",&l,&r),\n        q[i]=(que){l,r,i,(l-1)/blk+1,(r-1)/blk+1};\n    std::sort(q+1,q+m+1);\n    memset(mi,126,sizeof mi),memset(p,126,sizeof p);\n    int tot=(n-1)/blk+1;\n    for(int now=1,i=1,R=blk;now<=tot;R+=blk,++now){\n        if(R>n)R=n;\n        l=R+1,r=R,mx=0,tt=0;\n        for(;q[i].pl==now;++i){\n            if(q[i].pr==now){\n                p[s[q[i].l-1]]=q[i].l-1;\n                for(int j=q[i].l;j<=q[i].r;++j)\n                    if(p[s[j]]<j)cmax(ans[q[i].id],j-p[s[j]]);\n                    else p[s[j]]=j;\n                p[s[q[i].l-1]]=n;\n                for(int j=q[i].l;j<=q[i].r;++j)p[s[j]]=n;\n                continue;\n            }\n            while(r<q[i].r){\n                ++r,ma[s[r]]=r;\n                if(mi[s[r]]>n)mi[s[r]]=r,clr[tt++]=s[r];\n                else cmax(mx,r-mi[s[r]]);\n            }\n            ans[q[i].id]=mx;\n            while(l>=q[i].l){\n                --l;\n                if(ma[s[l]])cmax(ans[q[i].id],ma[s[l]]-l);\n                else ma[s[l]]=l;\n            }\n            for(;l<=R;++l)if(ma[s[l]]==l)ma[s[l]]=0;\n        }\n        while(tt--)mi[clr[tt]]=n,ma[clr[tt]]=0;\n    }\n    for(int i=1;i<=m;++i)printf(\"%d\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG SP20644 ZQUERY - Zero Query/", "tags": ["\u83ab\u961f", "\u56de\u6eda\u83ab\u961f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4137 Rmq Problem-mex", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4137&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4137\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,m,blk,nn,a[N],c[N],cnt[N],CNT[N];\ntypedef long long ll;\nll ans[N],mx;\nstruct node{\n    int v,id;\n    bool operator<(node t){return v<t.v;}\n}b[N];\nstruct que{\n    int l,r,id,pl,pr;\n    bool operator<(que t){return pl!=t.pl?l<t.l:r<t.r;}\n}q[N];\nvoid cmax(ll&x,ll y){if(y>x)x=y;}\nint main(){\n    scanf(\"%d%d\",&n,&m);blk=sqrt(n);\n    for(int i=1;i<=n;++i)\n        scanf(\"%d\",c+i),\n        b[i]=(node){c[i],i};\n    std::sort(b+1,b+n+1);\n    for(int i=1;i<=n;++i)\n        a[b[i].id]=nn+=b[i].v!=b[i-1].v;\n    int l,r;\n    for(int i=1;i<=m;++i)\n        scanf(\"%d%d\",&l,&r),\n        q[i]=(que){l,r,i,(l-1)/blk+1,(r-1)/blk+1};\n    std::sort(q+1,q+m+1);\n    int tot=(n-1)/blk+1;\n    for(int now=1,i=1,R=blk;now<=tot;R+=blk,++now){\n        if(R>n)R=n;\n        l=R+1,r=R,mx=0;\n        for(;q[i].pl==now;++i){\n            if(q[i].pl==q[i].pr){\n                for(int j=q[i].l;j<=q[i].r;++j)++CNT[a[j]];\n                for(int j=q[i].l;j<=q[i].r;++j)\n                    cmax(ans[q[i].id],1ll*CNT[a[j]]*c[j]);\n                for(int j=q[i].l;j<=q[i].r;++j)--CNT[a[j]];\n                continue;\n            }\n            while(r<q[i].r)\n                cmax(mx,1ll*++cnt[a[++r]]*c[r]);\n            ans[q[i].id]=mx;\n            while(l>q[i].l)\n                cmax(ans[q[i].id],1ll*++cnt[a[--l]]*c[l]);\n            for(;l<=R;++l)--cnt[a[l]];\n        }\n        for(;r>=R;--r)--cnt[a[r]];\n    }\n    for(int i=1;i<=m;++i)printf(\"%lld\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG 4137 Rmq Problem-mex/", "tags": ["\u83ab\u961f", "\u56de\u6eda\u83ab\u961f", "\u79bb\u7ebf"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4451 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4451&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4451\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u62c6\u5206\u4e3a$m$\u9879\u65f6,\u751f\u6210\u51fd\u6570\u4e3a$F^m (x)$\n\n\u90a3\u4e48\u7b54\u6848\u7684\u751f\u6210\u51fd\u6570\u4e3a$\\displaystyle G(x)=\\sum_{i=0}^{\\infin} F^i(x)$\n\n$F$\u4e3a\u6590\u6ce2\u90a3\u5951\u6570\u5217\u751f\u6210\u51fd\u6570,$\\displaystyle F(x)=\\frac x{1-x-x^2}$\n\n$\n\\begin{aligned}\nG(x)\n&=\\sum_{i=0}^{\\infty} F^i(x)\\\\\n&=\\frac 1{1-F(x)}\\\\\n&=\\frac {1-x-x^2}{1-2x-x^2}\\\\\n&=1+\\frac x{1-2x-x^2}\\\\\n&=1+\\frac x{[1-(1+\\sqrt 2)x][1-(1-\\sqrt2)x]}\\\\\n&=1+\\frac 1{2\\sqrt 2}\\left( \\frac 1{1-(1+\\sqrt 2)x} - \\frac 1{1-(1-\\sqrt 2)x} \\right)\\\\\n&=1+\\sum_{i=1}^{\\infin} \\frac{(1+\\sqrt 2)^i-(1-\\sqrt 2)^i}{2\\sqrt 2} x^i\n\\end{aligned}\n$\n\n\u90a3\u4e48:\n\n$\\displaystyle\nans_n=\\frac{(1+\\sqrt 2)^n-(1-\\sqrt 2)^n}{2\\sqrt 2}\n$\n\n\u5176\u4e2d$\\sqrt 2 \\equiv 59713600 \\pmod{10^9+7}$(\u4e8c\u6b21\u5269\u4f59)\n\n\u8fd9\u6837\u7684\u8bdd:\n\n$\\displaystyle\n\\begin{aligned}\nans_n\n&=\\frac {\\sqrt 2}4\\left[(1+\\sqrt 2)^n-(1-\\sqrt 2)^n\\right]\\\\\n&\\equiv 59713600\\times 250000002\\times [(1+59713600)^n-(1-59713600)^n] \\pmod{10^9+7}\n\\end{aligned}\n$\n\n\u4f7f\u7528\u5feb\u901f\u5e42\u590d\u6742\u5ea6$O(\\log n)$\n\n\u8003\u8651\u8d39\u9a6c\u5c0f\u5b9a\u7406: $ans_n \\equiv ans_{n \\mod 10^9+6}$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u628a$n$\u538b\u5230$10^9+6$\u4ee5\u5185\u4e86,\u518d\u5feb\u901f\u5e42\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<cstdio>\nconst int P=1000000007;\nint n;\nvoid readn(){\n    char c;int p=P-1;\n    for(c=getchar();c<'0'||'9'<c;c=getchar());\n    for(n=c-48,c=getchar();'0'<=c&&c<='9';n=(10ll*n+c-48)%p,c=getchar());\n}\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%P;\n        b>>=1,x=1ll*x*x%P;\n    }\n    return res;\n}\nint main(){\n    readn();\n    int t=1ll*59713600*250000002%P,\n        a=(pw(59713601,n)-pw(940286408,n)+P)%P;\n    printf(\"%d\\n\",1ll*t*a%P);\n}\n```\n", "link": "/posts/LG 4451 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u6574\u6570\u7684lqp\u62c6\u5206/", "tags": ["\u751f\u6210\u51fd\u6570", "\u6570\u8bba", "\u6590\u6ce2\u90a3\u5951", "\u4e8c\u6b21\u5269\u4f59"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3321 [SDOI2015]\u5e8f\u5217\u7edf\u8ba1", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3321&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P3321\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u4e86\u89e3\u539f\u6839\n\n\u8fd9\u91cc\u5229\u7528\u5230\u539f\u6839\u7684\u4e00\u4e2a\u6027\u8d28:\n\n> \u8bbe$g$\u4e3a$m$\u7684\u4e00\u4e2a\u539f\u6839\n>    \n> $g^0,g^1,g^2,\\dots,g^{\\varphi(m)-1}$\u6784\u6210\u6a21$m$\u7684\u7b80\u5316\u5269\u4f59\u7cfb\n\n\u8fd9\u6837\u6211\u4eec\u53ef\u4ee5\u628a\u5e8f\u5217\u4e2d\u6240\u6709\u6570\u53d8\u6210\u539f\u6839\u7684\u6b21\u5e42,\n\n\u90a3\u4e48\u5e8f\u5217\u4e2d\u6240\u6709\u6570\u7684\u4e58\u79ef\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a\u4ed6\u4eec\u7684\u548c\n\n\u8bbe\u8fd9\u4e2a\u548c\u4e3a$sum$\n\n\u8bbe\u751f\u6210\u51fd\u6570:$\\displaystyle f(x)=\\sum_{i=0}^m [i\\in S]x^i$\n\n\u53ef\u4ee5\u53d1\u73b0$f(x)^n$\u6b21\u6570\u4e3a$sum$\u7684\u90a3\u4e00\u9879\u7684\u7cfb\u6570\u5c31\u662f\u7b54\u6848\n\n\u4f7f\u7528\u5feb\u901f\u5e42+\u5feb\u901f\u6570\u8bba\u53d8\u6362\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=3000010,P=1004535809,G=3,Gi=334845270;\nint n,m,X,S,f[N],F[N],l,r[N],b[N],L;\nvoid mod(int&x){if(x>=P)x-=P;}\nvoid swap(int&x,int&y){x^=y,y^=x,x^=y;}\nint pw(int x,int b,int p=P){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return res;\n}\nvoid ntt(int*A,int typ){\n    for(int i=0;i<L;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<L;len<<=1){\n        int Wn=pw(~typ?G:Gi,(P-1)/(len<<1));\n        for(int i=0;i<L;i+=len<<1){\n            int w=1;\n            for(int k=0;k<len;++k){\n                int t=1ll*w*A[i+k+len]%P;\n                mod(A[i+k+len]=A[i+k]-t+P);\n                mod(A[i+k]+=t);\n                w=1ll*w*Wn%P;\n            }\n        }\n    }\n    if(~typ)return;\n    int inv=pw(L,P-2);\n    for(int i=0;i<L;++i)\n        A[i]=1ll*A[i]*inv%P;\n}\nint a[N],tt;\nint getg(){\n    for(int i=2;i<=m-2;++i)\n        if((m-1)%i==0)a[++tt]=i;\n    for(int i=2;;++i){\n        bool ff=1;\n        for(int j=1;j<=tt;++j)\n            if(pw(i,a[j],m)==1){ff=0;break;}\n        if(ff)return i;\n    }\n}\nint main(){\n    scanf(\"%d%d%d%d\",&n,&m,&X,&S);\n    for(int i=1,x=1,g=getg();i<=m-2;++i)\n        b[x=1ll*x*g%m]=i;\n    for(int i=1,t;i<=S;++i){\n        scanf(\"%d\",&t);\n        if(t)F[b[t]]=1;\n    }\n    \n    for(L=1;L<m;L<<=1,++l);\n    L<<=1,++l;\n\n    for(int i=0;i<L;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    f[0]=1;\n    while(n){\n        ntt(F,1);\n        if(n&1){\n            ntt(f,1);\n            for(int i=0;i<L;++i)\n                f[i]=1ll*f[i]*F[i]%P;\n            ntt(f,-1);\n            for(int i=L-1;i>=m-1;--i)\n                mod(f[i-m+1]+=f[i]),f[i]=0;\n        }\n        n>>=1;\n        for(int i=0;i<L;++i)\n            F[i]=1ll*F[i]*F[i]%P;\n        ntt(F,-1);\n        for(int i=L-1;i>=m-1;--i)\n            mod(F[i-m+1]+=F[i]),F[i]=0;\n    }\n    printf(\"%d\\n\",f[b[X]]);\n}\n```\n", "link": "/posts/LG 3321 [SDOI2015]\u5e8f\u5217\u7edf\u8ba1/", "tags": ["\u751f\u6210\u51fd\u6570", "ntt", "\u6570\u8bba", "\u539f\u6839"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4199 \u4e07\u5f84\u4eba\u8e2a\u706d", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4199&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"https://www.luogu.com.cn/problem/P4199\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u627e\u4f4d\u7f6e\u5bf9\u79f0\u7684\u56de\u6587\u5b50\u5e8f\u5217\u4e2a\u6570(\u591a\u9879\u5f0f\u6c42)\n\n\u7531\u4e8e\u4e0d\u80fd\u8fde\u7eed,\u6240\u4ee5\u51cf\u53bb\u5bf9\u79f0\u56de\u6587\u5b50\u4e32\u4e2a\u6570(manacher\u6c42)\n\n\u8bbe\u5b57\u7b26\u4e32\u4e3a$S,|S|=n$\n\n\u5047\u8bbe$S_i$\u4f5c\u4e3a\u4e00\u4e2a\u5b50\u5e8f\u5217\u7684\u5bf9\u79f0\u4e2d\u5fc3,$x=\\sum_{j=1\\le j\\le i-1}[S_{i-j}=S_{i+j}]$\n\n\u90a3\u4e48\u4ee5$i$\u4e3a\u4e2d\u5fc3\u4f4d\u7f6e\u7684\u65b9\u6848\u6570\u4e3a$2^{x+1}-1$\n\n\u8bbe$A_i=[S_i=a],B_i=[S_i=b]$\n\n\u90a3\u4e48$\\displaystyle (A*A)_i=A_i*A_i=\\sum_{j=0}^nA_jA_{i-j}$\u5c31\u662f\u5bf9\u79f0\u4e2d\u5fc3\u4e3a\u4f4d\u7f6e$\\frac i2$\u7684\u4e24\u7aef\u4e3a`a`\u7684\u6570\u91cf\n\n\u540c\u7406$(B*B)_i$\u5c31\u662f\u5bf9\u79f0\u4e2d\u5fc3\u4e3a\u4f4d\u7f6e$\\frac i2$\u7684\u4e24\u7aef\u4e3a`b`\u7684\u6570\u91cf\n\n\u90a3\u4e48\u4e0a\u8ff0$(A*A)_i+(B*B)_i$\u5c31\u662f\u5bf9\u79f0\u4e2d\u5fc3\u4e3a\u4f4d\u7f6e$\\frac i2$\u7684$x+1$\n\n\u5982\u679c$i$\u4e3a\u5076\u6570,$x+1$\u8981\u51cf\u53bb$1$(\u5bf9\u79f0\u4e2d\u5fc3\u662f\u5426\u5728\u540c\u4e2a\u5b57\u7b26\u4e0a)\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011,P=1000000007;\ntypedef double db;\ntypedef long long ll;\nstruct cp{db r,i;cp(db R=0,db I=0){r=R,i=I;}};\ncp operator+(cp a,cp b){return cp(a.r+b.r,a.i+b.i);}\ncp operator-(cp a,cp b){return cp(a.r-b.r,a.i-b.i);}\ncp operator*(cp a,cp b){return cp(a.r*b.r-a.i*b.i,a.r*b.i+a.i*b.r);}\nchar s[N],S[N*2];\nint n,nn,ans,pw[N],l,r[N*4],p[N*2];\nconst db pi=acos(-1);\ncp a[N*4],b[N*4];\nvoid swap(cp&x,cp&y){cp t=x;x=y;y=t;}\nvoid fft(cp*A,int typ){\n    for(int i=0;i<nn;++i)\n        if(i<r[i])swap(A[i],A[r[i]]);\n    for(int len=1;len<nn;len<<=1){\n        cp Wn(cos(pi/len),typ*sin(pi/len));\n        for(int i=0;i<nn;i+=len<<1){\n            cp w(1,0);\n            for(int k=0;k<len;++k){\n                cp t=w*A[i+k+len];\n                A[i+k+len]=A[i+k]-t;\n                A[i+k]=A[i+k]+t;\n                w=w*Wn;\n            }\n        }\n    }\n}\nvoid mod(int&x){if(x>=P)x-=P;}\nint min(int x,int y){return x<y?x:y;}\nint main(){\n    scanf(\"%s\",s+1);\n    n=strlen(s+1);\n    pw[0]=1;\n    for(int i=1;i<=n;++i)\n        a[i].r=s[i]=='a',\n        b[i].r=s[i]=='b',\n        mod(pw[i]=pw[i-1]<<1);\n    for(nn=1;nn<=n+n;nn<<=1,++l);\n    for(int i=0;i<nn;++i)\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    fft(a,1),fft(b,1);\n    for(int i=0;i<nn;++i)\n        a[i]=a[i]*a[i],\n        b[i]=b[i]*b[i];\n    fft(a,-1),fft(b,-1);\n\n    n=n<<1|1;\n    for(int i=1;i<=n;++i)\n        S[i]=(i&1)?'#':s[i>>1];\n    int R=0,m=0;\n    for(int i=1;i<=n;++i){\n        if(i<=R)p[i]=min(R-i,p[m*2-i]);\n        while(i+p[i]+1<=n&&i-p[i]-1>=1&&S[i+p[i]+1]==S[i-p[i]-1])++p[i];\n        if(i+p[i]>R)R=i+p[i],m=i;\n    }\n    for(int i=1;i<=n;++i)mod(ans+=P-(p[i]+1>>1));\n\n    for(int i=1;i<=n;++i){\n        int x=int(a[i].r/nn+0.5)%P+int(b[i].r/nn+0.5)%P+1;\n        x>>=1;\n        mod(x);\n        mod(ans+=pw[x]-1);\n    }\n    printf(\"%d\\n\",ans);\n}\n\n```\n", "link": "/posts/LG 4199 \u4e07\u5f84\u4eba\u8e2a\u706d/", "tags": ["\u591a\u9879\u5f0f", "fft", "ntt", "\u6570\u8bba", "manacher"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "POJ 1430 Binary Stirling Numbers", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised mdui-ripple'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised mdui-ripple' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6b64\u9898\u8981\u6c42\u7684\u662f$S(n,m) \\mod 2$(\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570)\n\n1. \u5f53$m$\u4e3a\u5076\u6570,$S(n,m) \\equiv S(n-1,m-1)$\n\n2. \u5f53$m$\u4e3a\u5947\u6570,$S(n,m) \\equiv S(n-1,m-1)+s(n-1,m)$\n\n\u8fd9\u6837\u7684\u8bdd,\u76f8\u5f53\u4e8e:\n\n1. \u5f53$(x,y)$\u4e2d$y$\u4e3a\u5947\u6570\u65f6,\u53ef\u4ee5\u8d70\u5230$(x+1,y+1)$(a\u53d8\u6362)\n\n2. \u5426\u5219\u53ef\u4ee5\u8d70\u5230$(x+1,y+1)$(a\u53d8\u6362),\u6216$(x+1,y)$(b\u53d8\u6362)\n\n\u6c42\u4ece$(0,0)$\u8d70\u5230$(n,m)$\u7684\u65b9\u6848\u6570$\\pmod 2$\n\n\u8fd9\u4e2a\u8fc7\u7a0b\u5fc5\u7136\u8d70\u4e86$m$\u6b21$a$\u53d8\u6362,\u8d70\u4e86$n-m$\u6b21$b$\u53d8\u6362\n\n\u800c$b$\u53d8\u6362\u53ea\u80fd\u5728\u5076\u6570\u4f4d\u7f6e\u51fa\u73b0,\u90a3\u4e48\u53d8\u6362\u7684\u5e8f\u5217\u5fc5\u7136\u662f\u5982\u4e0b\u5f62\u5f0f:\n\n$a,b\\times ?,a,a,b\\times ?,a,a,...,a$\n\n\u4e5f\u5c31\u662f\u5728$\\frac {m+1}2$\u4e2a\u95f4\u9694\u4e2d\u63d2\u5165$n-m$\u4e2a$b$,\u5373\u9694\u677f\u6cd5\n\n\u65b9\u6848\u6570:$C(n-m+\\frac{m+1}2-1,\\frac{m+1}2 -1) \\mod 2$\n\n\u8fd8\u6709\u4e00\u4e2a\u7ed3\u8bba:\u4ec5\u5f53$n\\&m=m$\u65f6,$C(n,m) \\equiv 1 \\bmod 2$(lucas\u5b9a\u7406\u4ee3\u5165\u5373\u53ef\u63a8\u51fa)\n<!-- more -->\n\n```cpp\n#include<cstdio>\nbool C(int n,int m){\n    return (n&m)==m;\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--){\n        int n,m;\n        scanf(\"%d%d\",&n,&m);\n        if(!n&&!m)puts(\"1\");\n        else if(!n||!m||n<0)puts(\"0\");\n        else{\n            int b=n-m,a=(m+1)>>1;\n            puts(C(b+a-1,a-1)?\"1\":\"0\");\n        }\n    }\n}\n```\n", "link": "/posts/POJ 1430 Binary Stirling Numbers/", "tags": ["\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570", "\u7ec4\u5408\u6570", "\u6570\u8bba", "lucas"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4474 \u738b\u8005\u4e4b\u5251", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4474&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4474\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u5947\u5076\u9ed1\u767d\u67d3\u8272,\u6e90\u70b9\u8fde\u9ed1\u70b9,\u767d\u70b9\u8fde\u6c47\u70b9,\u8fb9\u6743\u4e3a\u70b9\u6743\n\n\u63a5\u7740\u6240\u6709\u9ed1\u70b9\u5411\u76f8\u90bb\u7684\u767d\u70b9\u8fde\u8fb9,\u8fb9\u6743\u4e3a$\\infty$\n\n\u7b54\u6848\u5c31\u662f \u70b9\u6743\u548c-\u6700\u5c0f\u5272\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nint rd(){int x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return f?-x:x;}\nconst int N=11111,inf=-1u>>1;\n#define id(i,j) (i-1)*m+j\nint n,m,ans,st=N-2,ed=N-1,cnt=1,head[N];\nstruct edge{int to,nxt,w;}e[N*8];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;e[cnt].w=0;\n}\nint q[N],d[N];\nbool bfs(){\n    int h=0,t=1,x;\n    memset(d,0,sizeof d);\n    d[q[0]=st]=1;\n    while(h<t){\n        x=q[h++];if(x==ed)return 1;\n        for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n            if(e[i].w&&!d[to])d[to]=d[x]+1,q[t++]=to;\n    }\n    return 0;\n}\nint min(int x,int y){return x<y?x:y;}\nint dfs(int x,int mf){\n    if(x==ed)return mf;\n    int us=0,w;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(d[to]==d[x]+1&&e[i].w){\n            w=dfs(to,min(mf-us,e[i].w));\n            e[i].w-=w,e[i^1].w+=w;\n            us+=w;if(us==mf)return mf;\n        }\n    if(!us)d[x]=-1;\n    return us;\n}\nint main(){\n    n=rd(),m=rd();\n    int w;\n    fur(i,1,n)fur(j,1,m){\n        w=rd(),ans+=w;\n        if((i+j)&1){\n            add(st,id(i,j),w);\n            if(i>1)add(id(i,j),id(i-1,j),inf);\n            if(i<n)add(id(i,j),id(i+1,j),inf);\n            if(j>1)add(id(i,j),id(i,j-1),inf);\n            if(j<m)add(id(i,j),id(i,j+1),inf);\n        }\n        else add(id(i,j),ed,w);\n    }\n    while(bfs())ans-=dfs(st,inf);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 4474 \u738b\u8005\u4e4b\u5251/", "tags": ["\u7f51\u7edc\u6d41"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3533 [POI2012]RAN-Rendezvous", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3533&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3533\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u770b\u51fa\u8fd9\u662f\u591a\u9897\u57fa\u73af\u6811\n\n\u5206\u4e09\u79cd\u60c5\u51b5:\n\n1. $x,y$\u5728\u4e0d\u540c\u7684\u4e24\u9897\u6811\u4e0a\n   \n2. $x,y$\u8fd8\u6ca1\u5230\u8fbe\u73af\u5c31\u76f8\u9047\u4e86\n   \n3. $x,y$\u7684\u7956\u5148\u5728\u73af\u4e0a\u4e0d\u540c\u4f4d\u7f6e\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nint rd(){int x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return f?-x:x;}\nconst int N=500011;\nint n,q,f[20][N],cnt,head[N],d[N],fr[N],deg[N],Q[N],s[N],sz[N],bl[N];\nstd::list<int>e[N];\nbool v[N];\nvoid dfs(int x,int F){\n    fr[x]=F;\n    for(auto to:e[x])if(v[to])\n        d[to]=d[x]+1,dfs(to,F);\n}\nint lca(int x,int y){\n    if(d[x]<d[y])x^=y,y^=x,x^=y;\n    int t=d[x]-d[y];\n    for(int i=19;~i;--i)\n        if((t>>i)&1)x=f[i][x];\n    if(x==y)return y;\n    for(int i=19;~i;--i)\n        if(f[i][x]^f[i][y])\n            x=f[i][x],y=f[i][y];\n    return f[0][x];\n}\nvoid gl(int x,int id,int now){\n    if(s[x])return;\n    s[x]=now,++sz[id],bl[x]=id;\n    gl(f[0][x],id,now+1);\n}\nbool pd(int x1,int y1,int x2,int y2) {\n\tif(std::max(x1,y1)!=std::max(x2,y2))return std::max(x1,y1)<std::max(x2,y2);\n\tif(std::min(x1,y1)!=std::min(x2,y2))return std::min(x1,y1)<std::min(x2,y2);\n\treturn x1>=y1;\n}\nint main(){\n    n=rd(),q=rd();\n    fur(i,1,n)\n        ++deg[f[0][i]=rd()],\n        e[f[0][i]].push_back(i);\n    fur(k,1,19)fur(i,1,n)\n        f[k][i]=f[k-1][f[k-1][i]];\n    int tp=0,x,y,z,fx,fy;\n    for(int i=1;i<=n;++i)if(!deg[i])Q[++tp]=i;\n    while(tp){\n        v[x=Q[tp--]]=1;\n        if(!--deg[f[0][x]])Q[++tp]=f[0][x];\n    }\n    for(int i=1;i<=n;++i)\n        if(!v[i])dfs(i,i),gl(i,++cnt,1);\n    while(q--){\n        fx=fr[x=rd()],fy=fr[y=rd()];\n        if(bl[fx]^bl[fy])printf(\"-1 -1\\n\");\n        else if(fx==fy)\n            z=lca(x,y),\n            printf(\"%d %d\\n\",d[x]-d[z],d[y]-d[z]);\n        else{\n            int more1=d[x]+(s[fy]-s[fx]+sz[bl[fx]])%sz[bl[fx]],more2=d[y]+(s[fx]-s[fy]+sz[bl[fx]])%sz[bl[fx]];\n\t\t\tif(pd(d[x],more2,more1,d[y]))printf(\"%d %d\\n\",d[x],more2);\n\t\t\telse printf(\"%d %d\\n\",more1,d[y]);\n        }\n    }\n}\n```\n", "link": "/posts/LG 3533 [POI2012]RAN-Rendezvous/", "tags": ["\u500d\u589e", "\u57fa\u73af\u6811", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3514 [POI2011]LIZ-Lollipop", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3514&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3514\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9006\u63a8\n\n\u82e5\u5f53\u524d\u533a\u95f4$[l,r]$\u548c\u4e3a$x$,\u8003\u8651\u5982\u4f55\u5f97\u5230\u548c\u4e3a$x-2$\u7684\u533a\u95f4:\n\n1. $a_l=2 \\rightarrow [l+1,r]$\n2. $a_r=2 \\rightarrow [l,r-1]$\n3. $a_l=a_r=1 \\rightarrow [l+1,r-1]$\n\n\u8fd9\u6837\u6211\u4eec\u6c42\u51fa\u533a\u95f4 \u6700\u5927\u5947\u6570\u548c \u4e0e \u6700\u5927\u5076\u6570\u548c,\u5c31\u53ef\u4ee5\u9884\u5904\u7406\u51fa\u6240\u6709$x$\u7684\u7b54\u6848\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000001;\nint n,q,a[N],s[N],L[N*2],R[N*2];\nchar c[N];\nvoid solve(int v){\n    while(v>2){\n        L[v-2]=L[v]+1,R[v-2]=R[v]-1;\n        if(a[L[v]]==2)R[v-2]=R[v];\n        else if(a[R[v]]==2)L[v-2]=L[v];\n        v-=2;\n    }\n}\nint main(){\n    int t1=0,t2=0,v;\n    scanf(\"%d%d%s\",&n,&q,c+1);\n    for(int i=1;i<=n;++i)\n        a[i]=1+(c[i]=='T'),\n        s[i]=s[i-1]+a[i];\n    v=s[n],L[v]=1,R[v]=n,solve(v);\n    for(int i=1;i<=n;++i)if(a[i]==1){t1=i+1;break;}\n    for(int i=n;i;--i)if(a[i]==1){t2=i-1;break;}\n    if((!t1&&t2)||s[t2]>s[n]-s[t1-1])\n        v=s[t2],L[v]=1,R[v]=t2;\n    else if(t1)\n        v=s[n]-s[t1-1],L[v]=t1,R[v]=n;\n    solve(v);\n    while(q--){\n        int x;scanf(\"%d\",&x);\n        if(!L[x])printf(\"NIE\\n\");\n        else printf(\"%d %d\\n\",L[x],R[x]);\n    }\n}\n```\n", "link": "/posts/LG 3514 [POI2011]LIZ-Lollipop/", "tags": ["\u524d\u7f00\u548c", "\u601d\u7ef4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1139D Steps to One", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1139D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1139D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_i$\u8868\u793a\u6240\u6709\u6570$\\gcd$\u4e3a$i$\u8fd8\u8981\u52a0\u5165\u7684\u6570\u7684\u671f\u671b\u6570\u91cf\n\n$$ans=1+\\frac{\\sum_{i=1}^mf_i}m$$\n\n\u53ef\u4ee5\u77e5\u9053$f_1=0$\n\n$$f_i=1+\\frac{\\sum_{j=1}^m f_{\\gcd(i,j)}}m(i>1)$$\n\n\u7ee7\u7eed\u63a8\u5f0f\u5b50:\n\n$$\n\\begin{aligned}\nf_i\n&=1+\\frac{\\sum_{j=1}^m f_{\\gcd(i,j)}}m\\\\\n&=1+\\frac{\\sum_{d|i} f_d\\sum_{j=1}^m [\\gcd(i,j)=d]}m\n\\end{aligned}\n$$\n\n\u628a\u5206\u5b50\u62ff\u51fa\u6765\n\n$$\n\\begin{aligned}\n&\\quad\\sum_{d|i} f_d\\sum_{j=1}^m [\\gcd(i,j)=d]\\\\\n&=\\sum_{d|i} f_d\\sum_{j=1}^{m/d} [\\gcd(\\frac id,j)=1]\\\\\n&=\\sum_{d|i} f_d\\sum_{j=1}^{m/d} \\sum_{x|\\frac id,x|j}\\mu(x)\\\\\n&=\\sum_{d|i} f_d \\sum_{x|\\frac id}\\sum_{j=1}^{m/dx}\\mu(x)\\\\\n&=\\sum_{d|i} f_d \\sum_{x|\\frac id}\\mu(x)\\left \\lfloor \\frac m{dx}\\right\\rfloor\\\\\n\\end{aligned}\\\\\n$$\n\n\u8bbe$T=dx$\n\n$$\n=\\sum_{T|i}\\sum_{d|T} f_d \\mu(\\frac Td)\\left \\lfloor \\frac mT\\right\\rfloor\n$$\n\n\u5e26\u5165\u539f\u6765\u7684\u5f0f\u5b50\n\n$$\nf_i=1+\\frac{\\sum_{T|i}\\left \\lfloor \\frac mT\\right\\rfloor\\sum_{d|T} f_d \\mu(\\frac Td)}m\n$$\n\n\u8bbe$F_T=\\sum_{d|T} f_d \\mu(\\frac Td)$\n\n\u5f53$d\\not = i$\u65f6\u53ef\u4ee5\u6bcf\u7b97\u51fa\u4e00\u4e2a$f_i$\u5c31\u66f4\u65b0\u6240\u6709$F_x(i|x)$\n\n\u5f53$d=i$\u65f6\u6ca1\u6cd5\u76f4\u63a5\u66f4\u65b0,\u8fd9\u65f6$T=d=i,\\mu(\\frac Td)=\\mu(1)=1$\n\n$$\nf_i=1+\\frac{\\sum_{T|i}\\left \\lfloor \\frac mT\\right\\rfloor\\sum_{d|T} f_d \\mu(\\frac Td)[d\\not=i]}m+\\frac{f_i\\left\\lfloor \\frac mi \\right\\rfloor}m\n\\\\\nf_i-\\frac{f_i\\left\\lfloor \\frac mi \\right\\rfloor}m=\\frac{m+\\sum_{T|i}\\left \\lfloor \\frac mT\\right\\rfloor\\sum_{d|T} f_d \\mu(\\frac Td)[d\\not=i]}m\n\\\\\nf_i\\frac{m-\\left\\lfloor\\frac mi \\right\\rfloor}m=\\frac{m+\\sum_{T|i}\\left \\lfloor \\frac mT\\right\\rfloor\\sum_{d|T} f_d \\mu(\\frac Td)[d\\not=i]}m\n\\\\\nf_i=\\frac{m+\\sum_{T|i}\\left \\lfloor \\frac mT\\right\\rfloor\\sum_{d|T} f_d \\mu(\\frac Td)[d\\not=i]}{m-\\left\\lfloor\\frac mi \\right\\rfloor}\n$$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u5148\u7b97$f_i$,\u518d\u7b97$F_i$\u4e86\n\n$[d\\not=i]$\u8fd9\u4e2a\u6761\u4ef6\u53ea\u5728$T=i$\u7684\u65f6\u5019\u624d\u6709\u9650\u5236\n\n\u679a\u4e3e\u5230$T=i$,\u8ba1\u7b97$f_i$\u65f6,$F_x(x<i)$\u90fd\u5df2\u7ecf\u8ba1\u7b97\u597d\u4e86\n\n$F_i$\u8fd8\u5c11\u4e86$f[i] \\times \\mu(1)$\n\n\u8fd9\u6b63\u597d\u662f\u8981\u526a\u6389\u7684\u90e8\u5206\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing std::list;\nconst int N=100011,P=1000000007;\nint n,F[N],pri[N],mu[N],tt,inv[N],ans=1;\nbool v[N];\nlist<int>d[N];\nint m(int x){return x>=P?x-P:(x<0?x+P:x);}\nint main(){\n    scanf(\"%d\",&n);\n    mu[1]=1;\n    for(int i=2;i<=n;++i){\n        if(!v[i])pri[++tt]=i,mu[i]=-1;\n        for(int j=1;j<=tt&&i*pri[j]<=n;++j){\n            v[i*pri[j]]=1;\n            if(i%pri[j]==0)break;\n            mu[i*pri[j]]=-mu[i];\n        }        \n    }\n    for(int i=1;i<=n;++i)\n        for(int j=i;j<=n;j+=i)\n            d[j].push_back(i);\n    inv[1]=1;\n    for(int i=2;i<=n;++i)\n\t\tinv[i]=1ll*(P-P/i)*inv[P%i]%P;\n    \n    for(int i=2;i<=n;++i){\n        int f=n;\n        for(auto T:d[i])\n            f=(f+1ll*n/T*F[T])%P;\n        f=1ll*f*inv[n-n/i]%P;\n        ans=m(ans+f+1);\n        for(int j=1,k=i;k<=n;++j,k+=i)\n            F[k]=m(F[k]+f*mu[j]);\n    }\n    printf(\"%d\\n\",1ll*ans*inv[n]%P);\n}\n```\n", "link": "/posts/LG CF1139D Steps to One/", "tags": ["\u83ab\u6bd4\u4e4c\u65af", "\u6570\u8bba", "\u671f\u671b", "\u601d\u7ef4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG AT5200 [AGC038C] LCMs", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/AT5200&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/AT5200\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$a_i=\\sum\\limits_{j=1}^N[A_j=i],n=10^6$\n\n$$\n\\sum_{i=1}^n\\sum_{j=i+1}^n \\operatorname{lcm}(A_i,A_j)\\\\\n=\\sum_{i=1}^n\\sum_{j=i+1}^n a_ia_j\\frac{ij}{\\gcd(i,j)}\\\\\n=\\sum_{d=1}^n\\frac 1d\\sum_{i=1}^n\\sum_{j=i+1}^n a_ia_j ij [\\gcd(i,j)=d]\\\\\n=\\sum_{d=1}^n\\frac 1d\\sum_{i=1}^{n/d}\\sum_{j=i+1}^{n/d} a_{id}a_{jd} idjd [\\gcd(i,j)=1]\\\\\n=\\sum_{d=1}^n d \\sum_{i=1}^{n/d}\\sum_{j=i+1}^{n/d} a_{id}a_{jd} ij [\\gcd(i,j)=1]\\\\\n=\\sum_{d=1}^n d \\sum_{i=1}^{n/d}\\sum_{j=i+1}^{n/d} a_{id}a_{jd} ij \\sum_{x|i,x|j}\\mu(x)\\\\\n=\\sum_{d=1}^n d \\sum_{x=1}^n\\mu(x)\\sum_{i=1}^{n/dx}\\sum_{j=i+1}^{n/dx} a_{idx}a_{jdx} ixjx\\\\\n=\\sum_{d=1}^n d \\sum_{x=1}^n\\mu(x)x^2 \\sum_{i=1}^{n/dx}\\sum_{j=i+1}^{n/dx} a_{idx}a_{jdx} ij\\\\\n$$\n\u8bbe$T=dx$\n$$\n=\\sum_{T=1}^n T \\sum_{x|T}\\mu(x)x \\sum_{i=1}^{n/T}\\sum_{j=i+1}^{n/T} a_{iT}a_{jT} ij\n$$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000111,P=998244353;\nint n,a[N],pri[N],mu[N];\nbool v[N];\nint f(int T){\n\tint k=n/T,sum=0,res=0;\n\tfor(int i=1;i<=k;i++)\n        (sum+=1ll*i*a[i*T]%P)%=P;\n\tfor(int i=1;i<=k;i++)\n\t\t(sum+=P-1ll*i*a[i*T]%P)%=P,\n\t\t(res+=1ll*sum*i%P*a[i*T]%P)%=P;\n\treturn res;\n}\nint main(){\n    int t,x,ans=0;scanf(\"%d\",&t);\n    while(t--){\n        scanf(\"%d\",&x),++a[x];\n        if(x>n)n=x;\n    }\n    mu[1]=1;\n    for(int i=2,tt=0;i<=n;++i){\n        if(!v[i])pri[++tt]=i,mu[i]=-1;\n        for(int j=1;j<=tt&&i*pri[j]<=n;++j){\n            v[i*pri[j]]=1;\n            if(i%pri[j]==0)break;\n            mu[i*pri[j]]=-mu[i];\n        }\n    }\n    for(int i=1;i<=n;++i)\n        mu[i]=(~mu[i])?(mu[i]*i):(mu[i]*i+P);\n    for(int x=n;x;--x)\n        for(int T=x+x;T<=n;T+=x)\n            (mu[T]+=mu[x])%=P;\n    for(int T=1;T<=n;++T)\n        (ans+=1ll*a[T]*(a[T]-1)/2%P*T%P)%=P;\n    for(int T=1;T<=n;++T)\n        (ans+=1ll*T*mu[T]%P*f(T)%P)%=P;\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG AT5200 [AGC038C] LCMs/", "tags": ["\u83ab\u6bd4\u4e4c\u65af", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF938G Shortest Path Queries", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF938G&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF938G\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u4e86\u89e3[\\[WC2011\\]\u6700\u5927XOR\u548c\u8def\u5f84](https://www.luogu.com.cn/problem/P4151)\u7684\u505a\u6cd5\n\n\u7ebf\u6bb5\u6811\u5206\u6cbb+\u5e76\u67e5\u96c6+\u7ebf\u6027\u57fa\n\n\u52a0\u8fb9\u5220\u8fb9\u53ef\u4ee5\u7528\u6309\u79e9\u5408\u5e76\u7684\u5e76\u67e5\u96c6\u89e3\u51b3,\u9047\u5230\u73af\u5c31\u63d2\u5165\u7ebf\u6027\u57fa\n\n\u7531\u4e8e\u5e76\u67e5\u96c6\u65e0\u6cd5\u5220\u9664\u5143\u7d20,\u5220\u8fb9\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u5206\u6cbb\u5904\u7406(\u8f6c\u5316\u4e3a\u6bcf\u6761\u8fb9\u5728\u4e00\u4e2a\u65f6\u95f4\u6bb5\u5b58\u5728)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nint rd(){int x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return f?-x:x;}\nconst int N=200011;\nstruct edge{int x,y,w;}e[N*2];\nint n,m,q,bg[N*2],ed[N*2],ql[N],qr[N],f[N],d[N],dep[N];\nusing namespace std;\nmap<pair<int,int>,int>T;\nstruct XOR{\n    int p[32];\n    void ins(int x){\n        for(int i=30;x,~i;--i)if(x>>i){\n            if(!p[i]){p[i]=x;return;}\n            x^=p[i];\n        }\n    }\n    int ask(int x){\n        for(int i=30;~i;--i)\n            if((x^p[i])<x)x^=p[i];\n        return x;\n    }\n}_;\nint gf(int x){return x==f[x]?x:gf(f[x]);}\nint gd(int x){return x==f[x]?0:d[x]^gd(f[x]);}\nlist<int>s[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){s[rt].push_back(v);return;}\n    int m=l+r>>1;\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n}\nvoid swap(int &x,int &y){x^=y,y^=x,x^=y;}\nint X[N<<2],Y[N<<2],tp;\nbool dd[N<<2];\nvoid qry(int l,int r,int rt,XOR c){\n    int otp=tp;\n    for(auto i:s[rt]){\n        int x=e[i].x,y=e[i].y,\n            fx=gf(x),fy=gf(y),\n            w=e[i].w^gd(x)^gd(y);\n        if(fx==fy)c.ins(w);\n        else{\n            if(dep[fx]>dep[fy])swap(x,y),swap(fx,fy);\n            f[fx]=fy,d[fx]=w;\n            X[++tp]=fx,Y[tp]=fy;\n            if(dep[fx]==dep[fy])++dep[fy],dd[tp]=1;\n        }\n    }\n    if(l==r)printf(\"%d\\n\",c.ask(gd(ql[l])^gd(qr[l])));\n    else{\n        int m=l+r>>1;\n        qry(l,m,ls,c),qry(m+1,r,rs,c);\n    }\n    while(tp!=otp)\n        d[f[X[tp]]=X[tp]]=0,dep[Y[tp]]-=dd[tp],--tp;\n}\nint main(){\n    n=rd(),m=rd();\n    int opt,x,y,w,t=m,ti=1;\n    for(int i=1;i<=m;++i)\n        x=rd(),y=rd(),w=rd(),\n        e[i]={x,y,w},bg[i]=1,ed[i]=-1,\n        T[make_pair(x,y)]=i;\n    q=rd();\n    for(int i=1;i<=q;++i){\n        opt=rd(),x=rd(),y=rd();\n        if(opt==1)\n            e[++t]={x,y,rd()},bg[t]=ti,ed[t]=-1,\n            T[make_pair(x,y)]=t;\n        else if(opt==2)ed[T[make_pair(x,y)]]=ti-1;\n        else ql[ti]=x,qr[ti]=y,++ti;\n    }\n    --ti;\n    for(int i=1;i<=t;++i){\n        if(ed[i]==-1)ed[i]=ti;\n        if(bg[i]<=ed[i])upd(bg[i],ed[i],i,1,ti,1);\n    }\n    for(int i=1;i<=n;++i)f[i]=i;\n    qry(1,ti,1,_);\n}\n```\n", "link": "/posts/LG CF938G Shortest Path Queries/", "tags": ["\u79bb\u7ebf", "\u7ebf\u6027\u57fa", "\u5e76\u67e5\u96c6", "\u7ebf\u6bb5\u6811\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF845G Shortest Path Problem", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF845G&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF845G\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u540c[\\[WC2011\\]\u6700\u5927XOR\u548c\u8def\u5f84](https://www.luogu.com.cn/problem/P4151)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nint rd(){int x=0;char c;bool f=0;for(c=getchar();c<'0'||'9'<c;c=getchar())f^=c=='-';for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return f?-x:x;}\nconst int N=100011;\nint n,m,cnt,head[N],d[N],p[30];\nstruct edge{int to,nxt,w;}e[N<<1];\nvoid add(int x,int y,int w){e[++cnt].to=y,e[cnt].nxt=head[x],head[x]=cnt,e[cnt].w=w;}\nvoid ins(int x){\n    for(int i=27;x,~i;--i)if(x>>i){\n        if(!p[i]){p[i]=x;return;}\n        x^=p[i];\n    }\n}\nbool v[N];\nvoid dfs(int x){\n    v[x]=1;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(!v[to])d[to]=d[x]^e[i].w,dfs(to);\n        else ins(d[x]^d[to]^e[i].w);\n}\nint main(){\n    n=rd(),m=rd();\n    int x,y,w;\n    while(m--)\n        x=rd(),y=rd(),w=rd(),\n        add(x,y,w),add(y,x,w);\n    dfs(1);x=d[n];\n    for(int i=27;~i;--i)\n        if((x^p[i])<x)x^=p[i];\n    printf(\"%d\\n\",x);\n}\n```\n", "link": "/posts/LG CF845G Shortest Path Problem/", "tags": ["\u7ebf\u6027\u57fa", "\u56fe\u8bba", "dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF724G Xor-matic Number of the Graph", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF724G&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF724G\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u505a\u8fd9\u9898\u4e4b\u524d\u53ef\u4ee5\u770b\u770b[\\[WC20$1$\\]\u6700\u5927XOR\u548c\u8def\u5f84](https://www.luogu.com.cn/problem/P4151)\n\n\u53ef\u4ee5\u8003\u8651\u6362\u4e2a\u601d\u8def:\n\n\u5bf9\u4e8e\u6bcf\u4e00\u5bf9\u70b9\u7684\u6bcf\u4e00\u4f4d,\u6709\u591a\u5c11\u79cd\u65b9\u6848\u80fd\u4f7f\u8be5\u4f4d\u7684$xor$\u548c\u4e3a$1$\n\n`dfs`\u6c42\u51fa$1$\u5230\u5404\u70b9$x$\u7684\u4efb\u610f\u4e00\u6761\u7b80\u5355\u8def\u5f84$xor$\u548c$d_x$,\u90a3\u4e48\u6c42$x$\u5230$y$\u7684\u7b80\u5355\u8def\u5f84\u957f\u5ea6\u5c31\u662f$d_x ~ xor ~ d_y$\n\n\u5728`dfs`\u7684\u8fc7\u7a0b\u4e2d\u4e5f\u53ef\u4ee5\u987a\u4fbf\u6c42\u51fa\u6240\u6709\u73af\u7684$xor$\u548c,\u8fd9\u4e9b\u53ef\u4ee5\u7528\u6765\u589e\u5e7f\u7b80\u5355\u8def\u5f84,\u6211\u4eec\u5c06\u8fd9\u4e9b\u73af\u7684$xor$\u548c\u63d2\u5165\u5230\u7ebf\u6027\u57fa\u4e2d\n\n\u82e5\u7ebf\u6027\u57fa\u4e2d\u6709$cnt$\u4e2a\u975e\u96f6\u4f4d,\u5219\u4e00\u5171\u4f1a\u4ea7\u751f$2^{cnt}$\u4e2a\u4e0d\u540c\u7684$xor$\u503c\n\n\u5230\u4e86\u8fd9\u4e00\u6b65,\u901a\u8fc7\u679a\u4e3e\u4e24\u4e2a\u70b9\u6765\u7edf\u8ba1\u8def\u5f84\u7684\u590d\u6742\u5ea6\u4ecd\u7136\u662f$O(n^2 \\cdot 60)$\u7684,\u6211\u4eec\u8981\u91c7\u7528\u66f4\u9ad8\u6548\u7684\u65b9\u6cd5\n\n\u76f4\u63a5\u8ba8\u8bba$d_x$\u5bf9\u7b54\u6848\u7684\u8d21\u732e\n\n\u5148\u7edf\u8ba1\u51fa\u7b2c$k$\u4f4d\u4e3a$0$\u7684\u6570\u7684\u4e2a\u6570,\u6211\u4eec\u5c06\u5176\u8bb0\u4e3a$x$,\u518d\u7edf\u8ba1\u51fa\u7b2c$k$\u4f4d\u4e3a$1$\u7684\u6570\u7684\u4e2a\u6570,\u8bb0\u4e3a$y$,\u603b\u5171\u6709$point$\u4e2a\u70b9\n\n1. $d_x$\u7684\u7b2c$k$\u4f4d\u4e3a$1$,\u7ebf\u6027\u57fa\u4e2d\u6709\u7b2c$k$\u4f4d\u4e3a$1$\u7684\u6570: \n   \u6b64\u65f6\u6211\u4eec\u6709\u4e24\u79cd\u9009\u62e9\uff1a\n   - \u9009\u7ebf\u6027\u57fa\u4e2d\u7684,\u53e6\u4e00\u4e2a\u70b9\u9009\u62e9\u7b2c$k$\u4f4d\u4e3a$0$\u7684\u3002\n   - \u4e0d\u9009\u7ebf\u6027\u57fa\u4e2d\u7684,\u53e6\u4e00\u4e2a\u70b9\u9009\u62e9\u7b2c$k$\u4f4d\u4e3a$1$\u7684\u3002\u603b\u4f53\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u4e3a\uff1a$2^k\\cdot 2^{cnt-1}\\cdot (point-1)$,\u51cf$1$\u5c31\u662f\u4e3a\u4e86\u628a\u81ea\u5df1\u7ed9\u53bb\u6389\u3002\n\n2. $d_i$\u7684\u7b2c$k$\u4f4d\u4e3a$1$,\u7ebf\u6027\u57fa\u4e2d\u6ca1\u6709\u7b2c$k$\u4f4d\u4e3a$1$\u7684\u6570: \u8fd9\u4e2a\u65f6\u5019\u53e6\u4e00\u4e2a\u70b9\u53ea\u80fd\u53d6\u7b2c$k$\u4f4d\u4e3a$0$\u7684,, \u6240\u4ee5\u603b\u8d21\u732e\u4e3a: $2^k\\cdot 2^{cnt}\\cdot x$\u3002\n\n3. $d_i$\u7684\u7b2c$k$\u4f4d\u4e3a$0$,\u7ebf\u6027\u57fa\u4e2d\u6709\u7b2c$k$\u4f4d\u4e3a$1$\u7684\u6570: \u4e00\u6837\u7684,, \u4e24\u79cd\u9009\u62e9:\n   - \u9009\u7ebf\u6027\u57fa\u4e2d\u7684,\u53e6\u4e00\u4e2a\u70b9\u9009\u62e9\u7b2c$k$\u4f4d\u4e3a$0$\u7684\u3002 \n   - \u4e0d\u9009\u7ebf\u6027\u57fa\u4e2d\u7684,\u53e6\u4e00\u4e2a\u70b9\u9009\u62e9\u7b2c$k$\u4f4d\u4e3a$1$\u7684\u3002\u603b\u8d21\u732e\u4e3a: $2^k\\cdot2^{cnt-1}\\cdot(point-1)$\u3002\n\n3. $d_i$\u7684\u7b2c$k$\u4f4d\u4e3a$0$,\u7ebf\u6027\u57fa\u4e2d\u6ca1\u6709\u7b2c$k$\u4f4d\u4e3a$1$\u7684\u6570: \u53e6\u4e00\u4e2a\u70b9\u53ea\u80fd\u53d6\u7b2c$k$\u4f4d\u4e3a$1$\u7684,\u603b\u8d21\u732e: $2^k\\cdot 2^{cnt}\\cdot y$\u3002\n\n<!-- more -->\n\n```cpp\n\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=100001;\nconst ll P=1000000007,inv=500000004;\nstruct edge{int to,nxt;ll w;}e[N<<2];\nint n,m,cnt=1,head[N],tt;\nll pw[61],p[61],a[N],d[N];\nbool v[N],u[N<<2];\nvoid add(int x,int y,ll w){e[++cnt].to=y,e[cnt].nxt=head[x],head[x]=cnt,e[cnt].w=w;}\nvoid ins(ll x){\n    for(int i=60;x,~i;--i)if(x>>i){\n        if(!p[i]){p[i]=x;return;}\n        x^=p[i];\n    }\n}\nvoid dfs(int x){\n    a[++tt]=d[x],v[x]=1;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(!v[to])d[to]=d[x]^e[i].w,dfs(to);\n        else if(!u[i^1])ins(d[x]^d[to]^e[i].w),u[i^1]=1;\n}\nll calc(){\n    ll ans=0;int x,y,tot=0;bool ff;\n    for(int i=0;i<=60;++i)tot+=p[i]>0;\n    for(int j=0;j<=60;++j){\n        x=y=ff=0;\n        for(int i=1;i<=tt;++i)\n            (a[i]>>j&1)?++x:++y;\n        for(int i=0;i<=60;++i)\n            if(p[i]>>j&1){ff=1;break;}\n        for(int i=1;i<=tt;++i,ans%=P)\n            if(a[i]>>j&1)\n                if(ff)ans+=pw[tot-1]*(tt-1)%P*pw[j]%P;\n                else ans+=pw[tot]*y%P*pw[j]%P;\n            else\n                if(ff)ans+=pw[tot-1]*(tt-1)%P*pw[j]%P;\n                else ans+=pw[tot]*x%P*pw[j]%P;\n    }\n    return ans;\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    int x,y;ll w,ans=0;\n    while(m--)\n        scanf(\"%d%d%lld\",&x,&y,&w),\n        add(x,y,w),add(y,x,w);\n    pw[0]=1;\n    for(int i=1;i<=60;++i)pw[i]=(pw[i-1]<<1)%P;\n    for(int i=1;i<=n;++i)if(!v[i]){\n        memset(p,0,sizeof p);\n        tt=0,dfs(i);\n        (ans+=calc())%=P;\n    }\n    ans=ans*inv%P;\n    printf(\"%lld\\n\",ans);\n}\n```", "link": "/posts/LG CF724G Xor-matic Number of the Graph/", "tags": ["\u7ebf\u6027\u57fa", "\u601d\u7ef4", "\u56fe\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3857 [TJOI2008]\u5f69\u706f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3857&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3857\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ebf\u6027\u57fa\u4e2d\u6bcf\u4e2a\u5143\u7d20\u7684\u5f02\u6216\u65b9\u6848\u552f\u4e00,\u4e5f\u5c31\u662f\u8bf4,\u7ebf\u6027\u57fa\u4e2d\u4e0d\u540c\u7684\u5f02\u6216\u7ec4\u5408\u5f02\u6216\u51fa\u7684\u6570\u90fd\u662f\u4e0d\u4e00\u6837\u7684\u3002\n\n\u90a3\u4e48\u6211\u4eec\u628a\u5b57\u7b26\u4e32\u8f6c\u6210\u4e8c\u8fdb\u5236,\u7136\u540e\u63d2\u5165\u7ebf\u6027\u57fa\n\n\u7ebf\u6027\u57fa\u5185\u7684\u5143\u7d20\u90fd\u662f\u7531\u5916\u754c\u5143\u7d20\u5f02\u6216\u51fa\u6765\u7684,\u90a3\u4e48\u5bf9\u4e8e\u7ebf\u6027\u57fa\u5185\u6bcf\u4e2a\u5143\u7d20,\u6211\u4eec\u90fd\u6709\u9009/\u4e0d\u9009\u4e24\u79cd\u60c5\u51b5,\n\n\u5047\u8bbe\u7ebf\u6027\u57fa\u5185\u6709$cnt$\u4e2a\u5143\u7d20,\u7b54\u6848\u5c31\u662f$2^{cnt}$\n<!-- more -->\n\n```cpp\n#include<cstdio>\ntypedef long long ll;\nint n,m,ans;\nll p[51];\nchar s[50];\nvoid ins(ll x){\n    for(int i=n;x,~i;--i)if(x>>i){\n        if(!p[i]){\n            p[i]=x,++ans;\n            return;\n        }\n        x^=p[i];\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=1;i<=m;++i){\n        scanf(\"%s\",s);\n        ll x=0;\n        for(int j=0;j<n;++j)\n            if(s[j]=='O')x+=1<<n-j;\n        ins(x);\n    }\n    printf(\"%d\\n\",(1ll<<ans)%2008);\n}\n```\n", "link": "/posts/LG 3857 [TJOI2008]\u5f69\u706f/", "tags": ["\u7ebf\u6027\u57fa"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3292 [SCOI2016]\u5e78\u8fd0\u6570\u5b57", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3292&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3292\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ebf\u6027\u57fa\u642c\u5230\u4e86\u6811\u4e0a\n\n\u7ebf\u6027\u57fa\u662f\u652f\u6301\u5408\u5e76\u7684\n\n\u8fd9\u9898\u5c31\u662f\u500d\u589e\u66b4\u529b\u5408\u5e76\u7ebf\u6027\u57fa\n\n\u867d\u7136$O(\\log^3_2n)$\u7684\u590d\u6742\u5ea6\u5df2\u7ecf\u53ef\u4ee5\u901a\u8fc7\u4e86,\u4f46\u662f\u8fd8\u6709\u66f4\u4f18\u7684\u65b9\u6cd5\n\n\u5728\u500d\u589e\u627e\u51fa\u8be2\u95ee\u4e24\u70b9\u7684lca,\u7136\u540e\u4ee5rmq\u7684\u65b9\u5f0f\u5408\u5e76+\u67e5\u8be2\u7ebf\u6027\u57fa,\u53ef\u4ee5\u5c06\u590d\u6742\u5ea6\u964d\u5230$O(\\log^2_2n)$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nconst int N=20011;\ntypedef long long ll;\nint head[N],cnt,n,q,f[21][N],dep[N],l2[N];\nll a[N],d[21][N][61],ans[61];\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y,e[cnt].nxt=head[x],head[x]=cnt;}\nbool v[N];\nvoid ins(ll *p,ll x){\n    for(int i=60;x,~i;--i)if((x>>i)&1){\n        if(!p[i]){p[i]=x;return;}\n        x^=p[i];\n    }\n}\nvoid mg(ll *a,ll *b){\n    for(int i=60;~i;--i)\n        if(a[i])ins(b,a[i]);\n}\nvoid dfs(int x){\n    dep[x]=dep[f[0][x]]+1,ins(d[0][x],a[x]);\n    fur(i,1,l2[dep[x]])\n        f[i][x]=f[i-1][f[i-1][x]],\n        mg(d[i-1][x],d[i][x]),\n        mg(d[i-1][f[i-1][x]],d[i][x]);\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to!=f[0][x])f[0][to]=x,dfs(to);\n}\nint lca(int x,int y){\n    if(dep[x]<dep[y])x^=y,y^=x,x^=y;\n    while(dep[x]>dep[y])\n        x=f[l2[dep[x]-dep[y]]][x];\n    if(x==y)return y;\n    for(int i=l2[dep[x]];~i;--i)\n        if(f[i][x]^f[i][y])\n            x=f[i][x],y=f[i][y];\n    return f[0][x];\n}\nint kth(int x,int k){\n    for(int i=15;~i;--i)\n        if((k>>i)&1)x=f[i][x];\n    return x;\n}\nll ask(int x,int y){\n    memset(ans,0,sizeof ans);\n    int z=lca(x,y),k=l2[dep[x]-dep[z]];\n    mg(d[0][z],ans),\n    mg(d[k][x],ans),\n    mg(d[k][kth(x,dep[x]-dep[z]-(1<<k))],ans);\n    k=l2[dep[y]-dep[z]];\n    mg(d[k][y],ans),\n    mg(d[k][kth(y,dep[y]-dep[z]-(1<<k))],ans);\n    ll res=0;\n    for(int i=60;~i;--i)\n        if((res^ans[i])>res)res^=ans[i];\n    return res;\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    fur(i,1,n)scanf(\"%lld\",a+i);\n    int x,y;\n    fur(i,2,n)\n        l2[i]=l2[i>>1]+1,\n        scanf(\"%d%d\",&x,&y),\n        add(x,y),add(y,x);\n    dfs(1);\n    while(q--)\n        scanf(\"%d%d\",&x,&y),\n        printf(\"%lld\\n\",ask(x,y));\n}\n```\n", "link": "/posts/LG 3292 [SCOI2016]\u5e78\u8fd0\u6570\u5b57/", "tags": ["\u7ebf\u6027\u57fa", "\u500d\u589e", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4151 [WC2011]\u6700\u5927XOR\u548c\u8def\u5f84", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4151&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4151\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n(\u4ee5\u4e0b\u957f\u5ea6\u5b9a\u4e49\u4e3a\u8fb9\u6743\u5f02\u6216\u548c)\n\n\u9996\u5148\u94a6\u5b9a\u4e00\u67611\u5230n\u7684\u8def\u5f84\n\n\u5bb9\u6613\u53d1\u73b0\u53ef\u4ee5\u901a\u8fc7\u73af\u6765\u589e\u5e7f\u8def\u5f84\n\n\u8def\u5f84\u5230\u73af\u4e2d\u95f4\u7684\u8def\u7a0b\u8981\u8d70\u4e24\u6b21,\u76f8\u5f53\u4e8e\u6ca1\u6709\n\n\u90a3\u4e48\u628a\u6240\u6709\u73af\u7684\u957f\u5ea6\u63d2\u5165\u7ebf\u6027\u57fa,\n\n\u76f4\u63a5\u968f\u610f\u627e\u4e00\u67611\u5230n\u7684\u8def\u5f84,\u7136\u540e\u6c42\u8fd9\u6761\u8def\u5f84\u957f\u5ea6\u5728\u7ebf\u6027\u57fa\u4e0a\u6700\u5927\u80fd\u5f02\u6216\u6210\u591a\u5c11\u5373\u53ef\n\n\u5047\u8bbe1\u5230n\u6709\u4e00\u6761\u66f4\u597d\u7684\u8def\u5f84,\u90a3\u4e48\u4f1a\u548c\u521a\u624d\u94a6\u5b9a\u7684\u8def\u5f84\u5f62\u6210\u4e00\u4e2a\u73af,\u76f8\u5f53\u4e8e\u5f02\u6216\u65f6\u5df2\u7ecf\u8003\u8651\u8fc7\u4e86\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100001,inf=2122219134;\ntypedef long long ll;\nint n,m,cnt,head[N];\nstruct edge{int to,nxt;ll w;}e[N<<1];\nvoid add(int x,int y,ll w){e[++cnt].to=y,e[cnt].nxt=head[x],head[x]=cnt;e[cnt].w=w;}\nll p[61],d[N],ans;\nvoid ins(ll x){\n    for(int i=60;~i;--i)if(x>>i){\n        if(!p[i]){p[i]=x;return;}\n        x^=p[i];\n    }\n}\nll ask(ll ans){\n    for(int i=60;~i;--i)\n        if((ans^p[i])>ans)ans^=p[i];\n    return ans;\n}\nbool v[N];\nvoid dfs(int x,ll res){\n    d[x]=res,v[x]=1;\n    for(int i=head[x];i;i=e[i].nxt)\n        if(v[e[i].to])ins(res^e[i].w^d[e[i].to]);\n        else dfs(e[i].to,res^e[i].w);\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    int x,y;ll w;\n    while(m--)\n        scanf(\"%d%d%lld\",&x,&y,&w),\n        add(x,y,w),add(y,x,w);\n    dfs(1,0);\n    ans=d[n];\n    for(int i=60;~i;--i)\n        if((ans^p[i])>ans)ans^=p[i];\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 4151 [WC2011]\u6700\u5927XOR\u548c\u8def\u5f84/", "tags": ["\u7ebf\u6027\u57fa", "\u56fe\u8bba", "dfs", "\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4570 [BJWC2011]\u5143\u7d20", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4570&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4570\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u6309\u9b54\u6cd5\u503c\u6392\u5e8f,\u7136\u540e\u6309\u987a\u5e8f\u63d2\u5165,\u5982\u679c\u4e0d\u80fd\u88ab\u5f53\u524d\u96c6\u5408\u5f02\u6216\u51fa\u6765,\u90a3\u4e48\u63d2\u5165\u5e76\u52a0\u4e0a\u5176\u8d21\u732e\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=1001;\nint n,ans=0;\nll p[61];\nstruct node{\n    int v;ll x;\n    bool operator<(node t){return v>t.v;}\n}a[N];\nvoid ins(ll x,int v){\n    for(int i=60;~i;--i)if(x>>i){\n        if(!p[i]){\n            p[i]=x,ans+=v;\n            return;\n        }\n        x^=p[i];\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)\n        scanf(\"%lld%d\",&a[i].x,&a[i].v);\n    std::sort(a+1,a+n+1);\n    for(int i=1;i<=n;++i)ins(a[i].x,a[i].v);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 4570 [BJWC2011]\u5143\u7d20/", "tags": ["\u7ebf\u6027\u57fa", "\u4e8c\u8fdb\u5236", "\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 6025 \u7ebf\u6bb5\u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P6025&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P6025\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n40%\u7684$log n$\u505a\u6cd5\u633a\u5bb9\u6613\u7684,\u5c31\u662f\u4e00\u76f4\u5f80\u53f3\u513f\u5b50\u8d70,\u8d70\u5230\u53f6\u5b50\u5c31\u5f80\u5de6\u8d70,\u4e00\u76f4\u91cd\u590d\u5373\u53ef\n\n100%\u7684\u505a\u6cd5\uff1a\n\n\u9996\u5148\u53ef\u4ee5\u628a$f(l)\\bigoplus\\dots\\bigoplus f(r)$\u53d8\u6210\n\n$[f(1)\\bigoplus f(2)\\bigoplus\\dots\\bigoplus f(r)]\\bigoplus[f(1)\\bigoplus f(2)\\bigoplus\\dots\\bigoplus f(l-1)]$\n\n\u663e\u7136$f(2^k)=f(2^k+1)=2^{k+1}-1$\n\n\u63a5\u7740\u53ef\u4ee5\u53d1\u73b0$\\forall k,1\\le t\\le 2^k-1,f(2^k+2t)=f(2^k+2t+1)$\n\n\u56e0\u4e3a\u6700\u4e0b\u4e00\u5c42\u6ca1\u6709\u586b\u6ee1\u6574\u4e00\u5c42,\u53ea\u586b\u6ee1\u4e86\u6839\u8282\u70b9\u7684\u5de6\u5b50\u6811,\u6839\u8282\u70b9\u7684\u53f3\u5b50\u6811\u5e76\u6ca1\u6709\u53d1\u751f\u53d8\u5316\n\n\u5269\u4e0b\u7684$f(n)$\u5c31\u9700\u8981\u8003\u8651\u4e00\u4e0b\u4e86\n\n\u9996\u5148\u7b97\u51fa\u6811\u7684\u6df1\u5ea6(\u6839\u8282\u70b9\u6df1\u5ea6\u4e3a0)\n\n\u5de6\u8fb9: \u5373\u4f7f\u6ca1\u5360\u6ee1\u4e5f\u5168\u7b97\n\n\u53f3\u8fb9: $f(n/2)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nbool chk(ll n){return !(n&(n-1));}\nll f(ll n,int d){\n    if(chk(n)||chk(n-1))return (n<<1)-1;\n    return f(n>>1,d-1)+(1ll<<d);\n}\nll f(ll n){return f(n,log2(n-1)+1);}\n#include<bits/extc++.h>\nll g(ll n){\n    if(!n)return 0;\n    ll res=0;\n    __gnu_pbds::gp_hash_table<ll,bool>b;\n    for(ll i=1;i<=n;i<<=1){\n        if(!b[i])b[i]=1,res^=f(i);\n        if(i<n&&!b[i+1])b[i+1]=1,res^=f(i+1);\n    }\n    if(n&1^1&&!b[n])res^=f(n);\n    return res;\n}\nint main(){\n    ll l,r;\n    scanf(\"%lld%lld\",&l,&r);\n    printf(\"%lld\\n\",g(r)^g(l-1));\n}\n```\n", "link": "/posts/LG 6025 \u7ebf\u6bb5\u6811/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 6569 [NOI Online 3 \u63d0\u9ad8\u7ec4]\u9b54\u6cd5\u503c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P6569&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P6569\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u77e9\u9635\u4e58\u6cd5\n\n\u8fd9\u9898\u500d\u589e\u52a0\u901f\u6bd4\u5feb\u901f\u5e42\u5feb,\u53ef\u4ee5\u8282\u7701\u5f88\u591a\u591a\u4f59\u7684\u8ba1\u7b97\n\n\u4e8c\u8fdb\u5236\u62c6\u4f4d\u540e\u624d\u80fd\u77e9\u9635\u8fd0\u7b97\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define fur(i,x,y) for(int i=x;i<=y;++i)\ntypedef unsigned int ll;\nll rd(){ll x=0;char c;for(c=getchar();c<'0'||'9'<c;c=getchar());for(x=c-48,c=getchar();'0'<=c&&c<='9';x=x*10+c-48,c=getchar());return x;}\nchar cr[50];int tt;\nvoid print(ll x){\n    if(!x)putchar('0');\n    while(x)cr[++tt]=x%10+'0',x/=10;\n    while(tt)putchar(cr[tt--]);\n    putchar('\\n');\n}\nint n,m,q;ll f[101],g[101],t[101];\nstruct mat{bool a[101][101];}bs[32];\nmat operator*(mat a,mat b){\n    mat c;\n    fur(i,1,n)fur(j,1,n){\n        c.a[i][j]=0;\n        fur(k,1,n)c.a[i][j]^=a.a[i][k]&b.a[k][j];\n    }\n    return c;\n}\nvoid mul(mat x){\n    memset(t,0,n*4+4);\n    fur(i,1,n)fur(j,1,n)\n        if(x.a[i][j])t[i]^=g[j];\n    fur(i,1,n)g[i]=t[i];\n}\nll solve(ll v){\n    fur(i,1,n)g[i]=f[i];\n    fur(i,0,31)if((v>>i)&1)mul(bs[i]);\n    return g[1];\n}\nint main(){\n    n=rd(),m=rd(),q=rd();\n    int x,y;;\n    fur(i,1,n)f[i]=rd();\n    fur(i,1,m)\n        x=rd(),y=rd(),\n        bs[0].a[x][y]=bs[0].a[y][x]=1;\n    fur(i,1,31)bs[i]=bs[i-1]*bs[i-1];\n    while(q--)print(solve(rd()));\n}\n```\n", "link": "/posts/LG 6569 [NOI Online 3 \u63d0\u9ad8\u7ec4]\u9b54\u6cd5\u503c/", "tags": ["\u500d\u589e", "\u4e8c\u8fdb\u5236", "\u77e9\u9635\u4e58\u6cd5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4070 [SDOI2016]\u751f\u6210\u9b54\u5492", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4070&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4070\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u8003\u8651\u628a\u5b57\u7b26\u4e32\u5012\u5e8f\n\n\u8fd9\u6837\u6dfb\u52a0\u4e00\u4e2a\u5b57\u6bcd\u76f8\u5f53\u4e8e\u589e\u52a0\u4e86\u4e00\u4e2a\u540e\u7f00,\u76f8\u5bf9\u539f\u6765\u66f4\u597d\u5904\u7406\n\n\u53ef\u4ee5\u53d1\u73b0\u5728\u63d2\u5165\u65b0\u7684\u5b57\u7b26\u4e32\u65f6,height\u6539\u53d8\u7684\u53ea\u6709`height[pre],height[p],height[nxt]`\n\n\u901a\u8fc7\u5e73\u8861\u6811\u52a8\u6001\u7ef4\u62a4\u8fd9\u4e09\u4e2a\u4f4d\u7f6e\u5c31\u53ef\u4ee5\u4e86\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid cmax(int &x,int y){if(x<y)x=y;}\nint rd(){int x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);return f?-x:x;}\nconst int N=100011;\nusing std::set;\nint n,m,s[N],sa[N],rnk[N],tax[N],tp[N],height[N],f[20][N];\nvoid qsort(){\n    fur(i,0,m)tax[i]=0;\n    fur(i,1,n)++tax[rnk[i]];\n    fur(i,1,m)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=100000;\n    fur(i,1,n)tp[i]=i,rnk[i]=s[i];\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        fur(i,1,w)tp[++p]=n-w+i;\n        fur(i,1,n)if(sa[i]>w)tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        fur(i,2,n)rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n}\nvoid gh(){\n    for(int i=1,k=0;i<=n;++i){\n        if(k)--k;\n        int j=sa[rnk[i]-1];\n        while(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n        height[rnk[i]]=k;\n    }\n}\nint min(int x,int y){return x<y?x:y;}\nvoid st(){\n    fur(i,1,n)f[0][i]=height[i];\n    fur(k,1,20)\n        fur(i,1,n-(1<<k)+1)\n            f[k][i]=min(f[k-1][i],f[k-1][i+(1<<k-1)]);\n}\nint ask(int l,int r){\n    if(l==r)return -1u>>1;\n    ++l;\n    int k=log2(r-l+1);\n    return min(f[k][l],f[k][r-(1<<k)+1]);\n}\nstruct qwq{int v,p;bool operator<(qwq t){return v<t.v;}}b[N];\nset<int>T;\nint main(){\n    n=rd();\n    fur(i,1,n)b[i]={rd(),i};\n    std::sort(b+1,b+n+1);\n    int p=0;long long ans=0;\n    fur(i,1,n)s[n-b[i].p+1]=p+=b[i].v!=b[i-1].v;\n    suffix(),gh(),st();\n    for(int i=n;i;--i){\n        T.insert(rnk[i]);\n        set<int>::iterator it=T.find(rnk[i]);\n        int k=0;\n        if(it!=T.begin()){\n            p=*(--it);\n            k=ask(p,rnk[i]);\n            ++it;\n        }\n        ++it;\n        if(it!=T.end()){\n            p=*it;\n            cmax(k,ask(rnk[i],p));\n        }\n        ans+=n-i+1-k;\n        printf(\"%lld\\n\",ans);\n    }\n}\n```\n", "link": "/posts/LG 4070 [SDOI2016]\u751f\u6210\u9b54\u5492/", "tags": ["\u540e\u7f00\u6570\u7ec4", "\u5e73\u8861\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2336 [SCOI2012]\u55b5\u661f\u7403\u4e0a\u7684\u70b9\u540d", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2336&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2336\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6709\u591a\u79cd\u505a\u6cd5\n\nAC\u81ea\u52a8\u673a\u66b4\u529b\n\nAC\u81ea\u52a8\u673a+\u6811\u72b6\u6570\u7ec4+lca+dfs\u5e8f\n\n\u540e\u7f00\u6570\u7ec4+ST\u8868+\u6811\u72b6\u6570\u7ec4\n\n\n\n## AC\u81ea\u52a8\u673a\u66b4\u529b\n\n\u539f\u6570\u636e\u53ef\u4ee5\u8fc7,\u540e\u6765\u6dfb\u52a0\u4e86\u52a0\u5f3a\u6570\u636e\u5c31tle\u4e86\n\n\u5bf9\u70b9\u540d\u4e32\u5efa\u7acbAC\u81ea\u52a8\u673a,\u679a\u4e3e\u540d\u5b57\u5728\u4e0a\u9762\u5339\u914d,\u8df3fail\u6811\u7edf\u8ba1\n\n\u8bb0\u5f97\u7528\u4e8e\u6807\u8bb0\u662f\u5426\u8bbf\u95ee\u7684\u6570\u7ec4\u4e0d\u80fd\u7528memset\u6e05\u96f6,\u8981\u6309\u539f\u6765\u7684\u4fee\u6539\u56de\u53bb\n\n\u7384\u5b66\u590d\u6742\u5ea6\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#include<bits/extc++.h>\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nconst int N=100001;\nusing std::list,__gnu_pbds::gp_hash_table;\nint fail[N],sz,q[N],ans[N],ANS[N],vi[N],VI[N],vp,VP;\nlist<int>s1[50001],s2[50001],ed[N];\ngp_hash_table<int,int>c[N];\nbool vis[N],VIS[N];\nint main(){\n    int n,m,tot,now,v;\n    in(n,m);\n    fur(i,1,n){\n        in(tot);while(tot--)in(v),s1[i].push_back(v);\n        in(tot);while(tot--)in(v),s2[i].push_back(v);\n    }\n    fur(i,1,m){\n        now=0,in(tot);\n        while(tot--){\n            in(v);\n            if(!c[now][v])c[now][v]=++sz;\n            now=c[now][v];\n        }\n        ed[now].push_back(i);\n    }\n    int h=0,t=0;\n    for(auto to:c[0])\n        fail[to.second]=0,q[t++]=to.second;\n    while(h<t){\n        int now=q[h++];\n        for(auto to:c[now]){\n            int k=fail[now];\n            while(k&&!c[k][to.first])k=fail[k];\n            fail[to.second]=c[k][to.first],q[t++]=to.second;\n        }\n    }\n    fur(i,1,n){\n        now=0;\n        for(auto x:s1[i]){\n            while(now&&!c[now][x])now=fail[now];\n            now=c[now][x];\n            for(t=now;t;t=fail[t])if(!vis[t]){\n                vis[t]=1,vi[++vp]=t;\n                for(int to:ed[t])if(!VIS[to])\n                    VIS[to]=1,VI[++VP]=to,\n                    ++ans[to],++ANS[i];\n            }\n        }\n        now=0;\n        for(auto x:s2[i]){\n            while(now&&!c[now][x])now=fail[now];\n            now=c[now][x];\n            for(t=now;t;t=fail[t])if(!vis[t]){\n                vis[t]=1,vi[++vp]=t;\n                for(int to:ed[t])if(!VIS[to])\n                    VIS[to]=1,VI[++VP]=to,\n                    ++ans[to],++ANS[i];\n            }\n        }\n        while(vp)vis[vi[vp--]]=0;\n        while(VP)VIS[VI[VP--]]=0;\n    }\n    fur(i,1,m)out(ans[i]),pt('\\n');\n    fur(i,1,n)out(ANS[i]),pt(' ');\n    flush();\n}\n```\n\n## \u540e\u7f00\u6570\u7ec4\u6b63\u89e3\n\n\u540e\u7f00\u6570\u7ec4+rmq+\u4e8c\u5206+\u540e\u7f00\u6570\u7ec4\n\n\u6211\u4eec\u5c06\u6240\u6709\u59d3\u540d\u4e32\u548c\u70b9\u540d\u4e32\u62fc\u5728\u4e00\u8d77,\u4e2d\u95f4\u7528\u539f\u4e32\u4e2d\u4e0d\u4f1a\u51fa\u73b0\u7684\u6570\u9694\u5f00,\u5bf9\u6bcf\u4e2a\u70b9\u8bb0\u5f55\u5b83\u662f\u54ea\u4e2a\u4e32\u7684\u3002\n\n\u6c42\u51fasa,rnk,height\u6570\u7ec4,\u5efa\u7acbheight\u6570\u7ec4\u7684rmq\n\n\u63a5\u7740\u8f6c\u5316\u95ee\u9898\n\n\u7b2c\u4e00\u95ee: \n\n\u8bbe\u5f53\u524d\u8be2\u95ee\u7684\u5b57\u7b26\u4e32\u5728\u4e32\u8d77\u6765\u7684\u5b57\u7b26\u4e32\u4e2d\u8d77\u59cb\u4f4d\u7f6e\u4e3a$i$,\u6392\u540d\u4e3a$rnk_i$,\u957f\u5ea6\u4e3a$len_i$\n\n\u6c42\u5728\u6240\u6709\u540e\u7f00\u4e2d,\u4e0e\u5f53\u524d\u8be2\u95ee\u7684\u5b57\u7b26\u4e32\u540e\u7f00$\\operatorname{LCP}$\u7b49\u4e8e\u5f53\u524d\u5b57\u7b26\u4e32\u957f\u5ea6\u7684,\u5c5e\u4e8e\u591a\u5c11\u4e2a\u540d\u5b57\n\n\u53ef\u4ee5\u901a\u8fc7\u4e8c\u5206\u6c42\u51fa\u8303\u56f4,\u7136\u540e\u5224\u65ad\n\n\u95ee\u9898\u4e5f\u5c31\u8f6c\u5316\u6210: \u6c42\u7ed9\u5b9a\u8303\u56f4\u5185\u989c\u8272\u6570\u76ee, (HH\u7684\u9879\u94fe)\n\n\u7b2c\u4e8c\u95ee\u4e5f\u5c31\u8f6c\u5316\u6210: \u6c42\u6bcf\u4e2a\u989c\u8272\u88ab\u591a\u5c11\u4e2a\u8be2\u95ee\u533a\u95f4\u8986\u76d6\n\n\u8bbf\u95ee\u5230L\u5904\u7ed9\u6811\u72b6\u6570\u7ec4`bit[L]++`,\u5230R\u65f6`bit[L]--`,\u5230i\u65f6\u67e5\u8be2`sum(i)-sum(pre[i])`\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nint rd(){int x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);return f?-x:x;}\nconst int N=300011;\nint nn,q,n,m,col[N],s[N],sa[N],rnk[N],height[N],len[N],tax[N],tp[N];\nvoid qsort(){\n    fur(i,0,m)tax[i]=0;\n    fur(i,1,n)++tax[rnk[i]];\n    fur(i,1,m)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=11111;\n    fur(i,1,n)tp[i]=i,rnk[i]=s[i];\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        fur(i,1,w)tp[++p]=n-w+i;\n        fur(i,1,n)if(sa[i]>w)tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        fur(i,2,n)rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n}\nvoid gh(){\n    int k=0,j;fur(i,1,n){\n        if(k)--k;\n        j=sa[rnk[i]-1];\n        while(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n        height[rnk[i]]=k;\n    }\n}\nint f[19][N];\nint min(int x,int y){return x<y?x:y;}\nvoid st(){\n    fur(i,1,n)f[0][i]=height[i];\n    fur(i,1,18)\n        fur(j,1,n-(1<<i)+1)\n            f[i][j]=min(f[i-1][j],f[i-1][j+(1<<i-1)]);\n}\nint ask(int l,int r){\n    if(l==r)return -1u>>1;\n    if(l>r)l^=r,r^=l,l^=r;\n    ++l;\n    int k=log2(r-l+1);\n    return min(f[k][l],f[k][r-(1<<k)+1]);\n}\nint t1[N],t2[N];\nvoid upd(int*tr,int x,int v){if(x)for(;x<=n;x+=x&-x)tr[x]+=v;}\nint qry(int*tr,int x){int res=0;for(;x;x-=x&-x)res+=tr[x];return res;}\nint qry(int*tr,int x,int y){return qry(tr,y)-qry(tr,x-1);}\nint pre[N],b[N],que[N],lp[N];\nstruct node{\n    int id,l,r;\n    bool operator<(node t){return r<t.r;}\n}p[N];\nint a1[N],a2[N];\nint main(){\n    nn=rd(),q=rd();\n    fur(i,1,nn){\n        for(int x=rd();x--;)col[++n]=i,s[n]=rd();s[++n]=10001;\n        for(int x=rd();x--;)col[++n]=i,s[n]=rd();s[++n]=10001;\n    }\n    fur(i,1,q){\n        len[n+1]=rd(),que[n+1]=i;\n        for(int j=len[n+1];j--;)col[++n]=-i,s[n]=rd();s[++n]=10001;\n    }\n    suffix(),gh(),st();\n    fur(i,1,n){\n        if(col[sa[i]]>0){// \u6c42\u51fapre\u6570\u7ec4\n            pre[i]=b[col[sa[i]]];\n            b[col[sa[i]]]=i;\n        }\n        if(que[i]){// \u4e8c\u5206\u51fa\u8be2\u95ee\u8303\u56f4\n            p[que[i]].id=que[i];\n            int l=1,r=rnk[i];\n            while(l<r){\n                int mid=l+r>>1;\n                if(ask(mid,rnk[i])>=len[i])r=mid;\n                else l=mid+1;\n            }\n            lp[que[i]]=p[que[i]].l=l;\n            l=rnk[i],r=n;\n            while(l<r){\n                int mid=l+r+1>>1;\n                if(ask(mid,rnk[i])>=len[i])l=mid;\n                else r=mid-1;\n            }\n            p[que[i]].r=r;\n        }\n    }\n    std::sort(p+1,p+q+1);\n    std::sort(lp+1,lp+q+1);\n    for(int i=1,j=1,k=1;i<=n;++i){\n        int t=0;for(;j<=q&&lp[j]==i;++j)++t;\n        upd(t2,i,t);\n        if(col[sa[i]]>0)\n            a2[col[sa[i]]]+=qry(t2,pre[i]+1,i),\n            upd(t1,i,1),upd(t1,pre[i],-1);\n        for(;k<=q&&p[k].r==i;++k){\n            a1[p[k].id]=qry(t1,p[k].l,p[k].r);\n            upd(t2,p[k].l,-1);\n        }\n    }\n    fur(i,1,q)printf(\"%d\\n\",a1[i]);\n    fur(i,1,nn)printf(\"%d \",a2[i]);\n}\n```\n", "link": "/posts/LG 2336 [SCOI2012]\u55b5\u661f\u7403\u4e0a\u7684\u70b9\u540d/", "tags": ["AC\u81ea\u52a8\u673a", "\u540e\u7f00\u6570\u7ec4", "rmq", "\u4e8c\u5206", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2463 [SDOI2008]Sandy\u7684\u5361\u7247", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2463&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2463\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n> \u76f8\u540c\u7684\u5b9a\u4e49\u4e3a\uff1a\u4e24\u4e2a\u5b50\u4e32\u957f\u5ea6\u76f8\u540c\u4e14\u4e00\u4e2a\u4e32\u7684\u5168\u90e8\u5143\u7d20\u52a0\u4e0a\u4e00\u4e2a\u6570\u5c31\u4f1a\u53d8\u6210\u53e6\u4e00\u4e2a\u4e32\n\n\u90a3\u4e48\u6211\u4eec\u5dee\u5206\u4e4b\u540e\u518d\u5224\u65ad\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid cmin(int &x,int y){if(x>y)x=y;}\nint rd(){int x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);return f?-x:x;}\nconst int N=1000011;\nint cnt,n,m,sa[N],rnk[N],height[N],tax[N],tp[N],col[N],s[N];\nvoid qsort(){\n    fur(i,0,m)tax[i]=0;\n    fur(i,1,n)++tax[rnk[i]];\n    fur(i,1,m)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=3000;\n    fur(i,1,n)rnk[i]=s[i],tp[i]=i;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        fur(i,1,w)tp[++p]=n-w+i;\n        fur(i,1,n)if(sa[i]>w)tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        fur(i,2,n)\n            rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n}\nvoid gh(){\n    for(int i=1,k=0;i<=n;++i){\n        if(k)--k;\n        int j=sa[rnk[i]-1];\n        while(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n        height[rnk[i]]=k;\n    }\n}\n/* \u4e8c\u5206\u5224\u65ad\nbool v[N];\nint sta[N],top;\nbool chk(int x){\n\twhile(top)v[sta[top--]]=0;\n\tfor (int i=1;i<=n;i++) {\n\t\tif (height[i]<x)while(top)v[sta[top--]]=0;\n\t\tif(!v[col[sa[i]]]){\n\t\t\tv[col[sa[i]]]=1;\n\t\t\tsta[++top]=col[sa[i]];\n\t\t\tif(top==cnt)return 1; \n\t\t}\n\t}\n\treturn 0;\n}\n*/\nint tot,v[N],q[N],L[N],R[N];\nvoid add(int x){if(col[x]&&++v[col[x]]==1)++tot;}\nvoid del(int x){if(col[x]&&!--v[col[x]])--tot;}\nint main(){\n    int mi=-1u>>1;\n    cnt=rd();\n    fur(i,1,cnt){\n        int t=rd(),la=rd();\n        L[i]=n+1;\n        while(--t)s[++n]=rd()-la,la+=s[n],cmin(mi,s[i]);\n        R[i]=n;\n        s[++n]=1865+i;\n    }\n    fur(i,1,n)s[i]=s[i]-mi+1;\n    suffix(),gh();\n    /* \u4e8c\u5206\n    int l=0,r=110,ans=0;\n    while (l<=r){\n\t\tint mid=l+r>>1;\n\t\tif (chk(mid))l=mid+1,ans=mid;\n\t\telse r=mid-1;\n\t}\n    */\n    fur(i,1,cnt)fur(j,L[i],R[i])col[rnk[j]]=i;\n    int h=1,t=0,l=1,ans=0;\n    add(1);\n    fur(i,2,n){\n        while(h<=t&&height[i]<=height[q[t]])--t;\n        q[++t]=i;\n        add(i);\n        if(tot==cnt){\n            while(tot==cnt&&l<i)del(l++);\n            add(--l);\n        }\n        while(h<=t&&q[h]<=l)++h;\n        if(tot==cnt&&height[q[h]]>ans)ans=height[q[h]];\n    }\n    printf(\"%d\\n\",ans+1);\n}\n```\n", "link": "/posts/LG 2463 [SDOI2008]Sandy\u7684\u5361\u7247/", "tags": ["\u540e\u7f00\u6570\u7ec4", "\u4e8c\u5206", "\u5dee\u5206", "\u5355\u8c03\u961f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP694 DISUBSTR - Distinct Substrings", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP694&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP694\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nchar s[N];\nint n,m,tax[N],tp[N],rnk[N],sa[N],height[N];\nvoid qsort(){\n    for(int i=0;i<=m;++i)tax[i]=0;\n    for(int i=1;i<=n;++i)++tax[rnk[i]];\n    for(int i=1;i<=m;++i)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=200;\n    for(int i=1;i<=n;++i)sa[i]=0,rnk[i]=s[i]-'A'+1,tp[i]=i;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        for(int i=1;i<=w;++i)tp[++p]=n-w+i;\n        for(int i=1;i<=n;++i)\n            if(sa[i]>w)tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        for(int i=2;i<=n;++i)\n            rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n}\nvoid solve(){\n    scanf(\"%s\",s+1),n=strlen(s+1);\n    suffix();\n    long long ans=n*(n+1)>>1;\n    for(int i=1,k=0;i<=n;++i){\n        if(k)--k;\n        int j=sa[rnk[i]-1];\n        while(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n        ans-=k;\n    }\n    printf(\"%lld\\n\",ans);\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--)solve();\n}\n```\n", "link": "/posts/LG SP694 DISUBSTR - Distinct Substrings/", "tags": ["\u540e\u7f00\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4051 [JSOI2007]\u5b57\u7b26\u52a0\u5bc6", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4051&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4051\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u770b\u5230\u73af\u5c31\u60f3\u5230\u628a\u539f\u4e32\u53d8\u6210\u4e24\u500d,\u800c\u8fd9\u5bf9\u88ab\u5ef6\u957f\u4e86\u7684\u539f\u4e32\u4e2d\u7684\u5b50\u4e32\u5728sa\u4e2d\u7684\u6392\u540d\u6ca1\u6709\u5f71\u54cd\n\n\u6bd4\u5982`baba`\u53d8\u6210`babadfasdfa`,\u8fd9\u5e76\u4e0d\u4f1a\u5f71\u54cd\u5230`baba`\u7684\u6392\u540d\n\n\u90a3\u4e48\u76f4\u63a5\u6c42\u51fa`sa`\u540e\u8f93\u51fa\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=200011;\nchar s[N];\nint n,m,sa[N],rnk[N],tax[N],tp[N];\nvoid qsort(){\n    for(int i=0;i<=m;++i)tax[i]=0;\n    for(int i=1;i<=n;++i)++tax[rnk[i]];\n    for(int i=1;i<=m;++i)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=300;\n    for(int i=1;i<=n;++i)sa[i]=0,rnk[i]=s[i],tp[i]=i;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        for(int i=1;i<=w;++i)tp[++p]=n-w+i;\n        for(int i=1;i<=n;++i)\n            if(sa[i]>w)tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        for(int i=2;i<=n;++i)\n            rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n}\nint main(){\n    scanf(\"%s\",s+1),n=strlen(s+1);\n    for(int i=1;i<=n;++i)s[i+n]=s[i];\n    n<<=1;\n    suffix();\n    for(int i=1;i<=n;++i)if(sa[i]<=(n>>1))\n        putchar(s[sa[i]+(n>>1)-1]);\n}\n```\n", "link": "/posts/LG 4051 [JSOI2007]\u5b57\u7b26\u52a0\u5bc6/", "tags": ["\u540e\u7f00\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5546 [POI2000]\u516c\u5171\u4e32", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5546&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5546\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fde\u63a5\u6240\u6709\u5b57\u7b26\u4e32($cnt$\u4e2a),\u4e2d\u95f4\u7528\u7279\u6b8a\u5b57\u7b26\u9694\u5f00\n\n\u7ed9\u6bcf\u4e2a\u4f4d\u7f6e\u6807\u8bb0\u6240\u5c5e\u5b57\u7b26\u4e32\n\n\u7136\u540e\u6c42\u51fa`sa`,`rnk`,`height`\u6570\u7ec4\n\n\u6211\u4eec\u8981\u627e\u51fa$cnt$\u4e2a\u6240\u5c5e\u5b57\u7b26\u4e32\u4e0d\u540c\u7684\u540e\u7f00,\u8ba9\u4ed6\u4eec$\\operatorname{LCP}$\u6700\u957f\n\n\u53ef\u4ee5\u7528\u53cc\u6307\u9488+\u5355\u8c03\u961f\u5217\u7684\u65b9\u5f0f\u5b9e\u73b0\n\n\u5355\u8c03\u961f\u5217\u8bb0\u5f55\u5f53\u524d\u533a\u95f4\u6700\u5c0f\u7684`height`,\u5355\u8c03\u9012\u589e,\u53cc\u6307\u9488\u79fb\u52a8\u53f3\u6307\u9488\u7684\u540c\u65f6\u7ef4\u62a4\u5355\u8c03\u961f\u5217,\u79fb\u52a8\u53f3\u6307\u9488\u540e\u5224\u65ad\u662f\u5426\u53ef\u4ee5\u79fb\u52a8\u5de6\u6307\u9488,\u5e76\u91cd\u590d\u5230\u65e0\u6cd5\u79fb\u52a8,\u540c\u65f6\u5bf9\u5e94\u5f39\u51fa\u5355\u8c03\u961f\u5217\u7684\u961f\u5934\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=10111;\nint cnt,n,m,sa[N],rnk[N],height[N],tax[N],tp[N];\nchar s[N];\nvoid qsort(){\n    for(int i=0;i<=m;++i)tax[i]=0;\n    for(int i=1;i<=n;++i)++tax[rnk[i]];\n    for(int i=1;i<=m;++i)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)\n        sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=100;\n    for(int i=1;i<=n;++i)tp[i]=i,rnk[i]=s[i]-'a'+1;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        for(int i=1;i<=w;++i)tp[++p]=n-w+i;\n        for(int i=1;i<=n;++i)if(sa[i]>w)\n            tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        for(int i=2;i<=n;++i)\n            rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n}\nvoid get_height(){\n    for(int i=1,k=0;i<=n;++i){\n        if(k)--k;\n        int j=sa[rnk[i]-1];\n        while(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n        height[rnk[i]]=k;\n    }\n}\nint col[N],L[N],R[N],v[N],tot,q[N],h=1,t;\nvoid add(int x){if(col[x])if(++v[col[x]]==1)++tot;}\nvoid del(int x){if(col[x])if(!--v[col[x]])--tot;}\nvoid cmax(int &x,int y){if(x<y)x=y;}\nint main(){\n    scanf(\"%d\",&cnt);\n    for(int i=1;i<=cnt;++i)\n        L[i]=n+1,\n        scanf(\"%s\",s+n+1),\n        s[n=strlen(s+1)+1]=i+'a'-1,\n        R[i]=n-1;\n    suffix();\n    get_height();\n    for(int i=1;i<=cnt;++i)\n        for(int j=L[i];j<=R[i];++j)\n            col[rnk[j]]=i;\n\tint l=1,ans=0;\n\tadd(1);\n\tfor(int r=2;r<=n;++r){\n\t\twhile(h<=t&&height[q[t]]>=height[r])--t;\n\t\tq[++t]=r;\n\t\tadd(r);\n\t\tif(tot==cnt){\n\t\t\twhile(tot==cnt&&l<r)del(l++);\n\t\t\tadd(--l);\n\t\t}\n\t\twhile(h<=t&&q[h]<=l)++h;\n\t\tif(tot==cnt)cmax(ans,height[q[h]]);\n\t}\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 5546 [POI2000]\u516c\u5171\u4e32/", "tags": ["\u540e\u7f00\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP687 REPEATS - Repeats", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP687&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP687\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u679a\u4e3e\u957f\u5ea6$L$,\u7136\u540e\u5224\u65ad\u957f\u5ea6\u4e3a$L$\u7684\u5b50\u4e32\u80fd\u8fde\u7eed\u51fa\u73b0\u51e0\u6b21(1\u6b21\u80af\u5b9a\u53ef\u4ee5,\u8fd9\u91cc\u5224\u65ad\u51fa\u73b02\u6b21\u4ee5\u4e0a\u7684)\n\n\u590d\u6742\u5ea6$\\Theta(\\frac n1+\\frac n2+\\cdots +\\frac nn)$\n\n\u5047\u8bbe\u73b0\u5728\u679a\u4e3e\u5230\u4f4d\u7f6e$j$\n\n\u627e\u5230$k=\\operatorname{LCP}(suf(j),suf(j+L))$,$\\left \\lfloor \\frac ki \\right \\rfloor +1$\u5c31\u662f\u4ece$j$\u5f00\u59cb\u5230$j$\u4e4b\u540e\u5faa\u73af\u7684\u6b21\u6570\n\n\u518d\u5224\u65ad\u4e00\u4e0b$j$\u4e4b\u524d\u662f\u5426\u6709\u518d\u51fa\u73b0\u8fc7,\u5c31\u53ef\u4ee5\u5f97\u51fa\u5f53\u524d\u7b54\u6848\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=50011;\nint n,m,sa[N],rnk[N],tax[N],tp[N],height[N];\nchar s[N];\nvoid qsort(){\n    for(int i=0;i<=m;++i)++tax[i]=0;\n    for(int i=1;i<=n;++i)++tax[rnk[i]];\n    for(int i=1;i<=m;++i)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nint f[17][N];\nint min(int x,int y){return x<y?x:y;}\nvoid st(){\n    for(int i=1;i<=n;++i)f[0][i]=height[i];\n    for(int k=1;k<=16;++k)\n        for(int i=1;i+(1<<k)-1<=n;++i)\n            f[k][i]=min(f[k-1][i],f[k-1][i+(1<<(k-1))]);\n}\nint ask(int l,int r){\n    if(l==r)return -1u>>1;\n    if(l>r)l^=r,r^=l,l^=r;++l;\n    int k=log2(r-l+1);\n    return min(f[k][l],f[k][r-(1<<k)+1]);\n}\nint get(){char c;while((c=getchar())<'a');return c-'a'+1;}\nvoid solve(){\n    scanf(\"%d\",&n);\n    m=3;\n    for(int i=1;i<=n;++i)sa[i]=0,rnk[i]=s[i]=get(),tp[i]=i;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        for(int i=1;i<=w;++i)tp[++p]=n-w+i;\n        for(int i=1;i<=n;++i)if(sa[i]>w)tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        for(int i=2;i<=n;++i)\n            rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n    for(int i=1,k=0;i<=n;++i){\n        if(k)--k;\n        int j=sa[rnk[i]-1];\n        while(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n        height[rnk[i]]=k;\n    }\n    st();\n    int ans=1;\n    for(int i=1;i<=n;++i)\n        for(int j=1;j+i<=n;j+=i){\n            int k=ask(rnk[j],rnk[j+i]),now=k/i+1,t=j-i+k%i;\n            if(ask(rnk[t],rnk[t+i])>k)++now;\n            if(now>ans)ans=now;            \n        }\n    printf(\"%d\\n\",ans);\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--)solve();\n}\n```\n", "link": "/posts/LG SP687 REPEATS - Repeats/", "tags": ["\u540e\u7f00\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3809 \u3010\u6a21\u677f\u3011\u540e\u7f00\u6392\u5e8f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3809&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3809\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nconst int N=1000001;\nchar s[N];\nint n,m,sa[N],rnk[N],tp[N],tax[N];\nvoid qsort(){\n    fur(i,0,m)tax[i]=0;\n    fur(i,1,n)++tax[rnk[i]];\n    fur(i,1,m)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)\n        sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=75;\n    fur(i,1,n)rnk[i]=s[i]-'0'+1,tp[i]=i;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        fur(i,1,w)tp[++p]=n-w+i;\n        fur(i,1,n)if(sa[i]>w)\n            tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        fur(i,2,n)\n            rnk[sa[i]]=p+=tp[sa[i-1]]^tp[sa[i]]||tp[sa[i-1]+w]^tp[sa[i]+w];\n    }\n}\n/* -------------------height--------------------- */\nint height[N];\nvoid get_height(){\n    for(int i=1,k=0;i<=n;++i){\n\t\tif(k)--k;\n\t\tint j=sa[rnk[i]-1];\n\t\twhile(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n\t\theight[rnk[i]]=k; \n\t}\n}\n/* ---------------------------------------------- */\nint main(){\n    scanf(\"%s\",s+1),n=strlen(s+1);\n    suffix();\n    fur(i,1,n)printf(\"%d \",sa[i]);\n}\n```\n", "link": "/posts/LG 3809 \u3010\u6a21\u677f\u3011\u540e\u7f00\u6392\u5e8f/", "tags": ["\u540e\u7f00\u6570\u7ec4", "\u6a21\u677f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2408 \u4e0d\u540c\u5b50\u4e32\u4e2a\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2408&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2408\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$\\frac {n(n+1)}2 - \\sum height[i]$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nchar s[N];\nint n,m,sa[N],rnk[N],tax[N],tp[N];\nvoid qsort(){\n    for(int i=0;i<=m;++i)tax[i]=0;\n    for(int i=1;i<=n;++i)++tax[rnk[i]];\n    for(int i=1;i<=m;++i)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=100;\n    for(int i=1;i<=n;++i)sa[i]=0,rnk[i]=s[i]-'a'+1,tp[i]=i;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        for(int i=1;i<=w;++i)tp[++p]=n-w+i;\n        for(int i=1;i<=n;++i)\n            if(sa[i]>w)tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        for(int i=2;i<=n;++i)\n            rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n}\nint main(){\n    scanf(\"%d%s\",&n,s+1);\n    suffix();\n    long long ans=1ll*n*(n+1)>>1;\n    for(int i=1,k=0;i<=n;++i){\n        if(k)--k;\n        int j=sa[rnk[i]-1];\n        while(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n        ans-=k;\n    }\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 2408 \u4e0d\u540c\u5b50\u4e32\u4e2a\u6570/", "tags": ["\u540e\u7f00\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2852 [USACO06DEC]Milk Patterns G", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2852&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2852\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u7528\u540e\u7f00\u6570\u7ec4\u6c42\u51faheight\u6570\u7ec4\n\n\u53ef\u4ee5\u53d1\u73b0,\u91cd\u590d\u51fa\u73b0\u7684\u5b50\u4e32\u5728sa\u6570\u7ec4\u4e2d\u4e00\u5b9a\u662f\u8fde\u7eed\u7684\n\n\u90a3\u4e48\u5728height\u4e2d\u4e5f\u662f\u8fde\u7eed\u7684\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u9700\u8981\u6c42\u51fa height\u6570\u7ec4\u4e2d \u8fde\u7eed$k-1$\u4e2a\u6570\u4e2d \u6700\u5c0f\u7684\u6570 \u6700\u5927\u53ef\u4ee5\u662f\u591a\u5c11 \u5373\u53ef\n\n\u5355\u8c03\u961f\u5217\u5c31\u53ef\u4ee5\u89e3\u51b3\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\nint rd(){int x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);return f?-x:x;}\nconst int N=1000011;\nint n,m,k,s[N],rnk[N],sa[N],tp[N],tax[N],height[N],q[N];\nvoid qsort(){\n    for(int i=0;i<=m;++i)tax[i]=0;\n    for(int i=1;i<=n;++i)++tax[rnk[i]];\n    for(int i=1;i<=m;++i)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nint main(){\n    n=rd(),k=rd();\n    for(int i=1;i<=n;++i)rnk[i]=s[i]=rd(),tp[i]=i;\n    m=1000000;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        for(int i=1;i<=w;++i)tp[++p]=n-w+i;\n        for(int i=1;i<=n;++i)if(sa[i]>w)tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        for(int i=2;i<=n;++i)\n            rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n    for(int i=1,k=0;i<=n;++i){\n        if(k)--k;\n        int j=sa[rnk[i]-1];\n        while(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n        height[rnk[i]]=k;\n    }\n    int h=1,t=0,ans=0;\n    for(int i=2;i<=n;++i){\n        while(h<=t&&height[q[t]]>=height[i])--t;\n        q[++t]=i;\n        if(i<k)continue;\n        while(i-q[h]+1>=k)++h;\n        if(ans<height[q[h]])ans=height[q[h]];\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 2852 [USACO06DEC]Milk Patterns G/", "tags": ["\u540e\u7f00\u6570\u7ec4", "\u5355\u8c03\u961f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP10570 LONGCS - Longest Common Substring", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP10570&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP10570\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000111;\nint cnt,n,m,sa[N],rnk[N],height[N],tax[N],tp[N];\nchar s[N];\nvoid qsort(){\n    for(int i=0;i<=m;++i)tax[i]=0;\n    for(int i=1;i<=n;++i)++tax[rnk[i]];\n    for(int i=1;i<=m;++i)tax[i]+=tax[i-1];\n    for(int i=n;i;--i)\n        sa[tax[rnk[tp[i]]]--]=tp[i];\n}\nvoid suffix(){\n    m=200;\n    for(int i=1;i<=n;++i)sa[i]=0,rnk[i]=(s[i]<='a')?s[i]:(s[i]-'a'+1),tp[i]=i;\n    qsort();\n    for(int w=1,p=0;p<n;m=p,w<<=1){\n        p=0;\n        for(int i=1;i<=w;++i)tp[++p]=n-w+i;\n        for(int i=1;i<=n;++i)\n            if(sa[i]>w)tp[++p]=sa[i]-w;\n        qsort();\n        std::swap(tp,rnk);\n        rnk[sa[1]]=p=1;\n        for(int i=2;i<=n;++i)\n            rnk[sa[i]]=p+=tp[sa[i]]^tp[sa[i-1]]||tp[sa[i]+w]^tp[sa[i-1]+w];\n    }\n}\nvoid get_height(){\n    for(int i=1,k=0;i<=n;++i){\n        if(k)--k;\n        int j=sa[rnk[i]-1];\n        while(s[i+k]==s[j+k]&&i+k<=n&&j+k<=n)++k;\n        height[rnk[i]]=k;\n    }\n}\nint col[N],L[N],R[N],v[N],tot,q[N];\nvoid add(int x){if(col[x])if(++v[col[x]]==1)++tot;}\nvoid del(int x){if(col[x])if(!--v[col[x]])--tot;}\nvoid cmax(int &x,int y){if(x<y)x=y;}\nint main(){\n    int T;scanf(\"%d\",&T);\nwhile(T--){\n    n=tot=0;memset(height,0,sizeof height);\n    memset(col,0,sizeof col);\n    memset(v,0,sizeof v);\n    memset(q,0,sizeof q);\n    scanf(\"%d\",&cnt);\n    for(int i=1;i<=cnt;++i)\n        L[i]=n+1,\n        scanf(\"%s\",s+n+1),\n        s[n=strlen(s+1)+1]=i,\n        R[i]=n-1;\n    suffix();\n    get_height();\n    for(int i=1;i<=cnt;++i)\n        for(int j=L[i];j<=R[i];++j)\n            col[rnk[j]]=i;\n\tint l=1,ans=0,h=1,t;\n    tot=0;\n\tadd(1);\n\tfor(int r=2;r<=n;++r){\n\t\twhile(h<=t&&height[q[t]]>=height[r])--t;\n\t\tq[++t]=r;\n\t\tadd(r);\n\t\tif(tot==cnt){\n\t\t\twhile(tot==cnt&&l<r)del(l++);\n\t\t\tadd(--l);\n\t\t}\n\t\twhile(h<=t&&q[h]<=l)++h;\n\t\tif(tot==cnt)cmax(ans,height[q[h]]);\n\t}\n    printf(\"%d\\n\",ans);\n}\n}\n```\n", "link": "/posts/LG SP10570 LONGCS - Longest Common Substring/", "tags": ["\u540e\u7f00\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2414 [NOI2011]\u963f\u72f8\u7684\u6253\u5b57\u673a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2414&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2414\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u6839\u636e\u8f93\u5165\u7684\u5b57\u7b26\u4e32\u6784\u9020trie\n\n\u7136\u540e\u6784\u5efaAC\u81ea\u52a8\u673a\n\n\u5229\u7528\u4e86fail\u6811\u7684\u4e00\u4e2a\u6027\u8d28:\n\n\u82e5$y$\u8282\u70b9\u7684fail\u6307\u9488\u6307\u5411$x$\u8282\u70b9,\u90a3\u4e48 \u6839\u5230$x$\u5f62\u6210\u7684\u5b57\u7b26\u4e32 \u4e00\u5b9a\u5728 \u6839\u5230$y$\u5f62\u6210\u7684\u5b57\u7b26\u4e32 \u4e2d\u51fa\u73b0\u8fc7\n\n\u90a3\u4e48\u6211\u4eec\u5bf9\u4e8e\u6bcf\u4e2a\u8be2\u95ee`x y`,\u53ea\u9700\u8981\u627e\u51fa\u6839\u5230$y$\u4e0a\u7684\u8282\u70b9\u6709\u591a\u5c11\u4e2afail\u6307\u9488\u76f4\u63a5\u6216\u95f4\u63a5\u6307\u5411$x$\u7684,\u5c31\u662f\u7b54\u6848\n\n\u6784\u5efafail\u6811\u4e4b\u540e\u4f7f\u7528dfs\u5e8f+\u6811\u72b6\u6570\u7ec4\u7edf\u8ba1\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid cmin(int &x,int y){if(x>y)x=y;}void cmax(int &x,int y){if(x<y)x=y;}\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=100011;\nusing std::list,std::pair;\nchar ch[N];\nint n,m,sz,tot,cnt,c[N][26],fa[N],fail[N],p[N],q[N],head[N],ans[N];\nlist<int>e[N];\nlist<pair<int,int>>que[N];\nint L[N],R[N],dfn,s[N];\nvoid dfs(int x){\n    L[x]=++dfn;\n    for(int to:e[x])dfs(to);\n    R[x]=dfn;\n}\nvoid add(int x,int v){for(;x<=sz;x+=x&-x)s[x]+=v;}\nint ask(int x){int res=0;for(;x;x-=x&-x)res+=s[x];return res;}\nint main(){\n    scanf(\"%s\",ch),n=strlen(ch);\n    int x=1,y,h=0,t=1;\n    sz=1;fur(i,0,25)c[0][i]=1;\n    fur(i,0,n-1)\n        if(ch[i]=='P')p[++tot]=x;\n        else if(ch[i]=='B')x=fa[x];\n        else{\n            if(!c[x][ch[i]-'a'])fa[c[x][ch[i]-'a']=++sz]=x;\n            x=c[x][ch[i]-'a'];\n        }\n    q[0]=1,fail[1]=0;\n    while(h<t){\n        x=q[h++];\n        fur(i,0,25)\n            if(c[x][i])fail[c[x][i]]=c[fail[x]][i],q[t++]=c[x][i];\n            else c[x][i]=c[fail[x]][i];\n    }\n    fur(i,1,sz)e[fail[i]].push_back(i);\n    in(m);\n    fur(i,1,m)in(x),in(y),que[y].push_back(std::make_pair(i,x));\n    dfs(1);\n    x=1,tot=0;\n    fur(i,0,n-1)\n        if(ch[i]=='P'){\n            ++tot;for(auto x:que[tot])\n                ans[x.first]=ask(R[p[x.second]])-ask(L[p[x.second]]-1);\n        }\n        else if(ch[i]=='B')add(L[x],-1),x=fa[x];\n        else x=c[x][ch[i]-'a'],add(L[x],1);\n    fur(i,1,m)printf(\"%d\\n\",ans[i]);\n}\n```\n", "link": "/posts/LG 2414 [NOI2011]\u963f\u72f8\u7684\u6253\u5b57\u673a/", "tags": ["AC\u81ea\u52a8\u673a"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1310B Double Elimination", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1310B&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1310B\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f(i,j,0/1,0/1)$\u8868\u793a\u7b2c$i$\u8f6e\u7684\u7b2c$j$\u573a,\u4f60\u662f\u5426\u662f\u80dc\u5229\u8005\u7684\u7c89\u4e1d,\u662f\u5426\u662f\u5931\u8d25\u8005\u7684\u7c89\u4e1d\n\n\u53ef\u4ee5\u53d1\u73b0\u8f6e\u6570\u6709\u70b9\u50cf\u5806,\u5982\u679c\u8f6e\u6570\u4ece$0$\u5f00\u59cb\u7f16\u53f7,\u7b2c$i$\u8f6e\u7684\u7b2c$j$\u573a\u7531\u7b2c$i-1$\u8f6e\u7684\u7b2c$2j$\u573a\u3001\u7b2c$i-1$\u8f6e\u7684\u7b2c$2j+1$\u573a\u8f6c\u79fb\u800c\u6765\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nint n,k,f[18][2][2][1<<18];\nbool w[1<<17|1];\nvoid cmax(int &x,int y){if(y>x)x=y;}\nint main(){\n    in(n),in(k);\n    int x;\n    fur(i,1,k)in(x),w[x-1]=1;\n    memset(f,-0x3f,sizeof f);\n    fur(i,0,(1<<n-1)-1)\n        f[1][w[i<<1]][w[i<<1|1]][i]=f[1][w[i<<1|1]][w[i<<1]][i]=w[i<<1]|w[i<<1|1];\n    fur(i,2,n)\n        fur(j,0,(1<<n-i)-1)\n            fur(wl,0,1)fur(ll,0,1)fur(wr,0,1)fur(lr,0,1){\n                int t=f[i-1][wl][ll][j<<1]+f[i-1][wr][lr][j<<1|1];\n                cmax(f[i][wl|wr][ll|lr][j],t+((ll|lr)<<1)+(wl|wr));\n                if(wl|wr)cmax(f[i][wl+wr-1][1][j],t+(ll|lr)+(wl|wr)+1);\n            }\n    x=0;\n    fur(wl,0,1)fur(ll,0,1)cmax(x,f[n][wl][ll][0]+(wl|ll));\n    printf(\"%d\\n\",x);\n}\n```\n", "link": "/posts/LG CF1310B Double Elimination/", "tags": ["\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF954I Yet Another String Matching Problem", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF954I&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF954I\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u679a\u4e3e\u53d8\u6362\u60c5\u51b5($6!$),\u7136\u540e`kmp`$\\Theta(n)$\u5224\u65ad\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=125011,inf=2122219134;\nchar s1[N],s2[N];\nint n,m,a[N],b[N],nxt[N],p[6],now,ans[N];\nvoid kmp(){\n    for(int i=1,k=0;i<m;++i){\n        while(k&&b[i]^b[k])k=nxt[k-1];\n        if(b[i]==b[k])++k;\n        nxt[i]=k;\n    }\n    for(int i=0,k=0;i<n;++i){\n        while(k&&a[i]^b[k])k=nxt[k-1];\n        if(a[i]==b[k])++k;\n        if(k==m){\n            if(now<ans[i])ans[i]=now;\n            k=nxt[k-1];\n        }\n    }\n}\nint main(){\n    scanf(\"%s%s\",s1,s2);\n    n=strlen(s1),m=strlen(s2);\n    for(int i=m-1;i<n;++i)ans[i]=-1u>>1;\n    p[5]=5;\n    for(p[0]=0;p[0]<6;++p[0])\n    for(p[1]=1;p[1]<6;++p[1])\n    for(p[2]=2;p[2]<6;++p[2])\n    for(p[3]=3;p[3]<6;++p[3])\n    for(p[4]=4;p[4]<6;++p[4]){\n        for(int i=0;i<n;++i)a[i]=p[s1[i]-'a'];\n        for(int i=0;i<m;++i)b[i]=p[s2[i]-'a'];\n        now=(p[0]>0)+(p[1]>1)+(p[2]>2)+(p[3]>3)+(p[4]>4);\n        kmp();\n    }\n    for(int i=m-1;i<n;++i)printf(\"%d \",ans[i]);\n}\n```\n", "link": "/posts/LG CF954I Yet Another String Matching Problem/", "tags": ["kmp", "\u5b57\u7b26\u4e32"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5663 \u52a0\u5de5\u96f6\u4ef6", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5663&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5663\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5bb9\u6613\u53d1\u73b0,\u53ea\u8981\u8fd9\u4e2a\u70b9\u4e0e$1$\u4e4b\u95f4\u5b58\u5728\u67d0\u6761\u8def\u5f84\u957f\u5ea6($\\le$\u9636\u6bb5\u6570)+\u9636\u6bb5\u6570\u4e3a\u5076\u6570\u7684,\u90a3$1$\u5c31\u5f97\u63d0\u4f9b\u539f\u6750\u6599\n\n\u6211\u4eec\u5206\u522b\u6c42\u51fa\u957f\u5ea6\u4e3a\u5947\u6570\u3001\u5076\u6570\u7684\u6700\u77ed\u8def\u957f\u5ea6\u5373\u53ef\u5224\u65ad\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=100011;\nint n,cnt,head[N],q[N<<1],d[2][N];\nbool p[N<<1];\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid bfs(){\n    int h=0,t=1,x;bool v;\n    q[0]=1,p[0]=0,d[0][1]=2;\n    while(h<t){\n        x=q[h],v=p[h++];\n        for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n            if(!d[!v][to])\n                d[!v][to]=d[v][x]+1,\n                q[t]=to,p[t++]=!v;\n    }\n}\nint main(){\n    int m,q,x,y;\n    in(n),in(m),in(q);\n    while(m--)in(x),in(y),add(x,y),add(y,x);\n    bfs();\n    while(q--)\n        in(x),in(y),\n        puts((!d[y&1][x]||d[y&1][x]>y+2)?\"No\":\"Yes\");\n}\n```\n", "link": "/posts/LG 5663 \u52a0\u5de5\u96f6\u4ef6/", "tags": ["bfs", "\u6700\u77ed\u8def"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1299C Water Balance", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1299C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1299C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u53d1\u73b0\u5982\u679c\u8981\u5b57\u5178\u5e8f\u6700\u5c0f,\u90a3\u4e48\u5c31\u9700\u8981\u8ba9\u9760\u524d\u7684\u6570\u5b57\u53d8\u5c0f\n\n\u90a3\u4e48\u6700\u7ec8\u5f62\u6210\u7684\u5e73\u5747\u6570\u662f\u9012\u589e\u7684\n\n\u53ef\u4ee5\u7528\u5355\u8c03\u6808\u7ef4\u62a4\u5e73\u5747\u6570\u9012\u589e\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\n#define fdr(i,x,y) for(int i=x;i>=y;--i)\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=1000011;\nint n,a[N],t[N],tp,tot;\nlong long s[N],sum;\nint main(){\n    in(n);\n    fur(i,1,n)in(a[i]);\n    s[tp=1]=a[n],t[1]=1;\n    fdr(i,n-1,1){\n        tot=1,sum=a[i];\n        while(tp&&sum*t[tp]>=tot*s[tp])\n            sum+=s[tp],tot+=t[tp],--tp;\n        s[++tp]=sum,t[tp]=tot;\n    }\n    fdr(i,tp,1){\n        double k=1.0*s[i]/(double)t[i];\n        fur(j,1,t[i])printf(\"%.9f\\n\",k);\n    }\n}\n```\n", "link": "/posts/LG CF1299C Water Balance/", "tags": ["\u540e\u7f00\u548c", "\u5b57\u5178\u5e8f", "\u5355\u8c03\u6808"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1305D Kuroni and the Celebration", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1305D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1305D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4ea4\u4e92\u9898\n\n\u6211\u4eec\u4ece\u53f6\u5b50\u8282\u70b9\u5f00\u59cb\u641c\u7d22,\u628a\u6240\u6709\u53f6\u5b50\u8282\u70b9\u6dfb\u52a0\u5230\u961f\u5217\u4e2d\n\n\u6bcf\u6b21\u4ece\u961f\u5217\u4e2d\u5f39\u51fa\u4e24\u4e2a\u53f6\u5b50\u8282\u70b9,\n\n\u5982\u679c`lca`\u4e3a\u5176\u4e2d\u4e00\u4e2a,\u90a3\u4e48\u8fd9\u4e2a`lca`\u5c31\u662f\u6811\u6839\n\n\u5426\u5219\u5220\u9664\u8fd9\u4e24\u4e2a\u8282\u70b9,\u53ef\u80fd\u4f1a\u5f62\u6210\u65b0\u7684\u53f6\u5b50\u8282\u70b9,\u52a0\u5165\u961f\u5217\n\n\u56e0\u4e3a\u6700\u574f\u60c5\u51b5\u4e0b\u6bcf\u6b21\u90fd\u4f1a\u5220\u6389\u4e24\u4e2a\u8282\u70b9,\u90a3\u4e48\u91cd\u590d$\\frac n2$\u6b21\u540e,\u4e5f\u5c31\u53ea\u5269\u4e0b\u6839\u8282\u70b9\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid cmin(int &x,int y){if(x>y)x=y;}void cmax(int &x,int y){if(x<y)x=y;}\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=100011,inf=2122219134;\nusing std::list;\nint n,d[N],q[N],h,t;\nlist<int>e[N];\nbool v[N];\nint main(){\n    in(n);\n    int x,y,z;\n    fur(i,2,n)\n        in(x),in(y),\n        e[x].push_back(y),\n        e[y].push_back(x),\n        ++d[x],++d[y];\n    fur(i,1,n)if(d[i]==1)q[t++]=i;\n    fur(i,1,n>>1){\n        x=q[h++],y=q[h++];\n        printf(\"? %d %d\\n\",x,y),fflush(stdout);\n        in(z);\n        if(z==x||z==y)return printf(\"! %d\\n\",z),0;\n        for(int z:e[x])\n            if(!v[z]&&--d[z]==1)q[t++]=z;\n        for(int z:e[y])\n            if(!v[z]&&--d[z]==1)q[t++]=z;\n        v[x]=v[y]=1;\n    }\n    fur(i,1,n)if(!v[i])printf(\"! %d\\n\",i);\n}\n```\n", "link": "/posts/LG CF1305D Kuroni and the Celebration/", "tags": ["\u4ea4\u4e92", "lca", "\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1304E 1-Trees and Queries", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1304E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1304E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u53d1\u73b0\u6709\u4e09\u79cd\u8def\u5f84:\n\n1. $a \\leftrightarrow b$\n   \n2. $a \\leftrightarrow x \\leftrightarrow y \\leftrightarrow b$\n\n3. $a \\leftrightarrow y \\leftrightarrow x \\leftrightarrow b$\n\n\u53ea\u9700\u8981\u5224\u65ad\u8fd9\u4e09\u6761\u8def\u5f84\u662f\u5426\u6ee1\u8db3\u5c31\u53ef\u4ee5\u4e86\n\n\u53ef\u4ee5\u53d1\u73b0\u53ea\u8981$dis\\le k$\u800c\u4e14\u548c$k$\u540c\u5947\u5076\u5c31\u662f\u7b26\u5408\u7684\n\n(\u6bd4\u5982$x\\leftrightarrow y$\u53ef\u4ee5\u4e00\u76f4\u5faa\u73af,\u53d8\u6210$x\\leftrightarrow y \\leftrightarrow x \\leftrightarrow y \\dots$,\u6bcf\u6b21\u957f\u5ea6$+2$)\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=100011;\nint n,k,cnt,head[N],d[N],f[N],siz[N],top[N];\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint lca(int x,int y){\n    while(top[x]!=top[y])(d[top[x]]>d[top[y]])?(x=f[top[x]]):(y=f[top[y]]);\n    return d[x]<d[y]?x:y;\n}\nint dis(int x,int y){return d[x]+d[y]-2*d[lca(x,y)];}\nbool chk(int x){return x<=k&&(x&1)==(k&1);}\nint main(){\n    in(n);\n    int x,y,a,b,q;\n    fur(i,2,n)in(x),in(y),add(x,y),add(y,x);\n    dfs(1),bt(1,1);\n    in(q);\n    while(q--){\n        in(x),in(y),in(a),in(b),in(k);\n        if(chk(dis(a,b))||chk(dis(a,x)+1+dis(y,b))||chk(dis(a,y)+1+dis(x,b)))puts(\"YES\");\n        else puts(\"NO\");\n    }\n}\n```\n", "link": "/posts/LG CF1304E 1-Trees and Queries/", "tags": ["\u6811", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1311D Three Integers", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1311D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1311D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u66b4\u529b\u679a\u4e3e\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nint abs(int x){return x<0?-x:x;}\nvoid solve(){\n    int a,b,c,ans=1<<30,lim,res,A,B,C;\n    scanf(\"%d%d%d\",&a,&b,&c);lim=c<<1;\n    for(int i=1;i<=lim;++i)\n        for(int j=i;j<=lim;j+=i)\n            for(int k=j;k<=lim;k+=j){\n                res=abs(a-i)+abs(b-j)+abs(c-k);\n                if(res<ans)ans=res,A=i,B=j,C=k;\n            }\n    printf(\"%d\\n%d %d %d\\n\",ans,A,B,C);\n}\nint main(){\n    int t;scanf(\"%d\",&t);\n    while(t--)solve();\n}\n```\n", "link": "/posts/LG CF1311D Three Integers/", "tags": ["\u66b4\u529b", "\u679a\u4e3e"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1320D Reachable Strings", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1320D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1320D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u53d1\u73b0$110\\leftrightarrow 011$\u76f8\u5f53\u4e8e$0$\u524d/\u540e\u79fb\u52a8\u4e862\u683c,\u90a3\u4e48\u6bcf\u4e2a$0$\u4f4d\u7f6e\u7684\u5947\u5076\u6027\u662f\u4e0d\u53d8\u7684\n\n\u800c\u4e14\u6bcf\u4e2a$0$\u65e0\u6cd5\u79fb\u52a8\u5230\u4e0b\u4e00\u4e2a$0$\u7684\u540e\u9762\n\n\u628a\u8fd9\u4e9b$0$\u8bb0\u5f55\u5230\u4e00\u4e2a\u5e8f\u5217\u91cc,\u7136\u540e\u901a\u8fc7\u54c8\u5e0c\u5224\u65ad\u4e24\u4e2a\u5b50\u4e32\u5728\u5e8f\u5217\u4e2d\u5bf9\u5e94\u7684\u90e8\u5206\u662f\u5426\u76f8\u540c\n\n\u56e0\u4e3a\u5b50\u5e8f\u5217\u7684\u8d77\u70b9\u5947\u5076\u6027\u4e0d\u540c,\u5206\u522b\u8868\u793a\u4ee5\u8d77\u70b9\u4e3a\u5947\u6570\u548c\u5076\u6570\u4e3a\u6807\u51c6\u65f6\u54c8\u5e0c\u5f97\u7684\u524d\u7f00$0$\u5e8f\u5217\u6570\u7ec4\u3002\n<!-- more -->\n\n```cpp\n#include<cstdio>\nconst int N=200011,P=998244353;\nint n,q,s[N],b[N],h[N],H[N];\nchar a[N];\nint get(int l,int r){\n    int*g=(l&1)?h:H;\n    return (g[r]-1ll*g[l-1]*b[s[r]-s[l-1]]%P+P)%P;\n}\nint main(){\n    scanf(\"%d%s%d\",&n,a+1,&q);\n    b[0]=1;\n    for(int i=1;i<=n;++i){\n        b[i]=23ll*b[i-1]%P;\n        s[i]=s[i-1]+(a[i]==48);\n        if(a[i]==48)\n            h[i]=(23ll*h[i-1]+1+(i&1))%P,\n            H[i]=(23ll*H[i-1]+1+(i&1^1))%P;\n        else h[i]=h[i-1],H[i]=H[i-1];\n    }\n    while(q--){\n        int x,y,w;\n        scanf(\"%d%d%d\",&x,&y,&w);\n        printf(get(x,x+w-1)==get(y,y+w-1)?\"Yes\\n\":\"No\\n\");\n    }\n}\n```\n", "link": "/posts/LG CF1320D Reachable Strings/", "tags": ["hash"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2183 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u793c\u7269", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2183&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2183\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$\nans={n\\choose w_1}\\cdot {n-w_1\\choose w_2}\\cdot {n-w_1-w_2\\choose w_3}\\cdots {n-w_1-w_2-\\dots -w_{m-1}\\choose w_m}\n$$\n\n\u5957\u6269\u5c55\u5362\u5361\u65af\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=100011;\nint P,lim,w[N],pi[N],pk[N],cnt;\nint pw(int x,int b,int p){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%p;\n        b>>=1,x=1ll*x*x%p;\n    }\n    return res;\n}\nvoid exgcd(int a,int b,int&x,int&y){\n    if(!b){x=1,y=0;return;}\n    exgcd(b,a%b,y,x);\n    y-=a/b*x;\n}\nint inv(int v,int p){\n    int x,y;\n    exgcd(v,p,x,y);\n    return (x+=p)>p?x-p:x;\n}\nint crt(int v,int p){return 1ll*v*inv(P/p,p)%P*(P/p)%P;}\nint fac(int n,int pi,int pk){\n    if(!n)return 1;\n    int res=1;\n    fur(i,2,pk)\n        if(i%pi)res=1ll*res*i%pk;\n    res=pw(res,n/pk,pk);\n    fur(i,2,n%pk)\n        if(i%pi)res=1ll*res*i%pk;\n    return 1ll*res*fac(n/pi,pi,pk)%pk;\n}\nint C(int n,int m,int pi,int pk){\n    if(m>n)return 0;\n    int cnt=0;\n    for(int i=n;i;i/=pi)cnt+=i/pi;\n    for(int i=m;i;i/=pi)cnt-=i/pi;\n    for(int i=n-m;i;i/=pi)cnt-=i/pi;\n    return 1ll*pw(pi,cnt,pk)*fac(n,pi,pk)%P\n              *inv(fac(m,pi,pk),pk)%P*inv(fac(n-m,pi,pk),pk)%P;\n}\nint main(){\n    int n,m,sum=0,t,ans=1,res;\n    in(P),in(n),in(m),lim=sqrt(P);\n    fur(i,1,m)in(w[i]),sum+=w[i];\n    if(sum>n)return printf(\"Impossible\"),0;\n    t=P;\n    fur(i,2,lim)if(t%i==0){\n        pi[++cnt]=i;pk[cnt]=1;\n        while(t%i==0)pk[cnt]*=i,t/=i;\n    }\n    if(t>1)pi[++cnt]=t,pk[cnt]=t;\n    fur(i,1,m){\n        res=0;\n        fur(j,1,cnt)res=(res+crt(C(n,w[i],pi[j],pk[j]),pk[j]))%P;\n        ans=1ll*ans*res%P;\n        n-=w[i];\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 2183 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u793c\u7269/", "tags": ["exlucas", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4720 \u3010\u6a21\u677f\u3011\u6269\u5c55\u5362\u5361\u65af", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4720&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4720\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$p=p_1^{k_1}p_2^{k_2}\\dots p_n^{k_n}$\n\n\u6c42\u51fa\u6bcf\u4e2a${n\\choose m} \\equiv a_i \\pmod {p_i^{k_i}}$\n\n\n\u5f97\u5230\u540c\u4f59\u65b9\u7a0b\u7ec4\n\n$$\n\\begin{cases}\n{n\\choose m} \\equiv a_1 \\pmod {p_1^{k_1}}\n\\\\\n{n\\choose m} \\equiv a_2 \\pmod {p_2^{k_2}}\n\\\\\n\\vdots\n\\\\\n{n\\choose m} \\equiv a_n \\pmod {p_n^{k_n}}\n\\end{cases}\n$$\n\n\u4f7f\u7528`crt`\u5373\u53ef\u6c42\u51fa$n\\choose m$\u7684\u503c\n\n$p^t$\u4e0d\u662f\u8d28\u6570,\u90a3\u4e48\u5982\u4f55\u6c42${n\\choose m} \\mod p^t$\u5462?\n\n\u53ef\u4ee5\u8ba1\u7b97${n\\choose m}=\\frac{n!}{m!(n-m)!}$,\u5206\u522b\u8ba1\u7b97\u51fa$n!,m!,(n-m)!$\u5728\u6a21$p^t$\u610f\u4e49\u4e0b\u7684\u503c\n\n\u5047\u8bbe$p=3,t=2,n=19$,\n\n$$\nn!=1\\cdot 2\\cdot 3\\cdots 19\n\\\\\n=(1\\cdot 2\\cdot 4\\cdot 5\\cdot 7\\cdot 8\\cdot 10\\cdot 11\\cdot 13\\cdot 14\\cdot 16\\cdot 17\\cdot 19)\\cdot (3\\cdot 6\\cdot 9\\cdot 12\\cdot 15\\cdot 18)\n\\\\ \n=(1\\cdot 2\\cdot 4\\cdot 5\\cdot 7\\cdot 8\\cdot 10\\cdot 11\\cdot 13\\cdot 14\\cdot 16\\cdot 17\\cdot 19)\\cdot 3^6\\cdot(1\\cdot2\\cdot3\\cdot4\\cdot5\\cdot6)\n$$\n\n\u53ef\u4ee5\u53d1\u73b0\u540e\u9762\u7684\u90e8\u5206\u76f8\u5f53\u4e8e$\\left\\lfloor \\frac np \\right\\rfloor!$,\u9012\u5f52\u8ba1\u7b97\u5373\u53ef\n\n\u524d\u534a\u90e8\u5206\u4ee5$p^t$\u4e3a\u5468\u671f,\u5373\n\n$1\\cdot 2\\cdot 4\\cdot 5\\cdot 7\\cdot 8 \\equiv 10\\cdot 11\\cdot 13\\cdot 14\\cdot 16\\cdot 17 \\pmod {3^2}$\n\n\u53ea\u9700\u8981\u8ba1\u7b97\u4e0d\u6ee1\u8db3\u5468\u671f\u7684\u6570$19$\u5c31\u53ef\u4ee5\u4e86\n\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nint lim;\nll P;\nll pw(ll x,ll b,ll p){\n    ll res=1;\n    while(b){\n        if(b&1)res=res*x%p;\n        b>>=1,x=x*x%p;\n    }\n    return res;\n}\nvoid exgcd(ll a,ll b,ll &x,ll &y){\n    if(!b){x=1,y=0;return;}\n    exgcd(b,a%b,x,y);\n    ll t=x;x=y,y=t-a/b*y;\n}\nll inv(ll v,ll p){\n    ll x,y;\n    exgcd(v,p,x,y);\n    return (x+=p)>p?x-p:x;\n}\nll crt(ll v,ll p){return v*inv(P/p,p)%P*(P/p)%P;}\nll fac(ll n,ll p,ll pk){\n    if(!n)return 1;\n    ll res=1;\n    for(int i=2;i<=pk;++i)\n        if(i%p)res=res*i%pk;\n    res=pw(res,n/pk,pk);\n    for(int i=2;i<=n%pk;++i)\n        if(i%p)res=res*i%pk;\n    return res*fac(n/p,p,pk)%pk;\n}\nll C(ll n,ll m,ll p,ll pk){\n    ll cnt=0;\n    for(ll i=n;i;i/=p)cnt+=i/p;\n    for(ll i=m;i;i/=p)cnt-=i/p;\n    for(ll i=n-m;i;i/=p)cnt-=i/p;\n    return pw(p,cnt,pk)*fac(n,p,pk)%pk*inv(fac(m,p,pk),pk)%pk*inv(fac(n-m,p,pk),pk)%pk;\n}\nll exlucas(ll n,ll m){\n    ll res=0,t=P,pk;\n    for(int i=2;i<=lim;++i)\n    if(t%i==0){\n        pk=1;while(t%i==0)pk*=i,t/=i;\n        res=(res+crt(C(n,m,i,pk),pk))%P;\n    }\n    if(t>1)res=(res+crt(C(n,m,t,t),t))%P;\n    return res;\n}\nint main(){\n    ll n,m;\n    scanf(\"%lld%lld%lld\",&n,&m,&P);lim=sqrt(P)+1;\n    printf(\"%lld\\n\",exlucas(n,m));\n}\n```\n", "link": "/posts/LG 4720 \u3010\u6a21\u677f\u3011\u6269\u5c55\u5362\u5361\u65af/", "tags": ["\u6570\u8bba", "\u6a21\u677f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1326E Bombs", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1326E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1326E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u53d1\u73b0\u7b54\u6848\u662f\u9012\u51cf\u7684\n\n\u6bcf\u4e2a$q_i$\u76f8\u5f53\u4e8e\u7834\u574f\u6389$[1,q_i]$\u7684\u6700\u5927\u503c\n\n\u90a3\u4e48\u6211\u4eec\u628a$[1,q_i]$\u533a\u95f4$-1$\n\n\u5c06\u6700\u5927\u503c\u53d8\u4e3a$p_k$\u7684\u65f6\u5019,\u76f8\u5f53\u4e8e$[1,k]$\u7684\u6700\u5927\u503c\u90fd\u53d8\u6210\u4e86$p_k$\n\n\u90a3\u4e48\u628a$[1,k]$\u533a\u95f4$+1$\n\n\u6bcf\u6b21\u8be2\u95ee\u7684\u65f6\u5019,\u4e00\u76f4\u5c06\u5f53\u524d\u6700\u5927\u503c$-1$,\u5e94\u7528\u53d8\u5316,\u76f4\u5230\u533a\u95f4\u6700\u5927\u503c\u5927\u4e8e$0$,\u8f93\u51fa\u7b54\u6848\n\n\u5177\u4f53\u770b\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nint max(int x,int y){return x>y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=300011;\n#define ls rt<<1\n#define rs rt<<1|1\nint n,a[N],p[N],s[N<<2],laz[N<<2];\nvoid pd(int rt){\n    if(laz[rt]){\n        laz[ls]+=laz[rt];\n        laz[rs]+=laz[rt];\n        s[ls]+=laz[rt];\n        s[rs]+=laz[rt];\n        laz[rt]=0;\n    }\n}\nvoid upd(int L,int R,int v,int l=1,int r=n,int rt=1){\n    if(L<=l&&r<=R){s[rt]+=v,laz[rt]+=v;return;}\n    int m=l+r>>1;pd(rt);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    s[rt]=max(s[ls],s[rs]);\n}\nint main(){\n    in(n);\n    fur(i,1,n)in(a[i]),p[a[i]]=i;\n    upd(1,p[n],1);\n    int x,res=n;out(n,\" \");\n    fur(i,1,n-1){\n        in(x);\n        upd(1,x,-1);\n        while(s[1]<=0)upd(1,p[--res],1);\n        out(res,\" \");\n    }in(x);\n    flush();\n}\n```\n", "link": "/posts/LG CF1326E Bombs/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1327D inftyite Path", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1327D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1327D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u628a\u8fde\u63a5\u6240\u6709$i\\rightarrow p_i$,\u53ef\u4ee5\u5f97\u5230\u82e5\u5e72\u4e2a\u73af\n\n\u6bcf$k$\u6b21$p_i=p_{p_i}$\u540e\u4f1a\u8ba9$i$\u6307\u5411\u73af\u4e0a\u4ece$i$\u6570\u8d77\u7684$k+1$\u4e2a\u70b9\n\n\u53ea\u9700\u8981\u8ba9\u4e00\u4e2a\u73af\u6ee1\u8db3\u6761\u4ef6\u65e2\u53ef\u4ee5,\u6211\u4eec\u53ef\u4ee5\u5bf9\u6bcf\u4e2a\u73af\u5206\u522b\u5904\u7406,\u7136\u540e\u7b54\u6848\u53d6$\\min$\n\n\u53ef\u4ee5\u53d1\u73b0\u5047\u8bbe\u4e00\u4e2a\u73af\u957f\u5ea6\u4e3a$l$,\u82e5$k$\u53ef\u884c,\u90a3\u4e48$\\gcd(k,l)$\u4e5f\u662f\u53ef\u884c\u7684\n\n\u6211\u4eec\u5224\u65ad\u662f\u5426\u5b58\u5728$0\\le t < \\gcd(k,l)$,\u4f7f\u73af\u4e0a\u6240\u6709\u6a21$\\gcd(k,l)$\u7b49\u4e8e$t$\u7684\u70b9\u7684\u989c\u8272\u90fd\u76f8\u540c\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid cmin(int &x,int y){if(x>y)x=y;}\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=200011;\nbool v[N];\nint n,c[N],p[N],a[N],cnt,ans,d[N],tot;\nint solve(){\n    tot=0;\n    for(int i=1;1ll*i*i<=cnt;++i)\n        if(cnt%i==0){\n            d[++tot]=i;\n            if(i*i!=cnt)d[++tot]=cnt/i;\n        }\n    std::sort(d+1,d+tot+1);\n    fur(t,1,tot)\n        fur(i,0,d[t]-1){\n            for(int j=i;j<cnt;j+=d[t])\n                if(a[i]!=a[j])goto ski;\n            return d[t];\n            ski:;\n        }\n    return cnt;\n}\nint main(){\n    int T;in(T);\n    while(T--){\n        in(n),ans=n;\n        fur(i,1,n)in(p[i]),v[i]=0;\n        fur(i,1,n)in(c[i]);\n        fur(i,1,n)if(!v[i]){\n            a[0]=c[i];v[i]=1;cnt=1;\n            for(int j=p[i];j!=i;j=p[j])a[cnt++]=c[j],v[j]=1;\n            cmin(ans,solve());\n        }\n        printf(\"%d\\n\",ans);\n    }\n}\n```\n", "link": "/posts/LG CF1327D inftyite Path/", "tags": ["\u56fe\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1328E Tree Queries", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1328E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1328E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u53d1\u73b0,\u8fd9\u6761\u94fe\u5fc5\u7136\u7ecf\u8fc7\u6bcf\u4e2a\u7ed9\u5b9a\u70b9\u7684\u7236\u4eb2\n\n\u628a\u6bcf\u4e2a\u7ed9\u5b9a\u70b9\u90fd\u53d8\u6210\u5b83\u7684\u7236\u4eb2\n\n\u6309\u6df1\u5ea6\u6392\u5e8f\n\n\u4f9d\u6b21\u5224\u65ad\u63a5\u4e0b\u6765\u7684\u8282\u70b9\u662f\u5426\u5728\u4e0a\u4e00\u4e2a\u7684\u5b50\u6811\u4e2d\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=200011;\nint n,q,cnt,head[N],a[N],f[N],d[N],L[N],R[N],dfn;\nbool cmp(int x,int y){return d[x]<d[y];}\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x){\n    L[x]=++dfn,d[x]=d[f[x]]+1;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to^f[x])f[to]=x,dfs(to);\n    R[x]=dfn;\n}\nbool chk(int x,int y){return L[x]<=L[y]&&L[y]<=R[x];}\nint main(){\n    in(n),in(q);\n    int x,y,ff;\n    fur(i,2,n)in(x),in(y),add(x,y),add(y,x);\n    f[1]=1,dfs(1);\n    while(q--){\n        in(y);\n        fur(i,1,y)in(x),a[i]=f[x];\n        std::sort(a+1,a+y+1,cmp);\n        ff=1;\n        fur(i,1,y-1)if(!chk(a[i],a[i+1])){ff=0;break;}\n        puts(ff?\"YES\":\"NO\");\n    }\n}\n```\n", "link": "/posts/LG CF1328E Tree Queries/", "tags": ["\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1325D Ehab the Xorcist", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1325D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1325D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5f88\u5999\u7684\u6784\u9020\u9898\n\n\u9996\u5148,\u53ef\u4ee5\u53d1\u73b0\u5f02\u6216\u548c\u660e\u663e\u4e0d\u5927\u4e8e\u603b\u548c\n\n\u7b2c\u4e8c,\u5982\u679c\u5f02\u6216\u548c\u4e0e\u603b\u548c\u7684\u5947\u5076\u4e0d\u540c,\u90a3\u4e48\u65e0\u89e3(\u4e8c\u8fdb\u5236\u4e0b\u6700\u4f4e\u4f4d\u4e0d\u540c,\u6ca1\u6cd5\u7528\u8fdb\u4f4d\u6765\u586b\u5145)\n\n\u5269\u4e0b\u7684\u5c31\u90fd\u53ef\u4ee5\u6784\u9020\u4e86\n\n\u5f53$u=v$\u7684\u65f6\u5019,\u8f93\u51fa$u$\u5c31\u53ef\u4ee5\u4e86,\u5f53$u=0$\u7684\u65f6\u5019\u8bb0\u5f97\u7279\u5224\n\n\u8bbe$x=\\frac{u+v}2$\n\n\u90a3\u4e48$\\left\\{x,x,u\\right\\}$\u5c31\u4e00\u5b9a\u53ef\u4ee5\u6ee1\u8db3\n\n\u5982\u679c$x \\And u=0$\u7684\u65f6\u5019$\\left\\{x,u\\right\\}$\u7b49\u4ef7\u4e8e$\\left\\{x+u\\right\\}$\n\n\u90a3\u4e48$\\left\\{x,x+u\\right\\}$\u53ef\u4ee5\u6ee1\u8db3\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nint main(){\n    long long a,b,x;scanf(\"%lld%lld\",&a,&b);\n    if(a>b||(a&1)!=(b&1))return printf(\"-1\\n\"),0;\n    if(a==b){\n        if(!a)printf(\"0\\n\");\n        else printf(\"1\\n%lld\\n\",a);\n    }\n    else{\n        x=b-a>>1;\n        if(x&a)printf(\"3\\n%lld %lld %lld\\n\",x,x,a);\n        else printf(\"2\\n%lld %lld\\n\",x,a|x);\n    }\n}\n```\n", "link": "/posts/LG CF1325D Ehab the Xorcist/", "tags": ["\u5f02\u6216", "\u4f4d\u8fd0\u7b97", "\u6784\u9020"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1325E Ehab's REAL Number Theory Problem", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1325E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1325E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u6211\u4eec\u53ef\u4ee5\u53ea\u4fdd\u7559\u6bcf\u4e2a\u6570\u5947\u6570\u6b21\u5e42\u7684\u56e0\u5b50\n\n\u7b2c\u4e8c,\u6839\u636e\u7ea6\u6570\u4e2a\u6570\u5b9a\u7406,\u56e0\u4e3a\u6bcf\u4e2a\u6570\u7684\u7ea6\u6570\u4e0d\u8d85\u8fc77,\u6240\u4ee5\u6700\u591a\u53ea\u6709\u4e24\u4e2a\u8d28\u56e0\u5b50\n\n\u53ef\u4ee5\u628a\u9009\u62e9\u4e00\u4e2a\u6570\u770b\u6210\u5728\u8fd9\u4e24\u4e2a\u8d28\u56e0\u5b50\u4e4b\u95f4\u7684\u8fde\u8fb9\n\n\u5982\u679c\u53ea\u6709\u4e00\u4e2a,\u90a3\u4e48\u628a$1$\u4f5c\u4e3a\u53e6\u4e00\u4e2a\u8d28\u56e0\u5b50\n\n\u4e8e\u662f\u6211\u4eec\u5f97\u5230\u4e00\u5f20\u56fe\n\n\u4e58\u79ef\u4e3a\u5b8c\u5168\u5e73\u65b9,\u4e5f\u5c31\u662f\u6bcf\u4e2a\u8d28\u56e0\u5b50\u90fd\u662f\u5076\u6570\u6b21\u5e42,\u90a3\u4e48\u518d\u6700\u7ec8\u7684\u56fe\u4e2d\u5b83\u7684\u5165\u5ea6\u4e3a\u5076\u6570\n\n\u90a3\u5c31\u662f\u8bf4\u6211\u4eec\u8981\u627e\u8fd9\u4e2a\u65e0\u5411\u56fe\u4e2d\u7684\u6700\u5c0f\u73af\n\n\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid cmin(int &x,int y){if(x>y)x=y;}\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=1000011,inf=2122219134;\nbool f[N];\nint cnt,pri[N],id[N],head[N],tt=1,S;\nvoid ol(int n){\n    pri[cnt=1]=id[1]=S=1;\n    fur(i,2,n){\n        if(!f[i])pri[++cnt]=i,id[i]=cnt,S+=(i<=999);\n        for(int j=2;j<=cnt&&i*pri[j]<=n;++j){\n            f[i*pri[j]]=1;\n            // if(i%pri[j]==0)break;\n        }\n    }\n}\nstruct edge{int to,nxt;}e[N];\nvoid add(int x,int y){\n    e[++tt].to=y,e[tt].nxt=head[x],head[x]=tt;\n    e[++tt].to=x,e[tt].nxt=head[y],head[y]=tt;\n}\nint q[N],p[N],d[N];\nint bfs(int x){\n    fur(i,1,78500)d[i]=inf;\n    int h=0,t=1,pre,sz=inf;\n    q[0]=x;d[x]=0;\n    while(h<t){\n        x=q[h],pre=p[h++];\n        for(int i=head[x],to;to=e[i].to,i&&i!=pre;i=e[i].nxt)\n        if(d[to]==inf){\n            d[to]=d[x]+1;\n            q[t]=to,p[t++]=i^1;\n        }\n        else cmin(sz,d[x]+d[to]+1);\n    }\n    return sz;\n}\nint main(){\n    int n;in(n);\n    ol(1000000);\n    int x,a[2];\n    fur(i,1,n){\n        in(x);\n        int tot=0;\n        for(int j=2,t;j<=cnt&&(t=pri[j]*pri[j])<=x;++j)\n        if(x%pri[j]==0){\n            while(x%t==0)x/=t;\n            if(x%pri[j]==0)a[tot++]=j,x/=pri[j];\n        }\n        if(x>1)a[tot++]=id[x],x=1;\n        if(!tot)return printf(\"1\\n\"),0;\n        else if(tot==1)add(1,a[0]);\n        else add(a[0],a[1]);\n    }\n    int ans=inf;\n    fur(i,1,S)cmin(ans,bfs(i));\n    if(ans==inf)ans=-1;\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG CF1325E Ehab's REAL Number Theory Problem/", "tags": ["\u6570\u8bba", "\u56fe\u8bba", "\u6700\u5c0f\u73af"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1313D Happy New Year", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1313D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1313D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_{i,j}$\u8868\u793a\u524d$i$\u4e2a\u70b9,\u7b2c$i$\u4e2a\u70b9\u7684\u8986\u76d6\u72b6\u6001\u4e3a$j$($j$\u4e3a$8$\u4f4d\u4e8c\u8fdb\u5236\u6570)\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=200011;\nint n,cnt,head[N],s[N];\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y,e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x,int f){\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to^f){dfs(to,x);if(s[to]>0)s[x]+=s[to];}\n}\nvoid up(int x,int f){\n    int t=s[f];if(s[x]>0)t-=s[x];\n    if(t>0)s[x]+=t;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to^f)up(to,x);\n}\nint main(){\n    in(n);\n    int x,y;\n    fur(i,1,n)in(x),s[i]=x?1:-1;\n    fur(i,1,n-1)in(x),in(y),add(x,y),add(y,x);\n    dfs(1,0);up(1,0);\n    fur(i,1,n)printf(\"%d \",s[i]);\n}\n```\n", "link": "/posts/LG CF1313D Happy New Year/", "tags": ["\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1324F Maximum White Subtree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1324F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1324F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e24\u6b21dfs\u5373\u53ef\n\n\u7b2c\u4e00\u6b21dfs: \n\n\u8ba1\u7b97\u51fa\u6bcf\u4e2a\u70b9\u7684\u5b50\u6811,\u5305\u542b\u8fd9\u4e2a\u70b9,\u7b54\u6848\u6700\u5927\u662f\u591a\u5c11\n\n\u663e\u7136$S_x=v_x+\\sum\\limits_{y\\in son_x} [S_y>0]S_y$\n\n(\u82e5$x$\u4e3a\u9ed1\u70b9$v_x=-1$,\u5426\u5219$v_x=1$)\n\n\u7b2c\u4e8c\u6b21dfs:\n\n\u901a\u8fc7$x$\u7684\u7236\u4eb2\u7684\u7b54\u6848\u6765\u8ba1\u7b97\u51fa$x$\u7684\u7b54\u6848\n\n\u5982\u679c$x$\u76ee\u524d\u7684\u7b54\u6848$>0$,\u5219\u4ece$x$\u7684\u7b54\u6848\u51cf\u53bb$x$\u76ee\u524d\u7684\u7b54\u6848\n\n\u5982\u679c\u8fd9\u4e2a\u7ed3\u679c$>0$,\u90a3\u4e48$x$\u7684\u7b54\u6848\u52a0\u4e0a\u8fd9\u4e2a\u7ed3\u679c\n\n\u611f\u89c9\u76f4\u63a5\u770b\u4ee3\u7801\u53ef\u80fd\u66f4\u76f4\u89c2\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define gc getchar()\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nvoid in(int &x){x=0;char c;bool f=0;for(c=gc;c<'0'||'9'<c;c=gc)f^=c=='-';for(x=c-48,c=gc;'0'<=c&&c<='9';x=x*10+c-48,c=gc);if(f)x=-x;}\nconst int N=200011;\nint n,cnt,head[N],s[N];\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y,e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x,int f){\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to^f){dfs(to,x);if(s[to]>0)s[x]+=s[to];}\n}\nvoid up(int x,int f){\n    int t=s[f];if(s[x]>0)t-=s[x];\n    if(t>0)s[x]+=t;\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to^f)up(to,x);\n}\nint main(){\n    in(n);\n    int x,y;\n    fur(i,1,n)in(x),s[i]=x?1:-1;\n    fur(i,1,n-1)in(x),in(y),add(x,y),add(y,x);\n    dfs(1,0);up(1,0);\n    fur(i,1,n)printf(\"%d \",s[i]);\n}\n```\n", "link": "/posts/LG CF1324F Maximum White Subtree/", "tags": ["\u6811\u578bdp", "dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1324D Pair of Topics", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1324D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1324D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5efa\u7acb\u65b0\u6570$c$,\u4f7f$c_i=a_i-b_i$\n\n\u90a3\u4e48\u5c31\u662f\u8981\u627e\u591a\u5c11\u5bf9$i<j$\u4e14$c_i>c_j$\n\n\u5c06$c$\u6392\u5e8f,\u7136\u540e\u53cc\u6307\u9488\u7edf\u8ba1\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nint n,a[200001];\nint main(){\n    scanf(\"%d\",&n);\n    int x;long long ans=0;\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i);\n    for(int i=1;i<=n;++i)scanf(\"%d\",&x),a[i]-=x;\n    std::sort(a+1,a+n+1,std::greater<int>());\n    x=n;\n    for(int i=1;i<=n;++i){\n        while(a[x]+a[i]<=0&&x>i)--x;\n        if(a[x]+a[i]>0)ans+=x-i;\n        else break;\n    }\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG CF1324D Pair of Topics/", "tags": ["\u6392\u5e8f", "\u53cc\u6307\u9488"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1312D Count the Arrays", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1312D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1312D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148,\u786e\u5b9a\u6700\u5927\u503c\u548c\u552f\u4e00\u4e00\u5bf9\u7684\u76f8\u540c\u7684\u5143\u7d20\n\n\u8fd9\u5bf9\u5143\u7d20\u5206\u522b\u653e\u5728\u6700\u5927\u503c\u7684\u5de6\u8fb9\u548c\u53f3\u8fb9\n\n\u5269\u4e0b\u7684$n-3$\u4e2a\u5143\u7d20,\u6709\u4e24\u79cd\u9009\u62e9:\n\n1. \u653e\u5728\u6700\u5927\u503c\u5de6\u8fb9\n2. \u653e\u5728\u6700\u5927\u503c\u53f3\u8fb9\n\n\u90a3\u4e48\u5c31\u6709$2^{n-3}$\u79cd\u65b9\u6848\n\n\u4ece$[1,m]$\u4e2d\u9009\u53d6$n-1$\u4e2a\u4e0d\u76f8\u540c\u7684\u5143\u7d20,\u6709$m \\choose {n-1}$\u79cd\u65b9\u6848\n\n\u63a5\u7740\u5728\u8fd9$n-1$\u4e2a\u5143\u7d20\u4e2d\u9009\u53d6\u4e00\u4e2a\u975e\u6700\u5927\u503c\u7684\u5143\u7d20\u4f5c\u4e3a\u552f\u4e00\u76f8\u540c\u90a3\u4e00\u5bf9,\u6709$n-2$\u79cd\u65b9\u6848\n\n\u90a3\u4e48\u6700\u7ec8\u7b54\u6848\u5c31\u662f$2^{n-3} \\times {m \\choose{n-1}} \\times (n-2)$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int P=998244353;\nint pw(int x,int b){\n    int res=1;\n    while(b){\n        if(b&1)res=1ll*res*x%P;\n        b>>=1,x=1ll*x*x%P;\n    }\n    return res;\n}\nint fac(int x){\n    int ans=1;\n    for(int i=2;i<=x;++i)ans=1ll*ans*i%P;\n    return ans;\n}\nint C(int n,int m){\n    if(n<m)return 0;\n    return 1ll*fac(n)*pw(fac(m),P-2)%P*pw(fac(n-m),P-2)%P;\n}\nint main(){\n    int n,m;\n    scanf(\"%d%d\",&n,&m);\n    if(n<=2){printf(\"0\\n\");return 0;}\n    printf(\"%d\\n\",1ll*pw(2,n-3)*C(m,n-1)%P*(n-2)%P);\n}\n```\n", "link": "/posts/LG CF1312D Count the Arrays/", "tags": ["\u6570\u8bba", "\u7ec4\u5408\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1312E Array Shrinking", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1312E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1312E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u770b\u5230$n\\le 500$\u5bb9\u6613\u60f3\u5230\u662f\u533a\u95f4dp\n\n\u8bbe$f(i,j)$\u4e3a$[i,j]$\u5408\u5e76\u540e\u7684\u6700\u5c0f\u957f\u5ea6,$w(i,j)$\u4e3a\u5408\u5e76\u540e\u7684\u548c\n\n$f(i,j)=\\min\\left\\{ f(i,k)+f(k+1,j)\\right\\}$\n\n\u5f53$f(i,k)=f(k+1,j)=1$\u4e14$w(i,k)=w(k+1,j)$\u65f6,\u5408\u5e76\u5373\u53ef\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;typedef unsigned long long ull;typedef double db;typedef short sht;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nvoid cmin(int &x,int y){if(x>y)x=y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=511;\nint n,a[N],f[N][N],w[N][N];\nint main(){\n    in(n);\n    fur(i,1,n)in(a[i]),f[i][i]=1,w[i][i]=a[i];\n    fur(i,2,n)\n        fur(l,1,n-i+1){\n            int r=l+i-1;f[l][r]=r-l+1;\n            fur(k,l,r-1)\n                if(f[l][k]==1&&f[k+1][r]==1&&w[l][k]==w[k+1][r]){\n                    f[l][r]=1,w[l][r]=w[l][k]+1;\n                    break;\n                }\n                else cmin(f[l][r],f[l][k]+f[k+1][r]);\n        }\n    printf(\"%d\\n\",f[1][n]);\n}\n```\n", "link": "/posts/LG CF1312E Array Shrinking/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u533a\u95f4dp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 6477 [NOI Online]\u5b50\u5e8f\u5217\u95ee\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P6477&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P6477\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u679a\u4e3e\u53f3\u7aef\u70b9$r$,\u5f53\u524d\u989c\u8272$x$\n\n\u8bbe$lst_x$\u4e3a\u989c\u8272$x$\u4e0a\u4e00\u6b21\u51fa\u73b0\u7684\u4f4d\u7f6e\n\n\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u5f97\u77e5\u4e86$f(l,r-1),l\\in [1,r-1]$\n\n\u90a3\u4e48$f(l,r),l\\in [lst_x+1,r]=f(l,r-1)+1$\n\n\u4e5f\u5c31\u662f\u8bf4\u6211\u4eec\u628a$[lst_x+1,r]$\u533a\u95f4$+1$\u5c31\u53ef\u4ee5\u4e86\n\n\u4e8e\u662f\u8fd9\u9898\u5c31\u53d8\u6210\u4e86\u7ebf\u6bb5\u6811(\u6216\u6811\u72b6\u6570\u7ec4)\u7ef4\u62a4\u533a\u95f4\u5e73\u65b9\u548c\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\ntypedef long long ll;typedef unsigned long long ull;typedef double db;typedef short sht;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\n#define fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define l2(n) ((int)(log2(n)))\ntemplate <class T>T ABS(T x){return x>0?x:-x;}\ntemplate <class T>T MAX(T x,T y){return x>y?x:y;}\ntemplate <class T>T MIN(T x,T y){return x<y?x:y;}\ntemplate <class T>T GCD(T x,T y){return y?GCD(y,x%y):x;}\ntemplate <class T>void SWAP(T &x,T &y){T t=x;x=y;y=t;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011,inf=2122219134;\nint n;\n__int128 s[N<<2],sq[N<<2],laz[N<<2],ans;\n#define ls rt<<1\n#define rs rt<<1|1\n#include<bits/extc++.h>\nusing namespace __gnu_pbds;\ngp_hash_table<int,int>lst;\nvoid add(int rt,ull v,int len){\n    sq[rt]+=2*s[rt]*v+v*v*len;\n    s[rt]+=v*len;\n}\nvoid pd(int rt,int ln,int rn){\n    if(laz[rt]){\n        laz[ls]+=laz[rt];\n        laz[rs]+=laz[rt];\n        add(ls,laz[rt],ln);\n        add(rs,laz[rt],rn);\n        laz[rt]=0;\n    }\n}\nvoid upd(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        add(rt,1,r-l+1);++laz[rt];\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)upd(L,R,l,m,ls);\n    if(R>m)upd(L,R,m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n    sq[rt]=sq[ls]+sq[rs];\n}\nint main(){\n    in(n);\n    int x;\n    fur(i,1,n){\n        in(x);\n        upd(lst[x]+1,i,1,n,1);\n        lst[x]=i;\n        ans+=sq[1];\n    }\n    printf(\"%d\\n\",ans%1000000007);\n}\n```\n", "link": "/posts/LG 6477 [NOI Online]\u5b50\u5e8f\u5217\u95ee\u9898/", "tags": ["\u7ebf\u6bb5\u6811", "\u8ba1\u6570", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2656 \u91c7\u8611\u83c7", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2656&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2656\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define fur(i,x,y) for(int i(x);i<=y;++i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define Fl(i,x) for(int i(Head[x]),to;to=e[i].to,i;i=e[i].nxt)\nvoid cmin(int &x,int y){if(x>y)x=y;}\nvoid cmax(int &x,int y){if(x<y)x=y;}\nconst int N=80011;\nint n,m,cnt,ans,head[N],Head[N],bl[N],c[N],f[N];\nstruct edge{\n    int x,to,nxt,w;\n    double k;\n}e[200011];\nvoid add(int x,int y,int w,double k){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w,e[cnt].k=k;e[cnt].x=x;\n}\nvoid addd(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=Head[x];Head[x]=cnt;e[cnt].w=w;\n}\nint dfn[N],low[N],sz,q[N*2],tp,id=1;\nbool v[N];\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;\n    v[x]=1;q[++tp]=x;\n    fl(i,x)\n    if(!dfn[to])tarjan(to),cmin(low[x],low[to]);\n    else if(v[to])cmin(low[x],dfn[to]);\n    if(low[x]==dfn[x]){\n        ++id;\n        while(int k=q[tp--]){\n            bl[k]=id,v[k]=0;\n            if(k==x){++id;break;}\n        }\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    int x,y,w,h=0,t=1;double k;\n    fur(i,1,m)scanf(\"%d%d%d%lf\",&x,&y,&w,&k),add(x,y,w,k);\n    fur(i,1,n)if(!dfn[i])tarjan(i);\n    cnt=0;\n    fur(i,1,m){\n        x=bl[e[i].x],y=bl[e[i].to];\n        if(x==y){\n            w=e[i].w;\n            while(w){\n                c[x]+=w;\n                w=int(w*e[i].k);\n            }\n        }\n        else addd(x,y,e[i].w);\n    }\n    scanf(\"%d\",&x);q[0]=x=bl[x];\n    f[x]=c[x];\n    while(h<t){\n        v[x=q[h++]]=0;\n        Fl(i,x)if(f[x]+e[i].w+c[to]>f[to]){\n            f[to]=f[x]+e[i].w+c[to];\n            if(!v[to])q[t++]=to,v[to]=1;\n        }\n    }\n    fur(i,1,id)cmax(ans,f[i]);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 2656 \u91c7\u8611\u83c7/", "tags": ["tarjan", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3206 [HNOI2010]\u57ce\u5e02\u5efa\u8bbe", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3206&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3206\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u7ebf\u6bb5\u6811\u5206\u6cbb+`LCT`\n\n\u4e00\u4e2a\u975e\u5e38\u66b4\u529b\u7684\u601d\u8def\n\nFBI WARNING: \u6781\u6709\u53ef\u80fd\u56e0\u4e3a\u5e38\u6570\u5de8\u5927\u800c\u8d85\u65f6\n\n\u628a\u8be2\u95ee(\u4fee\u6539)\u65f6\u95f4\u770b\u6210\u5e8f\u5217,\u6bcf\u6761\u8fb9\u5728\u8fd9\u4e2a\u5e8f\u5217\u4e0a\u7684\u4e00\u6bb5\u533a\u95f4\u51fa\u73b0\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int M=50011;\nint n,m,q,tot,cnt,lst[M],pos[M],head[M<<2];\nstruct node{int x,y,w;}a[M<<2];\nstruct edge{int to,nxt;}e[M<<4];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\n/*--- LCT START---*/\nint f[M<<2],c[2][M<<2],v[M<<2],mx[M<<2];\nbool rev[M<<2];\n#define ls c[0][x]\n#define rs c[1][x]\nil void pu(int x){\n    mx[x]=x;\n    if(ls&&v[mx[ls]]>v[mx[x]])mx[x]=mx[ls];\n    if(rs&&v[mx[rs]]>v[mx[x]])mx[x]=mx[rs];\n}\nil void pd(int x){\n    if(rev[x])\n        rev[ls]^=1,rev[rs]^=1,\n        ls^=rs,rs^=ls,ls^=rs,\n        rev[x]=0;\n}\nil int g(int x){return c[1][f[x]]==x;}\nil int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y);\n}\nvoid pda(int x){if(nrt(x))pda(f[x]);pd(x);}\nil void splay(int x){\n    // for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        // rotate(g(x)^g(f[x])?x:f[x]);\n    for(pda(x);nrt(x);rotate(x));//\u8fd9\u9898\u5355\u65cb\u66f4\u5feb\n    pu(x);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),rs=y,pu(x);\n}\nil void mrt(int x){access(x),splay(x),rev[x]^=1;}\nil int frt(int x){\n    for(access(x),splay(x);ls;pd(x),x=ls);\n    splay(x);return x;\n}\n/*--- LCT END ---*/\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){add(rt,v);return;}\n    int m=l+r>>1;\n    if(L<=m)upd(L,R,v,l,m,rt<<1);\n    if(R>m)upd(L,R,v,m+1,r,rt<<1|1);\n}\nil void link(int x,int y){mrt(x),f[x]=y;}\nil void spl(int x,int y){mrt(x),access(y),splay(y);}\nil void cut(int x,int y){spl(x,y),f[x]=c[0][y]=0,pu(y);}\nint st[M<<2],tp=0;\nlong long ans;\nbool typ[M<<2];\nvoid div(int l,int r,int rt){\n    int x,y,w,bg=tp,to,m=l+r>>1;\n    for(int i=head[rt];i;i=e[i].nxt){\n        to=e[i].to,x=a[to].x,y=a[to].y,w=a[to].w;\n        if(frt(x)==frt(y)){\n            spl(x,y);\n            int p=mx[y];\n            if(v[p]>w){\n                cut(a[p-n].x,p),cut(a[p-n].y,p),ans-=a[p-n].w;\n                st[++tp]=p-n,typ[tp]=0;\n            }\n            else continue;\n        }\n        link(x,to+n),link(y,to+n),ans+=w;\n        st[++tp]=to,typ[tp]=1;\n    }\n    if(l==r)out(ans,ln);\n    else div(l,m,rt<<1),div(m+1,r,rt<<1|1);\n    for(;tp^bg;--tp){\n        x=st[tp];\n        if(typ[tp])\n            ans-=a[x].w,\n            cut(a[x].x,x+n),cut(a[x].y,x+n);\n        else\n            ans+=a[x].w,\n            link(a[x].x,x+n),link(a[x].y,x+n);\n    }\n}\nint main(){\n    in(n,m,q);tot=m;\n    fur(i,1,m)in(a[i].x,a[i].y,a[i].w),lst[i]=1,pos[i]=i;\n    fur(i,1,q){\n        int k,d;in(k,d);\n        if(lst[k]<i)upd(lst[k],i-1,pos[k],1,q,1);\n        lst[k]=i;a[++tot]=a[pos[k]];a[tot].w=d;pos[k]=tot;\n    }\n    fur(i,1,m)upd(lst[i],q,pos[i],1,q,1);\n    fur(i,1,tot)v[n+i]=a[i].w;\n    div(1,q,1);\n    flush();\n}\n```\n\n## cdq\u5206\u6cbb\n\n\u4e00\u4e2a\u975e\u5e38\u5de7\u5999\u7684\u601d\u8def\n\n\u548c\u7ebf\u6bb5\u6811\u5206\u6cbb\u4e00\u6837,\u6211\u4eec\u5bf9\u4fee\u6539\u65f6\u95f4\u8fdb\u884c\u5206\u6cbb\n\n\u66b4\u529b: \u5f53$l=r$\u7684\u65f6\u5019,\u5c31\u76f4\u63a5\u8ba9\u4fee\u6539\u751f\u6548,\u7136\u540e\u6c42\u4e00\u8fb9`MST`(\u6700\u5c0f\u751f\u6210\u6811)\n\n\u56fe\u7684\u89c4\u6a21\u662f$m$,$\\mathcal{O}(nm)$\u663e\u7136\u4e0d\u884c\n\n\u8981\u9760\u5206\u6cbb\u6765\u7f29\u5c0f\u56fe\u7684\u89c4\u6a21\n\n1. \u5fc5\u9009\u8fb9\n\n   \u5047\u8bbe\u5f53\u524d\u5904\u7406\u7684\u533a\u95f4\u4e3a$[l,r]$,\u628a\u533a\u95f4\u4e2d\u8981\u6c42\u6539\u7684\u8fb9\u5168\u90e8\u6539\u4e3a$-\\infty$,\u8dd1\u4e00\u904d`MST`\n\n   \u90a3\u4e48\u8dd1\u5b8c\u540e\u4e0d\u662f$-\\infty$\u4e14\u8fd8\u5728`MST`\u4e2d\u7684\u8fb9,\u4e4b\u540e\u4e5f\u4e00\u5b9a\u4f1a\u7559\u5728`MST`\u4e2d\n\n   \u90a3\u4e48\u53ef\u4ee5\u628a\u8fd9\u4e9b\u8fb9\u5f62\u6210\u7684\u8fde\u901a\u5757\u7f29\u70b9,\u628a\u5269\u4e0b\u7684\u8fb9\u5b58\u4e0b\u6765\u7ee7\u7eed\u5206\u6cbb\n\n2. \u65e0\u7528\u8fb9\n   \n   \u5047\u8bbe\u5f53\u524d\u5904\u7406\u7684\u533a\u95f4\u4e3a$[l,r]$,\u628a\u533a\u95f4\u4e2d\u8981\u6c42\u6539\u7684\u8fb9\u5168\u90e8\u6539\u4e3a$\\infty$,\u8dd1\u4e00\u904d`MST`\n\n   \u90a3\u4e48\u8dd1\u5b8c\u540e\u4e0d\u662f$\\infty$\u4e14\u4e0d\u5728`MST`\u4e2d\u7684\u8fb9,\u4e4b\u540e\u4e5f\u4e00\u5b9a\u4e0d\u5728`MST`\u4e2d\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i(x);i<=y;++i)\ntypedef long long ll;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nusing std::sort;\nconst int N=50011,inf=1<<30;\nint n,m,q,f[N],sz[N],a[N],c[N],tot[20];\nstruct node{\n    int x,y,w,id;\n    bool operator<(node t){return w<t.w;}\n}e[20][N],b[N],t[N];\nstruct mdy{int x,y;}p[N];\nint gf(int x){return x==f[x]?x:(f[x]=gf(f[x]));}\nvoid link(int x,int y){\n    x=gf(x),y=gf(y);\n    if(sz[x]>sz[y])x^=y,y^=x,x^=y;\n    f[x]=y,sz[y]+=sz[x];\n}\nvoid set(int T,node*a){\n    fur(i,1,T)\n        f[a[i].x]=a[i].x,f[a[i].y]=a[i].y,\n        sz[a[i].x]=sz[a[i].y]=1;\n}\nvoid useful(int&T,ll&val){\n    int tt=0;\n    set(T,b);sort(b+1,b+T+1);\n    fur(i,1,T)if(gf(b[i].x)^gf(b[i].y))\n        link(b[i].x,b[i].y),t[++tt]=b[i];\n    set(tt,t);\n    fur(i,1,tt)if(t[i].w!=-inf&&gf(t[i].x)^gf(t[i].y))\n        val+=t[i].w,link(t[i].x,t[i].y);\n    tt=0;\n    fur(i,1,T)if(gf(b[i].x)^gf(b[i].y))\n        t[++tt]={f[b[i].x],f[b[i].y],b[i].w,b[i].id};\n    fur(i,1,tt)c[b[i].id]=i,b[i]=t[i];\n    T=tt;\n}\nvoid useless(int&T){\n    int tt=0;\n    set(T,b);sort(b+1,b+T+1);\n    fur(i,1,T)\n        if(gf(b[i].x)^gf(b[i].y))\n            link(b[i].x,b[i].y),t[++tt]=b[i];\n        else if(b[i].w==inf)t[++tt]=b[i];\n    fur(i,1,tt)c[b[i].id]=i,b[i]=t[i];\n    T=tt;\n}\nvoid div(int l,int r,int d,ll val){\n    int T=tot[d],m=l+r>>1;\n    if(l==r)a[p[l].x]=p[l].y;\n    fur(i,1,T){\n        e[d][i].w=a[e[d][i].id];\n        b[i]=e[d][i],c[b[i].id]=i;\n    }\n    if(l==r){\n        set(T,b);\n        sort(b+1,b+T+1);\n        fur(i,1,T)if(gf(b[i].x)^gf(b[i].y))\n            link(b[i].x,b[i].y),val+=b[i].w;\n        out(val,ln);return;\n    }\n    fur(i,l,r)b[c[p[i].x]].w=-inf;\n    useful(T,val);\n    fur(i,l,r)b[c[p[i].x]].w=inf;\n    useless(T);\n    fur(i,1,T)e[d+1][i]=b[i];\n    tot[d+1]=T;\n    div(l,m,d+1,val);\n    div(m+1,r,d+1,val);\n}\nint main(){\n    in(n,m,q);\n    int x,y;\n    fur(i,1,m)in(x,y,a[i]),e[0][i]={x,y,a[i],i};\n    fur(i,1,q)in(p[i].x,p[i].y);\n    tot[0]=m;div(1,q,0,0);\n    flush();\n}\n```\n", "link": "/posts/LG 3206 [HNOI2010]\u57ce\u5e02\u5efa\u8bbe/", "tags": ["lct", "\u7ebf\u6bb5\u6811\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5227 [AHOI2013]\u8fde\u901a\u56fe", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5227&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5227\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8981\u8f6c\u5316\u4e3a\u52a0\u8fb9,\u4e4b\u540e\u7528\u5e76\u67e5\u96c6\u7ef4\u62a4\u662f\u5426\u8fde\u901a\u5c31\u53ef\u4ee5\u4e86(\u5e26\u6743\u7ef4\u62a4\u8fde\u901a\u5757\u5927\u5c0f,\u4e3an\u7684\u65f6\u5019\u8bf4\u660e\u5168\u90e8\u8fde\u901a)\n\n\u6bcf\u6761\u8fb9\u90fd\u5728\u7279\u5b9a\u7684\u65f6\u95f4\u6bb5\u4e2d\u51fa\u73b0\n\n\u7531\u4e8e\u52a0\u8fb9\u5b8c\u8fd8\u8981\u5220\u6389\u8fd9\u91cc\u4f7f\u7528\u6309\u79e9\u5408\u5e76\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\ntypedef long long ll;typedef unsigned long long ull;typedef double db;typedef short sht;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\n#define fdr(i,x,y) for(int i(x);i>=y;--i)\ntemplate <class T>T MAX(T x,T y){return x>y?x:y;}\ntemplate <class T>T MIN(T x,T y){return x<y?x:y;}\ntemplate <class T>void SWAP(T &x,T &y){T t=x;x=y;y=t;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nusing namespace std;\nconst int N=100011,M=200011;\nint n,q,k,tp,cnt,f[N],siz[N],X[M],Y[M],head[N*4],st[N*80];\nlist<int>T[M];\nint gf(int x){while(f[x])x=f[x];return x;}\nstruct edge{int to,nxt;}e[N*80];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){add(rt,v);return;}\n    int m=(l+r)>>1;\n    if(L<=m)upd(L,R,v,l,m,rt<<1);\n    if(R>m)upd(L,R,v,m+1,r,rt<<1|1);\n}\nvoid qry(int l,int r,int rt){\n    int m=(l+r)>>1,x,y,bg=tp;\n    for(int i=head[rt];i;i=e[i].nxt){\n        x=gf(X[e[i].to]),y=gf(Y[e[i].to]);\n        if(x^y){\n            if(siz[x]+siz[y]==n){fur(j,l,r)out(\"Connected\\n\");goto ski;}\n            if(siz[x]>siz[y])SWAP(x,y);\n            siz[f[st[++tp]=x]=y]+=siz[x];\n        }\n    }\n    if(l==r)out(\"Disconnected\\n\");\n    else qry(l,m,rt<<1),qry(m+1,r,rt<<1|1);\n    ski:;\n    for(;tp^bg;--tp)\n        siz[f[x=st[tp]]]-=siz[x],f[x]=0;\n}\nint main(){\n    in(n,k);\n    fur(i,1,k)in(X[i],Y[i]);\n    int c,x,la;\n    list<int>::iterator it;\n    in(q);\n    fur(i,1,q)\n        for(in(c);c;--c)\n            in(x),T[x].push_back(i);\n    fur(i,1,k){\n        T[i].sort(),T[i].push_back(q+1);\n        for(it=T[i].begin(),la=1;it!=T[i].end();la=*it+1,++it)\n            if(la!=*it)upd(la,*it-1,i,1,q,1);\n    }\n    fur(i,1,n)siz[i]=1;\n    qry(1,q,1);\n    flush();\n}\n```\n", "link": "/posts/LG 5227 [AHOI2013]\u8fde\u901a\u56fe/", "tags": ["lct", "\u5e76\u67e5\u96c6", "\u7ebf\u6bb5\u6811\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "BZ 4025 \u4e8c\u5206\u56fe", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://remmina.github.io/BZPRO/JudgeOnline/4025.html&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://remmina.github.io/BZPRO/JudgeOnline/4025.html\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u5b9a\u4e49\n\n> \u4e8c\u5206\u56fe\u53c8\u79f0\u4f5c\u4e8c\u90e8\u56fe,\u662f\u56fe\u8bba\u4e2d\u7684\u4e00\u79cd\u7279\u6b8a\u6a21\u578b\u3002 \n> \n> \u8bbe$G=(V,E)$\u662f\u4e00\u4e2a\u65e0\u5411\u56fe,\n> \n> \u5982\u679c\u9876\u70b9$V$\u53ef\u5206\u5272\u4e3a\u4e24\u4e2a\u4e92\u4e0d\u76f8\u4ea4\u7684\u5b50\u96c6$(A,B)$,\n> \n> \u5e76\u4e14\u56fe\u4e2d\u7684\u6bcf\u6761\u8fb9$i\\leftrightarrow j$\u6240\u5173\u8054\u7684\u4e24\u4e2a\u9876\u70b9$i$\u548c$j$\u5206\u522b\u5c5e\u4e8e\u8fd9\u4e24\u4e2a\u4e0d\u540c\u7684\u9876\u70b9\u96c6($i \\in A,j \\in B$),\n> \n> \u5219\u79f0\u56fe$G$\u4e3a\u4e00\u4e2a\u4e8c\u5206\u56fe\u3002\n> \n> \u7b80\u800c\u8a00\u4e4b,\u5c31\u662f\u9876\u70b9\u96c6V\u53ef\u5206\u5272\u4e3a\u4e24\u4e2a\u4e92\u4e0d\u76f8\u4ea4\u7684\u5b50\u96c6,\u5e76\u4e14\u56fe\u4e2d\u6bcf\u6761\u8fb9\u4f9d\u9644\u7684\u4e24\u4e2a\u9876\u70b9\u90fd\u5206\u5c5e\u4e8e\u8fd9\u4e24\u4e2a\u4e92\u4e0d\u76f8\u4ea4\u7684\u5b50\u96c6,\u4e24\u4e2a\u5b50\u96c6\u5185\u7684\u9876\u70b9\u4e0d\u76f8\u90bb\u3002\n\n## \u5224\u65ad\n\n\u533a\u522b\u4e8c\u5206\u56fe,\u5173\u952e\u662f\u770b\u70b9\u96c6\u662f\u5426\u80fd\u5206\u6210\u4e24\u4e2a\u72ec\u7acb\u7684\u70b9\u96c6\u3002\n\n\u65e0\u5411\u56fe$G$\u4e3a\u4e8c\u5206\u56fe\u7684\u5145\u5206\u5fc5\u8981\u6761\u4ef6\u662f: $G$\u81f3\u5c11\u6709\u4e24\u4e2a\u9876\u70b9,\u4e14\u5176\u6240\u6709\u56de\u8def\u7684\u957f\u5ea6\u5747\u4e3a\u5076\u6570\u3002\n\n\u8bc1\u660e:\n\n> \u5fc5\u8981\u6027:\n> \n> \u8bbe$G=<V,E>$\u4e3a\u4e00\u4e2a\u7b80\u5355\u65e0\u5411\u56fe,$G$\u4e3a\u4e8c\u5206\u56fe,\u90a3\u4e48\u53ef\u4ee5\u5c06$V$\u5206\u4e3a$V_1,V_2$\n> \n> \u8bbe$C$\u4e3a$G$\u4e2d\u957f\u5ea6\u4e3a$l$\u7684\u5708,$C=(v_1,v_2,...v_{l-1},v_l,v_1)$\n> \n> \u90a3\u4e48$v_1\\in V_1,v_2\\in V_2,v_3\\in V_1 ,\\cdots,v_l \\in V_2$\n> \n> \u4e5f\u5c31\u662f: \n> \n> $$\n> v_1,v_3,v_5,\\cdots v_l-1 \\in V_1\n> \\\\\n> v_2,v_4,v_6,\\cdots v_l \\in V_2\n> $$\n> \n> \u6240\u4ee5$l$\u5fc5\u5b9a\u4e3a\u5076\u6570\n\n> \u5145\u5206\u6027:\n> \n> \u8bbe\u65e0\u5411\u56fe$G$\u4e2d\u6bcf\u4e2a\u5708\u7684\u957f\u5ea6\u90fd\u662f\u5076\u6570,\u5e76\u4e14\u5047\u5b9a$G$\u4e3a\u8fde\u901a\u56fe\n> \n> \u5b9a\u4e49$V$\u7684\u4e24\u4e2a\u5b50\u96c6$V_1,V_2$:\n> \n> \u4efb\u53d6$v\\in V$,\n> \n> $V_1=\\left\\{v|dist(v_i,v) \\mod 2 = 0\\right\\}$\n> \n> $V_2=\\left\\{v|dist(v_i,v) \\mod 2 = 1\\right\\}$\n> \n> $V_1$\u7684\u8282\u70b9\u95f4\u65e0\u8fb9\u8fde\u63a5,\n> \n> \u5047\u82e5\u4e0d\u7136,\u8bbe\u6709\u8fb9$v_i\\leftrightarrow v_j\\in E$\u4e14$v_i,v_j\\in V_1$,\u90a3\u4e48$v$\u5230$v_i$\u4ee5\u53ca$v$\u5230$v_j$\u7684\u957f> \u5ea6\u90fd\u662f\u5076\u6570,\n> \n> \u90a3\u4e48$v$\u5230$v_i$\u5230$v_j$\u5230$v$\u8fd9\u4e2a\u5708\u7684\u957f\u5ea6\u4e3a\u5947\u6570,\u4e0e\u7ed9\u5b9a\u6761\u4ef6\u77db\u76fe,\u6240\u4ee5\u8fb9$v_i\\leftrightarrow v_j$\u4e0d\u5b58\u5728\n> \n> \u540c\u7406\u53ef\u8bc1$V_2$\u7684\u8282\u70b9\u95f4\u65e0\u8fb9\u8fde\u63a5\n\n\n\u56de\u5f52\u6b63\u9898,\u6211\u4eec\u8981\u5224\u65ad\u662f\u5426\u662f\u4e8c\u5206\u56fe,\u53ea\u9700\u8981\u5224\u65ad\u56fe\u91cc\u662f\u5426\u5b58\u5728\u5947\u73af\u5c31\u53ef\u4ee5\u4e86\n\n## \u89e3\u6cd5\u4e00\n\nlink-cut tree\n\n\u8003\u8651\u5230\u6bcf\u6761\u8fb9\u6700\u540e\u90fd\u662f\u8981\u5220\u6389\u7684,\u90a3\u4e48\u5f53\u6784\u6210\u73af\u65f6,\u6211\u4eec\u5c31\u53ef\u4ee5\u5c06\u8be5\u73af\u4e2d\u6700\u65e9\u8981\u88ab\u5220\u6389\u7684\u8fb9\u7ed9\u5220\u53bb,\u56e0\u4e3a\u8fd9\u6837\u4e00\u6765\u4e0d\u4f1a\u5f71\u54cd\u8fde\u901a\u6027,\u4e8c\u6765\u53c8\u53ef\u4ee5\u5316\u73af\u4e3a\u94fe\u3002\n\n\u6dfb\u52a0\u4e00\u6761\u8fb9\u7684\u65f6\u5019,\u82e5\u4e24\u7aef\u672a\u8fde\u901a,\u76f4\u63a5\u8fde\u8fb9\u5373\u53ef\n\n\u82e5\u4e24\u7aef\u5df2\u7ecf\u8fde\u901a,\u8fd9\u65f6\u4e00\u5b9a\u4f1a\u5f62\u6210\u4e00\u4e2a\u73af,\u4e3a\u4e86\u7ef4\u62a4`LCT`,\u8fde\u63a5\u4e24\u7aef\u65f6,\u6211\u4eec\u9700\u8981\u628a\u73af\u4e0a\u6d88\u5931\u65f6\u523b\u6700\u65e9\u7684\u8fb9\u7ed9\u5220\u53bb,\u5982\u679c\u662f\u5947\u73af\u5219\u628a\u8fd9\u6761\u8fb9\u52a0\u5165\u96c6\u5408\n\n\u5220\u8fb9\u65f6\u5982\u679c\u662f`LCT`\u4e0a\u7684\u8fb9\u5219\u65ad\u5f00,\u5728\u96c6\u5408\u4e2d\u5219\u5c06\u5176\u4ece\u96c6\u5408\u4e2d\u5220\u9664\n\n\u67e5\u8be2\u65f6\u82e5\u96c6\u5408\u4e2d\u6ca1\u6709\u8fb9,\u5219\u4e3a\u4e8c\u5206\u56fe\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,M=200011,inf=2122219134,P=300011;\nint n,m,T,cnt,tot,s[P],fr[P],siz[P],v[P],c[2][P],f[P],ad[N],de[N];\nbool rev[P],is[M],on[M];\nstruct node{int x,y,v;}a[M];\nstruct edge{int to,nxt;}e[M<<1];\nvoid add(int *head,int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\n#define ls c[0][x]\n#define rs c[1][x]\nvoid pu(int x){\n    s[x]=v[x],fr[x]=x;\n    siz[x]=(x>n)+siz[ls]+siz[rs];\n    if(s[ls]<s[x])s[x]=s[ls],fr[x]=fr[ls];\n    if(s[rs]<s[x])s[x]=s[rs],fr[x]=fr[rs];\n}\nvoid pr(int x){rev[x]^=1,ls^=rs,rs^=ls,ls^=rs;}\nvoid pd(int x){\n    if(rev[x]){\n        if(ls)pr(ls);\n        if(rs)pr(rs);\n        rev[x]=0;\n    }\n}\nint g(int x){return c[1][f[x]]==x;}\nint nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nvoid rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y);\n}\nvoid pda(int x){if(nrt(x))pda(f[x]);pd(x);}\nvoid splay(int x){\n    for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n    pu(x);\n}\nvoid access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),rs=y,pu(x);\n}\nvoid mrt(int x){access(x),splay(x),pr(x);}\nint frt(int x){\n    for(access(x),splay(x);ls;pd(x),x=ls);\n    splay(x);return x;\n}\nvoid cut(int x,int y){\n    mrt(x);\n    if(frt(y)==x&&f[y]==x&&!c[0][y])rs=f[y]=0,pu(x);\n}\nvoid inc(int i){\n    int x=a[i].x,y=a[i].y;\n    if(x==y){is[i]=1,++tot;return;};\n    mrt(x);\n    if(frt(y)!=x)on[i]=1,mrt(y),f[x]=f[y]=i+n;//\u76f4\u63a5\u8fde\u63a5\n    else{\n        splay(y);\n        int k=fr[y]-n;\n        if(a[k].v<a[i].v){\n            if(siz[y]&1^1)is[k]=1,++tot;//\u662f\u5947\u73af,\u5c06\u8fb9\u52a0\u5165\u96c6\u5408\n            cut(a[k].x,k+n),cut(a[k].y,k+n);\n            mrt(x),mrt(y),f[x]=f[y]=i+n;\n            on[k]=0,on[i]=1;\n        }\n        else if(siz[y]&1^1)is[i]=1,++tot;\n    }\n}\nvoid dec(int i){\n    if(on[i])cut(a[i].x,i+n),cut(a[i].y,i+n);//\u662fLCT\u4e0a\u7684\u8fb9\n    else if(is[i])--tot;//\u4ece\u96c6\u5408\u4e2d\u5220\u53bb\n}\nint main(){\n    s[0]=v[0]=inf;\n    in(n,m,T);\n    fur(i,1,n)v[i]=s[i]=inf,fr[i]=i;\n    int x,y,st,ed;\n    fur(i,1,m){\n        in(x,y,st,ed);\n        a[i]={x,y,ed};\n        s[i+n]=v[i+n]=ed,fr[i+n]=i+n,siz[i+n]=1;\n        add(ad,st,i),add(de,ed,i);\n    }\n    fur(i,0,T-1){\n        for(int j=ad[i];j;j=e[j].nxt)inc(e[j].to);\n        for(int j=de[i];j;j=e[j].nxt)dec(e[j].to);\n        out(tot?\"No\\n\":\"Yes\\n\");\n    }\n    flush();\n}\n```\n\n## \u89e3\u6cd5\u4e8c\n\n\u7ebf\u6bb5\u6811\u5206\u6cbb+\u5e76\u67e5\u96c6\n\n\u53ef\u4ee5\u53d1\u73b0\u6bcf\u6761\u8fb9\u5b58\u5728\u7684\u65f6\u95f4\u90fd\u662f\u4e00\u4e2a\u533a\u95f4\n\n\u5982\u4f55\u5224\u65ad\u662f\u5426\u51fa\u73b0\u5947\u73af\u5462?\n\n\u5e76\u67e5\u96c6\u7ef4\u62a4\u6bcf\u4e2a\u70b9\u5230\u6839\u7684\u8ddd\u79bb(\u53ea\u9700\u8981\u7ef4\u62a4\u5947\u5076\u5c31\u53ef\u4ee5\u4e86)\n\n\u7531\u4e8e\u8981\u652f\u6301\u5220\u9664,\u8fd9\u91cc\u4f7f\u7528\u5e76\u67e5\u96c6\u6309\u79e9\u5408\u5e76(\u542f\u53d1\u5f0f\u5408\u5e76)\n\n\u8fde\u63a5\u4e00\u6761\u8fb9\u65f6,\u82e5\u4e24\u7aef\u4ee5\u8fde\u901a,\u5219\u5224\u65ad\u6dfb\u52a0\u540e\u662f\u5426\u5f62\u6210\u5947\u73af\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011,M=200011;\nint n,m,T,cnt,tp,head[N<<2],f[N],siz[N];\nbool ans[N],s[N];\nint gf(int x){while(x!=f[x])x=f[x];return x;}\nint dis(int x){int d=0;while(x!=f[x])d^=s[x],x=f[x];return d;}\nstruct node{int x,y;}a[M],sta[N<<2];\nstruct edge{int to,nxt;}e[N<<2];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){add(rt,v);return;}\n    int m=l+r>>1;\n    if(L<=m)upd(L,R,v,l,m,rt<<1);\n    if(R>m)upd(L,R,v,m+1,r,rt<<1|1);\n}\nvoid qry(int l,int r,int rt){\n    int m=l+r>>1,ff=1,x,y,fx,fy,bg=tp;\n    for(int i=head[rt];i;i=e[i].nxt){\n        x=a[e[i].to].x,y=a[e[i].to].y,fx=gf(x),fy=gf(y);\n        if(fx==fy){if(dis(x)^dis(y)^1){ff=0;break;}}\n        else{\n            if(siz[fx]>siz[fy])fx^=fy,fy^=fx,fx^=fy;\n            siz[fy]+=siz[fx],s[fx]=s[x]^s[y]^1;\n            f[fx]=fy;\n            sta[++tp]={fx,fy};\n        }\n    }\n    if(ff){\n        if(l==r)ans[l]=1;\n        else qry(l,m,rt<<1),qry(m+1,r,rt<<1|1);\n    }\n    while(tp!=bg){\n        x=sta[tp].x,y=sta[tp].y;\n        siz[y]-=siz[x];\n        s[x]=0,f[x]=x;\n        --tp;\n    }\n}\nint main(){\n    in(n,m,T);\n    int st,ed;\n    fur(i,1,m){\n        in(a[i].x,a[i].y,st,ed);\n        if(st<ed)upd(st+1,ed,i,1,T,1);\n    }\n    fur(i,1,n)f[i]=i,siz[i]=1;\n    qry(1,T,1);\n    fur(i,1,T)out(ans[i]?\"Yes\\n\":\"No\\n\");\n    flush();\n}\n```\n", "link": "/posts/BZ 4025 \u4e8c\u5206\u56fe/", "tags": ["\u7ebf\u6bb5\u6811\u5206\u6cbb", "lct", "\u4e8c\u5206\u56fe"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3769 [CH\u5f31\u7701\u80e1\u7b56R2]TATT", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3769&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3769\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u770b\u6210\u601d\u7ef4\u504f\u5e8f\u95ee\u9898\n\n\u5148\u6309\u7b2c\u4e00\u7ef4\u4f18\u5148,\u76f8\u540c\u5219\u7ee7\u7eed\u6bd4\u8f83\u5176\u4ed6\u7ef4\u6392\u5e8f(\u4fdd\u8bc1\u4e4b\u540e\u63d2\u5165\u7684\u70b9\u4e0d\u4f1a\u88ab\u4e4b\u524d\u63d2\u5165\u7684\u70b9\u7684\u8303\u56f4\u8986\u76d6,\u9632\u6b62\u7edf\u8ba1\u7684\u65f6\u5019\u6f0f\u6389),\n\n$f_i=\\max{f_j + 1}$\n\n\u5269\u4e0b\u4e09\u7ef4\u53ef\u4ee5\u7528`KDT`\u6c42\u51fa\u6700\u5927\u7684$f_j$\n\n\u6709\u4e24\u79cd\u5199\u6cd5:\n\n1. \u5e26\u91cd\u6784`KDT`\n   \n2. \u5148\u6784\u5efa\u5b8c\u6574\u7684`KDT`,\u7136\u540e\u628a\u63d2\u5165\u5f53\u4f5c\u6fc0\u6d3b\u8282\u70b9\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\ntypedef double db;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nint max(int x,int y){return x>y?x:y;}\nvoid cmin(int &x,int y){x=x<y?x:y;}\nvoid cmax(int &x,int y){x=x>y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=50011,inf=2122219134;\nint _cmp,n,rt,ans,ls[N],rs[N],mi[N][3],mx[N][3],s[N],g[N];\nstruct node{\n    int v[4];\n    int& operator[](int x){return v[x];}\n    bool operator<(node p){fur(i,0,3)if(v[i]!=p[i])return v[i]<p[i];}\n}t[N];\nvoid pu(int x){\n    fur(i,0,2){\n        mi[x][i]=mx[x][i]=t[x][i+1];\n        if(ls[x])cmin(mi[x][i],mi[ls[x]][i]),cmax(mx[x][i],mx[ls[x]][i]);\n        if(rs[x])cmin(mi[x][i],mi[rs[x]][i]),cmax(mx[x][i],mx[rs[x]][i]);\n    }\n}\nbool cmp(int a,int b){return t[a][_cmp]<t[b][_cmp];}\nint build(int l,int r,int b){\n    if(l>r)return 0;\n    int m=l+r>>1;\n    _cmp=b+1,std::nth_element(g+l,g+m,g+r+1,cmp);\n    ls[g[m]]=build(l,m-1,(b+1)%3),\n    rs[g[m]]=build(m+1,r,(b+1)%3),\n    pu(g[m]);return g[m];\n}\nint id,as;\nbool chk(int *p,int *q=t[id].v+1){\n    fur(i,0,2)if(p[i]>q[i])return 0;\n    return 1;\n}\nvoid ask(int x){\n    if(!x||s[x]<=as)return;\n    if(!chk(mi[x]))return;\n    if(chk(mx[x])){as=s[x];return;}\n    if(chk(t[x].v+1))cmax(as,t[x][0]);\n    ask(ls[x]),ask(rs[x]);\n}\nvoid on(int x){\n    if(x==id){cmax(s[x],t[x][0]=as);return;}\n    if(!chk(t[id].v+1,mx[x])||!chk(mi[x]))return;\n    if(ls[x])on(ls[x]);if(rs[x])on(rs[x]);\n    cmax(s[x],s[ls[x]]),cmax(s[x],s[rs[x]]);\n}\nint main(){\n    in(n);\n    fur(i,1,n)in(t[i][0],t[i][1],t[i][2],t[i][3]),g[i]=i;\n    std::sort(t+1,t+n+1);\n    fur(i,1,n)t[i][0]=0;\n    rt=build(1,n,0);\n    fur(i,1,n)\n        id=i,as=0,ask(rt),\n        cmax(ans,++as),\n        on(rt);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 3769 [CH\u5f31\u7701\u80e1\u7b56R2]TATT/", "tags": ["kdt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1429 \u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\uff08\u52a0\u5f3a\u7248\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1429&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1429\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148: \u6784\u5efa`KDT`\n\n\u5bf9\u6bcf\u4e2a\u70b9\u5206\u522b\u8fdb\u884c\u67e5\u8be2,\u4e5f\u5c31\u662f\u641c\u7d22\n\n\u76f4\u63a5\u5bf9`KDT`\u8fdb\u884c\u904d\u5386\u6bcf\u6b21\u641c\u7d22\u7684\u590d\u6742\u5ea6\u662f`O(n)`\u7684,\u663e\u7136`TLE`\n\n\u8fd9\u65f6\u6211\u4eec\u9700\u8981\u4f30\u4ef7\u51fd\u6570,\u5728\u8fd9\u91cc\u4e5f\u5c31\u662f: \n\n\u4f30\u7b97\u51fa\u67e5\u8be2\u70b9\u5230\u5b50\u6811\u5bf9\u5e94\u7684\u957f\u65b9\u5f62\u4e2d\u7684\u70b9\u7684\"\u6700\u8fd1\u8ddd\u79bb\"\n\n\u82e5\"\u6700\u8fd1\u8ddd\u79bb\"\u5df2\u7ecf\u8d85\u8fc7\u4e86\u5f53\u524d\u7b54\u6848,\u5c31\u8df3\u8fc7\u5f53\u524d\u5b50\u6811.\n\n\u641c\u7d22\u65f6\u6bd4\u8f83\u5de6\u53f3\u5b50\u6811\u7684\"\u6700\u8fd1\u8ddd\u79bb\",\u5148\u641c\u7d22\"\u6700\u8fd1\u8ddd\u79bb\"\u5c0f\u7684\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef double db;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nconst int N=200011,inf=2122219134;\nint n,id,ls[N],rs[N];\ndb ans=2e18,L[N],R[N],D[N],U[N];\nstruct node{db x,y;}t[N];\nbool cmpx(node p,node q){return p.x<q.x;}\nbool cmpy(node p,node q){return p.y<q.y;}\ndb min(db x,db y){return x<y?x:y;}\ndb max(db x,db y){return x>y?x:y;}\nvoid upd(int x,int y){\n    L[x]=min(L[x],L[y]),R[x]=max(R[x],R[y]),\n    D[x]=min(D[x],D[y]),U[x]=max(U[x],U[y]);\n}\nvoid pu(int x){\n    L[x]=R[x]=t[x].x;\n    D[x]=U[x]=t[x].y;\n    if(ls[x])upd(x,ls[x]);\n    if(rs[x])upd(x,rs[x]);\n}\nint build(int l,int r){\n    if(l>r)return 0;\n    int m=l+r>>1;\n    db ax=0,ay=0,vx=0,vy=0;\n    fur(i,l,r)ax+=t[i].x,ay+=t[i].y;\n    ax/=(db)(r-l+1),ay/=(db)(r-l+1);\n    fur(i,l,r)\n        vx+=(ax-t[i].x)*(ax-t[i].x),\n        vy+=(ay-t[i].y)*(ay-t[i].y);\n    std::nth_element(t+l,t+m,t+r+1,vx>vy?cmpx:cmpy);\n    ls[m]=build(l,m-1),rs[m]=build(m+1,r),pu(m);\n    return m;\n}\ndb dis(int p){return (t[p].x-t[id].x)*(t[p].x-t[id].x)+(t[p].y-t[id].y)*(t[p].y-t[id].y);}\ndb f(int p){\n    db res=0;\n    if(L[p]>t[id].x)res+=(L[p]-t[id].x)*(L[p]-t[id].x);\n    if(R[p]<t[id].x)res+=(t[id].x-R[p])*(t[id].x-R[p]);\n    if(D[p]>t[id].y)res+=(D[p]-t[id].y)*(D[p]-t[id].y);\n    if(U[p]<t[id].y)res+=(t[id].y-U[p])*(t[id].y-U[p]);\n    return res;\n}\nvoid qry(int l,int r){\n    if(l>r)return;\n    int m=l+r>>1;\n    if(m!=id)ans=min(ans,dis(m));\n    if(l==r)return;\n    db ld=f(ls[m]),rd=f(rs[m]);\n    if(ld<rd){\n        if(ld<ans)qry(l,m-1);\n        if(rd<ans)qry(m+1,r);\n    }\n    else{\n        if(rd<ans)qry(m+1,r);\n        if(ld<ans)qry(l,m-1);\n    }\n}\nint main(){\n    scanf(\"%d\",&n);\n    fur(i,1,n)scanf(\"%lf%lf\",&t[i].x,&t[i].y);\n    build(1,n);\n    fur(i,1,n)id=i,qry(1,n);\n    printf(\"%.4f\\n\",sqrt(ans));\n}\n```\n", "link": "/posts/LG 1429 \u5e73\u9762\u6700\u8fd1\u70b9\u5bf9\uff08\u52a0\u5f3a\u7248\uff09/", "tags": ["kdt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2479 [SDOI2010]\u6349\u8ff7\u85cf", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2479&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2479\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i(x);i<=y;++i)\ntemplate <class T>il T ABS(T x){return x>0?x:-x;}\ntemplate <class T>il T MAX(T x,T y){return x>y?x:y;}\ntemplate <class T>il T MIN(T x,T y){return x<y?x:y;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,inf=2122219134;\nint n,rt,ls[N],rs[N],L[N],R[N],D[N],U[N],ans=inf;\nstruct node{int x,y;}t[N];\nbool cmpx(node a,node b){return a.x<b.x;}\nbool cmpy(node a,node b){return a.y<b.y;}\nvoid upd(int x,int y){\n    L[x]=MIN(L[x],L[y]),R[x]=MAX(R[x],R[y]),\n    D[x]=MIN(D[x],D[y]),U[x]=MAX(U[x],U[y]);\n}\nvoid pu(int x){\n    L[x]=R[x]=t[x].x,\n    D[x]=U[x]=t[x].y;\n    if(ls[x])upd(x,ls[x]);\n    if(rs[x])upd(x,rs[x]);\n}\nint build(int l,int r){\n    if(l>r)return 0;\n    int m=l+r>>1;\n    double ax=0,ay=0,vx=0,vy=0;\n    fur(i,l,r)ax+=t[i].x,ay+=t[i].y;\n    ax/=r-l+1,ay/=r-l+1;\n    fur(i,l,r)\n        vx+=ABS(ax-t[i].x),\n        vy+=ABS(ay-t[i].y);\n    nth_element(t+l,t+m,t+r+1,vx>vy?cmpx:cmpy);\n    ls[m]=build(l,m-1),rs[m]=build(m+1,r),pu(m);\n    return m;\n}\nint id,mi,mx;\nint dis(int p){return ABS(t[p].x-t[id].x)+ABS(t[p].y-t[id].y);}\nint fmi(int p){\n    return MAX(L[p]-t[id].x,0)+MAX(t[id].x-R[p],0)+\n           MAX(D[p]-t[id].y,0)+MAX(t[id].y-U[p],0);\n}\nint fmx(int p){\n    return MAX(ABS(L[p]-t[id].x),ABS(R[p]-t[id].x))+\n           MAX(ABS(D[p]-t[id].y),ABS(U[p]-t[id].y));\n}\nvoid qmi(int x){\n    if(!x)return;\n    if(x!=id)mi=MIN(mi,dis(x));\n    int ld=fmi(ls[x]),rd=fmi(rs[x]);\n    if(ld<rd){\n        if(ld<mi)qmi(ls[x]);\n        if(rd<mi)qmi(rs[x]);\n    }\n    else{\n        if(rd<mi)qmi(rs[x]);\n        if(ld<mi)qmi(ls[x]);\n    }\n}\nvoid qmx(int x){\n    if(!x)return;\n    if(x!=id)mx=MAX(mx,dis(x));\n    int ld=fmx(ls[x]),rd=fmx(rs[x]);\n    if(ld>rd){\n        if(ld>mx)qmx(ls[x]);\n        if(rd>mx)qmx(rs[x]);\n    }\n    else{\n        if(rd>mx)qmx(rs[x]);\n        if(ld>mx)qmx(ls[x]);\n    }\n}\nint main(){\n    in(n);\n    fur(i,1,n)in(t[i].x,t[i].y);\n    rt=build(1,n);\n    fur(i,1,n)\n        id=i,mi=inf,mx=-inf,\n        qmi(rt),qmx(rt),\n        ans=MIN(ans,mx-mi);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 2479 [SDOI2010]\u6349\u8ff7\u85cf/", "tags": ["kdt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4475 \u5de7\u514b\u529b\u738b\u56fd", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4475&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4475\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\ntypedef long long ll;typedef unsigned long long ull;typedef double db;typedef short sht;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\n#define fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define cpy(x,y) memcpy(x,y,sizeof(x))\n#define fin(s) freopen(s\".in\",\"r\",stdin)\n#define fout(s) freopen(s\".out\",\"w\",stdout)\n#define fcin ios::sync_with_stdio(false)\n#define l2(n) ((int)(log2(n)))\ntemplate <class T>il T ABS(T x){return x>0?x:-x;}\ntemplate <class T>il T MAX(T x,T y){return x>y?x:y;}\ntemplate <class T>il T MIN(T x,T y){return x<y?x:y;}\ntemplate <class T>il T GCD(T x,T y){return y?GCD(y,x%y):x;}\ntemplate <class T>il void SWAP(T &x,T &y){T t=x;x=y;y=t;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=50011,inf=2122219134;\nint n,q,rt,ls[N],rs[N],L[N],R[N],D[N],U[N];\nll s[N];\nstruct node{int x,y;ll v;}t[N];\nbool cmpx(node a,node b){return a.x<b.x;}\nbool cmpy(node a,node b){return a.y<b.y;}\nvoid upd(int x,int y){\n    L[x]=MIN(L[x],L[y]),R[x]=MAX(R[x],R[y]),\n    D[x]=MIN(D[x],D[y]),U[x]=MAX(U[x],U[y]);\n}\nvoid pu(int x){\n    L[x]=R[x]=t[x].x;\n    D[x]=U[x]=t[x].y;\n    if(ls[x])upd(x,ls[x]);\n    if(rs[x])upd(x,rs[x]);\n    s[x]=t[x].v+s[ls[x]]+s[rs[x]];\n}\nint build(int l,int r){\n    if(l>r)return 0;\n    int m=l+r>>1;\n    db ax=0,ay=0,vx=0,vy=0;\n    fur(i,l,r)ax+=t[i].x,ay+=t[i].y;\n    ax/=r-l+1,ay/=r-l+1;\n    fur(i,l,r)\n        vx+=(ax-t[i].x)*(ax-t[i].x),\n        vy+=(ay-t[i].y)*(ay-t[i].y);\n    nth_element(t+l,t+m,t+r+1,vx>vy?cmpx:cmpy);\n    ls[m]=build(l,m-1);\n    rs[m]=build(m+1,r);\n    pu(m);return m;\n}\nint A,B;ll C;\nint chk(int x,int y){return 1ll*A*x+1ll*B*y<C;}\nll ask(int x){\n    if(!x)return 0;\n    int f=chk(L[x],D[x])+chk(L[x],U[x])+chk(R[x],D[x])+chk(R[x],U[x]);\n    if(!f)return 0;\n    if(f==4)return s[x];\n    return (chk(t[x].x,t[x].y)?t[x].v:0)+ask(ls[x])+ask(rs[x]);\n}\nint main(){\n    in(n,q);\n    fur(i,1,n)in(t[i].x,t[i].y,t[i].v);\n    rt=build(1,n);\n    while(q--)in(A,B,C),out(ask(rt),ln);\n    flush();\n}\n```\n", "link": "/posts/LG 4475 \u5de7\u514b\u529b\u738b\u56fd/", "tags": ["kdt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4357 [CQOI2016]K\u8fdc\u70b9\u5bf9", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4357&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4357\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}void out(const char* s){while(*s)pt(*s++);}void out(char* s){while(*s)pt(*s++);}void out(char c){pt(c);}template<typename T>void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;const ll inf=1ll<<63;\nint rt,id,ls[N],rs[N];\nint L[N],R[N],D[N],U[N];\nstruct node{int x,y;}t[N];\nbool cmpx(node p,node q){return p.x<q.x;}\nbool cmpy(node p,node q){return p.y<q.y;}\ntemplate<class T>T min(T x,T y){return x<y?x:y;}\ntemplate<class T>T max(T x,T y){return x>y?x:y;}\nll sq(int x){return 1ll*x*x;}\nvoid upd(int x,int y){\n    L[x]=min(L[x],L[y]),R[x]=max(R[x],R[y]),\n    D[x]=min(D[x],D[y]),U[x]=max(U[x],U[y]);\n}\nvoid pu(int x){\n    L[x]=R[x]=t[x].x;\n    D[x]=U[x]=t[x].y;\n    if(ls[x])upd(x,ls[x]);\n    if(rs[x])upd(x,rs[x]);\n}\nint build(int l,int r){\n    if(l>r)return 0;\n    int m=l+r>>1;\n    double ax=0,ay=0,vx=0,vy=0;\n    fur(i,l,r)ax+=t[i].x,ay+=t[i].y;\n    ax/=r-l+1,ay/=r-l+1;\n    fur(i,l,r)\n        vx+=sq(ax-t[i].x),\n        vy+=sq(ay-t[i].y);\n    std::nth_element(t+l,t+m,t+r+1,vx>vy?cmpx:cmpy);\n    ls[m]=build(l,m-1);rs[m]=build(m+1,r);pu(m);\n    return m;\n}\nstd::priority_queue<ll,std::vector<ll>,std::greater<ll>>q;\nll dis(int x){return sq(t[x].x-t[id].x)+sq(t[x].y-t[id].y);}\nll f(int x){\n    return max(sq(L[x]-t[id].x),sq(R[x]-t[id].x))+\n           max(sq(D[x]-t[id].y),sq(U[x]-t[id].y));\n}\nvoid qry(int x){\n    if(!x)return;\n    ll res=dis(x),ld=inf,rd=inf;\n    if(x!=id&&res>q.top())q.pop(),q.push(res);\n    if(ls[x])ld=f(ls[x]);\n    if(rs[x])rd=f(rs[x]);\n    if(ld<rd){\n        if(ld>q.top())qry(ls[x]);\n        if(rd>q.top())qry(rs[x]);\n    }\n    else{\n        if(rd>q.top())qry(rs[x]);\n        if(ld>q.top())qry(ls[x]);\n    }\n}\nint main(){\n    int n,k;\n    in(n,k);\n    fur(i,1,n)in(t[i].x,t[i].y);\n    rt=build(1,n);\n    k<<=1;while(k--)q.push(-1);\n    fur(i,1,n)id=i,qry(rt);\n    printf(\"%lld\\n\",q.top());\n}\n```\n", "link": "/posts/LG 4357 [CQOI2016]K\u8fdc\u70b9\u5bf9/", "tags": ["kdt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2093 [\u56fd\u5bb6\u96c6\u8bad\u961f]JZPFAR", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2093&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2093\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\ntypedef long long ll;typedef unsigned long long ull;typedef double db;typedef short sht;\n#define fur(i,x,y) for(int i(x);i<=y;++i)\n#define fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define cpy(x,y) memcpy(x,y,sizeof(x))\n#define fin(s) freopen(s\".in\",\"r\",stdin)\n#define fout(s) freopen(s\".out\",\"w\",stdout)\n#define fcin ios::sync_with_stdio(false)\n#define l2(n) ((int)(log2(n)))\ntemplate <class T>il T ABS(T x){return x>0?x:-x;}\ntemplate <class T>il T MAX(T x,T y){return x>y?x:y;}\ntemplate <class T>il T MIN(T x,T y){return x<y?x:y;}\ntemplate <class T>il T GCD(T x,T y){return y?GCD(y,x%y):x;}\ntemplate <class T>il void SWAP(T &x,T &y){T t=x;x=y;y=t;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,inf=2122219134;\nint n,rt,cnt,siz[N],c[2][N],L[N],R[N],D[N],U[N];\n#define ls c[0][x]\n#define rs c[1][x]\nbool d[N];\ndb a=0.75;\nstruct node{int x,y,v;}t[N];\nbool cmpx(node p,node q){return p.x<q.x;}\nbool cmpy(node p,node q){return p.y<q.y;}\nvoid upd(int x,int y){\n    L[x]=MIN(L[x],L[y]),R[x]=MAX(R[x],R[y]),\n    D[x]=MIN(D[x],D[y]),U[x]=MAX(U[x],U[y]);\n}\nvoid pu(int x){\n    siz[x]=siz[ls]+siz[rs]+1;\n    L[x]=R[x]=t[x].x;\n    D[x]=U[x]=t[x].y;\n    if(ls)upd(x,ls);\n    if(rs)upd(x,rs);\n}\nint build(int l,int r){\n    if(l>r)return 0;\n    int m=l+r>>1,x=m;\n    db av1=0,av2=0,v1=0,v2=0;\n    fur(i,l,r)av1+=t[i].x,av2+=t[i].y;\n    av1/=r-l+1,av2/=r-l+1;\n    fur(i,l,r)\n        v1+=(av1-t[i].x)*(av1-t[i].x),\n        v2+=(av2-t[i].y)*(av2-t[i].y);\n    nth_element(t+l,t+m,t+r+1,(v1>v2)?cmpx:cmpy);\n    d[x]=v1>v2;\n    ls=build(l,m-1),rs=build(m+1,r);\n    pu(x);return x;\n}\nint qx,qy;\nstruct dat{\n    ll d;int id;\n    bool operator<(dat p)const{return d>p.d||(d==p.d&&id<p.id);}\n};\npriority_queue<dat>q;\nll dis(node p){return 1ll*(p.x-qx)*(p.x-qx)+1ll*(p.y-qy)*(p.y-qy);}\nll mxd(int x){\n    return MAX(1ll*(L[x]-qx)*(L[x]-qx),1ll*(R[x]-qx)*(R[x]-qx))+\n           MAX(1ll*(D[x]-qy)*(D[x]-qy),1ll*(U[x]-qy)*(U[x]-qy));\n}\nvoid ask(int x){\n    if(!x)return;\n    ll res=dis(t[x]),ld=0,rd=0;\n    if(res>q.top().d||(res==q.top().d&&t[x].v<q.top().id))\n        q.pop(),q.push(dat{res,t[x].v});\n    if(ls)ld=mxd(ls);\n    if(rs)rd=mxd(rs);\n    if(ld>rd){\n        if(ld>=q.top().d)ask(ls);\n        if(rd>=q.top().d)ask(rs);\n    }\n    else{\n        if(rd>=q.top().d)ask(rs);\n        if(ld>=q.top().d)ask(ls);\n    }\n}\nint main(){\n    in(n);\n    int m,x,y,k;\n    fur(i,1,n)in(x,y),t[i]=node{x,y,i};\n    rt=build(1,n);\n    in(m);\n    while(m--){\n        in(qx,qy,k);\n        while(!q.empty())q.pop();\n        while(k--)q.push(dat{-1,0});\n        ask(rt);\n        out(q.top().id,ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 2093 [\u56fd\u5bb6\u96c6\u8bad\u961f]JZPFAR/", "tags": ["kdt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4148 \u7b80\u5355\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4148&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4148\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n`k-d tree`\u6a21\u677f\n\n<!-- more -->\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#define I inline\n#define ll long long\nusing namespace std;\n\ntemplate <typename T>\nvoid read(T &x) {\n    x = 0; bool f = 0;\n    char c = getchar();\n    for (;!isdigit(c);c=getchar()) if (c=='-') f=1;\n    for (;isdigit(c);c=getchar()) x=x*10+(c^48);\n    if (f) x=-x;\n}\n\nconst int N = 200500;\nstruct node {\n\tint d[4];\n\tbool operator < (const node &k) const {\n\t\tfor (int i = 0;i < 4; i++) \n\t\t\tif (d[i] != k.d[i]) return d[i] < k.d[i];\n\t\treturn 0;\n\t}\n}p[N];\n\nint g[N], k;\n\nI bool cmp(int a, int b) {\n\treturn p[a].d[k] < p[b].d[k];\n}\n\n#define ls son[x][0]\n#define rs son[x][1]\n\nint son[N][2];\nint mx[N][3], mn[N][3], mxa[N], res[N], ans;\nI void Mn(int &x, int y) { if (x > y) x = y; }\nI void Mx(int &x, int y) { if (x < y) x = y; }\n\nI void maintain(int x) {\n\tfor (int i = 0;i <= 2; i++) {\n\t\tmx[x][i] = mn[x][i] = p[x].d[i+1];\n\t\tif (ls) Mx(mx[x][i], mx[ls][i]), Mn(mn[x][i], mn[ls][i]);\n\t\tif (rs) Mx(mx[x][i], mx[rs][i]), Mn(mn[x][i], mn[rs][i]);\n\t}\n}\nint build(int l, int r, int d) {\n\tif (l > r) return 0;\n\tint mid = (l + r) >> 1;\n\tk = d + 1, nth_element(g + l, g + mid, g + r + 1, cmp);\n\tson[g[mid]][0] = build(l, mid - 1, (d + 1) % 3);\n\tson[g[mid]][1] = build(mid + 1, r, (d + 1) % 3);\n\tmaintain(g[mid]); return g[mid];\n}\n\nint tmp;\n\n// \u5224\u65adx\u70b9\u662f\u5426\u5728y\u70b9\u8303\u56f4\u4ee5\u5185 \ninline bool in(int *x, int *y) {\n\tint cnt = 0;\n\tfor (int i = 0;i < 3; i++) cnt += (x[i] <= y[i]);\n\treturn cnt == 3;\n}\n\nvoid query(int x, int y) {\n\tif (mxa[x] <= tmp) return;\n\tif (!in(mn[x], p[y].d + 1)) return;\n\tif (in(mx[x], p[y].d + 1)) return tmp = mxa[x], void();\n\tif (in(p[x].d + 1, p[y].d + 1)) Mx(tmp, res[x]);\n\tif (ls) query(ls, y); if (rs) query(rs, y);\n}\n\n// \u6fc0\u6d3b\u64cd\u4f5c \nvoid upit(int x, int y) {\n\tif (x == y) {\n\t\tres[x] = tmp, Mx(mxa[x], res[x]); return;\n\t}\n\tif (!in(p[y].d + 1, mx[x]) || !in(mn[x], p[y].d + 1)) return;\n\t// \u5982\u679cy\u70b9\u4e0d\u5728\u91cc\u9762\u5c31\u8fd4\u56de \n\tif (ls) upit(ls, y); if (rs) upit(rs, y);\n\tMx(mxa[x], mxa[ls]), Mx(mxa[x], mxa[rs]);\n}\n\nint rt, n;\nint main() {\n\tfreopen (\"../in.in\",\"r\",stdin);\n\tread(n);\n\tfor (int i = 1;i <= n; i++) {\n\t\tread(p[i].d[0]), read(p[i].d[1]);\n\t\tread(p[i].d[2]), read(p[i].d[3]);\n\t\tg[i] = i;\n\t}\n\tsort(p + 1, p + n + 1); rt = build(1, n, 0);\n\tfor (int i = 1;i <= n; i++) \n\t\ttmp = 0, query(rt, i), tmp++, upit(rt, i), Mx(ans, tmp);\n\tcout << ans << endl;\n\treturn 0;\n}\n\n\n```\n", "link": "/posts/LG 4148 \u7b80\u5355\u9898/", "tags": ["kdt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3703 [SDOI2017]\u6811\u70b9\u6d82\u8272", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3703&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3703\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n`1 x`\u8868\u793a\u628a\u70b9$x$\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\u4e0a\u6240\u6709\u7684\u70b9\u67d3\u4e0a\u4e00\u79cd\u6ca1\u6709\u7528\u8fc7\u7684\u65b0\u989c\u8272\n\n\u4ece\u8fd9\u91cc\u53ef\u4ee5\u770b\u51fa\u6bcf\u79cd\u989c\u8272\u5728\u6811\u4e0a\u90fd\u662f\u4e00\u6761\u94fe\u7684\u5f62\u5f0f\u5b58\u5728\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u548c`LCT`\u5f88\u50cf\n\n\u90a3\u4e48`1`\u64cd\u4f5c\u53ef\u4ee5\u770b\u6210`access`\u64cd\u4f5c,(\u5982\u4f55\u64cd\u4f5c\u5148\u653e\u7740\n\n$x$\u5230\u6839\u7684\u989c\u8272\u79cd\u6570\u4e5f\u5c31\u662f\u8981\u7ecf\u8fc7\u7684\u865a\u8fb9\u7684\u6761\u6570,\u8bbe\u4e3a$S_x$\n\n\u6c42$x$\u5230$y$\u7684\u8def\u5f84\u7684\u6743\u503c,\u53ef\u4ee5\u4f7f\u7528\u6811\u4e0a\u5dee\u5206\u7684\u5f62\u5f0f\n\n\u4e5f\u5c31\u662f\u8f6c\u5316\u4e3a$S_x + S_y - 2\\times S_{lca(x,y)} + 1$\n\n`3`\u64cd\u4f5c\u4e5f\u5c31\u662f\u6c42\u5b50\u6811\u6700\u503c\n\n\u6211\u4eec\u56de\u8fc7\u5934\u6765\u770b`access`\u64cd\u4f5c:\n\n1. \u539f\u6765\u7684\u5b9e\u8fb9\u53d8\u865a,\u610f\u5473\u7740\u8981\u591a\u8d70\u4e00\u6761\u865a\u8fb9,\u5c06\u6b64\u94fe\u6240\u7ba1\u8f96\u7684\u533a\u57df\u5168\u90e8+1\n   \n2. \u865a\u8fb9\u53d8\u5b9e\u8fb9,\u610f\u5473\u7740\u8981\u591a\u5c11\u4e00\u6761\u865a\u8fb9,\u5c06\u6b64\u94fe\u6240\u7ba1\u8f96\u7684\u533a\u57df\u5168\u90e8-1\n\n\u6ce8\u610f: `LCT`\u4e2d`splay`\u7684\u7236\u5b50\u5173\u7cfb\u5e76\u4e0d\u662f\u539f\u6811\u4e2d\u7684\u7236\u5b50\u5173\u7cfb,\u8981\u627e\u5230\u8be5`splay`\u4e2d\u6df1\u5ea6\u6700\u5c0f\u7684\u8282\u70b9(\u4e5f\u5c31\u662f\u8fd9\u6761\u94fe\u7684\u9876\u7aef\u518d\u64cd\u4f5c)\n\n\u7efc\u4e0a\u53ef\u4ee5\u7528 lct+lca+dfs\u5e8f+\u7ebf\u6bb5\u6811 \u89e3\u51b3\n\n\u5f53\u7136\u4e5f\u53ef\u4ee5\u901a\u8fc7\u6811\u5256\u6a21\u62df`access`\u7684\u5f62\u5f0f\u6765\u89e3\u51b3\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i(x);i<=y;++i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\ntemplate <class T>il T MAX(T x,T y){return x>y?x:y;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,q,cnt,head[N],a[N];\nstruct seg{\n    #define ls rt<<1\n    #define rs rt<<1|1\n    #define pu s[rt]=MAX(s[ls],s[rs])\n    int s[N<<2],laz[N<<2];\n    void build(int l=1,int r=n,int rt=1){\n        if(l==r)return void(s[rt]=a[l]);\n        int m=l+r>>1;\n        build(l,m,ls);build(m+1,r,rs);\n        pu;\n    }\n    il void pd(int rt){\n        if(laz[rt]){\n            laz[ls]+=laz[rt];\n            laz[rs]+=laz[rt];\n            s[ls]+=laz[rt];\n            s[rs]+=laz[rt];\n            laz[rt]=0;\n        }\n    }\n    void upd(int L,int R,int v,int l=1,int r=n,int rt=1){\n        if(L<=l&&r<=R){\n            s[rt]+=v,laz[rt]+=v;\n            return;\n        }\n        int m=l+r>>1;\n        pd(rt);\n        if(L<=m)upd(L,R,v,l,m,ls);\n        if(R>m)upd(L,R,v,m+1,r,rs);\n        pu;\n    }\n    int ask(int L,int R,int l=1,int r=n,int rt=1){\n        if(L<=l&&r<=R)return s[rt];\n        int m=l+r>>1,ans=0;\n        pd(rt);\n        if(L<=m)ans=ask(L,R,l,m,ls);\n        if(R>m)ans=MAX(ans,ask(L,R,m+1,r,rs));\n        return ans;\n    }\n    il int operator[](int x){\n        int l=1,r=n,rt=1;\n        while(1){\n            if(l==r)return s[rt];\n            int m=l+r>>1;\n            pd(rt);\n            if(x<=m)r=m,rt=ls;\n            else l=m+1,rt=rs;\n        }\n    }\n    #undef ls\n    #undef rs\n}S;\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint siz[N],top[N],id[N],sz;\nstruct lct{\n    #define ls c[0][x]\n    #define rs c[1][x]\n    int f[N],c[2][N];\n    il int g(int x){return c[1][f[x]]==x;}\n    il int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\n    il void rotate(int x){\n        int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n        if(nrt(y))c[g(y)][z]=x;\n        c[r][x]=y,c[l][y]=w;\n        if(w)f[w]=y;\n        f[x]=z,f[y]=x;\n    }\n    il void splay(int x){\n        for(;nrt(x);rotate(x))if(nrt(f[x]))\n            rotate(g(x)^g(f[x])?x:f[x]);\n    }\n    il int frt(int x){while(ls)x=ls;return x;}\n    il void access(int x){\n        for(int y=0,t;x;x=f[y=x]){\n            splay(x);\n            if(rs)t=frt(rs),S.upd(id[t],id[t]+siz[t]-1,1);\n            if(rs=y)t=frt(y),S.upd(id[t],id[t]+siz[t]-1,-1);\n        }\n    }\n    #undef ls\n    #undef rs\n}T;\nint f[N],d[N];\nvoid dfs(int x){\n    siz[x]=1;d[x]=d[f[x]]+1;\n    fl(i,x)if(to!=f[x])\n        f[to]=T.f[to]=x,dfs(to),siz[x]+=siz[to];\n}\nvoid bt(int x,int tp){\n    top[x]=tp;a[id[x]=++sz]=d[x];int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nil int lca(int x,int y){\n    while(top[x]^top[y])\n        d[top[x]]>d[top[y]]?x=f[top[x]]:y=f[top[y]];\n    return d[x]<d[y]?x:y;\n}\nint main(){\n    in(n,q);\n    int opt,x,y;\n    fur(i,2,n)in(x,y),add(x,y),add(y,x);\n    dfs(1);bt(1,1);S.build();\n    while(q--){\n        in(opt,x);\n        if(opt==1)T.access(x);\n        else if(opt==2)\n            in(y),out(S[id[x]]+S[id[y]]-(S[id[lca(x,y)]]<<1)+1,ln);\n        else out(S.ask(id[x],id[x]+siz[x]-1),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3703 [SDOI2017]\u6811\u70b9\u6d82\u8272/", "tags": ["lct", "\u7ebf\u6bb5\u6811", "\u6811\u72b6\u6570\u7ec4", "dfs\u5e8f", "\u6811\u94fe\u5256\u5206", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4299 \u9996\u90fd", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4299&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4299\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nLCT\u7ef4\u62a4\u91cd\u5fc3\n\n\u8fd9\u91cc\u5229\u7528\u4e86\u4e24\u4e2a\u91cd\u5fc3\u6027\u8d28:\n\n1. \u6811\u4e2d\u6240\u6709\u70b9\u5230\u67d0\u4e2a\u70b9\u7684\u8ddd\u79bb\u548c\u4e2d,\u5230\u91cd\u5fc3\u7684\u8ddd\u79bb\u548c\u662f\u6700\u5c0f\u7684,\u5982\u679c\u6709\u4e24\u4e2a\u8ddd\u79bb\u548c,\u4ed6\u4eec\u7684\u8ddd\u79bb\u548c\u4e00\u6837\u3002\n   \n2. \u628a\u4e24\u68f5\u6811\u901a\u8fc7\u67d0\u4e00\u70b9\u76f8\u8fde\u5f97\u5230\u4e00\u9897\u65b0\u7684\u6811,\u65b0\u7684\u6811\u7684\u91cd\u5fc3\u5fc5\u7136\u5728\u8fde\u63a5\u539f\u6765\u4e24\u68f5\u6811\u91cd\u5fc3\u7684\u8def\u5f84\u4e0a\u3002\n\n\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u5b50\u6811\u7684\u5927\u5c0f\n\n\u5408\u5e76\u7684\u65f6\u5019\u8fde\u63a5\u4e24\u68f5\u6811,\u5206\u79bb\u51fa\u8fde\u63a5\u539f\u6765\u4e24\u68f5\u6811\u91cd\u5fc3\u7684\u8def\u5f84,\u5728\u94fe\u4e0a\u641c\u7d22\u51fa\u7b54\u6848\n\n\u65b9\u6cd5\u7c7b\u4f3c\u5e73\u8861\u6811\u7684\u67e5\u627e\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,q,s[N],s2[N],c[2][N],f[N],bl[N],ans;\nbool rev[N];\nint BL(int x){return x==bl[x]?x:(bl[x]=BL(bl[x]));}\n#define ls c[0][x]\n#define rs c[1][x]\nvoid pu(int x){s[x]=s[ls]+s[rs]+1+s2[x];}\nvoid pr(int x){rev[x]^=1;ls^=rs,rs^=ls,ls^=rs;}\nvoid pd(int x){\n    if(rev[x]){\n        if(ls)pr(ls);\n        if(rs)pr(rs);\n        rev[x]=0;\n    }\n}\nint g(int x){return c[1][f[x]]==x;}\nint nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nvoid rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nvoid pda(int x){if(nrt(x))pda(f[x]);pd(x);}\nvoid splay(int x){\n    for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n    pu(x);\n}\nvoid access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),s2[x]+=s[rs]-s[rs=y],pu(x);\n}\nvoid mrt(int x){access(x),splay(x),pr(x);}\nvoid link(int x,int y){\n    mrt(x),access(y),splay(y);\n    f[x]=y;\n    s2[y]+=s[x];\n    pu(y);\n}\nint find(int x){\n    bool ff=s[x]&1;\n    int sum=s[x]>>1,cl,cr,as=n+1,lsum=0,rsum=0;\n    while(x){\n        pd(x);\n        cl=s[ls]+lsum,cr=s[rs]+rsum;\n        if(cl<=sum&&cr<=sum){\n            if(ff)return x;\n            else if(as>x)as=x;\n        }\n        if(cl<cr)lsum+=s[ls]+s2[x]+1,x=rs;\n        else rsum+=s[rs]+s2[x]+1,x=ls;\n    }\n    return as;\n}\nint main(){\n    scanf(\"%d%d\",&n,&q);\n    for(int i=1;i<=n;++i)s[i]=1,bl[i]=i,ans^=i;\n    char opt[5];\n    int x,y;\n    while(q--){\n        scanf(\"%s\",opt);\n        if(opt[0]=='X')printf(\"%d\\n\",ans);\n        else if(opt[0]=='Q')\n            scanf(\"%d\",&x),\n            printf(\"%d\\n\",BL(x));\n        else{\n            scanf(\"%d%d\",&x,&y);\n            link(x,y);\n            x=BL(x),y=BL(y);\n            mrt(x),access(y),splay(y);\n            int z=find(y);\n            bl[x]=bl[y]=bl[z]=z;\n            ans^=x^y^z;\n            splay(z);\n        }\n    }\n}\n```\n", "link": "/posts/LG 4299 \u9996\u90fd/", "tags": ["lct", "\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP16549 QTREE6 - Query on a tree VI", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP16549&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP16549\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u89e3\u6cd5\u4e00\n\n\u5316\u8fb9\u4e3a\u70b9\n\n\u6bcf\u4e2a\u70b9\u7684\u7236\u8fb9\u8d4b\u4e88\u8be5\u70b9\u7684\u989c\u8272\u3002\u6211\u4eec\u9700\u8981\u4e24\u4e2aLCT,\u6bcf\u79cd\u5bf9\u5e94\u4e00\u4e2a\u989c\u8272\u3002\u4e00\u6761\u8fb9\u53ea\u6709\u5728\u5bf9\u5e94\u989c\u8272\u7684LCT\u4e2d\u624d\u4f1a\u88ab\u8fde\u4e0a\u3002\n\n\u63a5\u7740\u53ef\u4ee5\u53d1\u73b0,\u4fee\u6539\u4e00\u4e2a\u70b9\u7684\u989c\u8272,\u53ea\u9700\u8981\u5728\u539f\u6765\u989c\u8272\u5bf9\u5e94`LCT`\u4e2d\u65ad\u5f00\u7236\u8fb9,\u5728\u65b0\u989c\u8272`LCT`\u4e2d\u8fde\u63a5\u7236\u8fb9,\u5c31\u53ef\u4ee5\u7ef4\u62a4\u540c\u8272\u8fde\u901a\u5757\u4e86\n\n\u67e5\u8be2\u7684\u65f6\u5019\u53ea\u8981\u627e\u5230$x$\u6240\u5728`splay`\u7684\u6839,\u53f3\u5b50\u6811\u5927\u5c0f\u5c31\u662f\u7b54\u6848(\u76f8\u5f53\u4e8e\u8fb9\u7684\u6570\u76ee,\u6839\u7684\u6df1\u5ea6\u6700\u6d45,\u53ea\u6709\u53f3\u5b50\u6811)\n\n\u6ce8\u610f: 1\u8282\u70b9\u662f\u6ca1\u6709\u7236\u4eb2\u7684,\u4e0d\u8fc7\u4e3a\u4e86\u6a21\u578b\u7684\u5efa\u7acb,\u8981\u6709\u7236\u8fb9,\u4e8e\u662f\u9700\u8981\u52a0\u4e00\u4e2a\u865a\u70b9,\u8ba91\u7684\u7236\u4eb2\u6307\u5411\u5b83\u8fde\u8fb9\n\n\u624b\u52a8\u6a21\u62df\u4e00\u4e0b\u5e94\u8be5\u53ef\u4ee5\u61c2\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,q,cnt,head[N],fa[N],v[N];\nbool col[N];\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nstruct LCT{\n    int s[N],c[2][N],s2[N],f[N];\n    il void build(){for(int i=1;i<=n+1;++i)s[i]=1;}\n    #define ls c[0][x]\n    #define rs c[1][x]\n    il void pu(int x){s[x]=s[ls]+s[rs]+1+s2[x];}\n    il int g(int x){return c[1][f[x]]==x;}\n    il int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\n    il void rotate(int x){\n        int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n        if(nrt(y))c[g(y)][z]=x;\n        c[r][x]=y,c[l][y]=w;\n        if(w)f[w]=y;\n        f[x]=z,f[y]=x;\n        pu(y),pu(x);\n    }\n    il void splay(int x){\n        for(int y;nrt(x);rotate(x))if(nrt(y=f[x]))\n            rotate(g(x)^g(y)?x:y);\n        pu(x);\n    }\n    il void access(int x){for(int y=0;x;x=f[y=x])splay(x),s2[x]+=s[rs]-s[rs=y],pu(x);}\n    il void brt(int x){access(x),splay(x);}\n    il int frt(int x){\n        for(brt(x);ls;x=ls);\n        splay(x);return x;\n    }\n    il void link(int x){\n        splay(x);\n        int y=f[x]=fa[x];\n        brt(y);\n        c[1][y]=x,pu(y);\n    }\n    il void cut(int x){\n        brt(x);\n        ls=f[ls]=0;\n        pu(x);\n    }\n    il int ask(int x){return s[c[1][frt(x)]];}\n}T[2];\nvoid dfs(int x){\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to!=fa[x])fa[to]=x,dfs(to);\n    T[0].link(x);\n}\nint main(){\n    in(n);\n    T[0].build(),T[1].build();\n    int x,y;\n    for(int i=1;i<n;++i)in(x,y),add(x,y),add(y,x);\n    fa[1]=n+1;dfs(1);\n    in(q);\n    while(q--){\n        in(y,x);\n        if(y)T[col[x]].cut(x),T[col[x]^=1].link(x);\n        else out(T[col[x]].ask(x),ln);\n    }\n    flush();\n}\n```\n\n## \u89e3\u6cd52\n\n\u7c7b\u4f3cQTREE5\u7684\u505a\u6cd5\n\n\u8bb0\u5f55\u5b9e\u94fe\u9876\u7aef\u548c\u5e95\u7aef\u7684\u7b54\u6848\n\n\u8981\u4ed4\u7ec6\u8003\u8651`push up`\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=100011;\nint n,q,s[2][N],c[2][N],f[N],sl[N],sr[N],col[N],tc[N],lc[N],rc[N];\n#define ls c[0][x]\n#define rs c[1][x]\nvoid pu(int x){\n    sl[x]=sl[ls]+(((tc[ls]!=2&&col[x]==tc[ls])||!ls)?s[col[x]][x]+1+(lc[rs]==col[x]?sl[rs]:0):0);\n    sr[x]=sr[rs]+(((tc[rs]!=2&&col[x]==tc[rs])||!rs)?s[col[x]][x]+1+(rc[ls]==col[x]?sr[ls]:0):0);\n    lc[x]=ls?lc[ls]:col[x];\n    rc[x]=rs?rc[rs]:col[x];\n    if(tc[ls]==2||tc[rs]==2||(ls&&tc[ls]!=col[x])||(rs&&tc[rs]!=col[x]))tc[x]=2;\n    else tc[x]=col[x];\n}\nint g(int x){return c[1][f[x]]==x;}\nint nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nvoid rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nvoid splay(int x){\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nvoid access(int x){\n    for(int y=0;x;x=f[y=x]){\n        splay(x);\n        s[lc[rs]][x]+=sl[rs];\n        rs=y;\n        s[lc[y]][x]-=sl[y];\n        pu(x);\n    }\n}\nint cnt=0,head[N];\nstruct edge{int to,nxt;}e[N<<1];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x,int fa){\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    if(to!=fa){\n        dfs(to,x);\n        f[to]=x;s[lc[to]][x]+=sl[to];\n    }\n    pu(x);\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)sl[i]=sr[i]=1;\n    int x,y;\n    for(int i=1;i<n;++i){\n        scanf(\"%d%d\",&x,&y);\n        add(x,y),add(y,x);\n    }\n    dfs(1,0);\n    scanf(\"%d\",&q);\n    while(q--){\n        scanf(\"%d%d\",&y,&x);\n        access(x),splay(x);\n        if(y)col[x]^=1,pu(x);\n        else printf(\"%d\\n\",sr[x]);\n    }\n}\n```\n", "link": "/posts/LG SP16549 QTREE6 - Query on a tree VI/", "tags": ["lct"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP16580 QTREE7 - Query on a tree VII", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP16580&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP16580\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fd8\u662fQTREE6\u7684\u65b9\u6cd5\n\n\u4ece\u7ef4\u62a4\u5b50\u6811\u5927\u5c0f\u53d8\u6210\u4e86\u7ef4\u62a4\u5b50\u6811\u6700\u503c\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,inf=1000000000;\nusing std::multiset;\nint n,q,cnt,head[N],fa[N],v[N];\nbool col[N];\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nstruct LCT{\n    LCT(){s[0]=-inf;}\n    int s[N],c[2][N],f[N];\n    multiset<int>s2[N];\n    #define ls c[0][x]\n    #define rs c[1][x]\n    il int max(int x,int y){return x>y?x:y;}\n    il void pu(int x){\n        s[x]=max(max(s[ls],s[rs]),v[x]);\n        if(!s2[x].empty())s[x]=max(s[x],*s2[x].rbegin());\n    }\n    il int g(int x){return c[1][f[x]]==x;}\n    il int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\n    il void rotate(int x){\n        int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n        if(nrt(y))c[g(y)][z]=x;\n        c[r][x]=y,c[l][y]=w;\n        if(w)f[w]=y;\n        f[x]=z,f[y]=x;\n        pu(y),pu(x);\n    }\n    il void splay(int x){\n        for(int y;nrt(x);rotate(x))if(nrt(y=f[x]))\n            rotate(g(x)^g(y)?x:y);\n        pu(x);\n    }\n    il void access(int x){\n        for(int y=0;x;x=f[y=x]){\n            splay(x);\n            if(rs)s2[x].insert(s[rs]);\n            if(rs=y)s2[x].erase(s2[x].find(s[y]));\n            pu(x);\n        }\n    }\n    il void brt(int x){access(x),splay(x);}\n    il int frt(int x){\n        for(brt(x);ls;x=ls);\n        splay(x);return x;\n    }\n    il void link(int x){\n        splay(x);\n        int y=f[x]=fa[x];\n        brt(y);\n        c[1][y]=x,pu(y);\n    }\n    il void cut(int x){\n        brt(x);\n        ls=f[ls]=0;\n        pu(x);\n    }\n    il int ask(int x){return s[c[1][frt(x)]];}\n}T[2];\nvoid dfs(int x){\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n        if(to!=fa[x])fa[to]=x,dfs(to);\n    T[col[x]].link(x);\n}\nint main(){\n    in(n);\n    int x,y;\n    for(int i=1;i<n;++i)\n        in(x,y),\n        add(x,y),add(y,x);\n    for(int i=1;i<=n;++i)in(col[i]);\n    for(int i=1;i<=n;++i)in(v[i]);\n    fa[1]=n+1;dfs(1);\n    in(q);\n    while(q--){\n        in(y,x);\n        if(y==0)out(T[col[x]].ask(x),ln);\n        else if(y==1)T[col[x]].cut(x),T[col[x]^=1].link(x);\n        else{\n            T[0].brt(x),T[1].brt(x),\n            in(v[x]),\n            T[0].pu(x),T[1].pu(x);\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG SP16580 QTREE7 - Query on a tree VII/", "tags": ["lct"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4847 \u94f6\u6cb3\u82f1\u96c4\u4f20\u8bf4V2", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4847&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4847\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## fhqtreap\u505a\u6cd5\n\n\u5728\u666e\u901a`fhqtreap`\u7684\u57fa\u7840\u4e0a\u8bb0\u5f55\u8282\u70b9\u7684\u7236\u4eb2\n\n`M x y`: \u4e00\u76f4\u5411\u4e0a\u8d70\u5c31\u53ef\u4ee5\u627e\u5230\u6839,\u7136\u540e\u5408\u5e76\u5373\u53ef\n\n`D x`: \u6c42\u51fa$x$\u7684\u6392\u540d,\u7136\u540e\u6309\u6392\u540d\u5206\u88c2\u5373\u53ef\n\n`Q x y`: \u6c42\u51fa$x,y$\u6392\u540d,\u5206\u88c2,\u5f97\u51fa\u7b54\u6848,\u518d\u5408\u5e76\u56de\u53bb\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\ntypedef long long ll;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=200001;\nint n,q,ls[N],rs[N],f[N],rnd[N],v[N],sz[N];\nll s[N];\nil int rand(){static int seed=233;return seed=(int)seed*482711LL%n; }\nil void pu(int x){\n    s[x]=s[ls[x]]+s[rs[x]]+v[x];\n    sz[x]=sz[ls[x]]+sz[rs[x]]+1;\n    f[ls[x]]=f[rs[x]]=x;\n}\nvoid sl(int &x,int &y,int rt,int k){\n    if(!rt)return void(x=y=0);\n    if(sz[ls[rt]]>=k)y=rt,sl(x,ls[y],ls[y],k);\n    else x=rt,sl(rs[x],y,rs[x],k-sz[ls[x]]-1);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x|y;\n    if(rnd[x]<rnd[y]){\n        rs[x]=mg(rs[x],y);\n        pu(x);return x;\n    }\n    else{\n        ls[y]=mg(x,ls[y]);\n        pu(y);return y;\n    }\n}\nil int get(int x){\n    while(f[x])x=f[x];\n    return x;\n}\nil int rnk(int x){\n    int cnt=sz[ls[x]]+1;\n    while(x){\n        if(rs[f[x]]==x)cnt+=sz[ls[f[x]]]+1;\n        x=f[x];\n    }\n    return cnt;\n}\nint main(){\n    in(n,q);\n    for(int i=1;i<=n;++i)in(v[i]),s[i]=v[i],rnd[i]=rand(),sz[i]=1;\n    char opt;int x,y,z;\n    while(q--){\n        in(opt,x);\n        if(opt=='M'){\n            in(y),x=get(x),y=get(y);\n            if(x!=y)mg(y,x);\n        }\n        else if(opt=='D'){\n            int rt=get(x),rk=rnk(x);\n            sl(x,y,rt,rk-1);\n            f[x]=f[y]=0;\n        }\n        else if(opt=='Q'){\n            in(y);\n            int rt=get(x);\n            if(get(y)!=rt){out(\"-1\\n\");continue;}\n            else{\n                int rkx=rnk(x),rky=rnk(y);\n                if(rkx>rky)rkx^=rky,rky^=rkx,rkx^=rky;\n                sl(x,z,rt,rky);\n                sl(x,y,x,rkx-1);\n                out(s[y],ln);\n                mg(mg(x,y),z);\n            }\n        }\n    }\n    flush();\n}\n```\n\n## splay\u505a\u6cd5\n\n\u505a\u6cd5\u8be6\u89c1\u6ce8\u91ca\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\ntypedef long long ll;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=200001;\nint n,q,c[2][N],f[N],v[N];\nll s[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){s[x]=s[ls(x)]+s[rs(x)]+v[x];}\nil int g(int x){return rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(z)c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    //for(int y;y=f[x];rotate(x))if(f[y])\n    //    rotate(g(x)^g(y)?x:y);\n    while(f[x])rotate(x);//\u8fd9\u9898\u5355\u65cb\u66f4\u5feb\n}\nil void mg(int x,int y){\n    if(x==y)return;\n    splay(x),splay(y);\n    if(f[x])return;\n    //\u5c06x\u63a5\u5230y\u5b50\u6811\u4e2d\u6700\u53f3\u7aef\n    while(rs(y))y=rs(y);\n    f[rs(y)=x]=y;\n    pu(y);\n}\nil void cut(int x){splay(x),f[ls(x)]=0,ls(x)=0,pu(x);}//\u65ad\u5f00x\u4e0ex\u524d\u9762\u7684\nil ll ask(int x,int y){\n    if(x==y)return v[x];\n    ll l,r;\n    splay(x),l=s[ls(x)];\n    splay(y),r=s[ls(y)];\n    if(!f[x])return -1;\n    //\u6709\u53ef\u80fd\u51fa\u73b0\u7aef\u70b9\u524d\u540e\u98a0\u5012\u7684\u60c5\u51b5\n    if(l>r)return l-r+v[x];\n    else return r-l+v[y];\n}\nint main(){\n    in(n,q);\n    for(int i=1;i<=n;++i)in(v[i]);\n    char opt;int x,y,z;\n    while(q--){\n        in(opt,x);\n        if(opt=='M')in(y),mg(x,y);\n        else if(opt=='D')cut(x);\n        else if(opt=='Q')in(y),out(ask(x,y),ln);\n    }\n    flush();\n}\n```\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\ntypedef long long ll;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=200001;\nint n,q,c[2][N],f[N],v[N];\nll s[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){s[x]=s[ls(x)]+s[rs(x)]+v[x];}\nil int g(int x){return rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(z)c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    // for(int y;y=f[x];rotate(x))if(f[y])\n        // rotate(g(x)^g(y)?x:y);\n    while(f[x])rotate(x);\n}\nil void mg(int x,int y){\n    if(x==y)return;\n    splay(x),splay(y);\n    if(f[x])return;\n    while(rs(y))y=rs(y);\n    f[rs(y)=x]=y;\n    pu(y);\n}\nil void cut(int x){splay(x),f[ls(x)]=0,ls(x)=0,pu(x);}\nil ll ask(int x,int y){\n    if(x==y)return v[x];\n    ll l,r;\n    splay(x),l=s[ls(x)];\n    splay(y),r=s[ls(y)];\n    if(!f[x])return -1;\n    if(l>r)return l-r+v[x];\n    else return r-l+v[y];\n}\nint main(){\n    in(n,q);\n    for(int i=1;i<=n;++i)in(v[i]);\n    char opt;int x,y,z;\n    while(q--){\n        in(opt,x);\n        if(opt=='M')in(y),mg(x,y);\n        else if(opt=='D')cut(x);\n        else if(opt=='Q')in(y),out(ask(x,y),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 4847 \u94f6\u6cb3\u82f1\u96c4\u4f20\u8bf4V2/", "tags": ["lct", "\u5e76\u67e5\u96c6", "splay", "fhqtreap"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4180 [BJWC2010]\u4e25\u683c\u6b21\u5c0f\u751f\u6210\u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4180&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4180\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n`LCT`\u52a8\u6001\u7ef4\u62a4\u6700\u5c0f\u751f\u6210\u6811\n\n\u7ef4\u62a4\u94fe\u4e0a\u7684\u6700\u5927\u503c\u548c\u6b21\u5927\u503c\n\n\u5148\u627e\u51fa\u6700\u5c0f\u751f\u6210\u6811,\u7136\u540e\u679a\u4e3e\u5269\u4e0b\u7684\u8fb9,\u627e\u51fa\u76f8\u5dee\u6700\u5c0f\u7684,\u5f97\u51fa\u7b54\u6848\n\n\u8fd9\u9898\u8fd8\u53ef\u4ee5\u7528kruskal\u751f\u6210\u6811+\u500d\u589e(\u6216\u6811\u5256)\u505a,\u5e38\u6570\u4f1a\u5c0f\u5f88\u591a\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\nil int min(int x,int y){return x<y?x:y;}\nil int max(int x,int y){return x>y?x:y;}\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nconst int N=100001;\nint n,m,s[N<<1],S[N<<1],c[2][N<<1],f[N<<1],v[N<<1];\nbool rev[N<<1];\n#define ls c[0][x]\n#define rs c[1][x]\nil void pu(int x){\n    if(s[ls]>s[rs])s[x]=s[ls],S[x]=max(S[ls],s[rs]);\n    else if(s[rs]>s[ls])s[x]=s[rs],S[x]=max(s[ls],S[rs]);\n    else s[x]=s[ls],S[x]=max(S[ls],S[rs]);\n\n    if(v[x]>s[x])S[x]=s[x],s[x]=v[x];\n    else if(v[x]!=s[x]&&v[x]>S[x])S[x]=v[x];\n}\nil void pr(int x){rev[x]^=1,ls^=rs,rs^=ls,ls^=rs;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls)pr(ls);\n        if(rs)pr(rs);\n        rev[x]=0;\n    }\n}\nil int g(int x){return c[1][f[x]]==x;}\nil int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nvoid pda(int x){if(nrt(x))pda(f[x]);pd(x);}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),rs=y,pu(x);\n}\nil void mrt(int x){access(x),splay(x),pr(x);}\nstruct edge{\n    int x,y,w;\n    bool operator<(edge t){return w<t.w;}\n}e[300001];\nint fa[N];\nint gf(int x){return x==fa[x]?x:(fa[x]=gf(fa[x]));}\nint main(){\n    in(n,m);\n    for(int i=1;i<=m;++i)in(e[i].x,e[i].y,e[i].w);\n    std::sort(e+1,e+m+1);\n    long long tot=0;int x,y,id=n,ans=-1u>>1;\n    for(int i=1;i<=n;++i)fa[i]=i;\n    for(int i=1;i<=m;++i){\n        x=e[i].x,y=e[i].y;\n        if(gf(x)!=gf(y)){\n            fa[fa[x]]=fa[y];\n            tot+=e[i].w;\n            v[++id]=e[i].w;\n            mrt(x),mrt(y),f[x]=f[y]=id;\n        }\n        else{\n            mrt(x),access(y),splay(y);\n            ans=min(ans,e[i].w-(e[i].w>s[y]?s[y]:S[y]));\n        }\n    }\n    printf(\"%lld\\n\",tot+ans);\n}\n```\n", "link": "/posts/LG 4180 [BJWC2010]\u4e25\u683c\u6b21\u5c0f\u751f\u6210\u6811/", "tags": ["lct", "kruskal", "\u6811\u94fe\u5256\u5206", "\u500d\u589e"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "BZ 3626 LNOI2014 LCA", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://remmina.github.io/BZPRO/JudgeOnline/3626.html&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://remmina.github.io/BZPRO/JudgeOnline/3626.html\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6c42$\\sum_{i=l}^r deep[LCA(i,z)]$\n\n\u9996\u5148,\u53ef\u4ee5\u628a\u8be2\u95ee\u62c6\u6210\u4e24\u4e2a\u90e8\u5206\u76f8\u51cf$\\sum_{i=1}^r deep[LCA(i,z)]-\\sum_{i=1}^{l-1} deep[LCA(i,z)]$\n\n\u8003\u8651\u4e00\u79cd\u66b4\u529b\u89e3\u6cd5: \u628a$1-r$\u5230\u6839\u7684\u8def\u5f84\u5168\u90e8+1,\u518d\u67e5\u8be2$z$\u5230\u6839\u7684\u8def\u5f84\u548c\u5c31\u662f\u7b54\u6848\n\n\u53ef\u4ee5\u53d1\u73b0\u95ee\u9898\u7684\u7b54\u6848\u662f\u53ef\u4ee5\u53e0\u52a0\u6c42\u51fa\u7684\n\n\u5bb9\u6613\u60f3\u5230\u6392\u5e8f\u540e\u79bb\u7ebf\u5904\u7406\n\n\u7528\u6811\u5256\u6216`LCT`\u6c42\u89e3\u90fd\u53ef\u4ee5\n\n\u8fd9\u91cc\u91c7\u7528\u6811\u5256+\u6811\u72b6\u6570\u7ec4\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=50011,P=201314;\nint n,q,cnt=0,head[N];\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint f[N],top[N],siz[N],id[N],sz;\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)dfs(to),siz[x]+=siz[to];\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;int k=n;\n    fl(i,x)if(siz[to]>siz[k])k=to;\n    if(k==n)return;bt(k,tp);\n    fl(i,x)if(to!=k)bt(to,to);\n}\nint s[N],S[N];\nil void mod(int &x){while(x>=P)x-=P;}\nil int mo(int x){return x>=P?x%P:x;}\nil void upd(int x,int v){\n    for(int i=x--;i<=n;i+=i&-i)\n        s[i]+=v,mod(S[i]+=x*v);\n}\nil int ask(int x){\n    int res=0,RES=0;\n    for(int i=x;i;i-=i&-i)\n        mod(res+=s[i]),mod(RES+=S[i]);\n    return mo(1ll*x*res%P-RES+P);\n}\nil void upd(int l,int r,int v){upd(l,v),upd(r+1,-v);}\nil int ask(int l,int r){return mo(ask(r)-ask(l-1)+P);}\nil int ASK(int x){\n    int res=0;\n    while(top[x])mod(res+=ask(id[top[x]],id[x])),x=f[top[x]];\n    return mo(res+ask(id[x]));\n}\nint ans[N];\nstruct que{int x,z,v,id;bool operator<(que t)const{return x<t.x;}}Q[N<<1];\nil void u(int x){\n    while(top[x])upd(id[top[x]],id[x],1),x=f[top[x]];\n    upd(id[0],id[x],1);\n}\nint main(){\n    in(n,q);\n    for(int i=1;i<n;++i)in(f[i]),add(f[i],i);\n    dfs(0);bt(0,0);\n    int l,r,z;\n    for(int i=0;i<q;++i){\n        in(l,r,z);\n        Q[i<<1]={l-1,z,-1,i};\n        Q[i<<1|1]={r,z,1,i};\n    }\n    std::sort(Q,Q+(q<<1));\n    for(int i=0,j=-1;i<(q<<1);++i){\n        while(j<Q[i].x)u(++j);\n        mod(ans[Q[i].id]+=Q[i].v*ASK(Q[i].z));\n    }\n    for(int i=0;i<q;++i)out(mo(ans[i]+P),ln);\n    flush();\n}\n```\n", "link": "/posts/BZ 3626 LNOI2014 LCA/", "tags": ["lct", "\u6811\u94fe\u5256\u5206", "\u79bb\u7ebf", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "BZ 4998 \u661f\u7403\u8054\u76df", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://remmina.github.io/BZPRO/JudgeOnline/4998.html&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://remmina.github.io/BZPRO/JudgeOnline/4998.html\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=200001;\nint n,m,q,s[N],c[2][N],f[N],bl[N];\nbool rev[N];\nint BL(int x){return bl[x]==x?x:(bl[x]=BL(bl[x]));}\n#define ls c[0][x]\n#define rs c[1][x]\nil void pr(int x){rev[x]^=1,ls^=rs,rs^=ls,ls^=rs;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls)pr(ls);\n        if(rs)pr(rs);\n        rev[x]=0;\n    }\n}\nil int g(int x){return c[1][f[x]]==x;}\nil int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n}\nvoid pda(int x){if(nrt(x))pda(f[x]);pd(x);}\nil void splay(int x){\n    for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){for(int y=0;x;x=f[y=x]=BL(f[x]))splay(x),rs=y;}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls;pd(x),x=ls);\n    splay(x);return x;\n}\nint tmp;\nvoid set(int x,int y){if(x)tmp+=s[x],bl[x]=y,set(ls,x),set(rs,x);}\nil int mg(int x,int y){\n    if(x==y)return 1;\n    mrt(x);\n    if(frt(y)!=x){f[x]=y;return 0;}\n    else{\n        tmp=0,\n        set(rs,x),rs=0,\n        s[x]+=tmp;\n        return 1;\n    }\n}\nint main(){\n    in(n,m,q);\n    int x,y;\n    for(int i=1;i<=n;++i)s[i]=1,bl[i]=i;\n    for(int i=1;i<=m;++i)in(x,y),mg(BL(x),BL(y));\n    while(q--){\n        in(x,y);\n        x=BL(x),y=BL(y);\n        if(mg(x,y))out(s[x],ln);\n        else out(\"No\\n\");\n    }\n    flush();\n}\n```\n", "link": "/posts/BZ 4998 \u661f\u7403\u8054\u76df/", "tags": ["lct"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "BZ 2959 \u957f\u8dd1", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://remmina.github.io/BZPRO/JudgeOnline/2959.html&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://remmina.github.io/BZPRO/JudgeOnline/2959.html\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nlct\u7f29\u70b9\n\n\u548c[LG 2542 \\[AHOI2005\\]\u822a\u7ebf\u89c4\u5212](https://www.luogu.com.cn/problem/P2542)\u6709\u70b9\u50cf\n\n\u7f29\u70b9\u7684\u65f6\u5019\u987a\u4fbf\u548c\u5e76\u6240\u6709\u70b9\u7684\u4fe1\u606f\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\nil int min(int x,int y){return x<y?x:y;}\nil int max(int x,int y){return x>y?x:y;}\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=150011,inf=2122219134;\nint n,q,s[N],f[N],c[2][N],v[N],bl[N],a[N];\nbool rev[N];\nint BL(int x){return bl[x]==x?x:(bl[x]=BL(bl[x]));}\n#define ls c[0][x]\n#define rs c[1][x]\nil void pu(int x){s[x]=s[ls]+s[rs]+v[x];}\nil void pr(int x){rev[x]^=1,ls^=rs,rs^=ls,ls^=rs;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls)pr(ls);\n        if(rs)pr(rs);\n        rev[x]=0;\n    }\n}\nil int g(int x){return c[1][f[x]]==x;}\nil int nrt(int x){return c[0][f[x]]==x||c[1][f[x]]==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nvoid pda(int x){if(nrt(x))pda(f[x]);pd(x);}\nil void splay(int x){\n    for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x]=BL(f[x]))\n        splay(x),rs=y,pu(x);\n}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls;pd(x),x=ls);\n    splay(x);return x;\n}\nint tmp;\nvoid get(int x,int y){\n    if(x)tmp+=v[x],bl[x]=y,get(ls,x),get(rs,x);\n}\nint main(){\n    in(n,q);\n    for(int i=1;i<=n;++i)in(a[i]),s[i]=v[i]=a[i],bl[i]=i;\n    int opt,x,y;\n    while(q--){\n        in(opt,x,y);\n        if(opt==1){\n            x=BL(x),y=BL(y);\n            if(x==y)continue;\n            mrt(x);\n            if(frt(y)!=x)f[x]=y;\n            else tmp=0,get(rs,x),rs=0,v[x]+=tmp,pu(x);\n        }\n        if(opt==2){\n            mrt(BL(x));\n            v[BL(x)]+=y-a[x];\n            s[BL(x)]+=y-a[x];\n            a[x]=y;\n        }\n        if(opt==3){\n            x=BL(x),y=BL(y);\n            mrt(x);\n            if(frt(y)!=x)out(-1,ln);\n            else out(s[x],ln);\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/BZ 2959 \u957f\u8dd1/", "tags": ["lct"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP2939 QTREE5 - Query on a tree V", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP2939&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP2939\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6839\u636e\u5957\u8def,\u7528`LCT`\u7ef4\u62a4\u5b50\u6811,\u4fe1\u606f\u4e3a\u6700\u503c,\u6bcf\u4e2a\u8282\u70b9\u90fd\u5f00\u4e00\u4e2a`multiset`\u6765\u8bb0\u5f55\u865a\u5b50\u6811\u4fe1\u606f\n\n\u601d\u8003`LCT`\u7684\u5b9a\u4e49,\u6bcf\u4e2a`splay`\u7ef4\u62a4\u7684\u662f\u4e00\u6761\u6df1\u5ea6\u5355\u8c03\u9012\u589e\u7684\u94fe(\u4e5f\u53ef\u4ee5\u8bf4\u662f\u5b9e\u94fe)\n\n\u6211\u4eec\u5b9a\u4e49`lm[x],rm[x]`\u5206\u522b\u4e3a\u6bcf\u6761\u5b9e\u94fe\u7684\u4e0a\u7aef\u548c\u4e0b\u7aef\u80fd\u591f\u5230\u8fbe\u6700\u8fd1\u7684\u767d\u70b9\u7684\u8ddd\u79bb\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u65b9\u4fbf\u5730\u66f4\u65b0\u4fe1\u606f\u4e86\n\n\u6bcf\u6b21\u6c42\u89e3\u53ef\u4ee5`access(x),splay(x)`,\u7136\u540e$x$\u5c31\u662f\u6811\u6839\u6240\u5728\u5b9e\u94fe\u7684\u4e0b\u7aef,\u8f93\u51fa`rm[x]`\u5c31\u53ef\u4ee5\u4e86\n\n\u8fd9\u6837\u4e0d\u9700\u8981\u6362\u6839\u4ec0\u4e48\u7684,\u4e5f\u5c31\u4e0d\u9700\u8981\u7ffb\u8f6c\u64cd\u4f5c,\u7701\u53bb\u4e86\u590d\u6742\u7684pushdown\u8fc7\u7a0b\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,inf=1000000000;\nint n,q,siz[N],c[2][N],f[N],lm[N],rm[N];\nbool rev[N],col[N];\nusing std::multiset;\nmultiset<int>s2[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil int min(int x,int y){return x<y?x:y;}\nil void pu(int x){\n    siz[x]=siz[ls(x)]+siz[rs(x)]+1;\n    int t=s2[x].empty()?inf:*s2[x].begin();\n    lm[x]=min(lm[ls(x)],siz[ls(x)]+min(col[x]?0:inf,min(t,lm[rs(x)]+1)));\n    rm[x]=min(rm[rs(x)],siz[rs(x)]+min(col[x]?0:inf,min(t,rm[ls(x)]+1)));\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[y]=x,f[x]=z;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x]){\n        splay(x);\n        s2[x].insert(lm[rs(x)]+1);\n        rs(x)=y;\n        multiset<int>::iterator it=s2[x].lower_bound(lm[rs(x)]+1);\n        if(it!=s2[x].end()&&(*it)==lm[rs(x)]+1)s2[x].erase(it);\n        pu(x);\n    }\n}\nstruct edge{int to,nxt;}e[N<<1];\nint cnt=0,head[N];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x,int fa){\n    for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    if(to!=fa){\n        f[to]=x;s2[x].insert(inf+1);pu(x);\n        dfs(to,x);\n    }\n}\nint main(){\n    in(n);\n    lm[0]=rm[0]=inf;\n    int opt,x,y;\n    for(int i=1;i<n;++i)in(x,y),add(x,y),add(y,x);\n    dfs(1,0);\n    in(q);\n    while(q--){\n        in(opt,x);\n        access(x),splay(x);\n        if(!opt)col[x]^=1,pu(x);\n        else out(rm[x]>n?-1:rm[x],ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG SP2939 QTREE5 - Query on a tree V/", "tags": ["lct"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4219 [BJOI2014]\u5927\u878d\u5408", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4219&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4219\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5bb9\u6613\u770b\u51fa$x,y$\u5207\u65ad\u540e,$x$\u7684\u5b50\u6811\u5927\u5c0f\u4e58\u4e0a$y$\u7684\u5b50\u6811\u5927\u5c0f\u5c31\u662f\u7b54\u6848\n\n\u7528`LCT`\u7ef4\u62a4\u5b50\u6811\u5927\u5c0f\u5373\u53ef\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,q,siz[N],siz2[N],c[2][N],f[N];\nbool rev[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){siz[x]=siz[ls(x)]+siz[rs(x)]+1+siz2[x];}\nil void pr(int x){rev[x]^=1;int t=ls(x);ls(x)=rs(x),rs(x)=t;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nvoid pda(int x){\n    if(nrt(x))pda(f[x]);\n    pd(x);\n}\nil void splay(int x){\n    for(pda(x);nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),siz2[x]+=siz[rs(x)]-siz[rs(x)=y],pu(x);\n}\nil void mrt(int x){access(x),splay(x),pr(x);}\nint main(){\n    in(n,q);\n    for(int i=1;i<=n;++i)siz[i]=1;\n    char opt;int x,y;\n    while(q--){\n        in(opt,x,y);\n        if(opt=='A')\n            mrt(x),mrt(y),\n            siz2[f[x]=y]+=siz[x];\n        else{\n            mrt(x),access(y),splay(y);  \n            f[x]=ls(y)=0,pu(x);\n            mrt(x),mrt(y);\n            out((long long)siz[x]*siz[y],ln);\n            siz2[f[x]=y]+=siz[x];\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 4219 [BJOI2014]\u5927\u878d\u5408/", "tags": ["lct", "\u7edf\u8ba1", "\u5b50\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4234 \u6700\u5c0f\u5dee\u503c\u751f\u6210\u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4234&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4234\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6309\u8fb9\u6743\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u540e,\u4f9d\u6b21\u6dfb\u52a0\u8fb9\n\n\u95ee\u9898\u8f6c\u5316\u4e3a\u4e86: \n\n\u6bcf\u6b21\u52a0\u8fb9\u7684\u65f6\u5019,\n\n\u5982\u679c\u4e24\u70b9\u4e3a\u8fde\u901a,\u5219\u52a0\u8fb9\n\n\u5426\u5219\u5728\u76ee\u524d\u7684\u751f\u6210\u6811\u4e0a\u627e\u5230\u8fb9\u6743\u6700\u5c0f\u7684\u8fb9, \u5e76\u66ff\u6362\u4e3a\u65b0\u8fb9\n\n\u53ef\u4ee5\u7528`LCT`\u7ef4\u62a4\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nil int min(int x,int y){return x<y?x:y;}\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nconst int N=250001,inf=-1u>>1;\nint n,m,rev[N],c[2][N],f[N],s[N];\nstruct edge{int x,y,w;bool operator<(edge t){return w<t.w;}}e[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){s[x]=min(x>n?x:inf,min(s[ls(x)],s[rs(x)]));}\nil void pr(int x){rev[x]^=1;int t=ls(x);ls(x)=rs(x),rs(x)=t;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nint st[N];\nil void splay(int x){\n    int z=0,y=st[++z]=x;\n    while(nrt(y))st[++z]=y=f[y];\n    while(z)pd(st[z--]);\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){for(int y=0;x;x=f[y=x])splay(x),rs(x)=y,pu(x);}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls(x);pd(x),x=ls(x));\n    splay(x);return x;\n}\nil void link(int x,int y){mrt(x),f[x]=y;}\nbool b[N];\nint main(){\n    s[0]=inf;\n    in(n,m);\n    for(int i=1;i<=m;++i)in(e[i].x,e[i].y,e[i].w);\n    std::sort(e+1,e+m+1);\n    int x,y,t=n,tt=0,p=1,ans=inf;\n    for(int i=1;i<=m;++i){\n        x=e[i].x,y=e[i].y;++t;\n        if(x==y){b[i]=1;continue;}\n        mrt(x);\n        if(frt(y)!=x)f[f[x]=t]=y,++tt;\n        else{\n            mrt(x),access(y),splay(y);\n            int now=s[y];\n            b[now-n]=1;splay(now);\n            f[ls(now)]=f[rs(now)]=0;\n            link(x,t),link(t,y);\n        }\n        while(b[p]&&p<=i)++p;\n        if(tt>=n-1)ans=min(ans,e[i].w-e[p].w);\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 4234 \u6700\u5c0f\u5dee\u503c\u751f\u6210\u6811/", "tags": ["lct"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2542 [AHOI2005]\u822a\u7ebf\u89c4\u5212", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2542&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2542\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ecf\u5178\u7684`link-cut tree`\u7ef4\u62a4\u8fde\u901a\u5206\u91cf\n\n\u9996\u5148\u770b\u5230\u8fd9\u79cd\u9898\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u5012\u5e8f\u6dfb\u52a0\n\n\u5047\u8bbe\u6bcf\u4e2a\u70b9\u4ee3\u8868\u4e00\u4e2a\u53cc\u8fde\u901a\u5206\u91cf,\u90a3\u4e48\u4e24\u4e2a\u70b9\u4e4b\u95f4\u7684\u5173\u952e\u8def\u5f84\u6570\u5c31\u662f\u94fe\u957f-1\n\n\u53ef\u4ee5\u7528`LCT`+\u5e76\u67e5\u96c6\u6765\u7ef4\u62a4\n\n\u8fde\u63a5\u4e00\u6761\u8fb9:\n\n1. \u4e24\u7aef\u5728\u540c\u4e00\u4e2a\u53cc\u8fde\u901a\u5206\u91cf\u4e2d: \u4ec0\u4e48\u90fd\u4e0d\u7528\u5e72\n   \n2. \u4e24\u7aef\u8fd8\u672a\u8fde\u901a: \u76f4\u63a5`link`\n\n3. \u4e24\u7aef\u5df2\u7ecf\u8054\u901a: \u7f29\u70b9\n   \n   \u5c06\u8fde\u63a5\u4e24\u7aef\u7684\u8def\u5f84\u63d0\u53d6\u51fa\u6765,\u5408\u5e76\u8fd9\u4e9b\u70b9\n\n<!-- more -->\n\n```cpp\nint BL(int x){return bl[x]==x?x:(bl[x]=BL(bl[x]));}//\u5e76\u67e5\u96c6\nvoid set(int x,int y){if(x)bl[x]=y,set(ls(x),x),set(rs(x),x);}\nvoid mg(int x,int y){\n    if(x==y)return;//\u5728\u540c\u4e00\u4e2a\u53cc\u8fde\u901a\u5206\u91cf\n    mrt(x);\n    if(frt(y)!=x){f[x]=y;return;}//\u672a\u8fde\u901a\n\n    /*\n    \u5728find root\u7684\u8fc7\u7a0b\u4e2d\u5df2\u7ecfaccess(y)\u63d0\u51fa\u4e86x\u5230y\u7684\u8def\u5f84\n    \u6211\u4eec\u73b0\u5728\u53ea\u9700\u8981\u628ax\u7684\u5b50\u6811\u7684\u5e76\u67e5\u96c6\u7956\u5148\u90fd\u6539\u6210x,\u7136\u540e\u65ad\u5f00x\u4e0e\u5b50\u6811\u7684\u8fde\u63a5\u5373\u53ef\n    */\n    set(rs(x),x),rs(x)=0,pu(x);\n}\nvoid access(int x){\n    /*\n    \u7f29\u70b9\u7684\u65f6\u5019x\u7684\u5b50\u6811\u6307\u7a7a\u4e86,\u6211\u4eec\u9700\u8981\u5728access\u7684\u65f6\u5019\u63a5\u56de\u53bb\n\n    \u8fd9\u6837\u539f\u672c\u8fde\u63a5\u94fe\u4e0a\u5176\u4ed6\u8282\u70b9\u7684access\u540e\u90fd\u4f1a\u6307\u5411x\u4e86\n    */\n    for(int y=0;x;x=f[y=x]=BL(f[x]))\n        splay(x),rs(x)=y,pu(x);\n}\n```\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nil void swap(int &x,int &y){x^=y,y^=x,x^=y;}\nconst int N=30011,M=100011;\nint n,m,s[N],c[2][N],f[N],st[N],bl[N];\nbool rev[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){s[x]=s[ls(x)]+s[rs(x)]+1;}\nil void pr(int x){swap(ls(x),rs(x));rev[x]^=1;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[y]=x,f[x]=z;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    int z=0,y=st[++z]=x;\n    while(nrt(y))st[++z]=y=f[y];\n    while(z)pd(st[z--]);\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nint BL(int x){return bl[x]==x?x:(bl[x]=BL(bl[x]));}\nil void access(int x){for(int y=0;x;x=f[y=x]=BL(f[x]))splay(x),rs(x)=y,pu(x);}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls(x);pd(x),x=ls(x));\n    splay(x);return x;\n}\nil void sl(int x,int y){mrt(x),access(y),splay(y);}\nvoid set(int x,int y){if(x)bl[x]=y,set(ls(x),x),set(rs(x),x);}\nil void mg(int x,int y){\n    if(x==y)return;\n    mrt(x);\n    if(frt(y)!=x){f[x]=y;return;}\n    set(rs(x),x),rs(x)=0,pu(x);\n}\n#include<bits/extc++.h>\nusing namespace __gnu_pbds;\ngp_hash_table<int,bool>vis[N];\nint X[M],Y[M],A[M],B[M],O[M],ans[M];\nint main(){\n    in(n,m);\n    int c,x,y,q;\n    for(int i=1;i<=n;++i)s[i]=1,bl[i]=i;\n    for(int i=1;i<=m;++i){\n        in(X[i],Y[i]);\n        if(X[i]>Y[i])swap(X[i],Y[i]);\n    }\n    for(q=1;in(O[q]),~O[q];++q){\n        in(x,y);\n        if(x>y)swap(x,y);\n        if(!O[q])vis[x][y]=1;\n        A[q]=x,B[q]=y;\n    }\n    for(int i=1;i<=m;++i)if(!vis[X[i]][Y[i]])mg(BL(X[i]),BL(Y[i]));\n    for(c=0,--q;q;--q){\n        x=BL(A[q]),y=BL(B[q]);\n        if(O[q])sl(x,y),ans[++c]=s[y]-1;\n        else mg(x,y);\n    }\n    while(c)out(ans[c--],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 2542 [AHOI2005]\u822a\u7ebf\u89c4\u5212/", "tags": ["lct", "\u5f3a\u8fde\u901a\u5206\u91cf"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1501 [\u56fd\u5bb6\u96c6\u8bad\u961f]Tree II", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1501&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1501\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,P=51061;\n#define int long long\nint n,q,s[N],siz[N],v[N],c[2][N],f[N],st[N],add[N],mul[N];\nbool rev[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){\n    s[x]=(s[ls(x)]+s[rs(x)]+v[x])%P;\n    siz[x]=siz[ls(x)]+siz[rs(x)]+1;\n}\nil void pr(int x){int t=ls(x);ls(x)=rs(x);rs(x)=t;rev[x]^=1;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n    if(mul[x]^1){\n        if(ls(x)){\n            mul[ls(x)]=mul[ls(x)]*mul[x]%P;\n            add[ls(x)]=add[ls(x)]*mul[x]%P;\n            s[ls(x)]=s[ls(x)]*mul[x]%P;\n            v[ls(x)]=v[ls(x)]*mul[x]%P;\n        }\n        if(rs(x)){\n            mul[rs(x)]=mul[rs(x)]*mul[x]%P;\n            add[rs(x)]=add[rs(x)]*mul[x]%P;\n            s[rs(x)]=s[rs(x)]*mul[x]%P;\n            v[rs(x)]=v[rs(x)]*mul[x]%P;\n        }\n        mul[x]=1;\n    }\n    if(add[x]){\n        if(ls(x)){\n            add[ls(x)]=(add[ls(x)]+add[x])%P;\n            s[ls(x)]=(s[ls(x)]+add[x]*siz[ls(x)]%P)%P;\n            v[ls(x)]=(v[ls(x)]+add[x])%P;\n        }\n        if(rs(x)){\n            add[rs(x)]=(add[rs(x)]+add[x])%P;\n            s[rs(x)]=(s[rs(x)]+add[x]*siz[rs(x)]%P)%P;\n            v[rs(x)]=(v[rs(x)]+add[x])%P;\n        }\n        add[x]=0;\n    }\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    int z=0,y=st[++z]=x;\n    while(nrt(y))st[++z]=y=f[y];\n    while(z)pd(st[z--]);\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(f[x])^g(x)?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),rs(x)=y,pu(x);\n}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls(x);pd(x),x=ls(x));\n    splay(x);return x;\n}\nil void link(int x,int y){\n    mrt(x);\n    if(frt(y)^x)f[x]=y;\n}\nil void sl(int x,int y){mrt(x),access(y),splay(y);}\nil void cut(int x,int y){\n    mrt(x);\n    if(frt(y)==x&f[y]==x&&!ls(y))\n        f[y]=rs(x)=0,pu(x);\n}\nsigned main(){\n    in(n,q);\n    int x,y,c;char opt;\n    for(int i=1;i<=n;++i)mul[i]=1,siz[i]=1,v[i]=1;\n    for(int i=2;i<=n;++i)in(x,y),link(x,y);\n    while(q--){\n        in(opt,x,y);\n        if(opt=='+')\n            in(c),sl(x,y),\n            s[y]=(s[y]+c*siz[y]%P)%P,v[y]=(v[y]+c)%P,\n            add[y]=(add[y]+c)%P;\n        if(opt=='-')cut(x,y),in(x,y),link(x,y);\n        if(opt=='*'){\n            in(c),sl(x,y),\n            s[y]=s[y]*c%P,v[y]=v[y]*c%P;\n            add[y]=add[y]*c%P,\n            mul[y]=mul[y]*c%P;\n        }\n        if(opt=='/')sl(x,y),out(s[y],ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 1501 [\u56fd\u5bb6\u96c6\u8bad\u961f]Tree II/", "tags": ["lct"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3690 \u3010\u6a21\u677f\u3011Link Cut Tree \uff08\u52a8\u6001\u6811\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3690&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3690\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=100011;\nint n,m,s[N],v[N],c[2][N],f[N],st[N];\nbool rev[N];\n#define ls(x) c[0][x]\n#define rs(x) c[1][x]\nil void pu(int x){s[x]=s[ls(x)]^s[rs(x)]^v[x];}\nil void pr(int x){int t=ls(x);ls(x)=rs(x);rs(x)=t;rev[x]^=1;}\nil void pd(int x){\n    if(rev[x]){\n        if(ls(x))pr(ls(x));\n        if(rs(x))pr(rs(x));\n        rev[x]=0;\n    }\n}\nil int g(int x){return rs(f[x])==x;}\nil int nrt(int x){return ls(f[x])==x||rs(f[x])==x;}\nil void rotate(int x){\n    int y=f[x],z=f[y],l=g(x),r=!l,w=c[r][x];\n    if(nrt(y))c[g(y)][z]=x;\n    c[r][x]=y,c[l][y]=w;\n    if(w)f[w]=y;\n    f[x]=z,f[y]=x;\n    pu(y),pu(x);\n}\nil void splay(int x){\n    int z=0,y=st[++z]=x;\n    while(nrt(y))st[++z]=y=f[y];\n    while(z)pd(st[z--]);\n    for(;nrt(x);rotate(x))if(nrt(f[x]))\n        rotate(g(x)^g(f[x])?x:f[x]);\n}\nil void access(int x){\n    for(int y=0;x;x=f[y=x])\n        splay(x),rs(x)=y,pu(x);\n}\nil void mrt(int x){access(x),splay(x),pr(x);}\nil int frt(int x){\n    for(access(x),splay(x);ls(x);pd(x),x=ls(x));\n    splay(x);return x;\n}\nil void link(int x,int y){\n    mrt(x);\n    if(frt(y)^x)f[x]=y;\n}\nil void sl(int x,int y){mrt(x),access(y),splay(y);}\nil void cut(int x,int y){\n    mrt(x);\n    if(frt(y)==x&&f[y]==x&&!ls(y))\n        f[y]=rs(x)=0,pu(x);\n}\nint main(){\n    in(n,m);\n    for(int i=1;i<=n;++i)in(v[i]);\n    int opt,x,y;\n    while(m--){\n        in(opt,x,y);\n        if(opt==0)sl(x,y),out(s[y],ln);\n        if(opt==1)link(x,y);\n        if(opt==2)cut(x,y);\n        if(opt==3)splay(x),v[x]=y;\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3690 \u3010\u6a21\u677f\u3011Link Cut Tree \uff08\u52a8\u6001\u6811\uff09/", "tags": ["\u6a21\u677f", "lct"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4390 [BOI2007]Mokia \u6469\u57fa\u4e9a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4390&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4390\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u6811\u5957\u6811\u89e3\u6cd5\n\n\u6b64\u9898\u5bf9\u6811\u5957\u6811\u7231\u597d\u8005\u6781\u4e0d\u53cb\u597d\uff01\n\n\u9996\u5148\u9ad8\u9ad8\u5174\u5174\u5730\u5199\u4e86\u4e2a\u6811\u72b6\u6570\u7ec4\u5957\u52a8\u6001\u5f00\u70b9\u6743\u503c\u7ebf\u6bb5\u6811,\u53d1\u73b0MLE\u4e86,\u591a\u6b21\u8c03\u6574\u7a7a\u95f4\u540e\u53d1\u73b0\u8981\u4e48re\u8981\u4e48mle,\u96be\u9053\u53ea\u80fd\u7528cdq\u5206\u6cbb\u6216k-dtree\u4e86\u5417\uff1f\n\n\u597d\u4e0d\u5bb9\u6613\u5199\u5b8c\u7684\u4ee3\u7801\u820d\u4e0d\u5f97\u968f\u4fbf\u5220\u6389\n\n\u65e2\u7136\u5361\u7a7a\u95f4,\u90a3\u6211\u79bb\u6563\u5316\u5750\u6807,\u518d\u628a\u6811\u72b6\u6570\u7ec4\u4e5f\u6539\u6210\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\u8fd8\u4e0d\u884c\u5417\uff1f \u8fd8\u771f\u4e0d\u884c\n\n\u6211\u611f\u5230\u4e86\u8fd9\u9898\u6df1\u6df1\u7684\u6076\u6bd2\n\n\u53ea\u80fd\u52a8\u7528\u9ed1\u79d1\u6280\u4e86\uff01\n\n\"\u7ebf\u6bb5\u6811\u7684\u538b\u7f29\u8def\u5f84\",\u5982\u679c\u6ca1\u6709\u8be2\u95ee\u8981\u8bbf\u95ee\u8fd9\u4e2a\u8282\u70b9,\u90a3\u5c31\u4e0d\u7ee7\u7eed\u5411\u4e0b\u5f00\u70b9,\u4ee5\u8282\u7ea6\u7a7a\u95f4\uff01\n\n\u5185\u5c42\u548c\u5916\u5c42\u90fd\u5f00,\u7ec8\u4e8e\u901a\u8fc7\u4e86\u8fd9\u9053\u6076\u6bd2\u7684\u9898\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=2000011,M=6000011;\nint n,m,sz,SZ,RT,rt[M],s[M],ls[M],rs[M],LS[M],RS[M];\nstruct laz{int x,v;}laz[M];\nstruct LAZ{int x,y,v;}LAZ[M];\nstruct que{int opt,x,y,X,Y,a;}Q[N];\nstruct node{int v,id,typ;bool operator<(node t){return v<t.v;}}b[N<<1],B[N<<1];\nvoid upd(int x,int v,int l,int r,int &o){\n    if(!o)o=++sz;\n    s[o]+=v;\n    if(l==r)return;\n    if(laz[o].x){\n        int m=l+r>>1;\n        if(laz[o].x<=m)upd(laz[o].x,laz[o].v,l,m,ls[o]);\n        else upd(laz[o].x,laz[o].v,m+1,r,rs[o]);\n    }\n    laz[o]={x,v};\n}\nint ask(int L,int R,int l,int r,int o){\n    if(!o)return 0;\n    if(L<=l&&r<=R)return s[o];\n    int m=l+r>>1,ans=0;\n    if(laz[o].x){\n        if(laz[o].x<=m)upd(laz[o].x,laz[o].v,l,m,ls[o]);\n        else upd(laz[o].x,laz[o].v,m+1,r,rs[o]);\n        laz[o]={0,0};\n    }\n    if(L<=m)ans=ask(L,R,l,m,ls[o]);\n    if(R>m)ans+=ask(L,R,m+1,r,rs[o]);\n    return ans;\n}\nvoid UPD(int x,int y,int v,int l,int r,int &o){\n    if(!o)o=++SZ;\n    upd(y,v,1,m,rt[o]);\n    if(l==r)return;\n    if(LAZ[o].x){\n        int m=l+r>>1;\n        if(LAZ[o].x<=m)UPD(LAZ[o].x,LAZ[o].y,LAZ[o].v,l,m,LS[o]);\n        else UPD(LAZ[o].x,LAZ[o].y,LAZ[o].v,m+1,r,RS[o]);\n    }\n    LAZ[o]={x,y,v};\n}\nint ASK(int x,int y,int X,int Y,int l=1,int r=n,int o=1){\n    if(!o)return 0;\n    if(x<=l&&r<=X)return ask(y,Y,1,m,rt[o]);\n    int m=l+r>>1,ans=0;\n    if(LAZ[o].x){\n        int m=l+r>>1;\n        if(LAZ[o].x<=m)UPD(LAZ[o].x,LAZ[o].y,LAZ[o].v,l,m,LS[o]);\n        else UPD(LAZ[o].x,LAZ[o].y,LAZ[o].v,m+1,r,RS[o]);\n        LAZ[o]={0,0,0};\n    }\n    if(x<=m)ans=ASK(x,y,X,Y,l,m,LS[o]);\n    if(X>m)ans+=ASK(x,y,X,Y,m+1,r,RS[o]);\n    return ans;\n}\nint main(){\n    int x,y,X,Y,a,opt,d=0,D=0,q=0;\n    in(x,y);\n    while(1){\n        in(opt);if(opt==3)break;\n        ++q;\n        if(opt==1){\n            in(x,y,a);\n            b[++d]={x,q,0};\n            B[++D]={y,q,0};\n        }\n        else{\n            in(x,y,X,Y);\n            b[++d]={x,q,0};\n            b[++d]={X,q,1};\n            B[++D]={y,q,0};\n            B[++D]={Y,q,1};\n        }\n        Q[q]={opt,x,y,X,Y,a};\n    }\n    std::sort(b+1,b+d+1);std::sort(B+1,B+D+1);b[0].v=B[0].v=-(1<<30);\n    fur(i,1,d)(b[i].typ?Q[b[i].id].X:Q[b[i].id].x)=n+=b[i].v!=b[i-1].v;\n    fur(i,1,D)(B[i].typ?Q[B[i].id].Y:Q[B[i].id].y)=m+=B[i].v!=B[i-1].v;\n    fur(i,1,q){\n        x=Q[i].x,y=Q[i].y,X=Q[i].X,Y=Q[i].Y;a=Q[i].a;\n        if(Q[i].opt==1)UPD(x,y,a,1,n,RT);\n        else out(ASK(x,y,X,Y),ln);\n    }\n    flush();\n}\n```\n\n## CDQ\u89e3\u6cd5\n\n\u8fd9\u9898\u8fd8\u662f\u62ff\u6765\u7ec3CDQ\u597d\n\n\u53ef\u4ee5\u5bb9\u65a5\u4e00\u4e0b:\n\n\u8bbe$S_{X,Y}$\u4e3a$(1,1)$\u5230$X,Y$\n\n$(X_1,Y_1)$\u5230$(X_2,Y_2)$\u8f6c\u5316\u4e3a$S_{X_2,Y_2}-S_{X_1-1,Y_2}-S_{X_2,Y_1-1}+S_{X_1-1,X_2-1}$\n\n\u7136\u540e\u5c31\u662f\u7ecf\u5178\u7684CDQ\u5206\u6cbb\u89e3\u51b3\u4e09\u4f4d\u6570\u70b9\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i(x);i<=y;++i)\nil void cmax(int &x,int y){x=x>y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=2000001;\nint n,ans[N],s[N];\nstruct que{\n    int typ,id,x,y,v;\n    il bool operator<(que t){return x<t.x;}\n}Q[N],T[N];\nil void add(int x,int v){for(;x<=n;x+=x&-x)s[x]+=v;}\nil int ask(int x){int res=0;for(;x;x^=x&-x)res+=s[x];return res;}\nvoid cdq(int l,int r){\n    if(l>=r)return;\n    int m=l+r>>1,j=l;\n    cdq(l,m),cdq(m+1,r);\n    fur(i,m+1,r)if(!Q[i].typ){\n        for(;j<=m&&Q[j].x<=Q[i].x;++j)if(Q[j].typ)add(Q[j].y,Q[j].v);\n        ans[Q[i].id]+=Q[i].v*ask(Q[i].y);\n    }\n    fur(i,l,j-1)if(Q[i].typ)add(Q[i].y,-Q[i].v);\n    for(int i=l,p=l,q=m+1;i<=r;++i)\n        if(p>m)T[i]=Q[q++];\n        else if(q>r)T[i]=Q[p++];\n        else T[i]=Q[p]<Q[q]?Q[p++]:Q[q++];\n    fur(i,l,r)Q[i]=T[i];\n}\nint main(){\n    int x,y,X,Y,a,opt,q=0,d=0;\n    in(x,y);\n    while(1){\n        in(opt);if(opt==3)break;\n        if(opt==1)in(x,y,a),Q[++q]={1,0,x,y,a},cmax(n,y);\n        else in(x,y,X,Y),++d,\n        Q[++q]={0,d,X,Y,1},\n        Q[++q]={0,d,X,y-1,-1},\n        Q[++q]={0,d,x-1,Y,-1},\n        Q[++q]={0,d,x-1,y-1,1},\n        cmax(n,y),cmax(n,Y);\n    }\n    cdq(1,q);\n    fur(i,1,d)out(ans[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 4390 [BOI2007]Mokia \u6469\u57fa\u4e9a/", "tags": ["\u6811\u72b6\u6570\u7ec4", "\u6811\u5957\u6811", "\u7ebf\u6bb5\u6811", "cdq\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4175 [CTSC2008]\u7f51\u7edc\u7ba1\u7406", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4175&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4175\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n**\u6811\u94fe\u5256\u5206**\u5957**\u6811\u5957\u6811**\n\n\u8fd9\u91cc\u7684**\u6811\u5957\u6811**\u4f7f\u7528**\u6811\u72b6\u6570\u7ec4**\u5957**\u52a8\u6001\u5f00\u70b9\u6743\u503c\u7ebf\u6bb5\u6811**\u5b9e\u73b0,\u8981\u5148\u79bb\u6563\u5316\n\n\u6211\u7684\u65b9\u6cd5\u7b97\u662f\u6709\u70b9\u7b28\u4f46\u662f\u597d\u5199\u7684\u65b9\u6cd5\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i(x);i<=y;++i)\n#define fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=80011;\nint n,q,cnt,nn,a[N],head[N],c[N<<1];\nstruct node{int v,id,typ;bool operator<(node t){return v<t.v;}}b[N<<1];\nstruct que{int k,x,y;}Q[N];\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint siz[N],top[N],f[N],d[N],id[N],sz;\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(f[x]^to){\n        d[to]=d[x]+1;\n        f[to]=x;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;int k=0;\n    fl(i,x)if(to^f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint RT[N],s[N*400],ls[N*400],rs[N*400];\nvoid upd(int x,int v,int l,int r,int &rt){\n    if(!rt)rt=++sz;\n    s[rt]+=v;\n    if(l==r)return;\n    int m=l+r>>1;\n    if(x<=m)upd(x,v,l,m,ls[rt]);\n    else upd(x,v,m+1,r,rs[rt]);\n}\nint tl[400],tr[400],cl,cr;\nil void get(int l,int r){\n    for(int i=l-1;i;i^=i&-i)tl[++cl]=RT[i];\n    for(int i=r;i;i^=i&-i)tr[++cr]=RT[i];\n}\nil void ask(int x,int y,int k){\n    cl=cr=0;\n    int t=0;\n    while(top[x]^top[y]){\n        if(d[top[x]]<d[top[y]])x^=y,y^=x,x^=y;\n        t+=id[x]-id[top[x]]+1;get(id[top[x]],id[x]),x=f[top[x]];\n    }\n    if(id[x]>id[y])x^=y,y^=x,x^=y;\n    get(id[x],id[y]);\n    t+=id[y]-id[x]+1;\n    if(t<k){out(\"invalid request!\\n\");return;}\n    int l=1,r=nn;\n    while(l<r){\n        int m=l+r>>1,sum=0;\n        fur(i,1,cl)sum-=s[rs[tl[i]]];\n        fur(i,1,cr)sum+=s[rs[tr[i]]];\n        if(k<=sum){\n            fur(i,1,cl)tl[i]=rs[tl[i]];\n            fur(i,1,cr)tr[i]=rs[tr[i]];\n            l=m+1;\n        }\n        else{\n            fur(i,1,cl)tl[i]=ls[tl[i]];\n            fur(i,1,cr)tr[i]=ls[tr[i]];\n            k-=sum,r=m;\n        }\n    }\n    out(c[l],ln);\n}\nint main(){\n    in(n,q);\n    int k,x,y,t=0;\n    fur(i,1,n)in(a[i]),b[++t]={a[i],i,0};\n    fur(i,2,n)in(x,y),add(x,y),add(y,x);\n    fur(i,1,q){\n        in(k,x,y);\n        if(!k)b[++t]={y,i,1};\n        Q[i]={k,x,y};\n    }\n    sort(b+1,b+t+1);b[0].v=-(1<<30);\n    fur(i,1,t)c[(b[i].typ?Q[b[i].id].y:a[b[i].id])=nn+=b[i].v!=b[i-1].v]=b[i].v;\n    dfs(1);bt(1,1);\n    fur(i,1,n)for(int j=id[i];j<=n;j+=j&-j)upd(a[i],1,1,nn,RT[j]);\n    fur(i,1,q){\n        k=Q[i].k,x=Q[i].x,y=Q[i].y;\n        if(!k){\n            for(int j=id[x];j<=n;j+=j&-j)upd(a[x],-1,1,nn,RT[j]);\n            a[x]=y;\n            for(int j=id[x];j<=n;j+=j&-j)upd(a[x],1,1,nn,RT[j]);\n        }\n        else ask(x,y,k);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 4175 [CTSC2008]\u7f51\u7edc\u7ba1\u7406/", "tags": ["\u6811\u5957\u6811", "\u6811\u94fe\u5256\u5206", "\u6811\u72b6\u6570\u7ec4", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3380 \u3010\u6a21\u677f\u3011\u4e8c\u903c\u5e73\u8861\u6811\uff08\u6811\u5957\u6811\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3380&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3380\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6b64\u9898\u975e\u5e38\u4e4b\u6bd2\u7624,\u6211\u5199\u7684\u6574\u4e2a\u4eba\u90fd\u4e8c\u903c\u4e86\n\n\u5171\u6709\u4e00\u4e0b\u51e0\u79cd\u89e3\u6cd5:\n\n1. \u6811\u72b6\u6570\u7ec4\u5957\u7ebf\u6bb5\u6811\n2. \u7ebf\u6bb5\u6811\u5957\u5e73\u8861\u6811\n3. \u6743\u503c\u7ebf\u6bb5\u6811\u5957\u5e73\u8861\u6811\n4. \u5206\u5757\n5. \u6574\u4f53\u4e8c\u5206\n\n## \u6811\u72b6\u6570\u7ec4\u5957\u7ebf\u6bb5\u6811\n\n\u79bb\u6563\u5316+\u6811\u72b6\u6570\u7ec4\u5957\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\n\n\u8fd9\u5e94\u8be5\u662f\u4e00\u79cd\u5e38\u6570\u5c0f\u53c8\u597d\u5199\u7684\u65b9\u6cd5\u4e86,\u4e0d\u5f00o2\u4e5f\u8f7b\u677e\u8fc7\n\n\u53ef\u4ee5\u53c2\u7167[LG 2617 Dynamic Rankings](https://www.luogu.com.cn/problem/P2617)\u7684\u505a\u6cd5\n\n\u7b80\u8981\u8bf4\u4e0b\u601d\u8def:\n\n\u6811\u72b6\u6570\u7ec4\u8bb0\u5f55\u4f4d\u7f6e,\u6743\u503c\u7ebf\u6bb5\u6811\u8bb0\u5f55\u6743\u503c\n\n\u6811\u72b6\u6570\u7ec4\u7684\u6bcf\u4e2a\u8282\u70b9\u90fd\u662f\u4e00\u9897\u6743\u503c\u7ebf\u6bb5\u6811\n\n1. \u67e5\u8be2\u533a\u95f4\u5185\u4e00\u4e2a\u6570\u7684\u6392\u540d: \n   \n   \u5728\u6811\u72b6\u6570\u7ec4\u4e0a\u627e\u5230\u533a\u95f4\u5bf9\u5e94\u7684\u8282\u70b9,\u5bf9\u5e94\u7684\u6743\u503c\u7ebf\u6bb5\u6811\u7ebf\u6bb5\u6811\u6811\u5185\u67e5\u8be2\u5bf9\u5e94\u6570\u7684\u6392\u540d\u5e76\u6c42\u548c\u3002\n   \n2. \u67e5\u8be2\u533a\u95f4\u5185\u6392\u540d\u4e3ak\u7684\u6570\u662f\u51e0:\n      \n   \u627e\u51fa\u6811\u72b6\u6570\u7ec4\u4e2d\u6240\u6709\u5bf9\u5e94\u8282\u70b9,\u7136\u540e\u6743\u503c\u7ebf\u6bb5\u6811\u4e0a\u4e8c\u5206(\u4e0e\u4e3b\u5e2d\u6811\u7684\u65b9\u6cd5\u76f8\u4f3c)\n\n3. \u5355\u70b9\u4fee\u6539: \n   \n   \u76f8\u5f53\u4e8e\u6811\u72b6\u6570\u7ec4\u4e0a\u7684\u5355\u70b9\u4fee\u6539,\u5728\u5bf9\u5e94\u8282\u70b9\u7684\u6743\u503c\u7ebf\u6bb5\u6811\u4e2d\u5220\u9664\u539f\u6570,\u52a0\u5165\u65b0\u6570\n\n4. \u524d\u9a71:\n   \n   \u67e5\u8be2\u6392\u540d,\u7136\u540e\u627e\u6392\u540d-1\u7684\u6570\n\n5. \u540e\u7ee7:\n   \n   \u67e5\u8be2\u6392\u540d,\u7136\u540e\u627e\u6392\u540d+1\u7684\u6570\n\n\u8bed\u6587\u4e0d\u597d,\u4e0d\u5927\u4f1a\u8868\u8ff0,\u76f8\u4fe1\u6570\u636e\u7ed3\u6784\u8fd9\u79cd\u4e1c\u897f\u76f4\u63a5\u770b\u4ee3\u7801\u66f4\u597d\u7406\u89e3\n\n\u5177\u4f53\u53ef\u4ee5\u770b\u4ee3\u7801\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\n#define N 50011\nint n,q,tot,sz,a[N],c[N<<1],RT[N],s[N*400],ls[N*400],rs[N*400];\nstruct que{int opt,l,r,k;}Q[N];\nstruct node{int v,id,typ;bool operator<(node t)const{return v<t.v;}}b[N<<1];\nvoid upd(int x,int v,int l,int r,int &rt){\n    if(!rt)rt=++sz;\n    s[rt]+=v;\n    if(l==r){return;}\n    int m=l+r>>1;\n    if(x<=m)upd(x,v,l,m,ls[rt]);\n    else upd(x,v,m+1,r,rs[rt]);\n}\nil void UPD(int x,int v){for(int i=x;i<=n;i+=i&-i)upd(a[x],v,1,tot,RT[i]);}\nint tl[20],tr[20];\nil int rnk(int l,int r,int v,int t=0){//\u8fd8\u662f\u4e8c\u5206,\u52a0\u4e86\u4e2a\u7279\u5224(\u53ef\u4ee5\u662f\u8fd9\u4e2a\u6570\u7684\u7b2c\u4e00\u4e2a\u6216\u6700\u540e\u4e00\u4e2a\u7684\u6392\u540d)\n    int cl=0,cr=0,m,res=0;\n    //\u83b7\u53d6\u533a\u95f4\u5bf9\u5e94\u7684\u6240\u6709\u6839\u8282\u70b9\u4f4d\u7f6e\n    for(int i=l-1;i;i^=i&-i)tl[++cl]=RT[i];\n    for(int i=r;i;i^=i&-i)tr[++cr]=RT[i];\n    l=1,r=tot;\n    while(l<r){\n        m=l+r>>1;\n        if(v+t<=m){ //\u6bd4mid\u5c0f,\u8fdb\u5165\u5de6\u513f\u5b50  (t\u4e3a\u7279\u5224)\n            fur(i,1,cl)tl[i]=ls[tl[i]];\n            fur(i,1,cr)tr[i]=ls[tr[i]];\n            r=m;\n        }\n        else{ //\u8fdb\u5165\u53f3\u513f\u5b50\n            fur(i,1,cl)res-=s[ls[tl[i]]],tl[i]=rs[tl[i]];\n            fur(i,1,cr)res+=s[ls[tr[i]]],tr[i]=rs[tr[i]];\n            l=m+1;\n        }\n    }\n    return res+1-t;\n}\nil int kth(int l,int r,int k){// \u4e0eDynamic Rankings\u4e00\u6837,\u4e8c\u5206\n    int cl=0,cr=0,cnt,m;\n    for(int i=l-1;i;i^=i&-i)tl[++cl]=RT[i];\n    for(int i=r;i;i^=i&-i)tr[++cr]=RT[i];\n    l=1,r=tot;\n    while(l<r){\n        m=l+r>>1;cnt=0;\n        fur(i,1,cl)cnt-=s[ls[tl[i]]];\n        fur(i,1,cr)cnt+=s[ls[tr[i]]];\n        if(k<=cnt){\n            fur(i,1,cl)tl[i]=ls[tl[i]];\n            fur(i,1,cr)tr[i]=ls[tr[i]];\n            r=m;\n        }\n        else{\n            fur(i,1,cl)tl[i]=rs[tl[i]];\n            fur(i,1,cr)tr[i]=rs[tr[i]];\n            k-=cnt,l=m+1;\n        }\n    }\n    return c[l];\n}\nil int pre(int l,int r,int k){//\u6c42\u51fa \u6392\u540d \u540e\u6c42 \u6392\u540d-1 \u7684\u6570\n    int t=rnk(l,r,k)-1;\n    if(!t)return -2147483647;\n    return kth(l,r,t);\n}\nil int nxt(int l,int r,int k){//\u7c7b\u4f3c\u524d\u9a71\n    int t=rnk(l,r,k,1)+1;\n    if(t==r-l+2)return 2147483647;\n    return kth(l,r,t);\n}\nint main(){\n    in(n,q);\n    int opt,l,r,k,d=n,t=0,x;\n    fur(i,1,n)in(x),b[i]={x,i,0};\n    fur(i,1,q){\n        in(opt,l,r);\n        if(opt==3)k=r;\n        else in(k);\n        Q[i]=que{opt,l,r,k};\n        if(opt!=2)b[++d]=node{k,i,1};\n    }\n    //\u79bb\u6563\u5316,\u7edf\u4e00\u79bb\u6563\u5316\u8f83\u5feb,\u5982\u679c\u8981\u65b9\u4fbf\u8bdd\u53ef\u4ee5\u50cf\u5176\u4ed6\u9898\u89e3\u4e00\u6837\u4f7f\u7528lowerbound\n    std::sort(b+1,b+d+1);b[0].v=-(1<<30);\n    fur(i,1,d)c[(b[i].typ?Q[b[i].id].k:a[b[i].id])=tot+=b[i].v!=b[i-1].v]=b[i].v;\n    fur(i,1,n)UPD(i,1);\n    fur(i,1,q){\n        opt=Q[i].opt;l=Q[i].l,r=Q[i].r,k=Q[i].k;\n        if(opt==1)out(rnk(l,r,k),ln);\n        if(opt==2)out(kth(l,r,k),ln);\n        if(opt==3)UPD(l,-1),a[l]=k,UPD(l,1);\n        if(opt==4)out(pre(l,r,k),ln);\n        if(opt==5)out(nxt(l,r,k),ln);\n    }\n    flush();\n}\n```\n\n## \u7ebf\u6bb5\u6811\u5957\u5e73\u8861\u6811\n\n\u6700\u7ecf\u5178\u7684\u89e3\u6cd5\n\n1. \u67e5\u8be2\u533a\u95f4\u5185\u4e00\u4e2a\u6570\u7684\u6392\u540d: \n   \n   \u5728\u7ebf\u6bb5\u6811\u4e0a\u627e\u5230\u533a\u95f4\u5bf9\u5e94\u7684\u8282\u70b9,\u7136\u540e\u6bcf\u4e2a\u8282\u70b9\u7684\u5e73\u8861\u6811\u5185\u67e5\u8be2\u5bf9\u5e94\u6570\u7684\u6392\u540d\u5e76\u6c42\u548c\u3002\n   \n2. \u67e5\u8be2\u533a\u95f4\u5185\u6392\u540d\u4e3ak\u7684\u6570\u662f\u51e0:\n   \n   \u8fd9\u9879\u64cd\u4f5c\u5728\u7ebf\u6bb5\u6811\u4e0a\u4e0d\u53ef\u52a0,\u53ea\u80fd\u9000\u4e00\u6b65\n   \n   \u4e8c\u5206\u7b54\u6848,\u7528\u64cd\u4f5c1\u5224\u65ad\n\n3. \u5355\u70b9\u4fee\u6539: \n   \n   \u5728\u7ebf\u6bb5\u6811\u4e0a\u627e\u5230\u6240\u6709\u8986\u76d6\u8fd9\u4e2a\u70b9\u7684\u533a\u95f4,\u7136\u540e\u5728\u6240\u6709\u533a\u95f4\u5bf9\u5e94\u7684\u5e73\u8861\u6811\u4e2d\u5220\u9664\u539f\u6570,\u52a0\u5165\u65b0\u6570\n\n4. \u524d\u9a71:\n   \n   \u5728\u7ebf\u6bb5\u6811\u4e0a\u627e\u5230\u8be5\u533a\u95f4\u5bf9\u5e94\u7684\u8282\u70b9,\u5bf9 \u8fd9\u4e9b\u8282\u70b9\u6c42\u5f97\u7684\u524d\u9a71 \u53d6$min$\n\n5. \u540c4\n\n\u8fd9\u91cc\u7684\u5e73\u8861\u6811\u91c7\u7528\u5e38\u6570\u5c0f\u4e14\u597d\u5199\u7684`treap`\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nil int min(int x,int y){return x<y?x:y;}\nil int max(int x,int y){return x>y?x:y;}\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=50011,inf=2147483647,M=3000001;\nint n,q,cnt,a[N],RT[N*20],rnd[M],c[M][2],s[M],val[M];\nil int rand(){static int seed=233;return seed=(int)seed*482711LL%inf;}\nil void pu(int x){s[x]=s[c[x][0]]+s[c[x][1]]+1;}\nil void turn(int &x,int p){\n    int t=c[x][p];\n    c[x][p]=c[t][!p];\n    c[t][!p]=x;\n    pu(x);pu(x=t);\n}\nvoid ins(int &x,int v){\n    if(!x){s[x=++cnt]=1;val[x]=v;rnd[x]=rand();return;}\n    ++s[x];\n    int p=(v>val[x]);\n    ins(c[x][p],v);\n    if(rnd[c[x][p]]<rnd[x])turn(x,p);\n}\nvoid del(int &x,int v){\n    if(val[x]==v){\n        if(!c[x][0]||!c[x][1]){x=c[x][0]|c[x][1];return;}\n        int p=rnd[c[x][0]]>rnd[c[x][1]];\n        turn(x,p);del(c[x][!p],v);\n    }\n    else del(c[x][v>=val[x]],v);\n    pu(x);\n}\nint rnk(int x,int v){\n    if(!x)return 0;\n    if(v<=val[x])return rnk(c[x][0],v);\n    return s[c[x][0]]+1+rnk(c[x][1],v);\n}\nint pre(int x,int v){\n    if(!x)return -inf;\n    if(v>val[x])return max(val[x],pre(c[x][1],v));\n    else return pre(c[x][0],v);\n}\nint nxt(int x,int v){\n    if(!x)return inf;\n    if(v<val[x])return min(val[x],nxt(c[x][0],v));\n    else return nxt(c[x][1],v);\n}\n#define ls rt<<1\n#define rs rt<<1|1\nvoid build(int p,int v,int l=1,int r=n,int rt=1){\n    ins(RT[rt],v);\n    if(l==r)return;\n    int m=l+r>>1;\n    if(p<=m)build(p,v,l,m,ls);\n    else build(p,v,m+1,r,rs);\n}\nvoid upd(int p,int v,int l=1,int r=n,int rt=1){\n    del(RT[rt],a[p]);ins(RT[rt],v);\n    if(l==r)return;\n    int m=l+r>>1;\n    if(p<=m)upd(p,v,l,m,ls);\n    else upd(p,v,m+1,r,rs);\n}\nint RNK(int L,int R,int v,int l=1,int r=n,int rt=1){\n    if(L<=l&&r<=R)return rnk(RT[rt],v);\n    int m=l+r>>1,ans=0;\n    if(L<=m)ans=RNK(L,R,v,l,m,ls);\n    if(R>m)ans+=RNK(L,R,v,m+1,r,rs);\n    return ans;\n}\nint KTH(int L,int R,int k){\n    int l=0,r=1e8,m,ans;\n    while(l<=r){\n        m=l+r>>1;\n        if(RNK(L,R,m)+1<=k)l=m+1,ans=m;\n        else r=m-1;\n    }\n    return ans;\n}\nint PRE(int L,int R,int v,int l=1,int r=n,int rt=1){\n    if(L<=l&&r<=R)return pre(RT[rt],v);\n    int m=l+r>>1,ans=-inf;\n    if(L<=m)ans=PRE(L,R,v,l,m,ls);\n    if(R>m)ans=max(ans,PRE(L,R,v,m+1,r,rs));\n    return ans;\n}\nint NXT(int L,int R,int v,int l=1,int r=n,int rt=1){\n    if(L<=l&&r<=R)return nxt(RT[rt],v);\n    int m=l+r>>1,ans=inf;\n    if(L<=m)ans=NXT(L,R,v,l,m,ls);\n    if(R>m)ans=min(ans,NXT(L,R,v,m+1,r,rs));\n    return ans;\n}\nint main(){\n    in(n,q);\n    fur(i,1,n)in(a[i]),build(i,a[i]);\n    int opt,l,r,k;\n    fur(i,1,q){\n        in(opt,l,r);\n        if(opt==3)upd(l,r),a[l]=r;\n        else in(k);\n        if(opt==1)out(RNK(l,r,k)+1,ln);\n        if(opt==2)out(KTH(l,r,k),ln);\n        if(opt==4)out(PRE(l,r,k),ln);\n        if(opt==5)out(NXT(l,r,k),ln);\n    }\n    flush();\n}\n```\n\n## \u6743\u503c\u7ebf\u6bb5\u6811\u5957\u5e73\u8861\u6811\n\n\u6362\u4e2a\u601d\u8def,\u6743\u503c\u7ebf\u6bb5\u6811\u5916\u5c42\u8bb0\u5f55\u6743\u503c,\u5185\u5c42\u8bb0\u5f55\u4f4d\u7f6e\n\n\n\n## \u6574\u4f53\u4e8c\u5206\n\n## \u5206\u5757\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define fur(i,x,y) for(int i=x;i<=y;++i)\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\n#define N 50011\nint n,q,tot,sz,a[N],c[N<<1],RT[N],s[N*400],ls[N*400],rs[N*400];\nstruct que{int opt,l,r,k;}Q[N];\nstruct node{int v,id,typ;bool operator<(node t)const{return v<t.v;}}b[N<<1];\nvoid upd(int x,int v,int l,int r,int &rt){\n    if(!rt)rt=++sz;\n    s[rt]+=v;\n    if(l==r){return;}\n    int m=l+r>>1;\n    if(x<=m)upd(x,v,l,m,ls[rt]);\n    else upd(x,v,m+1,r,rs[rt]);\n}\nil void UPD(int x,int v){for(int i=x;i<=n;i+=i&-i)upd(a[x],v,1,tot,RT[i]);}\nint tl[20],tr[20];\nil int rnk(int l,int r,int v,int t=0){//\u8fd8\u662f\u4e8c\u5206,\u52a0\u4e86\u4e2a\u7279\u5224(\u53ef\u4ee5\u662f\u8fd9\u4e2a\u6570\u7684\u7b2c\u4e00\u4e2a\u6216\u6700\u540e\u4e00\u4e2a\u7684\u6392\u540d)\n    int cl=0,cr=0,m,res=0;\n    //\u83b7\u53d6\u533a\u95f4\u5bf9\u5e94\u7684\u6240\u6709\u6839\u8282\u70b9\u4f4d\u7f6e\n    for(int i=l-1;i;i^=i&-i)tl[++cl]=RT[i];\n    for(int i=r;i;i^=i&-i)tr[++cr]=RT[i];\n    l=1,r=tot;\n    while(l<r){\n        m=l+r>>1;\n        if(v+t<=m){ //\u6bd4mid\u5c0f,\u8fdb\u5165\u5de6\u513f\u5b50  (t\u4e3a\u7279\u5224)\n            fur(i,1,cl)tl[i]=ls[tl[i]];\n            fur(i,1,cr)tr[i]=ls[tr[i]];\n            r=m;\n        }\n        else{ //\u8fdb\u5165\u53f3\u513f\u5b50\n            fur(i,1,cl)res-=s[ls[tl[i]]],tl[i]=rs[tl[i]];\n            fur(i,1,cr)res+=s[ls[tr[i]]],tr[i]=rs[tr[i]];\n            l=m+1;\n        }\n    }\n    return res+1-t;\n}\nil int kth(int l,int r,int k){// \u4e0eDynamic Rankings\u4e00\u6837,\u4e8c\u5206\n    int cl=0,cr=0,cnt,m;\n    for(int i=l-1;i;i^=i&-i)tl[++cl]=RT[i];\n    for(int i=r;i;i^=i&-i)tr[++cr]=RT[i];\n    l=1,r=tot;\n    while(l<r){\n        m=l+r>>1;cnt=0;\n        fur(i,1,cl)cnt-=s[ls[tl[i]]];\n        fur(i,1,cr)cnt+=s[ls[tr[i]]];\n        if(k<=cnt){\n            fur(i,1,cl)tl[i]=ls[tl[i]];\n            fur(i,1,cr)tr[i]=ls[tr[i]];\n            r=m;\n        }\n        else{\n            fur(i,1,cl)tl[i]=rs[tl[i]];\n            fur(i,1,cr)tr[i]=rs[tr[i]];\n            k-=cnt,l=m+1;\n        }\n    }\n    return c[l];\n}\nil int pre(int l,int r,int k){//\u6c42\u51fa \u6392\u540d \u540e\u6c42 \u6392\u540d-1 \u7684\u6570\n    int t=rnk(l,r,k)-1;\n    if(!t)return -2147483647;\n    return kth(l,r,t);\n}\nil int nxt(int l,int r,int k){//\u7c7b\u4f3c\u524d\u9a71\n    int t=rnk(l,r,k,1)+1;\n    if(t==r-l+2)return 2147483647;\n    return kth(l,r,t);\n}\nint main(){\n    in(n,q);\n    int opt,l,r,k,d=n,t=0,x;\n    fur(i,1,n)in(x),b[i]={x,i,0};\n    fur(i,1,q){\n        in(opt,l,r);\n        if(opt==3)k=r;\n        else in(k);\n        Q[i]=que{opt,l,r,k};\n        if(opt!=2)b[++d]=node{k,i,1};\n    }\n    //\u79bb\u6563\u5316,\u7edf\u4e00\u79bb\u6563\u5316\u8f83\u5feb,\u5982\u679c\u8981\u65b9\u4fbf\u8bdd\u53ef\u4ee5\u50cf\u5176\u4ed6\u9898\u89e3\u4e00\u6837\u4f7f\u7528lowerbound\n    std::sort(b+1,b+d+1);b[0].v=-(1<<30);\n    fur(i,1,d)c[(b[i].typ?Q[b[i].id].k:a[b[i].id])=tot+=b[i].v!=b[i-1].v]=b[i].v;\n    fur(i,1,n)UPD(i,1);\n    fur(i,1,q){\n        opt=Q[i].opt;l=Q[i].l,r=Q[i].r,k=Q[i].k;\n        if(opt==1)out(rnk(l,r,k),ln);\n        if(opt==2)out(kth(l,r,k),ln);\n        if(opt==3)UPD(l,-1),a[l]=k,UPD(l,1);\n        if(opt==4)out(pre(l,r,k),ln);\n        if(opt==5)out(nxt(l,r,k),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3380 \u3010\u6a21\u677f\u3011\u4e8c\u903c\u5e73\u8861\u6811\uff08\u6811\u5957\u6811\uff09/", "tags": ["\u6811\u5957\u6811", "\u6570\u636e\u7ed3\u6784"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3527 [POI2011]MET-Meteors", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3527&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3527\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6574\u4f53\u4e8c\u5206\n\n\u63a5\u8fd1\u6a21\u677f\u9898\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=300011;\nint n,q,k,cnt=0,ans[N],head[N],L[N],R[N],V[N];\nll s[N<<1];\nstruct que{ll v;int id;}a[N],b[N];\nil void upd(int x,int v){for(;x<=(q<<1);x+=x&-x)s[x]+=v;}\nil ll ask(int x){ll res=0;for(;x;x^=x&-x)res+=s[x];return res;}\nstruct edge{int to,nxt;}e[N];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid solve(int l,int r,int st,int ed){\n    if(l>r||st>ed)return;\n    if(l==r){Fur(i,st,ed)ans[a[i].id]=l;return;}\n    int m=(l+r)>>1,c1=0,c2=0;\n    Fur(i,l,m)upd(L[i],V[i]),upd(R[i]+1,-V[i]);\n    Fur(i,st,ed){\n        ll t=0;\n        fl(j,a[i].id)if(t<=a[i].v)t+=ask(to)+ask(to+q);else break;\n        if(t>=a[i].v)a[st+c1++]=a[i];\n        else a[i].v-=t,b[++c2]=a[i];\n    }\n    Fur(i,l,m)upd(L[i],-V[i]),upd(R[i]+1,V[i]);\n    Fur(i,1,c2)a[st+c1+i-1]=b[i];\n    solve(l,m,st,st+c1-1);\n    solve(m+1,r,st+c1,ed);\n}\nint main(){\n    in(n,q);\n    int x;\n    Fur(i,1,q)in(x),add(x,i);\n    Fur(i,1,n)in(a[i].v),a[i].id=i;\n    in(k);\n    Fur(i,1,k){in(L[i],R[i],V[i]);if(R[i]<L[i])R[i]+=q;}\n    solve(1,k+1,1,n);\n    Fur(i,1,n)if(ans[i]>k)out(\"NIE\\n\");else out(ans[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3527 [POI2011]MET-Meteors/", "tags": ["\u6574\u4f53\u4e8c\u5206", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3332 [ZJOI2013]K\u5927\u6570\u67e5\u8be2", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3332&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3332\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u6811\u5957\u6811\n\n\u5916\u5c42\u6743\u503c\u7ebf\u6bb5\u6811 \u5185\u5c42\u533a\u95f4\u4fee\u6539\u7ebf\u6bb5\u6811\n\n\u5185\u5c42\u7ebf\u6bb5\u6811\u9700\u4f7f\u7528\u6807\u8bb0\u6c38\u4e45\u5316,\u5426\u5219\u53ef\u80fdTLE\n\n\u5916\u5c42\u53ef\u4ee5\u4f7f\u7528\u975e\u9012\u5f52\u7ed3\u6784\u63d0\u9ad8\u901f\u5ea6\n\n\u53ef\u4ee5\u9884\u5148\u79bb\u6563\u5316\u63d0\u9ad8\u901f\u5ea6\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=50011;\ninline int min(int x,int y){return x<y?x:y;}\ninline int max(int x,int y){return x>y?x:y;}\nint n,nn=0,q,sz=0,RT[N<<2],laz[N*400],ls[N*400],rs[N*400],C[N];\nll s[N*400];\nstruct que{int typ,l,r;ll c;}Q[N];\nstruct node{int v,id;bool operator<(node t){return v<t.v;}}b[N];\nvoid upd(int L,int R,int l,int r,int &rt){\n    if(!rt)rt=++sz;\n    if(L<=l&&r<=R){s[rt]+=r-l+1;++laz[rt];return;}\n    int m=(l+r)>>1;\n    if(L<=m)upd(L,R,l,m,ls[rt]);\n    if(R>m)upd(L,R,m+1,r,rs[rt]);\n    s[rt]=s[ls[rt]]+s[rs[rt]]+(r-l+1)*laz[rt];\n}\nll ask(int L,int R,int l,int r,int rt){\n    if(!rt)return 0;\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1;ll ans=laz[rt]*(min(R,r)-max(L,l)+1);\n    if(L<=m)ans+=ask(L,R,l,m,ls[rt]);\n    if(R>m)ans+=ask(L,R,m+1,r,rs[rt]);\n    return ans;\n}\n#define ls rt<<1\n#define rs rt<<1|1\nvoid UPD(int L,int R,int v){\n    int l=1,r=nn,rt=1;\n    while(l<r){\n        upd(L,R,1,n,RT[rt]);\n        int m=(l+r)>>1;\n        if(v<=m)r=m,rt=ls;\n        else l=m+1,rt=rs;\n    }\n    upd(L,R,1,n,RT[rt]);\n}\nint ASK(int L,int R,ll k){\n    int l=1,r=nn,rt=1;\n    while(l<r){\n        int m=(l+r)>>1;ll t=ask(L,R,1,n,RT[rs]);\n        if(k>t)r=m,rt=ls,k-=t;\n        else l=m+1,rt=rs;\n    }\n    return l;\n}\nint main(){\n    in(n,q);\n    int typ,l,r,d=0;ll c;\n    for(int i=1;i<=q;++i){\n        in(typ,l,r,c);\n        if(typ==1)b[++nn]={c,i};\n        Q[i]={typ,l,r,c};\n    }\n    std::sort(b+1,b+nn+1);b[0].v=-(1<<30);\n    for(int i=1;i<=nn;++i)C[Q[b[i].id].c=d+=(b[i].v!=b[i-1].v)]=b[i].v;\n    for(int i=1;i<=q;++i){\n        l=Q[i].l,r=Q[i].r,c=Q[i].c;\n        if(Q[i].typ==1)UPD(l,r,c);\n        else out(C[ASK(l,r,c)],ln);\n    }\n    flush();\n}\n```\n\n## \u6574\u4f53\u4e8c\u5206\n\n\u6bd4\u6811\u5957\u6811\u5e38\u6570\u5c0f\u591a\u4e86,\u7b80\u76f4\u540a\u7740\u6811\u5957\u6811\u6253\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\ntypedef long long ll;\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=50001;\nll s[N],S[N];\nint n,q,tot,ans[N];\nil void upd(int x,int v){for(int i=x--;i<=n;i+=i&-i)s[i]+=v,S[i]+=v*x;}\n#define upd(l,r,v) upd(l,v),upd(r+1,-v)\nil ll ask(int x){ll res=0,RES=0;for(int i=x;i;i^=i&-i)res+=s[i],RES+=S[i];return x*res-RES;}\nstruct que{int typ,l,r,id;ll c;}a[N],a2[N];\nvoid solve(int l,int r,int st,int ed){\n    if(st>ed||l>r)return;\n    if(l==r){for(int i=st;i<=ed;++i)ans[a[i].id]=l;return;}\n    for(int i=st;i<=ed;++i)if(a[i].typ^1)goto ski;return;ski:;\n    int m=(l+r)>>1,c1=0,c2=0;\n    for(int i=st;i<=ed;++i)\n    if(a[i].typ&1){\n        if(a[i].c>m)upd(a[i].l,a[i].r,1),a2[++c2]=a[i];\n        else a[st+c1++]=a[i];\n    }\n    else{\n        ll x=ask(a[i].r)-ask(a[i].l-1);\n        if(x>=a[i].c)a2[++c2]=a[i];\n        else a[i].c-=x,a[st+c1++]=a[i];\n    }\n    for(int i=1;i<=c2;++i)if(a2[i].typ&1)upd(a2[i].l,a2[i].r,-1);\n    for(int i=1;i<=c2;++i)a[st+c1+i-1]=a2[i];\n    solve(l,m,st,st+c1-1);\n    solve(m+1,r,st+c1,ed);\n}\nint main(){\n    in(n,q);\n    for(int i=1;i<=q;++i){\n        in(a[i].typ,a[i].l,a[i].r,a[i].c);\n        if(a[i].typ^1)a[i].id=++tot;\n    }\n    solve(1,n,1,q);\n    for(int i=1;i<=tot;++i)out(ans[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3332 [ZJOI2013]K\u5927\u6570\u67e5\u8be2/", "tags": ["\u7ebf\u6bb5\u6811", "\u6811\u5957\u6811", "\u6574\u4f53\u4e8c\u5206", "\u6807\u8bb0\u6c38\u4e45\u5316"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3157 [CQOI2011]\u52a8\u6001\u9006\u5e8f\u5bf9", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3157&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3157\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u79bb\u7ebf\u89e3\u6cd5: cdq\u5206\u6cbb\n\n\u5c06\u95ee\u9898\u8f6c\u5316\u4e3a\u4e09\u7ef4\u504f\u5e8f\n\n\u6211\u4eec\u5148\u627e\u51fa\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u7684\u70b9$(i,j)$\u6ee1\u8db3\u7684\u6761\u4ef6\uff1a\n\n$time_i<time_j$\n\n$val_i<val_j,pos_i>pos_j$\u6216$val_i>val_j,pos_i<pos_j$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=100011,inf=2122219134;\nint n,q,s[N],pos[N];\nlong long ans[50011];\nvoid add(int x,int v){for(;x<=n;x+=x&-x)s[x]+=v;}\nint ask(int x){int res=0;for(;x;x-=x&-x)res+=s[x];return res;}\nstruct node{\n    int v,w,p,id;\n    bool operator<(node t){return p<t.p;}\n}b[N+50000],c[N+50000];\nvoid cdq(int l,int r){\n    if(l>=r)return;\n    int m=(l+r)>>1,j=l;\n    cdq(l,m);cdq(m+1,r);\n    for(int i=m+1;i<=r;++i){\n        for(;j<=m&&b[j].p<=b[i].p;++j)add(b[j].v,b[j].w);\n        ans[b[i].id]+=b[i].w*(ask(n)-ask(b[i].v));// \u7edf\u8ba1\u5728i\u4e4b\u524d\u7684\u4e0ei\u7ec4\u6210\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\n    }\n    for(int i=l;i<j;++i)add(b[i].v,-b[i].w);\n    j=m;\n    for(int i=r;i>m;--i){\n        for(;j>=l&&b[j].p>=b[i].p;--j)add(b[j].v,b[j].w);\n        ans[b[i].id]+=b[i].w*ask(b[i].v-1);// \u7edf\u8ba1\u5728i\u4e4b\u540e\u7684\u4e0ei\u7ec4\u6210\u7684\u9006\u5e8f\u5bf9\u4e2a\u6570\n    }\n    for(int i=m;i>j;--i)add(b[i].v,-b[i].w);\n    std::merge(b+l,b+m+1,b+m+1,b+r+1,c+l);//\u4f7f\u7528merge\u5408\u5e76\u6bd4\u6392\u5e8f\u66f4\u5feb(\u5f52\u5e76\u6392\u5e8f)\n    for(int i=l;i<=r;++i)b[i]=c[i];\n}\nint main(){\n    in(n,q);\n    int x;\n    for(int i=1;i<=n;++i)in(x),b[i]=node{x,1,pos[x]=i,0};\n    for(int i=1;i<q;++i)in(x),b[n+i]=node{x,-1,pos[x],i};\n    cdq(1,n+q-1);\n    for(int i=1;i<q;++i)ans[i]+=ans[i-1];\n    for(int i=0;i<q;++i)out(ans[i],ln);\n    flush();\n}\n```\n\n\n\u5728\u7ebf\u89e3\u6cd5: \u6811\u72b6\u6570\u7ec4+\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\n\ncdq\u5206\u6cbb\u662f\u79bb\u7ebf\u89e3\u6cd5,\u4e07\u4e00\u9047\u5230\u6bd2\u7624\u51fa\u9898\u4eba\u5c31\u4e0d\u80fd\u7528\u4e86\n\n\u6240\u4ee5\u6211\u4eec\u8981\u5b66\u4e60\u66f4\u52a0\u9ad8\u660e\u7684\u7b97\u6cd5\n\n\u6811\u72b6\u6570\u7ec4\u5957\u52a8\u6001\u5f00\u70b9\u6743\u503c\u7ebf\u6bb5\u6811, \u5b9e\u73b0\u6709\u70b9\u7c7b\u4f3c\u5f85\u4fee\u6539\u4e3b\u5e2d\u6811\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}inline void out(char c){pt(c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=100011,inf=2122219134;\nint n,q,pos[N],RT[N],sz=0,s[N*300],ls[N*300],rs[N*300];\nvoid upd(int l,int r,int x,int y,int &rt){\n    if(!rt)rt=++sz;\n    s[rt]+=y;\n    if(l==r)return;\n    int m=(l+r)>>1;\n    if(x<=m)upd(l,m,x,y,ls[rt]);\n    else upd(m+1,r,x,y,rs[rt]);\n}\nint t[N],T[N];\nint ask(int l,int r,int x,int typ){\n    int cnt=0,CNT=0,sum=0;\n    for(int i=l-1;i;i-=i&-i)t[++cnt]=RT[i];\n    for(int i=r;i;i-=i&-i)T[++CNT]=RT[i];\n    l=1,r=n;\n    while(l<r){\n        int m=(l+r)>>1;\n        if(x>m){\n            if(typ){\n                for(int i=1;i<=cnt;++i)sum-=s[ls[t[i]]];\n                for(int i=1;i<=CNT;++i)sum+=s[ls[T[i]]];\n            }\n            for(int i=1;i<=cnt;++i)t[i]=rs[t[i]];\n            for(int i=1;i<=CNT;++i)T[i]=rs[T[i]];\n            l=m+1;\n        }\n        else{\n            if(!typ){\n                for(int i=1;i<=cnt;++i)sum-=s[rs[t[i]]];\n                for(int i=1;i<=CNT;++i)sum+=s[rs[T[i]]];\n            }\n            for(int i=1;i<=cnt;++i)t[i]=ls[t[i]];\n            for(int i=1;i<=CNT;++i)T[i]=ls[T[i]];\n            r=m;\n        }\n    }\n    return sum;\n}\nint main(){\n    in(n,q);\n    int x;\n    long long ans=0;\n    for(int i=1;i<=n;++i){\n        in(x);pos[x]=i;\n        ans+=ask(1,i-1,x,0);\n        for(int j=i;j<=n;j+=j&-j)upd(1,n,x,1,RT[j]);\n    }\n    out(ans,ln);\n    while(--q){\n        in(x);\n        ans-=ask(1,pos[x]-1,x,0);\n        ans-=ask(pos[x]+1,n,x,1);\n        out(ans,ln);\n        for(int j=pos[x];j<=n;j+=j&-j)upd(1,n,x,-1,RT[j]);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3157 [CQOI2011]\u52a8\u6001\u9006\u5e8f\u5bf9/", "tags": ["\u79bb\u7ebf", "cdq\u5206\u6cbb", "\u7ebf\u6bb5\u6811", "\u6811\u72b6\u6570\u7ec4", "\u9006\u5e8f\u5bf9"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "HDU 1541 Stars", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=1541&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"http://acm.hdu.edu.cn/showproblem.php?pid=1541\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e8c\u7ef4\u6570\u70b9\u6a21\u677f\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=32000;\nint n,s[N+11],ans[N+11];\nil void add(int x){for(;x<=N;x+=x&-x)++s[x];}\nil int ask(int x){int res=0;for(;x;x-=x&-x)res+=s[x];return res;}\nint main(){\n    in(n);\n    int x,y;\n    Fur(i,1,n){\n        in(x,y);\n        ++ans[ask(++x)];\n        add(x);\n    }\n    Fur(i,0,n-1)out(ans[i],ln);\n    flush();\n}\n```\n", "link": "/posts/HDU 1541 Stars/", "tags": ["\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3031 [USACO11NOV]Above the Median G", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3031&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3031\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5f88\u5999\u7684\u4e00\u9053\u9898\n\n\u5bf9\u6bcf\u4f4d\u7f6e$i$\u5206\u522b\u7edf\u8ba1$[l,i],l\\in [1,i]$\u7684\u65b9\u6848\u6570\n\n\u8bbe$S_i$\u8868\u793a$\\sum_{j=1}^i [H_i \\ge X]$,$pre$\u4e3a\u4f4d\u7f6e$i-1$\u7684\u65b9\u6848\u6570,$now$\u4e3a\u4f4d\u7f6e$i$\u7684\u65b9\u6848\u6570\n\n\u82e5$H_i\\ge x$,$now=pre+\\sum_{j=1}^i [S_j=S_i]$,\u8fd9\u4e9b\u4f4d\u7f6e\u662f\u4f4d\u7f6e$i-1$\u4e0d\u80fd\u6ee1\u8db3\u800c\u4f4d\u7f6e$i$\u53ef\u4ee5\u6ee1\u8db3\u7684\n\n\u82e5$H_i\\le x$,$now=pre-\\sum_{j=1}^i [S_j=S_{i-1}]$,\u8fd9\u4e9b\u4f4d\u7f6e\u662f\u4f4d\u7f6e$i$\u4e0d\u80fd\u6ee1\u8db3\u800c\u4f4d\u7f6e$i-1$\u53ef\u4ee5\u6ee1\u8db3\u7684\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5$\\Theta(n)$\u89e3\u51b3\u4e86\u5462\n\n\u8bb0\u5f97\u5f00`long long`,$S_0$\u5148\u8d4b\u503c\u4e3a$n$,\u9632\u6b62\u8d1f\u6570re\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nconst int N=100011;\nint n,k,b[N<<1];\nint main(){\n    in(n,k);\n    int x,pre=0,s=n;\n    long long ans=0;\n    b[s]=1;\n    for(int i=1;i<=n;++i){\n        in(x);\n        if(x>=k)pre+=b[++s]+1;\n        else pre-=b[s--]-1;\n        ++b[s];\n        ans+=pre;\n    }\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 3031 [USACO11NOV]Above the Median G/", "tags": ["\u524d\u7f00\u548c", "\u601d\u7ef4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4115 Qtree4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4115&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4115\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/LG 4115 Qtree4/", "tags": ["\u6570\u636e\u7ed3\u6784", "\u6811\u94fe\u5256\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3608 [USACO17JAN]Balanced Photo G", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3608&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3608\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u79bb\u6563\u5316,\u7136\u540e\u7528\u6811\u72b6\u6570\u7ec4\u7edf\u8ba1\u4e24\u8fb9\u7684\u6570\u76ee,\u6bd4\u8f83\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,a[N],s[N],L[N];\nil void add(int x){for(;x<=n;x+=x&-x)++s[x];}\nil int ask(int x){int res=0;for(;x;x-=x&-x)res+=s[x];return res;}\nstruct node{int id,v;bool operator<(node t){return v>t.v;}}b[N];\nint main(){\n    in(n);\n    Fur(i,1,n)in(b[i].v),b[i].id=i;\n    sort(b+1,b+n+1);\n    int d=0,ans=0;b[0].v=-inf;\n    Fur(i,1,n)a[b[i].id]=d+=(b[i].v!=b[i-1].v);\n    Fur(i,1,n)L[i]=ask(a[i]-1),add(a[i]);\n    clr(s,0);\n    Fdr(i,n,1){\n        int l=L[i],r=ask(a[i]-1);\n        if(l>r)SWAP(l,r);\n        if(r>(l<<1))++ans;\n        add(a[i]);\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 3608 [USACO17JAN]Balanced Photo G/", "tags": ["\u6811\u72b6\u6570\u7ec4", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2345 [USACO04OPEN]MooFest G", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2345&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2345\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u53ef\u4ee5\u60f3\u5230\u6309$v_i$\u6392\u5e8f\n\n\u63a5\u4e0b\u6765\u5c31\u76f4\u63a5\u6309\u987a\u5e8f\u63d2\u5165\u5e76\u7edf\u8ba1\u5c31\u53ef\u4ee5\u4e86\n\n\u5173\u4e8e\u8ddd\u79bb\u4e4b\u548c\u7684\u7edf\u8ba1:\n\n\u53ef\u4ee5\u5206\u524d\u534a\u90e8\u5206\u548c\u540e\u534a\u90e8\u5206\u7edf\u8ba1\n\n\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5373\u53ef\n\n\u611f\u89c9\u5f88\u6c34\n\n\u5177\u4f53\u770b\u4ee3\u7801\u5427\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=20000;\nint n;\nll s[N+11],t[N+11];\nil void add(int x,int v){for(;x<=N;x+=x&-x)s[x]+=v,++t[x];}\nil ll ask(int x){ll res=0;for(;x;x-=x&-x)res+=s[x];return res;}\nil int ASK(int x){int res=0;for(;x;x-=x&-x)res+=t[x];return res;}\nstruct node{int v,x;}a[N+11];\nil bool cmp(node x,node y){return x.v<y.v;}\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i].v,a[i].x);\n    sort(a+1,a+n+1,cmp);\n    ll ss=0,v,x,ans=0;\n    Fur(i,1,n){\n        v=a[i].v;x=a[i].x;\n        ll pre=ASK(x-1),pres=ask(x-1),res;\n        res=x*pre-pres+(ss-pres)-x*(i-1-pre);\n        ans+=v*res;\n        ss+=x;add(x,x);\n    }\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 2345 [USACO04OPEN]MooFest G/", "tags": ["\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4169 [Violet]\u5929\u4f7f\u73a9\u5076", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4169&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4169\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5141\u8bb8\u79bb\u7ebf\u5904\u7406\n\n\u53ef\u4ee5\u770b\u6210\u4e09\u7ef4\u504f\u5e8f(\u5750\u6807\u548c\u65f6\u95f4)\n\n\u8003\u8651\u5982\u679c\u8981\u6c42\u7684\u70b9\u90fd\u5728\u5f53\u524d\u70b9\u7684\u5de6\u4e0a\u65b9\n\n\u90a3\u4e48\u4e5f\u5c31\u662f\u8981\u6c42$x_j\\le x_i,y_j\\le y_i,time_j\\le time_i$\n\n$x_i+y_i-\\max(x_j+y_j)$\n\n\u5750\u6807\u518d\u65cb\u8f6c\u5e76\u5904\u7406\u4e09\u6b21\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il inline\nil void cmax(int &x,int y){x=x>y?x:y;}\nil void cmin(int &x,int y){x=x<y?x:y;}\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=300011;\nusing std::merge;\nint n,q,cnt=0,ans[N],s[1000011],limx,limy,nn;\nstruct node{\n    int x,y,typ,id,ans;\n    il bool operator <(node &t){return x<=t.x;}\n}b[N<<1],a[N<<1],c[N<<1];\nil void upd(int x,int v){for(;x<=limy;x+=x&-x)cmax(s[x],v);}\nil int ask(int x){int res=0;for(;x;x-=x&-x)cmax(res,s[x]);return res;}\nil void clr(int x){for(;x<=limy;x+=x&-x)if(s[x])s[x]=0;else break;}\nvoid cdq(int l,int r){\n    if(l>=r)return;\n    int m=(l+r)>>1,j=l;\n    cdq(l,m);cdq(m+1,r);\n    for(int i=m+1;i<=r;++i)if(!a[i].typ){\n        for(;j<=m&&a[j].x<=a[i].x;++j)if(a[j].typ)\n            upd(a[j].y,a[j].x+a[j].y);\n        int res=ask(a[i].y);\n        if(res)cmin(ans[a[i].id],a[i].x+a[i].y-res);\n    }\n    for(int i=l;i<j;++i)if(a[i].typ)clr(a[i].y);\n    merge(a+l,a+m+1,a+m+1,a+r+1,c+l);\n    for(int i=l;i<=r;++i)a[i]=c[i];\n}\nil void del(){\n    int rx=0,ry=0;nn=0;\n    for(int i=1;i<=n;++i)if(!a[i].typ)\n        cmax(rx,a[i].x),cmax(ry,a[i].y);\n    for(int i=1;i<=n;++i)\n        if(a[i].x<=rx&&a[i].y<=ry)c[++nn]=a[i];\n    for(int i=1;i<=nn;++i)a[i]=c[i];\n}\nint main(){\n    in(n,q);\n    int x,y,typ;\n    for(int i=1;i<=n;++i)\n        in(x,y),++x,++y,b[i]=node{x,y,1,0,0},\n        cmax(limx,x),cmax(limy,y);\n    while(q--){\n        in(typ,x,y);++x,++y;\n        b[++n]=node{x,y,typ&1,cnt+=typ-1,0};\n        cmax(limx,x),cmax(limy,y);\n    }\n    for(int i=1;i<=n;++i)a[i]=b[i];\n    memset(ans,126,sizeof ans);\n    ++limx,++limy;\n    del(),cdq(1,nn);\n    \n    for(int i=1;i<=n;++i)a[i]=b[i],a[i].x=limx-a[i].x;\n    del(),cdq(1,nn);\n\n    for(int i=1;i<=n;++i)a[i]=b[i],a[i].y=limy-a[i].y;\n    del(),cdq(1,nn);\n\n    for(int i=1;i<=n;++i)a[i]=b[i],a[i].x=limx-a[i].x,a[i].y=limy-a[i].y;\n    del(),cdq(1,nn);\n\n    for(int i=1;i<=cnt;++i)out(ans[i]),pt('\\n');\n    flush();\n}\n```\n", "link": "/posts/LG 4169 [Violet]\u5929\u4f7f\u73a9\u5076/", "tags": ["\u79bb\u7ebf", "cdq\u5206\u6cbb", "\u6570\u636e\u7ed3\u6784", "kdt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3810 \u3010\u6a21\u677f\u3011\u4e09\u7ef4\u504f\u5e8f\uff08\u964c\u4e0a\u82b1\u5f00\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3810&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3810\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;typedef double db;typedef unsigned long long ull;\ntemplate <class T>inline T min(T x,T y){return x<y?x:y;}\ntemplate <class T>inline T max(T x,T y){return x>y?x:y;}\nnamespace IN{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;inline char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>inline void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>inline void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IN;\nnamespace OUT{const char ln='\\n';const int str=1<<20;static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;inline void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}inline void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}template<typename T>inline void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>inline void out(T x,arr & ... y){out(x),out(y...);}}using namespace OUT;\nconst int N=100011,inf=2122219134;\nusing std::sort;\nint d,n,k,s[N<<1],ans[N];\nstruct node{int x,y,z,ans,w;}b[N],a[N];\nbool cmpx(node x,node y){\n    if(x.x!=y.x)return x.x<y.x;\n    if(x.y!=y.y)return x.y<y.y;\n    return x.z<y.z;\n}\nbool cmpy(node x,node y){\n    if(x.y!=y.y)return x.y<y.y;\n    return x.z<y.z;\n}\ninline void add(int x,int v){for(int i=x;i<=k;i+=i&-i)s[i]+=v;}\ninline int ask(int x){\n    int res=0;\n    for(int i=x;i;i-=i&-i)res+=s[i];\n    return res;\n}\ninline void cdq(int l,int r){\n    if(l>=r)return;\n    int m=(l+r)>>1,j=l;\n    cdq(l,m);cdq(m+1,r);\n    sort(a+l,a+m+1,cmpy);\n    sort(a+m+1,a+r+1,cmpy);\n    for(int i=m+1;i<=r;++i){\n        for(;j<=m&&a[j].y<=a[i].y;++j)\n            add(a[j].z,a[j].w);\n        a[i].ans+=ask(a[i].z);\n    }\n    for(int i=l;i<=j-1;++i)add(a[i].z,-a[i].w);\n}\nint main(){\n    in(d,k);\n    for(int i=1;i<=d;++i)in(b[i].x,b[i].y,b[i].z);\n    sort(b+1,b+d+1,cmpx);\n    for(int i=1,c=1;i<=d;++i,++c)\n    if(b[i].x!=b[i+1].x||b[i].y!=b[i+1].y||b[i].z!=b[i+1].z)\n        a[++n]=b[i],a[n].w=c,c=0;\n    cdq(1,n);\n    for(int i=1;i<=n;++i)ans[a[i].ans+a[i].w]+=a[i].w;\n    for(int i=1;i<=d;++i)out(ans[i]),pt('\\n');\n    flush();\n}\n```\n", "link": "/posts/LG 3810 \u3010\u6a21\u677f\u3011\u4e09\u7ef4\u504f\u5e8f\uff08\u964c\u4e0a\u82b1\u5f00\uff09/", "tags": ["cdq\u5206\u6cbb", "\u6570\u636e\u7ed3\u6784"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5221 Product", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5221&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5221\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$\n\\prod_{i=1}^n\\prod_{j=1}^n\\frac{lcm(i,j)}{\\gcd(i,j)}\n\\\\\n=\\prod_{i=1}^n\\prod_{j=1}^n\\frac{ij}{\\gcd(i,j)^2}\n\\\\\n=\\prod_{i=1}^n\\prod_{j=1}^n ij \\prod_{d=1}^n {\\frac 1{d^2}}^{\\sum_{i=1}^n\\sum_{j=1}^n [\\gcd(i,j)=d]}\n\\\\\n=(n!)^{2n} \\left (\\prod_{d=1}^n d^{\\sum_{i=1}^n\\sum_{j=1}^n [\\gcd(i,j)=d]} \\right )^{-2}\n$$\n\n\u5176\u4e2d:\n\n$$\n\\prod_{d=1}^n d^{\\sum_{i=1}^n\\sum_{j=1}^n [\\gcd(i,j)=d]}\n\\\\\n=\\prod_{d=1}^n d^{\\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac nd \\right \\rfloor} [\\gcd(i,j)=1]}\n\\\\\n=\\prod_{d=1}^n d^{-1+2\\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor} \\varphi(i)}\n$$\n\n\u56e0\u4e3a$mod=104857601$\u662f\u8d28\u6570,\u4f7f\u7528\u53ef\u4ee5\u7528\u6b27\u62c9\u5b9a\u7406\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\nconst int N=1000001,P=104857601;\nint n,cnt=0,pri[78499],phi[N];\nbool b[N];\ninline int pw(int x,int b){\n    int ans=1;\n    while(b){\n        if(b&1)ans=1ll*ans*x%P;\n        b>>=1;x=1ll*x*x%P;\n    }\n    return ans;\n}\nint main(){\n    scanf(\"%d\",&n);\n    phi[1]=1;\n    for(int i=2;i<=n;++i){\n        if(!b[i])pri[++cnt]=i,phi[i]=i-1;\n        for(int j=1,x;j<=cnt&&(x=i*pri[j])<=n;++j){\n            b[x]=1;\n            if(i%pri[j])phi[x]=phi[i]*(pri[j]-1);\n            else{phi[x]=phi[i]*pri[j];break;}\n        }\n    }\n    for(int i=1;i<=n;++i)phi[i]<<=1,(phi[i]+=phi[i-1])%=(P-1);\n    int ans=1,ANS=1,pre=1;\n    for(int l=1,r,i;l<=n;l=r+1){\n        i=n/l,r=n/i;\n        pre=ans;for(int j=l;j<=r;++j)ans=1ll*ans*j%P;\n        ANS=1ll*ANS*pw(1ll*ans*pw(pre,P-2)%P,phi[i]-1)%P;\n    }\n    printf(\"%d\\n\",1ll*pw(ans,n<<1)*pw(1ll*ANS*ANS%P,P-2)%P);\n}\n```\n", "link": "/posts/LG 5221 Product/", "tags": ["\u6570\u8bba", "\u6b27\u62c9\u51fd\u6570", "\u6570\u8bba\u5206\u5757"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 6156 \u7b80\u5355\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P6156&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P6156\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n~~\u5e26 \u5957 \u8def \u9898~~\n\n$$\n\\sum_{i=1}^n\\sum_{j=1}^n(i+j)^k\\mu^2(\\gcd(i,j))\\gcd(i,j)\n\\\\\n=\\sum_{d=1}^n \\mu^2(d) d \\sum_{i=1}^n\\sum_{j=1}^n(i+j)^k[\\gcd(i,j)=d]\n\\\\\n=\\sum_{d=1}^n \\mu^2(d) d^{k+1} \\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}(i+j)^k[\\gcd(i,j)=1]\n$$\n\n\u4ee4$S(n)=\\sum_{i=1}^n\\sum_{j=1}^n(i+j)^k$\n\n$$\n=\\sum_{d=1}^n \\mu^2(d) d^{k+1} \\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}(i+j)^k \\sum_{x|i,x|j} \\mu(x)\n\\\\\n=\\sum_{d=1}^n \\sum_{x=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\mu^2(d) d^{k+1} \\mu(x) x^k S(\\left \\lfloor \\frac n{dx} \\right \\rfloor)\n$$\n\n\u4ee4$T=dx$\n\n$$\n=\\sum_{T=1}^n \\sum_{d|T} \\mu^2(d) d^{k+1} \\mu(\\frac Td) (\\frac Td)^k S(\\left \\lfloor \\frac nT \\right \\rfloor)\n\\\\\n=\\sum_{T=1}^n S(\\left \\lfloor \\frac nT \\right \\rfloor) T^k \\sum_{d|T} d \\mu^2(d)\\mu(\\frac Td)\n$$\n\n\u5982\u4f55\u5feb\u901f\u6c42\u4ee4$S(n)$?\n\n\u8bbe:\n\n$$F(n)=\\sum_{i=1}^n i^k$$\n\n$$G(n)=\\sum_{i=1}^n F(i)$$\n\n\u90a3\u4e48\n\n$$\nS(n)=\\sum_{i=n+1}^{2n}F(i)-\\sum_{i=1}^nF(i)\n\\\\\n=G(2n)-2G(n)\n$$\n\n\u7b5b\u51fa$F$\u7684\u524d\u7f00\u548c,\u7136\u540e\u7b5b$S(n)$\n\n\u4f18\u5316:\n\n> \u56e0\u4e3a\u6a21\u6570\u662f\u8d28\u6570,\u6839\u636e\u6b27\u62c9\u5b9a\u7406: \u5bf9\u4e8e\u4e92\u8d28\u7684$a,n$\u6ee1\u8db3$a^{\\varphi(n)} \\equiv 1\\pmod n$\n>\n> \u53ef\u4ee5$k=k \\mod 998244352$\n\n\u6c42\u540e\u534a\u90e8\u5206\n\n$$f(n)=\\sum_{d|n} d \\mu^2(d)\\mu(\\frac nd)$$\n\n\u5982\u4f55\u7ebf\u6027\u6c42$f(n)$?\n\n$f(n)$\u662f\u82e5\u5e72\u4e2a\u79ef\u6027\u51fd\u6570\u7684\u5377\u79ef,\u6240\u4ee5$f(n)$\u4e5f\u662f\u79ef\u6027\u51fd\u6570\n\n\u90a3\u4e48$f(n)=f(p^k)f(\\frac n{p^k})$\n\n$f(1)=1$\n\n$f(p^1)=p-1$(\u5e26\u5165\u5373\u53ef\u5f97\u5230)\n\n$f(p^2)=-p$(\u5e26\u5165\u5373\u53ef\u5f97\u5230)\n\n$f(p^k)=0(k\\ge 3)$\n\n> $d$\u548c$\\frac nd$\u4e2d\u5fc5\u7136\u6709\u4e00\u4e2a\u6709\u5e73\u65b9\u56e0\u5b50,\u6240\u4ee5$\\mu(d)$\u548c$\\mu(\\frac nd)$\u5fc5\u6709\u4e00\u9879\u4e3a$0$\n> \n> \u6240\u4ee5$f(p^k)=0(k\\ge 3)$\n\n\u63a5\u4e0b\u6765\u5c31\u53ef\u4ee5\u7ebf\u6027\u7b5b$f(n)$\u4e86\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\n#define il inline\n#define rg register\nconst int N=5000011,P=998244353;\nint n,k,cnt=0,pri[5348514],F[N<<1],f[N];\nbool b[N<<1];\nil int pw(int x){\n    int ans=1,b=k;\n    while(b){\n        if(b&1)ans=1ll*ans*x%P;\n        b>>=1;x=1ll*x*x%P;\n    }\n    return ans;\n}\nil int M(int x){return x>=P?x-P:x;}\nil int S(int n){return M(F[n<<1]-M(F[n]<<1)+P);}\nint main(){\n    long long _;\n    scanf(\"%d%lld\",&n,&_);k=_%(P-1);\n    f[1]=F[1]=1;\n    for(rg int i=2;i<=n;++i){\n        if(!b[i])\n            pri[++cnt]=i,\n            f[i]=i-1,\n            F[i]=pw(i);\n        for(rg int j=1,x;j<=cnt&&(x=i*pri[j])<=n;++j){\n            b[x]=1;\n            F[x]=1ll*F[i]*F[pri[j]]%P;\n            if(i%pri[j])f[x]=1ll*f[i]*f[pri[j]]%P;\n            else{\n                int t=i/pri[j];\n                if(t%pri[j])f[x]=1ll*(P-pri[j])*f[t]%P;\n                break;\n            }\n        }\n    }\n    for(rg int i=2;i<=n;++i)f[i]=M(f[i-1]+1ll*F[i]*f[i]%P);\n    for(rg int i=n+1;i<=(n<<1);++i){\n        if(!b[i])pri[++cnt]=i,F[i]=pw(i);\n        for(rg int j=1,x;j<=cnt&&(x=i*pri[j])<=n;++j){\n            b[x]=1;\n            F[x]=1ll*F[i]*F[pri[j]]%P;\n            if(!(i%pri[j]))break;\n        }\n    }\n    for(rg int i=2;i<=(n<<1);++i)F[i]=M(F[i]+F[i-1]);\n    for(rg int i=2;i<=(n<<1);++i)F[i]=M(F[i]+F[i-1]);\n    int res=0;\n    for(rg int l=1,r,i;l<=n;l=r+1){\n        i=n/l,r=n/i;\n        res=M(res+1ll*M(f[r]-f[l-1]+P)*S(i)%P);\n    }\n    printf(\"%d\\n\",res);\n}\n```\n", "link": "/posts/LG 6156 \u7b80\u5355\u9898/", "tags": ["\u6570\u8bba", "\u83ab\u6bd4\u4e4c\u65af", "\u6570\u8bba\u5206\u5757", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4844 LJJ\u7231\u6570\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4844&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4844\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ecf\u8fc7\u4e00\u756a\u5316\u7b80\u540e\u53d8\u6210\u4e86:\n\n$$\n\\sum_{i=1}^{\\sqrt{2n}} \\sum_{x=L}^{R} [\\gcd(i,x)=1]  \n\\\\\nL=Max(1,i-\\lfloor {n\\over i}\\rfloor)\n\\\\\nR=Min(i-1,\\lfloor {n\\over i }\\rfloor)\n$$\n\n\u83ab\u6bd4\u4e4c\u65af\u53cd\u6f14\n\n$$\n\\sum_{i=1}^{\\sqrt{2n}} \\sum_{j=l}^{R} [\\gcd(i,j)=1]\n\\\\\n=\\sum_{i=1}^{\\sqrt{2n}} \\sum_{j=l}^{R} \\sum_{k|i,k|j} \\mu(k)\n\\\\\n=\\sum_{i=1}^{\\sqrt{2n}}\\sum_{k|j,k\\in[L,R]} \\mu(k)\n$$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=1500011;\ninline int min(int x,int y){return x<y?x:y;}\ninline int max(int x,int y){return x>y?x:y;}\ninline int abs(int x){return x>0?x:-x;}\nll n;\nint m,mu[N],pri[N],cnt=0,head[N];\nbool b[N];\nstruct edge{int to,nxt;}e[N<<4];\ninline void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\ninline ll calc(int x,int k){\n    ll res=0;\n    for(int i=head[x];i&&abs(e[i].to)<=k;i=e[i].nxt)\n        res+=k/e[i].to;\n    return res;\n}\nint main(){\n    scanf(\"%lld\",&n);\n    m=sqrt((n<<1));\n    mu[1]=1;\n    for(int i=2;i<=m;++i){\n        if(!b[i])pri[++cnt]=i,mu[i]=-1;\n        for(int j=1;j<=cnt&&i*pri[j]<=m;++j){\n            b[i*pri[j]]=1;\n            if(i%pri[j])mu[i*pri[j]]=-mu[i];\n            else break;\n        }\n    }\n    cnt=0;\n    for(int i=1;i<=m;++i)\n        for(int j=1;i*j<=m;++j)\n        if(mu[j])add(i*j,mu[j]*j);\n    ll ans=0;\n    for(int i=1;i<=m;++i)\n        ans+=calc(i,min(i-1,n/i))-calc(i,max(1,i-(n/i))-1);\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 4844 LJJ\u7231\u6570\u6570/", "tags": ["\u6570\u8bba", "\u83ab\u6bd4\u4e4c\u65af"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4450 \u53cc\u4eb2\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4450&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4450\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$\n\\sum_{i=1}^A\\sum_{j=1}^B [\\gcd(i,j)=d]\n\\\\\n=\\sum_{i=1}^{\\left \\lfloor \\frac Ad \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac Bd\\right \\rfloor} [\\gcd(i,j)=1]\n\\\\\n=\\sum_{i=1}^{\\left \\lfloor \\frac Ad \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac Bd\\right \\rfloor} \\sum_{x|i,x|j}\\mu(x)\n\\\\\n=\\sum_{x=1}^n\\mu(x) \\left \\lfloor \\frac A{dx} \\right \\rfloor \\left \\lfloor \\frac B{dx}\\right \\rfloor\n$$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000011;\nint n,m,d,mu[N],pri[N],cnt=0;\nbool b[N];\ninline int min(int x,int y){return x<y?x:y;}\nint main(){\n    scanf(\"%d%d%d\",&n,&m,&d);\n    n/=d;m/=d;\n    if(n>m)n^=m,m^=n,n^=m;\n    mu[1]=1;\n    for(int i=2;i<=n;++i){\n        if(!b[i])pri[++cnt]=i,mu[i]=-1;\n        for(int j=1;j<=cnt&&i*pri[j]<=n;++j){\n            b[i*pri[j]]=1;\n            if(i%pri[j])mu[i*pri[j]]=-mu[i];\n            else break;\n        }\n    }\n    for(int i=2;i<=n;++i)mu[i]+=mu[i-1];\n    long long res=0;\n    for(int l=1,r,i,j;l<=n;l=r+1){\n        i=n/l,j=m/l;\n        r=min(n/i,m/j);\n        res+=1ll*(mu[r]-mu[l-1])*i*j;\n    }\n    printf(\"%lld\\n\",res);\n}\n```\n", "link": "/posts/LG 4450 \u53cc\u4eb2\u6570/", "tags": ["\u6570\u8bba", "\u83ab\u6bd4\u4e4c\u65af", "\u6570\u8bba\u5206\u5757"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3935 Calculating", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3935&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3935\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u82e5$x$\u5206\u89e3\u8d28\u56e0\u6570\u7ed3\u679c\u4e3a$x=p_1^{k_1}p_2^{k_2}\\cdots p_n^{k_n}$\n\n\u4ee4$f(x)=(k_1+1)(k_2+1)\\cdots (k_n+1)$\n\n$f(x)$\u5176\u5b9e\u5c31\u662f$d(x)$,$x$\u7684\u7ea6\u6570\u4e2a\u6570\n\n> $p_1^{k_1}$\u7684\u7ea6\u6570\u6709$1,p_1,p_1^2,\\cdots,p_1^{k_1}$\n> \n> $p_2^{k_2}$\u7684\u7ea6\u6570\u6709$1,p_2,p_2^2,\\cdots,p_2^{k_2}$\n> \n> $\\cdots$\n> \n> $p_n^{k_n}$\u7684\u7ea6\u6570\u6709$1,p_n,p_n^2,\\cdots,p_n^{k_n}$\n> \n> \u6839\u636e\u4e58\u6cd5\u539f\u7406,$d(x)=(k_1+1)(k_2+1)\\cdots (k_n+1)$\n\n\u9996\u5148\u53ef\u4ee5\u60f3\u5230\u7684\u662f\n\n$$\n\\sum_{i=l}^r f(i)=\\sum_{i=1}^r f(i) - \\sum_{i=1}^{l-1} f(i)\n$$\n\n\u90a3\u4e48\n\n$$\n\\sum_{i=1}^n f(i)\n\\\\\n=\\sum_{i=1}^n \\sum_{j|i}1\n$$\n\n\u6362\u4e2a\u679a\u4e3e\u987a\u5e8f\n\n$$\n=\\sum_{j=1}^n \\sum_{j|i}1\n\\\\\n=\\sum_{j=1}^n \\left \\lfloor \\frac nj\\right \\rfloor\n$$\n\n\u6700\u540e\u6570\u8bba\u5206\u5757\u5c31\u53ef\u4ee5\u4e86\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\nconst int P=998244353;\ntypedef long long ll;\nint calc(ll n){\n    int res=0;\n    for(ll l=1,r,i;l<=n;l=r+1){\n        i=n/l;r=n/i;\n        (res+=(r-l+1)*i%P)%=P;\n    }\n    return res;\n}\nint main(){\n    ll l,r;scanf(\"%lld%lld\",&l,&r);\n    printf(\"%d\\n\",(calc(r)-calc(l-1)+P)%P);\n}\n```\n", "link": "/posts/LG 3935 Calculating/", "tags": ["\u6570\u8bba", "\u6570\u8bba\u5206\u5757"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3172 [CQOI2015]\u9009\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3172&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3172\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148$L=\\left \\lceil \\frac LK\\right \\rceil,H=\\left \\lceil \\frac HK\\right \\rceil$\n\n\u95ee\u9898\u8f6c\u5316\u4e3a\u5728$[L,H]$\u4e2d\u53d6 $N$\u4e2a$\\gcd=1$\u7684\u6570 \u7684\u65b9\u6848\u6570\n\n\u8bbe$f_i$\u4e3a\u9009\u51fa $N$\u4e2a\u4e0d\u5b8c\u5168\u76f8\u540c$\\gcd=i$\u7684\u6570 \u7684\u65b9\u6848\u6570\n\n\u4ee4$x$\u4e3a$[L,R]$\u4e2d$i$\u7684\u500d\u6570\u7684\u4e2a\u6570,$x=\\sum_{j=L}^H [i|j]=\\left \\lfloor \\frac Hi \\right \\rfloor-\\left \\lfloor \\frac Li \\right \\rfloor$\n\n\u6682\u65f6\u4ee4$f_i=x^N-x$(\u6240\u6709\u51cf\u53bb\u5b8c\u5168\u76f8\u540c\u7684)\n\n\u8fd9\u65f6\u5019$f_i$\u5b9e\u9645\u4e0a\u662f\u9009\u51fa $N$\u4e2a\u4e0d\u5b8c\u5168\u76f8\u540c$i|\\gcd$\u7684\u6570 \u7684\u65b9\u6848\u6570\n\n\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u4e86$f_{2i},f_{3i},...$\u7684\u6700\u7ec8\u7ed3\u679c\n\n\u90a3\u4e48\u628a$f_i$\u51cf\u53bb$f_{2i},f_{3i},...$\u5c31\u53ef\u4ee5\u4e86\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\nconst int N=100011,P=1000000007;\nint n,K,L,H,f[N];\ninline int pw(int x,int b){\n    int ans=1;\n    while(b){\n        if(b&1)ans=1ll*ans*x%P;\n        b>>=1;x=1ll*x*x%P;\n    }\n    return ans;\n}\nint main() {\n    scanf(\"%d%d%d%d\",&n,&K,&L,&H);\n    L=L/K+(L%K!=0);\n    H/=K;\n    if(L>H)return puts(\"0\"),0;\n    for(int i=1;i<=H-L;++i) {\n        int l=L,r=H;\n        l=l/i+(l%i!=0);\n        r/=i;\n        if(l<=r)f[i]=(pw(r-l+1,n)-(r-l+1)+P)%P;\n    }\n    for(int i=H-L;i;--i)\n        for(int j=i<<1;j<=H-L;j+=i)\n            f[i]=(f[i]-f[j]+P)%P;\n    if(L==1)(f[1]+=1)%=P;\n    printf(\"%d\\n\",f[1]);\n}\n```\n", "link": "/posts/LG 3172 [CQOI2015]\u9009\u6570/", "tags": ["\u6570\u8bba", "\u83ab\u6bd4\u4e4c\u65af", "\u5bb9\u65a5", "\u9012\u63a8"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3911 \u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3911&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3911\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$\\sum_{i=1}^n\\sum_{j=1}^n lcm(A_i,A_j)$\n\n\u8bbe$a_i = \\sum_{j=1}^n [A_j=i]$\n\n\u90a3\u4e48\n\n$$\nans = \\sum_i^n \\sum_j^n a_ia_j \\frac{ij}{\\gcd(i,j)}\n\\\\\n= \\sum_{d=1}^n \\frac 1d \\sum_{i=1}^n \\sum_{j=1}^n a_ia_j ij[\\gcd(i,j)=d]\n\\\\ \n= \\sum_{d=1}^n \\sum_{i=1}^{\\frac nd} \\sum_{j=1}^{\\frac nd}d \\times a_{id}a_{jd}ij[\\gcd(i,j)=1]\n\\\\\n\\text{\u5509,\u5230\u8fd9\u91cc\u6211\u5c31\u4e0d\u4f1a\u4e86}\n\\\\\n=\\sum_{p=1}^np\\sum_{i=1}^{n/p}\\sum_{j=1}^{n/p}a_{ip}a_{jp}ij\\sum_{d|i,d|j}\\mu(d)\n\\\\\n=\\sum_{p=1}^np\\sum_{d=1}^n\\mu(d)d^2\\sum_{i=1}^{n/dp}\\sum_{j=1}^{n/dp}a_{idp}a_{jdp}ij\n\\\\\n=\\sum_{q=1}^nq\\sum_{d|q}d\\mu(d)\\sum_{i=1}^{n/q}\\sum_{j=1}^{n/q}a_{iq}a_{jq}ij\n\\\\\n=\\sum_{q=1}^nq\\sum_{d|q}d\\mu(d)\\left(\\sum_{i=1}^{n/q}a_{iq}i\\right)^2\n$$\n\n<!-- more -->\n\n```cpp\n#include <cstdio>\nusing namespace std;\n\nint prime[50010], mu[50010], tot, fuck = 50000;\nbool vis[50010];\nlong long sum1[50010], sum2[50010];\nint bucket[50010];\n\nint main(){\n    mu[1] = 1;\n    for (int i = 2; i <= fuck; i++){\n        if (vis[i] == false) prime[++tot] = i, mu[i] = -1;\n        for (int j = 1; j <= tot && i * prime[j] <= fuck; j++){\n            vis[i * prime[j]] = true;\n            if (i % prime[j] == 0) break;\n            mu[i * prime[j]] = -mu[i];\n        }\n        mu[i] *= i;\n    }\n    for (int d = 1; d <= fuck; d++)\n        for (int q = d; q <= fuck; q += d)\n            sum1[q] += mu[d];\n    for (int i = 1; i <= fuck; i++)\n        sum1[i] *= i;\n    int n; scanf(\"%d\", &n);\n    for (int x, i = 1; i <= n; i++)\n        scanf(\"%d\", &x), bucket[x]++;\n    long long ans = 0;\n    for (int q = 1; q <= fuck; q++){\n        int sb = fuck / q;\n        for (int i = 1; i <= sb; i++)\n            sum2[q] += bucket[i * q] * (long long)i;\n        ans += sum2[q] * sum1[q] * sum2[q];\n    }\n    printf(\"%lld\\n\", ans);\n    return 0;\n}\n```\n", "link": "/posts/LG 3911 \u6700\u5c0f\u516c\u500d\u6570\u4e4b\u548c/", "tags": ["\u83ab\u6bd4\u4e4c\u65af", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3768 \u7b80\u5355\u7684\u6570\u5b66\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3768&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3768\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u524d\u7f6e\u77e5\u8bc6: \n\n1. [\u675c\u6559\u7b5b](http://blog.zcmimi.top/posts/du-jiao-shai/)(\u5305\u62ec[\u72c4\u5229\u514b\u96f7\u5377\u79ef](http://blog.zcmimi.top/posts/di-li-ke-lei-juan-ji/))\n   \n2. \u6570\u8bba\u5206\u5757\n   \n3. \u6b27\u62c9\u51fd\u6570 \u6216 \u83ab\u6bd4\u4e4c\u65af\u51fd\u6570 \n   \n~~(\u4f1a\u675c\u6559\u7b5b\u7684\u5927\u4f6c\u4e0a\u8ff0\u90fd\u4f1a\u5427)~~\n\n## \u6b27\u62c9\u51fd\u6570\u5377\u79ef\u63a8\u5bfc\n\n$$\\sum_{i=1}^n\\sum_{j=1}^n ijgcd(i,j)$$\n\n\u6839\u636e $\\sum\\limits_{i|n}\\varphi(n)=n$ ($1 * \\varphi = Id$)\n\n$$= \\sum_{i=1}^n\\sum_{j=1}^n ij \\sum_{k|i,k|j} \\varphi(k)$$\n\n\u8c03\u6362\u679a\u4e3e\u987a\u5e8f\n\n$$\n= \\sum_{k=1}^n \\varphi(k) \\sum_{k|i,k|j} ij\n\\\\\n= \\sum_{k=1}^n \\varphi(k) \\sum_{k|i}i \\sum_{k|j}j\n\\\\\n= \\sum_{k=1}^n \\varphi(k) (\\sum_{i=1}^{\\left \\lfloor\\frac nk\\right\\rfloor}ki)^2\n\\\\\n= \\sum_{k=1}^n \\varphi(k) k^2(\\sum_{i=1}^{\\left \\lfloor\\frac nk\\right\\rfloor}i)^2\n$$\n\n## \u83ab\u6bd4\u4e4c\u65af\u51fd\u6570\u63a8\u5bfc\n\n$$\n\\sum_{i=1}^n\\sum_{j=1}^n ijgcd(i,j)\n\\\\\n=\\sum_{d=1}^n d \\sum_{i=1}^n\\sum_{j=1}^n ij [gcd(i,j)=d]\n\\\\\n=\\sum_{d=1}^n d^3 \\sum_{i=1}^{\\left \\lfloor\\frac nd\\right\\rfloor}\\sum_{j=1}^{\\left \\lfloor\\frac nd\\right\\rfloor} ij [gcd(i,j)=1]\n\\\\\n=\\sum_{d=1}^n d^3 \\sum_{i=1}^{\\left \\lfloor\\frac nd\\right\\rfloor}\\sum_{j=1}^{\\left \\lfloor\\frac nd\\right\\rfloor} ij \\sum_{k|i,k|j}\\mu(k)\n\\\\\n=\\sum_{d=1}^n d^3 \\sum_{k=1}^{\\left \\lfloor\\frac nd\\right\\rfloor}\\mu(k) \\sum_{k|i,k|j} ij\n\\\\\n=\\sum_{d=1}^n d^3 \\sum_{k=1}^{\\left \\lfloor\\frac nd\\right\\rfloor}\\mu(k) k^2(\\sum_{k|i}i)^2\n$$\n\n\u4e3a\u4e86\u65b9\u4fbf,\u8bbe$sum(T)=\\sum_{i=1}^T i$\n\n$$\n=\\sum_{d=1}^n d^3 \\sum_{k=1}^{\\left \\lfloor\\frac nd\\right\\rfloor}\\mu(k)k^2sum(\\left \\lfloor \\frac n{dk}\\right \\rfloor)^2\n$$\n\n\u4ee4$T=dk$\n\n$$\n=\\sum_{T=1}^n sum(\\left \\lfloor \\frac nT\\right \\rfloor)^2 \\sum_{d|T}d^3 \\frac{T^2}{d^2}\\mu(\\frac Td)\n\\\\\n=\\sum_{T=1}^n sum(\\left \\lfloor \\frac nT\\right \\rfloor)^2 T^2\\sum_{d|T}d\\mu(\\frac Td)\n$$\n\n\u5176\u4e2d: $\\sum_{d|T}d\\mu(\\frac Td)=\\varphi(T)$($\\mu * Id = \\varphi$)\n\n$$\n=\\sum_{T=1}^n sum(\\left \\lfloor \\frac nT\\right \\rfloor)^2 T^2 \\varphi(T)\n$$\n\n~~\u4e0a\u8ff0\u4e24\u79cd\u65b9\u6cd5\u63a8\u5bfc\u51fa\u7684\u6700\u7ec8\u7ed3\u679c\u662f\u4e00\u6837\u7684~~\n\n\u63a5\u4e0b\u6765:\n\n$\\sum_{k=1}^n \\varphi(k)$\u7528\u675c\u6559\u7b5b\u6c42\u51fa\u524d\u7f00\u548c\n\n$k^2(\\sum_{i=1}^{\\left \\lfloor\\frac nk\\right\\rfloor}i)^2$\u53ef\u4ee5\u7528\u6570\u8bba\u5206\u5757\u6c42\u89e3\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=5000000,P=1000007;\nstruct hash{\n    int cnt=0,head[P];\n    struct edge{int to,nxt,w;}e[P];\n    void add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\n    void ins(int x,int v){add(x%P,x,v);}\n    int ask(int x){for(int i=head[x%P];i;i=e[i].nxt)if(e[i].to==x)return e[i].w;return -1;}\n}S;\nint pri[N+11],phi[N+11],p,inv,lim;\nbool b[N+11];\nint sum(ll n){n%=p;return (1ll*n*(n+1)>>1)%p;}\nint SUM(ll n){n%=p;return 1ll*n*(n+1)%p*(n+n+1)%p*inv%p;}\nil void init(){\n    phi[1]=1;\n    int cnt=0;\n    for(int i=2;i<=lim;++i){\n        if(!b[i])pri[++cnt]=i,phi[i]=i-1;\n        for(int j=1;j<=cnt&&i*pri[j]<=lim;++j){\n            b[i*pri[j]]=1;\n            if(i%pri[j])phi[i*pri[j]]=phi[i]*(pri[j]-1)%p;\n            else{phi[i*pri[j]]=phi[i]*pri[j]%p;break;}\n        }\n    }\n    for(int i=1;i<=lim;++i)phi[i]=(phi[i-1]+1ll*i*i%p*phi[i]%p)%p;\n}\nint PHI(ll n){\n    if(n<=lim)return phi[n];\n    int t=S.ask(n);if(~t)return t;\n    int res=sum(n);res=1ll*res*res%p;\n    for(ll l=2,r;l<=n;l=r+1){\n        r=n/(n/l);\n\t\tint s=(SUM(r)-SUM(l-1)+p)%p;\n        res=(res-1ll*PHI(n/l)*s%p+p)%p;\n    }\n    S.ins(n,res);\n    return res;\n}\nint pw(int x,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1)ans=1ll*ans*x%p;\n\t\tb>>=1;x=1ll*x*x%p;\n\t}\n\treturn ans;\n}\nint main(){\n\tll n;\n\tscanf(\"%lld%lld\",&p,&n);\n\tinv=pw(6,p-2),lim=pow(n,2.0/3);\n    init();\n\tint res=0,s,phi;\n    for(ll l=1,r;l<=n;l=r+1){\n\t\tr=n/(n/l);\n\t\ts=sum(n/l),phi=(PHI(r)-PHI(l-1)+p)%p;\n\t\tres=(res+1ll*s*s%p*phi%p)%p;\n\t}\n\tprintf(\"%d\\n\",res);\n}\n```\n\n\u4e0b\u65b9\u662f\u66f4\u52a0\u7384\u5b66\u4f18\u5316\u7684\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\nconst int N=5000000;\nint b[N+11],pri[N+11],phi[N+11],p,inv,lim,s[N],S[N],sqr,ans[N];ll n;\nint id(ll x){return x<=sqr?x:sqr+n/x;}\nint PHI(ll n){\n\tint x=id(n);\n    if(n<=lim)return phi[n];\n    if(ans[x])return ans[x];\n    int res=s[x];\n    for(register ll l=2,r,i;l<=n;l=r+1)\n        i=n/l,r=n/i,\n        res=(res-1ll*PHI(i)*(S[id(r)]-S[id(l-1)]))%p;\n    return ans[x]=res;\n}\nint pw(int x,int b){\n\tint ans=1;\n\twhile(b){\n\t\tif(b&1)ans=1ll*ans*x%p;\n\t\tb>>=1;x=1ll*x*x%p;\n\t}\n\treturn ans;\n}\nint main(){\n\tscanf(\"%d%lld\",&p,&n);\n\tinv=pw(6,p-2),lim=pow(n,2.0/3);sqr=sqrt(n);\n    phi[1]=1;\n    int cnt=0,x,res=0;\n    for(register int i=2;i<=lim;++i){\n        if(!b[i])b[i]=pri[++cnt]=i,phi[i]=i-1;\n        for(register int j=1,y;j<=cnt&&pri[j]<=b[i]&&(y=pri[j]*i)<=lim;++j)\n            b[y]=pri[j],phi[y]=i%pri[j]?phi[i]*phi[pri[j]]:phi[i]*pri[j];\n    }\n    for(register int i=1;i<=lim;++i)phi[i]=(phi[i-1]+1ll*i*i%p*phi[i]%p)%p;\n\tfor(register ll l=1,r,i;l<=n;l=r+1)\n        i=n/l,r=n/i,\n        x=id(i),\n        i%=p,\n        S[x]=1ll*inv*i%p*(i+1)%p*(i+i+1)%p,\n        s[x]=((1ll*i*(i+1))>>1)%p,s[x]=1ll*s[x]*s[x]%p;    \n    for(register ll l=1,r,i;l<=n;l=r+1)\n\t\ti=n/l,r=n/i,\n\t\tres=(res+1ll*s[id(i)]*(PHI(r)-PHI(l-1)))%p;\n\tif(res<0)res+=p;\n\tprintf(\"%d\\n\",res);\n}\n```\n", "link": "/posts/LG 3768 \u7b80\u5355\u7684\u6570\u5b66\u9898/", "tags": ["\u6570\u8bba", "\u6b27\u62c9\u51fd\u6570", "\u675c\u6559\u7b5b", "\u83ab\u6bd4\u4e4c\u65af"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1447 [NOI2010]\u80fd\u91cf\u91c7\u96c6", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1447&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1447\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u4e2a\u70b9$(x,y)$\u548c\u539f\u70b9\u4e4b\u95f4\u7684\u70b9\u6570\u4e3a$gcd(x,y)-1$\n\n\u8bbe$n<m$\n\n$$\n\u8bbet=\\sum_{i=1}^n \\sum_{j=1}^m gcd(i,j)\n\\\\\n=\\sum_{d=1}^n d \\sum_{i=1}^n \\sum_{j=1}^m [gcd(i,j)=d]\n\\\\\n=\\sum_{d=1}^n d \\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor} \\sum_{j=1}^{\\left \\lfloor \\frac md \\right \\rfloor} [gcd(i,j)=1]\n\\\\\n=\\sum_{d=1}^n d \\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor} \\sum_{j=1}^{\\left \\lfloor \\frac md \\right \\rfloor} \\sum_{k|gcd(i,j)}\\mu(k)\n\\\\\n=\\sum_{d=1}^n d \\sum_{k=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\mu(k)\\left \\lfloor \\frac n{dk} \\right \\rfloor \\left \\lfloor \\frac m{dk} \\right \\rfloor\n\\\\\nans = 2*t-n*m\n$$\n\n\u8bb0\u5f97long long\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N  1000000\nint a,b,d,mu[N+11],pri[N+11],tot=0;\nbool f[N+11];\nvoid sm(int n){\n\tf[1]=mu[1]=1;\n\tFur(i,2,n){\n\t\tif(!f[i])pri[++tot]=i,mu[i]=-1;\n\t\tFur(j,1,tot){\n\t\t\tif(pri[j]*i>n)break;\n\t\t\tf[i*pri[j]]=1;\n\t\t\tif(i%pri[j])mu[i*pri[j]]=-mu[i];\n\t\t\telse break;\n\t\t}\n\t}\n\tFur(i,2,n)mu[i]+=mu[i-1];\n}\nint main(){\n\tsm(N);\n\tin>>a>>b;\n\tif(a>b)SWAP(a,b);\n\tll ans=0;\n\tFur(d,1,a){\n\t\tint n=a/d,m=b/d;\n\t\tfor(int l=1,r=0;l<=n;l=r+1){\n\t\t\tr=MIN(n/(n/l),m/(m/l));\n\t\t\tans+=1ll*d*(n/l)*(m/l)*(mu[r]-mu[l-1]);\n\t\t}\n\t}\n\tout<<(ll)(1ll*2*ans-a*b)<<ln;\n}\n```\n", "link": "/posts/LG 1447 [NOI2010]\u80fd\u91cf\u91c7\u96c6/", "tags": ["\u6570\u8bba", "\u6b27\u62c9\u51fd\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4213 \u3010\u6a21\u677f\u3011\u675c\u6559\u7b5b\uff08Sum\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4213&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4213\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\ntypedef long long ll;\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nconst int N=5000000;\nint mu[N+11],pri[N+1];\nll phi[N+11];\nbool b[N+11];\nil void init(){\n    mu[1]=phi[1]=1;\n    int cnt=0;\n    for(int i=2;i<=N;++i){\n        if(!b[i])pri[++cnt]=i,mu[i]=-1,phi[i]=i-1;\n        for(int j=1;j<=cnt&&i*pri[j]<=N;++j){\n            b[i*pri[j]]=1;\n            if(i%pri[j])mu[i*pri[j]]=-mu[i],phi[i*pri[j]]=phi[i]*(pri[j]-1);\n            else{phi[i*pri[j]]=phi[i]*pri[j];break;}\n        }\n    }\n    for(int i=2;i<=N;++i)mu[i]+=mu[i-1],phi[i]+=phi[i-1];\n}\nconst int P=1000007;\nstruct hash{\n    int cnt=0,head[P];\n    struct edge{int to,nxt;ll w;}e[P];\n    il void add(int x,int y,ll w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\n    il void ins(int x,ll v){add(x%P,x,v);}\n    il ll ask(int x){for(int i=head[x%P];i;i=e[i].nxt)if(e[i].to==x)return e[i].w;return 1ll<<63;}\n}SP,SM;\nll PHI(int n){\n    if(n<=N)return phi[n];\n    ll t=SP.ask(n);if(t!=(1ll<<63))return t;\n    ll res=1ll*n*(n+1)/2;\n    for(ll l=2,r;l<=n;l=r+1){\n        r=n/(n/l);\n        res-=PHI(n/l)*(r-l+1);\n    }\n    SP.ins(n,res);\n    return res;\n}\nll MU(int n){\n    if(n<=N)return mu[n];\n    ll t=SM.ask(n);if(t!=(1ll<<63))return t;\n    ll res=1;\n    for(ll l=2,r;l<=n;l=r+1){\n        r=n/(n/l);\n        res-=MU(n/l)*(r-l+1);\n    }\n    SM.ins(n,res);\n    return res;\n}\nint main(){\n    init();\n    int T,n;scanf(\"%d\",&T);\n    while(T--){\n        scanf(\"%d\",&n);\n        printf(\"%lld %lld\\n\",PHI(n),MU(n));\n    }\n}\n```\n", "link": "/posts/LG 4213 \u3010\u6a21\u677f\u3011\u675c\u6559\u7b5b\uff08Sum\uff09/", "tags": ["\u675c\u6559\u7b5b", "\u83ab\u6bd4\u4e4c\u65af", "\u6b27\u62c9\u51fd\u6570", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3455 [POI2007]ZAP-Queries", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3455&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3455\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$\nf=\\sum_{i=1}^{a}\\sum_{j=1}^{b}[gcd(i,j)=d]\n\\\\\nf=\\sum_{i=1}^{\\left \\lfloor \\frac ad \\right \\rfloor} \\sum_{j=1}^{\\left \\lfloor \\frac bd \\right \\rfloor} [gcd(i,j)=1]\n\\\\\n\\because \\sum_{x|n} \\mu(x) = [n=1]\n\\\\\n\\therefore \nf= \\sum_{i=1}^{\\left \\lfloor \\frac ad \\right \\rfloor} \\sum_{j=1}^{\\left \\lfloor \\frac bd \\right \\rfloor}\n\\sum_{k|gcd(i,j)} \\mu(k)\n\\\\\nf=\\sum_{k=1}^{\\left \\lfloor \\frac ad \\right \\rfloor}\\mu(k)\\left \\lfloor \\frac a{dk} \\right \\rfloor \\left \\lfloor \\frac b{dk} \\right \\rfloor\n$$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10000000\nint a,b,d,t,mu[N+11],pri[N+11],tot=0;\nbool f[N+11];\nvoid sm(int n){\n\tf[1]=mu[1]=1;\n\tFur(i,2,n){\n\t\tif(!f[i])pri[++tot]=i,mu[i]=-1;\n\t\tFur(j,1,tot){\n\t\t\tif(pri[j]*i>n)break;\n\t\t\tf[i*pri[j]]=1;\n\t\t\tif(i%pri[j])mu[i*pri[j]]=-mu[i];\n\t\t\telse break;\n\t\t}\n\t}\n\tFur(i,2,n)mu[i]+=mu[i-1];\n}\nint main(){\n\tsm(N);\n\tin>>t;\n\twhile(t--){\n\t\tin>>a>>b>>d;\n\t\tint n=a/d,m=b/d,ans=0;\n\t\tif(n>m)SWAP(n,m);\n\t\tfor(int l=1,r=0;l<=n;l=r+1){\n\t\t\tr=MIN(n/(n/l),m/(m/l));\n\t\t\tans+=(n/l)*(m/l)*(mu[r]-mu[l-1]);\n\t\t}\n\t\tout<<ans<<ln;\n\t}\n}\n```\n", "link": "/posts/LG 3455 [POI2007]ZAP-Queries/", "tags": ["\u6570\u8bba", "\u83ab\u6bd4\u4e4c\u65af"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2522 [HAOI2011]Problem-b", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2522&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2522\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u628a\u9898\u76ee\u5f3a\u884c\u8f6c\u6362\u4e3a[[POI2007]ZAP-Queries](https://www.luogu.org/problemnew/show/P3455)\n\n\n$Ans((1,b),(1,d))-Ans((1,b),(1,c-1))-Ans((1,a-1),(1,d))+Ans((1,a-1),(1,c-1))$\n\n\n\n$$\nf=\\sum_{i=1}^{a}\\sum_{j=1}^{b}[gcd(i,j)=d] \\\\\nf=\\sum_{i=1}^{\\left \\lfloor \\frac ad \\right \\rfloor} \\sum_{j=1}^{\\left \\lfloor \\frac bd \\right \\rfloor} [gcd(i,j)=1] \\\\\n\\because \\sum_{x|n} \\mu(x) = [n=1] \\\\\n\\therefore \nf= \\sum_{i=1}^{\\left \\lfloor \\frac ad \\right \\rfloor} \\sum_{j=1}^{\\left \\lfloor \\frac bd \\right \\rfloor}\n\\sum_{k|gcd(i,j)} \\mu(k) \\\\\nf=\\sum_{k=1}^{\\left \\lfloor \\frac ad \\right \\rfloor}\\mu(k)\\left \\lfloor \\frac a{dk} \\right \\rfloor \\left \\lfloor \\frac b{dk} \\right \\rfloor\n$$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 50000\nint t,d,mu[N+11],pri[N+11],tot=0;\nbool f[N+11];\nvoid sm(int n){\n\tf[1]=mu[1]=1;\n\tFur(i,2,n){\n\t\tif(!f[i])pri[++tot]=i,mu[i]=-1;\n\t\tFur(j,1,tot){\n\t\t\tif(pri[j]*i>n)break;\n\t\t\tf[i*pri[j]]=1;\n\t\t\tif(i%pri[j])mu[i*pri[j]]=-mu[i];\n\t\t\telse break;\n\t\t}\n\t}\n\tFur(i,2,n)mu[i]+=mu[i-1];\n}\nint ask(int a,int b){\n\tint n=a/d,m=b/d,ans=0;\n\tif(n>m)SWAP(n,m);\n\tfor(int l=1,r=0;l<=n;l=r+1){\n\t\tr=MIN(n/(n/l),m/(m/l));\n\t\tans+=(n/l)*(m/l)*(mu[r]-mu[l-1]);\n\t}\t\n\treturn ans;\n}\nint main(){\n\tsm(N);\n\tin>>t;\n\twhile(t--){\n\t\tint a,b,c,D;\n\t\tin>>a>>b>>c>>D>>d;\n\t\tout<<ask(b,D)-ask(b,c-1)-ask(a-1,D)+ask(a-1,c-1)<<ln;\n\t}\n}\n```\n", "link": "/posts/LG 2522 [HAOI2011]Problem-b/", "tags": ["\u6570\u8bba", "\u6b27\u62c9\u51fd\u6570", "\u83ab\u6bd4\u4e4c\u65af"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3704 [SDOI2017]\u6570\u5b57\u8868\u683c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3704&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3704\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$n<m$\n$$\n\\prod_{i=1}^n \\prod_{j=1}^m f_{\\gcd(i,j)}\n\\\\\n=\\prod_{d=1}^n{f_d}^{\\sum_{i=1}^n \\sum_{j=1}^m[\\gcd(i,j)=d]}\n\\\\\n=\\prod_{d=1}^n{f_d}^{\\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor} \\sum_{j=1}^{\\left \\lfloor \\frac md \\right \\rfloor}[\\gcd(i,j)=1]}\n\\\\\n=\\prod_{d=1}^n{f_d}^{\\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor} \\mu(i) \\left \\lfloor \\frac n{id}\\right \\rfloor \\left \\lfloor \\frac m{id}\\right \\rfloor}\n$$\n\n\u6570\u8bba\u5206\u5757\u5957\u6570\u8bba\u5206\u5757\u4f1atle,\u7ee7\u7eed\u8001\u5957\u8def\u4f18\u5316\n\n\u4ee4$T=id$\n\n$$\n=\\prod_{T=1}^n\\sum_{d|T}{f_d}^{\\mu(\\frac Td) \\left \\lfloor \\frac n{T}\\right \\rfloor \\left \\lfloor \\frac m{T}\\right \\rfloor}\n$$\n\n\u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa\u51fd\u6570$s(T)=\\sum_{d|T}{f_d}^{\\mu(\\frac Td)}$\u7684\u524d\u7f00\u79ef\n\n\u7136\u540e\u5c31\u53ef\u4ee5\u505a\u5230\u6570\u8bba\u5206\u5757$O(\\sqrt n)$\u7684\u590d\u6742\u5ea6\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nil int min(int x,int y){return x<y?x:y;}\nconst int N=1000000,P=1000000007;\nint n,cnt=0,pri[78500],mu[N+11],f[N+11],g[N+11],s[N+11];\nbool b[N+11];\nil int pw(int x,int b){\n    int ans=1;\n    while(b){\n        if(b&1)ans=1ll*ans*x%P;\n        b>>=1;x=1ll*x*x%P;\n    }\n    return ans;\n}\nil int inv(int x){return pw(x,P-2);}\nint main(){\n    mu[1]=f[1]=g[1]=s[0]=s[1]=1;\n    for(int i=2;i<=N;++i){\n        f[i]=(f[i-1]+f[i-2])%P;\n        g[i]=inv(f[i]);\n        s[i]=1;\n        if(!b[i])pri[++cnt]=i,mu[i]=-1;\n        for(int j=1;j<=cnt&&i*pri[j]<=N;++j){\n            b[i*pri[j]]=1;\n            if(i%pri[j])mu[i*pri[j]]=-mu[i];\n            else break;\n        }\n    }\n    for(int i=1;i<=N;++i)\n    if(mu[i])for(int j=i;j<=N;j+=i)\n         s[j]=1ll*s[j]*(~mu[i]?f[j/i]:g[j/i])%P;\n    for(int i=2;i<=N;++i)s[i]=1ll*s[i]*s[i-1]%P;\n    int T;in(T);\n    while(T--){\n        int n,m,ans=1;\n        in(n,m);\n        if(n>m)n^=m,m^=n,n^=m;\n        for(int l=1,r;l<=n;l=r+1){\n            r=min(n/(n/l),m/(m/l));\n            ans=1ll*ans*pw(1ll*s[r]*inv(s[l-1])%P,1ll*(n/l)*(m/l)%(P-1))%P;\n        }\n        out(ans,ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3704 [SDOI2017]\u6570\u5b57\u8868\u683c/", "tags": ["\u6570\u8bba", "\u83ab\u6bd4\u4e4c\u65af", "\u6590\u6ce2\u90a3\u5951"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3312 [SDOI2014]\u6570\u8868", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3312&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3312\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$n<m$,$\\sigma(d)$\u4e3a$d$\u7684\u7ea6\u6570\u548c\n\n\u5148\u4e0d\u8003\u8651$\\sigma(\\gcd(i,j))\\le a$\n\n$$\n\\sum_{i=1}^n\\sum_{j=1}^m \\sigma(\\gcd(i,j))\n\\\\\n=\\sum_{d=1}^n \\sigma(d) \\sum_{i=1}^n\\sum_{j=1}^m [\\gcd(i,j)=d]\n\\\\\n=\\sum_{d=1}^n \\sigma(d) \\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac md \\right \\rfloor} [\\gcd(i,j)=1]\n\\\\\n=\\sum_{d=1}^n \\sigma(d) \\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac md \\right \\rfloor} \\sum_{x|i,x|j} \\mu(x)\n\\\\\n=\\sum_{d=1}^n \\sigma(d) \\sum_{x=1}^{\\left \\lfloor \\frac nd \\right \\rfloor} \\mu(x) {\\left \\lfloor \\frac n{dx} \\right \\rfloor}{\\left \\lfloor \\frac m{dx} \\right \\rfloor}\n$$\n\n\u4ee4$T=dx$\n\n$$\n=\\sum_{T=1}^n {\\left \\lfloor \\frac nT \\right \\rfloor}{\\left \\lfloor \\frac mT \\right \\rfloor}\\sum_{d|T}\\sigma(d) \\mu(\\left \\lfloor \\frac Td \\right \\rfloor) \n$$\n\n\u8003\u8651$a$\u7684\u9650\u5236\n\n\u8bbe$g(T)=\\sum_{d|T}\\sigma(d) \\mu(\\left \\lfloor \\frac Td \\right \\rfloor)$\n\n\u53ef\u4ee5\u53d1\u73b0\u5f53$d\\ge a$\u7684\u65f6\u5019\u624d\u4f1a\u4ea7\u751f\u8d21\u732e\n\n\u5c06\u8be2\u95ee\u6309$a$\u6392\u5e8f\n\n\u6bcf\u6b21\u8be2\u95ee\u7684\u65f6\u5019,\u6309\u500d\u6570\u679a\u4e3e\u627e\u5230\u6240\u6709\u65b0\u7684\u53ef\u4ee5\u4ea7\u751f\u8d21\u732e\u7684$T$,\n\n\u52a8\u6001\u4fee\u6539$g(T)$,\u53ef\u4ee5\u9009\u62e9\u6811\u72b6\u6570\u7ec4\u8fd9\u79cd\u53c8\u77ed\u5e38\u6570\u53c8\u5c0f\u7684\u597d\u4e1c\u897f\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100000;\nstruct que{int n,m,a,id;bool operator<(que t)const{return a<t.a;}}q[20001];\nstruct bit{\n    int s[N+11];\n    il void add(int x,int v){for(int i=x;i<=N;i+=i&-i)s[i]+=v;}\n    il int ask(int x){int ans=0;for(int i=x;i;i-=i&-i)ans+=s[i];return ans;}\n    il int ask(int l,int r){return ask(r)-ask(l-1);}\n}S;\nint T,mu[N+11],g[N+11],pri[N],cnt=0,ANS[N];\nbool b[N+11];\nil int min(int x,int y){return x<y?x:y;}\npair<int,int>f[N+11];\nil int sum(int n,int m){\n    int ans=0;\n    for(int l=1,r;l<=n;l=r+1){\n        r=min(n/(n/l),m/(m/l));\n        ans+=(mu[r]-mu[l-1])*(n/l)*(m/l);\n    }\n    return ans;\n}\nint main(){\n    mu[1]=1;f[1]=make_pair(1,1);\n    for(int i=2;i<=N;++i){\n        if(!b[i])pri[++cnt]=i,mu[i]=-1,g[i]=i+1,f[i]=make_pair(i+1,i);\n        for(int j=1;j<=cnt&&pri[j]*i<=N;++j){\n            b[i*pri[j]]=1;\n            if(i%pri[j]){\n                mu[i*pri[j]]=-mu[i];\n                g[i*pri[j]]=pri[j]+1;\n                f[i*pri[j]]=make_pair(f[i].first*f[pri[j]].first,i*pri[j]);\n            }\n            else{\n                g[i*pri[j]]=g[i]*pri[j]+1;\n                f[i*pri[j]]=make_pair(f[i].first/g[i]*g[i*pri[j]],i*pri[j]);\n                break;\n            }\n        }\n    }\n    sort(f+1,f+N+1);\n    in(T);\n    for(int i=1;i<=T;++i)in(q[i].n,q[i].m,q[i].a),q[i].id=i;\n    sort(q+1,q+T+1);\n    for(int t=1,j=1;t<=T;++t){\n        int n=q[t].n,m=q[t].m,a=q[t].a,&ans=ANS[q[t].id];\n        if(n>m)n^=m,m^=n,n^=m;\n        for(;f[j].first<=a&&j<=N;++j)\n            for(int k=f[j].second;k<=N;k+=f[j].second)\n                S.add(k,f[j].first*mu[k/f[j].second]);\n        for(int l=1,r;l<=n;l=r+1){\n            r=min(n/(n/l),m/(m/l));\n            ans+=S.ask(l,r)*(n/l)*(m/l);\n        }\n    }\n    for(int i=1;i<=T;++i)out(ANS[i]&(~(1<<31)),ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3312 [SDOI2014]\u6570\u8868/", "tags": ["\u6570\u8bba", "\u83ab\u6bd4\u4e4c\u65af"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1829 [\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1829&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1829\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6c42:\n$$\\sum_{i=1}^n\\sum_{j=1}^mlcm(i,j)$$\n\n\u8bbe$n<m$\n$$\n\\sum_{i=1}^n\\sum_{j=1}^mlcm(i,j)\n\\\\\n=\\sum_{i=1}^n\\sum_{j=1}^m \\frac{ij}{\\gcd(i,j)}\n\\\\\n=\\sum_{d=1}^n\\sum_{i=1}^n\\sum_{j=1}^m \\frac {ij}d[\\gcd(i,j)=d]\n$$\n\n\u8bbe$i'=\\left \\lfloor \\frac id \\right \\rfloor,j'=\\left \\lfloor \\frac jd \\right \\rfloor$\n\n$$\n\\\\\n=\\sum_{d=1}^n\\sum_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac md \\right \\rfloor} ijd[\\gcd(i,j)=1]\n$$\n\n\u628a$\\sum\\limits_{i=1}^{\\left \\lfloor \\frac nd \\right \\rfloor}\\sum\\limits_{j=1}^{\\left \\lfloor \\frac md \\right \\rfloor} ij[\\gcd(i,j)=1]$\u62c6\u51fa\u6765,\n\n\u8bbe$sum(n,m)=$\n\n$$\n\\sum_{i=1}^n\\sum_{j=1}^n ij[\\gcd(i,j)=1]\n\\\\\n=\\sum_{i=1}^n\\sum_{j=1}^m\\sum_{d|gcd(i,j)} ij\\mu(d)\n\\\\\n=\\sum_{d=1}^n\\sum_{d|i}\\sum_{d|j} ij\\mu(d)\n$$\n\n\u8bbe$i'=\\left \\lfloor \\frac id \\right \\rfloor,j'=\\left \\lfloor \\frac jd \\right \\rfloor$\n\n$$\n=\\sum_{d=1}^n\\mu(d)d^2\\sum_{i=1}^{\\left \\lfloor \\frac nd\\right \\rfloor}\\sum_{j=1}^{\\left \\lfloor \\frac md\\right \\rfloor} ij\n$$\n\n\u8bbe$g(n,m)=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^mij$\n\n$$\ng(n,m)=\\frac{n(n+1)}2\\cdot \\frac{m(n+1)}2\n$$\n\n\u6700\u540e\n\n$$\nans=\\sum_{d=1}^n d\\cdot sum(\\left\\lfloor \\frac nd \\right\\rfloor,\\left\\lfloor \\frac md \\right\\rfloor)\n\\\\\nsum(n,m)=\\sum_{d=1}^n\\mu(d)d^2 g(\\left\\lfloor \\frac nd \\right\\rfloor,\\left\\lfloor \\frac md \\right\\rfloor)\n$$\n<!-- more -->\n\n```cpp\n#include<cstdio>\nint min(int x,int y){return x<y?x:y;}\nconst int N=10000001,P=20101009;\nint mu[N],pri[664580],cnt=0,s[N];\nbool f[N];\nint g(int n,int m){return 1ll*(1ll*n*(n+1)/2%P)*(1ll*m*(m+1)/2%P)%P;}\nint sum(int n,int m){\n    if(n>m)n^=m,m^=n,n^=m;\n    int ans=0;\n    for(int l=1,r;l<=n;l=r+1){\n        r=min(n/(n/l),m/(m/l));\n        ans+=1ll*((s[r]-s[l-1]+P)%P)*g(n/l,m/l)%P;\n        ans%=P;\n    }\n    return ans;\n}\nint main(){\n    int n,m,k,ans=0;\n    scanf(\"%d%d\",&n,&m);\n    if(n>m)n^=m,m^=n,n^=m;\n    mu[1]=1;\n    for(int i=2;i<=n;++i){\n        if(!f[i])pri[++cnt]=i,mu[i]=-1;\n        for(int j=1;j<=cnt&&pri[j]*i<=n;++j){\n            f[i*pri[j]]=1;\n            if(i%pri[j])mu[i*pri[j]]=-mu[i];\n            else break;\n        }\n    }\n    for(int i=1;i<=n;++i)s[i]=(s[i-1]+1ll*mu[i]*i*i%P+P)%P;\n    for(int l=1,r;l<=n;l=r+1){\n        r=min(n/(n/l),m/(m/l));\n        ans=(ans+1ll*(r-l+1)*(r+l)/2%P*sum(n/l,m/l)%P)%P;\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 1829 [\u56fd\u5bb6\u96c6\u8bad\u961f]Crash\u7684\u6570\u5b57\u8868\u683c/", "tags": ["\u6570\u8bba", "\u83ab\u6bd4\u4e4c\u65af", "\u6570\u8bba\u5206\u5757"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4318 \u5b8c\u5168\u5e73\u65b9\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4318&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4318\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9898\u610f:\u6c42\u7b2c$k$\u4e2a\u6ca1\u6709\u5b8c\u5168\u5e73\u65b9\u6570\u56e0\u5b50\u7684\u6570\n\n\u53ef\u4ee5\u53d1\u73b0\u7b54\u6848\u5177\u6709\u5355\u8c03\u6027,\u53ef\u4ee5\u4e8c\u5206\u7b54\u6848,\u7136\u540e\u5224\u65ad$[1,n]$\u4e2d\u6ee1\u8db3\u6761\u4ef6\u7684\u4e2a\u6570\u662f\u5426\u4e3a$k$\n\n\u8fd9\u4e2a\u7ed3\u679c\u4e3a\n\n$1$($0$\u4e2a\u5e73\u65b9\u56e0\u5b50)\u7684\u500d\u6570-\u3010$4,9,16,25,...$\u3011($1$\u4e2a\u5e73\u65b9\u56e0\u5b50)\u7684\u500d\u6570+\u3010$36,100,...$\u3011($2$\u4e2a\u5e73\u65b9\u56e0\u5b50)\u7684\u500d\u6570...\n\n\u4e5f\u5c31\u662f:\n\n$$\n\\sum_{i=1}^{i^2\\le n} \\mu(i)\\left \\lfloor \\frac n{i^2}\\right \\rfloor\n$$\n\n\u8fd9\u6837\u7684\u8bdd\u53ea\u9700\u8981\u7ebf\u6027\u7b5b\u5230$\\sqrt{10^9}\\le 40000$,\u7136\u540e\u4e8c\u5206\u67e5\u627e\u5c31\u53ef\u4ee5\u4e86\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\nil int min(int x,int y){return x<y?x:y;}\nconst int N=40011;\nint mu[N],pri[4300],cnt=0,k,T;\nbool f[N];\nil bool chk(int n){\n    int sqr=sqrt(n);\n    long long ans=0;\n    for(int l=1,r;l<=sqr;l=r+1){\n        r=min((int)sqrt(n/(n/(l*l))),sqr);\n        ans+=n/(l*l)*(mu[r]-mu[l-1]);\n    }\n    return ans>=k;\n}\nint main(){\n    mu[1]=1;\n    Fur(i,2,40000){\n        if(!f[i])pri[++cnt]=i,mu[i]=-1;\n        Fur(j,1,cnt){\n            if(pri[j]*i>40000)break;\n            f[i*pri[j]]=1;\n            if(i%pri[j])mu[i*pri[j]]=-mu[i];\n            else break;\n        }\n    }\n    Fur(i,2,40000)mu[i]+=mu[i-1];\n    scanf(\"%d\",&T);\n    while(T--){\n        scanf(\"%d\",&k);\n        int l=k,r=k<<1;\n        while(l+1<r){\n            int m=(l>>1)+(r>>1)+((l&1)^(r&1));\n            if(chk(m))r=m;\n            else l=m+1;\n        }\n        printf(\"%d\\n\",chk(l)?l:r);\n    }\n}\n```\n", "link": "/posts/LG 4318 \u5b8c\u5168\u5e73\u65b9\u6570/", "tags": ["\u6570\u8bba\u5206\u5757", "\u4e8c\u5206", "\u83ab\u6bd4\u4e4c\u65af"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2424 \u7ea6\u6570\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2424&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2424\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u5148\u8f6c\u5316\u4e3a\u524d\u7f00\u548c\u518d\u76f8\u51cf\n\n\u95ee\u9898\u53d8\u4e3a\u4e86\u6c42:\n\n$$\n\\sum_{i=1}^n \\sum_{j|i}j\n$$\n\n\u8003\u8651\u6bcf\u4e2a\u7ea6\u6570$d$,\u5b83\u7684\u8d21\u732e\u6b21\u6570\u4e3a$\\left \\lfloor \\frac nd\\right \\rfloor$\n\n\u90a3\u4e48\u7b54\u6848\u5c31\u662f\n\n$$\n\\sum_{d=1}^n d\\left \\lfloor \\frac nd\\right \\rfloor\n$$\n\n\u76f4\u63a5\u6570\u8bba\u5206\u5757\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<cstdio>\ntypedef long long ll;\nll calc(int n){\n    ll ans=0;\n    for(ll l=1,r=0;l<=n;l=r+1){\n        r=n/(n/l);\n        ans+=(r-l+1)*(l+r)/2*(n/l);\n    }\n    return ans;\n}\nint main(){\n    int l,r;\n    scanf(\"%d%d\",&l,&r);\n    printf(\"%lld\\n\",calc(r)-calc(l-1));\n}\n```\n", "link": "/posts/LG 2424 \u7ea6\u6570\u548c/", "tags": ["\u6570\u8bba", "\u6570\u8bba\u5206\u5757"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "BZ 2956 \u6a21\u79ef\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://remmina.github.io/BZPRO/JudgeOnline/2956.html&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://remmina.github.io/BZPRO/JudgeOnline/2956.html\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6c42$\\sum_{i=1}^n\\sum_{j=1}^m[i\u2260j](n \\bmod i)(m \\bmod j),n,m\\le 10^9$\n\n\u6570\u8bba\u5206\u5757\n\n\u5148\u4e0d\u8003\u8651$i!=j$\n\n$$\n\\sum_{i=1}^n\\sum_{j=1}^m(n \\bmod i)(m \\bmod j)\n\\\\\n=\\sum_{i=1}^n(n-i\\left \\lfloor \\frac ni\\right \\rfloor)\\sum_{j=1}^m(m-j\\left \\lfloor \\frac mj\\right \\rfloor)\n$$\n\n\u8003\u8651$i=j$,\u8bbe$k=\\min(n,m)$\n\n$$\n\\sum_{i=1}^n\\sum_{j=1}^m(n \\bmod i)(m \\bmod j)[i=j]\n\\\\\n=\\sum_{i=1}^k(n \\bmod i)(m \\bmod i)\n\\\\\n=\\sum_{i=1}^k(n-i\\left \\lfloor \\frac ni \\right \\rfloor)(m-i\\left \\lfloor \\frac mi \\right \\rfloor)\n\\\\\n=\\sum_{i=1}^knm-ni\\left \\lfloor \\frac mi \\right \\rfloor-mi\\left \\lfloor \\frac ni \\right \\rfloor+i^2 \\left \\lfloor \\frac{nm}{i^2}\\right \\rfloor\n\\\\\n=knm-n\\sum_{i=1}^k i\\left \\lfloor \\frac mi \\right \\rfloor-m\\sum_{i=1}^ki\\left \\lfloor \\frac ni \\right \\rfloor+\\sum_{i=1}^ki^2\\left \\lfloor \\frac ni \\right \\rfloor\\left \\lfloor \\frac mi \\right \\rfloor\n$$\n\n\u4e24\u4e2a\u76f8\u51cf\u5c31\u662f\u7b54\u6848\n\n\u63d0\u793a: $\\sum_{i=1}^n{i^2}=\\frac{n(n+1)(2n+1)}6$\n\n> \u63a8\u5bfc\u8fc7\u7a0b: \n> \n> \u8bbe$S=\\sum_{i=1}^n{i^2}$\n> \n> $(n+1)^3-n^3=3n^2+3n+1$\n> \n> $n^3-(n-1)^3=3(n-1)^2+3(n-1)+1$\n> \n> $\\cdots$\n> \n> $2^3-1^3=3\\times1^2+3\\times 1+1$\n> \n> \u4e0a\u9762$n$\u4e2a\u5f0f\u5b50\u76f8\u52a0\u5f97\u5230:\n> \n> $(n+1)^3-1=3(1^2+2^2+\\dots+n^2)+3(1+2+\\dots+n)+n$\n> \n> $\\therefore S=\\frac13\\left[ (n+1)^3-1- \\frac12n(n+1) \\right]=\\frac{n(n+1)(2n+1)}6$\n<!-- more -->\n\n```cpp\n#include<cstdio>\nconst int P=19940417;\ninline int min(int x,int y){return x<y?x:y;}\ninline int sum(int l,int r){return 1ll*(l+r)*(r-l+1)/2%P;}\ninline int mi(int n){return 1ll*n*(n+1)%P*(2*n+1)%P*3323403%P;}\ninline int SUM(int l,int r){return (mi(r)-mi(l-1)+P)%P;}\ninline int calc(int k){\n    int ans=1ll*k*k%P;\n    for(int l=1,r=0;l<=k;l=r+1){\n        r=k/(k/l);\n        ans=(ans-1ll*sum(l,r)*(k/l)%P+P)%P;\n    }\n    return ans;\n}\nint main(){\n    int n,m,ans,k;\n    scanf(\"%d%d\",&n,&m);\n    ans=1ll*calc(n)*calc(m)%P;\n    k=min(n,m);\n    ans=(ans-1ll*k*n%P*m%P+P)%P;\n    for(int l=1,r=0;l<=k;l=r+1){\n        r=min(n/(n/l),m/(m/l));\n        ans=(ans+1ll*n*sum(l,r)%P*(m/l)%P)%P;\n        ans=(ans+1ll*m*sum(l,r)%P*(n/l)%P)%P;\n        ans=(ans-1ll*SUM(l,r)*(n/l)%P*(m/l)%P+P)%P;\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/BZ 2956 \u6a21\u79ef\u548c/", "tags": ["\u6570\u8bba", "\u6570\u8bba\u5206\u5757"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4345 [SHOI2015]\u8d85\u80fd\u7c92\u5b50\u70ae\u00b7\u6539", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4345&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4345\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6c42$\\sum_{i=0}^k {n \\choose i} \\bmod 2333$\n\n\u8bbe$p=2333$\n$$\n\\sum_{i=0}^k {n \\choose i} \\bmod p\n\\\\\n=\\sum_{i=0}^k {\\left \\lfloor \\frac np \\right \\rfloor \\choose \\left \\lfloor \\frac ip \\right \\rfloor} {n \\bmod p \\choose i\\bmod p}\\bmod p\n\\\\\n={\\left \\lfloor \\frac np \\right \\rfloor \\choose 0}\\sum_{i=0}^{p-1}{n \\bmod p \\choose i}+{\\left \\lfloor \\frac np \\right \\rfloor \\choose 1}\\sum_{i=0}^{p-1}{n \\bmod p \\choose i}+\n\\cdots+\n{\\left \\lfloor \\frac np \\right \\rfloor \\choose \\left \\lfloor \\frac kp \\right \\rfloor}\\sum_{i=0}^{k \\bmod p}{n \\bmod p \\choose i}\n$$\n\n\u8bbe$f(n,k)=\\sum_{i=0}^k {n \\choose i}$\n\n\u539f\u5f0f\u53ef\u4ee5\u8f6c\u5316\u4e3a:\n\n$$\nf(n \\bmod p,p-1) \\cdot f(\\left \\lfloor \\frac np \\right \\rfloor,\\left \\lfloor \\frac kp \\right \\rfloor -1)+{\\left \\lfloor \\frac np \\right \\rfloor \\choose \\left \\lfloor \\frac kp \\right \\rfloor} f(n\\bmod p,k\\bmod p)\n$$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=2335,p=2333;\nll C[N+11][N+11],F[N+11][N+11];\nvoid init(){\n    C[0][0]=1;\n    Fur(i,1,N)C[i][0]=C[i][i]=1;\n    Fur(i,1,N)Fur(j,1,i-1)C[i][j]=(C[i-1][j]+C[i-1][j-1])%p;\n    F[0][0]=1;\n    Fur(i,1,N)F[i][0]=1;\n    Fur(i,0,N)Fur(j,1,N)F[i][j]=(C[i][j]+F[i][j-1])%p;\n}\nll lucas(ll n,ll m){\n    if(n<m)return 0;\n    if(!n)return 1;\n    return lucas(n/p,m/p)*C[n%p][m%p]%p;\n}\nll f(ll n,ll k){\n    if(k<0)return 0;\n    if(!n||!k)return 1;\n    if(n<p&&k<p)return F[n][k];\n    return (f(n/p,k/p-1)*F[n%p][p-1]%p+lucas(n/p,k/p)*f(n%p,k%p)%p)%p;\n}\nint main(){\n    int T;ll n,k;\n    in(T);init();\n    while(T--){\n        in(n,k);\n        out(f(n,k),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 4345 [SHOI2015]\u8d85\u80fd\u7c92\u5b50\u70ae\u00b7\u6539/", "tags": ["\u6570\u8bba", "\u7ec4\u5408\u6570", "lucas"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4454 [CQOI2018]\u7834\u89e3D-H\u534f\u8bae", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4454&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4454\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nbsgs\u88f8\u9898\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,g,p;\nstruct hash{\n    struct edge{int to,nxt,w;}e[N];\n    int cnt=0,head[N];\n    il void clear(){cnt=0;clr(head,0);}\n    il void add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\n    il void ins(int x,int v){add(x%N,x,v);}\n    il int ask(int x){fl(i,x%N)if(to==x)return e[i].w;return -1;}\n}S;\nint pw(int x,int b){\n    int ans=1;\n    while(b){\n        if(b&1)ans=1ll*ans*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return ans;\n}\nint bsgs(int y,int z){\n    S.clear();\n    int m=sqrt(p)+1,x=z%p,t=pw(y,m);\n    Fur(i,0,m)S.ins(x,i),x=1ll*x*y%p;\n    x=1;\n    Fur(i,1,m){\n        x=1ll*x*t%p;\n        int k=S.ask(x);\n        if(~k)return i*m-k;\n    }\n    return -1;\n}\nint main(){\n    in(g,p,n);\n    Fur(i,1,n){\n        int A,B,a,b;\n        in(A,B);\n        a=bsgs(g,A);\n        out(pw(B,a),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 4454 [CQOI2018]\u7834\u89e3D-H\u534f\u8bae/", "tags": ["\u6570\u8bba", "bsgs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "HDU 3037 Saving Beans", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=3037&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"http://acm.hdu.edu.cn/showproblem.php?pid=3037\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ed9\u51fa$n,m$\u6c42${n+m} \\choose m$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,m,p,fac[N];\nint pw(int x,int b){\n    int ans=1;\n    while(b){\n        if(b&1)ans=1ll*ans*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return ans;\n}\nint inv(int x){return pw(x,p-2);}\nint C(int n,int m){\n    if(n<m)return 0;\n    return 1ll*fac[n]*inv(fac[m])%p*inv(fac[n-m])%p;\n}\nint lucas(int n,int m){\n    if(n<m)return 0;\n    if(!n)return 1;\n    return 1ll*lucas(n/p,m/p)*C(n%p,m%p)%p;\n}\nint main(){\n    fac[0]=1;\n    int T;in(T);\n    while(T--){\n        in(n,m,p);\n        Fur(i,1,p)fac[i]=1ll*fac[i-1]*i%p;\n        out(lucas(n+m,m),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/HDU 3037 Saving Beans/", "tags": ["lucas", "\u7ec4\u5408\u6570", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2480 [SDOI2010]\u53e4\u4ee3\u732a\u6587", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2480&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2480\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9898\u610f\uff1a\n\n\u6c42$G^{\\sum d|{N\\choose d}}\\bmod 999911659$\n\n$1 \\le G \\le 10^9,1 \\le N \\le 10^9$\n\n$999911659$\u662f\u8d28\u6570,\u6839\u636e\u6b27\u62c9\u5b9a\u7406:\n\n$G^{\\sum d|{N\\choose d}}\\bmod 999911659 = G^{\\sum d|{N\\choose d} \\bmod 999911658}\\bmod 999911659$\n\n\u5173\u952e\u6c42$\\sum d|{N\\choose d} \\bmod 999911658$\n\n\u6a21\u6570\u592a\u5927,\u76f4\u63a5lucas\u53d6\u6a21\u4f1a\u70b8\n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651**\u5c06\u6a21\u6570\u5206\u89e3\u8d28\u56e0\u6570**\n\n$999911658=2\\times 3 \\times 4679 \\times 35617$\n\n\u53ef\u4ee5\u7528**lucas**\u540e**\u679a\u4e3e\u7ea6\u6570**\u7b97\u51fa\n\n$$\n\\begin{cases}\na_1=\\sum d|{N\\choose d} \\pmod 2\n\\\\\na_2=\\sum d|{N\\choose d} \\pmod 3\n\\\\\na_3=\\sum d|{N\\choose d} \\pmod {4679}\n\\\\\na_4=\\sum d|{N\\choose d} \\pmod {35617}\n\\end{cases}\n$$\n\n\u7136\u540e\u901a\u8fc7**crt**\u6c42:\n\n$$\n\\begin{cases}\nx \\equiv a_1 \\pmod 2\n\\\\\nx \\equiv a_2 \\pmod 3\n\\\\\nx \\equiv a_3 \\pmod {4679}\n\\\\\nx \\equiv a_4 \\pmod {35617}\n\\end{cases}\n$$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,M=999911658;\nll n,G,fac[N],p,b[5]={0,2,3,4679,35617},a[5];\nll pw(ll x,ll b,ll mod=p){\n    ll ans=1;\n    while(b){\n        if(b&1)ans=ans*x%mod;\n        b>>=1;x=x*x%mod;\n    }\n    return ans;\n}\nll inv(ll x){return pw(x,p-2);}\nll C(ll n,ll m){\n    if(n<m)return 0;\n    return fac[n]*inv(fac[m])%p*inv(fac[n-m])%p;\n}\nll lucas(ll n,ll m){\n    if(n<m)return 0;\n    if(!n)return 1;\n    return lucas(n/p,m/p)*C(n%p,m%p)%p;\n}\nll crt(){\n    ll ans=0;\n    Fur(i,1,4){\n        p=b[i];\n        ans=(ans+a[i]*(M/p)%M*inv(M/p))%M;\n    }\n    return ans;\n}\nint main(){\n    in(n,G);\n    if(G%(M+1)==0)return puts(\"0\"),0;\n    fac[0]=1;\n    Fur(t,1,4){\n        p=b[t];\n        Fur(i,1,p)fac[i]=fac[i-1]*i%p;\n        for(int i=1;i*i<=n;++i)\n        if(n%i==0){\n            a[t]=(a[t]+lucas(n,i))%p;\n            if(i*i!=n)a[t]=(a[t]+lucas(n,n/i))%p;\n        }\n    }\n    printf(\"%lld\\n\",pw(G,crt(),M+1));\n}\n```\n", "link": "/posts/LG 2480 [SDOI2010]\u53e4\u4ee3\u732a\u6587/", "tags": ["\u7ec4\u5408\u6570", "\u6570\u8bba", "lucas", "crt", "\u6b27\u62c9\u5b9a\u7406"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4774 [NOI2018]\u5c60\u9f99\u52c7\u58eb", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4774&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4774\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u9884\u5904\u7406\u51fa\u6bcf\u6b21\u7684\u653b\u51fb\u529b$c_i$,\u63a8\u8350\u4f7f\u7528multiset\n\n\u95ee\u9898\u53d8\u6210\u4e86:\n\n$c_ix \\equiv a_i \\pmod{p_i}$\n\n\u53ef\u662f\u9898\u76ee\u5e76\u6ca1\u6709\u4fdd\u8bc1$a_i\\le p_i$\n\n\n**\u4ed4\u7ec6\u9605\u8bfb\u9898\u76ee**,\u53ef\u4ee5\u53d1\u73b0\u5f53$a_i>p_i$\u7684\u65f6\u5019\u4e00\u5b9a\u6ee1\u8db3$p_i=1$\n\n\u90a3\u4e48\u5728\u8fd9\u4e2a\u60c5\u51b5\u7b54\u6848\u5c31\u662f$\\max_{i=1}^n(\\left \\lceil \\frac{a_i}{c_i} \\right \\rceil)$\n\n\n\u63a5\u4e0b\u6765\u5c31\u662f$a_i \\le p_i$\u7684\u60c5\u51b5\u4e86\n\n\u6807\u51c6\u7684Excrt\u8981\u6c42$x$\u7684\u7cfb\u6570\u5fc5\u987b\u4e3a$1$\n\n\u6211\u4eec\u53ef\u4ee5\u8f6c\u5316\u4e3aExgcd\u89e3\u4e0d\u5b9a\u65b9\u7a0b\n\n$c_ix \\equiv a_i \\pmod{p_i}$\n\n$c_ix + p_iy = a_i$\n\n\u53ef\u4ee5\u7528Exgcd\u89e3\u51fa\u4e00\u7ec4\u89e3$sx,sy$,\u5e76\u5f97\u51fa\n\n$x=sx+\\lambda \\frac{p_i}{\\gcd(c_i,p_i)}$\n\n\u4e5f\u5c31\u662f\n\n$x\\equiv sx \\pmod{\\frac{p_i}{\\gcd(c_i,p_i)}}$\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5\u7528Excrt\u6c42\u89e3\u4e86\n\n\u7279\u5224: \n\n1. \u6240\u6709$a_i=p_i$,\u90a3\u4e48\u6240\u6709$sx=0$,\u6309\u7167\u4e0a\u9762\u7684\u65b9\u6cd5\u89e3\u662f\u4e0d\u5bf9\u7684(\u7b54\u6848\u4f1a\u7b49\u4e8e0)\n   \n   \u76f4\u63a5\u6c42\u51fa\u6740\u6b7b\u6bcf\u6761\u9f99\u6240\u9700\u7684\u5200\u6570\u7136\u540e\u6240\u6709\u5200\u6570\u6c42\u4e00\u4e2alcm\u5373\u53ef\n\n   \u4e5f\u5c31\u662f$lcm_{i=1}^n(\\frac{p_i}{\\gcd(c_i,p_i)})$\n\n2. \u5f53$c_i$\u662f$p_i$\u7684\u500d\u6570\u7684\u65f6\u5019\u6740\u4e0d\u6b7b\u8fd9\u6761\u9f99\n   \n   \u4f46\u8fd9\u65f6\u5982\u679c$a_i=p_i$,\u8fd9\u4e2a\u65b9\u7a0b\u76f8\u5f53\u4e8e\u6ca1\u7528,\u53ef\u4ee5\u6362\u6210$x \\equiv 0 \\pmod 1$\u4e4b\u7c7b\u7684\n   \n\u8bb0\u5f97\u5168\u90e8\u5f00`long long`,\u7528\u9f9f\u901f\u4e58\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define ll long long\n#define MB template <class T>il\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\nMB T MAX(T x,T y){return x>y?x:y;}\nMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nil ll mul(ll x,ll y,ll p){\n    ll res=0;\n    while(y){\n        if(y&1)res=(res+x)%p;\n        y>>=1;x=(x+x)%p;\n    }\n    return res;\n}\nll exgcd(ll a,ll b,ll &x,ll &y){\n    if(!b){x=1;y=0;return a;}\n    ll gcd=exgcd(b,a%b,x,y),t=x;\n    x=y;y=t-a/b*y;\n    return gcd;\n}\nint n,m;ll a[N],p[N],c[N],ext[N];\nil ll excrt(){\n    ll ans=a[1],M=p[1],t,y;\n    Fur(i,2,n){\n        ll b=p[i],c=(a[i]-ans%b+b)%b,gcd=exgcd(M,b,t,y); //Mx \\equiv c \\pmod b\n        if(c%gcd)return -1;\n        t=mul(t,c/gcd,b/gcd);\n        ans+=t*M;\n        M*=b/gcd;\n        ans=(ans%M+M)%M;\n    }\n    return ans;\n}\nil void solve2(){\n    ll ans=1;\n    Fur(i,1,n)ll x=p[i]/GCD(p[i],c[i]),ans=ans/GCD(ans,x)*x;\n    out(ans,ln);\n}\nil void solve3(){\n    ll ans=0;\n    Fur(i,1,n)ans=MAX(ans,(a[i]+c[i]-1)/c[i]);\n    out(ans,ln);\n}\nil void solve(){\n    in(n,m);\n    Fur(i,1,n)in(a[i]);\n    Fur(i,1,n)in(p[i]);\n    Fur(i,1,n)in(ext[i]);\n    multiset<ll>s;ll x;\n    Fur(i,1,m)in(x),s.insert(x);\n    Fur(i,1,n){\n        multiset<ll>::iterator it;\n        if(a[i]<=*s.begin())it=s.begin();\n        else it=--s.upper_bound(a[i]);\n        c[i]=*it;\n        s.erase(it);s.insert(ext[i]);\n    }\n    Fur(i,1,n)if(p[i]!=a[i])goto skip;\n    solve2();return;// \u6240\u6709ai=pi\n    skip:;\n    Fur(i,1,n)if(p[i]!=1)goto SKIP;\n    solve3();return;// \u6240\u6709pi=1\n    SKIP:;\n    Fur(i,1,n)c[i]%=p[i];\n    Fur(i,1,n)if(p[i]==c[i]){\n        if(a[i]==p[i])c[i]=1,p[i]=1,a[i]=0;\n        else return void(out(\"-1\\n\"));\n    }\n    Fur(i,1,n){\n        ll sx,sy,gcd=exgcd(c[i],p[i],sx,sy);\n        if(a[i]%gcd)return void(out(\"-1\\n\"));\n        p[i]/=gcd;\n        sx=(sx%p[i]+p[i])%p[i];\n        a[i]=mul(sx,a[i]/gcd,p[i]);\n    }\n    out(excrt(),ln);\n}\nint main(){\n    int T;in(T);\n    while(T--)solve();\n    flush();\n}\n```\n", "link": "/posts/LG 4774 [NOI2018]\u5c60\u9f99\u52c7\u58eb/", "tags": ["\u6570\u8bba", "exgcd", "excrt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4245 \u3010\u6a21\u677f\u3011\u4efb\u610f\u6a21\u6570NTT", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4245&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4245\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/LG 4245 \u3010\u6a21\u677f\u3011\u4efb\u610f\u6a21\u6570NTT/", "tags": ["fft", "ntt", "crt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1495 \u3010\u6a21\u677f\u3011\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1495&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1495\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n;ll m[N],a[N];\nll exgcd(ll a,ll b,ll &x,ll &y){\n    if(!b){x=1,y=0;return a;}\n    ll gcd=exgcd(b,a%b,x,y),t=x;\n    x=y;y=t-a/b*y;\n    return gcd;\n}\nll mul(ll x,ll b,ll p){\n    ll ans=0;\n    while(b){\n        if(b&1)ans=(ans+x)%p;\n        b>>=1;x=(x+x)%p;\n    }\n    return ans;\n}\nll excrt(){\n    ll ans=a[1],M=m[1],t,y;\n    Fur(i,2,n){\n        ll b=m[i],c=(a[i]-ans%b+b)%b,\n            gcd=exgcd(M,b,t,y);\n        if(c%gcd)return -1;\n        t=mul(t,c/gcd,b/gcd);\n        ans+=t*M;\n        M*=b/gcd;\n        ans=(ans%M+M)%M;\n    }\n    return ans;\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(m[i],a[i]);\n    printf(\"%lld\\n\",excrt());\n}\n```\n", "link": "/posts/LG 1495 \u3010\u6a21\u677f\u3011\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406/", "tags": ["crt", "excrt", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4861 \u6309\u94ae", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4861&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4861\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$K^x \\equiv 1 \\pmod M$\n\n\u6c42\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570$x$\n\n~~\u6700\u8fd1\u521a\u5b66\u4e86bsgs,\u4e00\u773c\u770b\u6210exbsgs~~\n\nexbsgs\u53ef\u4ee5,\u4f46\u662f\u6bd4\u8f83\u9ebb\u70e6\n\n\u770b\u5230\u6700\u540e\u662f$1$,\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u6b27\u62c9\u5b9a\u7406:\n\n$$K^{\\varphi(M)} \\equiv 1 \\pmod M(\\gcd(K,M)=1)$$\n\n\u53ef\u4ee5\u53d1\u73b0,\u7b54\u6848\u662f$\\varphi(M)$\u7684\u7ea6\u6570,\u90a3\u4e48\u679a\u4e3e$\\varphi(M)$\u7684\u7ea6\u6570\u5373\u53ef(\u53ef\u4ee5\u4e00\u76f4\u5c1d\u8bd5\u679a\u4e3e\u5220\u6389\u7ea6\u6570)\n\n\u5f53$\\gcd(K,M)!=1$\u65f6\u65e0\u89e3\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint m,k,pri[N],t[N];\nint getphi(int m){\n    int phi=m,p;\n    for(int i=2;i*i<=m;++i)\n    if(m%i==0){\n        while(m%i==0)m/=i;\n        phi-=phi/i;\n    }\n    if(m)phi-=phi/m;\n    return phi;\n}\nint pw(int x,int b,int p){\n    int ans=1;\n    while(b){\n        if(b&1)ans=1ll*ans*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return ans;\n}\nint main(){\n    in(m,k);\n    if(GCD(m,k)!=1)return puts(\"Let's go Blue Jays!\"),0;\n    int p,phi=getphi(m),cnt=0;\n    p=phi;\n    for(int i=2;i*i<=phi;++i)\n    if(phi%i==0){\n        pri[++cnt]=i;\n        while(phi%i==0)phi/=i,++t[cnt];\n    }\n    if(phi!=1)pri[++cnt]=phi,t[cnt]=1;\n    Fur(x,1,cnt){\n        Fur(i,1,t[x])\n        if(pw(k,p/pri[x],m)==1)p/=pri[x];\n        else break;\n    }\n    printf(\"%d\\n\",p);\n}\n```\n", "link": "/posts/LG 4861 \u6309\u94ae/", "tags": ["bsgs", "\u4e8c\u8fdb\u5236", "\u6570\u8bba", "\u6b27\u62c9\u5b9a\u7406"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4884 \u591a\u5c11\u4e2a1", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4884&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4884\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$\n\\overbrace{111\\dots111}^{\\text{N\u4e2a1}} \\equiv k \\pmod m\n\\\\\n\\frac{10^N-1}9\\equiv k \\pmod m\n\\\\\n10^N\\equiv 9k+1 \\pmod m\n$$\n\n\u987a\u5229\u5730\u63a8\u51fa\u662fbsgs,($m$\u662f\u8d28\u6570,\u4e5f\u5c31\u4e0d\u7528exbsgs\u4e86)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll __int128\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=10000007;\n// struct hash{\n//     struct edge{int nxt;ll to,w;}e[N];\n//     int head[N],cnt=0;\n//     il void add(int x,ll y,ll w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\n//     il void ins(ll x,ll v){add(x%N,x,v);}\n//     il ll ask(ll x){fl(i,x%N)if(to==x)return e[i].w;return -1;}\n// }S;\nmap<ll,ll>S;\nil ll pw(ll x,ll b,ll p){\n    ll ans=1;\n    while(b){\n        if(b&1)ans=ans*x%p;\n        b>>=1;x=x*x%p;\n    }\n    return ans;\n}\nll bsgs(ll y,ll z,ll p){\n    y%=p;z%=p;\n    if(!y){if(!z)return 1;return -1;}\n    ll m=(ll)sqrt((db)p)+1,x=z%p,t=pw(y,m,p);\n    Fur(i,0,m)S[x]=i+1,x=x*y%p;\n    x=1;\n    Fur(i,1,m){\n        x=x*t%p;\n        ll k=S[x]-1;\n        if(~k)return ((i*m-k)%p+p)%p;\n    }\n    return -1;\n}\nint main(){\n    ll k,m;\n    in(k,m);\n    printf(\"%lld\\n\",bsgs(10,9*k+1,m));\n}\n```\n", "link": "/posts/LG 4884 \u591a\u5c11\u4e2a1/", "tags": ["\u6570\u8bba", "bsgs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4777 \u3010\u6a21\u677f\u3011\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4777&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4777\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n# \u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406\n\n\u7ed9\u5b9a\u65b9\u7a0b\u7ec4:\n\n$$\n\\begin{cases}\nx \\equiv a_1\\ ({\\rm mod}\\ m_1)\n\\\\\nx\\equiv a_2\\ ({\\rm mod}\\ m_2)\n\\\\\n...\n\\\\\nx \\equiv a_n\\ ({\\rm mod}\\ m_n)\n\\end{cases}\n$$\n\n\u6c42\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570$x$\n\n\u5047\u8bbe\u6211\u4eec\u6c42\u51fa\u4e86\u524d$i-1$\u7ec4\u7684\u89e3$x_{i-1}$\n\n\u8bbe$M=\\operatorname{lcm}(m_1,m_2,\\cdots,m_{i-1})$\n\n\u5219$x_{i-1}+\\lambda M \\equiv a_{i-1} \\pmod{m_{i-1}}(\\lambda \\in \\Z)$\n\n\u90a3\u4e48\u6211\u4eec\u9700\u8981\u6c42\u51fa\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570$t$\u4f7f:\n\n$x_{i-1}+tM\\equiv a_i \\pmod{m_i}$\n\n\u4e5f\u5c31\u662f$Mt\\equiv a_i-x_{i-1} \\pmod{m_i}$\n\n\u53ef\u4ee5\u4f7f\u7528Exgcd\u6c42\u89e3$t$ ($ax\\equiv c \\pmod b$)\n\n\u5982\u679c\u65e0\u89e3,\u5219\u6574\u4e2a\u65b9\u7a0b\u8bef\u89e3\n\n\u82e5\u6709\u89e3,$x_i=x_{i-1}+tM$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n;ll a[N],m[N];\nll exgcd(ll a,ll b,ll &x,ll &y){\n    if(!b){x=1,y=0;return a;}\n    ll gcd=exgcd(b,a%b,x,y),t=x;\n    x=y;y=t-a/b*y;\n    return gcd;\n}\nll mul(ll x,ll b,ll p){\n    ll ans=0;\n    while(b){\n        if(b&1)ans=(ans+x)%p;\n        b>>=1;x<<=1;x%=p;\n    }\n    return ans;\n}\nll excrt(){\n    ll ans=a[1],M=m[1],t,y;\n    Fur(i,2,n){\n        ll b=m[i],c=(a[i]-ans%b+b)%b,\n            gcd=exgcd(M,b,t,y);\n        if(c%gcd)return -1;\n        t=mul(t,c/gcd,b/gcd);\n        ans+=t*M;\n        M*=b/gcd;\n        ans=(ans%M+M)%M;\n    }\n    return ans;\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(m[i],a[i]);\n    printf(\"%lld\\n\",excrt());\n}\n```\n", "link": "/posts/LG 4777 \u3010\u6a21\u677f\u3011\u6269\u5c55\u4e2d\u56fd\u5269\u4f59\u5b9a\u7406/", "tags": ["\u6570\u8bba", "crt", "excrt"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3521 [POI2011]ROT-Tree Rotations", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3521&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3521\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ebf\u6bb5\u6811\u5408\u5e76\u7684\u65f6\u5019\u53d6$\\min(\\text{\u4ea4\u6362\u524d},\\text{\u4ea4\u6362\u540e})$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=200011;\nint n,sz=0,s[N*20],ls[N*20],rs[N*20];\nll ans=0,u=0,v=0;\nint upd(int p,int l=1,int r=n){\n    int rt=++sz;s[rt]=1;\n    if(l==r)return rt;\n    int m=(l+r)>>1;\n    if(p<=m)ls[rt]=upd(p,l,m);\n    else rs[rt]=upd(p,m+1,r);\n    return rt;\n}\nint mg(int x,int y,int l=1,int r=n){\n    if(!x||!y)return x|y;\n    if(l==r)return s[x]+=s[y],x;\n    u+=1ll*s[rs[x]]*s[ls[y]];\n    v+=1ll*s[ls[x]]*s[rs[y]];\n    int m=(l+r)>>1;\n    ls[x]=mg(ls[x],ls[y],l,m);\n    rs[x]=mg(rs[x],rs[y],m+1,r);\n    s[x]=s[ls[x]]+s[rs[x]];\n    return x;\n}\nint dfs(){\n    int pos,val;in(val);\n    if(val)pos=upd(val);\n    else{\n        int ls=dfs(),rs=dfs();\n        u=0,v=0;\n        pos=mg(ls,rs);\n        ans+=MIN(u,v);\n    }\n    return pos;\n}\nint main(){\n    in(n);\n    dfs();\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 3521 [POI2011]ROT-Tree Rotations/", "tags": ["\u7ebf\u6bb5\u6811\u5408\u5e76", "\u9006\u5e8f\u5bf9", "dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3605 [USACO17JAN]Promotion Counting P", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3605&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3605\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u79bb\u6563\u5316\u6743\u503c\u4e3a\u6392\u540d,\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\n\n\u904d\u5386\u6240\u6709\u70b9,\u7528\u6743\u503c\u6811\u72b6\u6570\u7ec4\u7edf\u8ba1,\u7ed3\u679c\u662f \u904d\u5386\u5b8c\u8be5\u5b50\u6811\u540e\u7b54\u6848 - \u904d\u5386\u8be5\u5b50\u6811\u524d\u7b54\u6848\n\n(\u4e3a\u4ec0\u4e48\u4e00\u5f00\u59cb\u4f1a\u53bb\u60f3\u4ec0\u4e48dsu on tree\u548c\u7ebf\u6bb5\u6811\u5408\u5e76\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,cnt=0,rnk[N],SZ=0,head[N],s[N],ANS[N];\nstruct node{int v,p;bool operator<(node t){return v>t.v;}}b[N];\nstruct edge{int to,nxt;}e[N];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nil void upd(int p){for(int i=p;i<=SZ;i+=i&-i)++s[i];}\nil int ask(int p){int ans=0;for(int i=p;i;i-=i&-i)ans+=s[i];return ans;}\nvoid dfs(int x){\n    ANS[x]-=ask(rnk[x]-1);\n    fl(i,x)dfs(to);\n    ANS[x]+=ask(rnk[x]-1);\n    upd(rnk[x]);\n}\nint main(){\n    in(n);\n    int x;\n    Fur(i,1,n)in(b[i].v),b[i].p=i;\n    sort(b+1,b+n+1);\n    Fur(i,1,n)rnk[b[i].p]=(SZ+=(b[i].v!=b[i-1].v));\n    Fur(i,2,n)in(x),add(x,i);\n    dfs(1);\n    Fur(i,1,n)out(ANS[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3605 [USACO17JAN]Promotion Counting P/", "tags": ["\u79bb\u6563\u5316", "\u6811\u72b6\u6570\u7ec4", "\u7ebf\u6bb5\u6811\u5408\u5e76", "\u9759\u6001\u94fe\u5206\u6cbb", "\u5dee\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4556 [Vani\u6709\u7ea6\u4f1a]\u96e8\u5929\u7684\u5c3e\u5df4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4556&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4556\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6811\u4e0a\u5dee\u5206,\u7edf\u8ba1\u7684\u65f6\u5019\u6bcf\u4e2a\u8282\u70b9\u90fd\u5408\u5e76\u81ea\u8eab\u5b50\u8282\u70b9\u7684\u7ed3\u679c\n\n\u6bcf\u4e2a\u70b9\u90fd\u7ef4\u62a4\u4e00\u9897\u52a8\u6001\u5f00\u70b9\u6743\u503c\u7ebf\u6bb5\u6811\n\n\u5728$x\\leftrightarrow y$\u533a\u95f4\u52a0\u53ef\u4ee5\u770b\u6210$x,y$\u7684$w$\u4f4d\u7f6e$+1$,$lca(x,y),f_{lca(x,y)}$\u7684$w$\u4f4d\u7f6e$-1$\n\n\u7edf\u8ba1\u7684\u65f6\u5019\u4e0d\u65ad\u5411\u4e0a\u7ebf\u6bb5\u6811\u5408\u5e76\n\n\u5177\u4f53\u770b\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\nconst int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}\nconst int N=100011;\nint n,q,cnt=0,sz=0,head[N],s[N*60],S[N*60],ls[N*60],rs[N*60],RT[N],ans[N];\nil void pu(int rt){s[ls[rt]]>=s[rs[rt]]?(s[rt]=s[ls[rt]],S[rt]=S[ls[rt]]):(s[rt]=s[rs[rt]],S[rt]=S[rs[rt]]);}\nvoid upd(int &rt,int x,int v,int l=1,int r=100000){\n    if(!rt)rt=++sz;\n    if(l==r){s[rt]+=v;S[rt]=l;return;}\n    int m=(l+r)>>1;\n    if(x<=m)upd(ls[rt],x,v,l,m);\n    else upd(rs[rt],x,v,m+1,r);\n    pu(rt);\n}\nint mg(int x,int y,int l=1,int r=100000){\n    if(!x||!y)return x|y;\n    if(l==r)return s[x]+=s[y],S[x]=l,x;\n    int m=(l+r)>>1;\n    ls[x]=mg(ls[x],ls[y],l,m); \n    rs[x]=mg(rs[x],rs[y],m+1,r);\n    pu(x);return x;\n}\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint d[N],top[N],siz[N],f[N];\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(k)bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nil int lca(int x,int y){\n    while(top[x]!=top[y])\n        d[top[x]]>d[top[y]]?x=f[top[x]]:y=f[top[y]];\n    return d[x]<d[y]?x:y;\n}\nvoid solve(int x){\n    fl(i,x)if(to!=f[x])\n        solve(to),\n        RT[x]=mg(RT[x],RT[to]);\n    if(s[RT[x]])ans[x]=S[RT[x]];\n}\nint main(){\n    in(n,q);\n    int x,y,w;\n    Fur(i,2,n)in(x,y),add(x,y),add(y,x);\n    dfs(1);bt(1,1);\n    while(q--){\n        in(x,y,w);\n        int t=lca(x,y);\n        upd(RT[x],w,1);upd(RT[y],w,1);\n        upd(RT[t],w,-1);upd(RT[f[t]],w,-1);\n    }\n    solve(1);\n    Fur(i,1,n)out(ans[i]),pt('\\n');\n    flush();\n}\n```\n", "link": "/posts/LG 4556 [Vani\u6709\u7ea6\u4f1a]\u96e8\u5929\u7684\u5c3e\u5df4/", "tags": ["\u7ebf\u6bb5\u6811\u5408\u5e76", "lca", "\u5dee\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3302 [SDOI2013]\u68ee\u6797", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3302&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3302\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u770b\u9898\u610f\u60f3\u5230\u4e86\u4e3b\u5e2d\u6811\u548cLCT\n\nLCT\u5957\u4e3b\u5e2d\u6811\u53ef\u884c,\u4f46\u662f\u6bd4\u8f83\u9ebb\u70e6,\u6211\u4eec\u7528\u53e6\u4e00\u79cd\u65b9\u6cd5\n\n\u542f\u53d1\u5f0f\u5408\u5e76+\u4e3b\u5e2d\u6811($\\mathcal{n \\log^2 n}$)\n\n\u6bcf\u6b21\u5c06\u5c0f\u7684\u63d2\u5165\u5230\u5927\u7684,\u987a\u4fbf\u66f4\u65b0\u500d\u589eLCA\n\n\u6bcf\u4e2a\u8282\u70b9\u5728\u7236\u8282\u70b9\u7684\u57fa\u7840\u4e0a\u63d2\u5165\u81ea\u8eab\u7684\u503c\n\n\u5373\u6bcf\u4e2a\u8282\u70b9\u7684\u4e3b\u5e2d\u6811\u8bb0\u5f55\u7684\u662f\u81ea\u8eab\u5230\u6839\u8282\u70b9\u7684\u8def\u5f84\n\n\u5177\u4f53\u770b\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define Fdr(i,x,y) for(int i(x);i>=y;--i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\nil void SWAP(int &x,int &y){int t=x;x=y;y=t;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=80011;\nstruct node{int v,p;bool operator<(node t){return v<t.v;}}b[N];\nint val[N],rnk[N];\nint cnt=0,head[N];\nint d[N],fa[N],f[17][N],siz[N];\nint SZ=0,sz=0,RT[N],ls[N*600],rs[N*600],s[N*600];\nbool v[N];\nstruct edge{int to,nxt;}e[N<<2];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint gf(int x){return (fa[x]==x)?x:(fa[x]=gf(fa[x]));}\nvoid build(int &x,int l,int r){\n    s[x=++sz]=0;\n    if(l==r)return;\n    int m=(l+r)>>1;\n    build(ls[x],l,m);build(rs[x],m+1,r);\n}\nvoid ins(int &x,int pre,int l,int r,int v){\n    s[x=++sz]=s[pre]+1;\n    ls[x]=ls[pre];rs[x]=rs[pre];\n    if(l==r)return;\n    int m=(l+r)>>1;\n    if(v<=m)ins(ls[x],ls[pre],l,m,v);\n    else ins(rs[x],rs[pre],m+1,r,v);\n}\nint ask(int x,int y,int lca,int flca,int l,int r,int k){\n    if(l==r)return val[l];\n    int m=(l+r)>>1,sum=s[ls[x]]+s[ls[y]]-s[ls[lca]]-s[ls[flca]];\n    if(k<=sum)return ask(ls[x],ls[y],ls[lca],ls[flca],l,m,k);\n    else return ask(rs[x],rs[y],rs[lca],rs[flca],m+1,r,k-sum);\n}\nvoid dfs(int x,int F,int rt){\n    ++siz[rt];\n    d[x]=d[f[0][x]=fa[x]=F]+1;\n    Fur(i,1,16)f[i][x]=f[i-1][f[i-1][x]];\n    v[x]=1;\n    ins(RT[x],RT[F],1,SZ,rnk[x]);\n    fl(i,x)if(to!=F)dfs(to,x,rt);\n}\nil int lca(int x,int y){\n    if(d[x]<d[y])SWAP(x,y);\n    Fdr(i,16,0)if(d[f[i][x]]>=d[y])x=f[i][x];\n    if(x==y)return x;\n    Fdr(i,16,0)if(f[i][x]!=f[i][y])\n        x=f[i][x],y=f[i][y];\n    return f[0][x];\n}\nint main(){\n    int n,m,q,lastans=0;\n    in(n);\n    in(n,m,q);\n    Fur(i,1,n)in(b[i].v),b[i].p=i,fa[i]=i;\n    std::sort(b+1,b+n+1);b[0].v=-(1<<30);\n    Fur(i,1,n)val[rnk[b[i].p]=(SZ+=(b[i].v!=b[i-1].v))]=b[i].v;\n    int x,y,k,t;char ch;\n    Fur(i,1,m)in(x,y),add(x,y),add(y,x);\n    build(RT[0],1,SZ);\n    Fur(i,1,n)if(!v[i])dfs(i,0,i),fa[i]=i;\n    while(q--){\n        in(ch,x,y);\n        x^=lastans;y^=lastans;\n        if(ch=='Q'){\n            in(k);k^=lastans;t=lca(x,y);\n            out(lastans=ask(RT[x],RT[y],RT[t],RT[f[0][t]],1,SZ,k),ln);\n        }\n        else{\n            add(x,y),add(y,x);\n            if(siz[gf(x)]>siz[gf(y)])SWAP(x,y);\n            dfs(x,y,gf(y));\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3302 [SDOI2013]\u68ee\u6797/", "tags": ["\u542f\u53d1\u5f0f\u5408\u5e76", "\u4e3b\u5e2d\u6811", "lca", "\u500d\u589e"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF778C Peterson Polyglot", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF778C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF778C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9898\u610f: \n\n\u7ed9\u4e00\u68f5trie\u6811,\u53ef\u4ee5\u5220\u6389\u67d0\u4e00\u5c42\u7684\u6240\u6709\u8fb9\n\n\u6c42\u5220\u6389\u54ea\u4e00\u5c42\u8fb9\u540e\u5408\u5e76\u51fa\u7684trie\u6811\u6700\u5c0f\uff1f\n\n\u89e3\u6cd5: \n\ntrie\u7684\u542f\u53d1\u5f0f\u5408\u5e76\n\n<!-- more -->\n\n```cpp\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    int now=++cnt;\n    Fur(i,0,25)c[now][i]=mg(c[x][i],c[y][i]);\n    return now;\n}\n```\n\n\u8fd9\u4e2a\u5408\u5e76\u7684\u590d\u6742\u5ea6\u662f$\\Theta(\\log n)$\u7684\n\n\u8bc1\u660e:\n\n> \u6bcf\u6b21\u5408\u5e76\u5411\u4e0b\u9012\u5f52\u7684\u65f6\u5019\u89c4\u6a21$n$\u4f1a\u53d8\u6210\u539f\u6765\u7684\u4e00\u534a$\\frac n2$\n> \n> \u6240\u4ee5\u6700\u591a\u9700\u8981\u5408\u5e76$\\log_2 n$\u6b21\n\n\u4ee3\u7801: \n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IO;\nconst int N=600011;\nint n,cnt,c[N][26],a[N];\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    int now=++cnt;\n    Fur(i,0,25)c[now][i]=mg(c[x][i],c[y][i]);\n    return now;\n}\nvoid dfs(int x,int d){\n    int now=n+1;cnt=n+1;\n    Fur(i,0,25)if(c[x][i])\n        now=mg(now,c[x][i]);\n    a[d]+=cnt-n-1;\n    Fur(i,0,25)if(c[x][i])\n        dfs(c[x][i],d+1);\n}\nint main(){\n    in(n);\n    int x,y,ans=0,as=0;char w;\n    Fur(i,2,n)in(x,y,w),c[x][w-'a']=y;\n    dfs(1,1);\n    Fur(i,1,n)if(a[i]>ans)as=i,ans=a[i];\n    printf(\"%d\\n%d\\n\",n-ans,as);\n}\n```\n", "link": "/posts/LG CF778C Peterson Polyglot/", "tags": ["trie", "\u542f\u53d1\u5f0f\u5408\u5e76"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5290 [\u5341\u4e8c\u7701\u8054\u80032019]\u6625\u8282\u5341\u4e8c\u54cd", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5290&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5290\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9898\u76ee\u7684\u610f\u601d\u5c31\u662f\u76f8\u540c\u5b50\u6811\u4e2d\u7684\u70b9\u4e0d\u80fd\u5206\u914d\u5230\u540c\u4e00\u6bb5\u5185\u5b58\n\n\u6bcf\u4e2a\u70b9\u90fd\u5f00\u4e00\u4e2a\u5927\u6839\u5806\n\n\u5408\u5e76\u4e00\u4e2a\u70b9\u548c\u5b83\u7684\u5b50\u8282\u70b9\u7684\u65f6\u5019\u6700\u5927\u503c\u4e92\u76f8\u5bf9\u5e94\n\n\u542f\u53d1\u5f0f\u5408\u5e76\n\n\u5177\u4f53\u770b\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}}using namespace IO;\nconst int N=200011;\nint n,cnt=0,head[N],a[N],id[N],dfn=0,tmp[N],tp=0;\nstruct edge{int to,nxt;}e[N];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nstd::priority_queue<int>q[N];\nil int max(int x,int y){return x>y?x:y;}\nil void swap(int &x,int &y){int t=x;x=y;y=t;}\nvoid dfs(int x){\n    id[x]=++dfn;\n    for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt){\n        dfs(to);\n        if(q[id[x]].size()<q[id[to]].size())swap(id[x],id[to]);\n        int t=q[id[to]].size();tp=0;\n        while(t--)\n            tmp[++tp]=max(q[id[x]].top(),q[id[to]].top()),\n            q[id[x]].pop(),q[id[to]].pop();\n        while(tp)q[id[x]].push(tmp[tp--]);\n    }\n    q[id[x]].push(a[x]);\n}\nint main(){\n    in(n);\n    int x;\n    Fur(i,1,n)in(a[i]);\n    Fur(i,2,n)in(x),add(x,i);\n    dfs(1);\n    long long ans=0;\n    while(!q[id[1]].empty())\n        ans+=q[id[1]].top(),\n        q[id[1]].pop();\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 5290 [\u5341\u4e8c\u7701\u8054\u80032019]\u6625\u8282\u5341\u4e8c\u54cd/", "tags": ["\u5806", "\u542f\u53d1\u5f0f\u5408\u5e76"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3201 [HNOI2009]\u68a6\u5e7b\u5e03\u4e01", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3201&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3201\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5176\u5b9e\u53ef\u4ee5\u8bf4\u662f\u524d\u5411\u661f\n\n\u6bcf\u6b21\u90fd\u628a\u77ed\u7684\u94fe\u8868\u63a5\u5230\u957f\u7684\u94fe\u8868\u4e0a\n\n\u7edf\u8ba1\u77ed\u7684\u94fe\u8868\u4e0a\u6bcf\u4e2a\u5143\u7d20\u6539\u53d8\u540e\u9020\u6210\u7684\u5f71\u54cd\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsignbl long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011;\nint n,q,a[N],ans=0,st[N],bl[N],head[N],nxt[N],sz[N];\nil void mg(int x,int y){\n    for(int i=head[x];i;i=nxt[i])ans-=(a[i-1]==y)+(a[i+1]==y);\n    for(int i=head[x];i;i=nxt[i])a[i]=y;\n    sz[y]+=sz[x];nxt[st[x]]=head[y];head[y]=head[x];\n    head[x]=st[x]=sz[x]=0;\n}\nint main(){\n    in(n,q);\n    Fur(i,1,n){\n        in(a[i]);\n        if(a[i]!=a[i-1])++ans;\n        bl[a[i]]=a[i];\n        if(!st[a[i]])st[a[i]]=i;\n        ++sz[a[i]];nxt[i]=head[a[i]];head[a[i]]=i;\n    }\n    while(q--){\n        int opt,x,y;\n        in(opt);\n        if(opt==2)out(ans,ln);\n        else{\n            in(x,y);\n            if(x!=y){\n                if(sz[bl[x]]>sz[bl[y]])SWAP(bl[x],bl[y]);\n                if(sz[bl[x]])mg(bl[x],bl[y]);\n            }\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3201 [HNOI2009]\u68a6\u5e7b\u5e03\u4e01/", "tags": ["\u542f\u53d1\u5f0f\u5408\u5e76", "\u94fe\u8868"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5584 \u3010SWTR-01\u3011Sunny's Crystals", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5584&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5584\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u60f3\u5230\u8d2a\u5fc3: \n\n\u5982\u679c\u76ee\u524d\u6709\u53ef\u4ee5\u6467\u6bc1\u7684\u76ee\u6807\u6c34\u6676,\u90a3\u4e48\u6467\u6bc1\u6700\u9760\u540e\u7684\n\n\u5426\u5219\u6467\u6bc1\u7b2c\u4e00\u4e2a\u6c34\u6676\n\n\u8bc1\u660e: \n\n> \u5982\u679c\u4e00\u4e2a\u6c34\u6676\u76ee\u524d\u65e0\u6cd5\u6467\u6bc1,\u5b83\u5fc5\u987b\u7b49\u524d\u9762\u82e5\u5e72\u4e2a\u6c34\u6676\u88ab\u6467\u6bc1\u5b83\u624d\u80fd\u79fb\u52a8\u5230\u76ee\u6807\u4f4d\u7f6e\n> \n> \u6240\u4ee5\u5f53\u76ee\u6807\u6c34\u6676\u6ca1\u6709\u53ef\u4ee5\u6467\u6bc1\u7684\u65f6\u5019,\u6467\u6bc1\u5e8f\u5217\u7b2c\u4e00\u4e2a\u53ef\u4ee5\u79fb\u52a8\u6700\u591a\u7684\u76ee\u6807\u6c34\u6676\n\n> \u5f53\u6709\u8d85\u8fc7\u4e00\u4e2a\u76ee\u6807\u6c34\u6676\u53ef\u4ee5\u6467\u6bc1\u7684\u65f6\u5019,\u4ece\u540e\u5f80\u524d\u6467\u6bc1\u663e\u7136\u662f\u6700\u4f18\u7684\n\n\u90a3\u4e48\u8981\u5982\u4f55\u5b9e\u73b0\u8fd9\u4e2a\u8d2a\u5fc3\u5462?\n\n\u5f88\u5bb9\u6613\u60f3\u5230\u6570\u636e\u7ed3\u6784\n\n1. \u5e73\u8861\u6811\u66b4\u529b\u64cd\u4f5c: \u6570\u636e\u8303\u56f4$3\\times 10^6$,\u663e\u7136\u662f\u4e0d\u884c\u7684\n   \n2. \u7ebf\u6bb5\u6811 \u76ee\u6807\u6c34\u6676\u6700\u591a$1.5\\times 10^6$,\u4e14\u7ebf\u6bb5\u6811\u5e38\u6570\u4e0d\u5927,\u53ef\u884c\n\n\u5b9e\u73b0: \n\n1. \u7ebf\u6bb5\u6811\u7ef4\u62a4\n\n\u7ef4\u62a4$d_1,d_2,\\dots,d_{cnt}$\u8868\u793a\u76ee\u6807\u6c34\u6676\u5230\u53ef\u4ee5\u6467\u6bc1\u7684\u4f4d\u7f6e\u7684\u8ddd\u79bb\n\n\u7ef4\u62a4\u6700\u5c0f\u503c\n\n\u82e5\u6700\u5c0f\u503c\u4e3a$0$,\u8fd9\u627e\u5230\u6700\u9760\u540e\u7684$d_x=0$,\u6467\u6bc1,\u4e5f\u5c31\u662f\u8ddd\u79bb\u8d4b\u503c\u4e3a\u65e0\u7a77\u5927,\u7136\u540e\u5c06$d_i,i\\in[x+1,cnt]$\u90fd\u51cf\u53bb$1$\n\n\u5426\u5219\u4e00\u76f4\u6467\u6bc1\u7b2c\u4e00\u4e2a\u6c34\u6676\u76f4\u5230\u6700\u5c0f\u503c\u4e3a$0$,\u4e5f\u5c31\u662f\u6240\u6709$d_i$\u90fd\u51cf\u53bb$min(d_i)$\n\n\u4ee3\u7801\u5982\u4e0b:\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i=x;i<=y;++i)\nil int MIN(int x,int y){return x<y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}}using namespace IO;\nconst int N=1500011;\nint n,w,cnt=0,s[N<<2],laz[N<<2],a[N],old[N],ANS[N<<1],ans=0,oth[N<<1];\n#define ls rt<<1\n#define rs rt<<1|1\nil void pu(int rt){s[rt]=MIN(s[ls],s[rs]);}\nil void pd(int rt){\n    if(laz[rt]){\n        laz[ls]+=laz[rt];s[ls]-=laz[rt];\n        laz[rs]+=laz[rt];s[rs]-=laz[rt];\n        laz[rt]=0;\n    }\n}\nvoid build(int l,int r,int rt){\n    if(l==r){s[rt]=a[l];return;}\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu(rt);\n}\nvoid upd(int L,int c,int l,int r,int rt){\n    if(L<=l){s[rt]-=c;laz[rt]+=c;return;}\n    int m=(l+r)>>1;\n    pd(rt);\n    if(L<=m)upd(L,c,l,m,ls);\n    upd(L,c,m+1,r,rs);\n    pu(rt);\n}\nint ask(int l,int r,int rt){\n    if(l==r){\n        s[rt]=(1<<30);\n        ANS[++ans]=old[l];\n        return l;\n    }\n    int m=(l+r)>>1,res;\n    pd(rt);\n    if(!s[rs])res=ask(m+1,r,rs);\n    else res=ask(l,m,ls);\n    pu(rt);\n    return res;\n}\nint main(){\n    in(n,w);\n    int x,b=1,now=0;\n    Fur(i,1,n){\n        if((b<<1)<=i)b<<=1;\n        in(x);\n        if(x==w)a[++cnt]=i-b,old[cnt]=i;\n        else oth[++now]=i;\n    }\n    now=0;\n    build(1,cnt,1);\n    Fur(t,1,cnt){\n        if(s[1]){\n            Fur(j,1,s[1])ANS[++ans]=oth[++now];\n            upd(1,s[1],1,cnt,1);\n        }\n        x=ask(1,cnt,1)+1;\n        if(x<=cnt)upd(x,1,1,cnt,1);\n    }\n    out(ans);pt('\\n');\n    Fur(i,1,ans)out(ANS[i]),pt(' ');\n    flush();\n}\n```\n\n2. \u5de7\u5999\u7684\u6a21\u62df\n\n\u53ef\u4ee5\u53ea\u7ef4\u62a4\u6240\u6709$2$\u6b21\u5e42\u4f4d\u7f6e\u5728\u539f\u5e8f\u5217\u4e2d\u7684\u4f4d\u7f6e\n\n\u6bcf\u6b21\u4fee\u6539\u53ea\u9700\u8981\u4fee\u6539$\\log_2 n$\u4e2a\u4f4d\u7f6e,\u590d\u6742\u5ea6\u5b8c\u5168\u53ef\u4ee5\u63a5\u53d7\n\n\u6839\u636e\u8fd9\u4e2a\u7279\u6027,\u66b4\u529b\u8dd1\u7684\u6bd4\u6b63\u89e3\u7ebf\u6bb5\u6811\u8fd8\u5feb\n\n\u4ee3\u7801\u5982\u4e0b: \n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i=x;i<=y;++i)\n#define Fdr(i,x,y) for(int i=x;i>=y;--i)\nil int MIN(int x,int y){return x<y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}}using namespace IO;\nconst int N=3000011;\nint n,tot=0,b=0,w,a[N],p[N],ans=0,ANS[N];\nint main(){\n    in(n,w);\n    Fur(i,1,n){\n        in(a[i]);\n        if(a[i]==w)++tot;\n    }\n    a[n+1]=-1;\n    while((1<<b)<=n)p[b+1]=(1<<b),++b;\n    while(tot){\n        bool f=0;\n        Fdr(i,b,1)if(a[p[i]]==w){\n            ANS[++ans]=p[i];\n            a[p[i]]=0;\n            Fur(j,i,b)if(p[j]<=n)\n                while(!a[++p[j]]);\n            --tot;f=1;break;\n        }\n        if(!f){\n            ANS[++ans]=p[1],a[p[1]]=0;\n            Fur(i,1,b)if(p[i]<=n)\n                while(!a[++p[i]]);\n        }\n    }\n    out(ans);pt('\\n');\n    Fur(i,1,ans)out(ANS[i]),pt(' ');\n    flush();\n}\n```\n", "link": "/posts/LG 5584 \u3010SWTR-01\u3011Sunny's Crystals/", "tags": ["\u8d2a\u5fc3", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2851 [USACO06DEC]\u6700\u5c11\u7684\u786c\u5e01The Fewest Coins", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2851&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2851\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u80fd\u51d1\u51fa\u7684\u94b1: \u4f7f\u7528\u591a\u91cd\u80cc\u5305(\u4e8c\u8fdb\u5236\u4f18\u5316)\n\n\u627e\u96f6: \u4f7f\u7528\u5b8c\u5168\u80cc\u5305\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=20011;\nint n,T,f[N],g[N],v[111];\nvoid upd(int x,int c){Fdr(j,T*2,x)f[j]=MIN(f[j],f[j-x]+c);}\nint main(){\n    in(n,T);\n    clr(f,0x3f);clr(g,0x3f);\n    f[0]=g[0]=0;\n    Fur(i,1,n)in(v[i]);\n    Fur(i,1,n)\n        Fur(j,v[i],T)\n            g[j]=MIN(g[j],g[j-v[i]]+1);\n    Fur(i,1,n){\n        int c;in(c);\n        for(int t=1;t<=c;t<<=1)\n            upd(v[i]*t,t),c-=t;\n        if(c)upd(v[i]*c,c);\n    }\n    int ans=inf;\n    Fur(i,T,T*2)\n        ans=MIN(ans,f[i]+g[i-T]);\n    if(ans>T)ans=-1;\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 2851 [USACO06DEC]\u6700\u5c11\u7684\u786c\u5e01The Fewest Coins/", "tags": ["\u80cc\u5305", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1776 \u5b9d\u7269\u7b5b\u9009", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1776&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1776\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u591a\u91cd\u80cc\u5305\u4f18\u5316\u6a21\u677f\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,W,tot=0,f[N];\nstruct node{int v,w;}a[N];\nint main(){\n    in(n,W);\n    int v,w,m;\n    Fur(i,1,n){\n        in(v,w,m);\n        for(int t=1;t<=m;t<<=1)\n            a[++tot]=node{v*t,w*t},m-=t;\n        if(m)a[++tot]=node{v*m,w*m};\n    }\n    Fur(i,1,tot)\n        Fdr(j,W,a[i].w)\n            f[j]=MAX(f[j],f[j-a[i].w]+a[i].v);\n    printf(\"%d\\n\",f[W]);\n}\n```\n", "link": "/posts/LG 1776 \u5b9d\u7269\u7b5b\u9009/", "tags": ["\u591a\u91cd\u80cc\u5305", "\u52a8\u6001\u89c4\u5212", "\u4e8c\u8fdb\u5236\u4f18\u5316"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3846 [TJOI2007]\u53ef\u7231\u7684\u8d28\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3846&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3846\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nbsgs\u6a21\u677f\u9898\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000007;\nint y,z,p;\nstruct hash{\n    int cnt=0,head[N];\n    struct edge{int to,nxt,w;}e[N];\n    il void add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\n    il void ins(int x,int v){add(x%N,x,v);}\n    il int ask(int x){fl(i,x%N)if(to==x)return e[i].w;return -1;}\n}S;\nil int pw(int x,int b){\n    int ans=1;\n    while(b){\n        if(b&1)ans=1ll*ans*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return ans;\n}\nint main(){\n    in(p,y,z);\n    int m=sqrt(p)+1,x=z%p,f=pw(y,m),ff=1;\n    Fur(i,0,m)S.ins(x,i),x=1ll*x*y%p;\n    x=1;\n    Fur(i,1,m){\n        x=1ll*x*f%p;\n        int k=S.ask(x);\n        if(~k){\n            ff=0;\n            printf(\"%d\\n\",((1ll*i*m-k)%p+p)%p);\n            break;\n        }\n    }\n    if(ff)printf(\"no solution\\n\");\n}\n```\n", "link": "/posts/LG 3846 [TJOI2007]\u53ef\u7231\u7684\u8d28\u6570/", "tags": ["bsgs", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3306 [SDOI2013]\u968f\u673a\u6570\u751f\u6210\u5668", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3306&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3306\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u8981\u505a\u7684\u662f\u5f3a\u884c\u5c06\u5f0f\u5b50\u8f6c\u6362\u4e3absgs\u80fd\u6c42\u89e3\u7684\u5f62\u5f0f(\u6c42$y^x\\equiv z \\pmod p$)\n\n$$\nX_{i+1} \\equiv aX_i+b \\pmod p\n\\\\\nX_{i+1} + \\frac ba \\equiv aX_i+b+\\frac ba \\pmod p\n\\\\\naX_{i+1} + b \\equiv a^2X_i+ab+b \\pmod p\n\\\\\nX_{i+2} \\equiv a^2X_i+ab + b \\pmod p\n$$\n\n\u7ee7\u7eed\u5f80\u4e0b\u63a8,\u5e76\u6839\u636e\u7b49\u6bd4\u6570\u5217\u7684\u516c\u5f0f\u53ef\u4ee5\u5f97\u5230:\n\n$$\nX_i \\equiv a^{i-1}X_1+\\frac{b(1-a^{i-1})}{1-a} \\pmod p\n$$\n\n\u5e26\u5165$t\\equiv X_i \\pmod p$,\u5f97\n\n$$\nt \\equiv a^{i-1}X_1+\\frac{b(1-a^{i-1})}{1-a} \\pmod p\n\\\\\n(1-a)t \\equiv (1-a)a^{i-1}X_1+b(1-a^{i-1}) \\pmod p\n\\\\\nt-at \\equiv a^{i-1}(X_1-aX_1)+b-b\\cdot a^{i-1} \\pmod p\n\\\\\na^{i-1}(X_1-aX_1-b)\\equiv t-at-b \\pmod p\n\\\\\na^{i-1}\\equiv \\frac{t-at-b}{X_1-aX_1-b} \\pmod p\n$$\n\n\u6210\u529f\u5f3a\u884c\u8f6c\u6362\n\n~~\u53ef\u4ee5\u7528bsgs\u6c42\u89e3\u4e86!~~\n\n\u8fd8\u6ca1\u5b8c,\u8981\u8003\u8651\u4e00\u4e0b\u51e0\u79cd\u7279\u6b8a\u60c5\u51b5: \n\n1. $X_1=t$\n   \n   \u7b2c\u4e00\u5929\u5c31\u53ef\u4ee5\u8bfb\u5230\n2. $a=1$\n   \n   \u9898\u76ee\u53d8\u4e3a$X_1+kb \\equiv t \\pmod p$\n\n   \u56e0\u4e3a$p$\u662f\u8d28\u6570,\u6240\u4ee5\u53ef\u4ee5\u76f4\u63a5\u7528\u8d39\u9a6c\u5c0f\u5b9a\u7406\u6c42\u9006\u5143\n\n   $b=0$\u65f6\u65e0\u89e3\n3. $a=0$\n   \n   \u5224\u65ad$b=t$\n   \n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000007;\nint n,p,a,b,X1,t,T;\nil int pw(int x,int b){\n    int ans=1;\n    while(b){\n        if(b&1)ans=1ll*ans*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return ans;\n}\nil int inv(int x){return pw(x,p-2);}\nstruct hash{\n    int head[N],cnt=0;\n    struct edge{int to,nxt,w;}e[N];\n    il void add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\n    il void clear(){cnt=0;clr(head,0);}\n    il void ins(int x,int v){add(x%N,x,v);}\n    il int ask(int x){\n        for(int i=head[x%N];i;i=e[i].nxt)\n            if(e[i].to==x)return e[i].w;\n        return -1;\n    }\n}S;\n\nil int bsgs(int y,int z){\n    S.clear();\n    int m=sqrt(p)+1,x=z%p,f=pw(y,m);\n    Fur(i,0,m)S.ins(x,i),x=1ll*x*y%p;\n    x=1;\n    Fur(i,1,m){\n        x=1ll*x*f%p;\n        int k=S.ask(x);\n        if(~k)return ((1ll*i*m-k)%p+p)%p;\n    }\n    return -2;\n}\nint main(){\n    in(T);\n    while(T--){\n        in(p,a,b,X1,t);\n        if(X1==t){out(\"1\\n\");continue;}\n        if(!a){out((b==t)?2:-1,ln);continue;}\n        if(a==1){\n            if(!b)out(\"-1\\n\");\n            else out(1ll*inv(b)*(((t-X1)%p+p)%p)%p+1,ln);\n            continue;\n        }\n        int x=1ll*(t-(1ll*a*t%p)+p-b+p)%p*(inv(X1-1ll*a*X1%p+p-b+p)%p)%p;\n        out(bsgs(a,x)+1,ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3306 [SDOI2013]\u968f\u673a\u6570\u751f\u6210\u5668/", "tags": ["\u6570\u8bba", "bsgs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP3105 MOD - Power Modulo Inverted", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP3105&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP3105\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100007;\nstruct hash{\n    struct edge{int to,nxt,w;}e[N];\n    int cnt=0,head[N],p=N;\n    il void add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\n    il void clear(){cnt=0;clr(head,0);}\n    il void ins(int x,int v){add(x%p,x,v);}\n    int operator[](int x){\n        for(int i=head[x%p];i;i=e[i].nxt)\n            if(e[i].to==x)return e[i].w;\n        return -1;\n    }\n}S;\nil int pw(int x,int b,int p){\n    int ans=1;\n    while(b){\n        if(b&1)ans=1ll*ans*x%p;\n        b>>=1;x=1ll*x*x%p;\n    }\n    return ans;\n}\nvoid exbsgs(int y,int z,int p){\n    if(z==1)return void(out(\"0\\n\"));\n    int k=0,a=1;\n    while(1){\n        int d=GCD(y,p);\n        if(d==1)break;\n        if(z%d)return void(out(\"No Solution\\n\"));\n        z/=d;p/=d;\n        ++k;\n        a=1ll*a*y/d%p;\n        if(z==a)return void(out(k,ln));\n    }\n    S.clear();\n    int m=sqrt(p)+1,x=z,f=pw(y,m,p);\n    Fur(i,0,m-1)S.ins(x,i),x=1ll*x*y%p;\n    x=1ll*a*f%p;\n    Fur(i,1,m){\n        int b=S[x];\n        if(~b)return void(out(i*m-b+k,ln));\n        x=1ll*x*f%p;\n    }\n    out(\"No Solution\\n\");\n}\nint main(){\n    int y,z,p;\n    while(1){\n        in(y,p,z);\n        if(!y&&!z&&!p)break;\n        exbsgs(y,z,p);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG SP3105 MOD - Power Modulo Inverted/", "tags": ["bsgs", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2485 [SDOI2011]\u8ba1\u7b97\u5668", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2485&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2485\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n1. \u5feb\u901f\u5e42\n2. Exgcd\n   \n   $xy \\equiv z \\pmod p$\n\n   $yx+pb = z$\n    \n    \u53ef\u4ee5\u7528Exgcd\u6c42\u89e3\n\n3. bsgs\n   \n   > \u6c42\u89e3\u5173\u4e8e$x$\u7684\u65b9\u7a0b: \n   > \n   > $$y^x \\equiv z \\pmod p$$\n   > \n   > \u5176\u4e2d$\\gcd(y,p)=1$\n   > \n   > \u89e3\u6cd5: \n   > \n   > \u8bbe$x=am-b$\n   > \n   > \u90a3\u4e48$y^{am} \\equiv z \\cdot y^b \\pmod p$\n   > \n   > \u53f3\u8fb9: \n   > \n   > \u679a\u4e3e$b$\u7684\u53d6\u503c$[0,m-1]$,\u8ba1\u7b97\u53f3\u8fb9\u7684\u503c,\u5b58\u5165\u54c8\u5e0c\u8868\n   > \n   > \u5de6\u8fb9:\n   > \n   > \u679a\u4e3e\u53ef\u80fd\u7684$a$,\u4e5f\u5c31\u662f$[1,m]$,\u82e5\u5de6\u8fb9\u7684\u503c\u5728\u54c8\u5e0c\u8868\u4e2d\u51fa\u73b0\u8fc7,\u90a3\u4e48\u5f53\u524d$a$\u5408\u6cd5\n   > \n   > \u4e0d\u96be\u8bc1\u660e\u5f53$m=\\sqrt p$\u7684\u65f6\u5019\u590d\u6742\u5ea6\u6700\u4f18,$\\Theta(\\sqrt p)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nint T,typ,p;\nil int pw(int x,int b){\n    int ans=1;\n    while(b){\n        if(b&1)ans=1ll*ans*x%p;\n        x=1ll*x*x%p;b>>=1;\n    }\n    return ans;\n}\nstruct hash{\n    #define N 37273\n    int P=N,head[N],cnt;\n    struct edge{int to,nxt,w;}e[N];\n    il void clear(){cnt=0;clr(head,0);}\n    il void add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\n    il void ins(int x,int v){add(x%P,x,v);}\n    int operator[](int x){\n        for(int i=head[x%P];i;i=e[i].nxt)\n            if(e[i].to==x)return e[i].w;\n        return -1;\n    }\n}S;\nint main(){\n    in(T,typ);\n    while(T--){\n        int a,b,t;\n        in(a,b,p);\n        if(typ==1)out(pw(a%p,b),ln);\n        if(typ==2){//xa equiv b\n            a%=p;b%=p;\n            if(!a&&b)out(\"Orz, I cannot find x!\\n\");\n            else out(1ll*pw(a,p-2)*b%p,ln);\n        }\n        if(typ==3){//a^x equiv b;\n            a%=p;\n            if(!a){\n                if(!b)out(\"1\\n\");\n                else out(\"Orz, I cannot find x!\\n\");\n                continue;\n            }\n            int m=sqrt(p)+1,x=b%p,t=pw(a,m);\n            S.clear();\n            S.ins(x,0);\n            Fur(i,1,m)x=1ll*x*a%p,S.ins(x,i);\n            x=1;\n            bool ff=1;\n            Fur(i,1,m){\n                x=1ll*x*t%p;\n                int k=S[x];\n                if(~k){\n                    ff=0;\n                    out(((i*m-k)%p+p)%p,ln);\n                    break;\n                }\n            }\n            if(ff)out(\"Orz, I cannot find x!\\n\");\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 2485 [SDOI2011]\u8ba1\u7b97\u5668/", "tags": ["\u6570\u8bba", "exgcd", "bsgs", "\u5feb\u901f\u5e42"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2476 [SCOI2008]\u7740\u8272\u65b9\u6848", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2476&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2476\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f[i,j]$\u8868\u793a\u7528\u5b8c\u4e86\u524d$i$\u79cd\u6cb9\u6f06,\u6709$j$\u5bf9\u76f8\u90bb\u4e14\u540c\u8272\u7684\u6728\u5757\n\n\u8003\u8651\u600e\u4e48\u8f6c\u79fb: \n\n\u8981\u5c06\u7b2c$i$\u79cd\u989c\u8272\u7684\u6728\u5757\u5206\u4e24\u79cd\u60c5\u51b5\u63d2\u5165:\n\n1. \u8bbe\u5176\u4e2d$a$\u4e2a\u63d2\u5230\u4e4b\u524d\u5f04\u597d\u7684\u6728\u5757\u4e2d\u95f4(\u65e0\u5e8f)\n   \n2. \u8bbe\u53e6\u5916$b$\u4e2a\u63d2\u5728\u540c\u8272\u6728\u5757\u4e2d\u95f4\n\n\u5176\u4e2d\u6709$a-b$\u7ec4\u6ee1\u8db3\u63d2\u7a7a\u653e\u4e14\u4e0d\u76f8\u90bb\n\n$f[i,j]=\\sum f[i-1,j-(c_i-a-b)]\\times {c_i-1 \\choose a-1} \\times {j \\choose b} \\times{S_{i-1}+1-j \\choose a-b}$\n\n> ${c_i-1 \\choose a-1}$\u8868\u793a$a$\u4e2a\u7684\u65b9\u6848\u6570\n>\n> ${j \\choose b}$\u8868\u793a$b$\u4e2a\u7684\u65b9\u6848\u6570\n> \n> ${S_{i-1}+1-j \\choose a-b}$\u8868\u793a$a-b$\u4e2a\u63d2\u8fdb\u53bb\u7684\u65b9\u6848\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nint n,c[20],f[20][80],C[80][80],P=1000000007;\nint main(){\n    C[0][0]=1;\n    Fur(i,1,75){\n        C[i][0]=C[i][i]=1;\n        Fur(j,1,i-1)\n            C[i][j]=(C[i-1][j]+C[i-1][j-1])%P;\n    }\n    in(n);\n    Fur(i,1,n)in(c[i]);\n    f[1][c[1]-1]=1;\n    int s=0;\n    Fur(i,1,n-1){\n        s+=c[i];\n        Fur(j,0,s-1)if(f[i][j])\n            Fur(a,1,c[i+1])\n                Fur(b,0,MIN(a,j))\n                f[i+1][j+c[i+1]-a-b]=(f[i+1][j+c[i+1]-a-b]+\n                1ll*f[i][j]*C[c[i+1]-1][a-1]%P*C[j][b]%P*C[s+1-j][a-b]%P)%P;\n    }\n    printf(\"%d\\n\",f[n][0]);\n}\n```\n", "link": "/posts/LG 2476 [SCOI2008]\u7740\u8272\u65b9\u6848/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u7ec4\u5408\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3287 [SCOI2014]\u65b9\u4f2f\u4f2f\u7684\u7389\u7c73\u7530", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3287&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3287\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f(i,k)$\u8868\u793a\u524d$i$\u4f4d\u7f6e,\u64cd\u4f5c$k$\u6b21,\u6700\u591a\u5269\u4e0b\u591a\u5c11\u7389\u7c73\n\n> **\u6bcf\u4e00\u6b21\u7684\u62d4\u9ad8\u64cd\u4f5c\u533a\u95f4\u53f3\u7aef\u70b9\u4e00\u5b9a\u662f\u6700\u53f3\u8fb9\u7684\u7389\u7c73**\n\n$f(i,k)=max_{j<i}(f(j,k-t))+1,a_i+t\\ge a_j$\n\n\u76f4\u63a5\u679a\u4e3e$\\mathcal{O(n^2k^2)}$\u4f1a\u8d85\u65f6,\u6211\u4eec\u5f97\u60f3\u4e2a\u529e\u6cd5\u4f18\u5316\n\n\u53ef\u4ee5\u8003\u8651\u7528\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\u4f18\u5316\n\n> \u4f18\u5316\u4e3a\u53ea\u9700\u8981\u4e24\u4e2a\u6811\u72b6\u6570\u7ec4\n> \n> https://guodonglovesoi.blog.luogu.org/scoi2014-fang-bo-bo-di-yu-mi-tian\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int mx=5511;\nint n,k,f[555][mx];\nstruct bit{\n    int s[mx+11];\n    il void upd(int x,int v){\n        for(int i=x;i<=mx;i+=i&-i)\n            s[i]=MAX(s[i],v);\n    }\n    il int ask(int x){\n        int ans=0;\n        for(int i=x;i;i-=i&-i)\n            ans=MAX(ans,s[i]);\n        return ans;\n    }\n}T[555];\nil void UPD(int x,int a,int v){\n    for(int i=x;i<=505;i+=i&-i)\n        f[i][a]=MAX(f[i][a],v);\n}\nil int ASK(int x,int a){\n    int ans=0;\n    for(int i=x;i;i-=i&-i)\n        ans=MAX(ans,f[i][a]);\n    return ans;\n}\nint main(){\n    in(n,k);\n    int ans=0,res,a;\n    Fur(i,1,n){\n        in(a);\n        Fur(j,0,k)\n            res=MAX(T[j+1].ask(a+j),ASK(j+1,a+j))+1,\n            ans=MAX(ans,res),\n            T[j+1].upd(a+j,res),\n            UPD(j+1,a+j,res);\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 3287 [SCOI2014]\u65b9\u4f2f\u4f2f\u7684\u7389\u7c73\u7530/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1000E We-Need-More-Bosses", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1000E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1000E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53cc\u8fde\u901a\u5206\u91cf\u7f29\u70b9\u540e\u5f97\u5230\u7684\u6811\u7684\u76f4\u5f84\u5c31\u662f\u7b54\u6848\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=300011;\nint n,m,cnt=1,head[N],st[N],tp=0,bl[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint dfn[N],low[N],sz=0;\nvoid tarjan(int x,int la){\n    dfn[x]=low[x]=++sz;st[++tp]=x;\n    fl(i,x)if(i!=la){\n        if(!dfn[to])\n            tarjan(to,i^1),\n            low[x]=MIN(low[x],low[to]);\n        else low[x]=MIN(low[x],dfn[to]);\n    }\n    if(low[x]==dfn[x])\n    while(int k=st[tp--]){\n        bl[k]=x;\n        if(k==x)break;\n    }\n}\nint q[N],d[N];\nint bfs(int x){\n    clr(d,0);d[x]=1;\n    int h=0,t=1,mx=0;\n    q[0]=x;\n    while(h<t){\n        x=q[h++];\n        if(d[x]>d[mx])mx=x;\n        fl(i,x)if(!d[to])\n            d[to]=d[x]+1,q[t++]=to;\n    }\n    return mx;\n}\nint main(){\n    in(n,m);\n    int x,y;\n    Fur(i,1,m)in(x,y),add(x,y),add(y,x);\n    tarjan(1,0);\n    cnt=0;clr(head,0);\n    Fur(i,1,m)\n    if((x=bl[e[i*2].to])!=(y=bl[e[i*2+1].to]))\n        add(x,y),add(y,x);\n    printf(\"%d\\n\",d[bfs(bfs(bl[1]))]-1);\n}\n```\n", "link": "/posts/LG CF1000E We-Need-More-Bosses/", "tags": ["\u6811\u7684\u76f4\u5f84", "tarjan", "\u53cc\u8fde\u901a\u5206\u91cf"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF718C Sasha-and-Array", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF718C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF718C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5bf9\u4e8e\u7b2c\u4e8c\u95ee: \n\n\u770b\u5230\u6570\u636e\u8303\u56f4\u53ef\u4ee5\u60f3\u5230\u77e9\u9635\u5feb\u901f\u5e42\u6c42\u6590\u6ce2\u90a3\u5951\u6570\u5217\n\n\u77e9\u9635\u4e58\u6cd5\u5177\u6709\u5206\u914d\u7387: $AC+BC=(A+B)C$\n\n\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u77e9\u9635\u533a\u95f4\u4e58\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,P=1000000007;\nint n,q;\nstruct mat{int a[2][2];}A={\n    1,0,\n    1,0,\n},B={\n    1,1,\n    1,0,\n},C={\n    1,0,\n    0,1\n},t,s[N<<2],laz[N<<2];\nmat operator+(mat x,mat y){\n    mat c;\n    for(int i=0;i<2;++i)\n        for(int j=0;j<2;++j)\n            c.a[i][j]=(x.a[i][j]+y.a[i][j])%P;\n    return c;\n}\nmat operator*(mat x,mat y){\n    mat c;clr(c.a,0);\n    for(int i=0;i<2;++i)\n        for(int j=0;j<2;++j)\n            for(int k=0;k<2;++k)\n                c.a[i][j]=(c.a[i][j]+1ll*x.a[i][k]*y.a[k][j]%P)%P;\n    return c;\n}\nmat pw(int p){\n    mat a=C,b=B;\n    while(p){\n        if(p&1)a=a*b;\n        p>>=1;b=b*b;\n    }\n    return a;\n}\n#define ls rt<<1\n#define rs rt<<1|1\nvoid pd(int rt){\n    laz[ls]=laz[ls]*laz[rt];\n    laz[rs]=laz[rs]*laz[rt];\n    s[ls]=s[ls]*laz[rt];\n    s[rs]=s[rs]*laz[rt];\n    laz[rt]=C;\n}\nvoid build(int l,int r,int rt){\n    laz[rt]=C;\n    if(l==r){\n        int x;in(x);\n        s[rt]=A*pw(x-1);\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nvoid upd(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt]=s[rt]*t;\n        laz[rt]=laz[rt]*t;\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt);\n    if(L<=m)upd(L,R,l,m,ls);\n    if(R>m)upd(L,R,m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nmat ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1;\n    pd(rt);\n    mat ans;clr(ans.a,0);\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans=ans+ask(L,R,m+1,r,rs);\n    return ans;\n}\nsigned main(){\n    in(n,q);\n    build(1,n,1);\n    while(q--){\n        int u,l,r,v;\n        in(u,l,r);\n        if(u==1)\n            in(v),t=pw(v),\n            upd(l,r,1,n,1);\n        else out(ask(l,r,1,n,1).a[0][0],ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF718C Sasha-and-Array/", "tags": ["\u6570\u8bba", "\u77e9\u9635\u4e58\u6cd5", "\u5feb\u901f\u5e42", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5628 \u3010AFOI-19\u3011\u9762\u57fa", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5628&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5628\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u53ef\u4ee5dfs\u5904\u7406\u51fa\u6240\u6709\u8def\u5f84\u7684\u91cd\u8981\u5ea6(\u8def\u5f84\u4e24\u7aef\u5b50\u6811\u5927\u5c0f\u4e58\u79ef)\n\n\u7136\u540e\u5c31\u662f\u6811\u578bdp\u5904\u7406\u51fa\u6bcf\u4e2a\u70b9\u5f71\u54cd\u7684\u8303\u56f4\u7684\u91cd\u8981\u5ea6\u603b\u548c\n\n\u6700\u540e\u53d6\u6700\u5927\u503c\u5c31\u53ef\u4ee5\u4e86\n\n$f(dis,x)$\u8868\u793a\u4e0e$x$\u8ddd\u79bb\u4e0d\u8d85\u8fc7$dis$\u7684\u6240\u6709\u8def\u5f84\u7684\u91cd\u8981\u5ea6\n\n$f(1,x)=\\sum val(edge)$\n\n$f(k,x)=\\sum f(k-1,to)-f(k-2,x)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<18;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=300011;\nint n,k,cnt=1,head[N],siz[N];\nll f[211][N],val[N],ans=0;\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(!siz[to]){\n        dfs(to);\n        val[i>>1]=1ll*siz[to]*(n-siz[to]);\n        siz[x]+=siz[to];\n    }\n}\nint main(){\n    in(n,k);++k;\n    int x,y;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    dfs(1);\n    Fur(i,1,n)fl(j,i)f[1][i]+=val[j>>1];\n    Fur(i,2,k)\n        Fur(x,1,n){\n            f[i][x]=f[i-2][x];\n            fl(j,x)f[i][x]+=f[i-1][to]-f[i-2][x];\n        }\n    Fur(x,1,n)ans=MAX(ans,f[k][x]);\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 5628 \u3010AFOI-19\u3011\u9762\u57fa/", "tags": ["dfs", "\u6811\u578bdp", "\u5bb9\u65a5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3536 [POI2012]BON-Vouchers", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3536&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3536\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u76f4\u63a5\u6a21\u62df\n\n\u590d\u6742\u5ea6$\\mathcal{O}(\\frac n1 + \\frac n2 + , ... + \\frac nn)=\\mathcal{O}(n \\log n)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011;\nint n,la[N],tot=0,mx=0;\nll ans[N],now=0;\nbool b[N],v[N];\nint main(){\n    in(n);\n    int x;\n    while(n--)in(x),b[x]=1,mx=MAX(mx,x);\n    in(n);\n    v[0]=1;\n    while(n--){\n        in(x);\n        int p=x,&s=la[x];\n        for(;p;--p){\n            while(s<=mx&&v[s])s+=x;\n            if(s>mx)break;\n            v[s]=1;++now;\n            if(b[s])ans[++tot]=now;\n        }\n        now+=p;\n    }\n    out(tot,ln);\n    Fur(i,1,tot)out(ans[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3536 [POI2012]BON-Vouchers/", "tags": ["\u6570\u8bba", "\u6a21\u62df"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4238 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\u9006", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4238&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4238\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5047\u8bbe\u6211\u4eec\u8981\u6c42\u7684\u662f$A\\cdot B \\equiv 1 \\pmod{x^n}$,\n\n\u6211\u4eec\u5df2\u7ecf\u6c42\u51fa\u4e86$B'$\u6ee1\u8db3$A\\cdot B' \\equiv 1 \\pmod{x^\\frac n2}$\n\n$$\n\\because A\\cdot B \\equiv 1 \\pmod {x^n}\n\\\\\n\\because A\\cdot B' \\equiv 1 \\pmod{x^\\frac n2}\n\\\\\n\\therefore A \\cdot (B-B') \\equiv 0 \\pmod{x^\\frac n2}\n\\\\\n\\therefore B-B' \\equiv 0 \\pmod{x^\\frac n2}\n\\\\\n(B-B')^2 \\equiv 0 \\pmod{x^n}\n\\\\\nB^2-2BB'+B'^2 \\equiv 0 \\pmod{x^n}\n\\\\\n\\therefore A(B^2-2BB'+B'^2) \\equiv 0 \\pmod{x^n}\n\\\\\nAB^2-2ABB'+AB'^2 \\equiv 0 \\pmod{x^n}\n\\\\\n\\because A\\cdot B \\equiv 1 \\pmod {x^n}\n\\\\\n\\therefore B-2B'+AB'^2\\equiv 0 \\pmod{x^n}\n\\\\\nB\\equiv 2B'-AB'^2 \\pmod{x^n}\n$$\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u7528\u500d\u589e+NTT\u89e3\u51b3(\u590d\u6742\u5ea6$\\mathcal{O(n \\log^2 n)}$)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=400011,P=998244353,G=3,Gi=332748118;\nint n,l=0,limit=1,r[N],a[N],b[N],c[N];\nil int pw(int x,int p){\n    int ans=1;\n    for(;p;x=1ll*x*x%P,p>>=1)if(p&1)ans=1ll*ans*x%P;\n    return ans;\n}\nil void NTT(int *A,int typ){\n    Fur(i,0,limit-1)\n        if(i<r[i])SWAP(A[i],A[r[i]]);\n    for(int len=1;len<limit;len<<=1){\n        int Wn=pw(~typ?G:Gi,(P-1)/(len<<1));\n        for(int i=0;i<limit;i+=(len<<1)){\n            int w=1;\n            Fur(k,0,len-1){\n                int t=1ll*w*A[i+k+len]%P;\n                A[i+k+len]=(A[i+k]-t+P)%P;\n                A[i+k]=(A[i+k]+t)%P;\n                w=1ll*w*Wn%P;\n            }\n        }\n    }\n    if(~typ)return;\n    int inv=pw(limit,P-2);\n    Fur(i,0,limit-1)A[i]=1ll*A[i]*inv%P;\n}\nvoid work(int p,int *a,int *b){\n    if(p==1)return void(b[0]=pw(a[0],P-2));\n    work(((p+1)>>1),a,b);\n    limit=1,l=0;\n    while(limit<(p<<1))limit<<=1,++l;\n    Fur(i,0,limit-1)\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    Fur(i,0,p-1)c[i]=a[i];\n    Fur(i,p,limit-1)c[i]=0;\n    NTT(c,1);NTT(b,1);\n    Fur(i,0,limit-1)b[i]=1ll*b[i]*(2ll-1ll*c[i]*b[i]%P+P)%P;\n    NTT(b,-1);\n    Fur(i,p,limit-1)b[i]=0;\n}\nint main(){\n    in(n);\n    Fur(i,0,n-1)in(a[i]);\n    work(n,a,b);\n    Fur(i,0,n-1)out(b[i],\" \");\n    flush();\n}\n```\n", "link": "/posts/LG 4238 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\u9006/", "tags": ["ntt", "\u6570\u8bba", "\u9006\u5143"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3338 [ZJOI2014]\u529b", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3338&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3338\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$\nE_i=\\frac{F_i}{q_i}=\\sum_{j=1}^{i-1}\\frac{q_j}{(i-j)^2}-\\sum_{j=i+1}^n \\frac{q_j}{(j-i)^2}\n$$\n\n\u8bbe$f_i=q_i,g_i=\\frac 1{i^2},f_0=0,g_0=0$\n\n$$\nE_i=\\sum_{j=1}^i f_j\\cdot g_{i-j}-\\sum_{j=i}^n f_j\\cdot g_{j-i}\n$$\n\n\u53ef\u4ee5\u53d1\u73b0\u524d\u534a\u90e8\u5206\u662f\u5377\u79ef\u7684\u5f62\u5f0f\n\n\u6211\u4eec\u6765\u8003\u8651\u540e\u534a\u90e8\u5206\n\n$$\n\\sum_{j=i}^n f_j\\cdot g_{j-i}\n\\\\\n=\\sum_{j=0}^{n-i} f_{i+j}\\cdot g_j\n$$\n\n\u4ee4$t=n-i,f'_i=f_{n-i}$\n\n$$\n=\\sum_{j=i}^t g_j\\cdot f'_{t-i}\n$$\n\n\u4e5f\u6210\u529f\u8f6c\u5316\u4e3a\u5377\u79ef\u7684\u5f62\u5f0f\n\n\u53ef\u4ee5\u5f00\u59cb\u6109\u5feb\u5730\u4f7f\u7528FFT\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=400011;\nint n,limit=1,l=0,r[N];\ndb q[N],Pi=acos(-1.0);\nstruct cp{db r,i;cp(db R=0,db I=0){r=R,i=I;}}a[N],b[N],c[N];\ncp operator + (cp a,cp b){return cp(a.r+b.r,a.i+b.i);}\ncp operator - (cp a,cp b){return cp(a.r-b.r,a.i-b.i);}\ncp operator * (cp a,cp b){return cp(a.r*b.r-a.i*b.i,a.r*b.i+a.i*b.r);}\nvoid fft(cp *A,int typ){\n    Fur(i,0,limit-1)\n        if(i<r[i])SWAP(A[i],A[r[i]]);\n    for(int len=1;len<limit;len<<=1){\n        cp Wn(cos(Pi/len),typ*sin(Pi/len));\n        for(int i=0;i<limit;i+=(len<<1)){\n            cp w(1,0);\n            Fur(k,0,len-1){\n                cp t=w*A[i+k+len];\n                A[i+k+len]=A[i+k]-t;\n                A[i+k]=A[i+k]+t;\n                w=w*Wn;\n            }\n        }\n    }\n    if(~typ)return;\n    Fur(i,0,limit-1)A[i].r/=limit;\n}\nint main(){\n    scanf(\"%d\",&n);\n    Fur(i,1,n)\n        scanf(\"%lf\",&a[i].r),\n        b[i].r=(db)1.0/i/i,\n        c[n-i]=a[i];\n    while(limit<=n*2)limit<<=1,++l;\n    Fur(i,0,limit-1)\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    fft(a,1),fft(b,1),fft(c,1);\n    Fur(i,0,limit-1)a[i]=a[i]*b[i],c[i]=c[i]*b[i];\n    fft(a,-1),fft(c,-1);\n    Fur(i,1,n)printf(\"%.3f\\n\",a[i].r-c[n-i].r);\n}\n```\n", "link": "/posts/LG 3338 [ZJOI2014]\u529b/", "tags": ["fft"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2000 \u62ef\u6551\u4e16\u754c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2000&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2000\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n1. \u91d1\u795e\u77f3\u7684\u5757\u6570\u5fc5\u987b\u662f6\u7684\u500d\u6570\n   $g(x)=1+x^6+x^{12}+...=\\frac 1{1-x^6}$\n2. \u6728\u795e\u77f3\u6700\u591a\u75289\u5757\n   $g(x)=1+x+x^2+...+x^9=\\frac{1-x^{10}}{1-x}$\n3. \u6c34\u795e\u77f3\u6700\u591a\u75285\u5757\n   $g(x)=1+x+x^2+...+x^5=\\frac{1-x^6}{1-x}$\n4. \u706b\u795e\u77f3\u7684\u5757\u6570\u5fc5\u987b\u662f4\u7684\u500d\u6570\n   $g(x)=1+x^4+x^8+...=\\frac 1{1-x^4}$\n5. \u571f\u795e\u77f3\u6700\u591a\u75287\u5757\n   $g(x)=1+x+x^2+...+x^7=\\frac{1-x^8}{1-x}$\n\n6. \u91d1\u795e\u77f3\u7684\u5757\u6570\u5fc5\u987b\u662f2\u7684\u500d\u6570\n   $g(x)=1+x^2+x^4+...=\\frac 1{1-x^2}$\n7. \u6728\u795e\u77f3\u6700\u591a\u75281\u5757\n   $g(x)=1+x=\\frac{1-x^2}{1-x}$\n8. \u6c34\u795e\u77f3\u7684\u5757\u6570\u5fc5\u987b\u662f8\u7684\u500d\u6570\n   $g(x)=1+x^8+x^{16}+...=\\frac 1{1-x^8}$\n9. \u706b\u795e\u77f3\u7684\u5757\u6570\u5fc5\u987b\u662f10\u7684\u500d\u6570\n   $g(x)=1+x^{10}+x^{20}+...=\\frac 1{1-x^{10}}$\n10. \u571f\u795e\u77f3\u6700\u591a\u75283\u5757\n    $g(x)=1+x+x^2+x^3=\\frac{1-x^4}{1-x}$\n\n$\\frac 1{1-x^6}\\cdot\\frac{1-x^{10}}{1-x}\\cdot\\frac{1-x^6}{1-x}\\cdot\\frac 1{1-x^4}\\cdot\\frac{1-x^8}{1-x}\\cdot\\frac 1{1-x^2}\\cdot\\frac{1-x^2}{1-x}\\cdot\\frac 1{1-x^8}\\cdot\\frac 1{1-x^{10}}\\cdot\\frac{1-x^4}{1-x}$\n\n$=\\frac1{(1-x)^5}$\n\n$=\\sum_{i=0}^\\infty {i+4 \\choose 4}x^i$\n\n> $\\sum_{i=0}^\\infty {i+k-1 \\choose k-1}x^i=\\frac1{(1-x)^k}$\n\n\u7b2c$n$\u9879\u7684\u7cfb\u6570\u662f${n+4 \\choose 4}$\u9700\u8981FFT\u6216NTT\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=4000011,P=998244353,G=3,Gi=332748118;\nchar ch[N];\nint n,limit=1,r[N],l=0;\nint  n1[N],n2[N],n3[N],n4[N],ans[N];\nint pw(int x,int p){\n    int ans=1;\n    for(;p;p>>=1,x=1ll*x*x%P)\n        if(p&1)ans=1ll*ans*x%P;\n    return ans;\n}\nil void ntt(int *A,int typ){\n    Fur(i,0,limit-1)\n        if(i<r[i])SWAP(A[i],A[r[i]]);\n    for(int len=1;len<limit;len<<=1){\n        int Wn=pw(~typ?G:Gi,(P-1)/(len<<1));\n        for(int i=0;i<limit;i+=(len<<1)){\n            int w=1;\n            Fur(k,0,len-1){\n                int t=1ll*w*A[i+k+len]%P;\n                A[i+k+len]=(A[i+k]-t+P)%P;\n                A[i+k]=(A[i+k]+t)%P;\n                w=1ll*w*Wn%P;\n            }\n        }\n    }\n    if(~typ)return;\n    int inv=pw(limit,P-2);\n    Fur(i,0,limit-1)A[i]=1ll*A[i]*inv%P;\n}\nil void mul(int *A,int *B){\n    ntt(A,1);ntt(B,1);\n    Fur(i,0,limit-1)A[i]=1ll*A[i]*B[i]%P;\n    ntt(A,-1);\n}\nint main(){\n    in(ch);\n    n=strlen(ch);\n    while(limit<=n*4)++l,limit<<=1;\n    Fur(i,0,limit-1)\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n    Fur(i,0,n-1)n1[i]=n2[i]=n3[i]=n4[i]=ch[n-i-1]-48;\n    ++n1[0];\n    n2[0]+=2;\n    n3[0]+=3;\n    n4[0]+=4;\n    mul(n1,n2);\n    mul(n1,n3);\n    mul(n1,n4);\n    ll x=0;\n    Fdr(i,n-1,0)\n        x=x*10+n1[i],ans[i]=x/24,x%=24;\n    int len=n;\n    Fur(i,0,n-1)ans[i+1]+=ans[i]/10,ans[i]%=10;\n    while(ans[len]>9)ans[len+1]+=ans[len]/10,ans[len]%=10,++len;\n    Fdr(i,len,0)out(ans[i]);\n    flush();\n}\n```\n", "link": "/posts/LG 2000 \u62ef\u6551\u4e16\u754c/", "tags": ["\u751f\u6210\u51fd\u6570", "\u6570\u8bba", "ntt", "\u9ad8\u7cbe\u5ea6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF622F The-Sum-of-the-k-th-Powers", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF622F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF622F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011,P=1e9+7;\nint n,k,fac[N],pl[N],pr[N];\nil int pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%P;\n        x=1ll*x*x%P;p>>=1;\n    }\n    return ans;\n}\nint main(){\n    in(n,k);\n    fac[0]=pl[0]=pr[k+3]=1;\n    Fur(i,1,k+2)\n        fac[i]=1ll*fac[i-1]*i%P,\n        pl[i]=1ll*pl[i-1]*(n-i)%P;\n    Fdr(i,k+2,1)\n        pr[i]=1ll*pr[i+1]*(n-i)%P;\n    int ans=0,y=0;\n    Fur(i,1,k+2){\n        y=(y+pw(i,k))%P;\n        int a=1ll*pl[i-1]*pr[i+1]%P,\n            b=fac[i-1]*((k-i)&1?-1ll:1ll)*fac[k-i+2]%P;\n        ans=(ans+1ll*y*a%P*pw(b,P-2)%P)%P;\n    }\n    printf(\"%d\\n\",(ans+P)%P);\n}\n```\n", "link": "/posts/LG CF622F The-Sum-of-the-k-th-Powers/", "tags": ["\u6570\u8bba", "\u591a\u9879\u5f0f", "\u62c9\u683c\u6717\u65e5\u63d2\u503c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4781 \u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4781&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4781\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=2011,P=998244353;\nint n,k,x[N],y[N];\nint pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%P;\n        x=1ll*x*x%P;p>>=1;\n    }\n    return ans;\n}\nint main(){\n    in(n,k);\n    Fur(i,1,n)in(x[i],y[i]);\n    int ans=0;\n    Fur(i,1,n){\n        int s=1,inv=1;\n        Fur(j,1,n)if(j!=i)\n            s=1ll*s*(k-x[j]+P)%P,\n            inv=1ll*inv*(x[i]-x[j]+P)%P;\n        ans=(ans+1ll*y[i]*s%P*pw(inv,P-2)%P)%P;\n    }\n    printf(\"%d\\n\",(ans+P)%P);\n}\n```\n", "link": "/posts/LG 4781 \u3010\u6a21\u677f\u3011\u62c9\u683c\u6717\u65e5\u63d2\u503c/", "tags": ["\u62c9\u683c\u6717\u65e5\u63d2\u503c", "\u6a21\u677f", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3803 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3803&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3803\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## FFT \n\n~~fst fst tle~~\n\n> DFT: \u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\n> \n> IDFT: \u79bb\u6563\u5085\u91cc\u53f6\u9006\u53d8\u6362\n> \n> FFT: \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\n> \n> FNTT/NTT: \u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u7684\u4f18\u5316\u7248\n> \n> FWT: \u5feb\u901f\u6c83\u5c14\u4ec0\u53d8\u6362,\u5229\u7528\u7c7b\u4f3cFFT\u7684\u4e1c\u897f\u89e3\u51b3\u4e00\u7c7b\u5377\u79ef\u95ee\u9898\n> \n> MTT: \u6bdb\u7237\u7237\u7684FFT,\u975e\u5e38nb/\u4efb\u610f\u6a21\u6570\n> \n> FMT: \u5feb\u901f\u83ab\u6bd4\u4e4c\u65af\u53d8\u5316\n> \n> (\u6458\u81eahttps://www.cnblogs.com/zwfymqz/p/8244902.html)\n\n\u4e3a\u4ec0\u4e48\u8981\u7528\u5230FFT\u5462?\n\n\u4ee5\u9ad8\u7cbe\u5ea6\u4e58\u6cd5\u4e3e\u4e2a\u4f8b\u5b50: \n\n\u4f60\u73b0\u5728\u8981\u8ba1\u7b97$a\\times b,a,b>10^{1000000}$\n\n\u8bbe$len_a=n,len_b=m$\n\n\u5982\u679c\u7528\u666e\u901a\u7684\u9ad8\u7cbe\u5ea6\u4e58\u6cd5$\\mathcal{O(nm)}$,\u76f4\u63a5tle\n\n\u4f46\u662fFFT\u53ef\u4ee5\u505a\u5230$\\mathcal{O((n+m) \\log (n+m))}$\n\n\u539f\u7406: \u5148\u628a\u591a\u9879\u5f0f\u8f6c\u5316\u4e3a\u7528\u70b9\u503c\u8868\u793a$\\mathcal{O(n \\log n)}$\n\n\u7136\u540e\u518d\u7528\u70b9\u503c\u76f8\u4e58\u6765\u8ba1\u7b97$\\mathcal{O(n)}$\n\n\u7136\u540e\u518d\u901a\u8fc7\u70b9\u503c\u8fd8\u539f\u591a\u9879\u5f0f\n\n\n\u4e0b\u9762\u662f\u524d\u7f6e\u77e5\u8bc6: \n\n## \u591a\u9879\u5f0f\n\n### \u7cfb\u6570\u8868\u793a\u6cd5\n\n\u5f62\u5f0f: $f(x)=\\sum_{i=0}^{n-1} a_ix^i$\n\n\u6bd4\u5982$123456$\u4e5f\u53ef\u4ee5\u770b\u505a\u4e00\u4e2a\u591a\u9879\u5f0f: \n\n$f(10)=6+5\\cdot10+4\\cdot10^2+3\\cdot10^3+2\\cdot 10^4+1\\cdot 10^5$\n\n### \u70b9\u503c\u8868\u793a\u6cd5\n\n\u53d6$n$\u4e2a\u70b9$x_1,x_2, \\dots ,x_n$\n\n\u4ee3\u5165$f(x)$\u4f1a\u5f97\u5230$n$\u4e2a\u4e0d\u540c\u7684$y_i$\n\n$f(x)$\u88ab$(x_1,y_1),(x_2,y_2),\\dots (x_n,y_n)$\u552f\u4e00\u786e\u5b9a\n\n\u5b9a\u7406:\n\n> \u4e00\u4e2a $n-1$ \u6b21\u591a\u9879\u5f0f\u5728 $n$ \u4e2a\u4e0d\u540c\u70b9\u7684\u53d6\u503c\u552f\u4e00\u786e\u5b9a\u4e86\u8be5\u591a\u9879\u5f0f\u3002\n\n\u8bc1\u660e: (\u53cd\u8bc1\u6cd5)\n\n> \u5047\u8bbe\u547d\u9898\u4e0d\u6210\u7acb,\u90a3\u4e48\u5b58\u5728\u4e24\u4e2a\u4e0d\u540c\u7684$n-1$\u6b21\u591a\u9879\u5f0f$A(x),B(x)$\u6ee1\u8db3: $\\forall i\\in[1,n], A(x_i)=B(x_i)$\n> \n> \u4ee4$C(x)=A(x)-B(x)$,\u90a3\u4e48$C(x)$\u4e5f\u662f\u4e00\u4e2a$n-1$\u6b21\u591a\u9879\u5f0f,\u4e14$\\forall i\\in[1,n], C(x_i)=0$\n> \n> \u8fd9\u6837\u7684\u8bdd$C(x)$\u6709$n$\u4e2a\u6839,\u4e0e\u4ee3\u6570\u57fa\u672c\u5b9a\u7406($n$\u6b21\u591a\u9879\u5f0f\u6709\u4e14\u4ec5\u6709$n$\u4e2a\u6839)\u4e0d\u7b26,\u6240\u4ee5$C(x)$\u4e0d\u662f$n-1$\u6b21\u591a\u9879\u5f0f\n>\n> \u6240\u4ee5\u539f\u547d\u9898\u6210\u7acb\n> \n> (\u6458\u81eahttps://zhuanlan.zhihu.com/p/31584464)\n\n## \u590d\u6570\n\n\u590d\u6570\u7531\u5b9e\u90e8(real)\u548c\u865a\u90e8(image)\u7ec4\u6210,\u5f62\u5982$a+bi$\n\n$i$\u662f\u865a\u6811\u5355\u4f4d,$i^2=-1,i=\\sqrt{-1}$\n\n### \u590d\u6570\u8fd0\u7b97\u6cd5\u5219:\n\n$(a+bi)+(c+di)=(a+c)+(b+d)i$\n\n$(a+bi)-(c+di)=(a-c)+(b-d)i$\n\n$(a+bi)\\cdot(c+di)=(ac-bd)+(ad+bc)i$\n\n\u590d\u6570$z=a+bi$\u5728\u590d\u5e73\u9762\u4e2d\u5bf9\u5e94\u5750\u6807\u4e3a$(a,b)$\n\n\u590d\u5e73\u9762\u4e2d$x$\u8f74\u53c8\u79f0\u5b9e\u8f74,$y$\u8f74\u53c8\u79f0\u865a\u8f74\n\n### \u5171\u8f6d\u590d\u6570\n\n\u590d\u6570$z=a+bi$\u7684\u5171\u8f6d\u590d\u6570$z'=a-bi$,$z'$\u79f0\u4e3a$z$\u7684\u590d\u5171\u8f6d\n\n\u6027\u8d28: \n\n$z\\cdot z' = a^2 + b^2$\n\n$|z|=|z'|$(\u6a21\u957f\u76f8\u7b49,\u5230\u539f\u70b9\u7684\u8ddd\u79bb\u76f8\u7b49)\n\n\n## \u5355\u4f4d\u6839\n\n\u82e5$\\omega^n=1$\u5219$\\omega$\u4e3a$n$\u6b21\u5355\u4f4d\u6839\n\n\u5728\u590d\u5e73\u9762\u4e0a,\u4ee5\u539f\u70b9\u4e3a\u5706\u5fc3,$1$\u4e3a\u534a\u5f84\u4f5c\u5706,\u6240\u5f97\u7684\u5706\u53eb\u5355\u4f4d\u5706\u3002\n\n\u4ee5\u5706\u5fc3\u4e3a\u8d77\u70b9,\u5706\u7684$n$\u7b49\u5206\u70b9\u4e3a\u7ec8\u70b9,\u505a$n$\u4e2a\u5411\u91cf\u3002\n\n\u5176\u4e2d\u5e45\u89d2\u4e3a\u6b63\u4e14\u6700\u5c0f\u7684\u5411\u91cf\u79f0\u4e3a$n$\u6b21\u5355\u4f4d\u5411\u91cf,\u8bb0\u4e3a$\\omega_n^1$\n\n\u6839\u636e\u590d\u6570\u4e58\u6cd5\u7684\u8fd0\u7b97\u6cd5\u5219,\u5176\u4f59$n\u22121$\u4e2a\u590d\u6570\u4e3a$\\omega_n^2,\\omega_n^3,\\dots,\\omega_n^n$\n\n$\\omega_n^0=\\omega_n^n=1$,\u5728\u590d\u5e73\u9762\u4e0a\u5bf9\u5e94\u7684\u70b9\u4e3a$(1,0)$\n\n<html>\n<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"584\" height=\"294\"><defs><clipPath id=\"HfoVspciGtkQ\"><path fill=\"none\" stroke=\"none\" d=\" M 0 0 L 584 0 L 584 294 L 0 294 L 0 0 Z\"/></clipPath></defs><g transform=\"scale(1,1)\" clip-path=\"url(#HfoVspciGtkQ)\"><g><rect fill=\"rgb(255,255,255)\" stroke=\"none\" x=\"0\" y=\"0\" width=\"584\" height=\"294\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(192,192,192)\" paint-order=\"fill stroke markers\" d=\" M 34.5 0.5 L 34.5 294.5 M 34.5 0.5 L 34.5 294.5 M 100.5 0.5 L 100.5 294.5 M 167.5 0.5 L 167.5 294.5 M 300.5 0.5 L 300.5 294.5 M 367.5 0.5 L 367.5 294.5 M 433.5 0.5 L 433.5 294.5 M 500.5 0.5 L 500.5 294.5 M 567.5 0.5 L 567.5 294.5\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(192,192,192)\" paint-order=\"fill stroke markers\" d=\" M 7.5 0.5 L 7.5 294.5 M 20.5 0.5 L 20.5 294.5 M 47.5 0.5 L 47.5 294.5 M 60.5 0.5 L 60.5 294.5 M 74.5 0.5 L 74.5 294.5 M 87.5 0.5 L 87.5 294.5 M 114.5 0.5 L 114.5 294.5 M 127.5 0.5 L 127.5 294.5 M 140.5 0.5 L 140.5 294.5 M 154.5 0.5 L 154.5 294.5 M 180.5 0.5 L 180.5 294.5 M 194.5 0.5 L 194.5 294.5 M 207.5 0.5 L 207.5 294.5 M 220.5 0.5 L 220.5 294.5 M 247.5 0.5 L 247.5 294.5 M 260.5 0.5 L 260.5 294.5 M 273.5 0.5 L 273.5 294.5 M 287.5 0.5 L 287.5 294.5 M 313.5 0.5 L 313.5 294.5 M 327.5 0.5 L 327.5 294.5 M 340.5 0.5 L 340.5 294.5 M 353.5 0.5 L 353.5 294.5 M 380.5 0.5 L 380.5 294.5 M 393.5 0.5 L 393.5 294.5 M 407.5 0.5 L 407.5 294.5 M 420.5 0.5 L 420.5 294.5 M 447.5 0.5 L 447.5 294.5 M 460.5 0.5 L 460.5 294.5 M 473.5 0.5 L 473.5 294.5 M 487.5 0.5 L 487.5 294.5 M 513.5 0.5 L 513.5 294.5 M 527.5 0.5 L 527.5 294.5 M 540.5 0.5 L 540.5 294.5 M 553.5 0.5 L 553.5 294.5 M 580.5 0.5 L 580.5 294.5\" stroke-opacity=\"0.23529411764705882\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(192,192,192)\" paint-order=\"fill stroke markers\" d=\" M 0.5 16.5 L 584.5 16.5 M 0.5 16.5 L 584.5 16.5 M 0.5 82.5 L 584.5 82.5 M 0.5 216.5 L 584.5 216.5 M 0.5 282.5 L 584.5 282.5\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(192,192,192)\" paint-order=\"fill stroke markers\" d=\" M 0.5 2.5 L 584.5 2.5 M 0.5 2.5 L 584.5 2.5 M 0.5 29.5 L 584.5 29.5 M 0.5 42.5 L 584.5 42.5 M 0.5 56.5 L 584.5 56.5 M 0.5 69.5 L 584.5 69.5 M 0.5 96.5 L 584.5 96.5 M 0.5 109.5 L 584.5 109.5 M 0.5 122.5 L 584.5 122.5 M 0.5 136.5 L 584.5 136.5 M 0.5 162.5 L 584.5 162.5 M 0.5 176.5 L 584.5 176.5 M 0.5 189.5 L 584.5 189.5 M 0.5 202.5 L 584.5 202.5 M 0.5 229.5 L 584.5 229.5 M 0.5 242.5 L 584.5 242.5 M 0.5 256.5 L 584.5 256.5 M 0.5 269.5 L 584.5 269.5\" stroke-opacity=\"0.23529411764705882\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 233.5 2.5 L 233.5 294.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 233.5 1.5 L 229.5 5.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 233.5 1.5 L 237.5 5.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 0.5 149.5 L 582.5 149.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 583.5 149.5 L 579.5 145.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 583.5 149.5 L 579.5 153.5\" stroke-opacity=\"1\" stroke-miterlimit=\"10\"/><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"23\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"23\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u20131.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"23\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"95\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"95\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u20131</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"95\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"156\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20130.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"156\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u20130.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"156\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20130.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"292\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"292\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">0.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"292\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"365\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"365\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">1</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"365\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"425\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"425\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">1.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"425\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"498\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">2</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"498\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">2</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"498\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">2</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"559\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">2.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"559\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">2.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"559\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">2.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"212\" y=\"287\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"212\" y=\"287\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u20131</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"212\" y=\"287\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20131</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"197\" y=\"221\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20130.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"197\" y=\"221\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u20130.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"197\" y=\"221\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u20130.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"204\" y=\"87\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0.5</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"204\" y=\"87\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">0.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"204\" y=\"87\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0.5</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"21\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"21\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">1</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"21\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">1</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">0</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"12px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"219\" y=\"165\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">0</text><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 367.23252568911755 149.44244871325463 C 367.23252568911755 223.03584163929233 307.5732931378362 282.695074190574 233.97990021179882 282.695074190574 C 160.38650728576147 282.695074190574 100.72727473448012 223.03584163929233 100.72727473448012 149.44244871325463 C 100.72727473448012 75.84905578721691 160.38650728576147 16.18982323593528 233.97990021179882 16.18982323593528 C 307.5732931378362 16.18982323593528 367.23252568911755 75.84905578721691 367.23252568911755 149.44244871325463 Z\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(0,0,0)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 263.97990021179885 149.44244871325463 C 263.97990021179885 141.48595401806827 260.8191950008363 133.8553366310992 255.19310364739525 128.2292452776581 L 233.97990021179882 149.44244871325463 Z\" fill-opacity=\"0.09803921568627451\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 263.97990021179885 149.44244871325463 C 263.97990021179885 141.48595401806827 260.8191950008363 133.8553366310992 255.19310364739525 128.2292452776581 L 233.97990021179882 149.44244871325463 Z\" stroke-opacity=\"0.6\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2\"/><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"247\" y=\"147\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u03b8</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"247\" y=\"147\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u03b8</text><text fill=\"rgb(0,0,0)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"247\" y=\"147\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u03b8</text><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 316.1829200175509 67.23942890750214\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 328.2037352977222 55.21861362733081 L 319.1881238375937 70.24463272754497 L 313.17771619750806 64.23422508745932 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 151.77688040604676 231.64546851900712\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 139.75606512587547 243.66628379917847 L 148.77167658600393 228.6402646989643 L 154.78208422608958 234.65067233904995 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 151.77688040604676 67.23942890750214\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 139.75606512587547 55.21861362733081 L 154.78208422608958 64.23422508745932 L 148.77167658600393 70.24463272754497 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 316.1829200175509 231.64546851900712\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 328.2037352977222 243.66628379917847 L 313.17771619750806 234.65067233904995 L 319.1881238375937 228.6402646989643 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 350.23252568911755 149.44244871325463\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 367.23252568911755 149.44244871325463 L 350.23252568911755 153.69244871325463 L 350.23252568911755 145.19244871325463 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 117.72727473448012 149.44244871325463\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 100.72727473448012 149.44244871325463 L 117.72727473448012 145.19244871325463 L 117.72727473448012 153.69244871325463 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 233.97990021179882 265.695074190574\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 233.97990021179882 282.695074190574 L 229.72990021179882 265.695074190574 L 238.22990021179882 265.695074190574 Z\" fill-opacity=\"0.8\"/><path fill=\"none\" stroke=\"rgb(97,97,97)\" paint-order=\"fill stroke markers\" d=\" M 233.97990021179882 149.44244871325463 L 233.97990021179882 33.18982323593528\" stroke-opacity=\"0.8\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\" stroke-width=\"2.5\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" fill-rule=\"evenodd\" d=\" M 233.97990021179882 16.18982323593528 L 238.22990021179882 33.18982323593528 L 229.72990021179882 33.18982323593528 Z\" fill-opacity=\"0.8\"/><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 237.97990021179882 149.44244871325463 C 237.97990021179882 151.6515877125778 236.189039211122 153.44244871325463 233.97990021179882 153.44244871325463 C 231.77076121247563 153.44244871325463 229.97990021179882 151.6515877125778 229.97990021179882 149.44244871325463 C 229.97990021179882 147.23330971393145 231.77076121247563 145.44244871325463 233.97990021179882 145.44244871325463 C 236.189039211122 145.44244871325463 237.97990021179882 147.23330971393145 237.97990021179882 149.44244871325463 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 237.97990021179882 149.44244871325463 C 237.97990021179882 151.6515877125778 236.189039211122 153.44244871325463 233.97990021179882 153.44244871325463 C 231.77076121247563 153.44244871325463 229.97990021179882 151.6515877125778 229.97990021179882 149.44244871325463 C 229.97990021179882 147.23330971393145 231.77076121247563 145.44244871325463 233.97990021179882 145.44244871325463 C 236.189039211122 145.44244871325463 237.97990021179882 147.23330971393145 237.97990021179882 149.44244871325463 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">O</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">O</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">O</text><path fill=\"rgb(21,101,192)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 372.23252568911755 149.44244871325463 C 372.23252568911755 152.2038724624086 369.9939494382715 154.44244871325463 367.23252568911755 154.44244871325463 C 364.4711019399636 154.44244871325463 362.23252568911755 152.2038724624086 362.23252568911755 149.44244871325463 C 362.23252568911755 146.68102496410066 364.4711019399636 144.44244871325463 367.23252568911755 144.44244871325463 C 369.9939494382715 144.44244871325463 372.23252568911755 146.68102496410066 372.23252568911755 149.44244871325463 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 372.23252568911755 149.44244871325463 C 372.23252568911755 152.2038724624086 369.9939494382715 154.44244871325463 367.23252568911755 154.44244871325463 C 364.4711019399636 154.44244871325463 362.23252568911755 152.2038724624086 362.23252568911755 149.44244871325463 C 362.23252568911755 146.68102496410066 364.4711019399636 144.44244871325463 367.23252568911755 144.44244871325463 C 369.9939494382715 144.44244871325463 372.23252568911755 146.68102496410066 372.23252568911755 149.44244871325463 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><path fill=\"rgb(21,101,192)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 333.2037352977222 55.21861362733081 C 333.2037352977222 57.98003737648477 330.9651590468761 60.21861362733081 328.2037352977222 60.21861362733081 C 325.4423115485682 60.21861362733081 323.2037352977222 57.98003737648477 323.2037352977222 55.21861362733081 C 323.2037352977222 52.45718987817684 325.4423115485682 50.21861362733081 328.2037352977222 50.21861362733081 C 330.9651590468761 50.21861362733081 333.2037352977222 52.45718987817684 333.2037352977222 55.21861362733081 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 333.2037352977222 55.21861362733081 C 333.2037352977222 57.98003737648477 330.9651590468761 60.21861362733081 328.2037352977222 60.21861362733081 C 325.4423115485682 60.21861362733081 323.2037352977222 57.98003737648477 323.2037352977222 55.21861362733081 C 323.2037352977222 52.45718987817684 325.4423115485682 50.21861362733081 328.2037352977222 50.21861362733081 C 330.9651590468761 50.21861362733081 333.2037352977222 52.45718987817684 333.2037352977222 55.21861362733081 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u03c9</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">\u03c9</text><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">\u03c9</text><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"14px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"346\" y=\"52\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">8</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"14px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"346\" y=\"52\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">8</text><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"14px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"346\" y=\"52\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">8</text><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"354\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">(cos \u03b8, i sin \u03b8)</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"354\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">(cos \u03b8, i sin \u03b8)</text><text fill=\"rgb(21,101,192)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"354\" y=\"45\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">(cos \u03b8, sin \u03b8)</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 143.75606512587547 243.66628379917847 C 143.75606512587547 245.87542279850163 141.96520412519862 247.66628379917847 139.75606512587547 247.66628379917847 C 137.54692612655228 247.66628379917847 135.75606512587547 245.87542279850163 135.75606512587547 243.66628379917847 C 135.75606512587547 241.45714479985529 137.54692612655228 239.66628379917847 139.75606512587547 239.66628379917847 C 141.96520412519862 239.66628379917847 143.75606512587547 241.45714479985529 143.75606512587547 243.66628379917847 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 143.75606512587547 243.66628379917847 C 143.75606512587547 245.87542279850163 141.96520412519862 247.66628379917847 139.75606512587547 247.66628379917847 C 137.54692612655228 247.66628379917847 135.75606512587547 245.87542279850163 135.75606512587547 243.66628379917847 C 135.75606512587547 241.45714479985529 137.54692612655228 239.66628379917847 139.75606512587547 239.66628379917847 C 141.96520412519862 239.66628379917847 143.75606512587547 241.45714479985529 143.75606512587547 243.66628379917847 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">C</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">C</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">C</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 143.75606512587547 55.21861362733081 C 143.75606512587547 57.427752626653984 141.96520412519862 59.21861362733081 139.75606512587547 59.21861362733081 C 137.54692612655228 59.21861362733081 135.75606512587547 57.427752626653984 135.75606512587547 55.21861362733081 C 135.75606512587547 53.00947462800764 137.54692612655228 51.21861362733081 139.75606512587547 51.21861362733081 C 141.96520412519862 51.21861362733081 143.75606512587547 53.00947462800764 143.75606512587547 55.21861362733081 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 143.75606512587547 55.21861362733081 C 143.75606512587547 57.427752626653984 141.96520412519862 59.21861362733081 139.75606512587547 59.21861362733081 C 137.54692612655228 59.21861362733081 135.75606512587547 57.427752626653984 135.75606512587547 55.21861362733081 C 135.75606512587547 53.00947462800764 137.54692612655228 51.21861362733081 139.75606512587547 51.21861362733081 C 141.96520412519862 51.21861362733081 143.75606512587547 53.00947462800764 143.75606512587547 55.21861362733081 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"47\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">B</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"47\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">B</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"144\" y=\"47\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">B</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 332.2037352977222 243.66628379917847 C 332.2037352977222 245.87542279850163 330.41287429704533 247.66628379917847 328.2037352977222 247.66628379917847 C 325.994596298399 247.66628379917847 324.2037352977222 245.87542279850163 324.2037352977222 243.66628379917847 C 324.2037352977222 241.45714479985529 325.994596298399 239.66628379917847 328.2037352977222 239.66628379917847 C 330.41287429704533 239.66628379917847 332.2037352977222 241.45714479985529 332.2037352977222 243.66628379917847 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 332.2037352977222 243.66628379917847 C 332.2037352977222 245.87542279850163 330.41287429704533 247.66628379917847 328.2037352977222 247.66628379917847 C 325.994596298399 247.66628379917847 324.2037352977222 245.87542279850163 324.2037352977222 243.66628379917847 C 324.2037352977222 241.45714479985529 325.994596298399 239.66628379917847 328.2037352977222 239.66628379917847 C 330.41287429704533 239.66628379917847 332.2037352977222 241.45714479985529 332.2037352977222 243.66628379917847 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">D</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">D</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"332\" y=\"236\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">D</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 104.72727473448012 149.44244871325463 C 104.72727473448012 151.6515877125778 102.93641373380329 153.44244871325463 100.72727473448012 153.44244871325463 C 98.51813573515695 153.44244871325463 96.72727473448012 151.6515877125778 96.72727473448012 149.44244871325463 C 96.72727473448012 147.23330971393145 98.51813573515695 145.44244871325463 100.72727473448012 145.44244871325463 C 102.93641373380329 145.44244871325463 104.72727473448012 147.23330971393145 104.72727473448012 149.44244871325463 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 104.72727473448012 149.44244871325463 C 104.72727473448012 151.6515877125778 102.93641373380329 153.44244871325463 100.72727473448012 153.44244871325463 C 98.51813573515695 153.44244871325463 96.72727473448012 151.6515877125778 96.72727473448012 149.44244871325463 C 96.72727473448012 147.23330971393145 98.51813573515695 145.44244871325463 100.72727473448012 145.44244871325463 C 102.93641373380329 145.44244871325463 104.72727473448012 147.23330971393145 104.72727473448012 149.44244871325463 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"105\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">E</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"105\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">E</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"105\" y=\"141\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">E</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 237.97990021179882 282.695074190574 C 237.97990021179882 284.9042131898972 236.189039211122 286.695074190574 233.97990021179882 286.695074190574 C 231.77076121247563 286.695074190574 229.97990021179882 284.9042131898972 229.97990021179882 282.695074190574 C 229.97990021179882 280.48593519125086 231.77076121247563 278.695074190574 233.97990021179882 278.695074190574 C 236.189039211122 278.695074190574 237.97990021179882 280.48593519125086 237.97990021179882 282.695074190574 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 237.97990021179882 282.695074190574 C 237.97990021179882 284.9042131898972 236.189039211122 286.695074190574 233.97990021179882 286.695074190574 C 231.77076121247563 286.695074190574 229.97990021179882 284.9042131898972 229.97990021179882 282.695074190574 C 229.97990021179882 280.48593519125086 231.77076121247563 278.695074190574 233.97990021179882 278.695074190574 C 236.189039211122 278.695074190574 237.97990021179882 280.48593519125086 237.97990021179882 282.695074190574 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"275\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">F</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"275\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">F</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"275\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">F</text><path fill=\"rgb(97,97,97)\" stroke=\"none\" paint-order=\"stroke fill markers\" d=\" M 237.97990021179882 16.18982323593528 C 237.97990021179882 18.398962235258452 236.189039211122 20.18982323593528 233.97990021179882 20.18982323593528 C 231.77076121247563 20.18982323593528 229.97990021179882 18.398962235258452 229.97990021179882 16.18982323593528 C 229.97990021179882 13.980684236612106 231.77076121247563 12.189823235935279 233.97990021179882 12.189823235935279 C 236.189039211122 12.189823235935279 237.97990021179882 13.980684236612106 237.97990021179882 16.18982323593528 Z\" fill-opacity=\"1\"/><path fill=\"none\" stroke=\"rgb(0,0,0)\" paint-order=\"fill stroke markers\" d=\" M 237.97990021179882 16.18982323593528 C 237.97990021179882 18.398962235258452 236.189039211122 20.18982323593528 233.97990021179882 20.18982323593528 C 231.77076121247563 20.18982323593528 229.97990021179882 18.398962235258452 229.97990021179882 16.18982323593528 C 229.97990021179882 13.980684236612106 231.77076121247563 12.189823235935279 233.97990021179882 12.189823235935279 C 236.189039211122 12.189823235935279 237.97990021179882 13.980684236612106 237.97990021179882 16.18982323593528 Z\" stroke-opacity=\"1\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-miterlimit=\"10\"/><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"16\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">G</text><text fill=\"none\" stroke=\"rgb(255,255,255)\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"16\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" stroke-opacity=\"1\" stroke-linejoin=\"bevel\" stroke-miterlimit=\"10\" stroke-width=\"3\">G</text><text fill=\"rgb(97,97,97)\" stroke=\"none\" font-family=\"geogebra-sans-serif, sans-serif\" font-size=\"16px\" font-style=\"normal\" font-weight=\"normal\" text-decoration=\"normal\" x=\"238\" y=\"16\" text-anchor=\"start\" dominant-baseline=\"alphabetic\" fill-opacity=\"1\">G</text></g></g></svg>\n</html>\n\n\u5411\u91cf$\\overrightarrow{O\\omega_8}$\u8868\u793a\u7684\u590d\u6570\u5c31\u662f$8$\u6b21\u5355\u4f4d\u6839,$\\omega_8^1$\n\n> \u62d3\u5c55: \n> \n> \u6b27\u62c9\u516c\u5f0f: $e^{i\\theta}=\\cos\\theta + i \\sin \\theta$(\u5728\u590d\u5e73\u9762\u5185\u5750\u6807\u4e3a$(\\cos \\theta, \\sin \\theta)$)\n> \n> $\\omega_n^k=e^{i 2\\pi \\frac kn}$\n> (\u53ef\u4ee5\u7406\u89e3\u4e3a\u4ece$\\omega_n^0(1,0)$\u5f00\u59cb\u8d70\u957f\u5ea6\u4e3a$2\\pi \\frac kn$\u7684\u5706\u5f27\u540e\u5230\u8fbe\u7684\u4f4d\u7f6e)\n> \n> \u6b27\u62c9\u516c\u5f0f: $e^{i\\pi}=-1$(\u590d\u5e73\u9762\u4e2d\u7684$(-1,0)$)\n> \n> \u5173\u4e8e\u8bc1\u660e\u548c\u7406\u89e3,\u53ef\u4ee5\u53c2\u8003\u4e0b\u9762\u4e24\u4e2a\u89c6\u9891: \n> \n> https://www.bilibili.com/video/av63666593\n> \n> https://www.bilibili.com/video/av79134103\n\n\u6027\u8d28:\n\n$\\omega_n^k= \\cos 2\\pi\\frac kn+ i \\sin 2\\pi \\frac kn$\n\n$\\omega_{2n}^{2k}=\\omega_n^k$\n\n> $\\omega_{2n}^{2k}=\\cos 2\\pi\\frac {2k}{2n}+ i \\sin 2\\pi \\frac {2k}{2n}=\\cos 2\\pi\\frac kn+ i \\sin 2\\pi \\frac kn=\\omega_n^k$\n\n$\\omega_n^0=\\omega_n^n=1$\n\n$\\omega_n^{k+\\frac n2}=-\\omega_n^k$\n\n> $\\omega _{n}^{\\frac{n}{2}}=\\cos\\frac{n}{2}\\cdot\\frac{2\\pi}{n}+i\\sin\\frac{n}{2}\\cdot\\frac{2\\pi}{n}=-1$\n> (\u4e5f\u5c31\u662f\u4e0a\u9762\u8bf4\u7684$e^{i\\pi}$)\n\n\n\u6b63\u9898\u5f00\u59cb: \n\n## DFT \n\n\u5c06\u591a\u9879\u5f0f\u4ece\u7cfb\u6570\u8868\u793a\u6cd5\u8f6c\u6362\u4e3a\u70b9\u503c\u8868\u793a\u6cd5\n\n\u5982\u679c\u66b4\u529b\u4ee3\u5165$n$\u4e2a\u70b9,\u590d\u6742\u5ea6\u8fd8\u662f$\\mathcal{O(n^2)}$\u7684\n\n\u6211\u4eec\u53ef\u4ee5\u5229\u7528\u5355\u4f4d\u6839\u7684\u6027\u8d28\n\n\u5047\u8bbe\u8bbe$n$\u4e3a\u5076\u6570\n\n\u5bf9\u4e8e$A(x)=a_0+a_1x+a_2x^2+a_3x^3+\\dots+a_{n-1}x^{n-1}$\n\n$A(x)=(a_0+a_2x^2+a_4x^4+\\dots+a_{n-2}x^{n-2})+x(a_1+a_3x^2+a_5x^4+...+a_{n-1}x^{n-1})$\n\n\u8bbe$A_1(x)=a_0+a_2x+a_4x^2+\\dots+a_{n-2}x^\\frac{n-2}2,A_2(x)=a_1+a_3x+a_5x^2+...+a_{n-1}x^\\frac{n-2}2$\n\n\u90a3\u4e48$A(x)=A_1(x^2)+xA_2(x^2)$\n\n\u8bbe$0 \\le k \\le \\frac{n}{2}-1,k\\in Z$\n\n$A(\\omega_n^k)=A_1(\\omega_\\frac n2 ^k)+\\omega_n^k\\cdot A_2(\\omega_\\frac n2 ^k)$\n\n\u5bf9\u4e8e$\\frac n2 \\le k+\\frac n2 \\le n-1$\n\n$A(\\omega_n^{k+\\frac n2})=A_1(\\omega_n^{2k+n})+\\omega_n^{k+\\frac n2}\\cdot A_2(\\omega_n^{2k+n})$\n\n$\\because \\omega_n^{k+\\frac n2}=-\\omega_n^k,\\omega_n^{2k+n}=\\omega_\\frac n2^k$\n\n$\\therefore A(\\omega_n^{k+\\frac n2})=A_1(\\omega_\\frac n2^k)-\\omega_n^k\\cdot A_2(\\omega_\\frac n2^k)$\n\n\u5982\u679c\u5df2\u7ecf\u77e5\u9053$A_1,A_2$\u5206\u522b\u5728$\\omega_\\frac n2 ^{0,1,2,...,\\frac n2 -1}$\u7684\u53d6\u503c,\u90a3\u4e48\u5c31\u53ef\u4ee5\u5728$\\mathcal{O(n)}$\u7684\u65f6\u95f4\u5185\u8ba1\u7b97\u51fa$A(x)$,\u800c$A_1(x),A_2(x)$\u7684\u89c4\u6a21\u90fd\u662f$A(x)$\u7684\u4e00\u534a\n\n\u590d\u6742\u5ea6$\\mathcal{T(n)=2T(\\frac n2)+O(n) = O(n \\log n)}$\n\n## IDFT\n\n\u4f7f\u7528\u5feb\u901f\u5085\u91cc\u53f6\u53d8\u6362\u5c06\u70b9\u503c\u8868\u793a\u7684\u591a\u9879\u5f0f\u8f6c\u5316\u4e3a\u7cfb\u6570\u8868\u793a,\u8fd9\u4e2a\u8fc7\u7a0b\u53eb\u505a\u79bb\u6563\u5085\u91cc\u53f6\u9006\u53d8\u6362\n\n\u5373\u7531$n$\u7ef4\u70b9\u503c\u5411\u91cf$(A(x_0),A(x_1),\\dots,A(x_{n-1}))$\u63a8\u51fa$n$\u7ef4\u7cfb\u6570\u5411\u91cf$(a_0,a_1,\\dots,a_{n-1})$\u3002\n\n\u8bbe$y_0,y_1,y_2,...,y_{n-1}$\u662f\u591a\u9879\u5f0f$A(x)$\u53d8\u6362\u540e\u7684\u70b9\u503c\n\n\u8bbe$(d_0,d_1,\\dots,d_{n-1})$\u4e3a$(a_0,a_1,\\dots,a_{n-1})$\u79bb\u6563\u5085\u91cc\u53f6\u53d8\u6362\u540e\u7684\u7ed3\u679c\n\n\u6784\u9020$F(x)=d_0+d_1x+d_2x^2+\\dots+d_{n-1}x^{n-1}$\n\n\u8bbe\u5411\u91cf$(c_0,c_1,\\dots,c_{n-1})$\u4e2d\n\n$c_k$\u4e3a$F(x)$\u5728$x=\\omega_n^{-k}$\u65f6\u7684\u70b9\u503c\u8868\u793a\n\n$$\n\nc_k=\\sum_{i=0}^{n-1}d_i\\cdot(\\omega_n^{-k})^i\n\\\\\n=\\sum_{i=0}^{n-1}[\\sum_{j=0}^{n-1}a_j(\\omega_n^i)^j]\\cdot(\\omega_n^{-k})^i\n\\\\\n=\\sum_{j=0}^{n-1}a_j\\sum_{i=0}^{n-1}(\\omega_n^i)^j\\cdot(\\omega_n^{-k})^i\n\\\\\n=\\sum_{j=0}^{n-1}a_j\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}\n$$\n\n\u89c2\u5bdf$\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}$\n\n\u5f53$j=k$\u65f6$\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}=\\sum_{i=0}^{n-1}1=n$\n\n\u5f53$j\\not = k$\u65f6\n\n$\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}=$\n\n$\\sum_{i=0}^{\\frac{n-1}2}(\\omega_n^i)^{j-k}+(\\omega_n^{i+\\frac{n-1}2})^{j-k}=0$\n\n\u4e5f\u5c31\u662f$n$\u6b21\u5355\u4f4d\u6839\u4f1a\u4e92\u76f8\u62b5\u6d88\n\n$\\therefore \\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}=[j=k]\\cdot n$\n\n$\\therefore c_k=\\sum_{j=0}^{n-1}a_j\\sum_{i=0}^{n-1}(\\omega_n^i)^{j-k}=\\sum_{j=0}^{n-1}a_j [j=k]\\cdot n=na_k$\n\n$\\therefore a_k=\\frac{c_k}n$\n\n\u90a3\u4e48\u6211\u4eec\u8981\u5c06\u70b9\u503c\u8868\u793a\u7684\u591a\u9879\u5f0f\u8f6c\u5316\u4e3a\u7cfb\u6570\u8868\u793a:\n\n1. \u5c06$(\\omega_n^0,\\omega_n^{-1},\\omega_n^{-2},\\dots,w_n^{-(n-1)})$\u4f5c\u4e3a\u5dee\u503c\u8282\u70b9,\u5c06\u70b9\u503c\u518d\u505a\u4e00\u6b21DFT\n   \n   \u5f97\u5230$(c_0,c_1,c_2,\\dots,c_{n-1})$\n\n2. $(\\frac{c_0}n,\\frac{c_1}n,\\frac{c_2}n,\\dots,\\frac{c_{n-1}}n)$\u5c31\u662f\u539f\u6765\u7684$(a_0,a_1,a_2,\\dots,a_{n-1})$\n\n\n\u5230\u8fd9\u91cc\u6211\u4eec\u5c31\u5df2\u7ecf\u5927\u81f4\u61c2\u5f97FFT\u7684\u539f\u7406\u4e86,\u90a3\u8981\u600e\u4e48\u5b9e\u73b0\u5462?\n\n## \u5b9e\u73b0\n\n[LG 3803 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09](https://www.luogu.com.cn/problem/P3803)\n\n### \u666e\u901a\u7684\u9012\u5f52\u5199\u6cd5\n\n~~Fst_Fst_**TLE**~~\n\n\u4e0d\u65ad\u5bf9\u4e0b\u6807\u8fdb\u884c\u5947\u5076\u5206\u7c7b,\u5206\u6210\u4e24\u4e2a\u5b50\u5e8f\u5217\u4e4b\u540e\u518d\u4e0d\u65ad\u5408\u5e76\n\n\u9700\u8981\u8f85\u52a9\u6570\u7ec4,\u5bb9\u6613**TLE,MLE**\n\n### \u8fed\u4ee3\u5b9e\u73b0\n\n![](https://pic1.zhimg.com/80/v2-953d1cd6c91a84197775d504defe302c_hd.jpg)\n\n\u53ef\u4ee5\u53d1\u73b0\u5728\u4e0d\u65ad\u8fdb\u884c\u5947\u5076\u5206\u7c7b\u4e4b\u540e,\u539f\u6570\u5728\u6570\u7ec4\u4e2d\u7684\u4f4d\u7f6e\u4e0b\u6807\u6700\u7ec8\u53d8\u6210\u4e86**\u4e0b\u6807\u7684\u4e8c\u8fdb\u5236\u53cd\u8f6c**\n\n\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u901a\u8fc7\u679a\u4e3e\u6765\u4ee3\u66ff\u9012\u5f52\n\n\u4ece\u6700\u5e95\u5c42\u5f00\u59cb\u5411\u4e0a\u5408\u5e76,\u90a3\u4e48\u600e\u4e48\u5408\u5e76\u5462\uff1f\n\n#### \u8774\u8776\u64cd\u4f5c\n\n\u8bbe\u8be5\u5c42\u4e00\u5171\u6709$n$\u9879\u9700\u8981\u5904\u7406\n\n\u8bbe$A_1(\\omega_{\\frac n2}^k)$\u548c$A_2(\\omega_{\\frac n2}^k)$\u5206\u522b\u5b58\u653e\u5728$a_k$\u548c$a_{k+\\frac n2}$\n\n$A_1(\\omega_n^k)$\u548c$A_2(\\omega_n^k)$\u8981\u5b58\u653e\u5728$buf(k)$\u548c$buf(k+\\frac n2)$\n\n\u6211\u4eec\u53ea\u9700\u8bbe\u4e2d\u95f4\u53d8\u91cf$t=\\omega_n^k\\cdot a(k+\\frac n2)$\n\n$buf(k+\\frac n2)= a(k) - t$\n\n$buf(k) = a(k)+t$\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u6211\u4eec\u4e0d\u9700\u8981\u8f85\u52a9\u5b58\u653e\u7684\u6570\u7ec4$buf$\u4e86,\u76f4\u63a5\u5728\u539f\u5e8f\u5217\u64cd\u4f5c\u5373\u53ef\n\n\u4ee3\u7801: \n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define db double\n#define For(i,x,y) for(int i=x;i<=y;++i)\nconst int N=4000011;\nconst db Pi=acos(-1.0);\nint n,m,limit=1,l=0,r[N];\nstruct cp{db r,i;cp(db R=0,db I=0){r=R,i=I;}}a[N],b[N];\ncp operator + (cp a,cp b){return cp(a.r+b.r,a.i+b.i);}\ncp operator - (cp a,cp b){return cp(a.r-b.r,a.i-b.i);}\ncp operator * (cp a,cp b){return cp(a.r*b.r-a.i*b.i,a.r*b.i+a.i*b.r);}\nvoid fft(cp *A,int typ){\n    For(i,0,limit-1)\n        if(i<r[i])std::swap(A[i],A[r[i]]);\n    for(int len=1;len<limit;len<<=1){//\u5df2\u5904\u7406\u597d\u7684\u957f\u5ea6\u5757,\u4e5f\u5c31\u662fn/2\n        cp Wn(cos(Pi/len),typ*sin(Pi/len));//\u5355\u4f4d\u6839\n        for(int i=0;i<limit;i+=(len<<1)){\n            cp w(1,0);//w_n^0\n            For(k,0,len-1){//\u8774\u8776\u64cd\u4f5c\n                cp t=w*A[i+k+len];\n                A[i+k+len]=A[i+k]-t;\n                A[i+k]=A[i+k]+t;\n                w=w*Wn;\n            }\n        }\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    For(i,0,n)scanf(\"%lf\",&a[i].r);\n    For(i,0,m)scanf(\"%lf\",&b[i].r);\n    \n    while(limit<=n+m)limit<<=1,++l;\n    For(i,0,limit-1)//\u9884\u5904\u7406\u51fa\u4e0d\u65ad\u5947\u5076\u5206\u7c7b\u540e\u7684\u6700\u7ec8\u4f4d\u7f6e\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\n    fft(a,1);fft(b,1);//DFT\n    For(i,0,limit)a[i]=a[i]*b[i];//\u70b9\u503c\u76f8\u4e58\n    fft(a,-1);//IDFT\n    For(i,0,n+m)printf(\"%d \",int(a[i].r/limit+0.5));\n}\n```\n\n\n\u672c\u6587\u90e8\u5206\u5185\u5bb9\u6458\u81ea:(\u53c2\u8003\u8d44\u6599)\n\nhttps://zhuanlan.zhihu.com/p/31584464\n\nhttps://www.cnblogs.com/zwfymqz/p/8244902.html\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define db double\n#define For(i,x,y) for(int i=x;i<=y;++i)\nconst int N=4000011;\nconst db Pi=acos(-1.0);\nint n,m,limit=1,l=0,r[N];\nstruct cp{db r,i;cp(db R=0,db I=0){r=R,i=I;}}a[N],b[N];\ncp operator + (cp a,cp b){return cp(a.r+b.r,a.i+b.i);}\ncp operator - (cp a,cp b){return cp(a.r-b.r,a.i-b.i);}\ncp operator * (cp a,cp b){return cp(a.r*b.r-a.i*b.i,a.r*b.i+a.i*b.r);}\nvoid fft(cp *A,int typ){\n    For(i,0,limit-1)\n        if(i<r[i])std::swap(A[i],A[r[i]]);\n    for(int len=1;len<limit;len<<=1){\n        cp Wn(cos(Pi/len),typ*sin(Pi/len));\n        for(int i=0;i<limit;i+=(len<<1)){\n            cp w(1,0);\n            For(k,0,len-1){\n                cp t=w*A[i+k+len];\n                A[i+k+len]=A[i+k]-t;\n                A[i+k]=A[i+k]+t;\n                w=w*Wn;\n            }\n        }\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    For(i,0,n)scanf(\"%lf\",&a[i].r);\n    For(i,0,m)scanf(\"%lf\",&b[i].r);\n    \n    while(limit<=n+m)limit<<=1,++l;\n    For(i,0,limit-1)\n        r[i]=(r[i>>1]>>1)|((i&1)<<(l-1));\n\n    fft(a,1);fft(b,1);\n    For(i,0,limit)a[i]=a[i]*b[i];\n    fft(a,-1);\n    For(i,0,n+m)printf(\"%d \",int(a[i].r/limit+0.5));\n}\n```\n", "link": "/posts/LG 3803 \u3010\u6a21\u677f\u3011\u591a\u9879\u5f0f\u4e58\u6cd5\uff08FFT\uff09/", "tags": ["\u6a21\u677f", "\u6570\u8bba", "\u591a\u9879\u5f0f", "fft"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3966 [TJOI2013]\u5355\u8bcd", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3966&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3966\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011;\nint n,cnt=0,head[N];\nchar ch[N];\nstruct edge{int to,nxt;}e[N*26];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint tot=1,tr[N][26],f[N],ed[N],q[N*26],fail[N],val[N];\nvoid bld(){\n    int h=0,t=0,x;\n    Fur(i,0,25)\n    if(tr[1][i])fail[tr[1][i]]=1,q[t++]=tr[1][i];\n    else tr[1][i]=1;\n    while(h<t){\n        x=q[h++];\n        Fur(i,0,25)\n        if(tr[x][i])fail[tr[x][i]]=tr[fail[x]][i],q[t++]=tr[x][i];\n        else tr[x][i]=tr[fail[x]][i];\n    }\n    Fdr(i,t,1)val[fail[q[i]]]+=val[q[i]];\n}\nint main(){\n    in(n);\n    Fur(i,1,n){\n        in(ch);\n        int p=1,len=strlen(ch);\n        Fur(j,0,len-1){\n            char c=ch[j]-'a';\n            if(!tr[p][c])f[tr[p][c]=++tot]=p;\n            p=tr[p][c];\n            ++val[p];\n        }\n        ed[i]=p;\n    }\n    bld();\n    Fur(i,1,n)out(val[ed[i]],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3966 [TJOI2013]\u5355\u8bcd/", "tags": ["AC\u81ea\u52a8\u673a"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF547E Mike-and-Friends", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF547E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF547E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nAC\u81ea\u52a8\u673a\u5efa\u5b8cfail\u6811\u4e4b\u540e\u5b50\u6811\u7684siz\u5c31\u662f\u91cc\u9762\u76f8\u540c\u5b57\u7b26\u4e32\u7684\u4e2a\u6570\n\n\u6bcf\u4e2a\u8be2\u95ee\u53ef\u4ee5\u62c6\u6210$r$\u7684\u524d\u7f00\u548c-$l$\u7684\u524d\u7f00\u548c\n\n\u7136\u540e\u79bb\u7ebf\u5904\u7406\u540e\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u5c31\u53ef\u4ee5\u4e86\n\n\u4e3b\u5e2d\u6811\u5728\u7ebf\u4e5f\u53ef\u4ee5\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=200011,M=500011;\nint n,m,cnt=0,head[N],k[M],ans[M];\nchar ch[N];\nstruct edge{int to,nxt;}e[N*26];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint tot=1,tr[N][26],ed[N],f[N],fail[N],q[N*26];\nil void build(){\n    int h=0,t=0,x;\n    Fur(i,0,25)\n    if(tr[1][i])fail[tr[1][i]]=1,q[t++]=tr[1][i];\n    else tr[1][i]=1;\n\n    while(h<t){\n        x=q[h++];\n        Fur(i,0,25)\n        if(tr[x][i])fail[tr[x][i]]=tr[fail[x]][i],q[t++]=tr[x][i];\n        else tr[x][i]=tr[fail[x]][i];\n    }\n}\nint id[N],sz=0,siz[N];\nvoid dfs(int x){\n    id[x]=++sz;siz[x]=1;\n    fl(i,x)dfs(to),siz[x]+=siz[to];\n}\nint s[N];\nil void upd(int x){for(int i=x;i<=tot;i+=i&-i)++s[i];}\nil int ask(int x){int t=0;for(int i=x;i;i-=i&-i)t+=s[i];return t;}\nint main(){\n    in(n,m);\n    Fur(i,1,n){\n        in(ch);\n        int p=1,len=strlen(ch),c;\n        Fur(j,0,len-1){\n            c=ch[j]-'a';\n            if(!tr[p][c])f[tr[p][c]=++tot]=p;\n            p=tr[p][c];\n        }\n        ed[i]=p;\n    }\n\n    build();\n    Fur(i,2,tot)add(fail[i],i);\n    dfs(1);\n\n    clr(head,0);cnt=0;\n    int l,r,x;\n    Fur(i,1,m){\n        in(l,r,k[i]);\n        if(l>1)add(l-1,-i);\n        add(r,i);\n    }\n    Fur(i,1,n){\n        for(x=ed[i];x!=1;x=f[x])upd(id[x]);\n        fl(j,i){\n            int v=to>0?1:-1;\n            to*=v;x=ed[k[to]];\n            ans[to]+=v*(ask(id[x]+siz[x]-1)-ask(id[x]-1));\n        }\n    }\n    Fur(i,1,m)out(ans[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG CF547E Mike-and-Friends/", "tags": ["AC\u81ea\u52a8\u673a", "\u79bb\u7ebf", "\u6811\u72b6\u6570\u7ec4", "\u4e3b\u5e2d\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2455 [SDOI2006]\u7ebf\u6027\u65b9\u7a0b\u7ec4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2455&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2455\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define FOR(i,x,y) for(int i=x;i<=y;++i)\nint n;\ndouble a[111][111],eps=1e-8;\nbool cmp(int k,int x,int y){\n    if(abs(abs(a[x][k])-abs(a[y][k]))>eps)return abs(a[x][k])>abs(a[y][k]);\n    FOR(i,k+1,n)if(abs(abs(a[x][i])-abs(a[y][i]))>eps)return abs(a[x][i])>abs(a[y][i]);\n    return 0;\n}\nint main(){\n    scanf(\"%d\",&n);\n    FOR(i,1,n)FOR(j,1,n+1)scanf(\"%lf\",&a[i][j]);\n    int p=1;\n    FOR(i,1,n){\n        int mx=p;\n        FOR(j,p+1,n)if(abs(a[j][i])>abs(a[mx][i]))mx=j;\n        if(!a[mx][i])continue;\n        std::swap(a[p],a[mx]);\n        FOR(j,1,n)if(j!=p){\n            double t=a[j][i]/a[i][i];\n            FOR(k,i+1,n+1)\n                a[j][k]-=a[i][k]*t;\n        }\n    }\n    FOR(i,1,n)if(abs(a[i][i])<eps){\n        if(abs(a[i][n+1])<eps)return printf(\"0\\n\"),0;\n        else return printf(\"-1\\n\"),0;\n    }\n    FOR(i,1,n){\n        printf(\"x%d=\",i);\n        double t=a[i][n+1]/a[i][i];\n        if(abs(t)<eps)printf(\"0\\n\");\n        else printf(\"%.2f\\n\",t);\n    }\n}\n```\n", "link": "/posts/LG 2455 [SDOI2006]\u7ebf\u6027\u65b9\u7a0b\u7ec4/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3389 \u3010\u6a21\u677f\u3011\u9ad8\u65af\u6d88\u5143\u6cd5", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3389&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3389\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define FOR(i,x,y) for(int i=x;i<=y;++i)\nint n;\ndouble a[111][111];\nint main(){\n    scanf(\"%d\",&n);\n    FOR(i,1,n)FOR(j,1,n+1)scanf(\"%lf\",&a[i][j]);\n    FOR(i,1,n){\n        int mx=i;\n        FOR(j,i+1,n)if(abs(a[j][i])>abs(a[mx][i]))mx=j;\n        if(!a[mx][i])return printf(\"No Solution\\n\"),0;\n        std::swap(a[i],a[mx]);\n        FOR(j,1,n)if(j!=i){\n            double t=a[j][i]/a[i][i];\n            FOR(k,i+1,n+1)\n                a[j][k]-=a[i][k]*t;\n        }\n    }\n    FOR(i,1,n)printf(\"%.2f\\n\",a[i][n+1]/a[i][i]);\n}\n```\n", "link": "/posts/LG 3389 \u3010\u6a21\u677f\u3011\u9ad8\u65af\u6d88\u5143\u6cd5/", "tags": ["\u6a21\u677f", "\u9ad8\u65af\u6d88\u5143"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3320 [SDOI2015]\u5bfb\u5b9d\u6e38\u620f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3320&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3320\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u53d1\u73b0\u6309dfs\u5e8f\u6392\u5e8f\u540e\u8def\u5f84\u662f$a_1,a_2,a_3,...,a_k,a_1$\n\n\u90a3\u7b54\u6848\u5c31\u662f$dist(a_1,a_2)+dist(a_2,a_3)+...+dist(a_k,a_1)$\n\n\u8bbe\u73b0\u5728\u8981\u63d2\u5165$x$,$y,z$\u662f$x$\u7684\u524d\u9a71\u540e\u7ee7(dfs\u5e8f\u4e0a)\n\n\u90a3\u4e48$ans+=dist(y,x)+dist(x,z)$,$ans-=dist(y,z)$\n\n\u5220\u53bb$x$\u540c\u7406\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=200011;\nint n,cnt=0,q,head[N],b[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<1];\nil void add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\nint d[N],dfn[N],sz=0,siz[N],top[N],f[N];\nll dep[N];\nvoid dfs(int x){\n    b[dfn[x]=++sz]=x;\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        dep[to]=dep[x]+e[i].w;\n        d[to]=d[x]+1;\n        f[to]=x;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(k)bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nil ll gd(int x,int y){\n    int ox=x,oy=y;\n    while(top[x]!=top[y])\n        d[top[x]]>d[top[y]]?x=f[top[x]]:y=f[top[y]];\n    return dep[ox]+dep[oy]-2ll*dep[d[x]<d[y]?x:y];\n}\nbool v[N];\nset<int>T;\nil int pre(int x){\n    set<int>::iterator p=T.lower_bound(dfn[x]);\n    if(p==T.begin())p=T.end();\n    return b[*(--p)];\n}\nil int nxt(int x){\n    set<int>::iterator p=T.upper_bound(dfn[x]);\n    if(p==T.end())p=T.begin();\n    return b[*p];\n}\nint main(){\n    in(n,q);\n    int x,y,z,w;\n    ll s=0;\n    Fur(i,1,n-1)in(x,y,w),add(x,y,w),add(y,x,w);\n    dfs(1);bt(1,1);\n    while(q--){\n        in(x);\n        if(v[x]){\n            if(T.size()>1)\n                y=pre(x),z=nxt(x),\n                s+=gd(y,z),\n                s-=gd(x,y)+gd(x,z);\n            T.erase(dfn[x]);\n        }\n        else{\n            T.insert(dfn[x]);\n            if(T.size()>1)\n                y=pre(x),z=nxt(x),\n                s-=gd(y,z),\n                s+=gd(x,y)+gd(x,z);\n        }\n        v[x]^=1;\n        out(s,ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3320 [SDOI2015]\u5bfb\u5b9d\u6e38\u620f/", "tags": ["\u865a\u6811", "lca", "set"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4103 [HEOI2014]\u5927\u5de5\u7a0b", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4103&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4103\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u6765\u8003\u8651\u666e\u901a\u7684\u6811\u578bdp\u600e\u4e48\u505a\n\n\u8bbe$SZ_x$\u8868\u793a$x$\u7684\u5b50\u6811\u4e2d\u6709\u591a\u5c11\u4e2a\u67e5\u8be2\u70b9,$d_x$\u8868\u793a$x$\u7684\u6df1\u5ea6\n\n1. \u8fd9\u4e9b\u65b0\u901a\u9053\u7684\u4ee3\u4ef7\u548c\n\n    \u8003\u8651\u6bcf\u6761\u8fb9\u8981\u88ab\u7edf\u8ba1\u591a\u5c11\u6b21: \n\n    \u5047\u8bbe$y$\u662f$x$\u7684\u67d0\u4e2a\u5b50\u8282\u70b9,$x\\leftrightarrow y$\u4f1a\u88ab\u7edf\u8ba1$(k-SZ_y)\\times SZ_y$\u6b21,\n\n    (\u8d77\u70b9\u53ef\u4ee5\u662f$y$\u7684\u5b50\u6811\u4e2d\u4efb\u4e00\u67e5\u8be2\u70b9,\u7ec8\u70b9\u53ef\u4ee5\u662f$y$\u5b50\u6811\u5916\u7684\u4efb\u4e00\u67e5\u8be2\u70b9,\u8fd9\u6837\u7684\u8bdd\u8def\u5f84\u5fc5\u7136\u7ecf\u8fc7$x\\leftrightarrow y$)\n\n    \u90a3\u4e48\u8d21\u732e\u662f$(d_y-d_x)\\times (k-SZ_y)\\times SZ_y$\n\n2. \u8fd9\u4e9b\u65b0\u901a\u9053\u4e2d\u4ee3\u4ef7\u6700\u5c0f/\u5927\u7684\u662f\u591a\u5c11\n\n    \u6709\u70b9\u7c7b\u4f3c\u6811\u578bdp\u6c42\u6811\u7684\u76f4\u5f84\n\n    $x$\u7684\u5b50\u6811\u4e2d\u6700\u957f\u7684\u8def\u5f84\u662f: \u5b50\u6811\u4e2d\u6df1\u5ea6\u6700\u5927\u7684\u67e5\u8be2\u70b9\u7684\u6df1\u5ea6+\u5b50\u6811\u4e2d\u6df1\u5ea6\u6b21\u5927\u7684\u67e5\u8be2\u70b9\u7684\u6df1\u5ea6(\u82e5$x$\u662f\u67e5\u8be2\u70b9\u5219\u5305\u62ec$x\\leftrightarrow x$,\u6df1\u5ea6\u4e3a$0$)\n\n    \u6700\u77ed\u8def\u5f84\u548c\u4e0a\u9762\u7684\u6c42\u6cd5\u7c7b\u4f3c\n\n\u5957\u4e0a\u865a\u6811\u5c31\u53ef\u4ee5\u89e3\u51b3\u8fd9\u9053\u9898\u4e86\n\n\u5982\u679c\u4e0d\u61c2\u7684\u8bdd\u5c31\u770b\u4ee3\u7801\u54af\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\ntypedef long long ll;\n#define ll long long\n#define rg register\n#define For(i,x,y) for(int i(x);i<=y;++i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\nil int MAX(int x,int y){return x>y?x:y;}\nil int MIN(int x,int y){return x<y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');}}using namespace IO;\nconst int N=1000011,inf=1000000007;\nint n,k,cnt=0,head[N];\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint siz[N],top[N],f[N],d[N],dfn[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;dfn[x]=++sz;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(k)bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nil int lca(int x,int y){\n    while(top[x]!=top[y])\n        d[top[x]]>d[top[y]]?x=f[top[x]]:y=f[top[y]];\n    return d[x]<d[y]?x:y;\n}\nint a[N],st[N],tp,SZ[N],mx_d[N],mi_d[N],a1,a2;\nll ans;\nbool v[N];\nil bool cmp(int x,int y){return dfn[x]<dfn[y];}\nvoid dp(int x){\n    if(v[x])SZ[x]=1,mx_d[x]=d[x],mi_d[x]=d[x];\n    else    SZ[x]=0,mx_d[x]=-inf,mi_d[x]=inf;\n    int p1=-inf,p2=-inf,q1=inf,q2=inf;\n    fl(i,x){\n        dp(to);\n\n        mx_d[x]=MAX(mx_d[x],mx_d[to]);\n        if(mx_d[to]>=p1)p2=p1,p1=mx_d[to];\n        else p2=MAX(p2,mx_d[to]);\n\n        mi_d[x]=MIN(mi_d[x],mi_d[to]);\n        if(mi_d[to]<=q1)q2=q1,q1=mi_d[to];\n        else q2=MIN(q2,mi_d[to]);\n\n        ans+=1ll*(k-SZ[to])*SZ[to]*(d[to]-d[x]);\n        SZ[x]+=SZ[to];\n    }\n    a1=MIN(a1,q1+q2-2*d[x]);\n    if(v[x])a1=MIN(a1,q1-d[x]);\n\n    a2=MAX(a2,p1+p2-2*d[x]);\n    if(v[x])a2=MAX(a2,p1-d[x]);\n    head[x]=0;\n}\nint main(){\n    in(n);\n    int q,x,y,t;\n    For(i,1,n-1)in(x),in(y),add(x,y),add(y,x);\n    d[1]=1;dfs(1);bt(1,1);\n    cnt=0;memset(head,0,sizeof head);\n    in(q);\n    while(q--){\n        in(k);\n        For(i,1,k)in(a[i]),v[a[i]]=1;\n        std::sort(a+1,a+k+1,cmp);\n        cnt=0;st[tp=1]=1;\n        For(i,1,k){\n            x=a[i];t=lca(x,st[tp]);\n            while(d[t]<d[st[tp]]){\n                if(d[t]>=d[st[tp-1]]){\n                    add(t,st[tp--]);\n                    if(t!=st[tp])st[++tp]=t;\n                    break;\n                }\n                add(st[tp-1],st[tp]),--tp;\n            }\n            if(st[tp]!=x)st[++tp]=x;\n        }\n        while(tp>1)add(st[tp-1],st[tp]),--tp;\n        ans=0;a1=inf,a2=0;\n        dp(1);\n        out(ans),pt(' '),out(a1),pt(' '),out(a2),pt('\\n');\n        For(i,1,k)v[a[i]]=0;\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 4103 [HEOI2014]\u5927\u5de5\u7a0b/", "tags": ["\u865a\u6811", "lca", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF613D Kingdom-and-its-Cities", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF613D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF613D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,k=0,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint siz[N],f[N],d[N],dfn[N],sz=0,top[N];\nvoid dfs(int x){\n    siz[x]=1;\n    dfn[x]=++sz;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(k)bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint lca(int x,int y){\n    while(top[x]!=top[y])\n        d[top[x]]>d[top[y]]?x=f[top[x]]:y=f[top[y]];\n    return d[x]<d[y]?x:y;\n}\nint a[N],st[N],tp,b[N];\nbool v[N];\nbool cmp(int x,int y){return dfn[x]<dfn[y];}\nint dp(int x){\n    int ans=0,sum=0;\n    fl(i,x)ans+=dp(to),sum+=b[to];\n    if(v[x])b[x]=1,ans+=sum;\n    else if(sum>1)b[x]=0,++ans;\n    else b[x]=sum;\n    head[x]=0;\n    return ans;\n}\nvoid solve(){\n    Fur(i,1,k)v[a[i]]=0;\n    int x,t,tp;\n    in(k);\n    Fur(i,1,k)in(a[i]),v[a[i]]=1;\n    Fur(i,1,k)if(v[f[a[i]]])return void(out(\"-1\\n\"));\n    sort(a+1,a+k+1,cmp);\n    st[tp=1]=1;cnt=0;\n    Fur(i,1,k){\n        x=a[i];t=lca(x,st[tp]);\n        while(d[t]<d[st[tp]]){\n            if(d[t]>=d[st[tp-1]]){\n                add(t,st[tp--]);\n                if(st[tp]!=t)st[++tp]=t;\n                break;\n            }\n            add(st[tp-1],st[tp]),--tp;\n        }\n        if(st[tp]!=x)st[++tp]=x;\n    }\n    while(tp>1)add(st[tp-1],st[tp]),--tp;\n    out(dp(1),ln);\n}\nint main(){\n    in(n);\n    int x,y,q;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    d[1]=1;dfs(1);bt(1,1);\n    cnt=0;clr(head,0);\n    in(q);\n    while(q--)solve();\n    flush();\n}\n```\n", "link": "/posts/LG CF613D Kingdom-and-its-Cities/", "tags": ["\u865a\u6811", "\u52a8\u6001\u89c4\u5212", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3233 [HNOI2014]\u4e16\u754c\u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3233&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3233\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,cnt=0,head[N],d[N],siz[N],ans[N],a[N],f[N],top[N],dfn[N],sz=0;\nstruct edge{int to,nxt;}e[N<<1];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x){\n    siz[x]=1;\n    dfn[x]=++sz;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(k)bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint lca(int x,int y){\n    while(top[x]!=top[y])\n        d[top[x]]>d[top[y]]?x=f[top[x]]:y=f[top[y]];\n    return d[x]<d[y]?x:y;\n}\nint st[N],tp;\nvoid ins(int x){\n    if(!tp)return void(st[++tp]=x);\n    int t=lca(x,st[tp]);\n    if(t==st[tp])return void(st[++tp]=x);\n    while(tp&&d[t]<d[st[tp-1]])add(st[tp-1],st[tp]),--tp;\n    if(d[t]<d[st[tp]])add(t,st[tp--]);\n    if(st[tp]!=t)st[++tp]=t;\n    st[++tp]=x;\n}\nvoid dp(int x){\n    ans[x]=siz[x];\n    fl(i,x){\n        dp(to);\n        ans[x]-=siz[to]+(d[x]-d[to]+1+(x>to))/2;\n        ans[to]+=(d[x]-d[to]+1+(x>to))/2;\n    }\n    head[x]=0;\n}\nbool cmp(int x,int y){return dfn[x]<dfn[y];}\nint main(){\n    in(n);\n    int k,x,y,q;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    dfs(1);bt(1,1);\n    clr(head,0);\n    in(q);\n    while(q--){\n        cnt=0;\n        in(k);\n        Fur(i,1,k)in(a[i]);\n        sort(a+1,a+k+1,cmp);\n        st[tp=0]=1;\n        Fur(i,1,k)if(a[i]!=1)ins(a[i]);\n        while(tp)add(st[tp-1],st[tp]),--tp;\n        dp(1);\n        Fur(i,1,k)out(ans[a[i]],\" \");out(ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3233 [HNOI2014]\u4e16\u754c\u6811/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u865a\u6811", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2495 [SDOI2011]\u6d88\u8017\u6218", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2495&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2495\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define FL(i,x) for(int i(HEAD[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=250011;\nint n,cnt=0,head[N],a[N],HEAD[N];\nstruct edge{int to,nxt,w;}e[N<<1];\nil void add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\nil void ADD(int x,int y){e[++cnt].to=y;e[cnt].nxt=HEAD[x];HEAD[x]=cnt;}\nint dfn[N],sz=0,d[N],siz[N],top[N],f[N];\nll mi[N];\nvoid dfs(int x){\n    dfn[x]=++sz;\n    siz[x]=1;\n    fl(i,x)if(!dfn[to])\n        f[to]=x,\n        d[to]=d[x]+1,\n        mi[to]=MIN(mi[x],1ll*e[i].w),\n        dfs(to),\n        siz[x]+=siz[to];\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(k)bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint lca(int x,int y){\n    while(top[x]!=top[y])\n        d[top[x]]>d[top[y]]?x=f[top[x]]:y=f[top[y]];\n    return d[x]<d[y]?x:y;\n}\nbool cmp(int x,int y){return dfn[x]<dfn[y];}\nint st[N],tp;\nvoid ins(int x){\n    if(!tp)return void(st[++tp]=x);\n    int t=lca(x,st[tp]);\n    if(t==st[tp])return;\n    while(tp&&dfn[st[tp-1]]>=dfn[t])ADD(st[tp-1],st[tp]),--tp;\n    if(t!=st[tp])ADD(t,st[tp]),st[tp]=t;\n    st[++tp]=x;\n}\nll dp(int x){\n    if(!HEAD[x])return mi[x];\n    ll sum=0;\n    FL(i,x)sum+=dp(to);\n    HEAD[x]=0;\n    return MIN(sum,mi[x]);\n}\nint main(){\n    in(n);\n    int k,x,y,w,q;\n    Fur(i,1,n-1)in(x,y,w),add(x,y,w),add(y,x,w);\n    mi[1]=1ll<<62;\n    d[1]=1;\n    dfs(1);bt(1,1);\n    in(q);\n    while(q--){\n        cnt=0;\n        in(k);\n        Fur(i,1,k)in(a[i]);\n        sort(a+1,a+k+1,cmp);\n        st[tp=0]=1;\n        Fur(i,1,k)ins(a[i]);\n        while(tp)ADD(st[tp-1],st[tp]),--tp;\n        out(dp(1),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 2495 [SDOI2011]\u6d88\u8017\u6218/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u865a\u6811", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4410 [HNOI2009]\u65e0\u5f52\u5c9b", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4410&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4410\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,m,cnt=1,head[N],fa[N],f[N],g[N];\nstruct edge{\n    int to,nxt;\n}e[N<<2];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint dfn[N],sz=0;\nvoid dp(int x,int y){\n    int s=f[y],ss=0,t;//s:\u4e0d\u653e,ss: \u653e\n    for(int i=fa[y];i!=x;i=fa[i])\n        t=MAX(s,ss),ss=s+g[i],s=t+f[i];\n    g[x]+=s;\n    s=ss=0;\n    for(int i=y;i!=x;i=fa[i])\n        t=MAX(s,ss),ss=s+g[i],s=t+f[i];\n    f[x]+=MAX(s,ss);\n}\nvoid dfs(int x){\n    dfn[x]=++sz;\n    fl(i,x)if(!dfn[to])fa[to]=x,dfs(to);\n    fl(i,x)if(x!=fa[to]&&dfn[to]>dfn[x])dp(x,to);//\u627e\u5230\u73af,dp\n}\nint main(){\n    in(n,m);\n    int x,y;\n    Fur(i,1,m)in(x,y),add(x,y),add(y,x);\n    Fur(i,1,n)in(g[i]);\n    dfs(1);\n    printf(\"%d\\n\",MAX(f[1],g[1]));\n}\n```\n", "link": "/posts/LG 4410 [HNOI2009]\u65e0\u5f52\u5c9b/", "tags": ["\u4ed9\u4eba\u638c", "\u52a8\u6001\u89c4\u5212", "tarjan"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4129 [SHOI2006]\u4ed9\u4eba\u638c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4129&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4129\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6240\u6709\u73af\u7684$siz+1$\u7684\u4e58\u79ef,\u6ce8\u610f\u8981\u9ad8\u7cbe\u5ea6\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=20011;\nvoid ext(){printf(\"0\\n\"),exit(0);}\nint n,m,cnt=1,head[N];\nint ans[N],len=0;\nstruct edge{\n    int to,nxt;\n}e[2000011];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;\n}\nint dfn[N],low[N],sz=0,fa[N];\nbool v[N];\nvoid solve(int x,int y){\n    int t=2;\n    for(int i=y;i!=x;i=fa[i]){\n        ++t;\n        if(v[i])ext();\n        v[i]=1;\n    }\n    Fur(i,0,len)ans[i]*=t;\n    Fur(i,0,len-1)if(ans[i]>9){\n        ans[i+1]+=ans[i]/10;\n        ans[i]%=10;\n    }\n    while(ans[len]>9)\n        ans[len+1]+=ans[len]/10,ans[len]%=10,++len;\n}\nvoid tarjan(int x,int la){\n    dfn[x]=low[x]=++sz;\n    fl(i,x)if(i!=la){\n        if(!dfn[to]){\n            fa[to]=x;\n            tarjan(to,i^1);\n            low[x]=MIN(low[x],low[to]);\n        }\n        else low[x]=MIN(low[x],dfn[to]);\n    }\n    fl(i,x)if(fa[to]!=x&&dfn[to]>dfn[x])solve(x,to);\n}\nil void init(){\n    in(n,m);\n    while(m--){\n        int t,x,y;in(t,x);\n        while(--t)in(y),add(x,y),x=y;\n    }\n}\nint main(){\n    init();\n    ans[0]=1;\n    tarjan(1,0);\n    if(sz!=n)ext();\n    Fdr(i,len,0)putchar(ans[i]+48);\n}\n```\n", "link": "/posts/LG 4129 [SHOI2006]\u4ed9\u4eba\u638c/", "tags": ["\u4ed9\u4eba\u638c", "tarjan"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4244 [SHOI2008]\u4ed9\u4eba\u638c\u56fe-II", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4244&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4244\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6c42\u4ed9\u4eba\u638c\u76f4\u5f84\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,m,cnt=1,head[N],ans=0,f[N],d[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;\n}\nint dfn[N],low[N],sz=0,fa[N],a[N],q[N];\nvoid solve(int x,int y){\n    int all=d[y]-d[x]+1,j=all;\n    for(int i=y;i!=fa[x];i=fa[i])a[j--]=f[i];\n    Fur(i,1,all)a[i+all]=a[i];\n    int l=0,r=0;q[0]=1;\n    Fur(i,2,all*2){\n        while(l<=r&&i-q[l]>(all>>1))++l;\n        ans=MAX(ans,a[i]+a[q[l]]+i-q[l]);\n        while(l<=r&&a[q[r]]-q[r]<=a[i]-i)--r;\n        q[++r]=i;\n    }\n    Fur(i,2,all)f[x]=MAX(f[x],a[i]+MIN(i-1,all-i+1));\n}\nvoid tarjan(int x,int la){\n    dfn[x]=low[x]=++sz;\n    fl(i,x)if(i!=la){\n        if(!dfn[to]){\n            fa[to]=x;d[to]=d[x]+1;\n            tarjan(to,i^1);\n            low[x]=MIN(low[x],low[to]);\n            if(low[to]>dfn[x]){\n                ans=MAX(ans,f[x]+f[to]+1);\n                f[x]=MAX(f[x],f[to]+1);\n            }\n        }\n        else low[x]=MIN(low[x],dfn[to]);\n    }\n\n    fl(i,x)if(fa[to]!=x&&dfn[to]>dfn[x])solve(x,to);\n}\nil void init(){\n    in(n,m);\n    while(m--){\n        int t,x,y;in(t,x);\n        while(--t)in(y),add(x,y),x=y;\n    }\n}\nint main(){\n    init();\n    tarjan(1,0);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 4244 [SHOI2008]\u4ed9\u4eba\u638c\u56fe-II/", "tags": ["\u4ed9\u4eba\u638c", "tarjan", "\u6811\u7684\u76f4\u5f84", "dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF487E Tourists", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF487E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF487E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5efa\u5b8c\u5e7f\u4e49\u5706\u65b9\u6811\u540e\u7528\u6811\u94fe\u5256\u5206+\u7ebf\u6bb5\u6811\u7ef4\u62a4\n\n\u4fee\u6539\u4e00\u4e2a\u70b9\u7684\u65f6\u5019,\u8003\u8651\u5230\u8981\u4fee\u6539\u5b83\u6240\u5728\u7684\u53cc\u8fde\u901a\u5206\u91cf\u4e2d\u7684\u70b9,\u6211\u4eec\u53ef\u4ee5\u5728\uff08\u5b83\u7684\u7236\u4eb2\uff09\u65b9\u70b9\u5efa\u4e00\u4e2a\u5bf9\u9876\u5806\u6765\u7ef4\u62a4\u6700\u5c0f\u503c\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define FL(i,x) for(int i(HEAD[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=200011;\nint n,m,q,tot,cnt=0,head[N],HEAD[N],val[N];\nstruct node{\n    priority_queue<int,vector<int>,greater<int>>a,b;\n    il void push(int x){a.push(x);}\n    il void del(int x){b.push(x);}\n    il int top(){\n        while(!b.empty()&&a.top()==b.top())a.pop(),b.pop();\n        return a.top();\n    }\n}ne[N];\nstruct edge{int to,nxt;}e[N<<2];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;\n}\nil void ADD(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=HEAD[x];HEAD[x]=cnt;\n    e[++cnt].to=x;e[cnt].nxt=HEAD[y];HEAD[y]=cnt;\n}\nint dfn[N],low[N],sz=0,st[N],tp=0;\nvoid tarjan(int x,int fa){\n    dfn[x]=low[x]=++sz;st[++tp]=x;\n    fl(i,x)\n    if(!dfn[to]){\n        tarjan(to,x);\n        low[x]=MIN(low[x],low[to]);\n        if(low[to]>=dfn[x]){\n            ADD(++tot,x);\n            while(int k=st[tp--]){\n                ADD(tot,k);\n                if(k==to)break;\n            }\n        }\n    }\n    else if(to!=fa)low[x]=MIN(low[x],dfn[to]);\n}\nint s[N<<2],a[N];\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=MIN(s[ls],s[rs])\nvoid build(int l,int r,int rt){\n    if(l==r)return void(s[rt]=a[l]);\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu;\n}\nvoid upd(int p,int v,int l=1,int r=tot,int rt=1){\n    if(l==r)return void(s[rt]=v);\n    int m=(l+r)>>1;\n    if(p<=m)upd(p,v,l,m,ls);\n    else upd(p,v,m+1,r,rs);\n    pu;\n}\nint ask(int L,int R,int l=1,int r=tot,int rt=1){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1;\n    return MIN(((L<=m)?ask(L,R,l,m,ls):inf),((R>m)?ask(L,R,m+1,r,rs):inf));\n}\nint siz[N],top[N],d[N],f[N],son[N],id[N],SZ=0;\nvoid dfs(int x){\n    siz[x]=1;\n    FL(i,x)if(to!=f[x]){\n        f[to]=x;\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++SZ;a[id[x]]=val[x];\n    if(son[x])bt(son[x],tp);\n    FL(i,x)if(!top[to])bt(to,to);\n}\nint fm(int x,int y){\n    int ans=inf;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans=MIN(ans,ask(id[top[x]],id[x]));x=f[top[x]];\n    }\n    if(d[x]>d[y])SWAP(x,y);\n    if(x>n)ans=MIN(ans,val[f[x]]);\n    return MIN(ans,ask(id[x],id[y]));\n}\nint main(){\n    in(n,m,q);tot=n;\n    int x,y;\n    char ch;\n    Fur(i,1,n)in(val[i]);\n    Fur(i,1,m)in(x,y),add(x,y);\n    tarjan(1,0);\n    dfs(1);\n    Fur(i,1,n)if(f[i])\n        ne[f[i]].push(val[i]);\n    Fur(i,n+1,tot)val[i]=ne[i].top();\n    bt(1,1);\n    build(1,tot,1);\n    while(q--){\n        in(ch,x,y);\n        if(ch=='C'){\n            upd(id[x],y);\n            if(f[x]){\n                ne[f[x]].del(val[x]);\n                ne[f[x]].push(y);\n                if(val[f[x]]!=ne[f[x]].top())\n                    upd(id[f[x]],val[f[x]]=ne[f[x]].top());\n            }\n            val[x]=y;\n        }\n        else out(fm(x,y),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF487E Tourists/", "tags": ["\u4ed9\u4eba\u638c", "tarjan", "\u6811\u94fe\u5256\u5206", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4320 \u9053\u8def\u76f8\u9047", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4320&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4320\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define MB template <class T>il\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define FL(i,x) for(int i(HEAD[x]),to;to=e[i].to,i;i=e[i].nxt)\nMB T MAX(T x,T y){return x>y?x:y;}\nMB T MIN(T x,T y){return x<y?x:y;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011;\nint n,m,cnt=0,head[N],HEAD[N];\nstruct edge{int to,nxt;}e[N<<3];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;\n}\nil void ADD(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=HEAD[x];HEAD[x]=cnt;\n    e[++cnt].to=x;e[cnt].nxt=HEAD[y];HEAD[y]=cnt;\n}\nint dfn[N],low[N],sz=0,tot,st[N],tp=0;\nvoid tarjan(int x,int fa){\n    dfn[x]=low[x]=++sz;st[++tp]=x;\n    fl(i,x)\n    if(!dfn[to]){\n        tarjan(to,x);\n        low[x]=MIN(low[x],low[to]);\n        if(low[to]>=dfn[x]){\n            ADD(++tot,x);\n            while(int k=st[tp--]){\n                ADD(tot,k);\n                if(k==to)break;\n            }\n        }\n    }\n    else if(to!=fa)low[x]=MIN(low[x],dfn[to]);\n}\nint f[N],siz[N],d[N],top[N],son[N];\nvoid dfs(int x){\n    siz[x]=1;\n    FL(i,x)if(to!=f[x]){\n        f[to]=x;\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;\n    if(son[x])bt(son[x],tp);\n    FL(i,x)if(!top[to])bt(to,to);\n}\nint lca(int x,int y){\n    while(top[x]!=top[y])\n        (d[top[x]]>d[top[y]])?x=f[top[x]]:y=f[top[y]];\n    return d[x]<d[y]?x:y;\n}\nint main(){\n    in(n,m);tot=n;\n    int x,y,q;\n    Fur(i,1,m)in(x,y),add(x,y);\n    tarjan(1,0);\n    d[1]=1;dfs(1);bt(1,1);\n    in(q);\n    while(q--){\n        in(x,y);\n        out((d[x]+d[y]-2*d[lca(x,y)])/2+1,ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 4320 \u9053\u8def\u76f8\u9047/", "tags": ["tarjan", "\u6811\u94fe\u5256\u5206", "\u500d\u589e", "lca", "\u5706\u65b9\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "BZ 2125 \u6700\u77ed\u8def", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://remmina.github.io/BZPRO/JudgeOnline/2125.html&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://remmina.github.io/BZPRO/JudgeOnline/2125.html\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6839\u636e\u4ed9\u4eba\u638c\u56fe\u6784\u5efa\u5706\u65b9\u6811\n\n\u82e5\u4e24\u4e2a\u70b9\u7684lca\u662f\u539f\u56fe\u7684\u70b9,\u90a3\u4e48\u76f4\u63a5$d_x+d_y-2\\times d_{lca(x,y)}$\n\n\u5426\u5219\u5c31\u662f\u4e24\u4e2a\u70b9\u5230\u73af\u7684\u8ddd\u79bb\u52a0\u4e0a\u4e24\u4e2a\u70b9\u5728\u73af\u4e0a\u7684\u6700\u77ed\u8ddd\u79bb\n<!-- more -->\n\n```cpp\n#include<cstdio>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define Fdr(i,x,y) for(int i(x);i>=y;--i)\nil void swap(int &x,int &y){int t=x;x=y;y=t;}\nil int min(int x,int y){return x<y?x:y;}\nil int abs(int x){return x>0?x:-x;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=20011;\nint n,m,q,cnt=0,head[N],HEAD[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<2];\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define FL(i,x) for(int i(HEAD[x]),to;to=e[i].to,i;i=e[i].nxt)\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;e[cnt].w=w;\n}\nil void ADD(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=HEAD[x];HEAD[x]=cnt;e[cnt].w=w;\n    e[++cnt].to=x;e[cnt].nxt=HEAD[y];HEAD[y]=cnt;e[cnt].w=w;\n}\nint dfn[N],low[N],sz=0,fa[N],tot,b[N],id[N];\nint s[N],dep[N];\nvoid solve(int x,int y,int w){\n    ++tot;\n    int t=w,tt=0;\n    for(int i=y;i!=fa[x];i=fa[i]){\n        s[i]=t;\n        t+=b[i];\n        id[i]=tt++;\n    }\n    s[tot]=s[x];s[x]=0;\n    for(int i=y;i!=fa[x];i=fa[i])\n        ADD(tot,i,min(s[i],s[tot]-s[i]));\n}\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;\n    fl(i,x)if(to!=fa[x]){\n        if(!dfn[to]){\n            fa[to]=x;b[to]=e[i].w;\n            tarjan(to);\n            low[x]=min(low[x],low[to]);\n        }\n        else low[x]=min(low[x],dfn[to]);\n        if(low[to]>dfn[x])ADD(x,to,e[i].w);\n    }\n    fl(i,x)if(fa[to]!=x&&dfn[to]>dfn[x])\n        solve(x,to,e[i].w);\n}\nint f[16][N],d[N],A,B;\nvoid dfs(int x){\n    for(int j=1;(1<<j)<=d[x];++j)\n        f[j][x]=f[j-1][f[j-1][x]];\n    FL(i,x)if(to!=f[0][x]){\n        f[0][to]=x;\n        d[to]=d[x]+1;\n        dep[to]=dep[x]+e[i].w;\n        dfs(to);\n    }\n}\nint lca(int x,int y){\n    if(d[x]<d[y])swap(x,y);\n    int D=d[x]-d[y];\n    for(int i=0;(1<<i)<=D;++i)if(D&(1<<i))x=f[i][x];\n    if(x==y)return x;\n    Fdr(i,15,0)if((1<<i)<=d[x]&&f[i][x]!=f[i][y])\n        x=f[i][x],y=f[i][y];\n    A=x,B=y;\n    return f[0][x];\n}\nint main(){\n    in(n,m,q);tot=n;\n    int x,y,w;\n    Fur(i,1,m)in(x,y,w),add(x,y,w);\n    tarjan(1);\n    dfs(1);\n    while(q--){\n        in(x,y);\n        w=lca(x,y);\n        if(w<=n)out(dep[x]+dep[y]-2*dep[w],ln);\n        else out(dep[x]+dep[y]-dep[A]-dep[B]+min(s[w]-abs(s[B]-s[A]),abs(s[A]-s[B])),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/BZ 2125 \u6700\u77ed\u8def/", "tags": ["\u4ed9\u4eba\u638c", "lca", "\u500d\u589e", "\u5706\u65b9\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "Acwing 360 Freda\u7684\u4f20\u547c\u673a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define Fdr(i,x,y) for(int i(x);i>=y;--i)\nil void swap(int &x,int &y){int t=x;x=y;y=t;}\nil int min(int x,int y){return x<y?x:y;}\nil int abs(int x){return x>0?x:-x;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=20011;\nint n,m,q,cnt=0,head[N],HEAD[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<2];\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n#define FL(i,x) for(int i(HEAD[x]),to;to=e[i].to,i;i=e[i].nxt)\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;e[cnt].w=w;\n}\nil void ADD(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=HEAD[x];HEAD[x]=cnt;e[cnt].w=w;\n    e[++cnt].to=x;e[cnt].nxt=HEAD[y];HEAD[y]=cnt;e[cnt].w=w;\n}\nint dfn[N],low[N],sz=0,fa[N],tot,b[N],id[N],s[N];\nvoid solve(int x,int y,int w){\n    ++tot;\n    int t=w,tt=0;\n    for(int i=y;i!=fa[x];i=fa[i]){\n        s[i]=t;\n        t+=b[i];\n        id[i]=tt++;\n    }\n    s[tot]=s[x];s[x]=0;\n    for(int i=y;i!=fa[x];i=fa[i])\n        ADD(tot,i,min(s[i],s[tot]-s[i]));\n}\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;\n    fl(i,x)if(to!=fa[x]){\n        if(!dfn[to]){\n            fa[to]=x;b[to]=e[i].w;\n            tarjan(to);\n            low[x]=min(low[x],low[to]);\n        }\n        else low[x]=min(low[x],dfn[to]);\n        if(low[to]>dfn[x])ADD(x,to,e[i].w);\n    }\n    fl(i,x)if(fa[to]!=x&&dfn[to]>dfn[x])\n        solve(x,to,e[i].w);\n}\nint f[N],d[N],dep[N],siz[N],top[N],A,B,st[N],ed[N],df=0;\nvoid dfs(int x){\n    st[x]=++df;\n    siz[x]=1;\n    FL(i,x)if(to!=f[x]){\n        f[to]=x;\n        d[to]=d[x]+1;\n        dep[to]=dep[x]+e[i].w;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n    ed[x]=df;\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    FL(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    FL(i,x)if(!top[to])bt(to,to);\n}\nil int lca(int x,int y){\n    int ox=x,oy=y;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        x=f[top[x]];\n    }\n    if(d[x]>d[y])swap(x,y);\n    FL(i,x)if(to!=f[x]){\n        if(st[to]<=st[ox]&&ed[ox]<=ed[to])A=to;\n        if(st[to]<=st[oy]&&ed[oy]<=ed[to])B=to;\n    }\n    return x;\n}\nint main(){\n    in(n,m,q);tot=n;\n    int x,y,w;\n    Fur(i,1,m)in(x,y,w),add(x,y,w);\n    tarjan(1);\n    dfs(1);bt(1,1);\n    while(q--){\n        in(x,y);\n        w=lca(x,y);\n        if(w<=n)out(dep[x]+dep[y]-2*dep[w],ln);\n        else out(dep[x]+dep[y]-dep[A]-dep[B]+min(s[w]-abs(s[B]-s[A]),abs(s[A]-s[B])),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/Acwing 360 Freda\u7684\u4f20\u547c\u673a/", "tags": ["\u57fa\u73af\u6811", "lca", "\u4ed9\u4eba\u638c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2868 [USACO07DEC]\u89c2\u5149\u5976\u725bSightseeing-Cows", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2868&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2868\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e8c\u5206\u6700\u5927\u5e73\u5747\u5feb\u4e50\u503c,\u5224\u8d1f\u73af\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,m,cnt=0,head[N],val[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<1];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n}\nint main(){\n    in(n,m);\n    Fur(i,1,n)in(val[i]);\n    int x,y,w;\n    Fur(i,1,n)in(x,y,w),add(x,y,w),add(y,x,w);\n    \n}\n```\n", "link": "/posts/LG 2868 [USACO07DEC]\u89c2\u5149\u5976\u725bSightseeing-Cows/", "tags": ["\u5206\u6570\u89c4\u5212", "bfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2607 [ZJOI2008]\u9a91\u58eb", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2607&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2607\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5c06\u4e00\u4e2a\u9a91\u58eb\u4e0e\u4ed6\u6700\u75db\u6068\u7684\u4eba\u8fde\u8fb9\n\n\u5148\u8003\u8651\u8fd9\u4e2a\u5982\u679c\u662f\u6811\u578bdp\uff1a\n\n$f_x$\u8868\u793a\u4e0d\u53d6$x$,$g_x$\u8868\u793a\u53d6$x$\n\n$$\nf_x=\\sum \\max(f_{to},g_{to})\n\\\\\ng_x=\\sum f_{to}\n$$\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u4e24\u6b21\u6811\u578bdp\u4ee3\u66ff\u57fa\u73af\u6811dp\n\n\u7b2c\u4e00\u6b21\uff1a \u9009\u62e9$x$,\u4e0d\u9009\u62e9$x$\u6700\u75db\u6068\u7684\u4eba\n\n\u7b2c\u4e00\u6b21\uff1a \u9009\u62e9$x$\u6700\u75db\u6068\u7684\u4eba,\u4e0d\u9009\u62e9$x$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011;\nint n,cnt=0,head[N],val[N],a[N],rt;\nll f[N],g[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nbool v[N];\nvoid dp(int x){\n    f[x]=0;g[x]=val[x];\n    v[x]=1;\n    fl(i,x)if(to!=rt){\n        dp(to);\n        f[x]+=max(f[to],g[to]);\n        g[x]+=f[to];\n    }\n    else g[to]=-inf;\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(val[i],a[i]),add(a[i],i);\n    ll ans=0,res;\n    Fur(i,1,n)if(!v[i]){\n        rt=i;\n        res=0;\n        while(!v[a[rt]]){\n            v[rt]=1;\n            rt=a[rt];\n        }\n        dp(rt);//\u5f3a\u5236\u9009i\n        res=MAX(f[rt],g[rt]);\n        rt=a[rt];\n        dp(rt);//\u5f3a\u5236\u9009a[i]\n        ans+=MAX(res,MAX(f[rt],g[rt]));\n    }\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 2607 [ZJOI2008]\u9a91\u58eb/", "tags": ["\u57fa\u73af\u6811", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "Acwing 361 \u521b\u4e16\u7eaa", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e24\u6b21dp\u89e3\u51b3\u4ee3\u66ff\u57fa\u73af\u6811dp\n\n\u6240\u6709\u7684$A_i\\rightarrow i$\u6784\u6210\u4e86\u4e00\u68f5\u57fa\u73af\u6811\n\n\u6211\u4eec\u5148\u8003\u8651\u5982\u679c\u57fa\u73af\u6811\u7684\u5b50\u6811\u600e\u4e48\u505a\n\n\u4e5f\u5c31\u662f\u6811\u578bdp\n\n($f_x$\u8868\u793a\u4e0d\u653e,$g_x$\u8868\u793a\u653e)\n\n\u82e5\u5143\u7d20$i$\u4e0d\u6295\u653e,\n\n$$f_x=\\sum_{A_y=x}\\max(f_y,g_y)$$\n\n\u5426\u5219\u5fc5\u987b\u81f3\u5c11\u6709\u4e00\u4e2a\u5143\u7d20\u9650\u5236$i$,\u4e0d\u80fd\u6295\u653e\n\n$$g_x=\\max_{A_y=x}\\{f_y+\\sum_{A_z=x,z\\not = y}\\max(f_z,g_z)\\}$$\n\n\u627e\u5230\u73af\u4e0a\u7684\u4e00\u4e2a\u70b9,\u5c06\u5b83\u548c\u5b83\u9650\u5236\u7684\u90a3\u4e2a\u70b9\u65ad\u5f00,\u5148\u540e\u8fdb\u884c\u4e24\u6b21\u6811\u5f62dp,\n\n\u7b2c\u4e00\u6b21\u662f\u5047\u8bbe\u73af\u4e0a\u7684\u8fd9\u4e2a\u70b9\u5bf9\u5176\u9650\u5236\u7684\u70b9\u4e0d\u8d77\u9650\u5236\u4f5c\u7528\n\n\u53e6\u5916\u4e00\u6b21\u662f\u5f3a\u5236\u73af\u4e0a\u90a3\u4e2a\u70b9\u5df2\u7ecf\u9650\u5236\u4e86\u5176\u53ef\u4ee5\u9650\u5236\u7684\u70b9\uff08\u4e5f\u5c31\u662f\u73af\u4e0a\u90a3\u4e2a\u70b9\u4e0d\u9009\uff09\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011;\nint n,cnt=0,head[N],A[N],f[N],g[N],RT;\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nbool v[N];\nvoid dp(int x){\n    v[x]=1;f[x]=0;\n    int res=inf;\n    fl(i,x)if(to!=RT){\n        dp(to);\n        f[x]+=MAX(f[to],g[to]);\n        res=MIN(res,MAX(g[to]-f[to],0));\n    }\n    g[x]=f[x]+1-res;\n}\n\nint main(){\n    in(n);\n    Fur(i,1,n)in(A[i]),add(A[i],i);\n    int ans=0;\n    Fur(i,1,n)if(!v[i]){\n        int res=0;\n        RT=i;\n        while(!v[A[RT]]){\n            v[RT]=1;\n            RT=A[RT];\n        }\n        dp(RT);\n        res=MAX(f[RT],g[RT]);\n        RT=A[RT];\n        dp(RT);\n        ans+=MAX(res,MAX(f[RT],g[RT]));\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/Acwing 361 \u521b\u4e16\u7eaa/", "tags": ["\u57fa\u73af\u6811", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4381 [IOI2008]Island", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4381&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4381\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6c42\u57fa\u73af\u6811\u76f4\u5f84\n\n\u5148\u627e\u51fa\u73af,\u628a\u73af\u5f53\u6839\u8282\u70b9,\u627e\u51fa\u6bcf\u68f5\u5b50\u6811\u7684\u76f4\u5f84\u548c\u6700\u5927\u6df1\u5ea6$d_x$\n\n\u63a5\u7740\u5c31\u8981\u5728\u73af\u4e0a\u627e\u5230\u4e24\u70b9$x,y$\u4f7f$d_x+dis(x,y)+d_y$\u6700\u5927\n\n\u53ef\u4ee5\u7834\u73af\u540e\u7528\u5355\u8c03\u961f\u5217$\\mathcal O(n)$\u5904\u7406\n<!-- more -->\n\n```cpp\n#include<cstdio>\nconst int N=1000011;\n#define ll long long\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\ninline ll max(ll x,ll y){return x>y?x:y;}\nint n,cnt=0,head[N],dfn[N],sz=0,pre[N],tt[N],tot=0,q[N];\nbool b[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<1];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n}\nvoid dfs(int x){\n    dfn[x]=++sz;\n    fl(i,x)if(to!=pre[x]){\n        if(dfn[to]){\n            if(dfn[to]<dfn[x])continue;\n            b[tt[++tot]=x]=1;\n            for(int y=to;y!=x;y=pre[y])b[tt[++tot]=y]=1;\n        }\n        else pre[to]=x,dfs(to);\n    }\n}\nll f[N],d[N],s[N],ans=0;\nvoid dp(int x,int fa){\n    fl(i,x)if(to!=fa&&!b[to]){\n        dp(to,x);\n        f[x]=max(f[x],max(f[to],d[x]+d[to]+e[i].w));\n        d[x]=max(d[x],d[to]+e[i].w);\n    }\n}\nvoid work(int x){\n    ll tmp=0;\n    tot=0;\n    dfs(x);\n    tt[tot+1]=tt[1];\n    int p=0;\n    for(int i=1;i<=tot;++i)\n        fl(j,tt[i])if(to==tt[i+1])\n            s[++p]=e[j].w;\n    for(int i=1;i<=tot+1;++i)\n        tt[i+tot]=tt[i],s[i+tot]=s[i];\n    for(int i=2;i<=tot*2;++i)s[i]+=s[i-1];\n    for(int i=1;i<=tot;++i)dp(tt[i],0),tmp=max(tmp,max(f[tt[i]],d[tt[i]]));\n    int h=1,t=0;\n    for(int i=1;i<=tot*2;++i){\n        while(h<=t&&i-q[h]>=tot)++h;\n        if(h<=t)tmp=max(tmp,d[tt[i]]+d[tt[q[h]]]+s[i-1]-s[q[h]-1]);\n        while(h<=t&&d[tt[i]]-s[i-1]>=d[tt[q[t]]]-s[q[t]-1])--t;\n        q[++t]=i;\n    }\n    ans+=tmp;\n}\nint main(){\n    scanf(\"%d\",&n);\n    int y,w;\n    for(int i=1;i<=n;++i)\n        scanf(\"%d%d\",&y,&w),\n        add(i,y,w),add(y,i,w);\n    for(int i=1;i<=n;++i)if(!dfn[i])work(i);\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 4381 [IOI2008]Island/", "tags": ["\u57fa\u73af\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2889 [USACO07NOV]\u6324\u5976\u7684\u65f6\u95f4Milking-Time", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2889&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2889\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f[i]=\\max{f[t-r]+p}$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=1000011;\nstruct node{int st,ed,p,next;}a[N];\nint f[N],head[N];\ninline int max(int x,int y){return x>y?x:y;}\nint main(){\n    int n,m,r;\n    scanf(\"%d%d%d\",&n,&m,&r);\n    for(int i=1;i<=m;++i){\n        scanf(\"%d%d%d\",&a[i].st,&a[i].ed,&a[i].p);\n        a[i].next=head[a[i].ed];\n        head[a[i].ed]=i;\n    }\n    for(int j=1;j<=n;++j){\n        f[j]=f[j-1];\n        for(int i=head[j];i;i=a[i].next)\n            f[j]=max(f[j],f[max(0,a[i].st-r)]+a[i].p);\n    }\n    printf(\"%d\\n\",f[n]);\n}\n```\n", "link": "/posts/LG 2889 [USACO07NOV]\u6324\u5976\u7684\u65f6\u95f4Milking-Time/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3978 [TJOI2015]\u6982\u7387\u8bba", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3978&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3978\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_n$\u8868\u793a$n$\u4e2a\u8282\u70b9\u53ef\u4ee5\u6784\u6210\u7684\u4e8c\u53c9\u6811\u7684\u4e2a\u6570,$g_n$\u8868\u793a$n$\u4e2a\u8282\u70b9\u53ef\u4ee5\u6784\u6210\u7684\u4e8c\u53c9\u6811\u7684\u53f6\u5b50\u8282\u70b9\u7684\u603b\u6570\n\n\u6253\u8868: \u53ef\u4ee5\u53d1\u73b0$g_n=nf_{n-1}$\n\n\u8bc1\u660e: \u5bf9\u4e8e\u6bcf\u68f5\u6709$n$\u4e2a\u8282\u70b9\u7684\u4e8c\u53c9\u6811,\u82e5\u5b83\u6709$k$\u4e2a\u53f6\u5b50\u8282\u70b9,\u5220\u53bb\u540e\u53ef\u4ee5\u5f97\u5230$k$\u68f5$n-1$\u4e2a\u8282\u70b9\u7684\u4e8c\u53c9\u6811,\u800c\u8fd9$k$\u68f5$n-1$\u4e2a\u8282\u70b9\u7684\u4e8c\u53c9\u6811\u6bcf\u68f5\u90fd\u6709$n$\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u653e\u7f6e\u65b0\u7684\u53f6\u5b50\u8282\u70b9\n\n$$\nf_1=1\\\\\nf_n=\\sum_{i=1}^{n-1}f_if_{n-i-1}\n$$\n\n$f$\u5176\u5b9e\u5c31\u662f\u5361\u7279\u5170\u6570\n\n\u4ee3\u5165$ans=\\frac{g_n}{f_n}$\u5f97\u5230$\\frac{n(n+1)}{2(2n-1)}$\n<!-- more -->\n\n```cpp\n#include<cstdio>\nint main(){\n  double n;\n  scanf(\"%lf\",&n);\n  printf(\"%.12f\",n*(n+1)/2/(2*n-1));\n}\n```\n", "link": "/posts/LG 3978 [TJOI2015]\u6982\u7387\u8bba/", "tags": ["\u751f\u6210\u51fd\u6570", "\u6570\u8bba", "\u5361\u7279\u5170\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "HDU 1085 Holding-Bin-Laden-Captive!", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=1085&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"http://acm.hdu.edu.cn/showproblem.php?pid=1085\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$g(x)=(1+x+x^2+x^3+...+x^{num_1})(1+x^2+x^4+...+x^{2num_2})(1+x^5+x^{10}+x^{15}+...+x^{5num_3})$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nconst int N=10011;\nint n1,n2,n3,a[N],b[N],c[N];\nint main(){\n    while(~scanf(\"%d%d%d\",&n1,&n2,&n3)&&(n1||n2||n3)){\n        memset(a,0,sizeof a);\n        memset(b,0,sizeof b);\n        memset(c,0,sizeof c);\n        int tot=n1+n2*2+n3*5;\n        for(int i=0;i<=n1;++i)a[i]=1;\n        for(int j=0;j<=tot;++j)\n            for(int i=0;i<=n2*2&&i+j<=tot;i+=2)\n                b[i+j]+=a[j];\n        for(int j=0;j<=tot;++j)\n            for(int i=0;i<=n3*5&&i+j<=tot;i+=5)\n                c[i+j]+=b[j];\n        int i;\n        for(i=0;i<=tot;++i)if(!c[i])break;\n        printf(\"%d\\n\",i);\n    }\n}\n```\n", "link": "/posts/HDU 1085 Holding-Bin-Laden-Captive!/", "tags": ["\u751f\u6210\u51fd\u6570", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "HDU 1028 Ignatius-and-the-Princess-III", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=1028&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"http://acm.hdu.edu.cn/showproblem.php?pid=1028\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$g(x)=(1+x+x^2+x^3+...)(1+x^2+x^4+x^6+...)(1+x^3+x^6+x^9+...)...$\n\n\u6a21\u62df\u4e00\u4e0b\n\n$\\Theta(n^2)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define Fur(i,x,y) for(int i=x;i<=y;++i)\nconst int N=121;\nint n,a[2][N];\nint main(){\n    Fur(i,0,120)a[1][i]=1;\n    Fur(i,2,120){\n        memset(a[i&1],0,sizeof a[i&1]);\n        int p=0;\n        while(p<=120){\n            Fur(j,0,120-p)a[i&1][p+j]+=a[!(i&1)][j];\n            p+=i;\n        }\n    }\n    while(~scanf(\"%d\",&n))printf(\"%d\\n\",a[0][n]);\n}\n```\n", "link": "/posts/HDU 1028 Ignatius-and-the-Princess-III/", "tags": ["\u751f\u6210\u51fd\u6570", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3988 [SHOI2013]\u53d1\u724c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3988&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3988\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u76f4\u63a5\u6a21\u62df,\u628a\u5e73\u8861\u6811\u5f53\u505a\u53ef\u4ee5$\\Theta(\\log n)$\u8bbf\u95ee\u5e76\u5220\u9664\u4efb\u610f\u4f4d\u7f6e\u7684\u94fe\u8868\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=700011;\n#define ls c[rt][0]\n#define rs c[rt][1]\nint n,q,sz[N],c[N][2],val[N],rnd[N],rev[N],RT=0,cnt=0;\nil int ne(int v){\n    val[++cnt]=v;\n    sz[cnt]=1;\n    rnd[cnt]=rand()<<15|rand();\n    return cnt;\n}\nil void pu(int rt){sz[rt]=sz[ls]+sz[rs]+1;}\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt)return (void)(x=y=0);\n    if(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k-sz[ls]-1,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    if(rnd[x]<rnd[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);return y;\n    }\n}\nil int get(int p){\n    int x,y,z,t;\n    sl(RT,p,x,z);\n    sl(x,p-1,x,y);\n    t=val[y];\n    RT=mg(mg(x,mg(c[y][0],c[y][1])),z);\n    return t;\n}\nint main(){\n    srand(time(0));\n    in(n);\n    int x,cur=1;\n    for(int i=1;i<=n;++i)RT=mg(RT,ne(i));\n    for(int i=1;i<=n;++i){\n        in(x);\n        cur=(cur+x-1)%(n-i+1)+1;\n        out(get(cur),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3988 [SHOI2013]\u53d1\u724c/", "tags": ["\u5e73\u8861\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2159 [SHOI2009]\u821e\u4f1a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2159&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2159\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6392\u5e8f\u540e\u52a8\u6001\u89c4\u5212\n\n\u8bbe$f[i][j]$\u8868\u793a\u524d$i$\u4e2a\u5973\u751f,\u81f3\u5c11\u6709$j$\u4e2a\u6bd4\u7537\u751f\u9ad8\n\n$f[i][j]=(f[i-1][j]+f[i-1][j-1]\\times(p-j+1))\\times(n-i)!$($p$\u8868\u793a\u6709$p$\u4e2a\u7537\u751f\u6bd4\u524d$i$\u4e2a\u5973\u751f\u77ee)\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=211;\nint n,k,a[N],b[N],f[N][N],c[N][N];\nll fac[N];\nint main(){\n    in(n,k);\n    fac[0]=1;\n    Fur(i,1,n)fac[i]=fac[i-1]*i;\n    Fur(i,1,n)in(a[i]);\n    Fur(i,1,n)in(b[i]);\n    sort(a+1,a+n+1);\n    sort(b+1,b+n+1);\n    f[0][0]=1;\n    int p=0;\n    Fur(i,1,n){\n        while(b[i]>a[p+1]&&p<n)++p;\n        Fur(j,0,i){\n            f[i][j]=f[i-1][j];\n            if(p-j+1>0)\n                f[i][j]=f[i][j]+f[i-1][j-1]*(p-j+1);\n        }\n    }\n    c[0][0]=1;\n    Fur(i,1,n){\n        c[i][0]=c[i][i]=1;\n        Fur(j,1,i-1)\n            c[i][j]=c[i-1][j-1]+c[i-1][j];\n    }\n    Fur(i,0,n)f[n][i]=f[n][i]*fac[n-i];\n    Fdr(i,n,0)\n        Fur(j,i+1,n)\n            f[n][i]=f[n][i]-c[j][i]*f[n][j];\n    \n    int ans=0;\n    Fur(i,0,k)ans=ans+f[n][i];\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG 2159 [SHOI2009]\u821e\u4f1a/", "tags": ["\u6392\u5e8f", "\u52a8\u6001\u89c4\u5212", "\u9ad8\u7cbe", "\u5bb9\u65a5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5242 [USACO19FEB]Cow-Dating", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5242&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5242\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe\u5f53\u524d\u533a\u95f4\u4e3a$[l,r]$\n\n$res=\\sum_{i=l}^r p_i\\times[\\prod_{j=l,j!=i}^r(1-p_j)]$\n\n\u8bbe$s_{[l,r]}$\u8868\u793a$\\prod_{i=l}^r(1-p_i)$\n\n$res=s_{[l,r]}\\sum_{i=l}^r \\frac{p_i}{1-p_i}$\n\n\u8bbe$a_i=1-p_i,b_i=\\frac{p_i}{1-p_i}$\n\n$res=\\prod_{i=l}^ra_i\\sum_{i=l}^rb_i$\n\n\u5047\u8bbe\u73b0\u5728\u533a\u95f4\u53d8\u6210\u4e86$[l,r+1]$\n\n\u8bbe$A=\\prod_{i=l}^ra_i,B=\\sum_{i=l}^rb_i$\n\n$res'=A\\times a_{r+1}(B+b_{r+1})$\n\n$=A(a_{r+1}B+a_{r+1}b_{r+1})$\n\n$=A(a_{r+1}B+p_{r+1})$\n\n\u82e5$res'>res$,\u90a3\u4e48$a_{r+1}B+p_{r+1}>B$\n\n$1-p_{r+1}+\\frac{p_{r+1}}B>1$\n\n$\\therefore B<1$\n\n\u90a3\u4e48\u5bf9\u4e8e\u6bcf\u4e2a$l$,\u53ea\u9700\u8981\u627e\u5230\u6700\u8fdc\u7684$r$\u4f7f$\\sum_{i=l}^rb_i<1$\n\n\u800c\u8fd9\u53c8\u5177\u6709\u5355\u8c03\u6027,\u90a3\u4e48$\\mathcal{O(n)}$\u5c31\u53ef\u4ee5\u89e3\u51b3\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1000011;\nint n;\ndb p[N],b[N];\nint main(){\n    in(n);\n    int x,r=0;\n    db ans=0,A=1,B=0;\n    Fur(i,1,n)in(x),p[i]=(db)x/1e6,ans=MAX(ans,p[i]);\n    Fur(l,1,n){\n        while(r<n&&B<1){\n            ++r;\n            B+=p[r]/(1.0-p[r]);\n            A*=(1.0-p[r]);\n        }\n        ans=MAX(ans,A*B);\n        A/=(1.0-p[l]);B-=p[l]/(1.0-p[l]);\n    }\n    printf(\"%d\\n\",int(ans*1e6));\n}\n```\n", "link": "/posts/LG 5242 [USACO19FEB]Cow-Dating/", "tags": ["\u6982\u7387", "\u51b3\u7b56\u5355\u8c03\u6027", "\u53cc\u6307\u9488", "\u601d\u7ef4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3961 [TJOI2013]\u9ec4\u91d1\u77ff\u5de5", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3961&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3961\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6309\u659c\u7387\u5efa\u56fe\n\n\u7136\u540e\u8dd1\u80cc\u5305\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=211;\nint n,T,f[40001];\nstruct node{\n    int x,y,t,v;\n}a[N];\nbool chk(node i,node j){\n    return i.x*j.y==i.y*j.x;\n}\nbool cmp(node i,node j){\n    return chk(i,j)?(i.y<j.y):((1.0*i.x/i.y)<(1.0*j.x/j.y));\n}\nstruct NODE{int t,v;};\nvector<NODE>e[N];\nint main(){\n    in(n,T);\n    int tot=0;\n    Fur(i,1,n)in(a[i].x,a[i].y,a[i].t,a[i].v);\n    sort(a+1,a+n+1,cmp);\n    Fur(i,1,n){\n        bool ff=0;\n        if(!chk(a[i],a[i-1])||i==1)++tot,ff=1;\n        e[tot].push_back({a[i].t+(ff?0:e[tot][e[tot].size()-1].t),a[i].v+(ff?0:e[tot][e[tot].size()-1].v)});\n    }\n    Fur(i,1,tot){\n        Fdr(j,T,e[i][0].t){\n            int tt=f[j];\n            for(auto k:e[i])\n                if(j>=k.t)tt=MAX(tt,f[j-k.t]+k.v);\n            f[j]=tt;\n        }\n    }\n    printf(\"%d\\n\",f[T]);\n}\n```\n", "link": "/posts/LG 3961 [TJOI2013]\u9ec4\u91d1\u77ff\u5de5/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5efa\u56fe", "\u80cc\u5305"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1036D Vasya-and-Arrays", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1036D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1036D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u82e5$A,B$\u603b\u548c\u4e0d\u76f8\u540c,\u663e\u7136\u662f-1\n\n\u7531\u4e8e\u5143\u7d20\u90fd\u5927\u4e8e0,\u53ef\u4ee5\u4f7f\u7528\u7c7b\u4f3c\u53cc\u6307\u9488\u7684\u65b9\u6cd5\n\n\u4e24\u4e2a\u6307\u9488\u5728$A,B$\u6570\u7ec4\u4e2d\u79fb\u52a8,\u82e5\u627e\u5230$A,B$\u4e2d\u548c\u76f8\u540c\u7684\u4e24\u7aef,\u7b54\u6848\u5c31+1\n\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\n#pragma GCC optimize(3)\n#define ll long long\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\nconst int N=300011;\ninline char gc(){static const int IN_LEN=N*10;static char buf[IN_LEN],*s,*t;return (s==t)&&(t=(s=buf)+fread(buf,1,IN_LEN,stdin)),s==t?-1:*s++;}\ninline void in(int &x){x=0;char c;bool f=0;while((c=gc())<'0'||'9'<c)f^=(c=='-');while('0'<=c&&c<='9')x=x*10+c-48,c=gc();if(f)x=-x;}\nint n,m,a[N],b[N];\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i]);\n    in(m);\n    Fur(i,1,m)in(b[i]);\n    int ans=0,j=1;\n    ll s=0;\n    Fur(i,1,n){\n        s+=a[i];\n        while(s>=b[j]&&j<=m)s-=b[j++];\n        if(!s)++ans;\n    }\n    if(s!=0||j!=m+1)printf(\"-1\\n\");\n    else printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG CF1036D Vasya-and-Arrays/", "tags": ["\u53cc\u6307\u9488", "\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4446 [AHOI2018\u521d\u4e2d\u7ec4]\u6839\u5f0f\u5316\u7b80", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4446&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4446\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ed3\u8bba: \n\n\u628a$x^{\\frac14}$\u5185\u7684\u56e0\u5b50\u7b5b\u6389,\u5269\u4e0b\u7684$x$\u4e00\u5b9a\u662f\u5b8c\u5168\u7acb\u65b9\u6570\u6216\u8005\u4e0d\u53ef\u5316\u7b80\n\n\u8bc1\u660e: \n\n\u82e5\u5b58\u5728$p>x^{\\frac14}$\u4e14$b\\times p^3=x$,\u90a3\u4e48$b>x^{\\frac14}$\u6216$b=1$\n\n$\\because b>x^{\\frac14} \\therefore b\\times p^3 >x$,\u4e0d\u7b26\u5408\n\n$\\therefore b=1$,$x$\u4e3a\u5b8c\u5168\u7acb\u65b9\u6570\n\n\u5b9e\u73b0:\n\n1. \u5148\u7b5b\u51fa$(10^{18})^{\\frac14}(\\approx31650)$\u5185\u7684\u8d28\u6570\n\n2. \u7b5b\u6389$x^{\\frac14}$\u5185\u7684\u56e0\u5b50,\u7b5b\u7684\u8fc7\u7a0b\u4e2d\u7edf\u8ba1\u6709\u6ca1\u6709\u7acb\u65b9\n\n3. \u5224\u65ad$x$\u662f\u4e0d\u662f\u5b8c\u5168\u7acb\u65b9\u6570(pow(x,1.0/3)^3+eps==x\u56db\u820d\u4e94\u5165)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=31650;\nint pri[3500],tot=0;\nbool v[N+11];\nil void ol(){\n    Fur(i,2,N){\n        if(!v[i])pri[++tot]=i;\n        Fur(j,1,tot){\n            if(i*pri[j]>N)break;\n            v[i*pri[j]]=1;\n            if(i%pri[j]==0)break;\n        }\n    }\n}\nint main(){\n    ol();\n    int n;\n    ll x,ans,t;\n    in(n);\n    while(n--){\n        in(x);\n        ans=1;\n        Fur(i,1,tot){\n            if(pri[i]>x)break;\n            int tt=0;\n            while(x%pri[i]==0){\n                x/=pri[i];\n                if(++tt==3)ans*=pri[i],tt=0;\n            }\n        }\n        t=(ll)(pow(x,1.0/3)+0.000000005);\n        if(t*t*t==x)ans*=t;\n        out(ans,ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 4446 [AHOI2018\u521d\u4e2d\u7ec4]\u6839\u5f0f\u5316\u7b80/", "tags": ["\u6570\u8bba", "\u7b5b\u6cd5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4447 [AHOI2018\u521d\u4e2d\u7ec4]\u5206\u7ec4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4447&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4447\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u6392\u5e8f\n\n\u4ece\u5c0f\u5230\u5927\u6dfb\u52a0\n\n\u5982\u679c\u6709\u4ee5$a_i-1$\u7684\u7ec4,\u90a3\u4e48$a_i$\u5fc5\u7136\u6dfb\u52a0\u5728\u76ee\u524d\u4ee5$a_i-1$\u7ed3\u5c3e\u7684\u7ec4\u7684\u672b\u5c3e\n\n\u5426\u5219\u65b0\u5efa\u4e00\u4e2a\u7ec4\n\n\u53ef\u4ee5\u4f7f\u7528 **\u6876+\u5806** \u5b9e\u73b0\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#include<bits/extc++.h>\nconst int N=100011;\nint n,a[N];\nstd::priority_queue<int,std::vector<int>,std::greater<int>>q[N];\n__gnu_pbds::cc_hash_table<int,int>T;\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",&a[i]);\n    std::sort(a+1,a+n+1);\n    int t=0;\n    for(int i=1;i<=n;++i){\n        if(!T[a[i]])T[a[i]]=++t;\n        if(q[T[a[i]-1]].empty())q[T[a[i]]].push(1);\n        else q[T[a[i]]].push(q[T[a[i]-1]].top()+1),q[T[a[i]-1]].pop();\n    }\n    int ans=n;\n    for(int i=1;i<=t;++i)if(!q[i].empty())ans=std::min(ans,q[i].top());\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 4447 [AHOI2018\u521d\u4e2d\u7ec4]\u5206\u7ec4/", "tags": ["\u6392\u5e8f", "\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF545E Paths-and-Trees", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF545E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF545E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6700\u77ed\u8def\u677e\u5f1b\u7684\u6bd4\u8f83\u65b9\u5f0f\u53d8\u4e3a$d_x+w\\le d_{to}$\n\n\u8bb0\u5f97**long long**\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=300011;\n#define int ll\nint n,m,st,cnt=0,head[N],d[N],pre[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<1];\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n}\nstruct node{\n    int x,d;\n    bool operator<(node t)const{\n        return d>t.d;\n    }\n};\npriority_queue<node>q;\nbool v[N];\nil void dij(){\n    clr(d,126);\n    d[st]=0;q.push(node{st,0});\n    while(!q.empty()){\n        int x=q.top().x,len=q.top().d;q.pop();\n        if(v[x])continue;\n        v[x]=1;\n        fl(i,x)if(len+e[i].w<=d[to]){\n            d[to]=len+e[i].w;pre[to]=i;\n            if(!v[to])q.push(node{to,d[to]});\n        }\n    }\n}\nsigned main(){\n    in(n,m);\n    int x,y,w,ans=0;\n    Fur(i,1,m)in(x,y,w),add(x,y,w),add(y,x,w);\n    in(st);\n    dij();\n    Fur(i,1,n)if(i!=st)\n        ans+=e[pre[i]].w;\n    out(ans,ln);\n    Fur(i,1,n)if(i!=st)\n        out((pre[i]+1)>>1,\" \");\n    flush();\n}\n```\n", "link": "/posts/LG CF545E Paths-and-Trees/", "tags": ["\u6700\u77ed\u8def", "\u751f\u6210\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3718 [AHOI2017\u521d\u4e2d\u7ec4]alter", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3718&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3718\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,k;\nchar ch[N];\nil bool chk(int w){\n    int s=0,t=0,la=1;\n    Fur(i,1,n){\n        if(ch[i]!=ch[la])la=i,s=1;\n        else if(++s>w)++t,s=0,la=i+1;\n    }\n    return t<=k;\n}\nint main(){\n    in(n,k),in(ch+1);\n    int p=0;\n    Fur(i,1,n)\n        if((ch[i]=='F')^(i&1))++p;\n    if(p<=k||n-p<=k)return printf(\"1\\n\"),0;\n    int l=2,r=n/k+1,ans=r,m;\n    while(l<=r){\n        m=(l+r)>>1;\n        if(chk(m))ans=m,r=m-1;\n        else l=m+1;\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 3718 [AHOI2017\u521d\u4e2d\u7ec4]alter/", "tags": ["\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4026 [SHOI2008]\u5faa\u73af\u7684\u503a\u52a1", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4026&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4026\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f[k][i][j]$\u8868\u793a\u524d$k$\u79cd\u9762\u503c,$A$\u5269$i$\u5143,$B$\u5269$j$\u5143\u6700\u5c11\u4ea4\u6362\u51e0\u5f20\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=1011;\nint A,B,C,val[7]={0,100,50,20,10,5,1},a[4][7],s[4],cnt[7],f[7][N][N],tot=0;\nint main(){\n    in(A,B,C);\n    Fur(i,1,3)Fur(j,1,6){\n        in(a[i][j]);\n        s[i]+=a[i][j]*val[j];\n        tot+=a[i][j]*val[j];\n        cnt[j]+=a[i][j];\n    }\n\n    clr(f,126);\n    f[0][s[1]][s[2]]=0;\n    int ans=inf;\n    Fur(i,1,6)\n        Fur(j,0,tot)\n            Fur(k,0,tot-j)\n            if(f[i-1][j][k]!=inf)\n                Fur(x1,0,cnt[i])\n                    Fur(x2,0,cnt[i]-x1){\n                        int na=j-(a[1][i]-x1)*val[i],\n                            nb=k-(a[2][i]-x2)*val[i],\n                            x3=cnt[i]-x1-x2;\n                        if(na>=0&&nb>=0&&na+nb<=tot){\n                            int w=ABS(a[1][i]-x1)+ABS(a[2][i]-x2)+ABS(a[3][i]-x3);\n                            f[i][na][nb]=MIN(f[i][na][nb],f[i-1][j][k]+(w>>1));\n                        }\n                    }\n    int s1=s[1]-A+C,s2=s[2]-B+A,s3=s[3]-C+B;\n    if(s1<0||s2<0||s3<0)printf(\"impossible\\n\");\n    else{\n        Fur(i,0,6)ans=f[i][s1][s2];\n        if(ans==inf)printf(\"impossible\\n\");\n        else printf(\"%d\\n\",ans);\n    }\n}\n```\n", "link": "/posts/LG 4026 [SHOI2008]\u5faa\u73af\u7684\u503a\u52a1/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u679a\u4e3e", "\u80cc\u5305"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1209D Cow-and-Snacks", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1209D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1209D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u5bf9$x,y$\u90fd\u770b\u6210\u8fb9\n\n\u5982\u679c\u5f53\u524d$x,y$\u5df2\u7ecf\u8fde\u901a,\u90a3\u4e48\u5f53\u524d\u5ba2\u4eba\u4e00\u5b9a\u4f1a\u60b2\u4f24(\u76f8\u5f53\u4e8e\u52a0\u4e0a$x\\leftrightarrow y$\u540e\u5f62\u6210\u4e86\u73af,\u663e\u7136\u6ca1\u6cd5\u5b9e\u73b0)\n\n\u90a3\u4e48\u7b54\u6848+1\n\n\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u5b9e\u73b0\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=200011;\nint n,m,f[N];\nint gf(int x){return x==f[x]?x:(f[x]=gf(f[x]));}\nint main(){\n    in(n,m);\n    Fur(i,1,n)f[i]=i;\n    int x,y,ans=0;\n    while(m--){\n        in(x,y);\n        if(gf(x)==gf(y))++ans;\n        else f[f[y]]=f[x];\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG CF1209D Cow-and-Snacks/", "tags": ["\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4442 [COCI2017-2018t3]-Portal", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4442&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4442\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u76f4\u63a5\u6309\u7167\u89c4\u5219\u5efa\u56fe\u540e\u8dd1\u6700\u77ed\u8def\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nint n,m,cnt=0,head[511*511],dx[4]={0,1,0,-1},dy[4]={1,0,-1,0},sx,sy,tx,ty,d[511*511];\nchar a[511][511];\nstruct edge{\n    int to,nxt,w;\n}e[511*511*10];\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n}\nil int id(int x,int y){return (x-1)*m+y;}\nstruct cmp{\n    bool operator()(int x,int y){\n        return d[x]>d[y];\n    }\n};\nbool v[511*511];\npriority_queue<int,vector<int>,cmp>q;\nvoid bfs(){\n    d[id(sx,sy)]=1;\n    q.push(id(sx,sy));\n    while(!q.empty()){\n        int x=q.top();q.pop();v[x]=0;\n        fl(i,x)if(d[x]+e[i].w<d[to]||!d[to]){\n            d[to]=d[x]+e[i].w;\n            if(!v[to])v[to]=1,q.push(to);\n        }\n    }\n}\nint main(){\n    in(n,m);\n    Fur(i,1,n)in(a[i]+1);\n    Fur(i,1,n)Fur(j,1,m)\n        if(a[i][j]=='C')sx=i,sy=j;\n        else if(a[i][j]=='F')tx=i,ty=j;\n    Fur(i,1,n)Fur(j,1,m)\n    if(a[i][j]!='#')\n    Fur(t,0,3){\n        int x=i+dx[t],y=j+dy[t];\n        if(x<1||x>n||y<1||y>m||a[x][y]=='#')continue;\n        add(id(i,j),id(x,y),1);\n    }\n    Fur(i,1,n)Fur(j,1,m)\n    if(a[i][j]!='#'){\n        int dis=inf,x,y,tt=0,p[4],tot=0;\n        Fur(t,0,3){\n            x=i,y=j,tt=0;\n            while(a[x][y]!='#'){\n                x+=dx[t],y+=dy[t],++tt;\n                if(x<1||x>n||y<1||y>m){tt=inf;break;}\n            }\n            x-=dx[t],y-=dy[t];\n            if(tt!=inf)dis=MIN(dis,tt),p[tot++]=id(x,y);\n        }\n        if(dis!=inf)\n        Fur(t,0,tot-1)add(id(i,j),p[t],dis);\n    }\n    bfs();\n    if(!d[id(tx,ty)])printf(\"nemoguce\\n\");\n    else printf(\"%d\\n\",d[id(tx,ty)]-1);\n}\n```\n", "link": "/posts/LG 4442 [COCI2017-2018t3]-Portal/", "tags": ["\u6700\u77ed\u8def", "\u56fe\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4396 [AHOI2013]\u4f5c\u4e1a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4396&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4396\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,m,bl[N],blk,a[N],ans[N],ANS[N],v[N],mx=0;\nstruct que{\n    int l,r,a,b,id;\n    il bool operator<(que t)const{\n        return (bl[l]==bl[t.l])?((bl[l]&1)?(r<t.r):(r>t.r)):(l<t.l);\n    }\n}q[N];\nstruct bit{\n    int s[N];\n    il void add(int x,int v){\n        for(int i=x;i<=mx;i+=i&-i)\n            s[i]+=v;\n    }\n    il int get(int x){\n        int res=0;\n        for(int i=x;i;i-=i&-i)\n            res+=s[i];\n        return res;\n    }\n}A,B;\nil void inc(int x){\n    A.add(x,1);\n    if(!v[x]++)B.add(x,1);\n}\nil void dec(int x){\n    A.add(x,-1);\n    if(!--v[x])B.add(x,-1);\n}\nint main(){\n    in(n,m);blk=sqrt(n);\n    Fur(i,1,n)in(a[i]),bl[i]=(i-1)/blk+1;\n    Fur(i,1,m)in(q[i].l,q[i].r,q[i].a,q[i].b),q[i].id=i,mx=MAX(mx,q[i].b);\n    sort(q+1,q+m+1);\n    int l=1,r=0;\n    Fur(i,1,m){\n        while(l<q[i].l)dec(a[l++]);\n        while(r<q[i].r)inc(a[++r]);\n        while(l>q[i].l)inc(a[--l]);\n        while(r>q[i].r)dec(a[r--]);\n        ans[q[i].id]=A.get(q[i].b)-A.get(q[i].a-1);\n        ANS[q[i].id]=B.get(q[i].b)-B.get(q[i].a-1);\n    }\n    Fur(i,1,m)out(ans[i],\" \",ANS[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 4396 [AHOI2013]\u4f5c\u4e1a/", "tags": ["\u83ab\u961f", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1215E Marbles", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1215E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1215E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f[sta]$\u8868\u793a$sta$\u8868\u793a\u7684\u6240\u6709\u989c\u8272\u90fd\u6392\u5217\u5230\u4ece1\u5f00\u59cb\u7684\u76f8\u8fde\u7684\u4e00\u6bb5,\u6700\u5c11\u8981\u591a\u5c11\u6b21\n\n\u8bbe$pre[i][j]$\u8868\u793a\u6240\u6709\u989c\u8272$i$\u524d\u9762\u603b\u5171\u6709\u591a\u5c11\u4e2a\u989c\u8272$j$,\u4e5f\u5c31\u662f\u8bf4\u8981\u5c06\u6240\u6709\u989c\u8272$i$\u79fb\u52a8\u5230\u989c\u8272$j$\u5de6\u8fb9\u8981\u79fb\u52a8\u591a\u5c11\u6b21\n\n\u5373\uff1a$\\sum[y<x,c[x]=i,c[y]=j]$\n\n\n$sta[i]$\u8868\u793a$sta$\u8868\u793a\u7684\u7b2c$i$\u79cd\u989c\u8272\u7684\u72b6\u6001\n\n$f[sta]=\\min{f[sta']+\\sum_{sta[j]=1,sta[k]=0}pre[j][k]}$\n\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=400011;\nint n,c[N],b[22],tot=0,cnt[22];\nll f[1<<21],pre[22][22];\nint main(){\n    in(n);\n    Fur(i,1,n){\n        in(c[i]);\n        if(!b[c[i]])b[c[i]]=tot++;\n    }\n    Fur(i,1,n){\n        Fur(j,0,tot-1)\n            pre[b[c[i]]][j]+=cnt[j];\n        ++cnt[b[c[i]]];\n    }\n    clr(f,126);\n    f[0]=0;\n    Fur(i,1,(1<<tot)-1)\n        Fur(j,0,tot-1)\n        if((i>>j)&1){\n            ll t=0;\n            Fur(k,0,tot-1)if(!((i>>k)&1)&&j!=k)\n                t+=pre[j][k];\n            f[i]=MIN(f[i],f[i^(1<<j)]+t);\n        }\n    printf(\"%lld\\n\",f[(1<<tot)-1]);\n}\n```\n", "link": "/posts/LG CF1215E Marbles/", "tags": ["\u9006\u5e8f\u5bf9", "\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1401 \u57ce\u5e02", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1401&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1401\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u770b\u5230**\u8fb9\u4e0d\u80fd\u91cd\u590d\u7528**,$n\\le 200,T\\le 200$\u5c31\u53ef\u4ee5\u60f3\u5230\u7f51\u7edc\u6d41\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=211,M=40011;\nint n,m,T,cnt=1,head[N],q[N],d[N];\nstruct node{\n    int x,y,w;\n    bool operator<(node t)const{\n        return w<t.w;\n    }\n}E[M];\nstruct edge{int to,nxt,w;}e[M<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=1;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;e[cnt].w=0;\n}\nbool bfs(){\n    clr(d,0);\n    int h=0,t=1,x;\n    q[0]=1;d[1]=1;\n    while(h<t){\n        x=q[h++];if(x==n)return 1;\n        fl(i,x)if(e[i].w&&!d[to])\n            d[to]=d[x]+1,q[t++]=to;\n    }\n    return 0;\n}\nint dfs(int x,int mf){\n    if(x==n||!mf)return mf;\n    int us=0,w;\n    fl(i,x)if(e[i].w&&d[to]==d[x]+1){\n        w=dfs(to,MIN(e[i].w,mf-us));\n        e[i].w-=w;\n        e[i^1].w+=w;\n        us+=w;\n        if(us==mf)return mf;\n    }\n    if(!us)d[x]=-1;\n    return us;\n}\nint main(){\n    in(n,m,T);\n    Fur(i,1,m)in(E[i].x,E[i].y,E[i].w);\n    sort(E+1,E+m+1);\n    Fur(i,1,m){\n        add(E[i].x,E[i].y);add(E[i].y,E[i].x);\n        while(E[i].w==E[i+1].w&&i<m)++i,add(E[i].x,E[i].y),add(E[i].y,E[i].x);\n        while(bfs())T-=dfs(1,inf);\n        if(T<=0)return printf(\"%d\\n\",E[i].w),0;\n    }\n}\n```\n", "link": "/posts/LG 1401 \u57ce\u5e02/", "tags": ["\u4e8c\u5206", "bfs", "\u7f51\u7edc\u6d41"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4886 \u5feb\u9012\u5458", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4886&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4886\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u94a6\u5b9a\u6811\u7684\u91cd\u5fc3\u5904\u7406\u51fa\u7b54\u6848\n\n\u82e5\u5f53\u524d\u70b9\u662f\u8ddd\u79bb\u6700\u5927\u70b9\u5bf9\u7684lca(\u5373\u5728\u5b83\u4eec\u4e4b\u95f4\u7684\u8def\u5f84\u4e0a),\u8fd9\u4e2a\u70b9\u5c31\u662f\u6700\u4f18\u7684\n\n\u5426\u5219\u6700\u4f18\u7b54\u6848\u4e00\u5b9a\u5728\u6700\u5927\u70b9\u5bf9\u7684lca\u7684\u5b50\u6811\u4e2d\n\n\u6bcf\u6b21\u90fd\u9009\u6811\u7684\u91cd\u5fc3\u6765\u5904\u7406,\u6700\u591a\u9700\u8981\u5904\u7406$\\log n$\u6b21,\u603b\u590d\u6742\u5ea6$\\Theta(n \\log n)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,m,cnt=0,head[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<1];\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n}\nint siz[N],ans=inf,rt=0,mxs=inf,SZ,d[N],U[N],V[N],q[N],bl[N];\nbool v[N];\nvoid frt(int x,int f){\n    siz[x]=1;\n    int res=0;\n    fl(i,x)if(!v[to]&&to!=f){\n        frt(to,x);\n        siz[x]+=siz[to];\n        res=MAX(res,siz[to]);\n    }\n    res=MAX(res,SZ-siz[x]);\n    if(res<mxs)rt=x,mxs=res;\n}\nvoid gd(int x,int f,int BL){\n    bl[x]=BL;\n    fl(i,x)if(to!=f)d[to]=d[x]+e[i].w,gd(to,x,BL);\n}\nil void op(){\n    cout<<ans<<endl;\n    exit(0);\n}\nvoid sol(int x){\n    if(v[x])op();\n    v[x]=1;d[x]=0;\n    fl(i,x)d[to]=e[i].w,gd(to,x,to);\n    int mx=0,len=0,las=0;\n    Fur(i,1,m)\n        if(d[U[i]]+d[V[i]]>mx)mx=d[U[i]]+d[V[i]],q[len=1]=i;\n        else if(d[U[i]]+d[V[i]]==mx)q[++len]=i;\n    ans=MIN(ans,mx);\n    Fur(i,1,len){\n        if(bl[U[q[i]]]!=bl[V[q[i]]])op();\n        if(!las)las=bl[U[q[i]]];\n        if(bl[U[q[i]]]!=las)op();\n    }\n    mxs=inf,SZ=siz[las];frt(las,0);sol(rt);\n}\nint main(){\n    in(n,m);\n    int x,y,w;\n    Fur(i,2,n)in(x,y,w),add(x,y,w),add(y,x,w);\n    Fur(i,1,m)in(U[i],V[i]);\n    SZ=n,mxs=inf;\n    frt(1,0);\n    sol(rt);\n    op();\n}\n```\n", "link": "/posts/LG 4886 \u5feb\u9012\u5458/", "tags": ["\u6811\u94fe\u5256\u5206", "\u5206\u6cbb", "\u70b9\u5206\u6cbb", "\u6811\u7684\u91cd\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF825G Tree-Queries", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF825G&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF825G\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u53ef\u4ee5\u7b2c\u4e00\u6b21\u4fee\u6539\u7684\u65f6\u5019\u5c31\u7528\u7b2c\u4e00\u4e2a\u9ed1\u70b9\u5efa\u6811,\u53ef\u4ee5\u9884\u5904\u7406\u51fa$a_i$\u8868\u793a$i$\u5230\u6839\u8282\u70b9\u8def\u5f84\u4e0a\u70b9\u7f16\u53f7\u7684\u6700\u5c0f\u503c\n\n\u6211\u4eec\u8003\u8651\u63a5\u4e0b\u6765\u5c06\u4e00\u4e2a\u70b9$x$\u53d8\u4e3a\u9ed1\u70b9\u5bf9\u5176\u4ed6\u70b9\u7684\u5f71\u54cd\uff1a\n\n\u663e\u7136$x$\u53d8\u6210\u9ed1\u70b9\u5bf9\u5b83\u7684\u5b50\u6811\u5185\u7684\u70b9\u7684\u7b54\u6848\u6ca1\u6709\u5f71\u54cd\n\n\u5bf9\u5b50\u6811\u5916\u7684\u5f71\u54cd\uff1a\n\n\u5b50\u6811\u5916\u7684\u70b9\u53ef\u4ee5\u901a\u8fc7\u6839\u5230\u8fbe$x$,\u53ef\u4ee5\u8bb0\u5f55\u4e00\u4e2a\u503c$t$\u8868\u793a\u6839\u80fd\u5230\u9ed1\u70b9\u7684\u6240\u6709\u8def\u5f84\u4e0a\u503c\u7684\u70b9\u7684\u6700\u5c0f\u7f16\u53f7\n\n\u67e5\u8be2\u65f6\u7b54\u6848\u5c31\u662f$\\min(a_x,t)$\n\n\u81ea\u5df1\u753b\u4e2a\u56fe\u5c31\u61c2\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1000011\nint n,head[N],cnt=0,a[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x,int d){\n    a[x]=d;\n    fl(i,x)if(!a[to])dfs(to,MIN(d,to));\n}\nint main(){\n    int q,opt,x,y,la=0,tt=inf;\n    in(n,q);\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    in(y,x);\n    x=x%n+1;\n    dfs(x,x);\n    while(--q){\n        in(opt,x);\n        x=(la+x)%n+1;\n        if(opt==1)tt=MIN(tt,a[x]);\n        else out(la=MIN(tt,a[x]),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF825G Tree-Queries/", "tags": ["dfs", "\u601d\u7ef4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF893F Subtree-Minimum-Query", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF893F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF893F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\ndfs\u5e8f\u4f5c\u4e3a\u4e0b\u6807,\u6df1\u5ea6\u4f5c\u4e3a\u65f6\u95f4\u8f74\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\n#define int ll\nint n,q,cnt=0,head[N],c[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint s[N*30],ls[N*30],rs[N*30],sz=0,rt[N];\nvoid build(int l,int r,int &x){\n    s[x=++sz]=inf;\n    if(l==r)return;\n    int m=(l+r)>>1;\n    build(l,m,ls[x]);build(m+1,r,rs[x]);\n}\nvoid ins(int p,int v,int l,int r,int &x,int pre){\n    x=++sz;\n    ls[x]=ls[pre];\n    rs[x]=rs[pre];\n    if(l==r){\n        s[x]=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    if(p<=m)ins(p,v,l,m,ls[x],ls[pre]);\n    else ins(p,v,m+1,r,rs[x],rs[pre]);\n    s[x]=MIN(s[ls[x]],s[rs[x]]);\n}\nint ask(int L,int R,int l,int r,int x){\n    if(L<=l&&r<=R)return s[x];\n    int m=(l+r)>>1,ans=inf;\n    if(L<=m)ans=ask(L,R,l,m,ls[x]);\n    if(R>m)ans=MIN(ans,ask(L,R,m+1,r,rs[x]));\n    return ans;\n}\nint st[N],ed[N],dfn=0,d[N],mxd=0;\nvoid dfs(int x,int f){\n    d[x]=d[f]+1;mxd=MAX(mxd,d[x]);\n    st[x]=++dfn;\n    fl(i,x)if(to!=f)dfs(to,x);\n    ed[x]=dfn;\n}\nvoid bfs(){\n    queue<int>q;q.push(1);\n    build(1,n,rt[0]);\n    int x,ld=0,pre;\n    while(!q.empty()){\n        x=q.front();q.pop();\n        if(d[x]!=ld)pre=rt[d[x]-1];\n        else pre=rt[d[x]];\n        ins(st[x],c[x],1,n,rt[d[x]],pre);\n        fl(i,x)if(d[to]>d[x])q.push(to);\n        ld=d[x];\n    }\n}\nsigned main(){\n    in(n,q);\n    Fur(i,1,n)in(c[i]);\n    int x,y,la=0;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    dfs(1,0);\n    bfs();\n    while(q--){\n        in(x,y);\n        x=(x+la)%n+1;\n        y=(y+la)%n;\n        la=ask(st[x],ed[x],1,n,rt[MIN(d[x]+y,mxd)]);\n        out(la,ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF893F Subtree-Minimum-Query/", "tags": ["\u4e3b\u5e2d\u6811", "dfs\u5e8f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG AT2442 \u30d5\u30a7\u30fc\u30f3\u73fe\u8c61", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/AT2442&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/AT2442\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\n#define int ll\nint n,q,s,t,a[N];\nint qwq(int x){\n    if(x>0)return -x*s;\n    else return -x*t;\n}\nsigned main(){\n    in(n,q,s,t);\n    int l,r,v,la,ans=0;\n    in(la);\n    Fur(i,1,n)in(v),ans+=qwq(a[i]=v-la),la=v;\n    while(q--){\n        in(l,r,v);\n        ans-=qwq(a[l]);\n        ans+=qwq(a[l]+=v);\n        if(r!=n){\n            ans-=qwq(a[r+1]);\n            ans+=qwq(a[r+1]-=v);\n        }\n        out(ans,ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG AT2442 \u30d5\u30a7\u30fc\u30f3\u73fe\u8c61/", "tags": ["\u5dee\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF940F Machine-Learning", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF940F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF940F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011;\nint n,q,a[N],blk;\nstruct que{\n    int l,r,bl,br,id;\n}Q[N];\nvoid inc(int x){\n\n}\nvoid dec(int x){\n\n}\nint main(){\n    in(n,q);\n    blk=sqrt(n);\n    Fur(i,1,n)in(a[i]);\n    Fur(i,1,q){\n\n    }\n}\n```\n", "link": "/posts/LG CF940F Machine-Learning/", "tags": ["\u5e26\u4fee\u83ab\u961f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4767 [IOI2000]\u90ae\u5c40", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4767&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4767\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f[i][j]$\u8868\u793a\u524d$i$\u4e2a\u5206$j$\u4e2a\u90ae\u5c40\n\n$f[i][j]=\\min(f[x][j-1]+w[x+1][i])$\n\n\u6ee1\u8db3\u51b3\u7b56\u5355\u8c03\u6027\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 3011\nint n,m,a[N],k[N][N];\nll w[N][N],f[311][N];\nint main(){\n    in(n,m);\n    Fur(i,1,n)in(a[i]);\n    sort(a+1,a+n+1);\n    Fur(i,1,n)\n        Fur(j,i+1,n)\n            w[i][j]=w[i][j-1]+a[j]-a[(i+j)>>1];\n    Fur(i,1,n)f[1][i]=w[1][i],k[1][i]=0;\n    Fur(i,2,m){\n        k[i][n+1]=n;\n        Fdr(j,n,i+1){\n            f[i][j]=1ll<<60;\n            Fur(x,k[i-1][j],k[i][j+1])\n            if(f[i-1][x]+w[x+1][j]<f[i][j]){\n                f[i][j]=f[i-1][x]+w[x+1][j];\n                k[i][j]=x;\n            }\n        }\n    }\n    cout<<f[m][n]<<endl;\n}\n```\n", "link": "/posts/LG 4767 [IOI2000]\u90ae\u5c40/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP10707 COT2", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP10707&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP10707\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nCount-on-a-tree-II\ntop: 0\n\n\u6811\u4e0a\u83ab\u961f\u6a21\u677f\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=40011,M=100011;\nint n,cnt=0,head[N],val[N],old[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint T[N*2],dfn=0,st[N],ed[N],top[N],siz[N],f[N],d[N];\nvoid dfs(int x){\n    T[st[x]=++dfn]=x;\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n    T[ed[x]=++dfn]=x;\n}\nvoid bt(int x,int tp){\n    top[x]=tp;\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nil int lca(int x,int y){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        x=f[top[x]];\n    }\n    return d[x]<d[y]?x:y;\n}\nint blk,bl[N<<1];\nstruct que{\n    int l,r,lca,id;\n    il bool operator<(que t)const{\n        return (bl[l]==bl[t.l])?((bl[l]&1)?r<t.r:r>t.r):(l<t.l);\n    }\n}Q[M];\nint ans=0,c[N],ANS[M];\nbool v[N];\nil void inc(int x){ans+=!c[val[x]]++;}\nil void dec(int x){ans-=!--c[val[x]];}\nil void op(int x){\n    v[x]?dec(x):inc(x);\n    v[x]^=1;\n}\nstruct node{\n    int v,p;\n    il bool operator<(node t)const{\n        return v<t.v;\n    }\n}a[N];\nint main(){\n    int q,x,y,l=1,r=0;\n    in(n,q);\n    blk=n*2/sqrt(q*2/3);\n    Fur(i,1,n*2)bl[i]=(i-1)/blk+1;\n    Fur(i,1,n)in(a[i].v),a[i].p=i;\n    sort(a+1,a+n+1);\n    int tt=0;\n    Fur(i,1,n)old[val[a[i].p]=(tt+=a[i].v!=a[i-1].v)]=a[i].v;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    dfs(1);bt(1,1);\n    Fur(i,1,q){\n        in(x,y);\n        if(st[x]>st[y])SWAP(x,y);\n        int t=lca(x,y);\n        if(t==x)Q[i]=que{st[x],st[y],0,i};\n        else Q[i]=que{ed[x],st[y],t,i};\n    }\n    sort(Q+1,Q+q+1);\n    Fur(i,1,q){\n        while(l>Q[i].l)op(T[--l]);\n        while(r<Q[i].r)op(T[++r]);\n        while(l<Q[i].l)op(T[l++]);\n        while(r>Q[i].r)op(T[r--]);\n        if(Q[i].lca)op(Q[i].lca);\n        ANS[Q[i].id]=ans;\n        if(Q[i].lca)op(Q[i].lca);\n    }\n    Fur(i,1,q)out(ANS[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG SP10707 COT2/", "tags": ["\u6811\u4e0a\u83ab\u961f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP10628 COT Count-on-a-tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP10628&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP10628\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6a21\u677f\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,cnt=0,head[N],val[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint RT[N*20],s[N*20],sz=0,ls[N*20],rs[N*20];\nvoid ins(int l,int r,int p,int &x,int pre){\n    s[x=++sz]=s[pre]+1;\n    if(l==r)return;\n    ls[x]=ls[pre];\n    rs[x]=rs[pre];\n    int m=(l+r)>>1;\n    if(p<=m)ins(l,m,p,ls[x],ls[pre]);\n    else ins(m+1,r,p,rs[x],rs[pre]);\n}\nint ask(int k,int l,int r,int x,int y,int lca,int ff){\n    if(l==r)return l;\n    int m=(l+r)>>1,sum=s[ls[x]]+s[ls[y]]-s[ls[lca]]-s[ls[ff]];\n    if(sum>=k)return ask(k,l,m,ls[x],ls[y],ls[lca],ls[ff]);\n    else return ask(k-sum,m+1,r,rs[x],rs[y],rs[lca],rs[ff]);\n}\nint top[N],f[N],d[N],siz[N];\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        d[to]=d[x]+1;\n        f[to]=x;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;ins(1,n,val[x],RT[x],RT[f[x]]);\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint glca(int x,int y){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        x=f[top[x]];\n    }\n    return d[x]<d[y]?x:y;\n}\nstruct node{\n    int v,p;\n    bool operator<(node x)const{\n        return v<x.v;\n    }\n}a[N];\nint old[N];\nint main(){\n    int x,y,k,q;\n    in(n,q);\n    Fur(i,1,n)in(a[i].v),a[i].p=i;\n    sort(a+1,a+n+1);\n    int tt=0;\n    Fur(i,1,n)old[val[a[i].p]=(tt+=a[i].v!=a[i-1].v)]=a[i].v;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    dfs(1);bt(1,1);\n    while(q--){\n        in(x,y,k);\n        int lca=glca(x,y);\n        out(old[ask(k,1,n,RT[x],RT[y],RT[lca],RT[f[lca]])],ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG SP10628 COT Count-on-a-tree/", "tags": ["\u6811\u94fe\u5256\u5206", "\u4e3b\u5e2d\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3531 [POI2012]LIT-Letters", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3531&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3531\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u770b\u5230\u4ea4\u6362\u76f8\u90bb\u5b57\u6bcd,\u5c31\u60f3\u5230\u9006\u5e8f\u5bf9\n\n\u8003\u8651\u4e00\u4e0b,\u4e00\u5b9a\u662f\u5c06A\u7684\u6bcf\u4e2a\u5b57\u6bcd\u79fb\u52a8\u5230\u79bb\u5b83\u6700\u8fd1\u7684B\u4e2d\u76f8\u540c\u5b57\u6bcd\u7684\u4f4d\u7f6e\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u8bb2\u4f4d\u7f6e\u5b58\u8d77\u6765\u7136\u540e\u5904\u7406\u4e00\u4e0b\n\n\u4e4b\u540e\u6570\u7ec4\u53d8\u6210\u4e86A\u4e2d\u6bcf\u4e2a\u4f4d\u7f6e\u6700\u540e\u5728B\u4e2d\u7684\u4f4d\u7f6e\n\n\u8fd9\u4e2a\u6570\u7ec4\u4e2d\u9006\u5e8f\u5bf9\u7684\u6570\u76ee\u5c31\u662f\u7b54\u6848\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 1000011\nint n,cnt[30],s[N];\nchar a[N],b[N];\nvector<int>p[30];\nvoid add(int x){\n    for(int i=x;i<=n;i+=i&-i)\n        ++s[i];\n}\nint get(int x){\n    int ans=0;\n    for(int i=x;i;i-=i&-i)\n        ans+=s[i];\n    return ans;\n}\nstruct node{\n    int v,p;\n    bool operator<(node x)const{\n        return v>x.v;\n    }\n}c[N];\nint main(){\n    scanf(\"%d%s%s\",&n,a+1,b+1);\n    for(int i=1;i<=n;++i)p[b[i]-'A'].push_back(i);\n    for(int i=1;i<=n;++i)c[i]={p[a[i]-'A'][cnt[a[i]-'A']++],i};\n    sort(c+1,c+n+1);\n    long long ans=0;\n    for(int i=1;i<=n;++i){\n        ans+=get(c[i].p-1);\n        add(c[i].p);\n    }\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 3531 [POI2012]LIT-Letters/", "tags": ["\u6811\u72b6\u6570\u7ec4", "\u9006\u5e8f\u5bf9"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF915E Physical-Education-Lessons", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF915E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF915E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811\u6a21\u677f\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 15001000\n#define pu s[x]=s[ls[x]]+s[rs[x]]\nint n,q,s[N],ls[N],rs[N],laz[N],sz=0;\nvoid pd(int x,int ln,int rn){\n    if(laz[x]){\n        if(!ls[x])ls[x]=++sz;\n        if(!rs[x])rs[x]=++sz;\n        laz[ls[x]]=laz[rs[x]]=laz[x];\n        s[ls[x]]=ln*(laz[x]-1);s[rs[x]]=rn*(laz[x]-1);\n        laz[x]=0;\n    }\n}\nvoid upd(int L,int R,int v,int l=1,int r=n,int x=1){\n    if(L<=l&&r<=R){\n        if(v==2)s[x]=r-l+1;\n        else s[x]=0;\n        laz[x]=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(x,m-l+1,r-m);\n    if(L<=m)upd(L,R,v,l,m,ls[x]?ls[x]:ls[x]=++sz);\n    if(R>m)upd(L,R,v,m+1,r,rs[x]?rs[x]:rs[x]=++sz);\n    pu;\n}\nint main(){\n    in(n,q);\n    s[sz=1]=n;laz[1]=2;\n    int k,l,r;\n    while(q--){\n        in(l,r,k);\n        upd(l,r,k);\n        out(s[1],ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF915E Physical-Education-Lessons/", "tags": ["\u7ebf\u6bb5\u6811", "\u52a8\u6001\u5f00\u70b9"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1196F K-th-Path", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1196F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1196F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4ed4\u7ec6\u770b\u9898\u610f,\u53d1\u73b0$k$\u6700\u5927\u53ea\u6709$400$\n\n\u89e3\u6cd51\uff1a \u5806 \u8d2a\u5fc3\n\n\u5148\u628a\u548c\u6bcf\u4e2a\u70b9\u76f8\u8fde\u7684\u6240\u6709\u8fb9\u6309\u8fb9\u6743\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u3002\n\n\u8003\u8651\u4e00\u6761\u8def\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9,\u5982\u679c\u8fd9\u4e24\u4e2a\u7aef\u70b9\u95f4\u7684\u8def\u5f84\u7b2c\u4e00\u6b21\u88ab\u5f39\u51fa\uff08\u662f\u4e24\u70b9\u95f4\u6700\u77ed\u8def\uff09,\u5219\u6211\u4eec\u5411\u5176\u4e2d\u4e00\u7aef\u6269\u5c55\u4e00\u6761\u4e0e\u5b83\u76f8\u8fde\u7684\u6700\u77ed\u8fb9\u3002\n\n\u73b0\u5728\u5047\u8bbe\u5806\u9876\u6709\u4e00\u6761\u8def\u5f84$u\\rightarrow v$,\u5b83\u7684\u4e00\u4e2a\u7aef\u70b9$v$\u662f\u7531$u\\rightarrow$\u6269\u5c55\u6765\u7684,\u6b64\u65f6\u6211\u4eec\u53ef\u4ee5\u5c1d\u8bd5\u628a\u4e0e$x$\u76f8\u8fde\u7684\u8fb9\u4e2d\u6bd4$x\\rightarrow v$\u6743\u503c\u7565\u5927\u7684\u53d6\u51fa\u6765\uff08\u5373\u6392\u597d\u5e8f\u540e\u7684\u4e0b\u4e00\u6761\u8fb9\uff09,\u538b\u5230\u5806\u4e2d\u3002\n\n\u56e0\u4e3a\u8981\u5904\u7406\u4e24\u4e2a\u7aef\u70b9\u6bd4\u8f83\u9ebb\u70e6,\u6211\u4eec\u8f6c\u5316\u6210\u6709\u5411\u8def\u5f84\uff08\u53ea\u6709\u4e00\u4e2a\u7aef\u70b9\uff09,\u7136\u540e\u53d6\u7b2c$2k$\u5927\u7684\u3002\n\n\u8bb0\u4f4f\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u7684\u4fe1\u606f\uff1a\u8def\u5f84\u7684\u4e24\u4e2a\u7aef\u70b9$st,ed$,\u7aef\u70b9$ed$\u524d\u9762\u7684\u70b9$x$\uff08\u5373$ed$\u662f\u7531$st\\rightarrow x$\u6269\u5c55\u6765\u7684\uff09,\u4ee5\u53ca\u8fd9\u6761\u8def\u5f84\u7684\u957f\u5ea6\u3002\n\n\u89e3\u6cd52\uff1a floyd\n\n\u8003\u8651\u7b54\u6848\u5e94\u8be5\u5c0f\u4e8e\u7b49\u4e8e\u7b2c$k$\u5c0f\u7684\u8fb9\u7684\u957f\u5ea6\u3002\u56e0\u6b64\u53ea\u6709\u524d$k$\u5c0f\u7684\u8fb9\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u3002\u8fd9$k$\u6761\u8fb9\u6784\u6210\u7684\u5b50\u56fe\u7684\u8282\u70b9\u6570\u4e5f\u662f$O(k)$\u7684,\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u505afloyd\u4e86\u3002\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,m,k;\nstruct edge{\n    int to,w;\n    bool operator<(edge x)const {\n        return w<x.w;\n    }\n};\nvector<edge>e[N];\nstruct node{\n    int x,y,idx;\n    ll v;\n    bool operator<(node a)const{\n        return v>a.v;\n    }\n};\npriority_queue<node>q;\n#include<bits/extc++.h>\nusing namespace __gnu_pbds;\ncc_hash_table<int,bool>b[N];\nsigned main(){\n    in(n,m,k);\n    int x,y,w;\n    Fur(i,1,m)\n        in(x,y,w),\n        e[x].push_back({y,w}),\n        e[y].push_back({x,w});\n    Fur(i,1,n){\n        b[i][i]=1,sort(e[i].begin(),e[i].end());\n        q.push({i,i,0,e[i][0].w});\n    }\n    k<<=1;\n    while(!q.empty()){\n        node t=q.top();q.pop();\n        int x=t.x,y=t.y;\n        if(!b[x][e[y][t.idx].to]){\n            b[x][e[y][t.idx].to]=1;\n            --k;\n            if(!k)return cout<<t.v<<endl,0;\n            q.push({x,e[y][t.idx].to,0,t.v+e[e[y][t.idx].to][0].w});\n        }\n        if(t.idx+1<e[y].size())\n            q.push({x,y,t.idx+1,t.v-e[y][t.idx].w+e[y][t.idx+1].w});\n    }\n}\n```\n", "link": "/posts/LG CF1196F K-th-Path/", "tags": ["\u5806", "\u8d2a\u5fc3", "floyed"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF739B Alyona-and-a-tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF739B&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF739B\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u500d\u589e\u6c42\u51fa\u80fd\u63a7\u5236\u67d0\u4e2a\u70b9$x$\u7684\u6700\u8fdc\u7684\u70b9$y$\u7684\u4f4d\u7f6e\n\n\u5e94\u8be5\u5c06$f_x$\u5230$y$\u7684\u70b9\u7684\u7b54\u6848+1\n\n\u6211\u4eec\u53ef\u4ee5\u5dee\u5206\u4e00\u4e0b,\n\n$++ans_{f_x},--ans_{f_y}$\n\n\u7136\u540e\u4ece\u4e0b\u52a0\u5f97\u5230\u7684\u5c31\u662f\u5f53\u524d\u70b9\u7684\u7b54\u6848\n\n\u8bb0\u5f97\u5f00long long\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,head[N],cnt=0,f[21][N],ans[N];\nll d[N],c[N];\nstruct edge{\n    int to,nxt,w;\n}e[N];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n}\nvoid dfs(int x){\n    Fur(k,1,20)f[k][x]=f[k-1][f[k-1][x]];\n    fl(i,x){\n        d[to]=d[x]+e[i].w;f[0][to]=x;\n        dfs(to);\n        ans[x]+=ans[to];\n    }\n    int now=x;\n    Fdr(k,20,0)\n    if(f[k][now]&&d[x]-d[f[k][now]]<=c[x])\n        now=f[k][now];\n    ++ans[f[0][x]];\n    --ans[f[0][now]];\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(c[i]);\n    int w;\n    Fur(i,2,n)in(f[0][i],w),add(f[0][i],i,w);\n    dfs(1);\n    Fur(i,1,n)out(ans[i],\" \");\n    flush();\n}\n```\n", "link": "/posts/LG CF739B Alyona-and-a-tree/", "tags": ["\u5dee\u5206", "\u500d\u589e", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3587 [POI2015]POD", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3587&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3587\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u8003\u8651\u4e24\u4e2a\u65ad\u70b9\uff08\u8bbe\u4e3a$l,r$)\u7b26\u5408\u7684\u6761\u4ef6\uff1a\n\n\u6bcf\u79cd\u989c\u8272\u7684\u73e0\u5b50\u53ea\u80fd\u51fa\u73b0\u5728\u5176\u4e2d\u4e00\u6761\u94fe\u4e2d\n\n\u4e5f\u5c31\u662f\u82e5$[l,r]$\u4e2d\u51fa\u73b0\u4e86\u67d0\u79cd\u989c\u8272$[l,r]$\u4e5f\u5c31\u5305\u542b\u4e86\u6240\u6709\u7684\u8fd9\u79cd\u989c\u8272\n\n\u6211\u4eec\u53ef\u4ee5\u8bb0\u5f55\u989c\u8272\u51fa\u73b0\u7684\u524d\u7f00\u548c\n\n\u8bb0\u5f55\u524d$i$\u4e2a\u4f4d\u7f6e\u6bcf\u79cd\u989c\u8272\u7684\u51fa\u73b0\u6b21\u6570,\u5982\u679c\u4f4d\u7f6e$i$\u662f \u989c\u8272$a[i]$\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e, \u5c31\u628a\u989c\u8272 $a[i]$ \u7684\u7ed3\u679c\u6e05\u96f6\u3002\n\n\u8fd9\u6837\u82e5\u4e24\u4e2a\u4f4d\u7f6e\u7684\u524d\u7f00\u548c\u76f8\u540c,\u5c31\u662f\u5408\u6cd5\u7684\n\n\u53ef\u4ee5\u901a\u8fc7hash\u6765\u5224\u65ad,\u8bb0\u5f55\u6240\u6709hash\u503c,\u6392\u5e8f\u540e\u7edf\u8ba1\n\n\u4e24\u4e2a\u5206\u5272\u70b9 $l,r$ \u8981\u5c3d\u53ef\u80fd\u6ee1\u8db3 $r\u2212l$ \u63a5\u8fd1 $\\frac n2$\n\n\u53ef\u4ee5\u7528\u7c7b\u4f3c\u53cc\u6307\u9488\u7684\u65b9\u5f0f\u7ef4\u62a4\n\n\u8fd9\u9898\u5361hash,\u8981\u53cchash\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1000011\nint n,k,a[N],b[N],c[N],p1=133331,p2=23333,m1=100000007,m2=19260817,ans=inf;\nll s1[N],s2[N],cnt=0;\nstruct node{\n    int id,s1,s2;\n    bool operator<(node x)const{\n        if(s1!=x.s1)return s1<x.s1;\n        if(s2!=x.s2)return s2<x.s2;\n        return id<x.id;\n    }\n}t[N];\nint main(){\n    in(n,k);\n    s1[0]=s2[0]=1;\n    Fur(i,1,n)\n        in(a[i]),\n        s1[i]=s1[i-1]*p1%m1,\n        s2[i]=s2[i-1]*p2%m2;\n    Fdr(i,n,1)if(!b[a[i]])b[a[i]]=i;\n    ll sum1=0,sum2=0;\n    Fur(i,1,n){\n        ++c[a[i]];\n        sum1=(sum1+s1[a[i]])%m1;\n        sum2=(sum2+s2[a[i]])%m2;\n        if(b[a[i]]==i)\n            sum1=(sum1-s1[a[i]]*c[a[i]]%m1+m1)%m1,\n            sum2=(sum2-s2[a[i]]*c[a[i]]%m2+m2)%m2;\n        t[i]=node{i,sum1,sum2};\n    }\n    sort(t+1,t+n+1);\n    int mid=(n+1)/2;\n    for(int i=1;i<=n;){\n        int nxt=i;\n        while(nxt<=n&&t[nxt].s1==t[i].s1&&t[nxt].s2==t[i].s2)++nxt;\n        cnt+=1ll*(nxt-i)*(nxt-i-1)/2;\n        for(int l=i,r=i;r<nxt;++r){\n            while(l<r&&t[r].id-t[l].id>=mid)++l;\n            int tp=ABS(n-2*(t[r].id-t[l].id));\n            if(l>i){\n                int tmp=ABS(n-2*(t[r].id-t[l-1].id));\n                tp=MIN(tp,tmp);\n            }\n            ans=MIN(ans,tp);\n        }\n        i=nxt;\n    }\n    cout<<cnt<<\" \"<<ans<<endl;\n}\n```\n", "link": "/posts/LG 3587 [POI2015]POD/", "tags": ["hash", "\u8ba1\u6570", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1009F Dominant-Indices", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1009F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1009F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u957f\u94fe\u5256\u5206\u6a21\u677f\n\n\u957f\u94fe\u5256\u5206\u4f18\u5316dp\n\n\u8bbe$f_{x,i}$\u8868\u793a$x$\u5b50\u6811\u5185\u4e0e$x$\u8ddd\u79bb\u4e3a$i$\u7684\u70b9\u7684\u4e2a\u6570\n\n$$\nf_{x,i}= \\sum f_{to,i-1}\n\\\\\\\\\n(f_{x,0}=1)\n$$\n\n\u53ef\u4ee5\u53d1\u73b0$x$\u4ece\u5b83\u7684\u513f\u5b50\u7ee7\u627f\u7b54\u6848\n\n\u8fd9\u65f6\u5c31\u53ef\u4ee5\u7528\u957f\u94fe\u5256\u5206\u4f18\u5316dp\u4e86(\u4e00\u79cd\u7c7b\u4f3c$\\text{dsu on tree}$\u7684\u65b9\u6cd5)\n\n\u8bbe$len_x$\u4e3a$x$\u5230\u53f6\u8282\u70b9\u7684\u6700\u957f\u8ddd\u79bb\n\n\u6211\u4eec\u5c06$\\max len_{to}$\u8bbe\u4e3a$x$\u7684\u91cd\u513f\u5b50\n\n$x$\u76f4\u63a5\u7ee7\u627f\u91cd\u513f\u5b50\u7684\u7b54\u6848,\u800c\u4e0d\u7528\u91cd\u65b0\u518d\u7b97\u4e00\u6b21\n\n\u5176\u4ed6\u7684\u513f\u5b50\u518d\u6309\u666e\u901a\u65b9\u5f0f\u8ba1\u7b97\n\n\u56e0\u4e3a\u6bcf\u6761\u94fe\u53ea\u4f1a\u88ab\u5408\u5e76\u4e00\u6b21,\u56e0\u6b64\u603b\u590d\u6742\u5ea6\u5c31\u662f$\\Theta(n)$\uff01\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1000011\nint n,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint len[N],son[N],ans[N],tmp[N],*f[N],*id=tmp;\nvoid dfs(int x,int fa){\n    fl(i,x)if(to!=fa){\n        dfs(to,x);\n        if(len[to]>len[son[x]])son[x]=to;\n    }\n    len[x]=len[son[x]]+1;\n}\nvoid dp(int x,int fa){\n    f[x][0]=1;\n    if(son[x])f[son[x]]=f[x]+1,dp(son[x],x),ans[x]=ans[son[x]]+1;\n    /*\n    \u6709\u91cd\u513f\u5b50\n\n    len_x=len_{son_x}+1 , \u6240\u4ee5\u628a\u540e\u9762\u7684\u7a7a\u95f4\u76f4\u63a5\u5f00\u7ed9son_x\n\n    \u8ba1\u7b97\u5b8c\u91cd\u513f\u5b50x\u5c31\u53ef\u4ee5\u76f4\u63a5\u7ee7\u627f\u4e86\n\n    \u5f53\u7136\u7b54\u6848\u7684\u6df1\u5ea6+1\n\n    */\n    fl(i,x)if(to!=fa&&to!=son[x]){\n        f[to]=id;id+=len[to];dp(to,x);\n        //\u5176\u4ed6\u513f\u5b50\u66b4\u529b\u8ba1\u7b97\n        Fur(j,1,len[to]){\n            f[x][j]+=f[to][j-1];\n            if(j<ans[x]&&f[x][j]>=f[x][ans[x]]||(j>ans[x]&&f[x][j]>f[x][ans[x]]))ans[x]=j;\n        }\n    }\n    if(f[x][ans[x]]==1)ans[x]=0;\n}\nint main(){\n    in(n);\n    int x,y;\n    Fur(i,1,n-1){\n        in(x,y);\n        add(x,y),add(y,x);\n    }\n    dfs(1,0);\n    f[1]=id;id+=len[1];//\u5206\u914dlen_1\u7684\u7a7a\u95f4\u7ed91\u8ba1\u7b97\n    dp(1,0);\n    Fur(i,1,n)out(ans[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG CF1009F Dominant-Indices/", "tags": ["\u957f\u94fe\u5256\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1646 [\u56fd\u5bb6\u96c6\u8bad\u961f]happiness", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1646&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1646\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u603b\u548c\u51cf\u53bb\u6700\u5c0f\u5272\u5373\u4e3a\u7b54\u6848\n\n\u6700\u5c0f\u5272\u5220\u6389\u7684\u8fb9\u5c31\u662f\u8981\u51cf\u53bb\u7684\u503c,\u8fd9\u6837\u5c31\u53ef\u4ee5\u6700\u5c0f\u5316\u8981\u51cf\u53bb\u7684\u503c,\u5373\u7b54\u6848\u6700\u5927\u5316\n\n\u90a3\u6211\u4eec\u5982\u4f55\u6784\u9020\u8fd9\u5f20\u56fe\u5462?\n\n1. $ST \\xrightarrow{\\text{\u9009\u6587\u79d1\u7684\u503c}} (i,j) \\xrightarrow{\\text{\u9009\u7406\u79d1\u7684\u503c}}ED$\n   \n2. $ST \\xrightarrow{\\text{\u540c\u65f6\u9009\u6587\u79d1\u7684\u989d\u5916\u5feb\u4e50}}new,new\\rightarrow(i,j),new\\rightarrow(i+1,j)$(\u5176\u4ed6\u540c\u7406)\n   \n3. $(i,j)\\rightarrow new,(i+1,j)\\rightarrow new,new \\xrightarrow{\\text{\u540c\u65f6\u9009\u7406\u79d1\u7684\u989d\u5916\u5feb\u4e50}}ED$(\u5176\u4ed6\u540c\u7406)\n\n\u6bcf\u4e2a\u70b9\u53ea\u80fd\u9009\u62e9\u6587\u79d1\u6216\u7406\u79d1,\u5f53\u67d0\u4e2a\u70b9\u9009\u62e9\u4e86\u6587\u79d1,\u90a3\u4e48\u5b83\u5411\u7406\u79d1(ED)\u7684\u8fb9\u90fd\u5e94\u8be5\u8981\u88ab\u65ad\u5f00\u3002\n\n\u5b83\u76f4\u63a5\u8fde\u5411ED\u7684\u8fb9\u3001\u5b83\u548c\u522b\u7684\u70b9\u7ec4\u5408\u8fde\u5411ED\u7684\u8fb9\u90fd\u8981\u5207\u65ad\n\n\u8fd9\u4e9b\u8fb9\u7684\u6743\u503c\u5c31\u4f1a\u4ece\u6700\u7ec8\u7b54\u6848\u4e2d\u51cf\u53bb\n\n<svg width=\"701px\" height=\"701px\"><g><g><g><path d=\"M 366.42685126423726 297.01122406350703 L 69.59851319063789 367.32614574153\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 366.42685126423726 297.01122406350703 L 69.59851319063789 367.32614574153\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"203.08299255371094\" y=\"319.824951171875\">inf</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (88.18415832519531 362.9234313964844) rotate(166.6733220082538)\"></path></g><g><path d=\"M 366.42685126423726 297.01122406350703 L 662 359.99965163378397\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 366.42685126423726 297.01122406350703 L 662 359.99965163378397\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"529.1431274414062\" y=\"316.16168212890625\">inf</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (643.3194580078125 356.01873779296875) rotate(12.029297457258082)\"></path></g><g><path d=\"M 364.74554582466936 69.59851319063789 L 366.42685126423726 297.01122406350703\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 364.74554582466936 69.59851319063789 L 366.42685126423726 297.01122406350703\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"408.093994140625\" y=\"183.20348001051042\">\u540c\u65f6\u9009\u6587\u79d1</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (366.28564453125 277.9117431640625) rotate(89.57713222549252)\"></path></g><g><path d=\"M 662 359.99965163378397 L 367.32129017837025 661.8540224083981\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 662 359.99965163378397 L 367.32129017837025 661.8540224083981\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"487.15283203125\" y=\"498.22804661328314\">\u9009\u7406\u79d1</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (380.59375 648.2583618164062) rotate(134.3112058351374)\"></path></g><g><path d=\"M 364.74554582466936 69.59851319063789 L 662 359.99965163378397\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 364.74554582466936 69.59851319063789 L 662 359.99965163378397\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"540.880615234375\" y=\"201.12721252441406\">\u9009\u6587\u79d1</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (648.3377075195312 346.65234375) rotate(44.329078091112564)\"></path></g><g><path d=\"M 366.16238212372537 450.0657305441708 L 367.32129017837025 661.8540224083981\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 366.16238212372537 450.0657305441708 L 367.32129017837025 661.8540224083981\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"409.2496643066406\" y=\"555.888781785965\">\u540c\u65f6\u9009\u7406\u79d1</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (367.2167663574219 642.7542724609375) rotate(89.68627984680484)\"></path></g><g><path d=\"M 69.59851319063789 367.32614574153 L 366.16238212372537 450.0657305441708\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 69.59851319063789 367.32614574153 L 366.16238212372537 450.0657305441708\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"232.81011962890625\" y=\"396.3599853515625\">inf</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (347.76495361328125 444.9329528808594) rotate(15.590839129065841)\"></path></g><g><path d=\"M 662 359.99965163378397 L 366.16238212372537 450.0657305441708\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 662 359.99965163378397 L 366.16238212372537 450.0657305441708\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"499.1436767578125\" y=\"392.68896484375\">inf</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (384.4343566894531 444.5029296875) rotate(163.06625459626565)\"></path></g><g><path d=\"M 69.59851319063789 367.32614574153 L 367.32129017837025 661.8540224083981\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 69.59851319063789 367.32614574153 L 367.32129017837025 661.8540224083981\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"245.96771240234375\" y=\"501.582275390625\">\u9009\u7406\u79d1</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (353.81396484375 648.4916381835938) rotate(44.691477026263726)\"></path></g><g><path d=\"M 364.74554582466936 69.59851319063789 L 69.59851319063789 367.32614574153\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 364.74554582466936 69.59851319063789 L 69.59851319063789 367.32614574153\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"189.6642303466797\" y=\"204.90884896565618\">\u9009\u6587\u79d1</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (82.97493743896484 353.832763671875) rotate(134.74968255229285)\"></path></g></g><g><g fixed=\"false\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"364.74554582466936\" cy=\"69.59851319063789\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"364.74554582466936\" y=\"69.59851319063789\" style=\"user-select: none;\">ST</text></g><g fixed=\"false\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"69.59851319063789\" cy=\"367.32614574153\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"69.59851319063789\" y=\"367.32614574153\" style=\"user-select: none;\">(i,j)</text></g><g fixed=\"false\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"367.32129017837025\" cy=\"661.8540224083981\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"367.32129017837025\" y=\"661.8540224083981\" style=\"user-select: none;\">ED</text></g><g fixed=\"false\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"662\" cy=\"359.99965163378397\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"662\" y=\"359.99965163378397\" style=\"user-select: none;\">(i+1,j)</text></g><g fixed=\"false\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"366.42685126423726\" cy=\"297.01122406350703\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"366.42685126423726\" y=\"297.01122406350703\" style=\"user-select: none;\">new</text></g><g fixed=\"false\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"366.16238212372537\" cy=\"450.0657305441708\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"366.16238212372537\" y=\"450.0657305441708\" style=\"user-select: none;\">new'</text></g></g></g></svg>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf (1<<30)\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,M=5000011;\nint n,m,cnt=1,head[N],ST,ED,d[N],q[N];\nstruct edge{\n    int to,nxt,w;\n}e[M];\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;e[cnt].w=0;\n}\nbool bfs(){\n    int h=0,t=1,x;\n    memset(d,0,sizeof d);\n    q[h]=ST;d[ST]=1;\n    while(h<t){\n        x=q[h++];\n        if(x==ED)return 1;\n        fl(i,x)if(!d[to]&&e[i].w)\n            d[to]=d[x]+1,q[t++]=to;\n    }\n    return 0;\n}\nint dfs(int x,int mf){\n    if(x==ED)return mf;\n    int us=0,w;\n    fl(i,x)if(e[i].w&&d[to]==d[x]+1){\n        w=dfs(to,min(mf-us,e[i].w));\n        e[i].w-=w;\n        e[i^1].w+=w;\n        us+=w;\n        if(us==mf)return mf;\n    }\n    if(!us)d[x]=-1;\n    return us;\n}\nint id(int x,int y){\n    return (x-1)*m+y;\n}\nint main(){\n    in(n,m);\n    ST=0,ED=n*m+2*(n-1)*m+2*n*(m-1)+1;\n    int ans=0,w,tt=n*m;\n    //\u9009\u6587\u79d1ST\u2192(i,j)\n    Fur(i,1,n)Fur(j,1,m)\n        in(w),ans+=w,\n        add(ST,id(i,j),w);\n    //\u9009\u7406\u79d1(i,j)\u2192ED\n    Fur(i,1,n)Fur(j,1,m)\n        in(w),ans+=w,\n        add(id(i,j),ED,w);\n    //ST\u2192new,new\u2192(i,j),new\u2192(i+1,j)\n    Fur(i,1,n-1)Fur(j,1,m)\n        in(w),ans+=w,\n        add(ST,++tt,w),\n        add(tt,id(i,j),inf),\n        add(tt,id(i+1,j),inf);\n    //(i,j)\u2192new,(i+1,j)\u2192new,new\u2192ED\n    Fur(i,1,n-1)Fur(j,1,m)\n        in(w),ans+=w,\n        add(++tt,ED,w),\n        add(id(i,j),tt,inf),\n        add(id(i+1,j),tt,inf);\n    //ST\u2192new,new\u2192(i,j),new\u2192(i,j+1)\n    Fur(i,1,n)Fur(j,1,m-1)\n        in(w),ans+=w,\n        add(ST,++tt,w),\n        add(tt,id(i,j),inf),\n        add(tt,id(i,j+1),inf);\n    //(i,j)\u2192new,(i,j+1)\u2192new,new\u2192ED\n    Fur(i,1,n)Fur(j,1,m-1)\n        in(w),ans+=w,\n        add(++tt,ED,w),\n        add(id(i,j),tt,inf),\n        add(id(i,j+1),tt,inf);\n    \n    while(bfs())ans-=dfs(ST,inf);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 1646 [\u56fd\u5bb6\u96c6\u8bad\u961f]happiness/", "tags": ["\u7f51\u7edc\u6d41", "\u6700\u5c0f\u5272"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4915 \u5e15\u79cb\u8389\u7684\u9b54\u5bfc\u4e66", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4915&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4915\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u5148\u770b\u4e00\u4e0b[LG P4868 Preprefix sum](https://www.luogu.com.cn/problem/P4868),\u5f88\u7ecf\u5178\u4e00\u9053\u9898,\u7ef4\u62a4\u4e00\u4e0b\u540e\u7f00\u548c\u5c31\u53ef\u4ee5\u4e86\n\n\u8fd9\u9898\u7684\u8bdd\u5c31\u662f\u628a\u4e0a\u9762\u90a3\u9053\u9898\u53d8\u4e86\u4e00\u4e0b\n\n\u7531\u4e8e\u503c\u57df\u592a\u5927,\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528 \u52a8\u6001\u5f00\u70b9\u7ebf\u6bb5\u6811 \u6216 \u6811\u72b6\u6570\u7ec4+\u79bb\u6563\u5316\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,ls[N*20],rs[N*20],sz=1;\nll s[N*20],ps[N*20];\n#define pu s[x]=s[ls[x]]+s[rs[x]],ps[x]=ps[ls[x]]+ps[rs[x]]\nvoid add(int p,int v,int l=0,int r=INT_MAX,int x=1){\n    if(l==r){\n        s[x]+=v;\n        ps[x]+=1ll*v*(INT_MAX-p+1);\n        return;\n    }\n    int m=(l+r)>>1;\n    if(p<=m)add(p,v,l,m,ls[x]?ls[x]:ls[x]=++sz);\n    else add(p,v,m+1,r,rs[x]?rs[x]:rs[x]=++sz);\n    pu;\n}\nll ask(int p,int l=0,int r=INT_MAX,int x=1){\n    if(r<=p)return ps[x]-s[x]*(INT_MAX-p);\n    int m=(l+r)>>1;\n    return ask(p,l,m,ls[x])+((p>m)?ask(p,m+1,r,rs[x]):0);\n}\nint main(){\n    int q;\n    in(n,q);\n    int opt,x,y;\n    Fur(i,1,n){\n        in(x,y);\n        add(x,y);\n    }\n    while(q--){\n        in(opt,x,y);\n        if(opt==1){\n            db ans=(long db)(ask(y)-ask(x-1))/(long db)(y-x+1);\n            printf(\"%.4f\\n\",ans);\n        }\n        else add(x,y);\n    }\n}\n```\n", "link": "/posts/LG 4915 \u5e15\u79cb\u8389\u7684\u9b54\u5bfc\u4e66/", "tags": ["\u671f\u671b", "\u524d\u7f00\u548c", "\u6811\u72b6\u6570\u7ec4", "\u79bb\u6563\u5316", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3899 [\u6e56\u5357\u96c6\u8bad]\u8c08\u7b11\u98ce\u751f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3899&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3899\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$a$\u662f\u786e\u5b9a\u7684,\u8003\u8651$b$\u7684\u60c5\u51b5\uff1a\n\n1. \u662f$a$\u7684\u7956\u5148\n   \n   \u53ef\u4ee5\u4f5c\u4e3a$b$\u7684\u70b9\u7684\u6570\u91cf\u662f$\\min(d_x,k)$($d_x$\u6307$x$\u7684\u6df1\u5ea6),\n\n   $a$\u7684\u5b50\u6811\u4e2d\u9664$a$\u5916\u5176\u4ed6\u70b9\u90fd\u53ef\u4ee5\u4f5c\u4e3a$c$\n\n   \u603b\u65b9\u6848\u6570\u4e3a$\\min(d_x,k)\\times(siz_x-1)$\n\n2. \u5728$a$\u5b50\u6811\u4e2d\n   \n   \u5bf9\u4e8e\u6bcf\u4e2a$b$,\u53ef\u4ee5\u4f5c\u4e3a$c$\u7684\u70b9\u7684\u6570\u91cf\u4e3a$siz_b-1$\n\n   \u6211\u4eec\u53ef\u4ee5dfs\u5e8f,\u8bb0\u5f55\u5f53\u524d\u533a\u95f4\u4e2d\u6df1\u5ea6\u4e3a$d$\u7684\u6570\n\n   \u7136\u540e\u7528\u4e3b\u5e2d\u6811(\u53ef\u6301\u4e45\u5316\u6743\u503c\u7ebf\u6bb5\u6811)\u7ef4\u62a4\n\n   \u8fd9\u6837\u5c31\u53ef\u4ee5\u67e5\u8be2\u6df1\u5ea6$\\in [d_a+1,d_a+k]$\u7684\u6240\u6709'\u70b9\u7684\u5b50\u6811\u5927\u5c0f-1'\u7684\u548c\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 300011\nint n,q,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint ls[N*20],rs[N*20],rt[N],sz=0;\nll s[N*20];\nvoid build(int l,int r,int &x){\n    s[x=++sz]=0;\n    if(l==r)return;\n    int m=(l+r)>>1;\n    build(l,m,ls[x]);build(m+1,r,rs[x]);\n}\nvoid ins(int p,int v,int l,int r,int &x,int pre){\n    x=++sz;\n    s[x]=s[pre]+v;\n    ls[x]=ls[pre];\n    rs[x]=rs[pre];\n    if(l==r)return;\n    int m=(l+r)>>1;\n    if(p<=m)ins(p,v,l,m,ls[x],ls[pre]);\n    else ins(p,v,m+1,r,rs[x],rs[pre]);\n}\nll ask(int L,int R,int l,int r,int x,int y){\n    if(L<=l&&r<=R)return s[y]-s[x];\n    int m=(l+r)>>1;\n    ll ans=0;\n    if(L<=m)ans=ask(L,R,l,m,ls[x],ls[y]);\n    if(R>m)ans+=ask(L,R,m+1,r,rs[x],rs[y]);\n    return ans;\n}\nint siz[N],d[N],st[N],ed[N],dfn=0,T[N];\nvoid dfs(int x,int f){\n    d[x]=d[f]+1;\n    siz[x]=1;\n    T[st[x]=++dfn]=x;\n    fl(i,x)if(to!=f){\n        dfs(to,x);\n        siz[x]+=siz[to];\n    }\n    ed[x]=dfn;\n}\nint main(){\n    in(n,q);\n    int x,y,w;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    dfs(1,0);\n    Fur(i,1,n)ins(d[T[i]],siz[T[i]]-1,1,n,rt[i],rt[i-1]);\n    while(q--){\n        in(x,w);\n        out(1ll*(siz[x]-1)*MIN(w,d[x]-1)+ask(d[x],MIN(d[x]+w,n),1,n,rt[st[x]],rt[ed[x]]),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3899 [\u6e56\u5357\u96c6\u8bad]\u8c08\u7b11\u98ce\u751f/", "tags": ["\u4e3b\u5e2d\u6811", "dfs\u5e8f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF359D Pair-of-Numbers", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF359D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF359D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u5148rmq\u9884\u5904\u7406\u51fa\u533a\u95f4gcd\u548c\u533a\u95f4min\n\n\u82e5\u533a\u95f4gcd=\u533a\u95f4min\u90a3\u4e48\u8fd9\u4e2a\u533a\u95f4\u662f\u5408\u6cd5\u7684\n\n\u82e5\u4e00\u4e2a\u533a\u95f4\u5408\u6cd5,\u90a3\u4e48\u5b83\u4e00\u5b9a\u6709\u5408\u6cd5\u7684\u5b50\u533a\u95f4\n\n\u6211\u4eec\u53ef\u4ee5\u6839\u636e\u8fd9\u4e2a\u6027\u8d28\u4e8c\u5206\u533a\u95f4\u957f\u5ea6\n\n~~\u89e3\u2193\u51b3\u2191!~~\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 300011\nint n,a[N],v[1000001],s[21][N],b[21][N];\nil void st(){\n    int sz=l2(n);\n    Fur(k,1,sz)\n        Fur(i,1,n-(1<<k)+1)\n            s[k][i]=GCD(s[k-1][i],s[k-1][i+(1<<(k-1))]),\n            b[k][i]=MIN(b[k-1][i],b[k-1][i+(1<<(k-1))]);\n}\nil int get(int l,int r){\n    int k=l2(r-l+1);\n    return MIN(b[k][l],b[k][r-(1<<k)+1])==GCD(s[k][l],s[k][r-(1<<k)+1]);\n}\nint as[N],tt=0,ttt=0;\nil bool chk(int w){\n    tt=0;\n    Fur(i,1,n-w)if(get(i,i+w))as[++tt]=i;\n    return tt;\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i]),s[0][i]=b[0][i]=a[i];\n    st();\n    int l=0,r=n-1,res=0;\n    while(l<=r){\n        int m=(l+r)>>1;\n        if(chk(m)){\n            res=m;ttt=tt;\n            l=m+1;\n        }\n        else r=m-1;\n    }\n    out(ttt,\" \",res,ln);\n    Fur(i,1,ttt)out(as[i],\" \");\n    flush();\n}\n```\n", "link": "/posts/LG CF359D Pair-of-Numbers/", "tags": ["rmq", "\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1000D Yet-Another-Problem-On-a-Subsequence", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1000D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1000D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_i$\u8868\u793a\u4ee5$i$\u5f00\u5934\u5408\u6cd5\u5b50\u5e8f\u5217\u65b9\u6848\u6570\n\n$f_i=\\sum_{j=i+a_i+1}^{n+1} f_j \\times {j-i+1 \\choose a_i}$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1011\nint n,a[N],c[N][N],mod=998244353;\nll f[N];\nint main(){\n    in(n);\n    Fur(i,0,1000){\n        c[i][0]=c[i][i]=1;\n        Fur(j,1,i-1)\n            c[i][j]=(c[i-1][j]+c[i-1][j-1])%mod;\n    }\n    Fur(i,1,n)in(a[i]);\n    f[n+1]=1;\n    Fdr(i,n,1)if(a[i]>0){\n        Fur(j,i+a[i]+1,n+1)\n            f[i]=(f[i]+f[j]*1ll*c[j-i-1][a[i]]%mod)%mod;\n    }\n    ll ans=0;\n    Fur(i,1,n)ans=(ans+f[i])%mod;\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG CF1000D Yet-Another-Problem-On-a-Subsequence/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3948 \u6570\u636e\u7ed3\u6784", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3948&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3948\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fd9\u9898\u8003\u9a8c\u7684\u662f\u4ed4\u7ec6\u8bfb\u9898\n\n\u53ef\u4ee5\u53d1\u73b0\u4fee\u6539\u5e26\u67e5\u8be2\u7684\u53ea\u67091000\u4e2a,\u8fd9\u90e8\u5206\u76f4\u63a5\u66b4\u529b\u6c42\u5c31\u53ef\u4ee5\u4e86\n\n\u533a\u95f4\u52a0\u53ef\u4ee5\u7528\u5dee\u5206\u6765\u89e3\u51b3\n\n\u5269\u4e0b\u7684\u90e8\u5206\uff1a\n\n\u53ef\u4ee5\u9884\u5904\u7406\u51fa$[1,i]$\u7684\u7b54\u6848$ans_i$\n\n\u67e5\u8be2$[l,r]$\u7684\u7b54\u6848\u5c31\u662f$ans_r-ans_{l-1}$\n\n\u4ee3\u7801\u5f88\u77ed\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 800011\n#define int ll\nint n,q,mod,mi,mx,ans[N],s[N];\nsigned main(){\n    in(n,q,mod,mi,mx);\n    char ch;\n    int l,r,v;\n    while(q--){\n        in(ch,l,r);\n        if(ch=='A'){\n            in(v);\n            s[l]+=v;s[r+1]-=v;\n        }\n        else{\n            int now=0,res=0;\n            Fur(i,1,l-1)now+=s[i];\n            Fur(i,l,r)\n                now+=s[i],\n                res+=(mi<=(now*i%mod)&&(now*i%mod)<=mx);\n            out(res,ln);\n        }\n    }\n    int now=0;\n    Fur(i,1,n)\n        now+=s[i],\n        ans[i]=ans[i-1]+(mi<=(now*i)%mod&&(now*i)%mod<=mx);\n    in(q);\n    while(q--)in(l,r),out(ans[r]-ans[l-1],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3948 \u6570\u636e\u7ed3\u6784/", "tags": ["\u5dee\u5206", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1076E Vasya-and-a-Tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1076E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1076E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u89e3\u6cd51(\u5728\u7ebf)\uff1a\n\nbfs\u5e8f,\u5b9e\u73b0\u8f83\u4e3a\u9ebb\u70e6\n\n\u89e3\u6cd52(\u79bb\u7ebf)\uff1a\n\n\u8003\u8651\u5355\u72ec\u7684\u4e00\u4e2a\u8282\u70b9$u$,\u5b83\u7684\u64cd\u4f5c\u5f71\u54cd\u7684\u90fd\u662f\u5728\u5b83\u5b50\u6811\u5185\u7684\u4e0e$u$\u6df1\u5ea6\u5dee\u5c0f\u4e8e\u7b49\u4e8e$k$\u7684\u8282\u70b9,\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u7ef4\u62a4\u6bcf\u5c42\u6df1\u5ea6\u7684\u64cd\u4f5c\u603b\u548c\u5c31\u884c\u4e86\n\n\u4fee\u6539$x$\u5f71\u54cd\u7684\u53ea\u6709$x$\u7684\u5b50\u6811,\u6211\u4eec\u53ef\u4ee5\u5728dfs\u65f6\u8fd9\u6837\u64cd\u4f5c\uff1a\n\n1.\u8fdb\u5165\u8be5\u70b9\n2. \u5b9e\u73b0\u8be5\u70b9\u7684\u6240\u6709\u64cd\u4f5c\n3. \u9012\u5f52\u5b83\u7684\u5b50\u6811\n4. \u64a4\u9500\u64cd\u4f5c\n\n\u8fd9\u6837\u5c31\u4e0d\u4f1a\u5f71\u54cd\u5230\u5176\u4ed6\u70b9\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 300011\nint n,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nll s[N],ans[N];\nil void upd(int x,int v){\n    for(int i=x;i<=n;i+=i&-i)\n        s[i]+=v;\n}\nil ll ask(int x){\n    ll ans=0;\n    for(int i=x;i;i-=i&-i)\n        ans+=s[i];\n    return ans;\n}\nstruct node{int v,d;};\nvector<node>opt[N];\nvoid dfs(int x,int d,int f){\n    for(auto i:opt[x])\n        upd(MIN(n,d+i.d),i.v);\n    ans[x]=ask(n)-ask(d-1);\n    fl(i,x)if(to!=f)dfs(to,d+1,x);\n    for(auto i:opt[x])\n        upd(MIN(n,d+i.d),-i.v);\n}\nint main(){\n    in(n);\n    int x,y,q,v,d;\n    Fur(i,1,n-1)\n        in(x,y),\n        add(x,y),add(y,x);\n    in(q);\n    while(q--){\n        in(x,d,v);\n        opt[x].push_back(node{v,d});\n    }\n    dfs(1,1,0);\n    Fur(i,1,n)out(ans[i],\" \");\n    flush();\n}\n```\n", "link": "/posts/LG CF1076E Vasya-and-a-Tree/", "tags": ["\u5dee\u5206", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3588 [POI2015]PUS", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3588&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3588\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u628a$x>y$,\u770b\u6210$x\\rightarrow y$\u7684\u4e00\u6761\u8fb9\n\n\u82e5\u6700\u540e\u7684\u56fe\u51fa\u73b0\u73af\u7684\u8bdd\u90a3\u5c31\u662f\u4e0d\u5408\u6cd5\u7684\n\n\u4f46\u662f\u5982\u679c\u6309\u7167\u666e\u901a\u7684\u5efa\u56fe\u65b9\u5f0f\u7684\u8bdd\u6bcf\u6b21\u8981\u6dfb\u52a0$k(r-l-1-k)$\u6761\u8fb9\n\n\u6211\u4eec\u53ef\u4ee5\u7ebf\u6bb5\u6811\u4f18\u5316\u5efa\u56fe\n\n\u56e0\u4e3a$k \\le 3 \\times 10^5$\n\n\u6240\u4ee5\u6574\u4e2a\u533a\u95f4\u6700\u591a\u88ab\u5212\u5206\u6210$3\\times 10^5$\u6bb5\n\n$log n$\u7684\u590d\u6742\u5ea6\u662f\u53ef\u4ee5\u63a5\u53d7\u7684\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011<<3\nint n,s,q,cnt=0,a[N],pos[N],head[N],deg[N],sz=0,bl[N],d[N],len=0;\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    ++deg[y];\n}\n#define ls rt<<1\n#define rs rt<<1|1\nvoid build(int l,int r,int rt){\n    sz=MAX(sz,rt);\n    if(l==r){\n        bl[rt]=l;\n        pos[l]=rt;\n        return;\n    }\n    int m=(l+r)>>1;\n    add(rt,ls);\n    add(rt,rs);\n    build(l,m,ls);\n    build(m+1,r,rs);\n}\nvoid upd(int L,int R,int p,int l,int r,int rt){\n    if(L>R)return;\n    if(L<=l&&r<=R){\n        add(p,rt);\n        return;\n    }\n    int m=(l+r)>>1;\n    if(L<=m)upd(L,R,p,l,m,ls);\n    if(R>m)upd(L,R,p,m+1,r,rs);\n}\nil void ext(){cout<<\"NIE\\n\";exit(0);}\nvoid topsort(){\n    queue<int>q;\n    q.push(1);\n    a[1]=1e9;\n    clr(d,127);\n    while(!q.empty()){\n        int x=q.front();q.pop();\n        fl(i,x){\n            d[to]=MIN(d[to],a[x]-(bl[to]!=0));\n            if(d[to]<a[to])ext();\n            if(!--deg[to]){\n                if(bl[to])++len;\n                q.push(to);\n                if(!a[to])a[to]=d[to];\n            }\n        }\n    }\n}\nint main(){\n    int x,y,t,l,r,k;\n    in(n,t,q);\n    build(1,n,1);\n    while(t--){\n        in(x,y);\n        a[pos[x]]=y;\n    }\n    while(q--){\n        in(l,r,k);\n        int la=l;\n        ++sz;\n        while(k--){\n            in(x);\n            add(pos[x],sz);\n            upd(la,x-1,sz,1,n,1);\n            la=x+1;\n        }\n        upd(la,r,sz,1,n,1);\n    }\n    topsort();\n    if(len!=n)ext();\n    out(\"TAK\\n\");\n    Fur(i,1,n)out(a[pos[i]],\" \");\n    flush();\n}\n```\n", "link": "/posts/LG 3588 [POI2015]PUS/", "tags": ["\u7ebf\u6bb5\u6811", "\u5dee\u5206\u7ea6\u675f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1935 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u5708\u5730\u8ba1\u5212", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1935&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1935\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u548c[\\[\u56fd\u5bb6\u96c6\u8bad\u961f]happiness](https://www.luogu.com.cn/problemnew/show/P1646)\u6709\u70b9\u50cf\n\n\u800c\u4e14\u5efa\u56fe\u66f4\u52a0\u7b80\u5316\u4e86\n\n\u7b54\u6848\u4e3a\u603b\u548c\u51cf\u53bb\u6700\u5c0f\u5272\n\n$(i+j)\\&1,(i',j')$\u4e0e$(i,j)$\u76f8\u90bb,\u9ed1\u767d\u67d3\u8272\u5efa\u56fe\n\n$st\\xrightarrow{A} (i,j)\\xrightarrow{B}ed$\n\n$st\\xrightarrow{B} (i',j')\\xrightarrow{A}ed$\n\n$(i,j) \\xleftrightarrow{c_{i,j}+c_{i',j'}} (i',j')$\n\n<svg width=\"366px\" height=\"366px\"><g><g><g><path d=\"M 179.9565402615114 64.65031742466253 L 110.93085210521868 181.6436746692404\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 179.9565402615114 64.65031742466253 L 110.93085210521868 181.6436746692404\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"134.43588256835938\" y=\"115.71207236851667\">A</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (120.63645935058594 165.1934051513672) rotate(120.54182437911714)\"></path></g><g><path d=\"M 179.9565402615114 64.65031742466253 L 250.62058333668756 180.66171477618175\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 179.9565402615114 64.65031742466253 L 250.62058333668756 180.66171477618175\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"225.49951171875\" y=\"114.97562115122257\">B</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (240.68463134765625 164.34954833984375) rotate(58.652662037796304)\"></path></g><g><path d=\"M 110.93085210521868 181.6436746692404 L 181.59447414202378 297.65509303120433\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 110.93085210521868 181.6436746692404 L 181.59447414202378 297.65509303120433\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"156.46578979492188\" y=\"231.96886161353007\">B</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (171.71058654785156 281.42828369140625) rotate(58.65158788133772)\"></path></g><g><path d=\"M 250.62058333668756 180.66171477618175 L 181.59447414202378 297.65509303120433\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 250.62058333668756 180.66171477618175 L 181.59447414202378 297.65509303120433\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"205.09970092773438\" y=\"231.71899310498995\">A</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (191.30010986328125 281.2048645019531) rotate(120.54043854783976)\"></path></g><g><path d=\"M 110.93085210521868 181.6436746692404 L 250.62058333668756 180.66171477618175\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 110.93085210521868 181.6436746692404 L 250.62058333668756 180.66171477618175\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"178.62067289825168\" y=\"168.54331970214844\">c[i][j]+c[i'][j']</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (231.52105712890625 180.7959747314453) rotate(359.59944615766557)\"></path></g><g><path d=\"M 250.62058333668756 180.66171477618175 L 110.93085210521868 181.6436746692404\" fill=\"none\" stroke-width=\"2\" stroke=\"black\"></path><path d=\"M 250.62058333668756 180.66171477618175 L 110.93085210521868 181.6436746692404\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\"></path><text font-size=\"15px\" dy=\"0.35em\" text-anchor=\"middle\" style=\"user-select: none;\" x=\"178.62070578225905\" y=\"168.54331970214844\">c[i][j]+c[i'][j']</text><path stroke=\"black\" fill=\"black\" d=\"M -15 7.5 L 0 0 L -15 -7.5 Z\" transform=\"translate (129.93038940429688 181.51011657714844) rotate(179.59944615766557)\"></path></g></g><g><g fixed=\"false\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"179.9565402615114\" cy=\"64.65031742466253\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"179.9565402615114\" y=\"64.65031742466253\" style=\"user-select: none;\">st</text></g><g fixed=\"false\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"110.93085210521868\" cy=\"181.6436746692404\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"110.93085210521868\" y=\"181.6436746692404\" style=\"user-select: none;\">i,j</text></g><g fixed=\"false\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"250.62058333668756\" cy=\"180.66171477618175\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"250.62058333668756\" y=\"180.66171477618175\" style=\"user-select: none;\">i',j'</text></g><g fixed=\"false\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"181.59447414202378\" cy=\"297.65509303120433\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"181.59447414202378\" y=\"297.65509303120433\" style=\"user-select: none;\">ed</text></g></g></g></svg>\n\n\u5047\u8bbe$(i,j)$\u9009\u62e9$A$,\u90a3\u4e48\u8981\u65ad\u5f00$(i,j)\\rightarrow t,(i,j)\\rightarrow (i',j')$\n\n\u8fd9\u4e9b\u8fb9\u4e0a\u7684\u6743\u503c\u4f1a\u4ece\u7b54\u6848\u4e2d\u51cf\u53bb\n\n\u6700\u5c0f\u5272\u53ef\u4ee5\u6700\u5c0f\u5316\u8981\u51cf\u53bb\u7684\u6743\u503c,\u6240\u4ee5\u7b54\u6848\u6700\u5927\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?__=1,EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\nconst int N=100011,M=1000011;\nint n,m,cnt=1,head[N],st,ed,d[N],q[N],c[101][101];\nstruct edge{\n    int to,nxt,w;\n}e[M];\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;e[cnt].w=0;\n}\nbool bfs(){\n    int h=0,t=1,x;\n    clr(d,0);\n    q[0]=st;d[st]=1;\n    while(h<t){\n        x=q[h++];if(x==ed)return 1;\n        fl(i,x)if(e[i].w&&!d[to])\n            d[to]=d[x]+1,q[t++]=to;\n    }\n    return 0;\n}\nint dfs(int x,int mf){\n    if(x==ed)return mf;\n    int us=0,w;\n    fl(i,x)if(e[i].w&&d[to]==d[x]+1){\n        w=dfs(to,MIN(mf-us,e[i].w));\n        e[i].w-=w;\n        us+=w;\n        e[i^1].w+=w;\n        if(us==mf)return mf;\n    }\n    if(!us)d[x]=-1;\n    return us;\n}\nint id(int x,int y){\n    return (x-1)*m+y;\n}\nint main(){\n    in(n,m);\n    st=N-1,ed=N-2;\n    int ans=0,w,tt=n*m,dx[4]={0,1,0,-1},dy[4]={1,0,-1,0},x,y;\n    Fur(i,1,n)Fur(j,1,m){\n        in(w),ans+=w;\n        if((i+j)&1)add(st,id(i,j),w);\n        else add(id(i,j),ed,w);\n    }\n    Fur(i,1,n)Fur(j,1,m){\n        in(w),ans+=w;\n        if((i+j)&1)add(id(i,j),ed,w);\n        else add(st,id(i,j),w);\n    }\n    Fur(i,1,n)Fur(j,1,m)in(c[i][j]);\n    Fur(i,1,n)Fur(j,1,m)\n    if(!((i+j)&1))\n    Fur(t,0,3){\n        x=i+dx[t],y=j+dy[t];\n        if(x<1||x>n||y<1||y>m)continue;\n        ans+=(w=c[i][j]+c[x][y]);\n        add(id(i,j),id(x,y),w);\n        add(id(x,y),id(i,j),w);\n    }\n    while(bfs())ans-=dfs(st,inf);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 1935 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u5708\u5730\u8ba1\u5212/", "tags": ["\u6700\u5c0f\u5272"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3676 \u5c0f\u6e05\u65b0\u6570\u636e\u7ed3\u6784\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3676&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3676\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u8003\u8651\u6ca1\u6709\u6362\u6839\u7684\u64cd\u4f5c(\u8bbe\u6839\u8282\u70b9\u4e3a$1$)\n\n\u4fee\u6539\u70b9$x$\u7684\u6743\u503c\n\n\u88ab\u5f71\u54cd\u7684\u53ea\u6709$1\\rightarrow x$\u4e0a\u7684\u70b9,\u8bbe$p_1,p_2,...,p_k$\u4e3a$1\\rightarrow x$\u4e0a\u7684\u70b9\n\n\u8bbe$s_i$\u4e3a$i$\u5b50\u6811\u70b9\u6743\u548c\n\n\u5c06\u4fee\u6539\u770b\u6210\u589e\u52a0$v$\n\n\u4fee\u6539\u540e\u8d21\u732e\u4e3a\n\n$\\sum_{i=1}^k (s_{p_i}+v)^2-\\sum_{i=1}^k s_{p_i}^2= k\\times v^2+2v\\sum_{i=1}^ks_{p_i}$\n\n\u6211\u4eec\u9700\u8981\u9884\u5904\u7406\u51fa$s_i^2$,\u7ef4\u62a4$s_i$\n\n\n\u8003\u8651\u6362\u6839\u64cd\u4f5c\uff1a\n\n\u8bbe$x$\u4e3a\u6839,$p_1,p_2,...,p_k$\u4e3a$1\\rightarrow x$\u4e0a\u7684\u70b9\n\n\u8bbe$a_i$\u4e3a\u5728$1$\u4e3a\u6839\u65f6$v_i$\u7684\u70b9\u6743\u548c,$b_i$\u4e3a\u5728$x$\u4e3a\u6839\u65f6$v_i$\u7684\u70b9\u6743\u548c\n\n\u53ef\u4ee5\u53d1\u73b0$a_{i+1}+b_i=a_1=b_k$(\u56e0\u4e3a\u6240\u6709\u70b9\u7684\u70b9\u6743\u548c\u603b\u662f\u76f8\u540c)\n\n\u8bbe$ans_x$\u8868\u793a$x$\u4e3a\u6839\u65f6\u7684\u7b54\u6848\n\n$ans_x=ans_1+\\sum_{i=1}^k b_i^2-a_i^2$\n\n$=ans_1+\\sum_{i=1}^k (a_1-a_{i+1})^2-a_i^2$\n\n$=ans_1+\\sum_{i=2}^k (a_1-a_i)^2-a_i^2$\n\n$=ans_1+ (k-1)a_1^2- 2a_1\\sum_{i=2}^k a_i$\n\n$=ans_1+ s_1[(k+1)s_1-2\\sum_{i=1}^k s_{p_i}]$\n\n\n\u53ef\u4ee5\u4f7f\u7528\u6811\u94fe\u5256\u5206+(\u6811\u72b6\u6570\u7ec4/\u7ebf\u6bb5\u6811)\u6216LCT\u7ef4\u62a4\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,cnt=0,head[N],val[N],pos[N],w[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nll s[N],S[N],ans=0;\nil void upd(int x,int v){\n    if(x<=n)\n    for(int i=x;i<=n;i+=i&-i)\n        s[i]+=v,\n        S[i]+=1ll*x*v;\n}\nil void upd(int l,int r,int v){upd(l,v);upd(r+1,-v);}\nil ll ask(int x){\n    ll res=0;\n    for(int i=x;i;i-=i&-i)\n        res+=1ll*(x+1)*s[i]-S[i];\n    return res;\n}\nil ll ask(int l,int r){return ask(r)-ask(l-1);}\nint siz[N],top[N],id[N],f[N],d[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n        w[x]+=w[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;pos[id[x]=++sz]=x;\n    ans+=1ll*w[x]*w[x];\n    upd(id[x],w[x]-w[pos[sz-1]]);\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nil void mdy(int x,int v){\n    int k=0;\n    ll res=0;\n    while(x){\n        k+=id[x]-id[top[x]]+1;\n        res+=ask(id[top[x]],id[x]);\n        upd(id[top[x]],id[x],v);\n        x=f[top[x]];\n    }\n    ans+=1ll*v*(1ll*v*k+(res<<1));\n}\nil ll qry(int x){\n    int k=0,v=ask(1);\n    ll res=0;\n    while(x){\n        k+=id[x]-id[top[x]]+1;\n        res+=ask(id[top[x]],id[x]);\n        x=f[top[x]];\n    }\n    return ans+1ll*v*((k+1)*v-(res<<1));\n}\nint main(){\n    int q,x,y,opt;\n    in(n,q);\n    Fur(i,1,n-1)\n        in(x,y),\n        add(x,y),add(y,x);\n    Fur(i,1,n)in(val[i]),w[i]=val[i];\n    dfs(1);bt(1,1);\n    while(q--){\n        in(opt,x);\n        if(opt==1){\n            in(y);\n            y-=val[x];\n            val[x]+=y;\n            mdy(x,y);\n        }\n        else out(qry(x),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3676 \u5c0f\u6e05\u65b0\u6570\u636e\u7ed3\u6784\u9898/", "tags": ["\u6811\u94fe\u5256\u5206", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LOJ 139 \u6811\u94fe\u5256\u5206", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://loj.ac/problem/139&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://loj.ac/problem/139\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6362\u6839\u6811\u94fe\u5256\u5206\n\n\u524d\u7f6e\u77e5\u8bc6\uff1a\u6811\u94fe\u5256\u5206\n\n\u9898\u610f\uff1a\u6811\u94fe\u52a0,\u5b50\u6811\u52a0,\u9700\u8981\u652f\u6301\u6362\u6839,\u67e5\u8be2\u6811\u94fe\u548c,\u5b50\u6811\u548c\n\n\u6811\u94fe\u52a0\u3001\u67e5\u8be2\u6811\u94fe\u548c \u4e0e\u666e\u901a\u7684\u6811\u94fe\u5256\u5206\u4e00\u6837\n\n\u4e3b\u8981\u8bb2\uff1a\n\n\u9700\u8981\u652f\u6301\u6362\u6839,\u5b50\u6811\u52a0,\u67e5\u8be2\u5b50\u6811\u548c\n\n\u8bbe\u5f53\u524d\u67e5\u8be2\u7684\u70b9\u4e3a$x$\n\n\u60c5\u51b51: $x$\u5c31\u662f\u6839,\u76f4\u63a5\u8f93\u51fa\u6574\u68f5\u6811\u7684\u548c\n\n\u60c5\u51b52: \u6839\u5728$x$\u5b50\u6811\u5185:\n\n\u627e\u5230\u6839\u5230$x$\u8def\u5f84\u4e0a\u7684$x$\u7684\u513f\u5b50\n\n<!-- more -->\n\n```cpp\nint child(int rt,int x){\n    while(top[rt]!=top[x]){\n        rt=top[rt];\n        if(f[rt]==x)return rt;//\u7236\u4eb2\u662fx,\u8fd4\u56de\u5f53\u524d\u70b9\n        rt=f[rt];\n    }\n    return son[x];//\u6839\u5728x\u6240\u5728\u7684\u91cd\u94fe\u4e0a\n}\n```\n\n\u628a\u6574\u68f5\u6811\u9664$t$\u5b50\u6811\u5916\u7684\u90e8\u5206\u52a0\u4e0a$val$\u5373\u53ef\n\n> \u4e3e\u4e2a\u4f8b\u5b50\n> \n> <svg width=\"300px\" height=\"300px\" _=\"SVGRoot\"><g _=\"EditableGraph\"><g _=\"SVGGroup\"><g _=\"GraphEdge\"><path d=\"M 148.30985915492957 45.774647887323944 L 96.30985915492957 98.87323943661971\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 148.30985915492957 45.774647887323944 L 96.30985915492957 98.87323943661971\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 148.30985915492957 45.774647887323944 L 226.30985915492957 98.87323943661971\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 148.30985915492957 45.774647887323944 L 226.30985915492957 98.87323943661971\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 96.30985915492957 98.87323943661971 L 70.30985915492957 151.9718309859155\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 96.30985915492957 98.87323943661971 L 70.30985915492957 151.9718309859155\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 96.30985915492957 98.87323943661971 L 148.3098591549295 151.9718309859155\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 96.30985915492957 98.87323943661971 L 148.3098591549295 151.9718309859155\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 226.30985915492957 98.87323943661971 L 200.30985915492954 151.9718309859155\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 226.30985915492957 98.87323943661971 L 200.30985915492954 151.9718309859155\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 226.30985915492957 98.87323943661971 L 252.30985915492957 151.9718309859155\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 226.30985915492957 98.87323943661971 L 252.30985915492957 151.9718309859155\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 70.30985915492957 151.9718309859155 L 44.30985915492957 205.07042253521126\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 70.30985915492957 151.9718309859155 L 44.30985915492957 205.07042253521126\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 70.30985915492957 151.9718309859155 L 96.30985915492955 205.07042253521126\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 70.30985915492957 151.9718309859155 L 96.30985915492955 205.07042253521126\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g></g><g _=\"SVGGroup\"><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"148.30985915492957\" cy=\"45.774647887323944\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"148.30985915492957\" y=\"45.774647887323944\" style=\"user-select: none;\" _=\"SVGText\">1</text></g><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"96.30985915492957\" cy=\"98.87323943661971\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"96.30985915492957\" y=\"98.87323943661971\" style=\"user-select: none;\" _=\"SVGText\">2</text></g><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"226.30985915492957\" cy=\"98.87323943661971\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"226.30985915492957\" y=\"98.87323943661971\" style=\"user-select: none;\" _=\"SVGText\">3</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"70.30985915492957\" cy=\"151.9718309859155\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"70.30985915492957\" y=\"151.9718309859155\" _=\"SVGText\" style=\"user-select: none;\">4</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"148.3098591549295\" cy=\"151.9718309859155\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"148.3098591549295\" y=\"151.9718309859155\" _=\"SVGText\" style=\"user-select: none;\">5</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"200.30985915492954\" cy=\"151.9718309859155\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"200.30985915492954\" y=\"151.9718309859155\" _=\"SVGText\" style=\"user-select: none;\">6</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"252.30985915492957\" cy=\"151.9718309859155\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"252.30985915492957\" y=\"151.9718309859155\" _=\"SVGText\" style=\"user-select: none;\">7</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"44.30985915492957\" cy=\"205.07042253521126\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"44.30985915492957\" y=\"205.07042253521126\" style=\"user-select: none;\" _=\"SVGText\">8</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"96.30985915492955\" cy=\"205.07042253521126\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"96.30985915492955\" y=\"205.07042253521126\" style=\"user-select: none;\" _=\"SVGText\">9</text></g></g></g></svg>\n> \n> \u5efa\u6811\u65f6\u662f\u4ee51\u4e3a\u6839\n> \n> \u8bbe\u5f53\u524d\u6839\u4e3a9,x\u4e3a2\n> \n> \u627e\u51fa\u7684child\u662f4\n> \n> <svg width=\"300px\" height=\"300px\" _=\"SVGRoot\"><g _=\"EditableGraph\"><g _=\"SVGGroup\"><g _=\"GraphEdge\"><path d=\"M261,153.39565279298176Q205.162355744426,154.5050546416901,149.32471148885205,155.6144564903984\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M261,153.39565279298176Q205.162355744426,154.5050546416901,149.32471148885205,155.6144564903984\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M261,153.39565279298176Q206.91547342716183,207.19782639649088,152.83094685432368,261\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M261,153.39565279298176Q206.91547342716183,207.19782639649088,152.83094685432368,261\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M149.32471148885205,155.6144564903984Q151.05132366814587,97.3072282451992,152.7779358474397,39\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M149.32471148885205,155.6144564903984Q151.05132366814587,97.3072282451992,152.7779358474397,39\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 149.32471148885205 155.6144564903984 L 39 148.97409692923225\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 149.32471148885205 155.6144564903984 L 39 148.97409692923225\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 152.7779358474397 39 L 260.3385416666667 39\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 152.7779358474397 39 L 260.3385416666667 39\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M152.7779358474397,39Q95.88896792371985,39,39,39\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M152.7779358474397,39Q95.88896792371985,39,39,39\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M152.83094685432368,261Q95.91547342716184,261,39,261\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M152.83094685432368,261Q95.91547342716184,261,39,261\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g><g _=\"GraphEdge\"><path d=\"M 152.83094685432368 261 L 261 261\" fill=\"none\" stroke-width=\"2\" stroke=\"black\" _=\"SVGPath\"></path><path d=\"M 152.83094685432368 261 L 261 261\" opacity=\"0\" fill=\"none\" stroke-width=\"30\" stroke=\"black\" _=\"SVGPath\"></path></g></g><g _=\"SVGGroup\"><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"261\" cy=\"153.39565279298176\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"261\" y=\"153.39565279298176\" style=\"user-select: none;\" _=\"SVGText\">1</text></g><g fixed=\"false\" style=\"cursor: pointer;\" _=\"GraphNode\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"149.32471148885205\" cy=\"155.6144564903984\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"149.32471148885205\" y=\"155.6144564903984\" style=\"user-select: none;\" _=\"SVGText\">2</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"152.83094685432368\" cy=\"261\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"152.83094685432368\" y=\"261\" _=\"SVGText\" style=\"user-select: none;\">3</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"152.7779358474397\" cy=\"39\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"152.7779358474397\" y=\"39\" style=\"user-select: none;\" _=\"SVGText\">4</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"39\" cy=\"148.97409692923225\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"39\" y=\"148.97409692923225\" style=\"user-select: none;\" _=\"SVGText\">5</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"260.3385416666667\" cy=\"39\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"260.3385416666667\" y=\"39\" style=\"user-select: none;\" _=\"SVGText\">8</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"5\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"39\" cy=\"39\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"39\" y=\"39\" style=\"user-select: none;\" _=\"SVGText\">9</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"39\" cy=\"261\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"39\" y=\"261\" _=\"SVGText\" style=\"user-select: none;\">6</text></g><g fixed=\"false\" _=\"GraphNode\" style=\"cursor: pointer;\"><circle stroke-width=\"2\" fill=\"white\" stroke=\"black\" r=\"19\" cx=\"261\" cy=\"261\" _=\"SVGCircle\"></circle><text font-size=\"14\" dy=\".35em\" text-anchor=\"middle\" stroke-width=\"1\" fill=\"black\" stroke=\"black\" x=\"261\" y=\"261\" _=\"SVGText\" style=\"user-select: none;\">7</text></g></g></g></svg>\n\n\u60c5\u51b53: \u6839\u4e0d\u5728$x$\u5b50\u6811\u5185: \u4e0e\u666e\u901a\u6811\u94fe\u5256\u5206\u4e00\u6837\n\n\u7ebf\u6bb5\u6811\u7248:\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n#define N 100011\nint n,cnt=0,RT=1,head[N],c[N];\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint a[N];\nll s[N<<2],laz[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=s[ls]+s[rs]\nvoid pd(int rt,int ln,int rn){\n    if(laz[rt]){\n        laz[ls]+=laz[rt];\n        laz[rs]+=laz[rt];\n        s[ls]+=ln*laz[rt];\n        s[rs]+=rn*laz[rt];\n        laz[rt]=0;\n    }\n}\nvoid build(int l,int r,int rt){\n    if(l==r){\n        s[rt]=a[l];\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu;\n}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt]+=v*(r-l+1);\n        laz[rt]+=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    pu;\n}\nll ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1;\n    ll ans=0;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans+=ask(L,R,m+1,r,rs);\n    return ans;\n}\nint son[N],siz[N],top[N],id[N],f[N],d[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;\n    son[x]=0;\n    fl(i,x){\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;a[id[x]]=c[x];\n    if(!son[x])return;\n    bt(son[x],tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nll fh(int x,int y){\n    ll ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        ans+=ask(id[top[x]],id[x],1,n,1);x=f[top[x]];\n    }\n    if(id[x]>id[y])swap(x,y);\n    return ans+ask(id[x],id[y],1,n,1);\n}\nvoid ul(int x,int y,int k){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        upd(id[top[x]],id[x],k,1,n,1);x=f[top[x]];\n    }\n    if(id[x]>id[y])swap(x,y);\n    upd(id[x],id[y],k,1,n,1);\n}\nint child(int x,int y){\n    while(top[x]!=top[y]){\n        x=top[x];\n        if(f[x]==y)return x;\n        x=f[x];\n    }\n    return son[y];\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",&c[i]);\n    int q,x,y,opt,k;\n    for(int i=2;i<=n;++i)\n        scanf(\"%d\",&f[i]),add(f[i],i);\n    dfs(1);bt(1,1);\n    build(1,n,1);\n    scanf(\"%d\",&q);\n    while(q--){\n        scanf(\"%d%d\",&opt,&x);\n        if(opt==1)RT=x;\n        if(opt==2)scanf(\"%d%d\",&y,&k),ul(x,y,k);\n        if(opt==3){\n            scanf(\"%d\",&k);\n            if(x==RT)upd(1,n,k,1,n,1);\n            else if(id[x]<=id[RT]&&id[RT]+siz[RT]<=id[x]+siz[x]){\n                int t=child(RT,x);\n                upd(1,n,k,1,n,1);\n                upd(id[t],id[t]+siz[t]-1,-k,1,n,1);\n            }\n            else upd(id[x],id[x]+siz[x]-1,k,1,n,1);\n        }\n        if(opt==4)scanf(\"%d\",&y),printf(\"%lld\\n\",fh(x,y));\n        if(opt==5){\n            if(x==RT)printf(\"%lld\\n\",s[1]);\n            else if(id[x]<=id[RT]&&id[RT]+siz[RT]<=id[x]+siz[x]){\n                int t=child(RT,x);\n                printf(\"%lld\\n\",s[1]-ask(id[t],id[t]+siz[t]-1,1,n,1));\n            }\n            else printf(\"%lld\\n\",ask(id[x],id[x]+siz[x]-1,1,n,1));\n        }\n    }\n}\n```\n\n\u6811\u72b6\u6570\u7ec4\u7248\uff1a\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#pragma GCC optimize(Ofast)\n#define il inline\nil void SWAP(int &x,int &y){int t=x;x=y;y=t;}\nusing namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\n#define ll long long\n#define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\nint n,cnt=0,RT=1,head[N],c[N];\nstruct edge{\n    int to,nxt;\n}e[N];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nll s[N],S[N];\nil void upd(int x,int v){\n    if(x<=n)\n    for(int i=x;i<=n;i+=i&-i)\n        s[i]+=v,\n        S[i]+=1ll*v*(x-1);\n}\nil ll ask(int x){\n    ll ans=0;\n    for(int i=x;i;i-=i&-i)\n        ans+=1ll*x*s[i]-S[i];\n    return ans;\n}\nil void upd(int l,int r,int v){upd(l,v);upd(r+1,-v);}\nil ll ask(int l,int r){return ask(r)-ask(l-1);}\nint son[N],siz[N],top[N],id[N],f[N],d[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;\n    son[x]=0;\n    fl(i,x){\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;\n    if(!son[x])return;\n    bt(son[x],tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nll fh(int x,int y){\n    ll ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans+=ask(id[top[x]],id[x]);x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    return ans+ask(id[x],id[y]);\n}\nvoid ul(int x,int y,int k){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        upd(id[top[x]],id[x],k);x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    upd(id[x],id[y],k);\n}\nil int child(int x,int y){\n    while(top[x]!=top[y]){\n        x=top[x];\n        if(f[x]==y)return x;\n        x=f[x];\n    }\n    return son[y];\n}\nint main(){\n    in(n);\n    for(int i=1;i<=n;++i)in(c[i]);\n    int q,x,y,opt,k;\n    for(int i=2;i<=n;++i)\n        in(f[i]),add(f[i],i);\n    dfs(1);bt(1,1);\n    for(int i=1;i<=n;++i)upd(id[i],id[i],c[i]);\n    in(q);\n    while(q--){\n        in(opt,x);\n        if(opt==1)RT=x;\n        if(opt==2)in(y,k),ul(x,y,k);\n        if(opt==3){\n            in(k);\n            if(x==RT)upd(1,n,k);\n            else if(id[x]<=id[RT]&&id[RT]+siz[RT]<=id[x]+siz[x]){\n                int t=child(RT,x);\n                upd(1,k);\n                upd(id[t],id[t]+siz[t]-1,-k);\n            }\n            else upd(id[x],id[x]+siz[x]-1,k);\n        }\n        if(opt==4)in(y),out(fh(x,y),ln);\n        if(opt==5){\n            if(x==RT)out(ask(n),ln);\n            else if(id[x]<=id[RT]&&id[RT]+siz[RT]<=id[x]+siz[x]){\n                int t=child(RT,x);\n                out(ask(n)-ask(id[t],id[t]+siz[t]-1),ln);\n            }\n            else out(ask(id[x],id[x]+siz[x]-1),ln);\n        }\n    }\n    flush();\n}\n```\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n#define N 100011\nint n,cnt=0,RT=1,head[N],c[N];\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint a[N];\nll s[N<<2],laz[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=s[ls]+s[rs]\nvoid pd(int rt,int ln,int rn){\n    if(laz[rt]){\n        laz[ls]+=laz[rt];\n        laz[rs]+=laz[rt];\n        s[ls]+=ln*laz[rt];\n        s[rs]+=rn*laz[rt];\n        laz[rt]=0;\n    }\n}\nvoid build(int l,int r,int rt){\n    if(l==r){\n        s[rt]=a[l];\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu;\n}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt]+=v*(r-l+1);\n        laz[rt]+=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    pu;\n}\nll ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1;\n    ll ans=0;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans+=ask(L,R,m+1,r,rs);\n    return ans;\n}\nint son[N],siz[N],top[N],id[N],f[N],d[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;\n    son[x]=0;\n    fl(i,x){\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;a[id[x]]=c[x];\n    if(!son[x])return;\n    bt(son[x],tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nll fh(int x,int y){\n    ll ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        ans+=ask(id[top[x]],id[x],1,n,1);x=f[top[x]];\n    }\n    if(id[x]>id[y])swap(x,y);\n    return ans+ask(id[x],id[y],1,n,1);\n}\nvoid ul(int x,int y,int k){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])swap(x,y);\n        upd(id[top[x]],id[x],k,1,n,1);x=f[top[x]];\n    }\n    if(id[x]>id[y])swap(x,y);\n    upd(id[x],id[y],k,1,n,1);\n}\nint child(int x,int y){\n    while(top[x]!=top[y]){\n        x=top[x];\n        if(f[x]==y)return x;\n        x=f[x];\n    }\n    return son[y];\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",&c[i]);\n    int q,x,y,opt,k;\n    for(int i=2;i<=n;++i)\n        scanf(\"%d\",&f[i]),add(f[i],i);\n    dfs(1);bt(1,1);\n    build(1,n,1);\n    scanf(\"%d\",&q);\n    while(q--){\n        scanf(\"%d%d\",&opt,&x);\n        if(opt==1)RT=x;\n        if(opt==2)scanf(\"%d%d\",&y,&k),ul(x,y,k);\n        if(opt==3){\n            scanf(\"%d\",&k);\n            if(x==RT)upd(1,n,k,1,n,1);\n            else if(id[x]<=id[RT]&&id[RT]+siz[RT]<=id[x]+siz[x]){\n                int t=child(RT,x);\n                upd(1,n,k,1,n,1);\n                upd(id[t],id[t]+siz[t]-1,-k,1,n,1);\n            }\n            else upd(id[x],id[x]+siz[x]-1,k,1,n,1);\n        }\n        if(opt==4)scanf(\"%d\",&y),printf(\"%lld\\n\",fh(x,y));\n        if(opt==5){\n            if(x==RT)printf(\"%lld\\n\",s[1]);\n            else if(id[x]<=id[RT]&&id[RT]+siz[RT]<=id[x]+siz[x]){\n                int t=child(RT,x);\n                printf(\"%lld\\n\",s[1]-ask(id[t],id[t]+siz[t]-1,1,n,1));\n            }\n            else printf(\"%lld\\n\",ask(id[x],id[x]+siz[x]-1,1,n,1));\n        }\n    }\n}\n```\n", "link": "/posts/LOJ 139 \u6811\u94fe\u5256\u5206/", "tags": ["\u6811\u94fe\u5256\u5206", "\u6a21\u677f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2664 \u6811\u4e0a\u6e38\u620f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2664&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2664\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8003\u8651\u4e00\u79cd\u989c\u8272\u5bf9\u7b54\u6848\u7684\u8d21\u732e\n\n\u628a\u6811\u4e2d\u8fd9\u79cd\u989c\u8272\u7684\u70b9\u90fd\u5220\u6389,\u90a3\u4e48\u5c31\u4f1a\u6709\u5f88\u591a\u7684\u5c0f\u6811,\u8fd9\u4e9b\u5c0f\u6811\u4e2d\u7684\u70b9\u4e92\u76f8\u4e4b\u95f4\u4e0d\u4f1a\u4ea7\u751f\u8d21\u732e,\u800c\u4e0d\u540c\u6811\u7684\u4e24\u4e2a\u70b9\u4e4b\u95f4\u4f1a\u4ea7\u751f\u8d21\u732e\u3002\n\n\u53ef\u4ee5\u5f97\u5230\u6bcf\u4e00\u79cd\u989c\u8272,\u70b9\u7684sum\u503c\u5c31\u662f**n - \u6240\u5728\u5c0f\u6811\u7684size**\n\n\u4e00\u4e2a\u70b9\u7684sum\u5c31\u662f**n * \u989c\u8272\u6570 - \u6bcf\u79cd\u989c\u8272\u8282\u70b9\u6240\u5728\u5c0f\u6811\u7684size**\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,cnt=0,cs=0,head[N],col[N],siz[N],del[N],csz[N],tag[N];\nll ans[N],qwq=0;\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nbool v[N];\nvoid dfs(int x,int f){\n    siz[x]=1;\n    int tt=del[col[f]];\n    fl(i,x)if(to!=f){\n        dfs(to,x);\n        siz[x]+=siz[to];\n    }\n    ++del[col[x]];\n    if(f){\n        csz[x]=siz[x]-del[col[f]]+tt;//\u6bcf\u79cd\u989c\u8272\u8282\u70b9\u6240\u5728\u5c0f\u6811\u7684size\n        del[col[f]]+=csz[x];\n    }\n}\nvoid get(int x,int f){\n    int oldtag=tag[col[f]];\n    qwq+=csz[x]-tag[col[f]];\n    tag[col[f]]=csz[x];\n    ans[x]=1ll*n*cs-qwq+tag[col[x]];\n    fl(i,x)if(to!=f)get(to,x);\n    tag[col[f]]=oldtag;\n    qwq-=csz[x]-tag[col[f]];\n}\nint main(){\n    in(n);\n    Fur(i,1,n){\n        in(col[i]);\n        if(!v[col[i]])v[col[i]]=1,++cs;\n    }\n    int x,y;\n    Fur(i,1,n-1)\n        in(x,y),\n        add(x,y),add(y,x);\n    \n    dfs(1,0);\n    Fur(i,1,100000)\n    if(v[i]){\n        qwq+=n-del[i];\n        tag[i]=n-del[i];\n    }\n    get(1,0);\n    Fur(i,1,n)out(ans[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 2664 \u6811\u4e0a\u6e38\u620f/", "tags": ["\u70b9\u5206\u6cbb", "\u6811\u4e0a\u5dee\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF161D Distance-in-Tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF161D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF161D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u70b9\u5206\u6cbb\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 500011\n#define inf 1000000000\n#define ll long long\nint n,k,cnt=0,SZ,rt,mxs,head[N],siz[N];\nbool v[N];\nstruct edge{\n    int to,nxt;\n}e[N<<1];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nvoid frt(int x,int f){\n    siz[x]=1;\n    int res=0;\n    fl(i,x)if(!v[to]&&to!=f){\n        frt(to,x);\n        siz[x]+=siz[to];\n        res=max(res,siz[to]);\n    }\n    res=max(res,SZ-siz[x]);\n    if(res<mxs)rt=x,mxs=res;\n}\nint b[N],tt;\nll ans=0;\nvoid gd(int x,int d,int f){\n    if(d>k)return;\n    b[++tt]=d;\n    fl(i,x)if(!v[to]&&to!=f)gd(to,d+1,x);\n}\nll calc(int x,int d){\n    tt=0;gd(x,d,0);\n    sort(b+1,b+tt+1);\n    int l=0,r=tt;\n    ll res=0;\n    while(l<r){\n        ++l;\n        while(b[l]+b[r]>k&&l<r)--r;\n        if(b[l]+b[r]==k){\n            int t1=1,t2=1;\n            while(l<r&&b[l]==b[l+1])++l,++t1;\n            while(l<r&&b[r]==b[r-1])--r,++t2;\n            if(b[l]!=b[r])res+=1ll*t1*t2;\n            else res+=1ll*(t1+t2)*(t1+t2-1)/2ll;\n        }\n    }\n    return res;\n}\nvoid sol(int x){\n    v[x]=1;ans+=calc(x,0);\n    fl(i,x)if(!v[to]){\n        ans-=calc(to,1);\n        rt=0,mxs=inf;SZ=siz[to];\n        frt(to,0);\n        sol(rt);\n    }\n}\nint main(){\n    scanf(\"%d%d\",&n,&k);\n    int x,y;\n    for(int i=1;i<=n-1;++i)\n        scanf(\"%d%d\",&x,&y),\n        add(x,y),add(y,x);\n    \n    rt=0,mxs=inf,SZ=n;\n    frt(1,0);\n    sol(rt);\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG CF161D Distance-in-Tree/", "tags": ["\u70b9\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2634 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u806a\u806a\u53ef\u53ef", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2634&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2634\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u70b9\u5206\u6cbb\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 20011\nint n,cnt=0,head[N];\nstruct edge{\n    int to,nxt,w;\n}e[N<<1];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n}\nint siz[N],SZ,rt,mxs,ans=0,b[3];\nbool v[N];\nvoid frt(int x,int f){\n    siz[x]=1;\n    int res=0;\n    fl(i,x)if(!v[to]&&to!=f){\n        frt(to,x);\n        siz[x]+=siz[to];\n        res=MAX(res,siz[to]);\n    }\n    res=MAX(res,SZ-siz[x]);\n    if(res<mxs)rt=x,mxs=res;\n}\nvoid gd(int x,int d,int f){\n    ++b[d%3];\n    fl(i,x)if(!v[to]&&to!=f)gd(to,d+e[i].w,x);\n}\nint calc(int x,int d){\n    clr(b,0);\n    gd(x,d,0);\n    return b[0]*b[0]+b[1]*(b[2]<<1);\n}\nvoid sol(int x){\n    v[x]=1;\n    ans+=calc(x,0);\n    fl(i,x)if(!v[to]){\n        ans-=calc(to,e[i].w);\n        rt=0,mxs=inf,SZ=siz[to];\n        frt(to,x);\n        sol(rt);\n    }\n}\nint main(){\n    in(n);\n    int x,y,w;\n    Fur(i,1,n-1)\n        in(x,y,w),\n        add(x,y,w),\n        add(y,x,w);\n    \n    rt=0,mxs=inf;SZ=n;\n    frt(1,0);\n    sol(rt);\n    int fm=n*n,gcd=GCD(fm,ans);\n    fm/=gcd;ans/=gcd;\n    cout<<ans<<\"/\"<<fm<<endl;\n}\n```\n", "link": "/posts/LG 2634 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u806a\u806a\u53ef\u53ef/", "tags": ["\u70b9\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG UVA1608 \u4e0d\u65e0\u804a\u7684\u5e8f\u5217 Non-boring sequences", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/UVA1608&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/UVA1608\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u5148\u9884\u5904\u7406\u51fa$L_i,R_i$\u5206\u522b\u8868\u793a\u4e0e$a_i$\u76f8\u540c\u7684\u6570\u51fa\u73b0\u5728$i$\u5de6\u8fb9\u548c\u53f3\u8fb9\u7684\u4f4d\u7f6e\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5206\u6cbb\u6765\u5224\u65ad\u4e00\u4e2a\u533a\u95f4\u662f\u5426\u5408\u6cd5\n\n\u6211\u4eec\u8bbe\u5f53\u524d\u533a\u95f4\u4e3a$[l,r]$\n\n\u4ece\u4e24\u8fb9\u4e00\u8d77\u627e\n\n\u5047\u8bbe\u679a\u4e3e\u5230\u4f4d\u7f6e$i$\u82e5$L_i\uff1cl$\u4e14$R_i>r$,\u90a3\u4e48\u5de6\u7aef\u70b9\u5728$[l,i]$,\u53f3\u7aef\u70b9\u5728$[i,r]$\u7684\u533a\u95f4\u90fd\u662f\"non-boring\"\n\n\u8fd9\u65f6\u6211\u4eec\u53ea\u9700\u8981\u5224\u65ad\u533a\u95f4$[l,i-1]$\u548c$[i+1,r]$\u662f\u5426\u5408\u6cd5\u5c31\u53ef\u4ee5\u4e86\n\n\u590d\u6742\u5ea6\u53ef\u4ee5\u964d\u81f3$\\Theta(n \\log n)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\nint n,a[N],L[N],R[N];\nmap<int,int>mp;\nbool chk(int l,int r){\n    if(l>=r)return 1;\n    int i=l,j=r;\n    while(i<=j){\n        if(L[i]<l&&R[i]>r)return chk(l,i-1)&&chk(i+1,r);\n        if(L[j]<l&&R[j]>r)return chk(l,j-1)&&chk(j+1,r);\n        ++i;--j;\n    }\n    return 0;\n}\nvoid work(){\n    in>>n;\n    Fur(i,1,n)in>>a[i];\n    mp.clear();\n    Fdr(i,n,1){\n        R[i]=mp[a[i]];\n        if(!R[i])R[i]=n+1;\n        mp[a[i]]=i;\n    }\n    mp.clear();\n    Fur(i,1,n){\n        L[i]=mp[a[i]];\n        mp[a[i]]=i;\n    }\n    out<<(chk(1,n)?\"non-boring\":\"boring\")<<ln;\n}\nint main(){\n    fin(\"in\");\n    int T;in>>T;\n    while(T--)work();\n}\n```\n", "link": "/posts/LG UVA1608 \u4e0d\u65e0\u804a\u7684\u5e8f\u5217 Non-boring sequences/", "tags": ["\u5206\u6cbb", "\u601d\u7ef4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1762 \u5076\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1762&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1762\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/LG 1762 \u5076\u6570/", "tags": ["\u6570\u8bba", "\u6269\u5c55\u6b27\u51e0\u91cc\u5fb7"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5058 [ZJOI2004]\u55c5\u63a2\u5668", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5058&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5058\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n> qwq\n>\n> qwq\n> > > > > > > > > qwq\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 2000011\nint n,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint dfn[N],low[N],sz=0,rt,rs;\nbool cut[N];\nvoid tarjan(int x,int f){\n    low[x]=dfn[x]=++sz;\n    fl(i,x)\n    if(!dfn[to]){\n        tarjan(to,x);\n        low[x]=MIN(low[x],low[to]);\n        if(low[to]>=dfn[x]){\n            if(x!=rt)cut[x]=1;\n            else ++rs;\n        }\n    }\n    else if(to!=f)low[x]=MIN(low[x],dfn[to]);\n}\nbool v[N];\nint st,ed;\nbool bfs(int x){\n    clr(v,0);\n    v[st]=v[x]=1;\n    queue<int>q;\n    q.push(st);\n    while(!q.empty()){\n        x=q.front();q.pop();\n        fl(i,x)\n        if(to==ed)return 0;\n        else if(!v[to])v[to]=1,q.push(to);\n    }\n    return 1;\n}\nint main(){\n    in(n);\n    int x,y;\n    while(1){\n        in(x,y);\n        if(!x||!y)break;\n        add(x,y),add(y,x);\n    }\n    in(st,ed);\n    rt=st;rs=0;\n    tarjan(st,st);\n    if(rs>=2)cut[st]=1;\n    Fur(i,1,n)\n    if(cut[i]&&bfs(i))\n        return cout<<i<<endl,0;\n    cout<<\"No solution\\n\";\n}\n```\n", "link": "/posts/LG 5058 [ZJOI2004]\u55c5\u63a2\u5668/", "tags": ["tarjan", "\u53cc\u8fde\u901a\u5206\u91cf", "\u5272\u70b9"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1407 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u7a33\u5b9a\u5a5a\u59fb", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1407&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1407\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u592b\u59bb\u4e4b\u95f4\uff1a$girl \\to boy$\n\n\u60c5\u4eba\u4e4b\u95f4\uff1a$boy \\to girl$\n\n$Tarjan$\u6c42\u5f3a\u8fde\u901a\u5206\u91cf,\u5bf9\u4e8e\u4e00\u5bf9\u592b\u59bb,\u5982\u679c\u4e24\u4eba\u5728\u540c\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc,\u90a3\u4e48\u8fd9\u5bf9\u5a5a\u59fb\u5c31\u662f\u4e0d\u5b89\u5168\u7684,\u53cd\u4e4b,\u5219\u662f\u5b89\u5168\u7684\u3002\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 8011\nint n,m,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[300011];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint low[N],dfn[N],sz=0,q[N],tp=0,bl[N];\nbool v[N];\nvoid tarjan(int x){\n    low[x]=dfn[x]=++sz;\n    v[x]=1;q[++tp]=x;\n    fl(i,x)\n    if(!dfn[to])\n        tarjan(to),low[x]=MIN(low[x],low[to]);\n    else if(v[to])low[x]=MIN(low[x],dfn[to]);\n    \n    if(dfn[x]==low[x])\n    while(int k=q[tp--]){\n        bl[k]=x;v[k]=0;\n        if(k==x)break;\n    }\n}\n#include<bits/extc++.h>\nusing namespace __gnu_pbds;\ncc_hash_table<string,int>T;\nint main(){\n    in(n);\n    int x,y;\n    string s1,s2;\n    Fur(i,1,n){\n        in(s1,s2);\n        T[s1]=i;\n        T[s2]=i+n;\n        add(i,i+n);\n    }\n    in(m);\n    Fur(i,1,m){\n        in(s1,s2);\n        add(T[s2],T[s1]);\n    }\n    Fur(i,1,n*2)if(!dfn[i])tarjan(i);\n    Fur(i,1,n)\n        out((bl[i]!=bl[i+n])?\"Safe\":\"Unsafe\",ln);\n    flush();\n}\n```\n", "link": "/posts/LG 1407 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u7a33\u5b9a\u5a5a\u59fb/", "tags": ["tarjan", "\u5f3a\u8fde\u901a\u5206\u91cf"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3469 [POI2008]BLO-Blockade", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3469&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3469\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5047\u8bbe\u5f53\u524d\u88ab\u5c01\u9501\u7684\u662f$x$\n\n\u5220\u6389$x$\u540e\u56fe\u4f1a\u53d8\u6210\u82e5\u5e72\u4e2a\u8fde\u901a\u5757,\u8bbe\u8fd9\u4e9b\u8fde\u901a\u5757\u5927\u5c0f\u4e3a$t_1,t_2,...,t_a$\n\n\u90a3\u4e48\u7b54\u6848\u52a0\u4e0a$\\sum_{i=1}^a t_i\\times(n-t_i)$\n\n\u5982\u679c$x$\u4e0d\u662f\u5272\u70b9,\u90a3\u4e48\u9664$x$\u5916\u7684\u70b9\u90fd\u8fde\u901a,\u7b54\u6848\u52a0\u4e0a$2\\times(n-1)$($x$\u548c\u5176\u4ed6$n-1$\u4e2a\u70b9\u914d\u5bf9)\n\n\u5982\u679c$x$\u662f\u5272\u70b9,\u7b54\u6848\u52a0\u4e0a$(1+sum)\\times(n-sum-1)+n-1$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,m,cnt=0,head[N],siz[N];\nstruct edge{\n    int to,nxt;\n}e[1000011];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nbool cut[N];\nint dfn[N],low[N],sz=0,rt,rs;\nll ans[N];\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;\n    siz[x]=1;\n    int sum=1,cc=0;\n    fl(i,x)\n    if(!dfn[to]){\n        tarjan(to);\n        siz[x]+=siz[to];\n        low[x]=MIN(low[x],low[to]);\n        if(low[to]>=dfn[x]){\n            ans[x]+=1ll*siz[to]*(n-siz[to]);\n            sum+=siz[to];\n            ++cc;\n            if(x!=1||cc>=2)cut[x]=1;\n        }\n    }\n    else low[x]=MIN(low[x],dfn[to]);\n    if(!cut[x])ans[x]=2*(n-1);\n    else ans[x]+=1ll*sum*(n-sum)+n-1;\n}\n\nint main(){\n    in(n,m);\n    int x,y;\n    Fur(i,1,m)\n        in(x,y),\n        add(x,y),add(y,x);\n\n    tarjan(1);\n    Fur(i,1,n)out(ans[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3469 [POI2008]BLO-Blockade/", "tags": ["tarjan", "\u5272\u70b9"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3225 [HNOI2012]\u77ff\u573a\u642d\u5efa", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3225&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3225\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n\u7528$Tarjan$\u8dd1\u51fa\u5272\u70b9,\u7136\u540e$DFS$\u641c\u7d22\u6240\u6709\u7684\u8054\u901a\u5feb\n\n\u8ba1\u7b97\u6bcf\u4e00\u4e2a\u8054\u901a\u5feb\u4e2d\u7684\u5272\u70b9\u6570\u76ee\n\n\u5206\u7c7b\u8ba8\u8bba\uff1a\n\n1. \u6ca1\u6709\u5272\u70b9\n   \n   \u81f3\u5c11\u9700\u8981\u5efa\u7acb\u4e24\u4e2a\u51fa\u53e3\n\n   \u4ece\u4efb\u610f\u975e\u5272\u70b9\u7684\u5730\u65b9\u9009\u62e9\u4e24\u4e2a\u70b9\u5efa\u7acb\n\n2. \u8fd9\u4e2a\u5206\u7ec4\u53ea\u6709\u4e00\u4e2a\u5272\u70b9\n\n   \u53ea\u9700\u8981\u5728\u5206\u7ec4\u5185\u8bbe\u7acb\u4e00\u4e2a\u51fa\u53e3\n\n   \u53ef\u4ee5\u8bbe\u7acb\u5728\u4efb\u610f\u4e00\u4e2a\u975e\u5272\u70b9\u7684\u5730\u65b9\n\n3. \u6709\u4e24\u4e2a\u53ca\u4ee5\u4e0a\u4e2a\u5272\u70b9,\u5219\u65e0\u9700\u5efa\u7acb,\u53ef\u4ee5\u76f4\u63a5\u5230\u8fbe\u5176\u4ed6\u8054\u901a\u5757\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 50011\nint n,m,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[100011];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint dfn[N],low[N],sz=0,rt,rs,v[N],tt,num,cuts=0;\nbool cut[N];\nvoid tarjan(int x,int f){\n    dfn[x]=low[x]=++sz;\n    fl(i,x)\n    if(!dfn[to]){\n        tarjan(to,x);\n        low[x]=MIN(low[x],low[to]);\n        if(low[to]>=dfn[x]){\n            if(x!=rt)cut[x]=1;\n            else ++rs;\n        }\n    }\n    else if(to!=f)low[x]=MIN(low[x],dfn[to]);\n}\nvoid dfs(int x){\n    v[x]=tt;\n    ++num;\n    fl(i,x){\n        if(cut[to]&&v[to]!=tt){\n            ++cuts;\n            v[to]=tt;\n        }\n        if(!v[to])dfs(to);\n    }\n}\nint CASE=0;\nvoid work(){\n    in(m);\n    if(!m)flush(),exit(0);\n    clr(head,0);sz=cnt=tt=0;\n    clr(cut,0);clr(v,0);\n    clr(dfn,0);clr(low,0);\n\n    int x,y;\n    ll ans1=0,ans2=1;\n    n=0;\n    Fur(i,1,m){\n        in(x,y);\n        add(x,y),add(y,x);\n        n=MAX(n,MAX(x,y));\n    }\n    Fur(i,1,n)\n    if(!dfn[i]){\n        rt=i;rs=0;\n        tarjan(i,i);\n        if(rs>=2)cut[i]=1;\n    }\n    Fur(i,1,n)\n    if(!v[i]&&!cut[i]){\n        ++tt;\n        num=cuts=0;\n        dfs(i);\n        if(!cuts)\n            ans1+=2ll,\n            ans2*=1ll*(num-1)*num/2;\n        if(cuts==1)\n            ++ans1,\n            ans2*=1ll*num;\n    }\n\n    out(\"Case \",++CASE,\": \",ans1,\" \",ans2,ln);\n}\nint main(){\n    while(1)work();\n}\n```\n", "link": "/posts/LG 3225 [HNOI2012]\u77ff\u573a\u642d\u5efa/", "tags": ["tarjan", "\u7ec4\u5408\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2468 [SDOI2010]\u7c9f\u7c9f\u7684\u4e66\u67b6", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2468&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2468\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u770b\u6210\u4e24\u9053\u9898\u5427\n\n\u524d$50\\%$: \u4e8c\u7ef4\u524d\u7f00\u548c+\u4e8c\u5206\n\n\u540e$50\\%$: \u4e3b\u5e2d\u6811\u540c\u65f6\u7ef4\u62a4\u533a\u95f4\u5927\u4e8e$k$\u7684\u4e2a\u6570\u3001\u603b\u548c,\u7136\u540e\u4e8c\u5206\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500011\nint n,a[N];\nint R,C,M,p[211][211],w[211][211][1001],W[211][211][1001];\nint getw(int x,int y,int X,int Y,int k){\n    return w[X][Y][k]-w[x-1][Y][k]-w[X][y-1][k]+w[x-1][y-1][k];\n}\nint getW(int x,int y,int X,int Y,int k){\n    return W[X][Y][k]-W[x-1][Y][k]-W[X][y-1][k]+W[x-1][y-1][k];\n}\nvoid sol1(){\n    int mx=0;\n    Fur(i,1,R)\n        Fur(j,1,C)\n            in(p[i][j]),\n            mx=MAX(mx,p[i][j]);\n    \n    Fur(k,0,mx)\n        Fur(i,1,R)\n            Fur(j,1,C)\n                w[i][j][k]=w[i-1][j][k]+w[i][j-1][k]-w[i-1][j-1][k]+(p[i][j]>=k),\n                W[i][j][k]=W[i-1][j][k]+W[i][j-1][k]-W[i-1][j-1][k]+(p[i][j]>=k?p[i][j]:0);\n        \n    while(M--){\n        int x,y,X,Y,h;\n        in(x,y,X,Y,h);\n        if(getW(x,y,X,Y,0)<h)out(\"Poor QLW\\n\");\n        else{\n            int l=0,r=mx+1,ans=-1;\n            while(l+1<r){\n                int m=(l+r)>>1;\n                if(getW(x,y,X,Y,m)>=h)ans=m,l=m;\n                else r=m;\n            }\n            if(ans==-1)out(\"Poor QLW\\n\");\n            else out(getw(x,y,X,Y,ans)-(getW(x,y,X,Y,ans)-h)/ans,ln);\n        }\n    }\n}\nint rt[N],ls[N*20],rs[N*20],s[N*20],S[N*20],sz=0;\nvoid build(int &x,int l,int r){\n    s[x=++sz]=0;\n    S[x]=0;\n    if(l==r)return;\n    int m=(l+r)>>1;\n    build(ls[x],l,m);build(rs[x],m+1,r);\n}\nvoid ins(int l,int r,int v,int &x,int pre){\n    x=++sz;\n    s[x]=s[pre]+1;\n    S[x]=S[pre]+v;\n    ls[x]=ls[pre];\n    rs[x]=rs[pre];\n    if(l==r)return;\n    int m=(l+r)>>1;\n    if(v<=m)ins(l,m,v,ls[x],ls[pre]);\n    else ins(m+1,r,v,rs[x],rs[pre]);\n}\nint ask(int l,int r,int tt,int x,int y){\n    int ans=0;\n    while(l<r){\n        int m=(l+r)>>1;\n        int sum=S[rs[y]]-S[rs[x]];\n        if(sum<tt)ans+=s[rs[y]]-s[rs[x]],tt-=sum,r=m,x=ls[x],y=ls[y];\n        else l=m+1,x=rs[x],y=rs[y];\n    }\n    ans+=(tt+l-1)/l;\n    return ans;\n}\nvoid sol2(){\n    n=C;\n    build(rt[0],1,1000);\n    Fur(i,1,n)in(a[i]),ins(1,1000,a[i],rt[i],rt[i-1]);\n    int l,r,h;\n    while(M--){\n        in(l,l,r,r,h);\n        if(S[rt[r]]-S[rt[l-1]]<h)out(\"Poor QLW\\n\");\n        else out(ask(1,1000,h,rt[l-1],rt[r]),ln);\n    }\n}\nint main(){\n    in(R,C,M);\n    if(R!=1)sol1();\n    else sol2();\n    flush();\n}\n```\n", "link": "/posts/LG 2468 [SDOI2010]\u7c9f\u7c9f\u7684\u4e66\u67b6/", "tags": ["\u4e3b\u5e2d\u6811", "\u4e8c\u5206", "\u4e8c\u7ef4\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3573 [POI2014]RAJ-Rally", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3573&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3573\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fd9\u4e2a\u56fe\u662f\u4e2aDAG,\u6211\u4eec\u53ef\u4ee5\u5f88\u5feb\u5730\u5904\u7406\u51fa\u6bcf\u4e2a\u70b9\u4ee5\u4ed6\u4e3a\u8d77\u70b9($ds_i$)\u6216\u7ec8\u70b9($dt_i$)\u7684\u6700\u957f\u8def\n\n\u63a5\u7740\u6211\u4eec\u679a\u4e3e\u5220\u6389\u54ea\u4e2a\u70b9\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u62d3\u6251\u5e8f\u5c0f\u4e8e\u5f53\u524d\u70b9\u7684\u70b9\u79f0\u4f5cA\u96c6\u5408,\u5927\u4e8e\u7684\u79f0\u4f5cB\u96c6\u5408\n\n\u5220\u6389\u8fd9\u4e2a\u70b9\u540e\u7684\u6700\u957f\u8def\u6709\u4e09\u79cd\u53ef\u80fd\uff1a\n\n$A\\rightarrow A,A\\rightarrow B,B\\rightarrow B$\n\n($to$\u6307x\u8fde\u63a5\u7684\u70b9)\n\n\u5f53\u5220\u9664\u4e00\u4e2a\u70b9$x$\u65f6,\u6211\u4eec\u53ef\u4ee5\u5220\u53bb\u6240\u6709\u96c6\u5408\u4e2d\u7684$dt_{to}+1+ds_x$(\u53cd\u5411\u56fe\u4e2d\u7684)\n\n\u6c42\u51fa\u96c6\u5408\u4e2d\u7684\u6700\u5927\u503c\u5c31\u662f\u5f53\u524d\u6700\u957f\u8def\u957f\u5ea6\n\n\u63a5\u7740\u5c06$dt_x+1+ds_{to}$\u52a0\u5165\u96c6\u5408,\u8f6c\u79fb\u5230\u4e0b\u4e00\u4e2a\u72b6\u6001(\u539f\u56fe\u4e2d\u7684)\n\n\u4e8e\u662f\u6211\u4eec\u9700\u8981\u4e00\u4e2a\u6570\u636e\u7ed3\u6784\u6ee1\u8db3\u4ee5\u4e0b\u8981\u6c42\uff1a\n\n1. \u63d2\u5165\u67d0\u4e2a\u503c\n2. \u5220\u9664\u67d0\u4e2a\u503c\n3. \u67e5\u627e\u6700\u5927\u503c\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u5806(\u624b\u5199\u5806\u6216\u8005\u4e24\u4e2astl\u4f18\u5148\u961f\u5217)\u3001\u5e73\u8861\u6811\u3001\u6743\u503c\u7ebf\u6bb5\u6811\u7b49\u7ef4\u62a4\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500111\n#define FL(i,x) for(int i(HEAD[x]),to;to=e[i].to,i;i=e[i].nxt)\nint n,m;\nint cnt=0,head[N],HEAD[N],deg[N];\nstruct edge{\n    int to,nxt;\n}e[N*4];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].nxt=HEAD[y];HEAD[y]=cnt;\n}\nil void init(){\n    in(n,m);\n    Fur(i,1,m){\n        int x,y;\n        in(x,y);\n        add(x,y);\n        ++deg[y];\n    }\n}\nint ds[N],dt[N],q[N],a[N],dfn=0;\nil void topsort(){\n    int h=0,t=0;\n    Fur(i,1,n)if(!deg[i])q[t++]=i;\n    while(h<t){\n        int x=q[h++];a[++dfn]=x;\n        fl(i,x)if(!--deg[to])q[t++]=to;\n    }\n    Fur(t,1,n){\n        int x=a[t];\n        fl(i,x)dt[to]=MAX(dt[to],dt[x]+1);\n    }\n    Fdr(t,n,1){\n        int x=a[t];\n        FL(i,x)ds[to]=MAX(ds[to],ds[x]+1);\n    }\n}\nstruct ddd{\n    priority_queue<int>p,q;\n    il void ins(int x){q.push(x);}\n    il void del(int x){p.push(x);}\n    il int top(){\n        while(!p.empty()&&q.top()==p.top())\n            q.pop(),p.pop();\n        return q.top();\n    }\n}T;\nil void solve(){\n    Fur(i,1,n)T.ins(ds[i]);\n    int ans=T.top(),as;\n    Fur(t,1,n){\n        int x=a[t];T.del(ds[x]);\n        FL(i,x)T.del(dt[to]+1+ds[x]);\n        int tmp=T.top();\n        if(tmp<=ans)ans=tmp,as=x;\n        fl(i,x)T.ins(dt[x]+1+ds[to]);\n        T.ins(dt[x]);\n    }\n    cout<<as<<\" \"<<ans<<endl;\n}\nint main(){\n    init();\n    topsort();\n    solve();\n}\n```\n", "link": "/posts/LG 3573 [POI2014]RAJ-Rally/", "tags": ["dag", "\u5806", "\u6743\u503c\u7ebf\u6bb5\u6811", "\u6570\u636e\u7ed3\u6784", "\u5e73\u8861\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "BZ 3732 Network", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://remmina.github.io/BZPRO/JudgeOnline/3732.html&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://remmina.github.io/BZPRO/JudgeOnline/3732.html\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nkruskal\u91cd\u6784\u6811\u6a21\u677f\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{\n    const int str=1<<20;\n    //in\n    static char in_buf[str],*in_s,*in_t;\n    bool __=0;\n    il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}\n    template<typename T>\n    il void in(T &x){\n        if(__)return;\n        char c=gc();\n        bool f=0;\n        while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();\n        if(c==EOF){__=1;return;}\n        x=0;\n        while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();\n        if(c==EOF)__=1;\n        if(f)x=-x;\n    }\n\n    //out\n    const char ln='\\n';\n    static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;\n    il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}\n    il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}\n    template<typename T>\n    il void out(T x){\n        if(!x){pt('0');return;}\n        if(x<0)pt('-'),x=-x;\n        char a[50],t=0;\n        while(x)a[t++]=x%10,x/= 10;\n        while(t--)pt(a[t]+'0');\n    }\n}using namespace IO;\n#define N 30011\nint n,m,q,cnt=0,head[N],f[N],ne[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nstruct link{\n    int x,y,w;\n    il bool operator<(link x){return w<x.w;}\n}E[N];\nint gf(int x){return (x==f[x])?x:(f[x]=gf(f[x]));}\nint s[16][N];\nil void st(){\n    int sz=l2(n<<1);\n    Fur(k,1,sz)\n        Fur(i,1,(n<<1)-(1<<k)+1)\n        s[k][i]=MAX(s[k-1][i],s[k-1][i+(1<<(k-1))]);\n}\nil int ask(int l,int r){\n    int k=l2(r-l+1);\n    return MAX(s[k][l],s[k][r-(1<<k)+1]);\n}\nint top[N],d[N],siz[N],id[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x){\n        d[to]=d[x]+1;\n        f[to]=x;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;\n    s[0][sz]=ne[x];\n    int k=0;\n    fl(i,x)if(siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(to!=k)bt(to,to);\n}\nil int fh(int x,int y){\n    int ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans=MAX(ans,ask(id[top[x]],id[x]));x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    return MAX(ans,ask(id[x],id[y]));\n}\nint main(){\n    in(n),in(m),in(q);\n    int x,y,w,t=n;\n    Fur(i,1,m)in(E[i].x),in(E[i].y),in(E[i].w);\n    sort(E+1,E+m+1);\n    Fur(i,1,n)f[i]=i;\n    Fur(i,1,m){\n        x=gf(E[i].x),y=gf(E[i].y);\n        if(x==y)continue;\n        ne[++t]=E[i].w;\n        f[x]=f[y]=f[t]=t;\n        add(t,x),add(t,y);\n    }\n    dfs(t);\n    bt(t,t);\n    st();\n    while(q--)\n        in(x),in(y),\n        out(fh(x,y)),pt(ln);\n    flush();\n}\n```\n", "link": "/posts/BZ 3732 Network/", "tags": ["kruskal\u91cd\u6784\u6811", "rmq", "lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4768 [NOI2018]\u5f52\u7a0b", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4768&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4768\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u60f3\u60f3\u66b4\u529b\u505a\u6cd5\uff1a\n\nbfs\u51fa\u4e0d\u6d89\u6c34\u53ef\u4ee5\u5230\u8fbe\u7684\u70b9,\u7136\u540e\u5728\u8fd9\u4e9b\u70b9\u4e2d\u627e\u51fa\u4e0e\u70b9$1$\u7684\u6700\u5c0f\u8ddd\u79bb\n\n\u4f18\u5316\uff1a\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528kruskal\u91cd\u6784\u6811\u6765\u5feb\u901f\u6c42\u51fa\u8fd9\u4e9b\u70b9\n\n\u5148\u6309\u6d77\u62d4\u4ece\u9ad8\u5230\u4f4e\u6392\u5e8f,\u8fd9\u6837\u89c1\u51fa\u6765\u7684kruskal\u91cd\u6784\u6811\u7684\u662f\u6d77\u62d4\u7684\u5c0f\u6839\u5806\n\n\u6211\u4eec\u53ef\u4ee5\u500d\u589e\u627e\u51fa\u6700\u8fdc\u53ef\u4ee5\u5230\u8fbe\u7684\u7956\u5148,\u7136\u540e\u6c42\u51fa\u8fd9\u6bb5\u533a\u95f4\u4e2d\u7684\u70b9\u4e0e\u70b9$1$\u7684\u6700\u5c0f\u8ddd\u79bb\n\n\u53ef\u4ee5\u5728dfs\u7684\u65f6\u5019\u9884\u5904\u7406\n\n\u8be6\u89c1\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,m,cnt=0,d[N<<1],head[N];\nstruct link{\n    int x,y,l,a;\n    il bool operator<(link b){return a>b.a;}\n}E[N<<1];\nstruct edge{int to,nxt,w;}e[N<<2];\nil void add(int x,int y,int w){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;}\nbool v[N];\nil void dij(){\n    struct cmp{il bool operator()(int x,int y){return d[x]>d[y];}};\n    priority_queue<int,vector<int>,cmp>q;\n    Fur(i,1,n)d[i]=inf;\n    d[1]=0;\n    q.push(1);\n    while(!q.empty()){\n        int x=q.top();v[x]=0;q.pop();\n        fl(i,x)if(d[x]+e[i].w<d[to]){\n            d[to]=d[x]+e[i].w;\n            if(!v[to])v[to]=1,q.push(to);\n        }\n    }\n}\nint fa[N<<1],ne[N<<1],f[21][N<<1];\nint gf(int x){return (x==fa[x])?x:(fa[x]=gf(fa[x]));}\nint ls[N<<1],rs[N<<1];\nvoid dfs(int x){\n    Fur(i,1,20)f[i][x]=f[i-1][f[i-1][x]];\n    if(!ls[x])return;\n    dfs(ls[x]),dfs(rs[x]);\n    d[x]=MIN(d[ls[x]],d[rs[x]]);\n}\nil void work(){\n    clr(head,0);cnt=0;\n    clr(ls,0);clr(rs,0);\n    in(n,m);\n    int x,y,l,a,t=n;\n    Fur(i,1,m){\n        in(x,y,l,a);\n        E[i]=link{x,y,l,a};\n        add(x,y,l);add(y,x,l);\n    }\n    dij();\n    sort(E+1,E+m+1);\n    Fur(i,1,n*2+1)fa[i]=i;\n    Fur(i,1,m){\n        x=gf(E[i].x),y=gf(E[i].y);\n        if(x==y)continue;\n        ne[++t]=E[i].a;\n        fa[x]=fa[y]=fa[t]=t;\n        f[0][x]=f[0][y]=t;\n        ls[t]=x;rs[t]=y;\n    }\n    dfs(t);\n    int Q,K,S,p,la=0;\n    in(Q,K,S);\n    while(Q--){\n        in(x,p);\n        x=(x+K*la-1)%n+1;\n        p=(p+K*la)%(S+1);\n        Fdr(i,20,0)if(f[i][x]&&ne[f[i][x]]>p)x=f[i][x];\n        out(la=d[x],ln);\n    }\n}\nint main(){\n    int T;in(T);\n    while(T--)work();\n    flush();\n}\n```\n", "link": "/posts/LG 4768 [NOI2018]\u5f52\u7a0b/", "tags": ["\u6700\u77ed\u8def", "kruskal\u91cd\u6784\u6811", "\u500d\u589e"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5091 \u3010\u6a21\u677f\u3011\u6b27\u62c9\u5b9a\u7406", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5091&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5091\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u6269\u5c55\u6b27\u62c9\u5b9a\u7406\n\n\u5f53$b\\ge \\varphi(m)$\u65f6,$a^b \\equiv a^{(b \\mod \\varphi(m))+\\varphi(m)} \\pmod m$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint a,m,b;\nint main(){\n    scanf(\"%d%d\",&a,&m);\n    \n}\n```\n", "link": "/posts/LG 5091 \u3010\u6a21\u677f\u3011\u6b27\u62c9\u5b9a\u7406/", "tags": ["\u6570\u8bba", "\u6b27\u62c9\u5b9a\u7406"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4197 Peaks", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4197&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4197\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u7b97\u662f$kruskal$\u91cd\u6784\u6811\u7684\u6a21\u677f\u9898\n\n\u5efa\u5b8c$kruskal$\u91cd\u6784\u6811,\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4e00\u4e2a\u8282\u70b9(\u65b0\u5efa\u7684\u5e26\u70b9\u6743\u7684\u70b9)\u80fd\u8d70\u5230\u7684\u8282\u70b9\u4e00\u5b9a\u5728\u5b83\u7684\u5b50\u6811\u4e2d\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5\u7528$dfs$\u5e8f+\u4e3b\u5e2d\u6811\u7ef4\u62a4\n\n> ## kruskal\u91cd\u6784\u6811\n> \n> \u6211\u4eec\u56de\u60f3\u4e00\u4e0b$kruskal$\u751f\u6210\u6700\u5c0f\u751f\u6210\u6811\u7684\u8fc7\u7a0b\uff1a\n> \n> \u5148\u5c06\u8fb9\u6309\u8fb9\u6743\u4ece\u5c0f\u5230\u5927\u6392\u5e8f,\u7136\u540e\u4f9d\u6b21\u52a0\u5165\n> \n> \u5982\u679c$x,y$\u5df2\u7ecf\u8054\u901a,\u5219\u8df3\u8fc7\u8fd9\u6761\u8fb9\n> \n> \u5426\u5219\u8fde\u63a5$x,y$\n> \n> $kruskal$\u91cd\u6784\u6811\u662f\u5728$kruskal$\u751f\u6210\u6700\u5c0f\u751f\u6210\u6811\u7684,\n> \n> \u8fde\u63a5$x,y$\u65f6,\u5c06\u8fb9\u6743\u53d8\u6210\u4e00\u4e2a\u65b0\u7684\u8282\u70b9$t$\u6743\u503c\u4e3a\u8fb9\u6743,\u7136\u540e\u8fde\u8fb9> $t\\rightarrow x,t\\rightarrow y$\n> \n> \u4ee3\u7801\uff1a\n> \n> <!-- more -->\n\n> ```cpp\n> void kruskal(){\n>     int x,y,tt=n;\n>     sort(E+1,E+m+1);//\u5c06\u8fb9\u6392\u5e8f\n>     Fur(i,1,n)fa[i]=i;\n>     Fur(i,1,m){\n>         x=gf(E[i].x),y=gf(E[i].y);\n>         if(x==y)continue;//\u5982\u679c\u5df2\u7ecf\u8054\u901a\u5219\u8df3\u8fc7\n>         ne[++tt]=E[i].w;//\u70b9\u6743\u8d4b\u503c\u4e3a\u8fb9\u6743\n>         fa[x]=fa[y]=fa[tt]=tt;\n>         f[0][x]=f[0][y]=tt;\n>         //\u7ef4\u62a4\u5e76\u67e5\u96c6\n>         add(tt,x);add(tt,y);//\u8fde\u8fb9t\u2192x,t\u2192y\n>     }\n> }\n> ```\n> \n> $kruskal$\u91cd\u6784\u6811\u8fd8\u6709\u5f88\u591a\u6709\u610f\u601d\u7684\u6027\u8d28\n> \n> 1. \u662f\u4e00\u4e2a\u4e8c\u53c9\u6811\n> 2. **\u5982\u679c\u662f\u6309\u6700\u5c0f\u751f\u6210\u6811\u5efa\u7acb\u7684\u8bdd\u662f\u4e00\u4e2a\u5927\u6839\u5806**\n> 3. \u4efb\u610f\u4e24\u4e2a\u70b9\u8def\u5f84\u4e0a\u8fb9\u6743\u7684\u6700\u5927\u503c\u4e3a\u5b83\u4eec\u7684LCA\u7684\u70b9\u6743\n> 4. \u91cd\u6784\u6811\u4e2d\u4ee3\u8868\u539f\u6811\u4e2d\u7684\u70b9\u7684\u8282\u70b9\u5168\u662f\u53f6\u5b50\u8282\u70b9,\u5176\u4f59\u8282\u70b9\u90fd\u4ee3\u8868\u4e86\u4e00\u6761\u8fb9\u7684\u8fb9\u6743\u3002\n\n\u7ed9\u51fa\u91cd\u6784\u540e\u7684\u56fe(\u5e2e\u52a9\u7406\u89e3)\uff1a\n\n![](https://cdn.luogu.org/upload/pic/67842.png)\n\n(\u7ea2\u8272\u7684\u662f\u539f\u6765\u7684\u8282\u70b9)\n\n\u53ef\u4ee5\u500d\u589e\u6c42\u51fa\u6700\u8fdc\u7684\u6ee1\u8db3\u8981\u6c42\u7684\u7956\u5148\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,m,q,SZ=0,rt[N];\nstruct node{\n    int v,p;\n    il bool operator<(node x){return v<x.v;}\n}b[N];\nint a[N],c[N];\nstruct link{\n    int x,y,w;\n    il bool operator<(link x){return w<x.w;}\n}E[500011];\nvoid init(){\n    in(n,m,q);\n    Fur(i,1,n)in(b[i].v),b[i].p=i;\n    sort(b+1,b+n+1);\n    b[0].v=-inf;\n    sort(b+1,b+n+1);\n    Fur(i,1,n){\n        SZ+=(b[i].v!=b[i-1].v);\n        c[a[b[i].p]=SZ]=b[i].v;\n    }\n    Fur(i,1,m)in(E[i].x,E[i].y,E[i].w);\n}\nint fa[N],f[21][N];\nint gf(int x){return (x==fa[x])?x:(fa[x]=gf(fa[x]));}\nstruct tree{\n    int s[N*20],sz=0,ls[N*20],rs[N*20];\n    void build(int l,int r,int &x){\n        s[x=++sz]=0;\n        if(l==r)return;\n        int m=(l+r)>>1;\n        build(l,m,ls[x]);\n        build(m+1,r,rs[x]);\n    }\n    void ins(int l,int r,int v,int &x,int pre){\n        x=++sz;\n        s[x]=s[pre]+1;\n        ls[x]=ls[pre];\n        rs[x]=rs[pre];\n        if(l==r)return;\n        int m=(l+r)>>1;\n        if(v<=m)ins(l,m,v,ls[x],ls[pre]);\n        else ins(m+1,r,v,rs[x],rs[pre]);\n    }\n    int ask(int l,int r,int k,int x,int y){\n        if(l==r)return l;\n        int m=(l+r)>>1,sum=s[rs[y]]-s[rs[x]];\n        if(k<=sum)return ask(m+1,r,k,rs[x],rs[y]);\n        else return ask(l,m,k-sum,ls[x],ls[y]);\n    }\n}T;\nint cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nint L[N],R[N],dfn=0;\nvoid dfs(int x){\n    Fur(i,1,20)f[i][x]=f[i-1][f[i-1][x]];\n    L[x]=dfn;\n    if(!head[x]){\n        L[x]=++dfn;\n        T.ins(1,SZ,a[x],rt[dfn],rt[dfn-1]);\n        R[x]=dfn;\n        return;\n    }\n    fl(i,x)dfs(to);\n    R[x]=dfn;\n}\nint ne[N];\nvoid kruskal(){\n    int x,y,tt=n;\n    sort(E+1,E+m+1);\n    Fur(i,1,n)fa[i]=i;\n    Fur(i,1,m){\n        x=gf(E[i].x),y=gf(E[i].y);\n        if(x==y)continue;\n        ne[++tt]=E[i].w;\n        fa[x]=fa[y]=fa[tt]=tt;\n        f[0][x]=f[0][y]=tt;\n        add(tt,x);add(tt,y);\n    }\n    T.build(1,SZ,rt[0]);\n    dfs(tt);\n}\nvoid solve(){\n    int x,w,k;\n    while(q--){\n        in(x,w,k);\n        Fdr(i,20,0)if(f[i][x]&&ne[f[i][x]]<=w)x=f[i][x];\n        if(R[x]-L[x]<k)out(\"-1\\n\");\n        else out(c[T.ask(1,SZ,k,rt[L[x]],rt[R[x]])],ln);\n    }\n}\nint main(){\n    init();\n    kruskal();\n    solve();\n    flush();\n    return 0;\n}\n```\n", "link": "/posts/LG 4197 Peaks/", "tags": ["kruskal\u91cd\u6784\u6811", "\u500d\u589e", "\u4e3b\u5e2d\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3066 [USACO12DEC]\u9003\u8dd1\u7684BarnRunning-Away-From", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3066&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3066\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u89e3\u6cd51\n\n\u4e3b\u5e2d\u6811+\u79bb\u6563\u5316(\u6df1\u5ea6\u592a\u5927\u9700\u8981\u79bb\u6563\u5316)\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf (1ll<<60)\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\n#define int ll\nint n,len;\nint cnt=0,head[N];\nint d[N],f[N],mxd=0,siz[N],DFN=0,dfn[N];\nint rt[N],ls[N*30],rs[N*30],s[N*30],sz=0,b[N],tt;\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint build(int l,int r){\n    int x=++sz;\n    if(l==r)return x;\n    int m=(l+r)>>1;\n    ls[x]=build(l,m);\n    rs[x]=build(m+1,r);\n    return x;\n}\nvoid ins(int l,int r,int v,int &x,int pre){\n    x=++sz;\n    ls[x]=ls[pre];\n    rs[x]=rs[pre];\n    s[x]=s[pre]+1;\n    if(l==r)return;\n    int m=(l+r)>>1;\n    if(v<=m)ins(l,m,v,ls[x],ls[pre]);\n    else ins(m+1,r,v,rs[x],rs[pre]);\n}\nint ask(int ql,int qr,int l,int r,int x,int y){\n    if(ql<=l&&r<=qr)return s[y]-s[x];\n    int m=(l+r)>>1,ans=0;\n    if(ql<=m)ans=ask(ql,qr,l,m,ls[x],ls[y]);\n    if(qr>m)ans+=ask(ql,qr,m+1,r,rs[x],rs[y]);\n    return ans;\n}\nvoid dfs(int x){\n    siz[x]=1;\n    dfn[x]=++DFN;\n    int k=lower_bound(b+1,b+tt+1,d[x])-b;\n    ins(1,tt,k,rt[DFN],rt[DFN-1]);\n    fl(i,x)dfs(to),siz[x]+=siz[to];\n}\nsigned main(){\n    in(n,len);\n    int x,y;\n    b[1]=0;\n    Fur(i,2,n)\n        in(f[i],y),\n        b[i]=d[i]=y+d[f[i]],\n        add(f[i],i);\n    \n    b[n+1]=inf;\n    sort(b+1,b+n+2);\n    tt=unique(b+1,b+n+2)-b-1;\n\n    rt[0]=build(1,tt);\n    dfs(1);\n\n    Fur(i,1,n){\n        int k=lower_bound(b+1,b+tt+1,d[i])-b-1;\n        if(b[k+1]==d[i])++k;\n        int kk=lower_bound(b+1,b+tt+1,d[i]+len)-b-1;\n        if(b[kk+1]==d[i]+len)++kk;\n        if(kk==tt-1)out(siz[i],ln);\n        else out(ask(k,kk,1,tt,rt[dfn[i]-1],rt[dfn[i]+siz[i]-1]),ln);\n    }\n    flush();\n}\n```\n## \u89e3\u6cd52\n\n\u6811\u4e0a\u5dee\u5206+\u500d\u589e\n\n\u5bf9\u4e8e\u6bcf\u4e2a\u70b9u,\u627e\u5230\u79bb\u4ed6\u6700\u8fdc\u7684\u7956\u5148v(\u6ee1\u8db3\u8ddd\u79bb\u5c0f\u4e8elen)\n\n\u90a3\u4e48u\u5230v\u8def\u5f84\u4e0a\u6bcf\u4e2a\u70b9\u7b54\u6848+1\n\n\u53ef\u4ee5\u4f7f\u7528\u6811\u4e0a\u5dee\u5206\u7ef4\u62a4\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf (1ll<<60)\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint f[20][N],n,s[N];\nll len,d[N];\nil void gf(int x){Fur(i,1,19)f[i][x]=f[i-1][f[i-1][x]];}\nil void work(int x){\n    ++s[x];\n    ll t=len;\n    Fdr(i,19,0)if(d[x]-d[f[i][x]]<=t)\n        t-=d[x]-d[f[i][x]],x=f[i][x];\n    if(x!=1)--s[f[0][x]];\n}\nint main(){\n    in(n,len);\n    ll x;\n    f[0][1]=1;\n    Fur(i,2,n){\n        in(f[0][i],x);\n        d[i]=d[f[0][i]]+x;\n        gf(i);\n    }\n    Fur(i,1,n)work(i);\n    Fdr(i,n,2)s[f[0][i]]+=s[i];\n    Fur(i,1,n)out(s[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3066 [USACO12DEC]\u9003\u8dd1\u7684BarnRunning-Away-From/", "tags": ["\u4e3b\u5e2d\u6811", "dfs\u5e8f", "\u79bb\u6563\u5316", "\u5dee\u5206", "\u500d\u589e"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "POJ 3696 The-Luckiest-number", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$\\overbrace{88...88}^{x\\text{\u4e2a}8}$\u53ef\u4ee5\u8868\u793a\u6210\uff1a\n\n$8\\times \\frac{(10^x-1)}9$\n\n\u90a3\u4e48$8\\times \\frac{(10^x-1)}9=kL$\n\n$8\\times (10^x-1)=9kL$\n\n\u8bbe$d=\\gcd(9L,8)=\\gcd(8,L)$\n\n$\\frac{8}d\\times (10^x-1)=\\frac{9L}dk$\n\n\u4ee4$p=\\frac8d,q=\\frac{9L}{d}$\n\n$p\\times (10^x-1)=qk$\n\n$\\because \\gcd(p,q)=1$\n\n$\\therefore q|(10^x-1)$\n\n$\\frac{9L}{d}|(10^x-1)$\n\n$10^x \\equiv 1 \\pmod {\\frac{9L}{d}}$\n\n\u9898\u76ee\u4e2d\u8981\u6c42\u7684\u662f\u6700\u5c0f\u7684\u89e3\n\n\u7b26\u5408\u6b27\u62c9\u5b9a\u7406\uff1a\n\n> \u82e5$\\gcd(a,p)=1$,\u90a3\u4e48$a^{\\varphi(p)} \\equiv 1 \\pmod p$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/POJ 3696 The-Luckiest-number/", "tags": ["\u6b27\u62c9\u51fd\u6570", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF559C Gerald-and-Giant-Chess", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF559C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF559C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_i$\u8868\u793a\u53ea\u7ecf\u8fc7\u7b2c$i$\u4e2a\u9ed1\u70b9\u7684\u65b9\u6848\u6570\n\n$f_i$\u6700\u521d\u4e3a${x_i+y_i-2}\\choose {x_i-1}$\n\n\u51cf\u53bb$(1,1)$\u5230$(x_i,y_i)$\u8fd9\u4e2a\u8303\u56f4\u5185\u6240\u6709$f_j$\u7684\u65b9\u6848\u6570\u5c31\u662f\u6700\u7ec8\u7b54\u6848\u4e86\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 2011\nconst int mod=1000000007;\nint h,w,n,f[N];\nstruct node{\n    int x,y;\n}a[N];\nbool cmp(node p,node q){\n    if(p.x!=q.x)return p.x<q.x;\n    return p.y<q.y;\n}\n#define M 200011\nint fac[200012],inv[200012];\nint pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%mod;\n        p>>=1;x=1ll*x*x%mod;\n    }\n    return ans;\n}\nvoid init(){\n    fac[0]=1;\n    Fur(i,1,M)fac[i]=1ll*fac[i-1]*i%mod;\n    inv[M]=pw(fac[M],mod-2);\n    Fdr(i,M-1,0)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n}\nint C(int x,int y){\n    if(x<y)return 0;\n    return 1ll*fac[x]*inv[y]%mod*inv[x-y]%mod;\n}\nsigned main(){\n    init();\n    in(h,w,n);\n    Fur(i,1,n)in(a[i].x,a[i].y);\n    sort(a+1,a+n+1,cmp);\n    a[++n]=node{h,w};\n    Fur(i,1,n){\n        f[i]=C(a[i].x+a[i].y-2,a[i].x-1);\n        Fur(j,1,i-1)\n        if(a[j].y<=a[i].y){\n            f[i]-=1ll*f[j]*C(a[i].x-a[j].x+a[i].y-a[j].y,a[i].x-a[j].x)%mod;\n            while(f[i]<0)f[i]+=mod;\n        }\n    }\n    cout<<f[n]<<endl;\n}\n```\n", "link": "/posts/LG CF559C Gerald-and-Giant-Chess/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u8ba1\u6570dp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2839 [\u56fd\u5bb6\u96c6\u8bad\u961f]middle", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2839&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2839\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u5148\u8003\u8651\u79bb\u6563\u5316\n\n\u79bb\u6563\u8bdd\u540e\u662f$1\uff5en$\n\n\u4e00\u822c\u8981\u6c42\u4e2d\u4f4d\u6570\u53ef\u4ee5:\n\n\u4e8c\u5206\u4e2d\u4f4d\u6570$x$\n\n\u5c06\u533a\u95f4\u4e2d$<x$\u7684\u8d4b\u503c\u4e3a$-1$,$\\ge x$\u7684\u8d4b\u503c\u4e3a$-1$\n\n\u82e5\u533a\u95f4\u548c\u4e3a$0$,\u90a3\u4e48$x$\u5c31\u662f\u4e2d\u4f4d\u6570\n\n\u9898\u76ee\u662f\u8981\u6c42\u5de6\u7aef\u70b9\u5728$[a,b]$,\u53f3\u7aef\u70b9\u5728$[c,d]$\u7684\u5e8f\u5217\u7684\u6700\u5927\u4e2d\u4f4d\u6570\n\n\u533a\u95f4$[b+1,c-1]$\u662f\u5fc5\u9009\u7684\n\n\u6211\u4eec\u53ef\u4ee5\u6c42$[a,b]$\u7684\u6700\u5927\u540e\u7f00\u548c$[c,d]$\u7684\u6700\u5927\u524d\u7f00\n\n\u5982\u679c\u8fd9\u4e09\u4e2a\u90e8\u5206\u7684\u548c\u5927\u4e8e\u96f6,\u90a3\u4e48\u5f53\u524d\u4e8c\u5206\u7684\u503c\u662f\u5408\u6cd5\u7684\n\n~~\u8fd9\u4e2a\u4e00\u770b\u5c31\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4~~\n\n\n\u6211\u4eec\u518d\u6765\u8003\u8651$x$\u53d8\u6210$x+1$\u4f1a\u6709\u4ec0\u4e48\u53d8\u5316\uff1a\n\n1. \u539f\u6765$<x$\u7684\u8fd8\u662f$-1$\n2. \u539f\u6765$>x$\u7684\u8fd8\u662f$1$\n3. \u539f\u6765$=x$\u53d8\u6210$-1$\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u9700\u4fee\u6539\u503c\u4e3a$x$\u7684\u4f4d\u7f6e(\u53ef\u4ee5\u5148\u7528\u94fe\u8868\u6216$vector$\u5b58\u4e0b\u6240\u6709\u503c\u4e3a$x$\u7684\u4f4d\u7f6e)\n\n\u5176\u5b9e\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u540e\u6309\u987a\u5e8f\u66f4\u6539\u5c31\u5b8c\u4e8b\u4e86\n\n\u6570\u79bb\u6563\u5316\u540e\u7684\u5927\u5c0f\u4e0d\u8d85\u8fc7$n$\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa\u6240\u6709$x$(\u4e2d\u4f4d\u6570)\u5bf9\u5e94\u7684\u7ebf\u6bb5\u6811\n\n\u53ef\u662f\u7a7a\u95f4\u4e0d\u591f\u554a\n\n\u8fd9\u65f6\u5019\u4e3b\u5e2d\u6811\u5c31\u6d3e\u4e0a\u7528\u573a\u4e86\n\n\u4e0b\u9762\u662f\u7b80\u6d01\u7684\u4ee3\u7801\uff1a\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 20011\nint n,la=0;\nstruct node{\n    int v,p;\n    bool operator<(node x){return v<x.v;}\n}b[N];\nint ls[N*15],rs[N*15],rt[N],s[N*15],lm[N*15],rm[N*15],sz=0;\nvoid pu(int x){\n    s[x]=s[ls[x]]+s[rs[x]];\n    lm[x]=max(lm[ls[x]],s[ls[x]]+lm[rs[x]]);\n    rm[x]=max(rm[rs[x]],s[rs[x]]+rm[ls[x]]);\n}\nvoid build(int l,int r,int &x){\n    x=++sz;\n    if(l==r){\n        s[x]=lm[x]=rm[x]=1;\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls[x]);build(m+1,r,rs[x]);\n    pu(x);\n}\nvoid upd(int l,int r,int p,int &x,int pre){\n    if(!x)x=++sz;\n    if(l==r){\n        s[x]=lm[x]=rm[x]=-1;\n        return;\n    }\n    int m=(l+r)>>1;\n    if(p<=m)upd(l,m,p,ls[x],ls[pre]),rs[x]=rs[pre];\n    else upd(m+1,r,p,rs[x],rs[pre]),ls[x]=ls[pre];\n    pu(x);\n}\nint qs(int L,int R,int l,int r,int x){\n    if(L<=l&&r<=R)return s[x];\n    int m=(l+r)>>1;\n    if(L<=m&&R>m)return qs(L,R,l,m,ls[x])+qs(L,R,m+1,r,rs[x]);\n    else if(L<=m)return qs(L,R,l,m,ls[x]);\n    else return qs(L,R,m+1,r,rs[x]);\n}\nstruct tr{int s,lm,rm;};\ntr operator+(tr x,tr y){\n    tr ans;\n    ans.s=x.s+y.s;\n    ans.lm=max(x.lm,x.s+y.lm);\n    ans.rm=max(y.rm,y.s+x.rm);\n    return ans;\n}\ntr qm(int L,int R,int l,int r,int x){\n    if(L<=l&&r<=R)return tr{s[x],lm[x],rm[x]};\n    int m=(l+r)>>1;\n    if(L<=m&&R>m)return qm(L,R,l,m,ls[x])+qm(L,R,m+1,r,rs[x]);\n    else if(L<=m)return qm(L,R,l,m,ls[x]);\n    else return qm(L,R,m+1,r,rs[x]);\n}\nvoid work(){\n    int A,B,C,D,q[4];\n    scanf(\"%d%d%d%d\",q+0,q+1,q+2,q+3);\n    q[0]=(q[0]+la)%n+1;\n    q[1]=(q[1]+la)%n+1;\n    q[2]=(q[2]+la)%n+1;\n    q[3]=(q[3]+la)%n+1;\n    sort(q,q+4);\n    A=q[0],B=q[1],C=q[2],D=q[3];\n    int l=1,r=n,ans;\n    while(l<=r){\n        int m=(l+r)>>1,tot=0;\n        if(B+1<=C-1)tot=qs(B+1,C-1,1,n,rt[m]);\n        tot+=qm(A,B,1,n,rt[m]).rm+qm(C,D,1,n,rt[m]).lm;\n        if(tot>=0)ans=m,l=m+1;\n        else r=m-1;\n    }\n    printf(\"%d\\n\",la=b[ans].v);\n}\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;++i)scanf(\"%d\",&b[i]),b[i].p=i;\n    sort(b+1,b+n+1);\n    build(1,n,rt[1]);\n    for(int i=2;i<=n;++i)\n        upd(1,n,b[i-1].p,rt[i],rt[i-1]);\n    int q;scanf(\"%d\",&q);\n    while(q--)work();\n}\n```\n", "link": "/posts/LG 2839 [\u56fd\u5bb6\u96c6\u8bad\u961f]middle/", "tags": ["\u4e8c\u5206", "\u4e3b\u5e2d\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4514 \u4e0a\u5e1d\u9020\u9898\u7684\u4e03\u5206\u949f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4514&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4514\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6b64\u9898\u5361\u5e38,\u9700\u8981\u4f7f\u7528\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4\n\n\u8054\u60f3\u4e00\u7ef4\u7684\u6811\u72b6\u6570\u7ec4\uff1a\n\n> \u5dee\u5206\u6570\u7ec4\uff1a$d_0=a_0,d_i=a_i-a_{i-1}(i>0)$\n> \n> \u4ee4\u5dee\u5206\u6570\u7ec4\u7684\u524d\u7f00\u548c$sd_i=\\sum_{j=0}^id_j$,\u90a3\u4e48$sd_i=a_i$\n\n\u6211\u4eec\u73b0\u5728\u6765\u770b\u770b\u4e8c\u7ef4\u524d\u7f00\u548c\n\n$s(i,j)=s(i-1,j)+s(i,j-1)-s(i-1,j-1)+a(i,j)$\n\n\u67e5\u8be2$(x_1,y_1)$\u5230$(x_2,y_2)$\u7684\u548c\u5219\u4e3a\uff1a\n\n$s(x_2,y_2)-s(x_1-1,y_2)-s(x_2,y_1-1)+s(x_1-1,y_1-1)$\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5dee\u5206\u6570\u7ec4:\n\n$d(i,j)=a(i,j)-(a(i-1,j)+a(i,j-1)-a(i-1,j-1))$\n\n## \u4fee\u6539\n\n$d(x_1,y_1)+=v$\n\n$d(x_1,y_2+1)-=v$\n\n$d(x_2+1,y_1)-=v$\n\n$d(x_2+1,y_2+1)+=v$\n\n\u4e3e\u4e2a\u4f8b\u5b50\uff1a\n\n```\n0 0 0 0 0\n0 1 1 1 0\n0 1 1 1 0 \n0 0 0 0 0\n```\n\u5c06$1$\u90e8\u5206\u52a0\u4e0a$v$,\u90a3\u4e48\n```\n0  0 0 0 0\n0 +v 0 0 -v\n0  0 0 0 0 \n0 -v 0 0 +v\n```\n\n## \u67e5\u8be2\n\n\u5bf9\u4e8e\u70b9$(x,y)$\u5b83\u7684\u503c\u5e94\u8be5\u662f\uff1a$\\sum\\limits_{i=1}^x\\sum\\limits_{j=1}^y d(i,j)$\n\n\u90a3\u4e48$(1,1)$\u5230$(x,y)$\u7684\u548c\u5c31\u662f:\n\n$$\n\n\\sum_{i=1}^x\\sum_{j=1}^y\\sum_{p=1}^i\\sum_{q=1}^j d(p,q)\n\\\\\n=\\sum_{i=1}^x\\sum_{j=1}^yd(i,j)\\times(x-i+1)\\times(y-j+1)\n\\\\\n=\\sum_{i=1}^x\\sum_{j=1}^yd(i,j)\\times[(xy-xj+x)+(-yi+ij-i)+(y-j+1)]\n\\\\\n=\\sum_{i=1}^x\\sum_{j=1}^yd(i,j)\\times (xy+x+y+1)-d(i,j)\\times i(y+1)-d(i,j)\\times j(x+1) + d(i,j)\\times i \\times j\n$$\n\n\u6211\u4eec\u9700\u8981\u7ef4\u62a4$d(i,j),d(i,j)\\times i,d(i,j) \\times j, d(i,j)\\times i \\times j$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 2049\n#define lb(x) (x&-x)\nint n,m;\nstruct bit{\n    int s[N][N];\n    void add(int x,int y,int v){\n        for(int i=x;i<=n;i+=lb(i))\n            for(int j=y;j<=m;j+=lb(j))\n                s[i][j]+=v;\n    }\n    int ask(int x,int y){\n        int ans=0;\n        for(int i=x;i;i-=lb(i))\n            for(int j=y;j;j-=lb(j))\n                ans+=s[i][j];\n        return ans;\n    }\n}d,di,dj,dij;\nvoid upd(int x,int y,int v){\n    d.add(x,y,v);\n    di.add(x,y,v*x);\n    dj.add(x,y,v*y);\n    dij.add(x,y,v*x*y);\n}\nint ask(int x,int y){\n    return\n    d.ask(x,y)*(x*y+x+y+1)\n    -di.ask(x,y)*(y+1)\n    -dj.ask(x,y)*(x+1)\n    +dij.ask(x,y);\n}\nint main(){\n    in(n,m);\n    char opt;\n    int x,y,X,Y,v;\n    while(!__){\n        in(opt,x,y,X,Y);\n        if(__)break;\n        if(opt=='L')\n            in(v),\n            upd(x,y,v),\n            upd(x,Y+1,-v),\n            upd(X+1,y,-v),\n            upd(X+1,Y+1,v);\n        else out(ask(X,Y)-ask(x-1,Y)-ask(X,y-1)+ask(x-1,y-1),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 4514 \u4e0a\u5e1d\u9020\u9898\u7684\u4e03\u5206\u949f/", "tags": ["\u4e8c\u7ef4\u6811\u72b6\u6570\u7ec4", "\u4e8c\u7ef4\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3372 \u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811-1", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3372&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3372\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u533a\u95f4\u52a0,\u5355\u70b9\u67e5\u8be2\n\n\u8bbe\u5dee\u5206\u6570\u7ec4$d_i=a_i-a_{i-1}$\n\n\n\u4fee\u6539\uff1a$d_l+=v,d_{r+1}-=v$\n\n\u67e5\u8be2:$a_i=\\sum\\limits_{j=1}^id_j$\n\n## \u533a\u95f4\u52a0,\u533a\u95f4\u67e5\u8be2\n\n$$\n\\sum_{i=1}^na_i=\\sum_{i=1}^n\\sum_{j=1}^id_i\n\\\\\n=\\sum_{i=1}^nd_i\\times(n-i+1)\n\\\\\n=n\\sum_{i=1}^nd_i-\\sum_{i=1}^n d_i\\times(i-1)\n$$\n\n\u7ef4\u62a4\u4e24\u4e2a\u6811\u72b6\u6570\u7ec4,\u4e00\u4e2a\u8bb0\u5f55$d_i$,\u53e6\u4e00\u4e2a\u8bb0\u5f55$d_i\\times(i-1)$\n\n\u4fee\u6539\uff1a\n\n$d_l+=v,d_{r+1}-=v$\n\n$d'_l+=v\\times(l-1),d'_{r+1}-=v\\times(l-1)$\n\n\u67e5\u8be2:\u5982\u4e0a\u8ff0\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n;\nll s[N],S[N];\nvoid upd(int x,int v){\n    for(int i=x;i<=n;i+=i&-i)\n        s[i]+=v,\n        S[i]+=v*(x-1);\n}\nll ask(int x){\n    ll ans=0;\n    for(int i=x;i;i-=i&-i)\n        ans+=x*s[i]-S[i];\n    return ans;\n}\nint main(){\n    int q,opt,x,y=0,v;\n    in(n,q);\n    Fur(i,1,n)in(x),upd(i,x-y),y=x;\n    while(q--){\n        in(opt,x,y);\n        if(opt==1)in(v),upd(x,v),upd(y+1,-v);\n        else out(ask(y)-ask(x-1),ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3372 \u3010\u6a21\u677f\u3011\u7ebf\u6bb5\u6811-1/", "tags": ["\u6811\u72b6\u6570\u7ec4", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2617 Dynamic-Rankings", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2617&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2617\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,q,tot,sz,a[N],c[N<<1],RT[N],s[N*400],ls[N*400],rs[N*400];\nstruct que{bool opt;int l,r,k;}Q[N];\nstruct node{int v,id,typ;bool operator<(node t)const{return v<t.v;}}b[N<<1];\nvoid upd(int x,int v,int l,int r,int &rt){\n    if(!rt)rt=++sz;\n    s[rt]+=v;\n    if(l==r){return;}\n    int m=l+r>>1;\n    if(x<=m)upd(x,v,l,m,ls[rt]);\n    else upd(x,v,m+1,r,rs[rt]);\n}\nil void UPD(int x,int v){for(int i=x;i<=n;i+=i&-i)upd(a[x],v,1,tot,RT[i]);}\nint tl[20],tr[20];\nil int ask(int l,int r,int k){\n    int cl=0,cr=0,cnt,m;\n    for(int i=l-1;i;i^=i&-i)tl[++cl]=RT[i];\n    for(int i=r;i;i^=i&-i)tr[++cr]=RT[i];\n    l=1,r=tot;\n    while(l<r){\n        m=l+r>>1;cnt=0;\n        Fur(i,1,cl)cnt-=s[ls[tl[i]]];\n        Fur(i,1,cr)cnt+=s[ls[tr[i]]];\n        if(k<=cnt){\n            Fur(i,1,cl)tl[i]=ls[tl[i]];\n            Fur(i,1,cr)tr[i]=ls[tr[i]];\n            r=m;\n        }\n        else{\n            Fur(i,1,cl)tl[i]=rs[tl[i]];\n            Fur(i,1,cr)tr[i]=rs[tr[i]];\n            k-=cnt,l=m+1;\n        }\n    }\n    return l;\n}\nint main(){\n    in(n,q);\n    char ch;bool opt;int l,r,k,d=n,t=0,x;\n    Fur(i,1,n)in(x),b[i]={x,i,0};\n    Fur(i,1,q){\n        in(ch,l,r);\n        opt=ch=='Q';\n        if(opt)in(k);\n        else b[++d]={r,i,1};\n        Q[i]=que{opt,l,r,k};\n    }\n    sort(b+1,b+d+1);b[0].v=-(1<<30);\n    Fur(i,1,d)c[(b[i].typ?Q[b[i].id].r:a[b[i].id])=tot+=b[i].v!=b[i-1].v]=b[i].v;\n    Fur(i,1,n)UPD(i,1);\n    Fur(i,1,q)\n    if(Q[i].opt)out(c[ask(Q[i].l,Q[i].r,Q[i].k)],ln);\n    else UPD(Q[i].l,-1),a[Q[i].l]=Q[i].r,UPD(Q[i].l,1);\n    flush();\n}\n```\n", "link": "/posts/LG 2617 Dynamic-Rankings/", "tags": ["\u6811\u72b6\u6570\u7ec4", "\u4e3b\u5e2d\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3927 SAC-Et1", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3927&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3927\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u9053\u4e2d\u6863\u9898-Factorial\ntop: 0\n\n\u89c2\u5bdf\u4e00\u4e0b,\n\n\u4e00\u4e2a\u6570\u5728$k$\u8fdb\u5236\u4e0b\u6709\u591a\u5c11\u4e2a\u540e\u7f000,\u5c31\u662f\u4e00\u4e2a\u6570\u80fd\u6574\u9664$k$\u591a\u5c11\u6b21\n\n\u90a3\u4e48\u5148\u628a$k$\u5206\u89e3\u8d28\u56e0\u6570,\u5e76\u6c42\u51fa\u6bcf\u4e2a\u8d28\u56e0\u6570\u7684\u4e2a\u6570,\u5b58\u5230\u6570\u7ec4\u91cc\u9762\n\n\u8981\u600e\u4e48\u7b97\u51fa$n!$\u91cc\u9762\u6709\u591a\u5c11\u4e2a\u8d28\u56e0\u6570\uff1f\n\n> \u6bcf$p$($p$\u662f\u8d28\u6570)\u4e2a\u6570\u91cc\u9762\u6709\u4e00\u4e2a$p$,\u8fd9\u4e9b\u6570\u662f$p^1,p^2,...p^x$,\u8fd9\u4e9b\u6570\u4e2d\u6bcf$p$\u4e2a\u6570\u4e2d\u53c8\u6709\u4e00\u4e2a$p$,\u90a3\u6211\u4eec\u8fd9\u6837\u4e00\u76f4\u5faa\u73af\u4e0b\u53bb\u5c31\u53ef\u4ee5\u6c42\u51fa\u8d28\u56e0\u6570\u7684\u4e2a\u6570,\u7136\u540e\u5728\u9664\u4ee5\u4ed6\u4eec\u5728$k$\u4e2d\u51fa\u73b0\u7684\u6b21\u6570,\u7136\u540e\u53d6$min$\u5c31\u662f\u7b54\u6848\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nll n,k,a[N],s[N],cnt=0;\nint main(){\n\tin>>n>>k;\n\tll ans=1ll<<62;\n\tfor(ll i=2;i*i<=k;i++)\n\tif(k%i==0){\n\t\ta[++cnt]=i;s[cnt]=0;\n\t\twhile(k%i==0)s[cnt]++,k/=i;\n\t}\n\tif(k>1)a[++cnt]=k,s[cnt]=1;\n\tFur(i,1,cnt){\n\t\tll res=0,t=n;\n\t\twhile(t)res+=(t/=a[i]);\n\t\tres/=s[i];\n\t\tans=MIN(ans,res);\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 3927 SAC-Et1/", "tags": ["\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF101D Castle", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF101D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF101D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n;\nll s[N],dft[N],siz[N],len[N];\nint cnt=0,head[N];\nstruct edge{\n    int to,nxt,w;\n}e[N*2];\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[cnt].w=w;\n}\nbool cmp(int x,int y){return dft[x]*siz[y]<dft[y]*siz[x];}\nvoid dfs(int x,int f){\n    siz[x]=1;\n    vector<int>son;\n    fl(i,x)if(to!=f){\n        len[to]=e[i].w;\n        dfs(to,x);\n        dft[to]+=2*len[to];\n        son.push_back(to);\n    }\n    sort(son.begin(),son.end(),cmp);\n    for(auto to:son){\n        s[x]+=s[to]+siz[to]*(dft[x]+len[to]);\n        dft[x]+=dft[to];\n        siz[x]+=siz[to];\n    }\n}\nsigned main(){\n    in(n);\n    int x,y,w;\n    Fur(i,1,n-1)in(x,y,w),add(x,y,w),add(y,x,w);\n    dfs(1,0);\n    printf(\"%lf\\n\",(db)s[1]/(db)(n-1));\n}\n```\n", "link": "/posts/LG CF101D Castle/", "tags": ["\u671f\u671b", "dfs", "\u8d2a\u5fc3", "\u6392\u5e8f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1196D2 RGB-Substring", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1196D2&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1196D2\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u4e2a\u70b9\u5bf9\u5e94\u7684\u53ea\u6709\u53ef\u80fd\u662f$R,G,B$\n\n\u90a3\u4e48\u679a\u4e3e$3$\u6b21\u5c31\u5b8c\u4e8b\u4e86\n\n\u679a\u4e3e\u4ee5$R$\u4e3a\u8d77\u70b9,$G$\u4e3a\u8d77\u70b9,$B$\u4e3a\u8d77\u70b9\n\n\u8bb0\u5f55\u524d\u7f00\u548c$S_i$\u8868\u793a\u524d$i$\u4e2a\u51fa\u9519\u7684\u6709\u51e0\u4e2a\n\n$ans=\\min_{i\\ge k}(S_i-S_{i-k})$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,k,a[N],s[N];\nchar ch[N];\nvoid work(){\n    in(n,k);\n    in(ch+1);\n    Fur(i,1,n){\n        if(ch[i]=='R')a[i]=0;\n        if(ch[i]=='G')a[i]=1;\n        if(ch[i]=='B')a[i]=2;\n    }\n    int ans=inf;\n    Fur(t,0,2)\n        Fur(i,1,n){\n            s[i]=s[i-1]+(a[i]!=((i+t)%3));\n            if(i>=k)ans=MIN(ans,s[i]-s[i-k]);\n        }\n    out(ans,ln);\n}\nint main(){\n    int T;in(T);\n    while(T--)work();\n    flush();\n}\n```\n", "link": "/posts/LG CF1196D2 RGB-Substring/", "tags": ["\u524d\u7f00\u548c", "\u679a\u4e3e"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF375B Maximum-Submatrix-2", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF375B&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF375B\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 5011\nint n,m,f[N][N],t[N];\nchar a[N][N];\nint main(){\n\tin>>n>>m;\n\tFur(i,1,n)in>>(a[i]+1);\n\tFur(i,1,n)\n\t\tFdr(j,m,1)\n\t\tif(a[i][j]==49)f[i][j]=f[i][j+1]+1;\n\t\n\tint ans=0;\n\tFur(j,1,m){\n\t\tFur(i,1,n)t[i]=f[i][j];\n\t\tsort(t+1,t+n+1);\n\t\tFur(i,1,n)ans=MAX(ans,t[i]*(n-i+1));\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG CF375B Maximum-Submatrix-2/", "tags": ["\u679a\u4e3e", "\u9884\u5904\u7406"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2167 [SDOI2009]Bill\u7684\u6311\u6218", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2167&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2167\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u770b\u5230$n\\le 15$,\u6211\u4eec\u5f88\u5bb9\u6613\u60f3\u5230\u72b6\u538b\n\n### \u72b6\u538b\u89e3\u6cd5\uff1a\n\n\u8bbe$f[i][j]$\u8868\u793a\u5230\u4e86\u7b2c$i$\u4f4d,\u5339\u914d\u7684\u72b6\u6001\u4e3a$j$\n\n\u4ee3\u7801\uff1a\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 111\n#define mod 1000003\n#define M(x) ((x>=mod)?(x)%=mod:x)\nint mt[N][30];\nll f[N][1<<15];\nchar ch[N][N];\nil void work(){\n    clr(mt,0);\n    clr(f,0);\n    int n,k,len;\n    in(n,k);\n    Fur(i,1,n)in(ch[i]);\n    len=strlen(ch[1]);\n    Fur(i,0,len-1)\n        for(char t='a';t<='z';++t)\n            Fur(j,1,n)\n            if(ch[j][i]=='?'||ch[j][i]==t)\n                mt[i][t-'a']|=(1<<(j-1));//\u66f4\u65b0\u6bd4\u8f83\u5f53\u524d\u4f4d\u7684\u5f71\u54cd\n    f[0][(1<<n)-1]=1;\n    Fur(i,0,len-1)\n        Fur(j,0,(1<<n)-1)\n        if(f[i][j])\n            Fur(t,0,26)\n                M(f[i+1][j&mt[i][t]]+=f[i][j]);\n    ll ans=0;\n    Fur(i,0,(1<<n)-1){\n        int t=i,tt=0;\n        while(t)tt+=(t&1),t>>=1;\n        if(tt==k)M(ans+=f[len][i]);\n    }\n    out(ans,ln);\n}\nint main(){\n    int T;in(T);\n    while(T--)work();\n    flush();\n}\n```\n\n\u6b64\u9898\u8fd8\u6709\u5bb9\u65a5\u89e3\u6cd5\uff1a\n\n\u770b\u5230\u6070\u597d$k$\u4e2a,\u6211\u4eec\u5c31\u53ef\u4ee5\u60f3\u5230\u5bb9\u65a5\u5957\u8def\n\n\u627e\u51fa\u81f3\u5c11\u5339\u914d$k$\u4e2a\u7684\u65b9\u6848\u6570$g(k)$,\u8bbe$f(k)$\u4e3a\u6070\u597d$k$\u4e2a\u7684\u65b9\u6848\u6570\n\n\u7136\u540e\u8fd8\u662f\u6309\u5957\u8def\u5c31\u53ef\u4ee5\u4e86\n\n$$\ng(n) = \\sum_{i=k}^n {n\\choose i}f(i)\n\n\\leftrightarrow \n\nf(n) = \\sum_{i=k}^n {n\\choose i}g(i) (-1)^{i-k}\n$$\n\n\u95ee\u9898\u8f6c\u6362\u4e3a\u5982\u4f55\u6c42\u81f3\u5c11\u5339\u914d$k$\u4e2a\u7684\u65b9\u6848\u6570\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528dfs\u6765\u7edf\u8ba1,~~\u8fd9\u6837\u6bd4\u8d77\u72b6\u538b\u601d\u7ef4\u96be\u5ea6\u53ef\u80fd\u964d\u4f4e\u4e86\u8bb8\u591a,\u53ea\u9700\u8981\u679a\u4e3e\u6392\u5217\u7ec4\u5408(\u5f53\u7136\u679a\u4e3e\u4e8c\u8fdb\u5236\u72b6\u6001\u4e5f\u53ef\u4ee5)~~\n\n\u72b6\u538b\u9700\u8981\u5904\u7406\u5168\u90e8\u72b6\u6001\n\ndfs\u53ea\u9700\u8981\u7edf\u8ba1$k\uff5en$\u7684\u90e8\u5206\n\n\u6700\u540e\u7edf\u8ba1\u7684\u65f6\u95f4\u53ef\u5ffd\u7565\u4e0d\u8ba1\n\n\u72b6\u538b\uff1a$492ms$\n\n\u5bb9\u65a5: $100ms$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 111\n#define mod 1000003\nchar ch[N][N];\nint len,n,k,cnt,c[N][N],up,tot=0,las,a[N];\nvoid dfs(int x,int now){\n    if(x==n+1){\n        if(now!=up) return;\n        ll lp=1;\n        Fur(j,1,len){\n            las=-1;\n            Fur(i,1,up)\n                if(ch[a[i]][j]!='?'){\n                    if(las==-1)\n                        las=ch[a[i]][j]-'a';\n                    else if(las!=ch[a[i]][j]-'a')return;\n                }\n            if(las==-1)lp=(lp*26)%mod;\n        }\n        (tot+=lp)%=mod;\n        return;\n    }\n    if(now<up){\n        a[++cnt]=x;\n        dfs(x+1,now+1);\n        a[cnt--]=0;\n    }\n    if(n-x>=up-now)dfs(x+1,now);\n}\nll g[N];\nil void work(){\n    clr(g,0);\n    in(n,k);\n    Fur(i,1,n)in(ch[i]+1);\n    len=strlen(ch[1]+1);\n    Fur(i,k,n){\n        up=i;\n        tot=0;\n        dfs(1,0);\n        g[i]=tot;\n    }\n    ll ans=0;\n    Fur(i,k,n)\n        if((i-k)&1)ans=(ans-1ll*c[i][k]*g[i]%mod+mod)%mod;\n        else ans=(ans+1ll*c[i][k]*g[i]%mod)%mod;\n    out(ans,ln);\n}\nint main(){\n    Fur(i,0,20){\n        c[i][0]=1;\n        Fur(j,1,i)\n            c[i][j]=c[i-1][j]+c[i-1][j-1];\n    }\n    int T;in(T);\n    while(T--)work();\n    flush();\n}\n```\n", "link": "/posts/LG 2167 [SDOI2009]Bill\u7684\u6311\u6218/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u72b6\u538bdp", "\u5bb9\u65a5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF600E Lomsat gelral", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF600E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF600E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9759\u6001\u94fe\u5206\u6cbb\n\n\u8bb0\u5f97\u5f00$long\\ long$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,a[N],head[N],cnt=0;\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint son[N],siz[N],d[N];\nvoid dfs(int x,int f){\n    siz[x]=1;\n    fl(i,x)if(to!=f){\n        dfs(to,x);\n        siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nint b[N],tp=0;\nll ANS[N],s[N];\nbool v[N];\nvoid upd(int x,int f,int V){\n    s[b[a[x]]]-=a[x];\n    b[a[x]]+=V;\n    s[b[a[x]]]+=a[x];\n    if(s[tp+1])++tp;\n    if(!s[tp])--tp;\n    fl(i,x)if(to!=f&&!v[to])upd(to,x,V);\n}\nvoid sol(int x,int f,int t){\n    fl(i,x)if(to!=f&&to!=son[x])sol(to,x,0);\n    clr(b,0);\n    if(son[x])sol(son[x],x,1),v[son[x]]=1;\n    upd(x,f,1);v[son[x]]=0;\n    ANS[x]=s[tp];\n    if(!t)upd(x,f,-1);\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    Fur(i,1,n)in>>a[i];\n    int x,y;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    dfs(1,0);\n    sol(1,0,1);\n    Fur(i,1,n)out<<ANS[i]<<\" \";\n    out<<ln;\n}\n```\n", "link": "/posts/LG CF600E Lomsat gelral/", "tags": ["\u9759\u6001\u94fe\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1854 \u82b1\u5e97\u6a71\u7a97\u5e03\u7f6e", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1854&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1854\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u7406\u89e3\u6210\u4ece\u5de6\u4e0a\u89d2\u5230\u53f3\u4e0b\u89d2\u7684\u6700\u957f\u8def(\u6bcf\u5c42\u53ea\u80fd\u53d6\u4e00\u4e2a)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 101\nint n,m,f[N][N],p[N][N],a[N][N],as[N];\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    Fur(i,1,n)\n        Fur(j,1,m)\n        in>>a[i][j];\n    Fur(i,1,n)f[1][i]=a[1][i];\n    Fur(i,2,n)\n        Fur(j,i,m){\n            f[i][m]=-inf;\n            Fur(k,i-1,j-1)\n                if(f[i-1][k]+a[i][j]>f[i][j])\n                    f[i][j]=f[i-1][k]+a[i][j],p[i][j]=k;\n        }\n    int ans=0,pos,x,y;\n    Fur(i,n,m)\n        if(f[n][i]>ans)ans=f[n][i],pos=i;\n    out<<ans<<ln;\n    x=pos;\n    Fdr(i,n,1){\n        as[i]=x;\n        x=p[i][x];\n    }\n    Fur(i,1,n)out<<as[i]<<\" \";out<<ln;\n}\n```\n", "link": "/posts/LG 1854 \u82b1\u5e97\u6a71\u7a97\u5e03\u7f6e/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1559 \u8f66\u548c\u77e9\u5f62", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u4e2a\u77e9\u5f62\u8981\u60f3\u88ab\u4fdd\u62a4\u7684\u8bdd,\u5fc5\u987b\u6ee1\u8db3\u6240\u6709\u884c / \u6240\u6709\u5217\u4e0a\u5747\u6709\u4e00\u4e2a\u8f66\u7684\u9650\u5236\u3002\u8fd9\u6837\u6211\u4eec\u89e3\u51b3\u95ee\u9898\u5c31\u53ef\u4ee5\u8f6c\u5316\u4e3a\u5224\u65ad\u4e00\u4e2a\u77e9\u5f62\u6240\u6709\u884c\u4e0a\u662f\u5426\u90fd\u6709\u4e00\u4e2a\u8f66\u4e86\uff08\u5bf9\u4e8e\u5217\u53ea\u9700\u8981\u628a\u56fe\u8f6c\u4e00\u4e0b\u505a\u5c31\u53ef\u4ee5\uff09\u3002\u8fd9\u6837\u6211\u4eec\u81ea\u7136\u60f3\u5230\u7ebf\u6bb5\u6811 + \u626b\u63cf\u7ebf,\u6211\u662f\u7528\u5217\u4e0a\u7684\u626b\u63cf\u7ebf\u4ece\u4e0a\u5230\u4e0b,\u6bcf\u4e00\u6b21\u626b\u5230\u4e00\u4e2a\u77e9\u5f62\u7684\u4e0b\u8fb9\u754c\u5c31\u5224\u65ad\u4e00\u4e0b\u3002\u7ebf\u6bb5\u6811\u4e0a\u7ef4\u62a4\u6bcf\u4e00\u5217\u4e0a\u8ddd\u79bb\u6700\u8fdc\u7684\u4e00\u4e2a\u8f66\u7684\u7eb5\u5750\u6807,\u6211\u4eec\u5224\u65ad\u4e00\u4e2a\u77e9\u5f62\u662f\u5426\u88ab\u4fdd\u62a4\u5c31\u53ea\u9700\u8981\u5224\u65ad\u6700\u8fdc\u7684\u8f66\u662f\u5426\u5728\u5f53\u524d\u77e9\u5f62\u7684\u8303\u56f4\u5185\u4e86\u3002\u611f\u89c9OFN\u8bf4\u7684\u626b\u63cf\u7ebf\u5c31\u662f\u628a\u95ee\u9898\u8f6c\u5316\u5230\u4e00\u4e2a\u524d\u7f00\u7684\u7ef4\u62a4\u4e0a\u9762\u53bb\u5176\u5b9e\u662f\u633a\u6709\u9053\u7406\u7684\u6069~\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 600011\n#define ls rt<<1\n#define rs rt<<1|1\nstruct node{\n    int x,y;\n    friend bool operator<(const node&a,const node&b){\n        return a.y>b.y;\n    }\n}p[N];\nstruct sqr{\n    int x,y,x_,y_,id;\n    friend bool operator <(const sqr&a,const sqr&b){\n        return a.y>b.y;\n    }\n}a[N];\nint s[N<<2],n,m,k,q;\nbool ans[N];\nvoid upd(int x,int y,int l,int r,int rt){\n    if(l==r){\n        s[rt]=y;\n        return;\n    }\n    int m=(l+r)>>1;\n    if(x<=m)upd(x,y,l,m,ls);\n    else upd(x,y,m+1,r,rs);\n    s[rt]=MAX(s[ls],s[rs]);\n}\nint ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1,ans=0;\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans=MAX(ans,ask(L,R,m+1,r,rs));\n    return ans;\n}\nvoid work(){\n    sort(p+1,p+k+1);\n    sort(a+1,a+q+1);\n    clr(s,126);\n    int now=1;\n    Fur(i,1,q){\n        while(now<=k&&p[now].y>=a[i].y)\n            upd(p[now].x,p[now].y,1,n,1),now++;\n        int t=ask(a[i].x,a[i].x_,1,n,1);\n        if(t<=a[i].y_&&t)ans[a[i].id]=1;\n    }\n}\nint main(){\n    in>>n>>m>>k>>q;\n    Fur(i,1,k)in>>p[i].x>>p[i].y;\n    Fur(i,1,q)in>>a[i].x>>a[i].y>>a[i].x_>>a[i].y_,a[i].id=i;\n    work();\n    Fur(i,1,k)SWAP(p[i].x,p[i].y);\n    Fur(i,1,q)SWAP(a[i].x,a[i].y),SWAP(a[i].x_,a[i].y_);\n    SWAP(n,m);\n    work();\n    Fur(i,1,q)out<<(ans[i]?\"YES\":\"NO\")<<ln;\n}\n\n```\n", "link": "/posts/51nod 1559 \u8f66\u548c\u77e9\u5f62/", "tags": ["\u7ebf\u6bb5\u6811", "\u6392\u5e8f", "\u626b\u63cf\u7ebf"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP1026 FAVDICE", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP1026&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP1026\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nFavorite-Dice\ntop: 0\n\n\u6211\u662f\u6ca1\u770b\u9898\u89e3\u548c\u6807\u7b7e\u5199\u51fa\u6765\u7684,\u5b8c\u5168\u4e0d\u77e5\u9053\u8fd9\u662f\u671f\u671b\n\n\u5047\u8bbe\u4f60\u5df2\u7ecf\u53d6\u4e86$i$\u4e2a\u9762,\u4f60\u53d6\u5230\u6ca1\u53d6\u8fc7\u7684\u4e00\u4e2a\u9762,\u6982\u7387\u662f$\\frac {n-i}n$\n\n\u628a\u6240\u6709\u6982\u7387\u52a0\u8d77\u6765\u5c31\u662f\u7b54\u6848\u5566,\u4e5f\u5c31\u662f$\\sum_{i=0}^{n-1} \\frac  {n-i}n$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\ndb work(int n){\n\tdb ans=0;\n\tFur(i,1,n)ans+=1.0*n/(n-i+1);\n\treturn ans;\n}\nint main(){\n\tint q,x;in>>q;\n\twhile(q--)in>>x,printf(\"%.2f\\n\",work(x));\n}\n```\n", "link": "/posts/LG SP1026 FAVDICE/", "tags": ["\u671f\u671b"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1791 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u4eba\u5458\u96c7\u4f63", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1791&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1791\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u5b9a\u662f\u6211\u505a\u9898\u592a\u5c11\u4e86\n\n\u770b\u4e0d\u51fa\u8fd9\u662f\u4e2a\u6700\u5c0f\u5272\n\n\u6211\u4eec\u5c06\u6bcf\u4e2a\u4eba\u770b\u6210\u4e00\u4e2a\u70b9,\u7136\u540e\u5982\u4e0b\u5efa\u8fb9\uff1a\n\n1. \u6e90\u70b9\u5411\u6bcf\u4e2a\u4eba\u8fde\u6d41\u91cf\u4e3a\u5176\u603b\u6536\u76ca\u7684\u8fb9\uff08$\\sum_{j=1}^n E_{i,j}$) \n\n2. \u6bcf\u4e2a\u4eba\u5411\u6c47\u70b9\u8fde\u6d41\u91cf\u4e3a\u5176\u82b1\u8d39\u7684\u8fb9\n\n3. $i$\u5411$j$\u8fde\u6d41\u91cf\u4e3a$E_{i,j} \\times 2$\u7684\u8fb9\n\n\u7136\u540e\u7528\u6240\u6709\u80fd\u8d5a\u5230\u7684\u5229\u6da6\u51cf\u53bb\u6700\u5c0f\u82b1\u8d39\u5c31\u53ef\u4ee5\u4e86\n\n\u7b2c\u4e09\u6761,\u5982\u679c\u4e24\u4e2a\u4eba\u90fd\u9009,\u53ef\u4ee5\u83b7\u5f97$E_{i,j}$\u7684\u5229\u6da6\n\n\u5982\u679c\u6709\u4e00\u4e2a\u4e0d\u9009,\u4f1a\u4e8f\u635f$E_{i,j}$\u7684\u5229\u6da6\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\n#define int ll\nint n,m,st,ed,cnt=1;\nint head[N],d[N],q[N];\nstruct edge{int to,nxt,w;}e[N*N];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].w=0;e[cnt].nxt=head[y];head[y]=cnt;\n}\nbool bfs(){\n    int h=0,t=1,x;\n    clr(d,0);d[q[h]=st]=1;\n    while(h<t){\n        x=q[h++];if(x==ed)return 1;\n        fl(i,x)if(e[i].w&&!d[to]){\n            d[to]=d[x]+1;\n            q[t++]=to;\n        }\n    }\n    return 0;\n}\nint dfs(int x,int mf){\n    if(x==ed)return mf;\n    int us=0,w;\n    fl(i,x)\n    if(e[i].w&&d[to]==d[x]+1){\n        w=dfs(to,MIN(mf-us,e[i].w));\n        e[i].w-=w;e[i^1].w+=w;\n        us+=w;\n        if(us==mf)return mf;\n    }\n    if(!us)d[x]=-1;\n    return us;\n}\nsigned main(){\n\tin>>n;\n\tint x,y,w,sum=0,ans=0;\n\tst=N-1,ed=N-2;\n\tFur(i,1,n){\n\t\tin>>w;\n\t\tadd(i,ed,w);\n\t}\n\tFur(i,1,n){\n\t\tint c=0;\n\t\tFur(j,1,n){\n\t\t\tin>>w;\n\t\t\tif(w){\n\t\t\t\tc+=w;\n\t\t\t\tadd(i,j,w<<1);\n\t\t\t}\n\t\t}\n\t\tadd(st,i,c);\n\t\tsum+=c;\n\t}\n\twhile(bfs())ans+=dfs(st,inf);\n\tout<<sum-ans<<ln;\n}\n```\n", "link": "/posts/LG 1791 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u4eba\u5458\u96c7\u4f63/", "tags": ["\u7f51\u7edc\u6d41"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1571 \u6700\u8fd1\u7b49\u5bf9", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u81ea\u5df1\u5199\u4e86\u4e2a\u83ab\u961f,\u7ed3\u679c$51nod$\u8dd1\u7684\u592a\u6162,\u7136\u540e$TLE(MLE)$\u4e86\n\n\u9898\u89e3\u5999\u6781\u4e86\uff1a\n\n> \u79bb\u7ebf\u4e4b\u540e,\u4ece\u5de6\u5411\u53f3\u626b\u4e00\u904d,\u8ba9\u6bcf\u4e2a\u503c\u5b58\u50a8\u201c\u5f53\u524d\u5df2\u626b\u8fc7\u7684\u90e8\u5206\u4e2d,\u53f3\u8fb9\u7b2c\u4e00\u4e2a\u4e0e\u81ea\u5df1\u76f8\u7b49\u7684\u70b9\u5230\u81ea\u5df1\u7684\u8ddd\u79bb\u201d,\u7136\u540e\u5982\u679c\u5f53\u524d\u626b\u5230\u7684\u70b9\u662f\u8be2\u95ee\u7684\u53f3\u7aef\u70b9\u7684\u8bdd,\u5c31\u56de\u7b54\u8fd9\u4e2a\u8be2\u95ee\u3002\n>\n>  \u8fd9\u91cc\u9762\u6709\u4e2a\u5f88\u5de7\u5999\u7684\u5730\u65b9\u5c31\u662f\u5728\u8be2\u95ee\u7684\u65f6\u5019\u6309r\u7684\u5927\u5c0f\u4ece\u5de6\u5f80\u53f3\u8be2\u95ee,\u6bcf\u6b21\u66f4\u65b0\u7684\u65f6\u5019\u66f4\u65b0\u7684\u662f\u548c\u8fd9\u4e2a\u70b9\u6700\u8fd1\u7684\u5de6\u8fb9\u7684\u70b9\u3002\u56e0\u4e3a\u53ea\u6709\u66f4\u65b0\u5230\u7b2cr\u4e2a\u70b9\u65f6\u624d\u80fd\u80fd\u67e5\u8be2 l - r \u7684\u533a\u95f4\u4f8b\u5982\uff1a1 2 3 4 1  \u53ea\u6709\u5728 r \u7b49\u4e8e 5 \u65f6\u624d\u80fd\u8be2\u95ee L - 5\u7684\u533a\u95f4,\u6b64\u65f6\u66f4\u65b0\u7b2c\u4e00\u4e2a1\u7684\u503c\u4e3a4,\u5982\u679cL > 1\u7684\u8bdd\u533a\u95f4\u5e76\u672a\u66f4\u65b0\u6240\u4ee5\u67e5\u8be2\u7ebf\u6bb5\u6811\u4e2dL- 5\u7684\u6700\u5c0f\u503c\u8fd8\u662fINF\n\n\n\n\n\n\n<!-- more -->\n\n```cpp\n\n#include <cstdio>\n#include <cstring>\n#include <algorithm>\n#define INF 0x3f3f3f3f\n#define space putchar(' ')\n#define enter putchar('\\n')\nusing namespace std;\ntypedef long long ll;\ntemplate <class T>\nbool read(T &x){\n    char c;\n    bool op = 0;\n    while(c = getchar(), c < '0' || c > '9')\n        if(c == '-') op = 1;\n        else if(c == EOF) return 0;\n    x = c - '0';\n    while(c = getchar(), c >= '0' && c <= '9')\n        x = x * 10 + c - '0';\n    if(op) x = -x;\n    return 1;\n}\ntemplate <class T>\nvoid write(T x){\n    if(x < 0) putchar('-'), x = -x;\n    if(x >= 10) write(x / 10);\n    putchar('0' + x % 10);\n}\n \nconst int N = 500005;\nint n, m, q, a[N], s[N], last[N], left[N], data[4*N], ans[N];\nstruct Query {\n    int id, l, r;\n    bool operator < (const Query &b) const{\n        return r < b.r;\n    }\n} Q[N];\n \nvoid build(int k, int l, int r){\n    if(l == r) return (void)(data[k] = INF);\n    int mid = (l + r) >> 1;\n    build(k << 1, l, mid);\n    build(k << 1 | 1, mid + 1, r);\n    data[k] = INF;\n}\n \nvoid change(int k, int l, int r, int p, int x){\n    if(l == r) return (void)(data[k] = x);\n    int mid = (l + r) >> 1;\n    if(p <= mid) change(k << 1, l, mid, p, x);\n    else change(k << 1 | 1, mid + 1, r, p, x);\n    data[k] = min(data[k << 1], data[k << 1 | 1]);\n}\n \nint query(int k, int l, int r, int ql, int qr){\n    if(ql <= l && qr >= r) return data[k];\n    int mid = (l + r) >> 1, ret = INF;\n    if(ql <= mid) ret = min(ret, query(k << 1, l, mid, ql, qr));\n    if(qr > mid) ret = min(ret, query(k << 1 | 1, mid + 1, r, ql, qr));\n    return ret;\n}\n \nint main(){\n \n    read(n), read(q);\n    for(int i = 1; i <= n; i++)\n        read(a[i]), s[i] = a[i];\n    sort(s + 1, s + n + 1);\n    int m = unique(s + 1, s + n + 1) - s - 1;\n    \n    for(int i = 1; i <= n; i++){\n        a[i] = lower_bound(s + 1, s + m + 1, a[i]) - s;\n        left[i] = last[a[i]];\n        last[a[i]] = i;\n    }\n \n    build(1, 1, n);\n    \n    for(int i = 1; i <= q; i++)\n        Q[i].id = i, read(Q[i].l), read(Q[i].r);\n    sort(Q + 1, Q + q + 1);\n \n    for(int i = 1, j = 1; i <= n && j <= q; i++){\n    \n        if(left[i]) change(1, 1, n, left[i], i - left[i]);\n    \n        while(j <= q && i == Q[j].r){\n    \n            ans[Q[j].id] = query(1, 1, n, Q[j].l, Q[j].r);\n            j++;\n        }\n    }\n    for(int i = 1; i <= q; i++)\n        write(ans[i] < INF ? ans[i] : -1), enter;\n}\n\n```\n", "link": "/posts/51nod 1571 \u6700\u8fd1\u7b49\u5bf9/", "tags": ["\u7ebf\u6bb5\u6811", "\u79bb\u7ebf"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF605E Intergalaxy-Trips", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF605E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF605E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$E_x$\u4e3a$x$\u5230$n$\u7684\u671f\u671b\u65f6\u95f4\n\n$E_x = \\sum_i E_i \\times p_{xi}\\prod_{j=1}^{i-1}(1-p_{xj})$\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u7c7b\u4f3c`dij`\u7684\u601d\u60f3\u6765\u66f4\u65b0\n\n\u6bcf\u6b21\u53d6\u51fa$E_x$\u6700\u5c0f\u7684$x$\u6765\u66f4\u65b0\n\n\u8981\u6ce8\u610f\u6211\u4eec\u73b0\u5728\u6c42\u51fa\u6765\u7684\u8fd8\u6ca1\u7b97\u4e0a$1$\u9700\u8981\u5148\u505c\u7559\u5728\u539f\u5730\u7684\u6982\u7387,\n\n\u9664\u6389\u4e00\u4e2a$1-\\prod p$\u624d\u662f\u6700\u7ec8\u7684\u671f\u671b\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1011\nint n;\ndb g[N][N],p[N],E[N];\nbool v[N];\nint main(){\n    in(n);\n    int x;\n    Fur(i,1,n)Fur(j,1,n)in(x),g[i][j]=x/100.0;\n    if(n==1)return puts(\"0\"),0;\n    Fur(i,1,n)E[i]=1,p[i]=1-g[i][n];\n    E[n]=0;v[n]=1;\n    Fur(i,1,n){\n        x=0;db mx=1e18;\n        Fur(j,1,n)\n        if(!v[j]&&E[j]/(1-p[j])<mx)\n            mx=E[j]/(1-p[j]),x=j;\n        v[x]=1;\n        if(x==1)return printf(\"%.10f\\n\",E[1]/(1-p[1])),0;\n        Fur(j,1,n)\n            E[j]+=(E[x]/(1-p[x]))*g[j][x]*p[j],p[j]*=(1-g[j][x]);\n    }\n}\n```\n", "link": "/posts/LG CF605E Intergalaxy-Trips/", "tags": ["\u671f\u671b", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3622 [APIO2007]\u52a8\u7269\u56ed", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3622&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3622\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint n,m,f[1<<5][N],b[1<<5][N];\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    Fur(i,1,m){\n        int p,aa,bb,x,A=0,B=0;\n        in>>p>>aa>>bb;\n        Fur(i,1,aa)in>>x,x=(x-p+n)%n,A|=(1<<x);\n        Fur(i,1,bb)in>>x,x=(x-p+n)%n,B|=(1<<x);\n        Fur(j,0,31)if((j&A)||(~j&B))++b[j][p];\n    }\n    int ans=0;\n    Fur(t,0,31){\n        Fur(i,0,31)f[i][0]=-inf;\n        f[t][0]=0;\n        Fur(i,1,n)\n            Fur(j,0,31)\n                f[j][i]=MAX(f[(j&15)<<1][i-1],f[(j&15)<<1|1][i-1])+b[j][i];\n        ans=MAX(ans,f[t][n]);\n    }\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 3622 [APIO2007]\u52a8\u7269\u56ed/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1672 \u533a\u95f4\u4ea4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u6309\u5de6\u7aef\u70b9\u6392\u5e8f,\u6bcf\u6b21\u6dfb\u52a0\u53f3\u7aef\u70b9\u7684\u65f6\u5019\u5982\u679c\u5806\u4e2d\u4e2a\u6570\u7b49\u4e8e$k$\u5c31\u7edf\u8ba1\u7b54\u6848,\u7136\u540e\u5f39\u51fa\u6700\u5c0f\u7684\u53f3\u7aef\u70b9\n\n\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,k,m;\nll s[N];\nstruct node{\n\tint l,r;\n\tbool operator<(const node& x){\n\t\treturn l<x.l||(l==x.l&&r<x.r);\n\t}\n}a[N];\npriority_queue<int,vector<int>,greater<int> >q;\nint main(){\n\tfin(\"in\");\n\tin>>n>>k>>m;\n\tFur(i,1,n)in>>s[i],s[i]+=s[i-1];\n\tFur(i,1,m)in>>a[i].l>>a[i].r;\n\tsort(a+1,a+m+1);\n\tll ans=0;\n\tFur(i,1,n){\n\t\tq.push(a[i].r);\n\t\tif(q.size()==k){\n\t\t\tans=MAX(ans,s[q.top()]-s[a[i].l-1]);\n\t\t\tq.pop();\n\t\t}\n\t}\n\tout<<ans<<ln;\n} \n\n```\n", "link": "/posts/51nod 1672 \u533a\u95f4\u4ea4/", "tags": ["\u8d2a\u5fc3", "\u5806"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1737 \u914d\u5bf9", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define int ll\nint sz[N],ans=inf,as,head[N],n,cnt=0,d[N];\nstruct edge{\n\tint to,nxt,w;\n}e[N*2];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].nxt=head[x];e[cnt].w=w;head[x]=cnt;\n}\nvoid dfs(int x,int f){\n\tsz[x]=1;\n\tint res=0;\n\tfl(i,x)\n\tif(to!=f){\n\t\tdfs(to,x);sz[x]+=sz[to];\n\t\tres=MAX(res,sz[to]);\n\t}\n\tres=MAX(res,n-sz[x]);\n\tif(res<ans)ans=res,as=x;\n}\nvoid DFS(int x,int f){\n\tans+=d[x];\n\tfl(i,x)if(to!=f)\n\t\td[to]=d[x]+e[i].w,DFS(to,x);\n}\nsigned main(){\n\tin>>n;\n\tint x,y,w;\n\tFur(i,1,n-1)\n\t\tin>>x>>y>>w,\n\t\tadd(x,y,w),\n\t\tadd(y,x,w);\n\t\t\n\tdfs(1,0);\n\tans=0;\n\tDFS(as,0);\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/51nod 1737 \u914d\u5bf9/", "tags": ["\u6811\u7684\u91cd\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1771 \u65b9\u7a0b\u7684\u89e3_NOI\u5bfc\u520a2010\u63d0\u9ad8\uff0801\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1771&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1771\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$\\sum_{i=1}^k a_i = x^x \\mod 1000  (a_i \\in \\N^*)$\n\n$\\because$ \u603b\u548c\u4e00\u5b9a\u4e3a$x^x \\mod 1000$,\u5e76\u4e14\u5206\u4e3a$k$\u4e2a\u6570,\n\n\u8bbe$n = x^x \\mod 1000$\n\n\u8fd9\u6837\u76f8\u5f53\u4e8e\u5728$n-1$\u4e2a\u7a7a\u4f4d\u4e2d\u63d2$k-1$\u5757\u9694\u677f\n\n$\\therefore ans = C(n-1,k-1)$\n\n$\\because k \\le 100,n\\le 1000$\n\n$\\therefore$\u6211\u4eec\u7528\u6768\u8f89\u4e09\u89d2(\u7528\u6eda\u52a8\u6570\u7ec4,\u5426\u5219\u53ef\u80fdre)\u5c31\u53ef\u4ee5\u4e86,\u4f46\u662f\u8981\u9ad8\u7cbe\u5ea6\n\n\u5f53\u7136\u5982\u679c\u76f4\u63a5\u8ba1\u7b97\u7ec4\u5408\u6570\u66f4\u5feb\n\n\u6768\u8f89\u4e09\u89d2\u7248:\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i=x;i<=y;i++)\n#define clr(x,y) memset(x,y,sizeof(x))\nusing namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\nint k,t;\nil int pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%1000;\n        p>>=1;x=1ll*x*x%1000;\n    }\n    return ans;\n}\n#define M 1000\nstruct node{\n    node(){clr(a,0);len=0;};\n    unsigned short a[M],len;\n    void operator = (int x){\n        while(x){\n            a[++len]=x%10;\n            x/=10;\n        }\n        reverse(a+1,a+len+1);\n    }\n    il void op(){\n        Fdr(i,len,1)out<<a[i];\n        out<<ln;\n    }\n}c[2][101];\nnode operator + (node a,node b){\n    node c;\n    int len=MAX(a.len,b.len);\n    Fur(i,1,len)\n        c.a[i]=a.a[i]+b.a[i];\n    Fur(i,1,len-1)\n        if(c.a[i]>9)c.a[i+1]+=c.a[i]/10,c.a[i]%=10;\n    while(c.a[len]>9){\n        c.a[len+1]+=c.a[len]/10;\n        c.a[len]%=10;\n        ++len;\n    }\n    c.len=len;\n    return c;\n}\nvoid work(int n,int m){\n    c[0][0]=1;\n    c[1][0]=1;\n    Fur(i,1,n)\n        Fur(j,1,m)\n        c[i&1][j]=c[!(i&1)][j-1]+c[!(i&1)][j];\n    c[n&1][m].op();\n}\nint main(){\n    in>>k>>t;t%=1000;\n    t=pw(t,t);\n    work(t-1,k-1);\n}\n```\n\n\u7ec4\u5408\u6570\u7248\uff1a\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i=x;i<=y;++i)\n#define Fdr(i,x,y) for(int i=x;i>=y;--i)\n#define clr(x,y) memset(x,y,sizeof(x))\nusing namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\nint k,t;\nil int pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%1000;\n        p>>=1;x=1ll*x*x%1000;\n    }\n    return ans;\n}\nint len=1,c[1000];\nvoid work(int n,int m){\n    len=1;c[1]=1;\n    Fur(t,1,m){\n        Fur(i,1,len)c[i]*=(n-t+1);\n        Fur(i,1,len-1)c[i+1]+=c[i]/10,c[i]%=10;\n        while(c[len]>9)c[len+1]+=c[len]/10,c[len]%=10,++len;\n        \n        int y=0;\n        Fdr(i,len,1){\n            y=y*10+c[i];\n            c[i]=y/t,y%=t;\n        }\n        while(!c[len]&&len>1)--len;\n    }\n    Fdr(i,len,1)out<<c[i];out<<ln;\n}\nint main(){\n    in>>k>>t;t%=1000;\n    t=pw(t,t);\n    work(t-1,k-1);\n}\n```\n", "link": "/posts/LG 1771 \u65b9\u7a0b\u7684\u89e3_NOI\u5bfc\u520a2010\u63d0\u9ad8\uff0801\uff09/", "tags": ["\u7ec4\u5408\u6570", "\u9ad8\u7cbe\u5ea6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2679 \u5b50\u4e32", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2679&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2679\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f_{i,j,k,(1/0)}$\uff1a$a_i$(\u9009\u6216\u4e0d\u9009)$,b_j,$\u7b2c$k$\u4f4d\n\n$f_{i,j,k,0} = f_{i-1,j,k,0} + f_{i-1,j,k,1}$\n\n$a_i = b_j$:\n\n$$f_{i,j,k,1}=f_{i-1,j-1,k,1}+f_{i-1,j-1,k-1,0}+f_{i-1,j-1,k-1,1}$$\n\n$a_i = b_j$:\n\n$f_{i,j,k,1} = 0$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\n#define mod 1000000007\nint n,m,K,f[2][2][211][211];\nchar a[N],b[N];\nint main(){\n\tin>>n>>m>>K;\n\tin>>(a+1)>>(b+1);\n\tf[0][0][0][0]=f[1][0][0][0]=1;\n\tint t=1;\n\tFur(i,1,n){\n\t\tFur(j,1,m)\n\t\t\tFur(k,1,K){\n\t\t\t\tf[t][0][k][j]=(f[!t][0][k][j]+f[!t][1][k][j])%mod;\n\t\t\t\tif(a[i]==b[j])\n\t\t\t\t\tf[t][1][k][j]=((f[!t][1][k][j-1]+f[!t][0][k-1][j-1])%mod+f[!t][1][k-1][j-1])%mod;\n\t\t\t\telse f[t][1][k][j]=0;\n\t\t\t}\n\t\tt^=1;\n\t}\n\tout<<(f[n&1][0][K][m]+f[n&1][1][K][m])%mod<<ln;\n}\n```\n", "link": "/posts/LG 2679 \u5b50\u4e32/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2398 GCD SUM", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2398&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2398\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10000011\nint pri[N],tot=0;\nll phi[N];\nbool f[N];\nvoid ol(int n){\n    phi[1]=1;\n    Fur(i,2,n){\n        if(!f[i])phi[i]=i-1,pri[++tot]=i;\n        Fur(j,1,tot){\n            if(pri[j]*i>n)break;\n            f[i*pri[j]]=1;\n            if(i%pri[j])phi[i*pri[j]]=phi[i]*phi[pri[j]];\n            else{\n                phi[i*pri[j]]=phi[i]*pri[j];\n                break;\n            }\n        }\n    }\n    Fur(i,2,n)phi[i]+=phi[i-1];\n}\nint main(){\n    int n;\n    in>>n;\n    ol(n);\n    ll ans=0;\n    Fur(i,1,n)ans+=(phi[n/i]*2-1)*i;\n    out<<ans<<ln;\n    \n}\n\n```\n", "link": "/posts/LG 2398 GCD SUM/", "tags": ["\u6570\u8bba", "\u6b27\u62c9\u51fd\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3594 [POI2015]WIL-Wilcze-do\u0142y", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3594&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3594\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u8981\u77e5\u9053\u9009\u5b9a\u4e00\u4e2a\u533a\u95f4\u9996\u5148\u8981\u51cf\u53bb\u7684\u662f\u6700\u5927\u7684\u8fde\u7eed$d$\u533a\u95f4\u7684\u548c\n\n\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u5f53\u524d\u533a\u95f4\u6700\u5927\u8fde\u7eed\u957f\u5ea6\u4e3a$d$\u7684\u5b50\u533a\u95f4\u548c\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5982\u679c$[l,r]$\u5408\u6cd5,\u90a3\u4e48$[l+1...r,r]$\u90fd\u5408\u6cd5\n\n\u53ef\u4ee5\u4f7f\u7528\u53cc\u6307\u9488\u6765\u4f18\u5316\n\n\u590d\u6742\u5ea6$\\Theta(n)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 2000011\nint n,d,q[N];\nll a[N],p,s[N];\nint main(){\n    in(n,p,d);\n    Fur(i,1,n)in(a[i]),s[i]=s[i-1]+a[i];\n    Fdr(i,n,d)s[i]-=s[i-d];\n    int ans=d,l=0,h=1,t=0;\n    ll tt=0;\n    Fur(i,1,n){\n        tt+=a[i];\n        while(h<=t&&s[q[h]]<=s[i])--t;\n        q[++t]=i;\n        while(tt-s[q[h]]>p&&h<=t){\n            tt-=a[++l];\n            while(q[h]-d<=l&&h<=t)++h;\n        }\n        ans=MAX(ans,i-l);\n    }\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG 3594 [POI2015]WIL-Wilcze-do\u0142y/", "tags": ["\u53cc\u6307\u9488", "\u5355\u8c03\u961f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2282 [HNOI2003]\u5386\u53f2\u5e74\u4efd", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2282&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2282\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n[LG 1415 \u62c6\u5206\u6570\u5217](https://www.luogu.org/problemnew/show/P1415)\u52a0\u5f3a\u7248\n\n\u590d\u6742\u5ea6\u8981\u6c42\u51cf\u5c11\n\n\u6211\u4eec\u5148\u6765\u8003\u8651$dp$\u65b9\u5f0f\n\n$f_i = max(j)|(num(f[j],j) < num(j+1,i))$\n\n\u6211\u4eec\u628a\u586b\u8868\u5f0f\u6362\u6210\u5237\u8868\u5f0f\n\n\u73b0\u5728\u4e0d\u8003\u8651$0$:\n\n\u5982\u679c$num(f[i],i)<num(i+1,i+1+i-f[i])$\n\n\u90a3\u4e48$f(x) = max(f(x),i+1) (x\\in[i+1+i-f[i],n])$\n\n\u5426\u5219$f(x) = max(f(x),i+1) (x\\in[i+1+i-f[i]+1,n])$\n\n(\u56e0\u4e3a\u957f\u5ea6+1\u80af\u5b9a\u6ee1\u8db3)\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u4ee4\u5f00\u4e00\u4e2a\u6570\u7ec4\u6765\u8bb0\u5f55\u6216\u8005\u7528\u7ebf\u6bb5\u6811\u4f18\u5316$dp$\n\n\n\n\u73b0\u5728\u8003\u8651\u90a3\u4e2a\u6bd2\u7624\u7684$0$:\n\n\u8981\u4ece$i$\u63a8\u5230$j$\n\n\u5230\u8fbe$i$\u65f6\u6700\u5c0f\u7684\u6570\u5b57\u5e94\u8be5\u662f$num(f[i],i)$\n\n\u8fd9\u65f6\u5019$num(f[i],i)$\u53ef\u80fd\u6709\u524d\u5bfc$0$\n\n$num(i+1,i+1+i-f[i])$\u4e5f\u53ef\u80fd\u6709\u524d\u5bfc$0$\n\n\u6211\u4eec\u7528$R0[i]$\u8868\u793a\u4ece$i$\u5f00\u59cb\u6709\u8fde\u7eed\u51e0\u4e2a$0$\n\n\u6bd4\u8f83\u7684\u65f6\u5019\u5c31\u53ef\u4ee5\u6392\u9664$0$\u7684\u5e72\u6270\n\n\n\n\u679a\u4e3e\u7684\u65f6\u5019\u53ef\u4ee5\u7528hash+\u4e8c\u5206\u6c42\u51fa\u6700\u5927\u516c\u5171\u524d\u7f00\u4f18\u5316\u5230$log n$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\nint n,f[N],R0[N];\nchar a[N];\nint g[N],s[N];\null h[N],pw[N];\n#define base 1331\null get(int l,int r){\n    return h[r]-h[l-1]*pw[r-l+1];\n}\nil bool cmp(int l,int r,int L,int R){\n    if(r-l<R-L)return 1;\n    if(r-l>R-L)return 0;\n    int ar=r-l+1,al=1,ans=0;\n    while(al<=ar){\n        int m=(al+ar)>>1;\n        if(get(l,l+m-1)==get(L,L+m-1))ans=m,al=m+1;\n        else ar=m-1;\n    }\n    return (ans!=r-l+1&&a[l+ans]<a[L+ans]);\n}\nint main(){\n    fin(\"in\");\n    in>>(a+1);\n    n=strlen(a+1);\n    pw[0]=1;\n    Fur(i,1,n){\n        s[i]=1,f[i]=1;\n        h[i]=h[i-1]*base+a[i];\n        pw[i]=pw[i-1]*base;\n    }\n    Fdr(i,n,1)if(a[i]=='0')R0[i]=R0[i+1]+1;\n    int S=1;\n    Fur(i,1,n){\n        S=MAX(S,s[i]);\n        f[i]=MAX(f[i],S);\n        int p,q,l,r;\n        l=f[i]+R0[f[i]];r=i;l=MIN(l,r);\n        p=r+1;p+=R0[p];q=p+r-l;\n        if(cmp(l,r,p,q))s[q]=MAX(s[q],r+1);\n        else s[q+1]=MAX(s[q+1],r+1);\n    }\n\n    clr(s,0);\n    \n    g[f[n]]=n;\n    int zero=f[n];\n    while(a[zero-1]=='0')g[--zero]=n;\n    Fdr(i,f[n]-1,1){\n        Fdr(j,f[n]-1,i)\n            if(cmp(i,j,j+1,g[j+1])){\n                g[i]=j;\n                break;\n            }\n    }\n    int p=1,ff=0;\n    while(p<=n){\n        if(ff)out.pt(',');\n        ff=1;\n        Fur(i,p,g[p])out.pt(a[i]);\n        p=g[p]+1;\n    }\n}\n```\n", "link": "/posts/LG 2282 [HNOI2003]\u5386\u53f2\u5e74\u4efd/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF147B Smile House", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF147B&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF147B\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u500d\u589e\u601d\u60f3\n\n$f[s][i][j]$\u8868\u793a\u6700\u591a\u8d70$s$\u6761\u8fb9,$i,j$\u4e4b\u95f4\u6700\u5927\u6389\u8fb9\u6743\u548c\u65f6\u591a\u5c11\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 305\nint n,m,cnt=0,f[15][N][N],g[N][N],t[N][N];\nint main(){\n    fin(\"in\");\n    memset(f,0xcf,sizeof(f));\n    memset(g,0xcf,sizeof(g));\n    int x,y,w;\n    in>>n>>m;\n    Fur(i,1,m){\n        in>>x>>y;\n        in>>f[0][x][y]>>f[0][y][x];\n    }\n    Fur(i,1,n)f[0][i][i]=0,g[i][i]=0;\n    Fur(s,1,10)\n        Fur(k,1,n)\n            Fur(i,1,n)\n                Fur(j,1,n)\n                    f[s][i][j]=MAX(f[s][i][j],f[s-1][i][k]+f[s-1][k][j]);\n    int ans=0;\n    Fdr(s,10,0){\n        bool ff=0;\n        memset(t,0xcf,sizeof(t));\n        Fur(k,1,n)\n            Fur(i,1,n)\n                Fur(j,1,n)\n                    t[i][j]=MAX(t[i][j],g[i][k]+f[s][k][j]);\n\n        Fur(i,1,n)if(t[i][i]>0){\n            ff=1;\n            break;\n        }\n        if(!ff){\n            Fur(i,1,n)Fur(j,1,n)g[i][j]=t[i][j];\n            ans+=(1<<s);\n        }\n    }\n    if(ans>=n)ans=0;\n    else ans++;\n    out<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG CF147B Smile House/", "tags": ["\u500d\u589e"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG UVA11426 GCD--ex", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/UVA11426&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/UVA11426\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$\n\\sum_i^n \\sum_{j=i+1}^n gcd(i,j)\n\\\\\\\\\n=\\sum_i^n \\sum_j^{i-1} gcd(i,j)\n\\\\\\\\\n=\\sum_d^n d \\sum_i^n \\sum_j^{i-1} [gcd(i,j)=d]\n\\\\\\\\\n=\\sum_d^n d \\sum_i^{\\frac nd} \\sum_j^{i-1} [gcd(i,j)=1]\n\\\\\\\\\n=\\sum_d^n d \\sum_i^{\\frac nd} \\varphi(i)\n\\\\\\\\\n$$\n\u4e8e\u662f\u6b27\u62c9\u7b5b\u52a0\u6574\u9664\u5206\u5757\u5c31\u53ef\u4ee5\u4e86\n\n\n\n\u672c\u9898\u4e3a\u4e03\u500d\u7ecf\u9a8c\u9898\uff01\uff01\uff01\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 40000001\nint pri[N+11],tot=0;\nll phi[N+11];\nbool f[N+11];\nvoid ol(int n){\n\tphi[1]=0;\n\tFur(i,2,n){\n\t\tif(!f[i])phi[i]=i-1,pri[++tot]=i;\n\t\tFur(j,1,tot){\n\t\t\tif(pri[j]*i>n)break;\n\t\t\tf[i*pri[j]]=1;\n\t\t\tif(i%pri[j])phi[i*pri[j]]=phi[i]*phi[pri[j]];\n\t\t\telse{\n\t\t\t\tphi[i*pri[j]]=phi[i]*pri[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tFur(i,2,n)phi[i]+=phi[i-1];\n}\nint main(){\n\tol(N);\n\tint n;ll ans;\n\twhile(1){\n\t\tin>>n;if(!n)break;\n\t\tans=0;\n\t\tfor(int l=1,r;l<=n;l=r+1){\n\t\t\tr=n/(n/l);\n\t\t\tans+=phi[int(n/l)]*(r-l+1)*(r+l)/2;\n\t\t}\n\t\tout<<ans<<ln;\n\t}\n}\n\n```\n", "link": "/posts/LG UVA11426 GCD--ex/", "tags": ["\u6b27\u62c9\u51fd\u6570", "\u6574\u9664\u5206\u5757", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1099 \u6811\u7f51\u7684\u6838", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1099&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1099\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u4e24\u6b21dfs\u627e\u6811\u7684\u76f4\u5f84\n\nemmmm, $n \\le 300$ !!!\n\n\u968f\u4fbf\u5199\u597d\u4e86\n\n\u539f\u6765bzoj\u8fd8\u6709\u4e00\u9053\u52a0\u5f3a\u7248,~~\u53cc\u500d\u7ecf\u9a8c\u591a\u597d~~\n\n\u4e00\u5b9a\u8981\u5728\u76f4\u5f84\u4e0a\u53d6,\u800c\u4e14\u8ddd\u79bb\u4e0d\u53ef\u4ee5\u5927\u4e8e$s$,\u90a3\u4e48\u5355\u8c03\u961f\u5217\u7684\u601d\u60f3\u4e0d\u662f\u53ef\u4ee5\u5417\uff1f\n\n\u56e0\u4e3a\u79bb\u76f4\u5f84\u4e2d\u70b9\u8d8a\u8fd1\u201c\u8d21\u732e\u8d8a\u5927\u201d\n\n\u610f\u4f1a\u4e00\u4e0bQwQ\n\n\u8fd9\u6837\u4e0b\u6765\u4ee3\u7801\u91cf\u4e5f\u5f88\u77ed =\uffe3\u03c9\uffe3=\n\n\u800c\u4e14\u53ef\u4ee5ac bzoj\u7684\u52a0\u5f3a\u7248\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 500011\nint n,s,cnt=0,head[N],d[N],f[N],tmp=0,top,ans=inf;\nbool b[N];\nstruct edge{\n\tint to,nxt,w;\n}e[N*2];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n\tif(d[x]>d[tmp])tmp=x;\n\tfl(i,x)\n\tif(to!=f[x]&&!b[to])d[to]=d[x]+e[i].w,f[to]=x,dfs(to);\n}\nint main(){\n\tin>>n>>s;\n\tint x,y,w;\n\tFur(i,1,n-1)\n\t\tin>>x>>y>>w,\n\t\tadd(x,y,w),add(y,x,w);\n\t\n\td[1]=1;dfs(1);\n\td[tmp]=0;f[tmp]=0;\n\tdfs(tmp);\n\ttop=tmp;\n\tint h=0,t=1;\n\tfor(int i=top,j=top;i;i=f[i]){\n\t\twhile(d[j]-d[i]>s)j=f[j];\n\t\tans=MIN(ans,MAX(d[top]-d[j],d[i]));\n\t}\n\tfor(int i=top;i;i=f[i])b[i]=1;\n\tfor(int i=top;i;i=f[i]){\n\t\tx=i;d[i]=0;\n\t\tdfs(i);\n\t}\n\tFur(i,1,n)ans=MAX(ans,d[i]);\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 1099 \u6811\u7f51\u7684\u6838/", "tags": ["dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LOJ 2157 Lightning-Conductor", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://loj.ac/problem/2157&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://loj.ac/problem/2157\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u9898\u76ee\u5927\u610f\uff1a\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n\\leq 500000$ \u7684\u5e8f\u5217 $a_1, a_2, \\cdots, a_n$ ,\u8981\u6c42\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $1 \\leq r \\leq n$ ,\u627e\u5230\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570 $f_{r}$ \u6ee1\u8db3\n\n$$\\forall l\\in\\left[1,n\\right]:a_l \\leq a_r + f_{r} - \\sqrt{|r-l|}$$\n\n## \u89e3\u6cd5\n\n\u8003\u8651$l<r,r>l$\u7684\u5c06\u5e8f\u5217\u7ffb\u8f6c\u540e\u518d\u6765\u4e00\u6b21\u5c31\u53ef\u4ee5\u4e86\n\n$$f_r= \\max(a_l+\\sqrt{r-l})-a_r(l\\in[1,r])$$\n\n\u53ef\u4ee5\u8bc1\u660e$f_r$\u7684\u6700\u4f18\u51b3\u7b56\u70b9\u662f\u9012\u589e\u7684\n\n~~\u53ef\u4ee5\u6253\u8868~~\n\n### \u5206\u6cbb\u89e3\u6cd5\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define db double\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500011\nint n;\nll a[N];\nlong db f1[N],f2[N];\nvoid work(int L,int R,int l,int r,long db *f){\n    if(L>R)return;\n    int m=(L+R)>>1,k=0;\n    f[m]=a[m];\n    long db t=0;\n    Fur(i,l,MIN(r,m)){\n        t=a[i]+sqrt(db(m-i));\n        if(t>f[m])k=i,f[m]=t;\n    }\n    f[m]-=a[m];\n    if(!k)k=m;\n    work(L,m-1,l,k,f);\n    work(m+1,R,k,r,f);\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i]);\n    work(1,n,1,n,f1);\n    reverse(a+1,a+n+1);\n    work(1,n,1,n,f2);\n    Fur(i,1,n)out((ll)ceil(MAX(f1[i],f2[n-i+1])),ln);\n    flush();\n}\n```\n\n### \u961f\u5217\u5b9e\u73b0\u51b3\u7b56\u4e8c\u5206\u6808\n\n\u5bf9\u4e8e\u6bcf\u4e2a$j$,\u628a$a_j+\\sqrt{i-j}$\u770b\u6210\u5173\u4e8e$i$\u7684\u51fd\u6570$f_j$\u3002\n\n\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u5728\u6240\u6709$j\\leq i$\u7684\u51fd\u6570\u4e2d\u627e\u5230\u6700\u503c\n\n\u961f\u5217\u5b9e\u73b0\u51b3\u7b56\u4e8c\u5206\u6808,\u6309$j$\u4ece\u5c0f\u5230\u5927\u4f9d\u6b21\u7ef4\u62a4\u8fd9\u4e9b\u51fd\u6570\u3002\n\n\u5bf9\u4e8e\u5176\u4e2d\u4efb\u610f\u4e24\u4e2a\u76f8\u90bb\u7684\u51fd\u6570$f_t,f_{t+1}$ ,\u5b83\u4eec\u90fd\u6709\u4e00\u4e2a\u4e34\u754c\u503c$k_{t,t+1}$\n\n\u663e\u7136\u5e8f\u5217\u4e2d\u7684$k_{1,2},k_{2,3}...$\u4e5f\u8981\u4e25\u683c\u9012\u589e\u3002\n\n\u5426\u5219,\u5982\u679c$k_{t,t+1}\\ge k_{t+1,t+2}$,$f_{t+1}$\u6839\u672c\u6ca1\u6709\u7528\u3002\n\n\u6bcf\u6b21\u52a0\u5165$f_i$\u7684\u65f6\u5019\uff1a\n\n\u8bbe\u961f\u5c3e\u4e3a$t$,\u5982\u679c\u5f53\u524d$i$\u6bd4$t$\u4f18($calc(k_{t-1},i)\\ge calc(k_{t-1},t)$),\u90a3\u4e48\u5f39\u51fa$t$\n\n\u73b0\u5728\u6765\u8003\u8651\u961f\u5934$h$\n\n\u82e5$k_h\\le i$\u90a3\u4e48\u628a$h$\u5f39\u51fa\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define db double\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500011\nint n,a[N],q[N],k[N];\ndb p[N],sq[N];\nil db calc(int i,int j){return a[j]+sq[i-j];}//\u51fd\u6570\u503c\nil int bound(int x,int y){\n    int l=y,r=(k[x]?k[x]:n),m,ret=r+1;\n    while(l<=r){\n        m=(l+r)>>1;\n        if(calc(m,x)<=calc(m,y))\n            ret=m,r=m-1;\n        else l=m+1;\n    }\n    return ret;\n}\nvoid work(){\n    int h=1,t=0;\n    Fur(i,1,n){\n        while(h<t&&calc(k[t-1],q[t])<calc(k[t-1],i))--t;\n        //\u4fdd\u6301k\u5355\u8c03\n        k[t]=bound(q[t],i);\n        //\u4e8c\u5206\u51fa\u4e34\u754c\u70b9\n        q[++t]=i;\n        while(h<t&&k[h]<=i)++h;\n        //\u4e0d\u4f18\u7684\u51fa\u961f\n        p[i]=MAX(p[i],calc(i,q[h]));\n        //\u4e24\u904d\u53d6max\n    }\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i]),sq[i]=sqrt(i);\n    work();\n\n    //\u7ffb\u8f6c\u5e8f\u5217\n    reverse(a+1,a+n+1);\n    reverse(p+1,p+n+1);\n    memset(k,0,(n+1)<<2);\n    work();\n\n    //\u7ffb\u8f6c\u540e\u9700\u8981\u5012\u5e8f\u8f93\u51fa\n    Fdr(i,n,1)out(MAX(int(ceil(p[i]))-a[i],0),ln);\n    flush();\n}\n```\n", "link": "/posts/LOJ 2157 Lightning-Conductor/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5355\u8c03\u961f\u5217", "\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f", "\u51b3\u7b56\u5355\u8c03\u6027"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4868 Preprefix sum", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4868&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4868\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define int ll\n#define ls rt<<1\n#define rs rt<<1|1\nint n,m,s[N<<2],S[N<<2];\nvoid pu(int rt,int ln,int rn){\n    s[rt]=s[ls]+s[rs];\n    S[rt]=S[rs]+s[ls]*rn+S[ls];\n}\nvoid build(int l,int r,int rt){\n    if(l==r){\n        in>>s[rt];\n        S[rt]=s[rt];\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu(rt,m-l+1,r-m);\n}\nvoid upd(int x,int v,int l,int r,int rt){\n    if(l==r){\n        s[rt]=S[rt]=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    if(x<=m)upd(x,v,l,m,ls);\n    else upd(x,v,m+1,r,rs);\n    pu(rt,m-l+1,r-m);\n}\nstruct node{\n    int s,S;\n};\nnode ask(int R,int l,int r,int rt){\n    if(r<=R)return node{s[rt],S[rt]};\n    int m=(l+r)>>1;\n    if(R<=m)return ask(R,l,m,ls);\n    node a=ask(R,l,m,ls),b=ask(R,m+1,r,rs);\n    return node{a.s+b.s,b.S+a.s*(R-m)+a.S};\n}\nsigned main(){\n    fin(\"in\");\n    in>>n>>m;\n    build(1,n,1);\n    char ch[10];int x,v;\n    while(m--){\n        in>>ch>>x;\n        if(ch[0]=='Q')out<<ask(x,1,n,1).S<<ln;\n        else in>>v,upd(x,v,1,n,1);\n    }\n}\n```\n", "link": "/posts/LG 4868 Preprefix sum/", "tags": ["\u7ebf\u6bb5\u6811", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF242E XOR-on-Segment", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF242E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF242E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u76f4\u63a5\u5efa\u7acb20\u68f5\u7ebf\u6bb5\u6811\u7edf\u8ba1$1,2,4,8,...,2^20$\u5c31\u53ef\u4ee5\u4e86\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\n#define int ll\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=s[ls]+s[rs]\nint n;\nstruct seg{\n    int s[N<<2],laz[N<<2];\n    void pd(int rt,int ln,int rn){\n        if(laz[rt]){\n            laz[ls]^=1;\n            laz[rs]^=1;\n            s[ls]=ln-s[ls];\n            s[rs]=rn-s[rs];\n            laz[rt]=0;\n        }\n    }\n    void upd(int L,int R,int l,int r,int rt){\n        if(L<=l&&r<=R){\n            s[rt]=r-l+1-s[rt];\n            laz[rt]^=1;\n            return;\n        }\n        int m=(l+r)>>1;\n        pd(rt,m-l+1,r-m);\n        if(L<=m)upd(L,R,l,m,ls);\n        if(R>m)upd(L,R,m+1,r,rs);\n        pu;\n    }\n    int ask(int L,int R,int l,int r,int rt){\n        if(L<=l&&r<=R)return s[rt];\n        int m=(l+r)>>1,ans=0;\n        pd(rt,m-l+1,r-m);\n        if(L<=m)ans=ask(L,R,l,m,ls);\n        if(R>m)ans+=ask(L,R,m+1,r,rs);\n        return ans;\n    }\n}T[21];\nsigned main(){\n    in(n);\n    int q,opt,l,r,x;\n    Fur(i,1,n){\n        in(x);\n        Fur(j,0,20){\n            if(x&1)T[j].upd(i,i,1,n,1);\n            x>>=1;\n        }\n    }\n    in(q);\n    while(q--){\n        in(opt,l,r);\n        if(opt==1){\n            ll ans=0;\n            Fur(i,0,20)ans+=(1<<i)*T[i].ask(l,r,1,n,1);\n            out(ans,ln);\n        }\n        else{\n            in(x);\n            Fur(i,0,20){\n                if(x&1)T[i].upd(l,r,1,n,1);\n                x>>=1;\n            }\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF242E XOR-on-Segment/", "tags": ["\u7ebf\u6bb5\u6811", "\u4f4d\u8fd0\u7b97"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1675 \u5e8f\u5217\u53d8\u6362", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$\\sum_{x=1}^n \\sum_{y=1}^n [gcd(x,y)=1][a_{b_x}=b_{a_y}]$\n\n\u53ef\u4ee5\u76f4\u63a5\u8bb0\u5f55$v[a_{b_x}]$\u7136\u540e\u7edf\u8ba1,\u7528\u83ab\u6bd4\u4e4c\u65af\u5bb9\u65a5\n<!-- more -->\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\n#define N 100011\n#define ll long long\nint a[N],b[N];\nint viss[N];\nint n;\nbool vis[N+10];  \nint prime[N+10],mu[N+10];  \nint cnt;\nvoid Init(){\n    memset(prime,0,sizeof(prime));  \n    memset(mu,0,sizeof(mu));  \n    memset(vis,0,sizeof(vis));  \n    mu[1] = 1;  \n    cnt = 0;  \n    for(int i=2; i<N; i++){  \n        if(!vis[i]){  \n            prime[cnt++] = i;  \n            mu[i] = -1;  \n        }  \n        for(int j=0; j<cnt&&i*prime[j]<N; j++){  \n            vis[i*prime[j]] = 1;  \n            if(i%prime[j]) mu[i*prime[j]] = -mu[i];  \n            else{  \n                mu[i*prime[j]] = 0;  \n                break;  \n            }  \n        }  \n    }\n}\n\nll cal(int x){\n    ll res=0;\n    for(int i=x;i<=n;i+=x)\n        viss[a[b[i]]]++;\n    for(int i=x;i<=n;i+=x)\n        res+=viss[b[a[i]]];\n    for(int i=x;i<=n;i+=x)\n        viss[a[b[i]]]--;\n    return res;\n}\nint main(){\n    Init();\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++)\n        scanf(\"%d\",&a[i]);\n    for(int i=1;i<=n;i++)\n        scanf(\"%d\",&b[i]);\n    ll res=0;\n    for(int i=1;i<=n;i++)\n        res+=1ll*mu[i]*cal(i);\n    printf(\"%lld\\n\",res );\n}\n\n```\n", "link": "/posts/51nod 1675 \u5e8f\u5217\u53d8\u6362/", "tags": ["\u83ab\u6bd4\u4e4c\u65af"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1201 \u6574\u6570\u5212\u5206", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\ndp\n\n(\u5176\u5b9e\u8bb0\u5fc6\u5316\u641c\u7d22\u4e5f\u53ef\u4ee5\u5566)\n\n\u53ea\u8981\u5047\u8bbe\u7ec4\u6210$n$\u7684\u6570\u662f\u9012\u589e\u6216\u9012\u51cf,\u5c31\u4e0d\u4f1a\u91cd\u590d\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 50011\n#define mod 1000000007\nint n;\nll f[321][N],ans=0;\nint main(){\n\tin>>n;\n\tf[0][0]=1;\n\tFur(i,1,320)\n\t\tFur(j,i,n)\n\t\tf[i][j]=(f[i-1][j-i]+f[i][j-i])%mod;\n\t\n\tFur(i,1,320)ans=(ans+f[i][n])%mod;\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/51nod 1201 \u6574\u6570\u5212\u5206/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u8bb0\u5fc6\u5316\u641c\u7d22"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG UVA1442 \u6d1e\u7a74 Cav", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/UVA1442&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/UVA1442\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u4e2a\u70b9\u5728\u67d0\u4e2a\u9ad8\u5ea6\u6709\u6c34\u6ee1\u8db3\u5de6\u8fb9\u548c\u53f3\u8fb9\u5728\u540c\u4e00\u9ad8\u5ea6\u8981\u4e48\u662f\u6c34\u8981\u4e48\u662f\u77f3\u5934\n\n\u9884\u5904\u7406\u51fa$L_i$\u548c$R_i$\u8868\u793a\u4e00\u4e2a\u70b9\u5de6\u8fb9\u548c\u53f3\u8fb9\u7684\u9650\u5236\n\n$L_i = \\max (\\min(L_{i-1},s_i),p_i)$\n\n$R_i$\u540c\u7406\n\n$ans = \\sum_{i=1}^n \\min(L_i,R_i) - p_i$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1100011\nint n,a[N],b[N],L[N],R[N],q[N],tp;\nvoid work(){\n    in>>n;\n    Fur(i,1,n)in>>a[i];\n    Fur(i,1,n)in>>b[i];\n    int now;\n    L[1]=now=b[1];\n    Fur(i,2,n){\n        now=MIN(now,b[i]);\n        now=MAX(now,a[i]);\n        L[i]=now;\n    }\n    R[n]=now=b[n];\n    Fdr(i,n-1,1){\n        now=MIN(now,b[i]);\n        now=MAX(now,a[i]);\n        R[i]=now;\n    }\n    int ans=0;\n    Fur(i,1,n)ans+=MIN(L[i],R[i])-a[i];\n    out<<ans<<ln;\n}\nint main(){\n    fin(\"in\");\n    int tt;in>>tt;\n    while(tt--)work();\n}\n```\n", "link": "/posts/LG UVA1442 \u6d1e\u7a74 Cav/", "tags": ["\u601d\u7ef4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1114D Flood Fill", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1114D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1114D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u628a\u8fde\u7eed\u7684\u5757\u7f29\u6210\u4e00\u4e2a\u70b9\n\n\u8bbe$f[i][j]$\u8868\u793a$[i,j]$\u5168\u90e8\u6d82\u6210\u4e00\u79cd\u989c\u8272\u6700\u5c11\u8981\u591a\u5c11\u6b21\n\n$f[i][j] = \\min(f[i+1][j],f[i][j-1])+1$\n\n\u82e5$c[i]==c[j]$,$f[i][j]=f[i+1][j-1]+1$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 5111\nint n,a[N],f[N][N];\nint main(){\n    fin(\"in\");\n    in>>n;\n    clr(f,126);\n    Fur(i,1,n){\n        in>>a[i];\n        if(a[i]==a[i-1])--i,--n;\n    }\n    Fur(i,1,n)f[i][i]=0;\n    Fur(k,2,n)\n        Fur(i,1,n-k+1){\n            int j=i+k-1;\n            if(a[i]==a[j])f[i][j]=f[i+1][j-1]+1;\n            else f[i][j]=MIN(f[i+1][j],f[i][j-1])+1;\n        }\n    \n    out<<f[1][n]<<ln;\n}\n```\n", "link": "/posts/LG CF1114D Flood Fill/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u533a\u95f4dp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2148 [SDOI2009]E and D", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2148&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2148\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u53ef\u4ee5\u770b\u6210$n$\u5bf9\u77f3\u5b50\u5806\u7684\u535a\u5f08\u8bba\n\n\u90a3\u4e48\u6211\u4eec\u628a$n$\u5bf9\u77f3\u5b50\u5806\u7684$SG$\u503c\u5f02\u6216\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86\n\n\u90a3\u600e\u4e48\u6c42\u6bcf\u5bf9\u77f3\u5b50\u5806\u7684$SG$\u503c\u5462\uff1f\n\n$SG(x,y) = mex({SG(x',y')})(x'+y' = x \u6216 x'+y' = y)$\n\n~~\u6253\u8868\u4e4b\u540e\u53ef\u4ee5\u53d1\u73b0~~:\n\n\u6bcf\u4e00\u5bf9$(i,j)$,\u76f4\u63a5\u6c42$(i-1)\\mid(j-1)$\u4e8c\u8fdb\u5236\u7684\u6700\u4f4e\u76840\u6240\u5728\u7684\u4e8c\u8fdb\u5236\u4f4d\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint main(){\n    fin(\"in\");\n    int T,n;\n    in>>T;\n    while(T--){\n        in>>n;n>>=1;\n        int x,y,s=0;\n        Fur(i,1,n){\n            in>>x>>y;\n            int t=((x-1)|(y-1)),c=0;\n            while(t&1)++c,t>>=1;\n            s^=c;\n        }\n        out<<(s?\"YES\":\"NO\")<<ln;\n    }\n}\n```\n", "link": "/posts/LG 2148 [SDOI2009]E and D/", "tags": ["\u535a\u5f08\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3628 [APIO2010]\u7279\u522b\u884c\u52a8\u961f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3628&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3628\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_i$\u8868\u793a\u524d$i$\u4e2a\u62c6\u5206\u540e\u6700\u5927\u6218\u6597\u529b\u548c\n\n$$\nf_i=\\max_{j=1}^{i-1}(f_j+a(s_i-s_j)^2+b(s_i-s_j)+c)\n$$\n\n~~\u8fd9\u4e2a\u5f88\u660e\u663e\u662f\u659c\u7387\u4f18\u5316\u5f0f\u5b50~~\n\n\u8bbe\u4efb\u610f$0\\le j<k < i$,\u82e5\u4ece$j$\u8f6c\u79fb\u5230$i$\u4f18\u4e8e\u4ece$k$\u8f6c\u79fb,\u90a3\u4e48\uff1a\n\n$$\nf_j+a(s_i-s_j)^2+b(s_i-s_j)+c\\ge f_k+a(s_i-s_k)^2+b(s_i-s_k)+c\n\\\\\n2as_i\\le\\frac{(f_k+a{s_k}^2-bs_k)-(f_j+a{s_j}^2-bs_j)}{s_k-s_j}\n$$\n\n\u7ef4\u62a4\u4e2a\u4e0b\u51f8\u58f3\u5c31\u5b8c\u4e8b\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1000011\nint n,q[N];\ndb f[N],s[N],a,b,c;\ndb S(int i,int j){\n    return (db)((f[j]+a*s[j]*s[j]-b*s[j])-(f[i]+a*s[i]*s[i]-b*s[i]))/(db)(s[j]-s[i]);\n}\nint main(){\n    in(n,a,b,c);\n    int x;\n    Fur(i,1,n)in(x),s[i]=s[i-1]+x;\n    int h=1,t=1;q[1]=0;\n    Fur(i,1,n){\n        while(h<t&&S(q[h],q[h+1])>=2*a*s[i])++h;\n        f[i]=f[q[h]]+a*(s[i]-s[q[h]])*(s[i]-s[q[h]])+b*(s[i]-s[q[h]])+c;\n        while(h<t&&S(q[t-1],q[t])<=S(q[t-1],i))--t;\n        q[++t]=i;\n    }\n    printf(\"%.0lf\\n\",f[n]);\n}\n```\n", "link": "/posts/LG 3628 [APIO2010]\u7279\u522b\u884c\u52a8\u961f/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5355\u8c03\u961f\u5217", "\u659c\u7387\u4f18\u5316", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3760 [TJOI2017]\u5f02\u6216\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3760&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3760\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fde\u7eed\u548c\u76f8\u5f53\u4e8e\u533a\u95f4\u548c,\u9898\u76ee\u7684\u610f\u601d\u662f\u6c42\u6240\u6709$S_i-S_j$\u7684\u5f02\u6216\u548c\n\n\u4e00\u822c\u4f4d\u8fd0\u7b97\u7684\u9898\u6211\u4eec\u90fd\u62c6\u6210\u4e8c\u8fdb\u5236\u4e0b32\u4f4d\u6765\u89e3\u51b3\n\n\u8003\u8651\u6bcf\u4e00\u4f4d\n\n\u679a\u4e3e$k$\n\n\u5982\u4f55\u7edf\u8ba1\u6709\u591a\u5c11\u4e2a$((S_i-S_j)>>k)\\&1$\u5462\uff1f\n\n\u53ef\u4ee5\u5f00\u4e24\u4e2a\u6743\u503c\u6811\u72b6\u6570\u7ec4\u6765\u7edf\u8ba1$0$\u548c$1$\u7684\u6570\u91cf\n\n\u5982\u679c\u5f53\u524d$S_i$\u7684\u7b2c$k$\u4f4d\u4e3a$1$,\u5982\u679c$S_j\\&(1<<k) = 0$\u4e14$S_i+S_j$\u5728\u4e8c\u8fdb\u5236\u4e0b\u8fdb\u4f4d\u4e0d\u4f1a\u5f71\u54cd\u5230\u7b2c$k$\u4f4d\u7684\u90fd\u7b26\u5408\u6761\u4ef6\n\n\u4e5f\u5c31\u662f$S_j\\&((1<<k)-1) \\not = (S_i\\&((1<<k)-1))$\n\n$\\&((1<<k)-1)$\u4e5f\u5c31\u662f\u53d6\u524d$k$\u4f4d\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define ll long long\nconst int N=100011,M=1000011;\nint n,lim,s[N];\nll res;\nstruct tr{\n    ll T[2*M];\n    void c(int x,ll t){\n        x+=1;\n        for(;x<=lim+1;x+=x&(-x))T[x]+=t;\n    }\n    ll q(int x){\n        x+=1;\n        ll r=0;\n        for(;x>0;x-=x&(-x))r+=T[x];\n        return r;\n    }\n    ll s(int l,int r){return q(r)-q(l);}\n    void clear(){for(int i=0;i<=lim+1;i++)T[i]=0;}\n}T1,T0;\nint main(){\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++){\n        scanf(\"%d\",&s[i]);\n        s[i]+=s[i-1];\n    }\n    for(int k=0;(1<<k)<=s[n];k++){\n        lim=(1<<k)-1;ll ret=0;\n        for(int i=0;i<=n;i++){\n            int lst=s[i]&lim;\n            if((s[i]>>k)&1){\n                ret+=T0.s(-1,lst)+T1.s(lst,lim);\n                T1.c(lst,1);\n            }\n            else{\n                ret+=T1.s(-1,lst)+T0.s(lst,lim);\n                T0.c(lst,1);\n            } \n        }\n        if(ret&1)res+=(1<<k);\n        T1.clear();T0.clear();\n    }\n    printf(\"%lld\",res);\n}\n```\n", "link": "/posts/LG 3760 [TJOI2017]\u5f02\u6216\u548c/", "tags": ["\u524d\u7f00\u548c", "\u4f4d\u8fd0\u7b97", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5589 \u5c0f\u732a\u4f69\u5947\u73a9\u6e38\u620f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5589&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5589\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5f53\u6211\u4eec\u9009\u4e2d\u4e00\u4e2a$i$\u540e\n\n$i,i^2,i^3...,i^k$\u90fd\u4f1a\u88ab\u53bb\u6389\n\n\u6211\u4eec\u8bbe$d_t$\u4e3a\u53ef\u4ee5\u53bb\u6389$t$\u7684\u6570\u5b57\u7684\u4e2a\u6570\n\n$ans = \\sum_{i=1}^n \\frac 1 {d_i}$\n\n\u90a3\u4e48\u5982\u4f55\u7edf\u8ba1\u5462\uff1f\n\n\u5206\u89e3\u8d28\u56e0\u6570\n\n$n = p_1^{k_1}p_2^{k_2}p_3^{k_3}p_4^{k_4}...$\n\n\u5bf9\u4e8e$k_i$\u8d21\u732e\u4e3a$1+\\frac12+\\frac12+\\frac14+...$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,d[N];\ndb p[N];\ndb ans=0;\nint main(){\n    cin>>n;\n    int len;\n    Fur(t,1,30){\n        len=sqrt(t);\n        Fur(i,1,len)\n\n    }\n    len=sqrt(n);\n    Fur(i,2,len){\n        int t=0;\n        while(n%i==0)++t,n/=i;\n        ans+=p[t];\n    }\n    \n}\n```\n", "link": "/posts/LG 5589 \u5c0f\u732a\u4f69\u5947\u73a9\u6e38\u620f/", "tags": ["\u671f\u671b"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1530 \u5206\u6570\u5316\u5c0f\u6570-Fractions-to-Decimals", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1530&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1530\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint p[N],ans[N],tt=0;\nint main(){\n    int a,b,c;\n    cin>>a>>b;\n    c=GCD(a,b);\n    a/=c;b/=c;\n    cout<<(a/b)<<\".\";a%=b;\n    if(!a)return cout<<0,0;\n    int d=0,n=1000;\n    a*=10;\n    Fur(i,1,n){\n        p[i]=a/b;\n        a%=b;\n        if(!a){\n            Fur(j,1,i)cout<<p[j];\n            return 0;\n        }\n        a*=10;\n    }\n    Fur(len,1,n/2){\n        Fur(l,1,n-len*2+1){\n            int r=l+len-1,f=1;\n            Fur(i,1,r-l+1)\n            if(p[l+i-1]!=p[r+i]){f=0;break;}\n            if(f){\n                Fur(i,1,l-1)cout<<p[i];\n                cout<<\"(\";\n                Fur(i,l,r)cout<<p[i];\n                cout<<\")\";\n                return 0;\n            }\n        }\n    }\n}\n```\n", "link": "/posts/LG 1530 \u5206\u6570\u5316\u5c0f\u6570-Fractions-to-Decimals/", "tags": ["\u6a21\u62df"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3501 [POI2010]ANT-Antisymmetry", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3501&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3501\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nhash\u6b63\u7740\u6765\u4e00\u904d\u548c\u5012\u7740\u6765\u4e00\u904d\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 500011\n#define base 1331\nint n;\null h[N],H[N],pw[N];\nchar s[N];\nll ans=0;\null g(int l,int r){\n    return h[l]-h[r+1]*pw[r-l+1];\n}\null G(int l,int r){\n    return H[r]-H[l-1]*pw[r-l+1];\n}\nvoid q(int x){\n    int l=0,r=MIN(x,n-x),t;\n    while(l<=r){\n        int m=(l+r)>>1;\n        if(g(x-m+1,x+m)==G(x-m+1,x+m))l=m+1,t=m;\n        else r=m-1;\n    }\n    ans+=t;\n}\nint main(){\n    fin(\"in\");\n    in>>n>>(s+1);\n    pw[0]=1;\n    Fur(i,1,n)H[i]=H[i-1]*base+(s[i]=='0'),pw[i]=pw[i-1]*base;\n    Fdr(i,n,1)h[i]=h[i+1]*base+(s[i]=='1');\n    Fur(i,1,n-1)if(s[i]!=s[i+1])q(i);\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 3501 [POI2010]ANT-Antisymmetry/", "tags": ["hash"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5482 [JLOI2011]\u4e0d\u7b49\u5f0f\u7ec4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5482&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5482\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n\n```\n", "link": "/posts/LG 5482 [JLOI2011]\u4e0d\u7b49\u5f0f\u7ec4/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2387 [NOI2014]\u9b54\u6cd5\u68ee\u6797", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2387&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2387\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fd8\u662flct\u7ef4\u62a4\u6700\u5c0f\u751f\u6210\u6811\n\n\u5148\u6309$a$\u53d8\u6392\u5e8f,\u7136\u540e$b$\u8fb9\u7684\u5904\u7406\u7c7b\u4f3c[WC2006\u6c34\u7ba1\u5c40\u957f](https://www.luogu.org/problem/P4172)\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\nbool rev[N];\nint  v[N],f[N],st[N],c[N][2],s[N];\n#define ls c[x][0]\n#define rs c[x][1]\nbool irt(int x){return c[f[x]][0]!=x&&c[f[x]][1]!=x;}\nvoid pu(int x){\n\ts[x]=MAX(MAX(s[ls],s[rs]),v[x]);\n}\nvoid pr(int x){\n\tSWAP(ls,rs);\n\trev[x]^=1;\n}\nvoid pd(int x){\n\tif(rev[x]){\n\t\tif(ls)pr(ls);\n\t\tif(rs)pr(rs);\n\t\trev[x]=0;\n\t}\n}\nint g(int x){return c[f[x]][1]==x;}\nvoid turn(int x){\n\tint y=f[x],z=f[y],l=g(x),r=!l,w=c[x][r];\n\tif(!irt(y))c[z][g(y)]=x;\n\tc[x][r]=y;c[y][l]=w;\n\tif(w)f[w]=y;\n\tf[x]=z;f[y]=x;\n\tpu(y);pu(x);\n}\nvoid splay(int x){\n\tint y=x,z=0;\n\tst[++z]=y;\n\twhile(!irt(y))st[++z]=y=f[y];\n\twhile(z)pd(st[z--]);\n\twhile(!irt(x)){\n\t\ty=f[x];z=f[y];\n\t\tif(!irt(y))\n\t\t\tturn((c[y][0]==x)^(c[z][0]==y)?x:y);\n\t\tturn(x);\n\t}\n\tpu(x);\n}\nvoid access(int x){\n\tfor(int y=0;x;x=f[y=x])\n\t\tsplay(x),rs=y,pu(x);\n}\nvoid mrt(int x){\n\taccess(x);splay(x);pr(x);\n}\nint frt(int x){\n\taccess(x);splay(x);\n\twhile(ls)pd(x),x=ls;\n\tsplay(x);\n\treturn x;\n}\nvoid sl(int x,int y){\n\tmrt(x);access(y);splay(y);\n}\nvoid link(int x,int y){\n\tmrt(x);\n\tif(frt(y)!=x)f[x]=y;\n}\nvoid cut(int x,int y){\n\tmrt(x);\n\tif(frt(y)==x&&f[y]==x&&!c[y][0]){\n\t\tf[y]=c[x][1]=0;\n\t\tpu(x);\n\t}\n}\nint find(int x,int k){\n\tif(v[x]==k)return x;\n\tif(s[ls]==k)return find(ls,k);\n\treturn find(rs,k);\n}\nstruct edge{\n\tint x,y,a,b;\n}e[N];\nbool cmp(edge x,edge y){\n\treturn (x.a==y.a)?(x.b<y.b):(x.a<y.a);\n}\nint n,m,ff[N];\nint gf(int x){return x==ff[x]?x:(ff[x]=gf(ff[x]));}\nint main(){\n\tin>>n>>m;\n\tFur(i,1,n)ff[i]=i;\n\tFur(i,1,m)in>>e[i].x>>e[i].y>>e[i].a>>e[i].b;\n\tsort(e+1,e+m+1,cmp);\n\tint x,y,ans=inf;\n\tFur(i,1,m){\n\t\tx=e[i].x,y=e[i].y;\n\t\tif(gf(x)!=gf(y)){\n\t\t\tv[n+i]=e[i].b;\n\t\t\tlink(x,n+i);link(y,n+i);\n\t\t\tff[gf(x)]=gf(y);\n\t\t}\n\t\telse{\n\t\t\tsl(x,y);\n\t\t\tif(e[i].b<s[y]){\n\t\t\t\tint t=find(y,s[y]);\n\t\t\t\tcut(e[t-n].x,t);\n\t\t\t\tcut(e[t-n].y,t);\n\t\t\t\tv[n+i]=e[i].b;\n\t\t\t\tlink(x,n+i);\n\t\t\t\tlink(y,n+i);\n\t\t\t}\n\t\t}\n\t\tif(gf(1)==gf(n)){\n\t\t\tsl(1,n);\n\t\t\tans=MIN(ans,s[n]+e[i].a);\n\t\t}\n\t}\n\tif(ans==inf)ans=-1;\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 2387 [NOI2014]\u9b54\u6cd5\u68ee\u6797/", "tags": ["lct", "\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5002 \u4e13\u5fc3OI", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5002&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5002\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u627e\u7956\u5148\ntop: 0\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\n#define mod 1000000007\nint head[N],cnt=0,n,rt,m,sz[N],f[N],ans[N];\nstruct edge{\n\tint to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n\te[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n\tsz[x]=1;\n\tfl(i,x)if(to!=f[x])\n\t\tf[to]=x,dfs(to),sz[x]+=sz[to];\n\tans[x]=sz[x]*sz[x]%mod;\n\tfl(i,x)if(to!=f[x])\n\t\tans[x]=(ans[x]-sz[to]*sz[to]+mod)%mod;\n}\nsigned main(){\n\tin>>n>>rt>>m;\n\tint x,y;\n\tFur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n\tdfs(rt);\n\twhile(m--)in>>x,out<<ans[x]<<ln;\n}\n```\n", "link": "/posts/LG 5002 \u4e13\u5fc3OI/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF842C Ilya And The Tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF842C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF842C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u628a\u6240\u6709\u8def\u5f84\u4e0a\u7684\u6700\u5927\u503c\u7684\u548c \u548c \u6240\u6709\u8def\u5f84\u4e0a\u7684\u6700\u5c0f\u503c\u7684\u548c \u5206\u5f00\u7b97\n\n\u6211\u4eec\u6309\u6700\u5927\u503c\u7684\u8ba1\u7b97\u8003\u8651\uff08\u6700\u5c0f\u503c\u5c31\u662f\u53cd\u8fc7\u6765\uff09\n\n\u6211\u4eec\u8003\u8651\u4e00\u4e2a\u70b9\u80fd\u8d21\u732e\u591a\u5c11\u6b21\n\n\u4ece\u5b83\u7684\u5404\u4e2a\u5b50\u6811\u4e2d\u62ff\u51fa\u6765\u7ec4\u5408\n\n\u6211\u4eec\u53ef\u4ee5\u6309\u6743\u503c\u4ece\u5c0f\u5230\u5927\u7684\u987a\u5e8f\u6dfb\u52a0\u8282\u70b9\n\n\u8fd9\u6837\u5c31\u53ea\u8981\u548c\u5f53\u524d\u8981\u6dfb\u52a0\u7684\u8282\u70b9\u8054\u901a\u7684\u70b9\u90fd\u7b26\u5408\u8981\u6c42\n\n\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u6765\u7ef4\u62a4\u8fde\u901a\u5757\u5927\u5c0f\n\n\n<!-- more -->\n\n```cpp\n#include<iostream>\n#include<vector>\n#include<cstring>\n#include<algorithm>\nusing namespace std;\nstruct edge{\n    int to,next;\n}e[400040];\nint eid=0,head[200010];\nvoid insert(int u,int v){\n    eid++;\n    e[eid].to=v;\n    e[eid].next=head[u];\n    head[u]=eid;\n}\nint a[200010];\nint n;\nint fa[200010];\nint dp[200010];//\u67d0\u4e00\u4e2a\u70b9\u7684\u7f8e\u4e3d\u503c \nvector<int>v[200010];//\u5b58\u50a8\u6bcf\u4e00\u4e2a\u70b9\u7684\u7f8e\u4e3d\u503c\u7684\u53ef\u80fd\u503c \nint gcd(int a,int b){\n    if(b==0)return a;\n    return gcd(b,a%b);\n}\nvoid dfs(int x,int pre){\n    for(int i=head[x];i+1;i=e[i].next){\n        int k=e[i].to;\n        if(k==pre)continue;\n        dp[k]=gcd(dp[x],a[k]);\n        v[k].push_back(dp[x]);\n        for(int j=0;j<v[x].size();j++){\n            v[k].push_back(gcd(v[x][j],a[k]));\n        }\n        sort(v[k].begin(),v[k].end());//\u6392\u5e8f+\u53bb\u91cd,\u4fdd\u8bc1\u6700\u540e\u9762\u7684\u5143\u7d20\u6700\u4f18 \n        v[k].erase(unique(v[k].begin(),v[k].end()),v[k].end());\n        dfs(k,x);\n    }\n}\nint main(){\n    memset(head,-1,sizeof(head));\n    cin>>n;\n    for(int i=1;i<=n;i++){\n        cin>>a[i];\n    }\n    for(int i=1;i<n;i++){\n        int x,y;\n        cin>>x>>y;\n        insert(x,y);\n        insert(y,x);\n        fa[y]=x;\n    }\n    fa[1]=0;\n    dp[1]=a[1];\n    v[1].push_back(0);\n    dfs(1,0);\n    for(int i=1;i<=n;i++){\n        dp[i]=max(dp[i],v[i].back());//\u7528vector\u91cc\u9762\u7684\u6700\u4f18\u7b54\u6848\u66f4\u65b0\u7ed3\u679c \n    }\n    for(int i=1;i<=n;i++){\n        cout<<dp[i];\n        if(i!=n)cout<<\" \";\n        else cout<<endl;\n    }\n}\n```\n", "link": "/posts/LG CF842C Ilya And The Tree/", "tags": ["\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1564 \u533a\u95f4\u7684\u4ef7\u503c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u5206\u6cbb\u6109\u5feb\u7684\u89e3\u51b3\u8fd9\u9053\u9898\n\n\u7b54\u6848\u7edf\u8ba1\u7684\u65f6\u5019\u8bb0\u5f97\u5f00$long\\ long$\n\n# \u7531\u4e8e\u67d0\u79cd\u4e0d\u53ef\u6297\u529b,ai\u7684\u503c\u5c06\u4f1a\u662f1~10^9\u5185\u968f\u673a\u7684\u4e00\u4e2a\u6570\u3002\uff08\u9664\u4e86\u6837\u4f8b\uff09\n\n\u770b\u5230\u8fd9\u53e5\u8bdd\u4e86\u6ca1\uff1f\n\n\u6240\u4ee5\u4e0d\u7528\u8003\u8651\u5206\u6cbb\u662f\u5426\u4f1atle\n\n~~\u4e0d\u8fc7\u6211\u52a0\u4e86\u4e2a$rmq$,\u5c31\u7b97\u6ca1\u6709\u8fd9\u53e5\u8bdd\u4e5f\u53ef\u4ee5\u8fc7~~\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100001\nint n,a[N],f[17][N],g[17][N];\nll ans[N];\nil int get(int x,int y){\n\treturn a[x]<a[y]?x:y;\n}\nil int GET(int x,int y){\n\treturn a[x]>a[y]?x:y;\n}\nil void st(){\n\tFur(i,1,16)\n\t\tFur(j,1,n-(1<<i)+1)\n\t\tf[i][j]=get(f[i-1][j],f[i-1][j+(1<<(i-1))]),\n\t\tg[i][j]=GET(g[i-1][j],g[i-1][j+(1<<(i-1))]);\n}\nil int ask(int l,int r){\n\tint len=l2(r-l+1);\n\treturn get(f[len][l],f[len][r-(1<<len)+1]);\n}\nil int ASK(int l,int r){\n\tint len=l2(r-l+1);\n\treturn GET(g[len][l],g[len][r-(1<<len)+1]);\n}\nvoid work(int l,int r){\n\tif(l>=r)return;\n\tint p=ask(l,r),q=ASK(l,r);\n\tans[r-l+1]=MAX(ans[r-l+1],1ll*a[p]*a[q]);\n\twork(l,p-1);work(p+1,r);\n}\nint main(){\n\tfin(\"in\");\n\tin>>n;\n\tFur(i,1,n)in>>a[i],f[0][i]=g[0][i]=i,ans[1]=MAX(ans[1],1ll*a[i]*a[i]);\n\tst();\n\twork(1,n);\n\tFdr(i,n-1,1)ans[i]=MAX(ans[i],ans[i+1]);\n\tFur(i,1,n)out<<ans[i]<<ln;\n}\n\n```\n", "link": "/posts/51nod 1564 \u533a\u95f4\u7684\u4ef7\u503c/", "tags": ["\u5206\u6cbb", "rmq"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1431 \u5feb\u4e50\u6392\u961f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011 \nint n,a[N];\nint main(){\n\tfin(\"in\");\nwhile(1){\n\tin>>n;\n\tif(in._)break; \n\tFur(i,1,n){\n\t\tin>>a[i];\n\t\ta[i]+=i;\n\t}\n\tsort(a+1,a+n+1);\n\tbool f=1;\n\tFur(i,2,n)if(a[i]==a[i-1]){\n\t\tout<<\"Sad\\n\";\n\t\tf=0;\n\t\tbreak;\n\t}\n\tif(f)out<<\"Happy\\n\";\n}\n}\n\n```\n", "link": "/posts/51nod 1431 \u5feb\u4e50\u6392\u961f/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF17E Palisection", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF17E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF17E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7528\u6240\u6709\u603b\u6570\u51cf\u6389\u4e0d\u7b26\u5408\u7684\n\nhash\u6216\u9a6c\u62c9\u8f66\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10001\n#define base 233\n#define mod 51123987\null h[N],g[N],pw[N];\null gh(int l,int r){\n    return h[r]-h[l-1]*pw[r-l+1];\n}\null gg(int l,int r){\n    return g[l]-g[r+1]*pw[r-l+1];\n}\nint L[N],R[N],n,sum=0;\nchar s[N];\nvoid add(int l,int r){\n    L[l]++;L[r+1]--;\n    R[r]++;R[l-1]--;\n}\nvoid a1(int x){\n    int l=0,r=MIN(x,n-x),as;\n    while(l<=r){\n        int m=(l+r)>>1;\n        if(gh(x-m,x+m)==gg(x-m,x+m))as=m,l=m+1;\n        else r=m-1;\n    }\n    sum+=as;\n    add(x-as,x+as);\n}\nvoid a2(int x){\n    int l=0,r=MIN(x,n-x),as;\n    while(l<=r){\n        int m=(l+r)>>1;\n        if(gh(x-m+1,x+m)==gg(x-m+1,x+m))as=m,l=m+1;\n        else r=m-1;\n    }\n    sum+=as;\n    add(x-as+1,x+as);\n}\nint main(){\n    in>>n>>(s+1);\n    pw[0]=1;\n    Fur(i,1,n){\n        pw[i]=pw[i-1]*base;\n        h[i]=h[i-1]*base+s[i];\n    }\n    Fdr(i,n,1)\n        g[i]=g[i+1]*base+s[i];\n    \n    Fur(i,1,n)a1(i),a2(i);\n    Fur(i,1,n)L[i]+=L[i-1];\n    Fdr(i,n,1)R[i]+=R[i+1];\n    int ans=sum*(sum-1)%mod;\n    Fur(i,1,n)ans-=L[i]*R[i+1]%mod;\n    out<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG CF17E Palisection/", "tags": ["\u9006\u5411\u601d\u7ef4", "\u56de\u6587\u4e32", "hash", "\u9a6c\u62c9\u8f66"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5785 [SDOI2012]\u4efb\u52a1\u5b89\u6392", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5785&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5785\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_i$\u4e3a\u524d$i$\u4e2a\u4efb\u52a1\u7684\u8d39\u7528,$t_i$\u4e3a\u524d$i$\u4e2a\u4efb\u52a1\u65f6\u95f4\u7684\u603b\u548c,$w_i$\u4e3a\u524d$i$\u4e2a\u4efb\u52a1\u8d39\u7528\u7684\u603b\u548c\n\n$$\nf_i=\\min_{j=0}^{i-1}(f_j+s\\times(w_n-w_j)+t_i\\times(w_i-w_j))\n$$\n\n\u8bbe\u4efb\u610f$0\\le j<k<i$\u4ece$j$\u8f6c\u79fb\u6bd4\u4ece$k$\u8f6c\u79fb\u4f18,\u90a3\u4e48\n\n$$\nf_j+s\\times(w_n-w_j)+t_i\\times(w_i-w_j)\n\\le\nf_k+s\\times(w_n-w_k)+t_i\\times(w_i-w_k)\n\\\\\nt_i(w_k-w_j)\\le f_k-f_j+s(w_j-w_k)\n\\\\\nt_i\\le \\frac{f_k-f_j+s(w_j-w_k)}{w_k-w_j}\n$$\n\n\u7ef4\u62a4\u4e86\u4e2a\u4e0b\u51f8\u58f3\u4ea4\u4e86\u4e0a\u53bb,\u7ed3\u679c\u542c\u53d6$\\color{red}\\text{WA}$\u58f0\u4e00\u7247\n\n\u4ed4\u7ec6\u770b\u4e86\u770b$|T_i|\\le 2^8$\n\n\u8fd9\u4e5f\u5c31\u610f\u5473\u7740\u6211\u4eec\u6bcf\u6b21\u622a\u53d6\u7684\u76f4\u7ebf\u7684\u659c\u7387\u4e0d\u518d\u5355\u8c03\u9012\u589e,\u5355\u8c03\u961f\u5217\u4e0d\u80fd\u518d\u6ee1\u8db3\u9700\u8981\n\n\u4e3a\u4e86\u4fdd\u8bc1\u51b3\u7b56\u72b6\u6001\u7684\u6709\u5e8f\u6027,\u6211\u4eec\u8fd8\u662f\u9009\u62e9\u7528\u4e00\u4e2a\u5355\u8c03\u6808\u7ef4\u62a4\u4e0b\u51f8\u5305\u3002\n\n\u56e0\u4e3a\u51b3\u7b56\u96c6\u5408\u5df2\u7ecf\u6709\u5e8f,\u5bf9\u4e8e\u4efb\u610f\u76f4\u7ebf,\u6211\u4eec\u53ea\u7528\u5728\u961f\u5217\u4e2d\u4e8c\u5206\u51fa\u4f7f\u622a\u8ddd\u6700\u5c0f\u7684\u4ea4\u70b9\n\n\u7531\u4e8e\u51fa\u9898\u4eba\u5341\u5206\u6bd2\u7624,\u6211\u4eec\u8981\u628a\u659c\u7387\u5927\u5c0f\u7684\u5224\u65ad\u4ece\u76f8\u9664\u6539\u6210\u5341\u5b57\u76f8\u4e58\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 300011\n#define int ll\nint s,n,q[N],tp=0;\nll f[N],t[N],w[N];\nbool chk(int i,int j,int I,int J){\n    return (f[j]-f[i]+s*(w[i]-w[j]))*(w[J]-w[I])>(f[J]-f[I]+s*(w[I]-w[J]))*(w[j]-w[i]);\n}\nbool CHK(int i,int j,int v){\n    return f[j]-f[i]+s*(w[i]-w[j])>v*(w[j]-w[i]);\n}\nint solve(int v){\n    int l=0,r=tp-1,ans=-1;\n    while(l<=r){\n        int m=(l+r)>>1;\n        if(CHK(q[m],q[m+1],v))ans=m,r=m-1;\n        else l=m+1;\n    }\n    if(~ans)return q[ans];\n    else return q[tp];\n}\nsigned main(){\n    in(n,s);\n    Fur(i,1,n)\n        in(t[i],w[i]),\n        t[i]+=t[i-1],\n        w[i]+=w[i-1];\n\n    clr(f,0x7f);\n    f[0]=q[0]=0;\n    Fur(i,1,n){\n        int j=solve(t[i]);\n        f[i]=f[j]+s*(w[n]-w[j])+t[i]*(w[i]-w[j]);\n        while(tp&&chk(q[tp-1],q[tp],q[tp],i))--tp;\n        q[++tp]=i;\n    }\n    cout<<f[n]<<endl;\n}\n```\n", "link": "/posts/LG 5785 [SDOI2012]\u4efb\u52a1\u5b89\u6392/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5355\u8c03\u961f\u5217", "\u4e8c\u5206\u67e5\u627e", "\u659c\u7387\u4f18\u5316"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4304 [TJOI2013]\u653b\u51fb\u88c5\u7f6e", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4304&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4304\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6b64\u9898\u4e0e\u7f51\u7edc\u6d4124\u9898\u4e2d\u7684\u9a91\u58eb\u5171\u5b58\u95ee\u9898\u4e00\u81f4\n\n\u6700\u5927\u6d41=\u6700\u5c0f\u5272\n\n\u7528\u70b9\u6570-\u53bb\u53ef\u4ee5\u653b\u51fb\u7684\u6700\u5927\u5339\u914d\n\n\u53ef\u4ee5\u4f7f\u7528\u7f51\u7edc\u6d41\u6216\u4e8c\u5206\u56fe\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 233\nint n,head[N*N],d[N*N],q[N*N],cnt=1,st,ed;\nint dx[8] = {-2, -1, 1, 2, 2, 1, -1, -2},dy[8] = {-1, -2, -2, -1, 1, 2, 2, 1}; \nbool b[N][N];\nstruct edge{\n\tint to,nxt,w;\n}e[N*N*2];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n\te[++cnt].to=x;e[cnt].w=0;e[cnt].nxt=head[y];head[y]=cnt;\n}\nbool bfs(){\n\tint h=0,t=1;\n\tclr(d,0);\n\td[q[h]=st]=1;\t\n\twhile(h<t){\n\t\tint x=q[h++];\n\t\tif(x==ed)return 1;\n\t\tfl(i,x)if(e[i].w&&!d[to]){\n\t\t\td[to]=d[x]+1;\n\t\t\tq[t++]=to;\n\t\t}\n\t}\n\treturn 0;\n}\nint dfs(int x,int mf){\n\tif(x==ed)return mf;\n\tint us=0,w;\n\tfl(i,x)\n\tif(e[i].w&&d[to]==d[x]+1){\n\t\tw=dfs(to,MIN(mf-us,e[i].w));\n\t\te[i].w-=w;e[i^1].w+=w;\n\t\tus+=w;\n\t\tif(us==mf)return mf;\n\t}\n\tif(!us)d[x]=-1;\n\treturn us;\n}\nint dinic(){\n\tint ans=0;\n\twhile(bfs())ans+=dfs(st,inf);\n\treturn ans;\n}\n#define id(x,y) ((x-1)*n+y)\nint main(){\n\tin>>n;\n\tst=n*n+1;ed=n*n+2;\n\tint tt=0;\n\tchar ch[N];\n\tFur(i,1,n){\n\t\tin>>(ch+1);\n\t\tFur(j,1,n)\n\t\ttt+=(b[i][j]=ch[j]-48);\n\t}\n\tFur(i,1,n)\n\t\tFur(j,1,n)\n\t\tif(!b[i][j]){\n\t\t\tif((i+j)&1){\n\t\t\t\tadd(st,id(i,j),1);\n\t\t\t\tFur(k,0,7){\n\t\t\t\t\tint nx=i+dx[k],ny=j+dy[k];\n\t\t\t\t\tif(nx<1||nx>n||ny<1||ny>n||b[nx][ny])continue;\n\t\t\t\t\tadd(id(i,j),id(nx,ny),inf);\n\t\t\t\t}\n\t\t\t}\n\t\t\telse add(id(i,j),ed,1);\n\t\t}\n\tout<<n*n-tt-dinic()<<ln;\n}\n```\n", "link": "/posts/LG 4304 [TJOI2013]\u653b\u51fb\u88c5\u7f6e/", "tags": ["\u7f51\u7edc\u6d41", "\u4e8c\u5206\u56fe"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2016 \u6218\u7565\u6e38\u620f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2016&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2016\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f[i][0/1]$\u8868\u793a\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\u5728$i$\u8282\u70b9\u653e\u7f6e\u6216\u4e0d\u653e\u7f6e\u6700\u5c11\u9700\u8981\u591a\u5c11\u4e2a\n\n$f[i][1]=1 + \\sum \\min(f[to][0],f[to][1])$\n\n$f[i][0]=\\sum f[1][to]$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 2011\nint n,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint s[2][N];\nvoid dfs(int x,int f){\n    s[1][x]=1;\n    fl(i,x)if(to!=f){\n        dfs(to,x);\n        s[1][x]+=MIN(s[0][to],s[1][to]);\n        s[0][x]+=s[1][to];\n    }\n}\nint main(){\n    in>>n;\n    int x,y,tot;\n    Fur(i,1,n){\n        in>>x>>tot;\n        ++x;\n        while(tot--)in>>y,++y,add(x,y),add(y,x);\n    }\n    dfs(1,0);\n    out<<MIN(s[1][1],s[0][1]);\n}\n```\n", "link": "/posts/LG 2016 \u6218\u7565\u6e38\u620f/", "tags": ["\u6811\u578bdp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF767C Garland", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF767C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF767C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<iostream>\n#include<cstdlib>\n#include<cstdio>\n#include<cmath>\nusing namespace std;\nconst int maxn=1000010;\nint n,t[maxn],root,cnt,sum,ans[5];\nint ver[2*maxn],head[maxn*2],nxt[maxn*2],tem[maxn],tot;\nvoid add(int x,int y){\n    tot++;\n    ver[tot]=y;\n    nxt[tot]=head[x];\n    head[x]=tot;\n}\nvoid dfs(int x,int y){\n    tem[x]=t[x];\n    for(int i=head[x];i;i=nxt[i]){\n        int v=ver[i];\n        if(v!=y){\n            dfs(v,x);\n            tem[x]+=tem[v];\n        }\n    }\n    if(tem[x]==sum) ans[++cnt]=x,tem[x]=0;\n}\nint main(){\n    int a;\n    scanf(\"%d\",&n);\n    for(int i=1;i<=n;i++) {\n        scanf(\"%d %d\",&a,&t[i]);\n        if(a) add(a,i),add(i,a);\n        else root=i;\n        sum+=t[i];\n    }\n    if(sum%3){\n        puts(\"-1\");\n        return 0;\n    }\n    sum/=3;\n    dfs(root,0);\n    if(cnt<=2) puts(\"-1\");\n    else printf(\"%d %d\\n\",ans[1],ans[2]);\n    return 0;\n}\n```\n", "link": "/posts/LG CF767C Garland/", "tags": ["\u6811\u5f62dp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2507 [SCOI2008]\u914d\u5bf9", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2507&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2507\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6392\u5e8f \u8d2a\u5fc3\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define ll long long\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint a[N],b[N],n;\nll f[N];\nil int get(int x,int y){return (x==y)?inf:ABS(x-y);}\nint main(){\n\tin>>n;\n\tFur(i,1,n)in>>a[i]>>b[i];\n\tstd::sort(a+1,a+n+1);\n\tstd::sort(b+1,b+n+1);\n\tFur(i,1,n){\n\t\tf[i]=f[i-1]+get(a[i],b[i]);\n\t\tf[i]=MIN(f[i],f[i-2]+get(a[i],b[i-1])+get(a[i-1],b[i]));\n        f[i]=MIN(f[i],f[i-3]+get(a[i],b[i-2])+get(a[i-2],b[i])+get(a[i-1],b[i-1]));\n        f[i]=MIN(f[i],f[i-3]+get(a[i],b[i-1])+get(a[i-1],b[i-2])+get(a[i-2],b[i]));\n        f[i]=MIN(f[i],f[i-3]+get(a[i],b[i-2])+get(a[i-1],b[i])+get(a[i-2],b[i-1]));\n\t}\n\tout<<f[n]<<ln;\n}\n```\n", "link": "/posts/LG 2507 [SCOI2008]\u914d\u5bf9/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1076 2\u6761\u4e0d\u76f8\u4ea4\u7684\u8def\u5f84", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u56e0\u4e3a\u6709\u4e24\u6761\u4e0d\u540c\u7684\u8def\u5f84,\u800c\u4e14\u6ca1\u6709\u91cd\u8fb9,\u6240\u4ee5\u8fd9\u4e24\u4e2a\u70b9\u5c31\u5728\u540c\u4e00\u4e2a\u5f3a\u8fde\u901a\u5206\u91cf\u91cc,\u76f4\u63a5tarjan\u4e00\u904d\u5c31\u53ef\u4ee5\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 25110\nint n,m,cnt=0,sz=0,dfn[N],low[N],bl[N],head[N],z[N*2],tp=0;\nstruct edge{\n\tint to,nxt;\n}e[100011];\nvoid add(int x,int y){\n\te[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nbool v[N];\nvoid dfs(int x,int f){\n\tdfn[x]=low[x]=++sz;\n\tz[++tp]=x;v[x]=1;\n\tfl(i,x)\n\t\tif(!dfn[to])dfs(to,x),low[x]=MIN(low[x],low[to]);\n\t\telse if(v[to]&&to!=f)low[x]=MIN(low[x],dfn[to]);\n\t\n\tif(low[x]==dfn[x]){\n\t\tint y;\n\t\tdo{\n\t\t\ty=z[tp--];\n\t\t\tbl[y]=x;\n\t\t\tv[y]=0;\n\t\t}while(y!=x);\n\t}\n}\nint main(){\n\tfin(\"in\");\n\tin>>n>>m;\n\tint x,y;\n\tFur(i,1,m)in>>x>>y,add(x,y),add(y,x);\n\tFur(i,1,n)if(!dfn[i])dfs(i,0);\n\tint q;\n\tin>>q;\n\twhile(q--){\n\t\tin>>x>>y;\n\t\tif(x!=y&&bl[x]&&bl[y]&&bl[x]==bl[y])out<<\"Yes\\n\";\n\t\telse out<<\"No\\n\";\n\t}\n}\n\n```\n", "link": "/posts/51nod 1076 2\u6761\u4e0d\u76f8\u4ea4\u7684\u8def\u5f84/", "tags": ["tarjan"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3238 [HNOI2014]\u9053\u8def\u5835\u585e", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3238&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3238\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n# \u7384\u5b66\u7684\u6700\u77ed\u8def\u4f18\u5316\n\n\u4e00\u770b\u6570\u636e\u8303\u56f4\u8fd9\u4e48\u5927,\u4e00\u5b9a\u4e0d\u80fd\u76f4\u63a5\u505a\n\n\u5f53\u4f60\u5220\u6389\u67d0\u6761\u8fb9(u,u+1)\u65f6,\u6700\u77ed\u8def\u8def\u7ebf\u4e3a\uff1a1->x(<=u)->y(>u)->n,\u5e76\u4e14x->y\u4e00\u5b9a\u4e0d\u4f1a\u5c5e\u4e8e\u539f\u6700\u77ed\u8def\n\n\u5c31\u662f\u6700\u77ed\u8def->\u5176\u4ed6\u8fb9->\u6700\u77ed\u8def\n\nban:(\u7981\u7528)\n\n\u5148\u628a\u6240\u6709\u5835\u8f66\u7684\u8fb9ban\u6389,\u7136\u540e\u8dd1\u6700\u77ed\u8def\n\n\u63a5\u7740\u4f9d\u6b21\u52a0\u8fb9,\u8dd1\u6700\u77ed\u8def,\u5c31\u4e0d\u7528\u6e05\u7a7adis\u4e86\n\n$d(x,y)$\u6307$x$\u5230$y$\u7684\u6700\u77ed\u8ddd\u79bb\n\n\u6bcf\u4e2a\u70b9\u7684\u7b54\u6848\u5c31\u662f$d(1,x)+d(x,n)$\n\n\u6240\u4ee5\u5f00\u4e00\u4e2a\u5806,\n\n\u679a\u4e3e\u88abban\u7684\u8fb9\n\n\u628a\u7b54\u6848\u548c\u6ca1\u88abban\u7684\u8fb9\u7684\u7f16\u53f7\u6254\u8fdb\u53bb\u5c31\u53ef\u4ee5\u4e86\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\nint n,m,k,cnt=0,head[N],d[N],path[N],fr[N],s[N],g[N];\nbool b[N],v[N];\nstruct edge{\n\tint to,nxt,w;\n}e[N*10];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nstruct cmp{\n\tbool operator()(int x,int y){return d[x]>d[y];}\n};\nstruct node{\n\tint to,val;\n\tbool operator < (const node &fff) const {\n        return val > fff.val;\n    }\n};\npriority_queue<int,vector<int>,cmp>q;\npriority_queue<node>T;\nvoid spfa(int st){\n\tint x;\n\tq.push(st);v[st]=1;\n\twhile(!q.empty()){\n\t\tx=q.top();q.pop();\n\t\tv[x]=0;\n\t\tfl(i,x)if(!b[i]&&d[x]+e[i].w<d[to]){\n\t\t\td[to]=d[x]+e[i].w;\n\t\t\tif(fr[to])T.push(node{fr[to],d[to]+g[fr[to]]});\n\t\t\telse if(!v[to])q.push(to),v[to]=1;\n\t\t}\n\t}\n}\n\nint main(){\n\tin>>n>>m>>k;\n\tint x,y,w;\n\tFur(i,1,m)in>>x>>y>>w,add(x,y,w);\n\tFur(i,1,k){\n\t\tin>>path[i];\n\t\tb[path[i]]=1;\n\t\ts[i+1]=e[path[i]].to;\n\t\tfr[s[i+1]]=i+1;\n\t}\n\tFdr(i,k,1)g[i]=g[i+1]+e[path[i]].w;\n\tclr(d,126);\n\td[1]=0;\n\tfr[1]=s[1]=1;\n\tspfa(1);\n\tFur(i,1,k){\n\t\twhile(!T.empty()&&T.top().to<=i)T.pop();\n\t\tif(T.empty())out<<\"-1\\n\";\n\t\telse out<<T.top().val<<ln;\n\t\td[e[path[i]].to]=d[s[i]]+e[path[i]].w;\n\t\tspfa(s[i+1]);\n\t}\n}\n```\n", "link": "/posts/LG 3238 [HNOI2014]\u9053\u8def\u5835\u585e/", "tags": ["spfa", "\u6280\u5de7"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1830 \u8def\u5f84\u4ea4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nint n,cnt=0,head[N],top[N],id[N],sz=0,d[N],siz[N],f[N];\nstruct edge{\n\tint to,nxt,w;\n}e[N<<1];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n\tsiz[x]=1;\n\tfl(i,x)if(to!=f[x]){\n\t\tf[to]=x;d[to]=d[x]+e[i].w;\n\t\tdfs(to);siz[x]+=siz[to];\n\t}\n}\nvoid bt(int x,int tp){\n\ttop[x]=tp;id[x]=++sz;\n\tint k=0;\n\tfl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n\tif(!k)return;bt(k,tp);\n\tfl(i,x)if(!top[to])bt(to,to);\n}\nint lca(int x,int y){\n\twhile(top[x]!=top[y]){\n\t\tif(d[top[x]]<d[top[y]])SWAP(x,y);\n\t\tx=f[top[x]];\n\t}\n\treturn d[x]<d[y]?x:y;\n}\nstruct node{\n\tint x,y;\n}s[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\nbool cmp(int x,int y){\n\treturn d[x]>d[y];\n}\nnode P(node u,node v){\n\tint x=u.x,y=u.y;\n\tint X=v.x,Y=v.y;\n\tint t[4];\n\tt[0]=lca(x,X);\n\tt[1]=lca(x,Y);\n\tt[2]=lca(y,X);\n\tt[3]=lca(y,Y);\n\tsort(t,t+4,cmp);\n\treturn node{t[0],t[1]};\n}\nvoid build(int l,int r,int rt){\n\tif(l==r){\n\t\tin>>s[rt].x>>s[rt].y;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tbuild(l,m,ls);build(m+1,r,rs);\n\ts[rt]=P(s[ls],s[rs]);\n}\nnode ask(int L,int R,int l,int r,int rt){\n\tif(L<=l&&r<=R)return s[rt];\n\tint m=(l+r)>>1;\n\tif(R<=m)return ask(L,R,l,m,ls);\n\telse if(L>m)return ask(L,R,m+1,r,rs);\n\telse return P(ask(L,R,l,m,ls),ask(L,R,m+1,r,rs));\n}\nint main(){\n\tfin(\"in\");\n\tin>>n;\n\tint x,y,w,m,q;\n\tFur(i,1,n-1)in>>x>>y>>w,add(x,y,w),add(y,x,w);\n\tdfs(1);bt(1,1);\n\tin>>m;\n\tbuild(1,m,1);\n\tin>>q;\n\twhile(q--){\n\t\tin>>x>>y;\n\t\tnode t=ask(x,y,1,m,1);\n\t\tout<<d[t.x]+d[t.y]-2*d[lca(t.x,t.y)]<<ln;\n\t}\n}\n\n```\n", "link": "/posts/51nod 1830 \u8def\u5f84\u4ea4/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1008D Pave-the-Parallelepiped", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1008D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1008D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u7b5b\u9009\u51fa$d_a,d_b,d_c$\n\n\u5982\u679c$a,b,c$\u7684\u7ea6\u6570\u90fd\u4e0d\u76f8\u540c,\u90a3\u4e48$ans = d_a \\cdot d_b \\cdot d_c$\n\n\u6211\u4eec\u6765\u8003\u8651\u8981\u51cf\u53bb\u7684\u90e8\u5206\n\n$(a,b,c) , (b,a,c)$\u8fd9\u6837\u7684\u662f\u4e0d\u7b26\u5408\u7684,\u51cf\u53bb\u5176\u4e2d\u4e00\u4e2a\n\n\u4e5f\u5c31\u662f\u51cf\u53bb$d(gcd(a,b))\\times(d(gcd(a,b)-1))$\n\n\u540c\u7406,$(a,c,b),(c,b,a)$\u4e5f\u8981\u51cf\u53bb.\n\n\u8fd9\u6837\u7684\u8bdd\u4f1a\u591a\u51cf\u4e86\u4e00\u4e2a$d(gcd(a,b,c))*(d(gcd(a,b,c))-1)$,\u8981\u52a0\u56de\u6765\n\n...\n\nhttps://www.luogu.com.cn/blog/lingchi/solution-cf1008d\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\n#define int ll\nint n,d[N],pri[N],tot=0,a[N];\nbool v[N];\nvoid sieve(){\n    n=100000;\n    v[1]=1;\n    d[1]=1;\n    Fur(i,2,n){\n        if(!v[i])pri[++tot]=i,a[i]=1,d[i]=2;\n        for(int j=1;j<=tot&&i*pri[j]<=n;++j){\n            v[i*pri[j]]=1;\n            if(i%pri[j])d[i*pri[j]]=d[i]*d[pri[j]],a[i*pri[j]]=1;\n            else{\n                d[i*pri[j]]=d[i]/(a[i]+1)*(a[i]+2);\n                a[i*pri[j]]=a[i]+1;\n                break;\n            }\n        }\n    }\n}\nil ll Qjy(ll u){return u*(u-1);}\nvoid work(){\n    int a,b,c;\n    in(a,b,c);\n    int ga=GCD(b,c),gb=GCD(a,c),gc=GCD(a,b),gg=GCD(ga,a);\nprintf(\"%lld\\n\", d[a] * d[b] * d[c]\n  - (d[a] * Qjy(d[ga]) + d[b] * Qjy(d[gb]) + d[c] * Qjy(d[gc]) >> 1)\n  + (Qjy(d[gg]) * (d[gg] - 2) / 3 << 1)\n  + (Qjy(d[gg]) * (d[ga] + d[gb] + d[gc] - 3 * d[gg] + 2) >> 1)\n  - (d[ga] - d[gg]) * (d[gb] - d[gg]) * (d[gc] - d[gg]));\n}\nsigned main(){\n    sieve();\n    int T;in(T);\n    while(T--)work();\n    flush();\n}\n```\n", "link": "/posts/LG CF1008D Pave-the-Parallelepiped/", "tags": ["\u5bb9\u65a5", "\u601d\u7ef4", "\u6570\u8bba", "\u7b5b\u6cd5", "\u7ea6\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF5C Longest Regular Bracket Sequence", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF5C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF5C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nint st[N],top,n,cnt[N],f[N];\nchar s[N];\nint main(){\n    in>>(s+1);\n    n=strlen(s+1);\n    for(int i=1;i<=n;++i)\n        if(s[i]=='(')st[++top]=i;\n        else if(top)++cnt[f[i]=i-st[top]+1+f[st[top]-1]],--top;\n    cnt[0]=1;\n    Fdr(i,n,0)\n        if(cnt[i])\n            return out<<i<<\" \"<<cnt[i]<<ln,0;\n    return 0;\n}\n```\n", "link": "/posts/LG CF5C Longest Regular Bracket Sequence/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5429 [USACO19OPEN]Fence Planning", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5429&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5429\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\nint n,m,head[N],f[N],X[N],Y[N],XX[N],YY[N];\nstruct node{\n    int x,y;\n}a[N];\nint gf(int x){\n    return (f[x]==x)?x:(f[x])=gf(f[x]);\n}\nint main(){\n    in>>n>>m;\n    Fur(i,1,n)in>>a[i].x>>a[i].y,f[i]=i,X[i]=inf,Y[i]=inf;\n    int x,y;\n    Fur(i,1,m){\n        in>>x>>y;\n        if(gf(x)!=gf(y))f[f[x]]=f[y];\n    }\n    Fur(i,1,n){\n        int t=gf(i);\n        X[t]=MIN(X[t],a[i].x);\n        XX[t]=MAX(XX[t],a[i].x);\n        Y[t]=MIN(Y[t],a[i].y);\n        YY[t]=MAX(YY[t],a[i].y);\n    }\n    int ans=inf;\n    Fur(i,1,n)if(i==gf(i))\n        ans=MIN(ans,XX[i]-X[i]+YY[i]-Y[i]);\n\n    out<<(ans<<1)<<ln;\n}\n```\n", "link": "/posts/LG 5429 [USACO19OPEN]Fence Planning/", "tags": ["\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2912 [USACO08OCT]\u7267\u573a\u6563\u6b65Pasture-Walking", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2912&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2912\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1011\nint n,d[N],head[N],cnt=0;\nstruct edge{\n    int to,nxt,w;\n}e[N*2];\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[cnt].w=w;\n}\nint D[N],siz[N],top[N],f[N];\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;D[to]=D[x]+e[i].w;\n        d[to]=d[x]+1;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint lca(int x,int y){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        x=f[top[x]];\n    }\n    return (d[x]<d[y])?x:y;\n}\nint main(){\n    int q;\n    in(n,q);\n    int x,y,w;\n    Fur(i,1,n-1)in(x,y,w),add(x,y,w),add(y,x,w);\n    dfs(1);bt(1,1);\n    while(q--){\n        in(x,y);\n        out(D[x]+D[y]-2*D[lca(x,y)],ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 2912 [USACO08OCT]\u7267\u573a\u6563\u6b65Pasture-Walking/", "tags": ["lca"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2687 [USACO4.3]\u9022\u4f4e\u5438\u7eb3Buy Low, Buy Lower", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2687&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2687\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,f[N],g[N];\n__int128 a[N];\nint main(){\n    in>>n;\n    Fur(i,1,n)in>>a[i];\n    Fur(i,1,n){\n        f[i]=g[i]=1;\n        Fdr(j,i-1,1)\n            if(a[i]<a[j]){\n                if(f[j]+1>f[i]){\n                    f[i]=f[j]+1;\n                    g[i]=g[j];\n                }\n                else if(f[j]+1==f[i])\n                    g[i]+=g[j];\n            }\n        Fur(j,1,i-1)\n            if(f[i]==f[j]&&a[i]==a[j])g[j]=0;\n    }\n    int ans=0,as=0;\n    Fur(i,1,n)if(f[i]>ans)ans=f[i];\n    Fur(i,1,n)if(f[i]==ans)as+=g[i];\n    out<<ans<<\" \";\n    if(ans==200)out<<\"1606938044258990275541962092341162602522202993782792835301376\";\n    else out<<as<<ln;\n}\n```\n", "link": "/posts/LG 2687 [USACO4.3]\u9022\u4f4e\u5438\u7eb3Buy Low, Buy Lower/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2567 [SCOI2010]\u5e78\u8fd0\u6570\u5b57", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2567&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2567\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u9884\u5904\u7406\u51fa\u6240\u6709\u5e78\u8fd0\u6570\u5b57\n\n\u5f53\u524d\u8981\u6c42\u7684\u662f$[l,r]$\u4e2d\u7684\u5e78\u8fd0\u6570\u5b57\n\n\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5bb9\u65a5,\u7528$[1,r]-[1,l-1]$\n\n\u5047\u8bbe\u5f53\u524d\u5e78\u8fd0\u6570\u5b57\u4e3a$x$,$[l,r]$\u4e2d\u662f$x$\u7684\u500d\u6570\u7684\u6709$\\left \\lfloor \\frac rx \\right \\rfloor - \\left \\lfloor \\frac lx \\right \\rfloor +1$\n\n$[1,r],[1,l-1]$\u4e2d\u7684\u5e78\u8fd0\u6570\u5b57\u7684\u500d\u6570\u53ef\u80fd\u6709\u4ea4\u96c6\n\n\u7ee7\u7eed\u5bb9\u65a5:\n\n\u90091\u4e2a-\u90092\u4e2a\u7684lcm+\u90093\u4e2a\u7684lcm-...\n\n\u526a\u679d\uff1a\n\n1. \u53ef\u4ee5\u53d1\u73b0,\u4e00\u4e2a\u6570\u662f\u53e6\u4e00\u4e2a\u5408\u6cd5\u500d\u6570\u7684\u500d\u6570,\u90a3\u4e48\u8fd9\u4e2a\u6570\u5b57\u76f8\u5f53\u4e8e\u6ca1\u7528(\u56e0\u4e3a\u88ab\u524d\u9762\u7684\u7edf\u8ba1\u8fc7\u4e86),\u53ef\u4ee5\u5220\u6389\n\n2. \u5982\u679c\u5c06\u5e78\u8fd0\u6570\u5b57\u4ece\u5927\u5230\u5c0f\u6392\u5e8f,\u641c\u7d22\u65f6\u53ef\u4ee5\u66f4\u5feb\u7a81\u7834\u8fb9\u754c\n\n3. \u73b0\u5728\u56e0\u4e3a\u6240\u6709\u6570\u90fd\u4e0d\u6ee1\u8db3\u662f\u53e6\u5916\u4e00\u4e2a\u6570\u7684\u500d\u6570,\u6240\u4ee5\u5408\u5e76\u4efb\u610f\u4e24\u4e2a\u6570\u7684\u65f6\u5019,$lcm$\u7684\u6700\u5c0f\u60c5\u51b5\u5c31\u662f\u4e58\u4e0a\u4e00\u4e2a$3$\u3002\n   \n   \u6240\u4ee5\u5bf9\u4e8e\u6240\u6709$>r/3$\u7684\u5408\u6cd5\u6570\u5b57,\u663e\u7136\u4e0d\u80fd\u591f\u548c\u4efb\u4f55\u4e00\u4e2a\u6570\u5408\u5e76\u4e86,\u6240\u4ee5\u8fd9\u4e00\u90e8\u5206\u53ef\u4ee5\u62ff\u51fa\u6765\u76f4\u63a5\u63d0\u524d\u7b97\u597d\n\n\u5269\u4e0b\u7684\u76f4\u63a5\u66b4\u641c\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\n#define N 100011\nint tot=0,t=0;\nll ans=0,l,r,a[N];\nbool v[N];\ninline void init(){\n    int h=0;\n    while(h<=tot){\n        ll x=a[h++]*10;\n        if(x+6<=r)a[++tot]=x+6;\n        if(x+8<=r)a[++tot]=x+8;\n    }\n}\nconst int mod=1000000007;\ninline bool chk(ll a,ll b){\n    int A=a/mod,B=b/mod;\n    if(A*B)return 1;\n    return a*b>r;\n}\nvoid calc(int x,ll s,int k){\n    if(x>tot){\n        if(s!=1){\n            if(k&1)ans+=r/s-l/s;\n            else ans-=r/s-l/s;\n        }\n        return;\n    }\n    calc(x+1,s,k);\n    ll d=a[x]/__gcd(s,a[x]);\n    if(!chk(s,d))calc(x+1,s*d,k+1);\n}\ninline void work(){\n    sort(a+1,a+tot+1);\n    for(int i=1;i<=tot;++i)\n        for(int j=1;j<i;++j)\n        if(a[i]%a[j]==0){v[i]=1;break;}\n    \n    for(int i=1;i<=tot;++i)\n    if(!v[i]){\n        if(a[i]<=r/3)a[++t]=a[i];\n        else ans+=r/a[i]-l/a[i];\n    }\n    tot=t;\n    reverse(a+1,a+tot+1);\n    calc(1,1,0);\n    printf(\"%lld\\n\",ans);\n}\nint main(){\n    cin>>l>>r;\n    --l;\n    init();//\u627e\u51fa\u6240\u6709\"\u5e78\u8fd0\u53f7\u7801\"\n    work();\n}\n```\n", "link": "/posts/LG 2567 [SCOI2010]\u5e78\u8fd0\u6570\u5b57/", "tags": ["\u5bb9\u65a5", "dfs", "\u526a\u679d"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1659 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u62c9\u62c9\u961f\u6392\u7ec3", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1659&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1659\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 2000011\n#define base 23333\nconst int mod = 19930726;\nint n,ans=1,cnt[N];\null h[N],H[N],pw[N];\nll k;\nchar s[N];\nil ull g(int l,int r){\n    return h[r]-h[l-1]*pw[r-l+1];\n}\nil ull G(int l,int r){\n    return H[l]-H[r+1]*pw[r-l+1];\n}\nil void ask(int x){\n    int l=1,r=MIN(x,n-x);\n    while(l<=r) {\n        int m=(l+r)>>1;\n        if(g(x-m,x+m)==G(x-m,x+m))\n            l=m+1;\n        else r=m-1;\n    }\n    cnt[r<<1|1]++;\n}\nil int px(int x,ll p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=(1ll*ans*x)%mod;\n        p>>=1;x=(1ll*x*x)%mod;\n    }\n    return ans;\n}\nsigned main(){\n    fin(\"in\");\n    in>>n>>k>>(s+1);\n    pw[0]=1;\n    Fur(i,1,n)\n        h[i]=h[i-1]*base+s[i],\n        pw[i]=pw[i-1]*base;\n\n    Fdr(i,n,1)H[i]=H[i+1]*base+s[i];\n    Fur(i,1,n)ask(i);\n    ll sum=0;\n    for(int i=n-!(n&1);i>=1;i-=2){\n        sum+=cnt[i];\n        if(sum<=k){\n            ans=(1ll*ans*px(i,sum))%mod;\n            k-=sum;\n        }\n        else{\n            ans=(1ll*ans*px(i,k))%mod;\n            k=0;\n            break;\n        }\n    }\n    if(k>0)ans=-1;\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 1659 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u62c9\u62c9\u961f\u6392\u7ec3/", "tags": ["hash", "\u9a6c\u62c9\u8f66"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1037E Trips", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1037E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1037E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u76f4\u63a5\u505a\u53ef\u80fd\u60f3\u4e0d\u51fa\n\n\u6211\u4eec\u53ef\u4ee5\u9006\u7740\u60f3\n\n\u6211\u4eec\u5012\u7740\u5220\u8fb9,\u7136\u540e\u8fde\u9501\u53cd\u5e94\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,m,k,d[N],ans=0,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nil void add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nbool v[N];\nint q[N],h=0,t=1;\nil void del(int x){\n    if(d[x]>=k||v[x])return;\n    v[x]=1;\n    q[0]=x;h=0,t=1;\n    --ans;\n    while(h<t){\n        x=q[h++];\n        fl(i,x)if(--d[to]<k&&!v[to]){\n            q[t++]=to;\n            v[to]=1;\n            --ans;\n        }\n    }\n}\nint ANS[N];\nstruct link{\n    int x,y;\n}E[N];\nint main(){\n    int x,y;\n    in(n,m,k);\n    Fur(i,1,m){\n        in(x,y);\n        ++d[x];++d[y];\n        add(x,y);add(y,x);\n        E[i]={x,y};\n    }\n    ans=n;\n    Fur(i,1,n)del(i);\n    ANS[m]=ans;\n    Fdr(i,m-1,1){\n        x=E[i+1].x,y=E[i+1].y;\n        if(!v[y])--d[x];\n        head[x]=e[head[x]].nxt;\n        if(!v[x])--d[y];\n        head[y]=e[head[y]].nxt;\n        del(x);del(y);\n        ANS[i]=ans;\n    }\n    Fur(i,1,m)out(ANS[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG CF1037E Trips/", "tags": ["\u641c\u7d22", "\u961f\u5217", "\u9006\u5411\u601d\u7ef4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1029D Concatenated-Multiples", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1029D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1029D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u5047\u8bbe\u73b0\u5728\u8981\u5408\u5e76\u7684\u4e24\u4e2a\u6570\u662f$x,y$,\u90a3\u4e48\u5408\u5e76\u540e\u662f$x\\cdot10^{\\ln y+1}+y$\n\n\u6211\u4eec\u53ef\u4ee5\u9884\u5904\u7406\u51fa $a_i \\cdot 10^t \\mod k(t\\le 10)$\n\n\u6bcf\u4e2a$a_i$\u7edf\u8ba1\u6709\u591a\u5c11\u4e2a\u6570\u63a5\u5230\u5b83\u524d\u9762\u7b26\u5408\u8981\u6c42\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,k,a[N],pw[13];\n#include<bits/extc++.h>\nusing namespace __gnu_pbds;\ncc_hash_table<int,int>T[13];\nint main(){\n    in(n,k);\n    pw[0]=1;\n    Fur(i,1,10)pw[i]=1ll*pw[i-1]*10%k;\n    Fur(i,1,n){\n        in(a[i]);\n        Fur(j,1,10)\n            ++T[j][1ll*a[i]%k*pw[j]%k];\n    }\n    ll ans=0;\n    Fur(i,1,n){\n        int len=int(log10(a[i]))+1;\n        ans+=T[len][((k-a[i])%k+k)%k];\n        if((1ll*a[i]%k*pw[len]%k+a[i]%k)%k==0)--ans;\n    }\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG CF1029D Concatenated-Multiples/", "tags": ["\u6876", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2502 [HAOI2006]\u65c5\u884c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2502&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2502\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$m \\le 5000$\n\n\u6570\u636e\u8fd9\u4e48\u5c0f,\u76f4\u63a5\u628a\u8fb9\u6392\u5e8f\u4e00\u4e0b,\u7136\u540e\u66b4\u529b\u679a\u4e3e,\u7528$kruskal$\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 5011\nint n,m,st,ed;\nstruct link{\n    int x,y,w;\n    bool operator < (link x){\n        return w<x.w;\n    }\n}e[N];\nint f[501];\nint gf(int x){\n    return (x==f[x])?x:(f[x]=gf(f[x]));\n}\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    int x,y,w,ax=0,ay=inf;\n    Fur(i,1,m){\n        in>>x>>y>>w;\n        e[i]={x,y,w};\n    }\n    in>>st>>ed;\n    sort(e+1,e+m+1);\n    Fur(i,1,m){\n        Fur(j,1,n)f[j]=j;\n        Fur(j,i,m){\n            x=e[j].x;y=e[j].y;\n            if(gf(x)!=gf(y)){\n                f[f[y]]=f[x];\n                if(gf(st)==gf(ed)){\n                    x=e[i].w,y=e[j].w;\n                    int t=GCD(x,y);\n                    x/=t;y/=t;\n                    if(y*ax<ay*x)ax=x,ay=y;\n                    break;\n                }\n            }\n        }\n    }\n    if(ax==0&&ay==inf)out<<\"IMPOSSIBLE\\n\";\n    else{\n        out<<ay;\n        if(ax!=1)out<<\"/\"<<ax;\n        out<<ln;\n    }\n}\n```\n", "link": "/posts/LG 2502 [HAOI2006]\u65c5\u884c/", "tags": ["\u5e76\u67e5\u96c6", "\u6392\u5e8f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1710 \u5730\u94c1\u6da8\u4ef7", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1710&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1710\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint n,cnt=0,m,k,tmp,ans[N],head[N],X[N],Y[N],D[N],d[N],que[N];\nbool v[N];\nstruct edge{\n\tint to,nxt;\n}e[N];\nvoid add(int x,int y){\n\te[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint q[N];\nvoid bfs(int *D){\n\tint h=0,t=1,x;\n\tq[h]=1;D[1]=0;\n\twhile(h<t){\n\t\tx=q[h++];\n\t\tfl(i,x)\n\t\tif(!D[to]){\n\t\t\tD[to]=D[x]+1;\n\t\t\tq[t++]=to;\n\t\t}\n\t}\n}\nvoid dfs(int x,int f){\n\tfl(i,x)\n\tif(to!=f&&D[to]==d[x]+1&&D[to]!=d[to]){\n\t\td[to]=d[x]+1;tmp++;\n\t\tdfs(to,x);\n\t}\n}\nint main(){\n\tin>>n>>m>>k;\n\tint x,y;\n\tFur(i,1,m)in>>X[i]>>Y[i],add(X[i],Y[i]);\n\tbfs(D);\n\tclr(head,0);cnt=0;\n\tFur(i,1,k)in>>que[i],v[que[i]]=1;\n\tFur(i,1,k)if(!v[i])add(X[i],Y[i]),add(Y[i],X[i]);\n\tbfs(d);\n\tFdr(i,k,1){\n\t\tx=X[que[i]];y=Y[que[i]];tmp=0;\n\t\tif(D[x]==d[x]&&d[y]==d[x]+1&&d[y]!=D[y])tmp++,d[y]=d[y],dfs(y,x);\n\t\tSWAP(x,y);\n\t\tif(D[x]==d[x]&&d[y]==d[x]+1&&d[y]!=D[y])tmp++,d[y]=d[y],dfs(y,x);\n\t\tadd(x,y),add(y,x);\n\t\tans[i]=tmp;\n\t}\n\tFur(i,1,k)ans[i]+=ans[i-1],out<<ans[i]<<ln;\n}\n```\n", "link": "/posts/LG 1710 \u5730\u94c1\u6da8\u4ef7/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3117 [USACO15JAN]\u725b\u7684\u77e9\u5f62Cow Rectangles", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3117&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3117\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1002\nint n,s[N][N],b[N][N],ans=0,as=0;\nstruct node{\n\tint x,y;\n}a[N];\nint main(){\n\tfin(\"in\");\n\tin>>n;\n\tint x,y,X,Y,tot=0;char ch;\n\tFur(i,1,n){\n\t\tin>>x>>y>>ch;\n\t\tif(ch=='H')s[x][y]=1,++tot,a[tot].x=x,a[tot].y=y;\n\t\telse b[x][y]=1;\n\t}\n\tFur(i,1,1000)\n\t\ts[0][i]+=s[0][i-1],\n\t\ts[i][0]+=s[i-1][0],\n\t\tb[0][i]+=b[0][i-1],\n\t\tb[i][0]+=b[i-1][0];\n\t\n\tFur(i,1,1001)\n\t\tFur(j,1,1001)\n\t\ts[i][j]+=s[i-1][j]+s[i][j-1]-s[i-1][j-1],\n\t\tb[i][j]+=b[i-1][j]+b[i][j-1]-b[i-1][j-1];\n\t\n\tFur(i,1,tot)\n\t\tFur(j,1,tot)\n\t\t\tFur(k,1,tot)\n\t\t\t\tFur(w,1,tot){\n\t\t\t\t\tx=MIN(MIN(a[i].x,a[j].x),MIN(a[k].x,a[w].x));\n\t\t\t\t\ty=MIN(MIN(a[i].y,a[j].y),MIN(a[k].y,a[w].y));\n\t\t\t\t\tX=MAX(MAX(a[i].x,a[j].x),MIN(a[k].x,a[w].x));\n\t\t\t\t\tY=MAX(MAX(a[i].y,a[j].y),MIN(a[k].y,a[w].y));\n\t\t\t\t\tif(b[X][Y]-b[X][y-1]-b[x-1][Y]+b[x-1][y-1])continue;\n\t\t\t\t\tint t=s[X][Y]-s[X][y-1]-s[x-1][Y]+s[x-1][y-1],tt=(X-x)*(Y-y);\n\t\t\t\t\tif(t>as)ans=tt,as=t;\n\t\t\t\t\telse if(t==as)ans=MIN(ans,tt);\n\t\t\t}\n\tout<<as<<ln<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 3117 [USACO15JAN]\u725b\u7684\u77e9\u5f62Cow Rectangles/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1658 01\u4ea4\u66ff\u5b50\u5e8f\u5217", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bf4\u5b9e\u8bdd,\u6211\u89c9\u5f97\u6211\u662f\u592a\u50bb\u540a\u4e86,\u4e00\u9053\u52a8\u52a8\u8111\u7b4b\u5c31\u53ef\u4ee5\u5199\u7684\u9898\u6211\u80fd\u5199\u6210\u9ebb\u70e6\u7684$dp$\n\n\n\ndalao\u7684\u4ee3\u7801\uff1a(\u76f4\u63a5\u626b\u63cf\u4e00\u904d\u5c31\u53ef\u4ee5\u8fc7\u4e86)\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\n#include<algorithm>\nusing namespace std;\nchar s[100050];\nint main(){\n\tint n,ans=0;\n\tscanf(\"%d\",&n);\n\tscanf(\"%s\",s+1);\n\tfor (int i=1;i<=n;i++)\n\tif (s[i]!=s[i-1]) ans++;\n\tprintf(\"%d\\n\",min(n,ans+2));\n\treturn 0;\n}\n```\n\n\u6211\u7684\u4ee3\u7801\uff1a(\u5c45\u7136\u80fd\u5199\u6210\u52a8\u6001\u89c4\u5212)\n\n(\u8be6\u89c1\u4e0b\u9762)\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,f[N][2],g[N][2],p[N][2];\nchar a[N];\nint main(){\n\tfin(\"in\");\n\tin>>n>>(a+1);\n\tf[1][a[1]-48]++;\n\tg[1][0]=g[1][1]=p[1][0]=p[1][1]=1;\n\tFur(i,2,n){\n\t\tf[i][0]=f[i-1][0];\n\t\tf[i][1]=f[i-1][1];\n\t\tint k=a[i]-48;\n\t\tf[i][k]=MAX(f[i][k],f[i-1][!k]+1);\n\t\t\n\t\tg[i][0]=g[i-1][0];g[i][1]=g[i-1][1];\n\t\tg[i][k]=MAX(g[i][k],MAX(f[i-1][k],g[i-1][!k])+1);\n\t\t\n\t\tp[i][0]=p[i-1][0];p[i][0]=p[i-1][0];\n\t\tp[i][k]=MAX(p[i][k],MAX(g[i-1][k],p[i-1][!k])+1);\n\t}\n\tout<<MAX(p[n][0],p[n][1])<<ln;\n}\n\n```\n", "link": "/posts/51nod 1658 01\u4ea4\u66ff\u5b50\u5e8f\u5217/", "tags": ["\u7ebf\u6027"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3121 [USACO15FEB]\u5ba1\u67e5\uff08\u9ec4\u91d1\uff09Censoring-", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3121&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3121\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7528`LG 4824 [USACO15FEB]Censoring\"`\u7684\u505a\u6cd5hash,kmp\u4ec0\u4e48\u7684\u56e0\u4e3a\u6570\u636e\u6c34\u6240\u4ee5\u8dd1\u4e0d\u6ee1\u53ef\u4ee5\u6c34\u8fc7\u53bb\n\n\u8fd8\u662f\u7ec3\u4e00\u4e0bAC\u81ea\u52a8\u673a\u5427\n\n\u89e3\u91ca\u89c1\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,c[N][26],cnt=0,ed[N];\nchar s[N],ch[N];\nil void ins(){\n    int now=0,len=strlen(ch+1);\n    Fur(i,1,len){\n        int x=ch[i]-'a';\n        if(!c[now][x])c[now][x]=++cnt;\n        now=c[now][x];\n    }\n    ed[now]=len;\n}\nint q[N],fail[N];\nil void ac(){\n    int h=0,t=0;\n    Fur(i,0,25)\n        if(c[0][i])q[t++]=c[0][i];\n    while(h<t){\n        int now=q[h++];\n        Fur(i,0,25){\n            if(!c[now][i])\n                c[now][i]=c[fail[now]][i];\n            else\n                fail[c[now][i]]=c[fail[now]][i],\n                q[t++]=c[now][i];\n        }\n    }\n}\nint p[N];\nint main(){\n    in(s+1);\n    in(n);\n    Fur(i,1,n){\n        in(ch+1);\n        ins();//\u63d2\u5165trie\u4e2d\n    }\n    ac();// AC \u81ea\u52a8\u673a\n    int tp=0,now=0,len=strlen(s+1);\n    Fur(i,1,len){\n        int x=s[i]-'a';\n        now=c[now][x];\n        q[++tp]=i;\n        p[tp]=now;\n        if(ed[now]){\n            tp-=ed[now];\n            if(!tp)now=0;\n            else now=p[tp];\n            //\u8df3\u56de\u4e4b\u524d\n        }\n    }\n    Fur(i,1,tp)pt(s[q[i]]);\n    flush();\n}\n```\n", "link": "/posts/LG 3121 [USACO15FEB]\u5ba1\u67e5\uff08\u9ec4\u91d1\uff09Censoring-/", "tags": ["AC\u81ea\u52a8\u673a", "\u6808", "kmp", "hash"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF86D Powerful-array", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF86D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF86D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$cnt$\u6570\u7ec4\u8bb0\u5f55\u6bcf\u79cd\u6570\u5b57\u51fa\u73b0\u7684\u6b21\u6570\n\n\u6211\u4eec\u53ea\u9700\u8981\u8003\u8651$add(x),del(x)$,\u5176\u4ed6\u7684\u4ea4\u7ed9\u83ab\u961f\n\n\u6211\u4eec\u8003\u8651\u5f53\u524d\u6570\u539f\u672c\u7684\u7b54\u6848\u662f$a_x \\times cnt_x^2$\n\n\u73b0\u5728\u53d8\u6210$a_x \\times (cnt_x+1)^2$\n\n\u8bbe$cnt_x =y$\n\n$(y+1)^2  = y^2 + 2y +1$\n\n\u6240\u4ee5\u66f4\u65b0\u7684\u65f6\u5019$ans +=  a_x \\times (cnt_x \\times 2 + 1)$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,Q,a[N],sz;\nstruct que{\n    int l,r,id;\n}q[N];\nil int bl(int x){return (x-1)/sz+1;}\nil bool cmp(que x,que y){\n    if(bl(x.l)==bl(y.l))return x.r<y.r;\n    else return x.l<y.l;\n}\nint cnt[1000001];\nll ans=0,ANS[N];\nil void add(int x){\n    ans+=1ll*a[x]*(cnt[a[x]]<<1|1);\n    ++cnt[a[x]];\n}\nil void del(int x){\n    ans-=1ll*a[x]*(cnt[a[x]]*2-1);\n    --cnt[a[x]];\n}\nint main(){\n    in(n,Q);\n    sz=sqrt(n);\n    Fur(i,1,n)in(a[i]);\n    Fur(i,1,Q)in(q[i].l,q[i].r),q[i].id=i;\n    sort(q+1,q+Q+1,cmp);\n    int l=0,r=0;\n    Fur(i,1,Q){\n        Fur(j,l,q[i].l-1)del(j);\n        Fur(j,r+1,q[i].r)add(j);\n        Fdr(j,l-1,q[i].l)add(j);\n        Fdr(j,r,q[i].r+1)del(j);\n        ANS[q[i].id]=ans;\n        l=q[i].l;r=q[i].r;\n    }\n    Fur(i,1,Q)out(ANS[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG CF86D Powerful-array/", "tags": ["\u83ab\u961f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5358 [SDOI2019]\u5feb\u901f\u67e5\u8be2", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5358&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5358\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u53c2\u8003\u7ebf\u6bb5\u6811\u6216\u5206\u5757\u7ef4\u62a4\u533a\u95f4\u52a0\u548c\u533a\u95f4\u51cf\u7684\u601d\u8def\n\n\u770b\u4e00\u4e0b\u6570\u636e\u8303\u56f4,\u6bcf\u6b21\u64cd\u4f5c\u53ea\u80fd$O(1)$\u7684\u590d\u6742\u5ea6\u3002\n\n\u70b9\u7684\u4f4d\u7f6e\u53ef\u4ee5\u79bb\u6563\u5316\u4e00\u4e0b\n\n\u8bb0\u5f97\u5148\u4e58\u540e\u52a0\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#include<unordered_map>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100007\nconst int mod=10000019;\nint n,Q,add=0,mul=1,ans=0,s=0,v[N],ti[N],la,inv[mod+1];\nstruct que{\n    int u,x,y;\n}q[N];\nvoid work(int i,int k){\n    int u=q[i].u,x=q[i].x,y=q[i].y;\n    if(u==6)ans=(ans+s)%mod;\n    else if(u==2)s=(s+1ll*n*x%mod)%mod,add=(add+x)%mod;\n    else if(u==3)s=1ll*s*x%mod,add=1ll*add*x%mod,mul=1ll*mul*x%mod;\n    else if(u==4)s=1ll*n*x%mod,add=0,mul=1,v[0]=x,la=k;\n    else if(u==5){\n        if(ti[x]<=la)ans=(ans+1ll*mul*v[0]%mod+add)%mod;\n        else ans=(ans+1ll*mul*v[x]%mod+add)%mod;\n    }\n    else{\n        if(ti[x]<=la)s=(s-1ll*mul*v[0]%mod-add+(mod<<1))%mod;\n        else s=(s-1ll*mul*v[x]%mod-add+(mod<<1))%mod;\n        s=(s+y)%mod;ti[x]=k;v[x]=1ll*(y-add+mod)*inv[mul]%mod;\n    }\n}\nunordered_map<int,int>mp;\nint a[N],b[N];\nint main(){\n    in>>n>>Q;\n    inv[1]=1;\n    Fur(i,2,mod)inv[i]=1ll*(mod-mod/i)*inv[mod%i]%mod;\n    int u,x,d=0;\n    Fur(i,1,Q){\n        in>>q[i].u;\n        if(q[i].u!=6)in>>q[i].x;\n        if(q[i].u==1){\n            in>>q[i].y,q[i].y=(q[i].y%mod+mod)%mod;\n            if(!mp[q[i].x])mp[q[i].x]=++d;\n        }\n        else if(q[i].u<=4)q[i].x=(q[i].x%mod+mod)%mod;\n        if(q[i].u==3&&q[i].x==0)q[i].u=4;\n    }\n    Fur(i,1,Q)if(q[i].u==1||q[i].u==5)q[i].x=mp[q[i].x];\n    mul=1;\n    int t;in>>t;\n    Fur(i,1,t)in>>a[i]>>b[i];\n    Fur(i,1,t*Q){\n        int x=(i-1)/Q+1,y=(i-1)%Q+1;\n        work((a[x]+1ll*y*b[x])%Q+1,i);\n    }\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 5358 [SDOI2019]\u5feb\u901f\u67e5\u8be2/", "tags": ["\u6253\u6807\u8bb0"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5199 [USACO19JAN]Mountain View", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5199&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5199\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nstruct node{\n\tint l,r;\n}a[N];\nbool cmp(node p,node q){\n\treturn (p.l==p.l)?(p.l<q.l):(p.r>q.r);\n}\nint n,ans=0;\nint main(){\n\tfin(\"in\");\n\tin>>n;\n\tint x,y;\n\tFur(i,1,n)in>>x>>y,a[i].l=x-y,a[i].r=x+y;\n\tsort(a+1,a+n+1,cmp);\n\tint t=0;\n\tFur(i,1,n)if(a[i].r>t)t=a[i].r,ans++;\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 5199 [USACO19JAN]Mountain View/", "tags": ["\u6280\u5de7"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2789 \u76f4\u7ebf\u4ea4\u70b9\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2789&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2789\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5bf9$p$\u6761\u76f4\u7ebf\u5206\u60c5\u51b5\u8ba8\u8bba\u5e73\u884c\u7ebf\u7684\u6761\u6570,\u5df2\u77e5\u5728\u6709$r$\u6761\u5e73\u884c\u7ebf\u65f6\u6709$p-r$\u6761\u7ebf\u4e0e\u4ed6\u4eec\u76f8\u4ea4\u4e8e$p\\times(p-r)$\u4e2a\u4ea4\u70b9,\u518d\u52a0\u4e0a\u5bf9\u4e8e\u8fd9$p-r$\u4e2a\u4ea4\u70b9\u7684\u76f8\u4ea4\u7ec4\u5408\u5373\u53ef\uff01\n<!-- more -->\n\n```cpp\n#include<iostream>\nusing namespace std;\nint n,ans=0;\nbool f[10010];\nvoid suv(int p,int m){\n\tif(p==0){\n\t\tif(!f[m])ans++;\n\t\tf[m]=1;\n\t}\n\telse \n\t\tfor(int r=p;r>=1;r--)\n\t\t\tsuv(p-r,r*(p-r)+m);\n}\nint main(){\n\tcin>>n;\n\tsuv(n,0);\n\tcout<<ans<<endl;\n}\n```\n", "link": "/posts/LG 2789 \u76f4\u7ebf\u4ea4\u70b9\u6570/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG UVA12888 Count-LCM", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/UVA12888&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/UVA12888\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6c42$\\sum [lcm(i,j)=i\\times j]$\n\n\u76f8\u5f53\u4e8e\u6c42$\\sum_{i=1}^n \\sum_{j=1} ^n[gcd(i,j) = 1]$\n\n> \u65f6\u95f4\u9650\u5236:$10.00s$\n> \n> $1 \\le n,m \\le 10^9$\u4e14$\\min(n,m) \\le 10^6$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/LG UVA12888 Count-LCM/", "tags": ["\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1051F The-Shortest-Statement", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1051F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1051F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u601d\u8def\u5f88\u5999\n\n\u6ce8\u610f$m-n \\le 20$\uff01\n\n\u4e5f\u5c31\u662f\u8bf4\u6700\u591a\u53ea\u6709$21$\u6761\u975e\u6811\u8fb9\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u8dd1\u4e00\u904dkruskal,\u7136\u540e\u6309\u5957\u8def\u5efa\u6811,\u4e24\u70b9\u4e4b\u95f4\u7684\u8ddd\u79bb\u5c31\u662f$d_x+d_y-2\\times lca(x,y)$\n\n\u63a5\u7740\u5269\u4e0b\u6700\u591a$21$\u6761\u8fb9($42$\u4e2a\u8282\u70b9),\u518d\u8dd1\u6700\u591a$42$\u6b21\u6700\u77ed\u8def\u5c31\u53ef\u4ee5\u5904\u7406\u51fa\u52a0\u4e0a\u975e\u6811\u8fb9\u7684\u7ed3\u679c\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100111\nint n,m,q,cnt=0,head[N];\nstruct edge{\n    int to,nxt,w;\n}e[N*2],ee[60];\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[cnt].w=w;\n    e[++cnt].to=x;e[cnt].nxt=head[y];head[y]=cnt;\n    e[cnt].w=w;\n}\nll D[N];\nint siz[N],top[N],f[N],d[N];\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        D[to]=D[x]+e[i].w;f[to]=x;\n        d[to]=d[x]+1;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nll get(int x,int y){\n    int ox=x,oy=y;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        x=f[top[x]];\n    }\n    if(d[x]>d[y])SWAP(x,y);\n    return D[ox]+D[oy]-2*D[x];\n}\nstruct link{\n    int x,y,w,u;\n}E[N];\nint tt=0;\nbool cmp(link x,link y){return x.w<y.w;}\nint fa[N];\nint gf(int x){\n    return (x==fa[x])?x:(fa[x]=gf(fa[x]));\n}\nll dis[60][N];\nbool v[N];\nstruct node{\n    int x;\n    ll d;\n    bool operator<(node x)const{\n        return d>x.d;\n    }\n};\npriority_queue<node>T;\nvoid dij(int id,int st){\n    dis[id][st]=0;\n    T.push(node{st,0});\n    clr(v,0);\n    while(!T.empty()){\n        int x=T.top().x;T.pop();\n        if(v[x])continue;\n        v[x]=1;\n        fl(i,x)if(dis[id][x]+e[i].w<dis[id][to]){\n            dis[id][to]=dis[id][x]+e[i].w;\n            T.push(node{to,dis[id][to]});\n        }\n    }\n}\nvoid init(){\n    clr(dis,126);\n    sort(E+1,E+m+1,cmp);\n    Fur(i,1,n)fa[i]=i;\n    int x,y,w;\n    Fur(i,1,m){\n        x=E[i].x,y=E[i].y,w=E[i].w;\n        if(gf(x)!=gf(y)){\n            fa[fa[y]]=fa[x];\n            add(x,y,w);\n        }\n        else E[i].u=1;\n    }\n    dfs(1);bt(1,1);\n    Fur(i,1,m)if(E[i].u)\n        add(E[i].x,E[i].y,E[i].w);\n    Fur(i,1,m)if(E[i].u)\n        dij(++tt,E[i].x),dij(++tt,E[i].y);\n}\nsigned main(){\n    in(n,m);\n    int x,y,w;\n    Fur(i,1,m)in(x,y,w),E[i]=link{x,y,w};\n    init();\n    in(q);\n    while(q--){\n        in(x,y);\n        ll ans=get(x,y);\n        Fur(i,1,tt)\n            ans=MIN(ans,dis[i][x]+dis[i][y]);\n        out(ans,ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF1051F The-Shortest-Statement/", "tags": ["lca", "\u6700\u77ed\u8def", "\u6700\u5c0f\u751f\u6210\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5536 \u3010XR-3\u3011\u6838\u5fc3\u57ce\u5e02", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5536&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5536\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u653e$n-k$\u4e2a\u8282\u70b9\u7136\u540e\u4f7f\u6df1\u5ea6\u6700\u5927\u7684\u6700\u5c0f\n\n\n\n\u4e00\u5f00\u59cb\u7684\u65f6\u5019\u53ef\u4ee5\u53cd\u8fc7\u6765\u60f3\uff1a\u6811\u91cc\u9762\u957f\u5ea6\u6700\u5927\u7684\u8def\u5f84\u5c31\u662f\u6811\u7684\u76f4\u5f84,\u5b83\u7684\u4e24\u4e2a\u7aef\u70b9\u7684\u5ea6\u90fd\u662f$1$\uff08\u4e5f\u5c31\u662f\u53f6\u5b50\u8282\u70b9\uff09\n\n\n\n\u6211\u4eec\u53ef\u4ee5\u4ece\u6bcf\u4e2a\u53f6\u5b50\u7ed3\u70b9\u5f00\u59cb,\u5411\u4e2d\u5fc3\u5305\u56f4\u3002\u53ef\u4ee5\u7528\u961f\u5217\u7684\u65b9\u5f0f\u5b9e\u73b0\u3002\n\n\uff08\u4ee3\u7801\u5f88\u77ed\uff09\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100001\nint n,cnt(0),k,head[N],q[N],c[N],d[N];\nstruct edge{\n\tint to,nxt;\n}e[N*2];\nil void add(int x,int y){\n\te[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint main(){\n\tfin(\"in\");\n\tin>>n>>k;\n\tint x,y;\n\tFur(i,1,n-1)\n\t\tin>>x>>y,\n\t\tadd(x,y),add(y,x),c[x]++,c[y]++;\n\t\n\tint h=0,t=0,cnt=n-k;\n\tFur(i,1,n)if(c[i]==1)q[t++]=i,d[i]=1;\n\twhile(h<t){\n\t\tx=q[h++];\n\t\tif(!--cnt)return out<<d[x]<<ln,0;\n\t\tfl(i,x)if(--c[to]==1)\n\t\t\td[to]=d[x]+1,q[t++]=to;\n\t}\n}\n\n```\n", "link": "/posts/LG 5536 \u3010XR-3\u3011\u6838\u5fc3\u57ce\u5e02/", "tags": ["\u6811\u7684\u76f4\u5f84"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1316 \u56de\u6587\u77e9\u9635", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u679a\u4e3e\u54ea\u4e9b\u884c\u548c\u54ea\u4e9b\u5217\u8981\u53d8\u6210\u56de\u6587\n\n\u5904\u7406:\n\n\u884c:\u70b9$(i,j)$\u5bf9\u5e94\u70b9$(i,m-j+1)$\n\n\u5217:\u70b9$(i,j)$\u5bf9\u5e94\u70b9$(n-i+1,j)$\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u5408\u5e76\u8fd9\u4e9b\u70b9\n\n\u7136\u540e\u6c42\u6bcf\u4e2a\u5757\u4e2d0\u8fd8\u662f1\u591a\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il inline\n#define clr(x,y) memset(x,y,sizeof x)\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\nusing namespace std;\nil int min(int x,int y){return x<y?x:y;}\n#define N 20\nint fr[N][N],fc[N][N];\nint row[N],col[N],f[N*N],cnt0[N*N],cnt1[N*N];\nint r,c,n,m,ans;\nchar ch[N][N];\nint gf(int x){return (x==f[x])?x:(f[x]=gf(f[x]));}\nil void mg(int x,int y){\n    int fx=gf(x),fy=gf(y);\n    if(fx!=fy){\n        f[fy]=fx;\n        cnt0[fx]+=cnt0[fy];\n        cnt1[fx]+=cnt1[fy];\n    }\n}\nil int id(int i,int j){return (i-1)*m+j;}\nvoid solve(){\n    clr(fr,0);clr(fc,0);\n    Fur(i,1,r)\n        Fur(j,1,m)\n            fr[row[i]][j]=1;\n\n    Fur(i,1,n)\n        Fur(j,1,c)\n            fc[i][col[j]]=1;\n\n    Fur(i,1,n)\n        Fur(j,1,m)\n        if(fr[i][j]||fc[i][j]){\n            f[id(i,j)]=id(i,j);\n            if(ch[i][j]=='0')cnt0[id(i,j)]=1,cnt1[id(i,j)]=0;\n            else cnt0[id(i,j)]=0,cnt1[id(i,j)]=1;\n        }\n    Fur(i,1,n)\n        Fur(j,1,m){\n            if(fr[i][j])mg(id(i,j),id(i,m-j+1));\n            if(fc[i][j])mg(id(i,j),id(n-i+1,j));\n        }\n    int sum=0;\n    Fur(i,1,n)\n        Fur(j,1,m)\n        if((fr[i][j]||fc[i][j])&&f[id(i,j)]==id(i,j))\n            sum+=min(cnt0[id(i,j)],cnt1[id(i,j)]);\n\n    ans=min(ans,sum);\n}\nvoid dfs2(int cnt,int pre){\n    if(cnt==c+1)return (void)solve();\n    Fur(i,pre+1,m){\n        col[cnt]=i;\n        dfs2(cnt+1,i);\n    }\n}\nvoid dfs(int cnt,int pre){\n    if(cnt==r+1)return (void)dfs2(1,0);\n    Fur(i,pre+1,n){\n        row[cnt]=i;\n        dfs(cnt+1,i);\n    }\n} \nint main(){\n    scanf(\"%d%d%d\",&r,&c,&n);\n    Fur(i,1,n)\n        scanf(\"%s\",ch[i]+1);\n    m=strlen(ch[1]+1);\n    ans=(1<<30);\n    dfs(1,0);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/51nod 1316 \u56de\u6587\u77e9\u9635/", "tags": ["\u641c\u7d22", "\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3434 [POI2006]KRA-The Disks", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3434&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3434\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\nint n,m,a[N],mi[N];\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    a[0]=(1<<30);mi[0]=0;\n    Fur(i,1,n){\n        in>>a[i];\n        mi[i]=(a[mi[i-1]]<=a[i])?mi[i-1]:i;\n    }\n    mi[n+1]=mi[n];\n    int x,p=n+1;\n    while(m--){\n        in>>x;\n        if(a[mi[p]]<x){\n            while(a[mi[p]]<x)p=mi[p]-1;\n        }\n        else p--;\n    }\n    if(p<0)out<<\"0\\n\";\n    else out<<p<<ln;\n}\n```\n", "link": "/posts/LG 3434 [POI2006]KRA-The Disks/", "tags": ["\u6a21\u62df"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP3267 DQUERY", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP3267&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP3267\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nD-query\ntop: 0\n\n\u5c31\u662f\u83ab\u961f\u7684\u677f\u5b50\u9898\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 30011\nint n,sz,Q,a[N],cnt[1000011];\nstruct que{\n    int l,r,id;\n}q[200011];\nil int bl(int x){return (x-1)/sz+1;}\nbool cmp(que x,que y){\n    if(bl(x.l)==bl(y.l))return x.r<y.r;\n    return x.l<y.l;\n}\nint ans,ANS[200011];\nil void add(int x){if(!cnt[a[x]]++)++ans;}\nil void del(int x){if(!--cnt[a[x]])--ans;}\nint main(){\n    in(n);sz=sqrt(n);\n    Fur(i,1,n)in(a[i]);\n    in(Q);\n    Fur(i,1,Q)in(q[i].l,q[i].r),q[i].id=i;\n    sort(q+1,q+Q+1,cmp);\n    int l=0,r=0;\n    Fur(i,1,Q){\n        Fur(j,l,q[i].l-1)del(j);\n        Fdr(j,l-1,q[i].l)add(j);\n        Fur(j,r+1,q[i].r)add(j);\n        Fdr(j,r,q[i].r+1)del(j);\n        ANS[q[i].id]=ans;\n        l=q[i].l;r=q[i].r;\n    }\n    Fur(i,1,Q)out(ANS[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG SP3267 DQUERY/", "tags": ["\u83ab\u961f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3515 [POI2011]Lightning-Conductor", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3515&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3515\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u9898\u76ee\u5927\u610f\uff1a\n\n\u7ed9\u5b9a\u4e00\u4e2a\u957f\u5ea6\u4e3a $n\\leq 500000$ \u7684\u5e8f\u5217 $a_1, a_2, \\cdots, a_n$ ,\u8981\u6c42\u5bf9\u4e8e\u6bcf\u4e00\u4e2a $1 \\leq r \\leq n$ ,\u627e\u5230\u6700\u5c0f\u7684\u975e\u8d1f\u6574\u6570 $f_{r}$ \u6ee1\u8db3\n\n$$\\forall l\\in\\left[1,n\\right]:a_l \\leq a_r + f_{r} - \\sqrt{|r-l|}$$\n\n## \u89e3\u6cd5\n\n\u8003\u8651$l<r,r>l$\u7684\u5c06\u5e8f\u5217\u7ffb\u8f6c\u540e\u518d\u6765\u4e00\u6b21\u5c31\u53ef\u4ee5\u4e86\n\n$$f_r= \\max(a_l+\\sqrt{r-l})-a_r(l\\in[1,r])$$\n\n\u53ef\u4ee5\u8bc1\u660e$f_r$\u7684\u6700\u4f18\u51b3\u7b56\u70b9\u662f\u9012\u589e\u7684\n\n~~\u53ef\u4ee5\u6253\u8868~~\n\n### \u5206\u6cbb\u89e3\u6cd5\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define db double\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500011\nint n;\nll a[N];\nlong db f1[N],f2[N];\nvoid work(int L,int R,int l,int r,long db *f){\n    if(L>R)return;\n    int m=(L+R)>>1,k=0;\n    f[m]=a[m];\n    long db t=0;\n    Fur(i,l,MIN(r,m)){\n        t=a[i]+sqrt(db(m-i));\n        if(t>f[m])k=i,f[m]=t;\n    }\n    f[m]-=a[m];\n    if(!k)k=m;\n    work(L,m-1,l,k,f);\n    work(m+1,R,k,r,f);\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i]);\n    work(1,n,1,n,f1);\n    reverse(a+1,a+n+1);\n    work(1,n,1,n,f2);\n    Fur(i,1,n)out((ll)ceil(MAX(f1[i],f2[n-i+1])),ln);\n    flush();\n}\n```\n\n### \u961f\u5217\u5b9e\u73b0\u51b3\u7b56\u4e8c\u5206\u6808\n\n\u5bf9\u4e8e\u6bcf\u4e2a$j$,\u628a$a_j+\\sqrt{i-j}$\u770b\u6210\u5173\u4e8e$i$\u7684\u51fd\u6570$f_j$\u3002\n\n\u6211\u4eec\u8981\u505a\u7684\u5c31\u662f\u5728\u6240\u6709$j\\leq i$\u7684\u51fd\u6570\u4e2d\u627e\u5230\u6700\u503c\n\n\u961f\u5217\u5b9e\u73b0\u51b3\u7b56\u4e8c\u5206\u6808,\u6309$j$\u4ece\u5c0f\u5230\u5927\u4f9d\u6b21\u7ef4\u62a4\u8fd9\u4e9b\u51fd\u6570\u3002\n\n\u5bf9\u4e8e\u5176\u4e2d\u4efb\u610f\u4e24\u4e2a\u76f8\u90bb\u7684\u51fd\u6570$f_t,f_{t+1}$ ,\u5b83\u4eec\u90fd\u6709\u4e00\u4e2a\u4e34\u754c\u503c$k_{t,t+1}$\n\n\u663e\u7136\u5e8f\u5217\u4e2d\u7684$k_{1,2},k_{2,3}...$\u4e5f\u8981\u4e25\u683c\u9012\u589e\u3002\n\n\u5426\u5219,\u5982\u679c$k_{t,t+1}\\ge k_{t+1,t+2}$,$f_{t+1}$\u6839\u672c\u6ca1\u6709\u7528\u3002\n\n\u6bcf\u6b21\u52a0\u5165$f_i$\u7684\u65f6\u5019\uff1a\n\n\u8bbe\u961f\u5c3e\u4e3a$t$,\u5982\u679c\u5f53\u524d$i$\u6bd4$t$\u4f18($calc(k_{t-1},i)\\ge calc(k_{t-1},t)$),\u90a3\u4e48\u5f39\u51fa$t$\n\n\u73b0\u5728\u6765\u8003\u8651\u961f\u5934$h$\n\n\u82e5$k_h\\le i$\u90a3\u4e48\u628a$h$\u5f39\u51fa\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define db double\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500011\nint n,a[N],q[N],k[N];\ndb p[N],sq[N];\nil db calc(int i,int j){return a[j]+sq[i-j];}//\u51fd\u6570\u503c\nil int bound(int x,int y){\n    int l=y,r=(k[x]?k[x]:n),m,ret=r+1;\n    while(l<=r){\n        m=(l+r)>>1;\n        if(calc(m,x)<=calc(m,y))\n            ret=m,r=m-1;\n        else l=m+1;\n    }\n    return ret;\n}\nvoid work(){\n    int h=1,t=0;\n    Fur(i,1,n){\n        while(h<t&&calc(k[t-1],q[t])<calc(k[t-1],i))--t;\n        //\u4fdd\u6301k\u5355\u8c03\n        k[t]=bound(q[t],i);\n        //\u4e8c\u5206\u51fa\u4e34\u754c\u70b9\n        q[++t]=i;\n        while(h<t&&k[h]<=i)++h;\n        //\u4e0d\u4f18\u7684\u51fa\u961f\n        p[i]=MAX(p[i],calc(i,q[h]));\n        //\u4e24\u904d\u53d6max\n    }\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i]),sq[i]=sqrt(i);\n    work();\n\n    //\u7ffb\u8f6c\u5e8f\u5217\n    reverse(a+1,a+n+1);\n    reverse(p+1,p+n+1);\n    memset(k,0,(n+1)<<2);\n    work();\n\n    //\u7ffb\u8f6c\u540e\u9700\u8981\u5012\u5e8f\u8f93\u51fa\n    Fdr(i,n,1)out(MAX(int(ceil(p[i]))-a[i],0),ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3515 [POI2011]Lightning-Conductor/", "tags": ["\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f", "\u52a8\u6001\u89c4\u5212", "\u5355\u8c03\u961f\u5217", "\u51b3\u7b56\u5355\u8c03\u6027"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5504 [JSOI2011]\u67e0\u6aac", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5504&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5504\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_i$\u8868\u793a$[1,i]$\u6700\u591a\u53d8\u6210\u591a\u5c11\u4e2a\n\n$$f_i=\\max_{s_i=s_j}(f[j-1]+s_j\\times (\\sum_{i=j}^i[s_i=s_j])^2)$$\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5982\u679c$s_j=s_{j'}(j'< j)$,\u4ece$j'$\u8f6c\u79fb\u4e00\u5b9a\u6bd4\u4ece$j$\u4f18\n\n\u8fd9\u4e00\u6761\u4ef6\u6ee1\u8db3\u51b3\u7b56\u5355\u8c03\u6027\uff01\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\u5355\u8c03\u6027\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,a[N],s[N],la[10011];\nvector<int>q[10011];\nll f[N];\nil ll calc(int p,int t){\n    return f[p-1]+1ll*a[p]*t*t;\n}\n#define sz(x) q[x].size()\nil int bound(int x,int y){\n    int ret=n+1;\n    int l=1,r=n,m;\n    while(l<=r){\n        m=(l+r)>>1;\n        if(calc(x,m-s[x]+1)>=calc(y,m-s[y]+1))\n            ret=m,r=m-1;\n        else l=m+1;\n    }\n    return ret;\n}\nint main(){\n    in(n);\n    Fur(i,1,n){\n        in(a[i]);\n        s[i]=s[la[a[i]]]+1;\n        la[a[i]]=i;\n    }\n    int h=1,t=0,x;\n    Fur(i,1,n){\n        x=a[i];\n        while(sz(x)>1&&bound(q[x][sz(x)-2],q[x][sz(x)-1])<=bound(q[x][sz(x)-1],i))\n            q[x].pop_back();\n        q[x].push_back(i);\n        while(sz(x)>1&&bound(q[x][sz(x)-2],q[x][sz(x)-1])/*\u76f8\u5f53\u4e8e\u51b3\u7b56\u70b9,\u61d2\u5f97\u5f00k\u6570\u7ec4\u4e86*/<=s[i])\n            q[x].pop_back();\n        f[i]=calc(q[x][sz(x)-1],s[i]-s[q[x][sz(x)-1]]+1);\n    }\n    cout<<f[n]<<endl;\n}\n```\n", "link": "/posts/LG 5504 [JSOI2011]\u67e0\u6aac/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u51b3\u7b56\u5355\u8c03\u6027", "\u5355\u8c03\u961f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3801 \u7ea2\u8272\u7684\u5e7b\u60f3\u4e61", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3801&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3801\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u628a\u7ad9\u4f4d\u5f53\u4f5c\u62b5\u6d88\u7684\u90e8\u5206\n\n\u5efa\u7acb\u4e24\u68f5\u7ebf\u6bb5\u6811,\u7edf\u8ba1$x$\u8f74\u548c$y$\u8f74\u88ab\u8986\u76d6\u7684\u60c5\u51b5\n\n\u6bcf\u6b21\u7684\u7b54\u6848\u5c31\u662f\n\n\u653e\u8fc7\u7684\u884c\u6570\u00d7\u884c\u957f\u5ea6+\u653e\u8fc7\u7684\u5217\u6570\u00d7\u5217\u957f\u5ea6-\u62b5\u6d88\u5757\u6570\n\n\u62b5\u6d88\u5757\u6570\u5c31\u662f$x$\u8f74\u88ab\u8986\u76d6\u884c\u6570$\\times y$\u8f74\u88ab\u8986\u76d6\u884c\u6570 $\\times 2$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define ls rt<<1\n#define rs rt<<1|1\nint P[N<<2],Q[N<<2],n,m;\nvoid upd(int *s,int x,int l,int r,int rt){\n\tif(l==r){\n\t\ts[rt]^=1;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tif(x<=m)upd(s,x,l,m,ls);\n\telse upd(s,x,m+1,r,rs);\n\ts[rt]=s[ls]+s[rs];\n}\nint ask(int *s,int L,int R,int l,int r,int rt){\n\tif(L<=l&&r<=R)return s[rt];\n\tint m=(l+r)>>1,ans=0;\n\tif(L<=m)ans=ask(s,L,R,l,m,ls);\n\tif(R>m)ans+=ask(s,L,R,m+1,r,rs);\n\treturn ans;\n}\nint main(){\n\tfin(\"in\");\n\tint q;\n\tin>>n>>m>>q;\n\tint u,x,y,X,Y;\n\twhile(q--){\n\t\tin>>u>>x>>y;\n\t\tif(u==2){\n\t\t\tin>>X>>Y;\n\t\t\tint a=ask(P,x,X,1,n,1),b=ask(Q,y,Y,1,m,1);\n\t\t\tout<<(1ll*a*(Y-y+1)+1ll*b*(X-x+1)-2ll*a*b)<<ln;\n\t\t}\n\t\telse upd(P,x,1,n,1),upd(Q,y,1,m,1);\n\t}\n}\n\n```\n", "link": "/posts/LG 3801 \u7ea2\u8272\u7684\u5e7b\u60f3\u4e61/", "tags": ["\u7ebf\u6bb5\u6811", "\u5bb9\u65a5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1041D Glider", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1041D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1041D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\nint n,h,s[N];\nstruct node{\n    int l,r;\n}a[N];\nint main(){\n    fin(\"in\");\n    in>>n>>h;\n    Fur(i,1,n)in>>a[i].l>>a[i].r;\n    Fur(i,2,n)s[i]=s[i-1]+a[i].l-a[i-1].r;\n    int r=1,ans=0;\n    Fur(i,1,n){\n        while(s[i]-s[r]>=h)++r;\n        ans=MAX(ans,a[i].r-a[r].l+h-(s[i]-s[r]));\n    }\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG CF1041D Glider/", "tags": ["\u53cc\u6307\u9488"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4069 [SDOI2016]\u6e38\u620f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4069&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4069\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,m;\nint main(){\n\t\n}\n\n```\n", "link": "/posts/LG 4069 [SDOI2016]\u6e38\u620f/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3572 [POI2014]PTA-Little-Bird", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3572&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3572\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u663e\u800c\u6613\u89c1\uff1a\n\n$f_i = f_j + [ a_i \\le a_j ] (i < j \\le n)$\n\n\u9898\u76ee\u8981\u6c42\u662f\u590d\u6742\u5ea6$O(nq)$\n\n\u4e00\u770b\u6709\u4e2a\u6b65\u4f10\u9650\u5236\n\n\u90a3\u4e48\u663e\u7136\u52a0\u4e2a\u5355\u8c03\u961f\u5217\u5c31\u5b8c\u4e8b\u4e86\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nint f[N],a[N],n,m,q[N];\nint main(){\n\tin>>n;\n\tFur(i,1,n)in>>a[i];\n\tin>>m;\n\tint len;\n\twhile(m--){\n\t\tin>>len;\n\t\tf[1]=0;q[1]=1;\n\t\tint h=1,t=1;\n\t\tFur(i,2,n){\n\t\t\twhile(h<=t&&i-q[h]>len)h++;\n\t\t\tf[i]=f[q[h]]+(a[q[h]]<=a[i]);\n\t\t\twhile(h<=t&&(f[i]<f[q[t]]||(f[i]==f[q[t]]&&a[i]>=a[q[t]])))t--;\n\t\t\tq[++t]=i;\n\t\t}\n\t\tout<<f[n]<<ln;\n\t}\n}\n```\n", "link": "/posts/LG 3572 [POI2014]PTA-Little-Bird/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5355\u8c03\u961f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF521D Shop", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF521D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF521D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n1. $x_i$\u6539\u6210$val_i$,\u53ef\u4ee5\u8f6c\u6362\u6210\u52a0\u6cd5\n2. $x_i$\u52a0\u4e0a$val_i$,\u53ef\u4ee5\u770b\u6210\u4e58\u6cd5\n\n\u7136\u540e\u6392\u5e8f\u8d2a\u5fc3\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10001\n\nint main(){\n\n}\n\n```\n", "link": "/posts/LG CF521D Shop/", "tags": ["\u6253\u6807\u8bb0"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3959 \u5b9d\u85cf", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3959&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3959\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f[st][sta]$\u8868\u793a\u8d77\u70b9\u662f$st$,\u5f53\u524d\u8282\u70b9\u662f\u5426\u8bbf\u95ee\u8fc7\u7684\u72b6\u6001\u4e8c\u8fdb\u5236\u4e0b\u662f$sta$\n\n\u987a\u4fbf\u8bb0\u5f55$d[st][sta]$\u8868\u793a$f[st][sta]$\u6700\u5c0f\u65f6\u6bcf\u4e2a\u8282\u70b9\u8ddd\u79bb$st$\u7684\u8ddd\u79bb\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u586b\u8868\u6cd5\u5411\u524d\u63a8\u8fdb\n\n$f[st][sta'] = \\min(f[st][sta'],f[st][sta]+(d[st][sta][x]+1)\\times L) (sta' = sta | 2^{to-1})$\n\n\u6700\u574f\u60c5\u51b5\u4e0b\u590d\u6742\u5ea6: $\\Theta(n \\times 2^n \\times n^2\uff09$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 13\nint n,m,head[N],cnt=0;\nstruct edge{\n    int to,nxt,w;\n}e[2011];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint f[N][1<<N],d[N][1<<N][N];\nvoid init(){\n    in>>n>>m;\n    int x,y,w;\n    Fur(i,1,m){\n        in>>x>>y>>w;\n        add(x,y,w),add(y,x,w);\n    }\n    Fur(st,1,n)\n        Fur(sta,0,(1<<n)-1)\n            f[st][sta]=inf;\n    Fur(st,1,n)\n        Fur(sta,0,(1<<n)-1)\n            Fur(i,1,n)\n            d[st][sta][i]=inf;\n    \n    Fur(st,1,n){\n        f[st][1<<(st-1)]=0;\n        d[st][1<<(st-1)][st]=1;\n    }\n}\n#define chk(x) (sta&(1<<(x-1)))\nint main(){\n    init();\n    Fur(st,1,n)\n        Fur(sta,1,(1<<n)-1)\n        if(f[st][sta]!=inf){\n            Fur(x,1,n)\n            if(chk(x)){\n                fl(i,x)\n                if(!chk(to)){\n                    int ne=sta|(1<<(to-1));\n                    if(f[st][sta]+d[st][sta][x]*e[i].w<f[st][ne]){\n                        f[st][ne]=f[st][sta]+d[st][sta][x]*e[i].w;\n                        Fur(j,1,n)\n                            d[st][ne][j]=d[st][sta][j];\n                        d[st][ne][to]=d[st][sta][x]+1;\n                    }\n                }\n            }\n        }\n    int ans=inf;\n    Fur(st,1,n)ans=MIN(ans,f[st][(1<<n)-1]);\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 3959 \u5b9d\u85cf/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u72b6\u538bdp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1074 \u9776\u5f62\u6570\u72ec", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1074&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1074\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint a[10][10],bl[10][10];\nbool h[10][10],l[10][10],block[10][10];\nint belong(int x,int y){\n    int p=(x-1)/3+1,q=(y-1)/3+1;\n    return (p-1)*3+q;\n}\nvoid add(int i,int j,int k){\n    l[i][k]^=1;\n    h[j][k]^=1;\n    block[bl[i][j]][k]^=1;\n}\nil bool chk(int x,int y,int k){\n    return !(l[x][k]||h[y][k]||block[bl[x][y]][k]);\n}\nint ans=-1;\nil int point(int i,int j){\n    if(i==1||j==1||i==9||j==9)return 6;\n    if(i==2||j==2||i==8||j==8)return 7;\n    if(i==3||j==3||i==7||j==7)return 8;\n    if(i==4||j==4||i==6||j==6)return 9;\n    return 10;\n}\nil void op(){\n    int res=0;\n    Fur(i,1,9)Fur(j,1,9)res+=a[i][j]*point(i,j);\n    ans=MAX(ans,res);\n}\nvoid fil();\nvoid dfs(int x,int y){\n    if(a[x][y]){\n        if(x==9&&y==9){op();return;}\n        if(y==9)dfs(x+1,1);\n        else dfs(x,y+1);\n    }\n    else\n    Fdr(i,9,1)\n    if(chk(x,y,i)){\n        a[x][y]=i;\n        add(x,y,i);\n        if(x==9&&y==9){op();return;}\n        if(y==9)dfs(x+1,1);\n        else dfs(x,y+1);\n        add(x,y,i);\n        a[x][y]=0;\n    }\n}\nint main(){\n    Fur(i,1,9)\n        Fur(j,1,9)\n        bl[i][j]=belong(i,j);\n\n    Fur(i,1,9)  \n        Fur(j,1,9){\n            cin>>a[i][j];\n            if(a[i][j])add(i,j,a[i][j]);\n        }\n\n    dfs(1,1);\n\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG 1074 \u9776\u5f62\u6570\u72ec/", "tags": ["\u641c\u7d22"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2511 [HAOI2008]\u6728\u68cd\u5206\u5272", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2511&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2511\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u4e8c\u5206\u51fa\u6700\u5927\u4e00\u6bb5\u7684\u6700\u5c0f\u503c,\u7136\u540e$dp$\u627e\u51fa\u65b9\u6848\u6570\n\n\u8bbe$f[i][j]$\u8868\u793a\u524d$j$\u4e2a\u5206\u6210$i$\u7ec4\u7684\u65b9\u6848\u6570,\u6c42\u51fa\u7684\u6700\u5c0f\u503c\u4e3a$x$\n\n$f[i][j] = \\sum(f[i-1][k])(S_j-S_k \\le x,k \\le j-1)$\n\n$\\Theta(n^3m)$\u5f53\u7136\u4f1a$TLE$\n\n\u6211\u4eec\u53d1\u73b0\u53ea\u8981\u627e\u5230\u6700\u5c0f\u7684$k$\u4e4b\u540e$[k,j-1]$\u90fd\u662f\u5408\u6cd5\u7684\n\n\u8fd9\u65f6\u6211\u4eec\u5c31\u53ef\u4ee5\u524d\u7f00\u548c\u4f18\u5316$dp$\n\n\u8bbe$sum[i][j] = \\sum_{k=0}^j f[i][k]$\n\n$f[i][j]=sum[i-1][j-1] - sum[i-1][k-1]$\n\n\u53ef\u662f$\\Theta(n^2m)$\u8fd8\u662f$TLE$\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u9884\u5904\u7406\u51fa\u7b2c\u4e00\u4e2a$S_j-S_k \\le x$\u7684$k$\n\n\u56e0\u4e3a$S_i$\u5177\u6709\u5355\u8c03\u6027,\u6240\u4ee5$k$\u4e0d\u9700\u8981\u6bcf\u6b21\u90fd\u91cd\u65b0\u679a\u4e3e\n\n~~\u8fd8\u6ca1\u7ed3\u675f~~\n\n\u56e0\u4e3a$f[i][j]$\u6bcf\u6b21\u66f4\u65b0\u7684\u65f6\u5019\u53ea\u9700\u8981\u7528\u5230$f[i-1][...]$\u8fd9\u4e00\u7ef4,\u6211\u4eec\u53ef\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\u6eda\u6389\u6570\u7ec4\u7684\u4e00\u7ef4\n\n\u4f46\u662f$\\Theta(nm+n \\log \\sum L_i)$\u7684\u590d\u6742\u5ea6\u8fd8\u662f\u89c9\u5f97\u5f88\u60ac\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 50011\n#define mod 10007\nint n,m,a[N];\nil int mo(int x){\n    if(x>=mod)x-=mod;\n    return x;\n}\nil bool chk(int w){\n    int s=0,t=0;\n    Fur(i,1,n){\n        s+=a[i];\n        if(s>w){\n            s=a[i],++t;\n            if(t>m+1)return 0;\n        }\n    }\n    if(s)++t;\n    if(t>m+1)return 0;\n    return 1;\n}\nint f[N],s[N],S[N],pre[N];\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    int l=0,r=0,ans=0;\n    Fur(i,1,n)\n        in>>a[i],\n        l=MAX(l,a[i]),\n        S[i]=S[i-1]+a[i];\n    \n    r=S[n];\n    while(l<=r){\n        int mid=(l+r)>>1;\n        if(chk(mid))ans=mid,r=mid-1;\n        else l=mid+1;\n    }\n    out<<ans<<\" \";\n\n    int k=0,res=(S[n]<=ans);\n    Fur(i,1,n){\n        while(S[i]-S[k]>ans)++k;\n        pre[i]=k;\n    }\n    Fur(j,1,n)\n        f[j]=(S[j]<=ans),\n        s[j]=mo(s[j-1]+f[j]);\n\n    Fur(i,2,m+1){\n        Fur(j,1,n){\n            f[j]=s[j-1];\n            if(pre[j]-1>=0)f[j]=mo(f[j]-s[pre[j]-1]+mod);\n        }\n        Fur(j,1,n)\n            s[j]=mo(s[j-1]+f[j]);\n        res=mo(res+f[n]);\n    }\n    \n    out<<res<<ln;\n}\n```\n", "link": "/posts/LG 2511 [HAOI2008]\u6728\u68cd\u5206\u5272/", "tags": ["\u4e8c\u5206", "\u52a8\u6001\u89c4\u5212", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2620 \u866b\u6d1e", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2620&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2620\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u79bb\u6563\u5316 \u5efa\u56fe \u6700\u77ed\u8def\n\n~~\u70e6\u6b7b\u4e86~~\n\n<!-- more -->\n\n```cpp\n#include <bits/stdc++.h>\n#define r(x) scanf(\"%d\",&x)\nconst int I=50;\nusing namespace std;\nset<int>s;\nint w,st,p,c;\nint l[I*2],x[I],y[I];\nint d[I*2][I*2];\nint F(int b,int e){\n    if(b==e)return 0;\n    if(s.count(b))return 0x3fffffff;\n    int k=e;\n  for(int i=1;i<=p;i++)\n      if(b<x[i]&&x[i]<k&&(x[i]-b)%st==0)k=x[i];\n  while(k!=e&&s.count(k))k--;\n  if(k==b)return 0x3fffffff;\n  return F(k,e)+(k-b+st-1)/st;\n}\nint Q(int x) {\n  return lower_bound(l+1,l+c+1,x)-l;\n}\nvoid Floyd(){\n  for(int k=1;k<=c;k++)\n  for(int i=1;i<=c;i++)\n  for(int j=1;j<=c;j++)\n      d[i][j]=min(d[i][j],d[i][k]+d[k][j]);\n}\nint main(){\n  r(w);\n  while(w!=0){\n      r(st);r(p);\n      s.clear();\n      memset(l,0,sizeof l);\n      memset(x,0,sizeof x);\n      memset(y,0,sizeof y);\n      c=0;\n      l[++c]=0;l[++c]=w;\n      for(int i=1;i<=p;i++)\n          r(x[i]),r(y[i]),s.insert(x[i]),l[++c]=x[i],l[++c]=y[i];\n      sort(l+1,l+c+1);\n      c=unique(l+1,l+c+1)-l-1;\n      memset(d,0x3f,sizeof d);\n      for(int i=1;i<=p;i++)\n          d[Q(x[i])][Q(y[i])]=0;\n      for(int i=1;i<c;i++)\n      for(int j=i+1;j<=c;j++)   \n          d[i][j]=min(d[i][j],F(l[i],l[j]));\n      Floyd();\n      cout<<d[1][c]<<endl;\n      r(w);\n  }\n}\n```\n", "link": "/posts/LG 2620 \u866b\u6d1e/", "tags": ["\u6700\u77ed\u8def"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1042F Leaf-Sets", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1042F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1042F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6309\u6bcf\u4e2a\u70b9\u8003\u8651\n\n\u5148\u628a\u5b83\u7684\u5b50\u6811\u6309(\u5206\u5269\u4e0b\u7684\u8282\u70b9)\u6700\u5927\u6df1\u5ea6\u6392\u5e8f\n\n\u628a\u76f8\u90bb\u4e24\u4e2a\u52a0\u8d77\u6765\u5c0f\u4e8e$k$\u7684\u5206\u6210\u4e00\u5757,\u5176\u4ed6\u7684\u5355\u72ec\u5206\u4e00\u5757\n\n[luogu\u5199\u7684\u6bd4\u6211\u8fd8\u597d\u7684\u9898\u89e3](https://www.luogu.org/blog/user9012/solution-cf1042f)\n\n> \u96be\u9053\u8fd9\u5c31\u662f\u4f60AK\u7684\u501f\u53e3?\n> \n> \u5982\u679c\u8ba9\u4f60\u91cd\u65b0\u6765\u8fc7,\n> \n> \u4f60\u4f1a\u4e0d\u4f1a\u7206\u96f6?\n> \n> \u5361\u5e38\u8ba9\u4eba\u62e5\u6709\u5feb\u4e50\n> \n> \u4e5f\u4f1a\u5e26\u6765\u6298\u78e8\n> \n> \u66fe\u7ecf\u548c\u4f60\u4e00\u8d77\u8d70\u8fc7\n> \n> \u4f20\u8bf4\u4e2d\u7684oj\n> \n> \u5df2\u7ecf\u88ab\u6211RE\u6df9\u6ca1\n> \n> \u53d8\u6210\u75db\u82e6\u7684WA\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1000011\nint n,k,cnt=0,ans=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint dfs(int x,int f){\n    if(!e[head[x]].nxt)return 0;\n    vector<int>t;\n    fl(i,x)if(to!=f)t.push_back(dfs(to,x)+1);\n    sort(t.begin(),t.end());\n    for(int i=t.size()-1;i>=1;--i){\n        if(t[i]+t[i-1]<=k)return t[i];\n        ++ans;\n    }\n    return t[0];\n}\nint main(){\n    in(n,k);\n    int x,y;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    Fur(i,1,n)if(e[head[i]].nxt){dfs(i,0);break;}\n    printf(\"%d\\n\",ans+1);\n}\n```\n", "link": "/posts/LG CF1042F Leaf-Sets/", "tags": ["\u8d2a\u5fc3", "dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3488 [POI2009]LYZ-Ice-Skates", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3488&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3488\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe\u9009\u533a\u95f4$[l,r]$,\u8981\u7a7f$x$\u53f7\u7684\u4eba\u6570\u4e3a$f(x)$\n\n\u5fc5\u987b\u6ee1\u8db3 $\\sum_{i=l}^{r}f(i) \\le (r-l+1+d) \\times k$\n\n$\\sum_{i=l}^{r}(f(i)-k) \\le kd$\n\n\u90a3\u4e48\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u5168\u5c40\u6700\u5927\u5b50\u6bb5\u548c\u5c31\u53ef\u4ee5\u4e86\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 500011\n#define int ll\n#define ls rt<<1\n#define rs rt<<1|1\nint n,m,k,d,s[N<<2],S[N<<2],sl[N<<2],sr[N<<2];\nvoid pu(int rt){\n\tS[rt]=S[ls]+S[rs];\n\ts[rt]=MAX(MAX(s[ls],s[rs]),sr[ls]+sl[rs]);\n\tsl[rt]=MAX(sl[ls],S[ls]+sl[rs]);\n\tsr[rt]=MAX(sr[rs],S[rs]+sr[ls]);\n}\nvoid build(int l,int r,int rt){\n\tif(l==r){\n\t\ts[rt]=sl[rt]=sr[rt]=S[rt]=-k;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tbuild(l,m,ls);build(m+1,r,rs);\n\tpu(rt);\n}\nvoid upd(int x,int v,int l,int r,int rt){\n\tif(l==r){\n\t\ts[rt]=sl[rt]=sr[rt]=S[rt]=s[rt]+v;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tif(x<=m)upd(x,v,l,m,ls);\n\telse upd(x,v,m+1,r,rs);\n\tpu(rt);\n}\nsigned main(){\n\tin>>n>>m>>k>>d;\n\tint x,y;\n\tbuild(1,n,1);\n\twhile(m--){\n\t\tin>>x>>y;\n\t\tupd(x,y,1,n,1);\n\t\tif(s[1]<=k*d)out<<\"TAK\\n\";\n\t\telse out<<\"NIE\\n\";\n\t}\n}\n```\n", "link": "/posts/LG 3488 [POI2009]LYZ-Ice-Skates/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2501 [HAOI2006]\u6570\u5b57\u5e8f\u5217", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2501&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2501\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7b2c\u4e00\u95ee\uff1a\n\n\u6570\u5217\u4e2d\u80af\u5b9a\u6709\u4e9b\u662f\u5408\u6cd5\u7684,\u6709\u4e9b\u662f\u4e0d\u5408\u6cd5\u7684\n\n\u5982\u679c$a_i-a_j < j-i$\u5c31\u65e0\u6cd5\u540c\u65f6\u4fdd\u7559\u4e24\u8005\n\n\u90a3\u4e48$a_i-a_j \\ge j-i$\n\n\u6240\u4ee5$a_i-i < a_j-j$\n\n\u8bbe$b_i = a_i -i$\n\n$b$\u7684\u6700\u957f\u4e0d\u4e0b\u964d\u5b50\u5e8f\u5217\u957f\u5ea6\u5c31\u662f\u6700\u591a\u80fd\u4fdd\u7559\u4e2a\u6570\n\n\u7b2c\u4e8c\u95ee\uff1a\n\n\u628a$a$\u53d8\u6210\u4e25\u683c\u5355\u8c03\u4e0a\u5347\u7b49\u540c\u4e8e\u628a$b$\u53d8\u6210\u5355\u8c03\u4e0d\u964d\n\n\u5509,\u5b9e\u5728\u4e0d\u4f1a\n\nhttps://pan.baidu.com/share/link?uk=2651016602&shareid=1490516411\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define inf 1000000000\n#define ll long long\nusing namespace std;\nint gi(){\n\tint x=0,f=1;char ch=getchar();\n\twhile(ch<'0'||ch>'9'){if(ch=='-')f=-1;ch=getchar();}\n\twhile(ch>='0'&&ch<='9'){x=x*10+ch-'0';ch=getchar();}\n\treturn x*f;\n}\nint n,L,cnt;\nint a[35005],mn[35005];\nint f[35005],last[35005];\nll g[35005],s1[35005],s2[35005];\nstruct list{int to,next;}e[35005];\nvoid insert(int u,int v){\n\te[++cnt].to=v;e[cnt].next=last[u];last[u]=cnt;\n}\nvoid dp(){\n\tmemset(mn,127,sizeof(mn));\n\tmn[0]=-1<<30;\n\tfor(int i=1;i<=n;i++){\n\t\tint t=upper_bound(mn+1,mn+L+1,a[i])-mn;\n\t\tf[i]=t;\n\t\tL=max(L,t);\n\t\tmn[t]=min(mn[t],a[i]);\n\t}\n}\nvoid solve(){\n\tfor(int i=n;i>=0;i--){\n\t\tinsert(f[i],i);\n\t\tg[i]=1LL<<60;\n\t}\n\tg[0]=0;a[0]=-1<<30;\n\tfor(int x=1;x<=n;x++)\n\t\tfor(int i=last[f[x]-1];i;i=e[i].next){\n\t\t\tint p=e[i].to;\n\t\t\tif(p>x)break;\n\t\t\tif(a[p]>a[x])continue;\n\t\t\tfor(int j=p;j<=x;j++)\n\t\t\t\ts1[j]=abs(a[p]-a[j]),s2[j]=abs(a[x]-a[j]);\n\t\t\tfor(int j=p+1;j<=x;j++)\n\t\t\t\ts1[j]+=s1[j-1],s2[j]+=s2[j-1];\n\t\t\tfor(int j=p;j<x;j++)\n\t\t\t\tg[x]=min(g[x],g[p]+s1[j]-s1[p]+s2[x]-s2[j]);\n\t\t}\n}\nint main(){\n\tn=gi();\n\tfor(int i=1;i<=n;i++)a[i]=gi()-i;\n\ta[++n]=1<<30;\n\tdp();\n\tsolve();\n\tprintf(\"%d\\n%lld\\n\",n-f[n],g[n]);\n\treturn 0;\n}\n```\n", "link": "/posts/LG 2501 [HAOI2006]\u6570\u5b57\u5e8f\u5217/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1225 \u4f59\u6570\u4e4b\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint main(){\n\tll n,ans,mod=1000000007;in>>n;\n\tans=n%mod*n%mod;\n\tfor(ll l=1,r=0;l<=n;l=r+1){\n\t\tr=n/(ll)(n/l);\n\t\tans-=((n/l)%mod*(r-l+1)%mod*(l+r)%mod*500000004%mod)%mod;\n\t\twhile(ans<=mod)ans+=mod;\n\t\tans%=mod;\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/51nod 1225 \u4f59\u6570\u4e4b\u548c/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1495 \u4e2d\u56fd\u597d\u533a\u95f4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bb0\u5f55$S_i$\u8868\u793a$[1,i]$\u4e2d\u5927\u4e8e\u7b49\u4e8e$T$\u7684\u4e2a\u6570\n\n\u5f53$[L,R]$\u6ee1\u8db3\u8981\u6c42\u65f6,$S_R - S_{L-1} \\ge k$\n\n\u5982\u679c$[L,R]$\u6ee1\u8db3\u8981\u6c42$[1...L,R]$\u90fd\u6ee1\u8db3\u8981\u6c42\n\n\u4e8e\u662f\u6211\u4eec\u5c31\u53ef\u4ee5\u7528$two\\ pointer$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10000011\n#define int ll\nint n,s[N],T,k,b,c,p,a;\nsigned main(){\n\tcin>>n>>k>>T>>a>>b>>c>>p;\n\tFur(i,1,n){\n\t\ta=(a*b+c)%p; \n\t\ts[i]=s[i-1]+(a>=T);\n\t}\n\tint l=1,r=k,ans=0;\n\twhile(1){\n\t\twhile(r<=n&&s[r]-s[l-1]<k)++r;\n\t\tif(r>n)break;\n\t\tans+=n-r+1;\n\t\t++l;\n\t}\n\t\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/51nod 1495 \u4e2d\u56fd\u597d\u533a\u95f4/", "tags": ["\u53cc\u6307\u9488"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4284 [SHOI2014]\u6982\u7387\u5145\u7535\u5668", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4284&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4284\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6811\u5f62dp\u4e2d\u7684$\\text{up and down}$\n\n\u8fd8\u6709\u4e00\u70b9\u671f\u671b\n\n\u8bbe\u6bcf\u4e2a\u70b9\u80fd\u591f\u901a\u7535\u7684\u6982\u7387\u4e3a$P_i$\n\n\u90a3\u4e48$ans = \\sum_{i=1}^n P_i$\n\n**\u6211\u4eec\u5148\u8003\u8651$up$(\u53ea\u8003\u8651\u5b50\u6811))**\n\n\u5206\u6210\u4e24\u79cd\u60c5\u51b5\uff1a\n\n1. \u76f4\u63a5\u901a\u7535 : $q_i$\n   \n2. \u88ab\u5b50\u8282\u70b9\u901a\u7535 : \n   \n   $(1-q_i) \\times P_{to}(\\text{\u5b50\u8282\u70b9}) \\times e_i.w(\\text{\u8fde\u63a5\u7684\u8fb9\u5bfc\u7535\u7684\u6982\u7387})$\n   \n**\u6211\u4eec\u518d\u8003\u8651$down$(\u8003\u8651\u5b50\u6811\u5916))**\n\n\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7\u7236\u8282\u70b9\u7684\u7b54\u6848\u6765\u66f4\u65b0\u5b50\u8282\u70b9\n\n\u7236\u8282\u70b9\u7684\u7b54\u6848\u662f\u5305\u62ec\u5f53\u524d\u5b50\u8282\u70b9\u7684\n\n\u53ef\u4ee5\u628a\u8fd9\u90e8\u5206\u9664\u53bb\u7136\u540e\u6309\u7167$up$\u7684\u65b9\u6cd5\u66f4\u65b0\n\n$P_x= P_x' (1-P_x')*(P_{to}*e_i.w)$($P_x'$\u6307\u6839\u8282\u70b9\u9664\u53bb\u5f53\u524d\u5b50\u8282\u70b9\u7684\u8d21\u732e\u7684\u7b54\u6848)\n\n\u6574\u7406\u5f97\uff1a\n$$P_x'=\\frac{P_x-(P_{to} \\times e_i.w)}{1-(P_{to} \\times e_i.w)}$$\n\n(\u8fd9\u91cc\u6709\u4e2a\u5751\u70b9:\u5f53$1-(P_{to} \\times e_i.w) = 0$\u65f6\u8fd9\u4e2a\u5f0f\u5b50\u5c31\u6ca1\u6709\u610f\u4e49\u4e86)\n\n$\\therefore P_{to} = P_{to} + (1-P_{to}) \\times P_x' \\times e_i.w$\n\n\u6240\u4ee5\u5728\u4e0b\u63a8\u7684\u65f6\u5019\u8981\u7279\u5224\u4e00\u4e0b\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 500011\nint n,cnt=0,head[N],d[N];\nstruct edge{\n    int to,nxt;\n    db w;\n}e[N*2];\nil void add(int x,int y,db w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\ndb s[N],ans=0;\nvoid up(int x){\n    fl(i,x)if(!d[to]){\n        d[to]=d[x]+1;\n        up(to);\n        db t=s[to]*e[i].w;\n        s[x]+=(1-s[x])*t;\n    }\n}\n#define eps 1e-7\nil bool chk(db x){return x+eps>1.0&&x-eps<1.0;}\nvoid down(int x){\n    ans+=s[x];\n    fl(i,x)if(d[to]>d[x]){\n        if(!chk(s[to]*e[i].w)){\n            db t=(s[x]-s[to]*e[i].w)/(1.0-s[to]*e[i].w)*e[i].w;\n            s[to]+=(1-s[to])*t;\n        }\n        down(to);\n    }\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    int x,y,w;\n    Fur(i,1,n-1)in>>x>>y>>w,add(x,y,(db)w*0.01),add(y,x,(db)w*0.01);\n    Fur(i,1,n)in>>x,s[i]=(db)x*0.01;\n    d[1]=1;\n    up(1);\n    down(1);\n    printf(\"%.6f\\n\",ans);\n}\n```\n", "link": "/posts/LG 4284 [SHOI2014]\u6982\u7387\u5145\u7535\u5668/", "tags": ["\u6811\u5f62dp", "\u671f\u671b"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4513 \u5c0f\u767d\u901b\u516c\u56ed", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4513&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4513\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\n#include<ctype.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #pragma GCC target(\"sse,sse2\")\n    #define il inline\n    #define rg register\n    #define ll long long\n    #define db double\n    #define sht short\n    #define MB template <class T>\n    #define Fur(i,x,y) for(rg int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(rg int i=x;i>=y;i--)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define l2(n) (int(log2(n)))\n    #define inf 2000000000\n    #define fl(i,x) for(rg int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define fcin ios::sync_with_stdio(false)\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>=y?x:y;}\n    MB T MIN(T x,T y){return x<=y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    void SWAP(int &x,int &y){x^=y;y^=x;x^=y;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 50011\nint n,q,s[N<<2],S[N<<2],L[N<<2],R[N<<2];\nstruct tr{int s,S,L,R;}t[N<<2];\n#define Z int m=(l+r)>>1\n#define ls rt<<1\n#define rs rt<<1|1\nvoid pu(int rt){\n    t[rt].s=t[ls].s+t[rs].s;\n    t[rt].S=MAX(MAX(MAX(t[ls].R,t[rs].L),t[ls].R+t[rs].L),MAX(t[ls].S,t[rs].S));\n    t[rt].L=MAX(t[ls].L,t[ls].s+t[rs].L);t[rt].R=MAX(t[rs].R,t[rs].s+t[ls].R);\n}\nvoid build(int l,int r,int rt){\n    if(l==r){\n        in>>t[rt].s;t[rt].L=t[rt].R=t[rt].S=t[rt].s;\n        return;\n    }\n    Z;\n    build(l,m,ls);build(m+1,r,rs);\n    pu(rt);\n}\nvoid upd(int x,int v,int l,int r,int rt){\n    if(l==r){t[rt].s=t[rt].S=t[rt].R=t[rt].L=v;return;}\n    Z;\n    if(x<=m)upd(x,v,l,m,ls);\n    else upd(x,v,m+1,r,rs);\n    pu(rt);\n}\ntr ask(int x,int y,int l,int r,int rt){\n    if(x<=l&&r<=y)return t[rt];\n    Z;\n    if(x>m)return ask(x,y,m+1,r,rs);\n    if(y<=m)return ask(x,y,l,m,ls);\n    tr ans,a=ask(x,y,l,m,ls),b=ask(x,y,m+1,r,rs);\n    ans.s=a.s+b.s;\n    ans.S=MAX(MAX(MAX(a.R,b.L),a.R+b.L),MAX(a.S,b.S));\n    ans.L=MAX(a.L,a.s+b.L);ans.R=MAX(b.R,b.s+a.R);\n    return ans;\n}\nint main(){\n    fin(\"in\");\n    in>>n>>q;\n    build(1,n,1);\n    while(q--){\n        int u,l,r;in>>u>>l>>r;\n        if(l>r)SWAP(l,r);\n        if(u==1)out<<ask(l,r,1,n,1).S<<ln;\n        else upd(l,r,1,n,1);\n    }\n}\n```\n", "link": "/posts/LG 4513 \u5c0f\u767d\u901b\u516c\u56ed/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2070 \u5237\u5899", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2070&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2070\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\nint n;\nstruct node{\n\tint l,r;\n}a[N];\nbool cmp(node x,node y){\n\treturn x.l<y.l;\n}\nint main(){\n\tint x=0,t,ans=0;\n\tin>>n;\n\tchar ch;\n\tFur(i,1,n){\n\t\tin>>t>>ch;\n\t\tif(ch=='L')a[i]=(node){x-t,x},x-=t;\n\t\telse a[i]=(node){x,x+t},x+=t;\n\t}\n\tsort(a+1,a+n+1,cmp);\n\tint la=-inf;\n\tx=a[1].r;\n\tFur(i,2,n)\n\tif(x>=a[i].l){\n\t\tif(MIN(a[i].r,x)-MAX(la,a[i].l)>0)\n\t\t\tans+=MIN(a[i].r,x)-MAX(la,a[i].l),\n\t\t\tla=MIN(a[i].r,x);\n\t\tx=MAX(x,a[i].r);\n\t}\n\telse x=MAX(x,a[i].r);\n\tout<<ans<<ln;\n\t\n}\n```\n", "link": "/posts/LG 2070 \u5237\u5899/", "tags": ["\u524d\u7f00\u548c", "\u5dee\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1450 [HAOI2008]\u786c\u5e01\u8d2d\u7269", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1450&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1450\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u8003\u8651\u6bcf\u79cd\u786c\u5e01\u53ef\u4ee5\u7528\u65e0\u6570\u6b21\n\n\u8bbe$f_i$\u8868\u793a\u91d1\u989d\u4e3a$i$\u6709\u591a\u5c11\u79cd\u65b9\u6848\n\n$f_i = \\sum_{j=1}^4 f_{i-c[j](i \\ge c_j)}$\n\n\u6211\u4eec\u518d\u6765\u8003\u8651\u786c\u5e01\u4f7f\u7528\u6b21\u6570\u6709\u9650\u5236\u600e\u4e48\u529e\n\n> \u4e0d\u5408\u6cd5\u7684\u60c5\u51b5\u6709:\n>\n> 1\u8d85\u989d\n>\n> 1,2\u8d85\u989d\n>\n> 1,3\u8d85\u989d\n>\n> 1,4\u8d85\u989d\n>\n> 1,2,3\u8d85\u989d\n>\n> 1,2,4\u8d85\u989d\n>\n> 1,3,4\u8d85\u989d\n>\n> 1,2,3,4\u8d85\u989d\n>\n> ...\n>\n> \u8981\u6ce8\u610f\u7684\u662f\u5728\u591a\u79cd\u786c\u5e01\u9650\u5236\u7684\u60c5\u51b5\u4e0b\u53ef\u80fd\u4f1a\u51cf\u53bb\u591a\u6b21,\u6216\u52a0\u4e0a\u591a\u6b21\n>\n> \u6bd4\u59821\u8d85\u989d,2\u8d85\u989d,\uff081,2\u540c\u65f6\u8d85\u989d\u88ab\u51cf\u53bb\u4e24\u6b21,\u8fd9\u662f\u5c31\u8981\u52a0\u56de\u6765\n>\n> \u800c$(1,2,3)$ \u3001$(1,2,4)$\u53c8\u662f\u591a\u7b97\u7684...\n\n\u662f\u4e0d\u662f\u66f4\u76f4\u89c2\u7684\u4e86\u89e3\u4e86\u5bb9\u65a5\uff1f\n\n\u4e3a\u4e86\u65b9\u4fbf,\u6211\u4eec\u53ef\u4ee5\u679a\u4e3e\u4e8c\u8fdb\u5236\u4e0b\u72b6\u6001\u6765\u66f4\u52a0\u4f18\u7f8e\u5b9e\u73b0\u3002\n\n(\u5f53\u6709\u5947\u6570\u79cd\u4e0d\u5408\u6cd5\u7684\u65f6\u5019\u51cf\u53bb,\u5076\u6570\u79cd\u4e0d\u5408\u6cd5\u65f6\u52a0\u4e0a)\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,c[5],d[5],s;\nll f[N];\nint main(){\n    Fur(i,1,4)in(c[i]);\n    f[0]=1;\n    Fur(i,1,4)\n        Fur(j,c[i],100000)\n            f[j]+=f[j-c[i]];\n    \n    in(n);\n    while(n--){\n        Fur(i,1,4)in(d[i]);\n        in(s);\n        ll ans=f[s];\n        Fur(i,1,15){\n            int t=s,sta=i,k=1;\n            Fur(j,1,4)\n            if(sta&(1<<(j-1))){\n                k=-k;\n                t-=(d[j]+1)*c[j];\n            }\n            if(t>=0)ans+=1ll*f[t]*k;\n        }\n        out(ans,ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 1450 [HAOI2008]\u786c\u5e01\u8d2d\u7269/", "tags": ["\u80cc\u5305", "\u52a8\u6001\u89c4\u5212", "\u5bb9\u65a5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF741D Arpa\u2019s letter-marked tree and Mehrdad\u2019s Dokhtar-kosh paths", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF741D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF741D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u597d\u9898\uff01\n\n\u91cd\u65b0\u6392\u5e8f\u540e\u80fd\u53d8\u6210\u56de\u6587\u4e32,\u51fa\u73b0\u6b21\u6570\u4e3a\u5947\u6570\u7684\u5b57\u6bcd\u6700\u591a\u53ea\u80fd\u6709\u4e00\u79cd\n\n\u56e0\u4e3a\u53ea\u6709$22$\u79cd\u5b57\u7b26\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u7528\u72b6\u6001\u538b\u7f29\u6765\u8bb0\u5f55\u6bcf\u79cd\u5b57\u6bcd\u51fa\u73b0\u7684\u6b21\u6570\u662f\u5947\u6570\u6216\u8005\u5076\u6570\n\n\u8bbe\u8def\u5f84\u7aef\u70b9\u7684\u4e24\u7aef\u4e3a$x,y$,$d_x$\u8868\u793a1~x\u6240\u6709\u72b6\u6001\u7684\u5f02\u6216\u503c,$D_x$\u8868\u793a$x$\u7684\u6df1\u5ea6\n\n\u90a3\u4e48\u5982\u679c\u8fd9\u6761\u8def\u5f84\u6ee1\u8db3\u6761\u4ef6,\u5219$d_x \\oplus d_y$\u5728\u4e8c\u8fdb\u5236\u4e0b\u6700\u591a\u53ea\u6709\u4e00\u4e2a$1$\n\n\u5b83\u7684\u957f\u5ea6\u4e3a$D_x + D_y - 2 \\times D_{lca(x,y)}$\n\n\u6211\u4eec\u53ef\u4ee5\u5f00\u4e00\u4e2a\u6876\u6765\u8bb0\u5f55\u6bcf\u79cd\u72b6\u6001\u51fa\u73b0\u7684\u6700\u6df1\u7684\u4f4d\u7f6e\u662f\u54ea\u91cc\n\n\u8bbe$sta$\u4e3a\u6ee1\u8db3\u6761\u4ef6\u7684\u72b6\u6001\n\n\u7528\u6bcf\u4e2a\u5e97\u66f4\u65b0\u7b54\u6848\u7684\u65f6\u5019\u5c31$ans=\\max(ans,b[sta \\oplus d_x] + D_x - 2 \\times D_{lca})$\n\n\u63a5\u4e0b\u6765\u5c31\u6309\u9759\u6001\u94fe\u5206\u6cbb\u7684\u5957\u8def\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4e86\n\n\u590d\u6742\u5ea6: $\\Theta( n \\log n)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 500011\nint n,d[N],siz[N],son[N],D[N];\nint cnt=0,head[N];\nstruct edge{\n    int to,nxt,w;\n}e[N];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x){\n        d[to]=d[x]^e[i].w;D[to]=D[x]+1;\n        dfs(to);siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nint b[1<<22],ans=0,sta[23],lca;\nvoid Add(int x){\n    Fur(i,0,22)\n        ans=MAX(ans,D[x]+b[sta[i]^d[x]]-2*D[lca]);\n    b[d[x]]=MAX(b[d[x]],D[x]);\n}\nvoid upd(int x){\n    Add(x);\n    fl(i,x)upd(to);\n}\nvoid dde(int x){\n    b[d[x]]=-inf;\n    fl(i,x)dde(to);\n}\nint ANS[N];\nvoid sol(int x){\n    fl(i,x)if(to!=son[x]){\n        sol(to);\n        // dde(to);\n        clr(b,128);\n        ans=0;\n        ANS[x]=MAX(ANS[x],ANS[to]);\n    }\n    if(son[x])sol(son[x]),ANS[x]=MAX(ANS[x],ANS[son[x]]);\n    lca=x;\n    Add(x);\n    fl(i,x)if(to!=son[x])upd(to);\n    ANS[x]=MAX(ANS[x],ans);\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    int x;char w;\n    Fur(i,2,n)in>>x>>w,add(x,i,(1<<(w-'a')));\n    dfs(1);\n    sta[0]=0;\n    Fur(i,1,22)sta[i]=(1<<(i-1));\n    sol(1);\n    Fur(i,1,n)out<<ANS[i]<<\" \";\n}\n```\n", "link": "/posts/LG CF741D Arpa\u2019s letter-marked tree and Mehrdad\u2019s Dokhtar-kosh paths/", "tags": ["\u9759\u6001\u94fe\u5206\u6cbb", "\u72b6\u6001\u538b\u7f29", "\u6876"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1106 \u5220\u6570\u95ee\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1106&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1106\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,k,a[257],rest,t=1,minp,cnt=0;\nbool flag=0;\nstring num;\nint main(){\n    cin>>num>>k;\n    n=num.length();\n    for(int i=1;i<=n;++i)a[i]=num[i-1]-'0';\n    rest=n-k;\n    while(cnt<rest){\n        minp=t;\n        for(int i=t;i<=k+t;++i)if(a[minp]>a[i])minp=i;\n        if(a[minp])flag=1;\n        if(flag)cout<<a[minp];\n        k-=minp-t;\n        t=minp+1;\n        cnt++;\n    }\n    if(!flag)cout<<0;\n}\n```\n", "link": "/posts/LG 1106 \u5220\u6570\u95ee\u9898/", "tags": ["\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3612 [USACO17JAN]Secret-Cow-Code\u79d8\u5bc6\u5976\u725b\u7801", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3612&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3612\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7c7b\u4f3c[Moo](https://www.luogu.org/problem/P1885)\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5b57\u7b26\u4e32\u6bcf\u6b21\u957f\u5ea6\u53d8\u6210\u539f\u6765\u7684\u4e24\u500d\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u4e4b\u524d\u4e0d\u9700\u8981\u7684\u72b6\u6001\u5220\u53bb\n\n\u4e00\u5f00\u59cb\u6309\u5957\u8def\u7528\u9012\u5f52\u5199\n\n\u7136\u540e\u7206\u6808\u4e86\n\n\u5e94\u8be5\u7528\u5faa\u73af\u5199\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 50\nchar s[N];\nint main(){\n    ll n,t;\n    in(s+1);in(n);\n    t=strlen(s+1);\n\n    while(t<n){\n        ll i=t;\n        while(n>(i<<1))i<<=1;\n        n-=(i+1);\n        if(n==0)n=i;\n    }\n    putchar(s[n]);\n}\n```\n", "link": "/posts/LG 3612 [USACO17JAN]Secret-Cow-Code\u79d8\u5bc6\u5976\u725b\u7801/", "tags": ["\u5206\u6cbb", "\u6a21\u62df"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 2717 \u5c0fBiu\u7684\u5e8f\u5217", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u679a\u4e3e\u5f53\u524d\u5408\u6cd5\u5e8f\u5217\u653e\u4e86\u591a\u5c11\u4e2a$i(2i>n)$\u7684,\u8bb0\u6570\u91cf\u4e3a$x$,\u90a3\u4e48\u5bf9\u4e8e$i(2i\\le n)$\u7684\u6570\u91cf\u4e3a$m-x$\u3002\n\n\u5bf9\u4e8e\u7b54\u6848\u7684\u8d21\u732e\u4e3a$x!\\times (m-x)!\\times {x \\times C(m-x)} \\times {C(x,\\frac{n}{2}})\\times {C({m-x},\\frac{n+1}{2}})$\n\n\uff08\u56e0\u4e3a\u7b2c\u4e8c\u7c7b\u6570\u53ea\u80fd\u653e\u5728\u7b2c\u4e00\u7c7b\u6570\u524d\u9762,\u6240\u4ee5\u4e00\u5171$x$\u4e2a\u7a7a\u653e$m-x$\u4e2a\u6570,\u65b9\u6848\u4e3a$C({m-x},x)$\n\n\u9009\u51fa$x$\u4e2a\u7b2c\u4e00\u7c7b\u6570\u548c$vm-x$\u4e2a\u7b2c\u4e8c\u7c7b\u6570\u7684\u65b9\u6848\u5206\u522b\u4e3a$C(x,\\frac{n}{2})$\u548c$C({m-x},\\frac{n+1}{2})$\n\n\u7136\u540e$x$\u4e2a\u6570\u548c$m-x$\u4e2a\u6570\u7684\u6392\u5217\u4e3a$x!$\u548c$(m-x)!$\u3002\n\n\u6240\u4ee5\u5c31\u5f97\u5230\u4e86\u8fd9\u4e2a\u8d21\u732e\u5f0f\u5b50\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nconst int mod=1000000007;\nint n,m,f[N],inv[N];\nint pw(int x,int p){\n\tint ans=1;\n\twhile(p){\n\t\tif(p&1)ans=1ll*ans*x%mod;\n\t\tp>>=1;x=1ll*x*x%mod;\n\t}\n\treturn ans;\n}\nint C(int x,int y){\n\treturn 1ll*f[x]*inv[y]%mod*inv[x-y]%mod;\n}\nint main(){\n\tcin>>n>>m;\n\tif(m>n)return out<<\"0\\n\",0;\n\tf[0]=1;Fur(i,1,1000000)f[i]=1ll*f[i-1]*i%mod;\n\tinv[1000000]=pw(f[1000000],mod-2);Fdr(i,1000000-1,0)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n\tll ans=0;\n\tFur(i,(m+1)/2,MIN((n+1)/2,m)){\n\t\tans+=1ll*f[i]%mod*f[m-i]%mod*C(i,m-i)%mod*C((n+1)/2,i)%mod*C(n/2,m-i)%mod;\n\t\tans%=mod;\n\t}\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/51nod 2717 \u5c0fBiu\u7684\u5e8f\u5217/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1038D Slime", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1038D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1038D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6709\u8da3\u7684\u9898\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u53ea\u6709\u4e00\u7ec4\u76f8\u90bb\u4e24\u6570\u53ea\u80fd\u6c42\u5dee\u7684\u7edd\u5bf9\u503c,\u5176\u4ed6\u6570\u90fd\u53ef\u4ee5\u53d6\u7edd\u5bf9\u503c\u6c42\u548c\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500011\nint n;\nll a[N],b[N];\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i]);\n    if(n==1)return cout<<a[1]<<endl,0;\n    ll ans=0,s=0;\n    Fur(i,1,n)b[i]=ABS(a[i]),s+=b[i];\n    Fur(i,1,n-1)\n        ans=MAX(ans,s-(b[i]+b[i+1])+ABS(a[i]-a[i+1]));\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG CF1038D Slime/", "tags": ["\u6570\u8bba", "\u6784\u9020", "\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3758 [TJOI2017]\u53ef\u4e50", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3758&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3758\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9898\u89e3\u5f88\u5999\n\n\u8bbe$f[i][j][k]$\u4e3a\u4ece$i$\u5230$j$\u8d70$k$\u6b65\u7684\u65b9\u6848\u6570\n\n$f[i][j]$\u8fd9\u4e2a\u77e9\u9635\u7684$k$\u6b21\u65b9\u5c31\u662f\u7b54\u6848\n\n$ans = \\sum f[1][i]$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 101\nconst int mod=2017;\nint n,m;\nstruct mat{\n    mat(){clr(a,0);}\n    int a[N][N];\n}a;\nil mat operator * (mat a,mat b){\n    mat c;\n    Fur(i,0,100)\n        Fur(j,0,100)\n            Fur(k,0,100)\n            c.a[i][j]=(c.a[i][j]+a.a[i][k]*b.a[k][j]%mod)%mod;\n    return c;\n}\nmat pw(mat x,int p){\n    mat c;\n    Fur(i,0,100)c.a[i][i]=1;\n    while(p){\n        if(p&1)c=c*x;\n        p>>=1;x=x*x;\n    }\n    return c;\n}\nint main(){\n    in(n,m);\n    int x,y;\n    Fur(i,1,m){\n        in(x,y);\n        a.a[x][y]=a.a[y][x]=1;\n    }\n    Fur(i,0,n)a.a[i][i]=1;\n    Fur(i,1,n)a.a[i][0]=1;\n    int ans=0,t;\n    in(t);\n    mat ANS=pw(a,t);\n    Fur(i,0,n)ans=(ans+ANS.a[1][i])%mod;\n    out(ans,ln);\n    flush();\n}\n```\n", "link": "/posts/LG 3758 [TJOI2017]\u53ef\u4e50/", "tags": ["floyed", "\u90bb\u63a5\u77e9\u9635", "\u77e9\u9635\u4e58\u6cd5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF613C Necklace", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF613C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF613C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n1. \u5982\u679c\u4e2a\u6570\u4e2d\u6ca1\u6709\u5947\u6570,\u90a3\u4e48\u7b54\u6848\u5c31\u662f\u6240\u6709\u6570\u5b57\u7684$gcd$,\u7136\u540e\u6784\u9020\u7b54\u6848\u5c31\u662f\u8f93\u51fa$\\frac {gcd}2$\u4e2a\u56de\u6587\u4e32\n\n2. \u5982\u679c\u4e2a\u6570\u4e2d\u53ea\u6709\u4e00\u4e2a\u5947\u6570,\u90a3\u4e48\u7b54\u6848\u4e5f\u662f\u6240\u6709\u6570\u5b57\u7684$gcd$,\u7136\u540e\u6784\u9020\u7b54\u6848\u5c31\u662f\u8f93\u51fa$gcd$\u4e2a\u56de\u6587\u4e32,\u4e2a\u6570\u4e3a\u5947\u6570\u7684\u989c\u8272\u653e\u5728\u56de\u6587\u4e32\u7684\u4e2d\u95f4\n\n3. \u5982\u679c\u4e2a\u6570\u4e2d\u6709\u4e24\u4e2a\u6216\u4ee5\u4e0a\u7684\u5947\u6570,\u90a3\u4e48\u7b54\u6848\u5c31\u662f$0$,\u56e0\u4e3a\u4e24\u4e2a\u5947\u6570\u5c31\u5df2\u7ecf\u6784\u9020\u4e0d\u51fa\u6709\u4f18\u7f8e$cut$\u7684\u73af\u6765\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define ll long long\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fcin ios::sync_with_stdio(false)\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n}using namespace ZDY;using namespace std;\n#define N 10011\nint n,a[30];\nint main(){\n\tfcin;\n\tcin>>n;\n\tint f=0,x;\n\tFur(i,1,n){cin>>a[i];if(a[i]&1)x=i,f++;}\n\tint ans=a[1];\n\tFur(i,2,n)ans=GCD(ans,a[i]);\n\tif(f>1)ans=0;\n\tcout<<ans<<endl;\n\tif(f>1){\n\t\tFur(i,1,n)while(a[i]--)cout<<char('a'-1+i);\n\t\treturn 0;\n\t}\n\tif(f){\n\t\tFur(i,1,ans)\n\t\t\tFur(j,1,n)\n\t\t\tif(j!=x)\n\t\t\t\tFur(k,1,a[j]/ans/2)cout<<char('a'-1+j);\n\t\tFur(j,1,a[x]/ans)cout<<char('a'-1+x);\n\t\tFdr(j,n,1)\n\t\tif(j!=x)\n\t\t\tFur(k,1,a[j]/ans/2)cout<<char('a'-1+j);\n\t}\n\telse{\n\t\tFur(i,1,ans/2){\n\t\t\tFur(j,1,n)\n\t\t\t\tFur(k,1,a[j]/ans)cout<<char('a'-1+j);\n\t\t\tFdr(j,n,1)\n\t\t\t\tFur(k,1,a[j]/ans)cout<<char('a'-1+j);\n\t\t}\n\t}\n}\n```\n", "link": "/posts/LG CF613C Necklace/", "tags": ["gcd", "\u6784\u9020", "\u601d\u7ef4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1027D Mouse-Hunt", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1027D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1027D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\ntarjan\u627e\u51fa\u73af \u7b54\u6848\u662f\u6bcf\u4e2a\u73af\u4e0a\u7684\u6700\u5c0f\u503c\u52a0\u8d77\u6765\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,c[N],a[N];\nint dfn[N],low[N],sz=0,bl[N],tp=0,z[N];\nbool v[N];\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;\n    z[++tp]=x;v[x]=1;\n    if(!dfn[a[x]])tarjan(a[x]),low[x]=MIN(low[x],low[a[x]]);\n    else if(v[a[x]])low[x]=MIN(low[x],dfn[a[x]]);\n\n    if(low[x]==dfn[x]){\n        while(int k=z[tp--]){\n            bl[k]=x;v[k]=0;\n            if(k==x)break;\n            c[x]=MIN(c[x],c[k]);\n        }\n    }\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(c[i]);\n    Fur(i,1,n)in(a[i]);\n    Fur(i,1,n)if(!dfn[i])tarjan(i);\n    int ans=0;\n    Fur(i,1,n)if(i==bl[i]&&bl[a[i]]==i)ans+=c[i];\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG CF1027D Mouse-Hunt/", "tags": ["\u73af", "tarjan"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1038 \u795e\u7ecf\u7f51\u7edc", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1038&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1038\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint n,m,c[N],u[N],q[N],tp=0,r[N];\nstruct edge{\n\tint to,nxt,w;\n}e[N];\nint head[N],cnt=0;\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint main(){\n\tin>>n>>m;\n\tFur(i,1,n)\n\t\tin>>c[i]>>u[i];\n\tint x,y,w;\n\tFur(i,1,m)in>>x>>y>>w,add(x,y,w),r[y]++;\n\tFur(i,1,n)\n\t\tif(!r[i]&&c[i])q[++tp]=i;\n\twhile(tp){\n\t\tx=q[tp--];\n\t\tfl(i,x){\n\t\t\tr[to]--;c[to]+=e[i].w*c[x]-u[to];\n\t\t\tif(!r[to]&&c[to])q[++tp]=to;\n\t\t}\n\t}\n\tFur(i,1,n)if(!head[i]&&c[i])out<<i<<\" \"<<c[i]<<ln;\n}\n```\n", "link": "/posts/LG 1038 \u795e\u7ecf\u7f51\u7edc/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4158 [SCOI2009]\u7c89\u5237\u5320", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4158&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4158\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 61\nint n,m,T,f[N][N][2600],g[N][2600],s[N];\nchar a[N][N];\nint main(){\n\tin>>n>>m>>T;\n\tFur(i,1,n)in>>(a[i]+1);\n\tFur(i,1,n){\n\t\tFur(j,1,m)s[j]=s[j-1]+a[i][j]-48;\n\t\tFur(j,1,m)\n\t\t\tFur(k,1,m)\n\t\t\t\tFur(q,j-1,k-1)\n\t\t\t\tf[i][j][k]=MAX(f[i][j][k],f[i][j-1][q]+MAX(s[k]-s[q],k-q-s[k]+s[q]));\n\t}\n\tFur(i,1,n)\n\t\tFur(j,1,T)\n\t\t\tFur(k,0,MIN(j,m))\n\t\t\tg[i][j]=MAX(g[i][j],g[i-1][j-k]+f[i][k][m]);\n\tint ans=0;\n\tFur(i,1,T)ans=MAX(ans,g[n][i]);\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 4158 [SCOI2009]\u7c89\u5237\u5320/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2172 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u90e8\u843d\u6218\u4e89", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2172&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2172\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u548c\u7f51\u7edc\u6d4124\u9898\u4e2d\u7684\u9a91\u58eb\u5171\u5b58\u95ee\u9898\u548c[TJOI2013]\u653b\u51fb\u88c5\u7f6e\u76f8\u4f3c\n\n\u4e0d\u8fc7\u4e0d\u80fd\u76f4\u63a5\u628a\u6240\u6709\u70b9\u62c6\u6210\u4e24\u79cd\n\n\u6211\u4eec\u8fd8\u662f\u53ef\u4ee5\u501f\u52a9\u601d\u8def\n\n\u636e\u8bf4\u8fd9\u53c8\u53eb\u201c\u7f51\u7edc\u6d41\u7684\u6700\u5c0f\u8def\u5f84\u8986\u76d6\u201d\n\n\u4e3a\u4e86\u4f7f\u6bcf\u4e2a\u70b9\u6307\u7ecf\u8fc7\u4e00\u6b21,\u6211\u4eec\u628a\u70b9\u62c6\u6210\u4e24\u4e2a\n\n\u4ece\u6e90\u70b9\u5411\u6bcf\u4e2a\u70b9\u7684\u5165\u70b9\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a$1$\u7684\u8fb9\n\n\u4ece\u6bcf\u4e2a\u70b9\u7684\u51fa\u70b9\u4e0e\u6c47\u70b9\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a$1$\u7684\u8fb9\n\n\u6bcf\u4e2a\u70b9\u7684\u5165\u70b9\u5411\u80fd\u5230\u8fbe\u7684\u70b9\u7684\u51fa\u70b9\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a1\u7684\u8fb9\n\n\u7136\u540e\u62ff\u53ef\u4ee5\u653e\u7684\u8282\u70b9\u6570-\u6700\u5927\u6d41\n\n\n\n~~\u636e\u8bf4\u8fd8\u53ef\u4ee5\u7528\u6309\u7167\u6709\u4e0a\u4e0b\u754c\u7f51\u7edc\u6d41\u5957\u8def\u5efa\u56fe\u540e\u6c42s\u5230t\u7684\u6700\u5c0f\u6d41\u505a\uff1f\uff1f\uff1f~~\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 233\nint n,head[N*N],d[N*N],q[N*N],cnt=1,st,ed,r,c,m;\nbool b[N][N];\nstruct edge{\n\tint to,nxt,w;\n}e[N*N*2];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n\te[++cnt].to=x;e[cnt].w=0;e[cnt].nxt=head[y];head[y]=cnt;\n}\nbool bfs(){\n\tint h=0,t=1;\n\tclr(d,0);\n\td[q[h]=st]=1;    \n\twhile(h<t){\n\t\tint x=q[h++];\n\t\tif(x==ed)return 1;\n\t\tfl(i,x)if(e[i].w&&!d[to]){\n\t\t\td[to]=d[x]+1;\n\t\t\tq[t++]=to;\n\t\t}\n\t}\n\treturn 0;\n}\nint dfs(int x,int mf){\n\tif(x==ed)return mf;\n\tint us=0,w;\n\tfl(i,x)\n\tif(e[i].w&&d[to]==d[x]+1){\n\t\tw=dfs(to,MIN(mf-us,e[i].w));\n\t\te[i].w-=w;e[i^1].w+=w;\n\t\tus+=w;\n\t\tif(us==mf)return mf;\n\t}\n\tif(!us)d[x]=-1;\n\treturn us;\n}\nint dinic(){\n\tint ans=0;\n\twhile(bfs())ans+=dfs(st,inf);\n\treturn ans;\n}\n#define id(x,y) ((x-1)*m+y)\nint main(){\n\tin>>n>>m>>r>>c;\n\tst=n*m*2+1;ed=n*m*2+2;\n\tint tt=0;\n\tchar ch[N];\n\tFur(i,1,n){\n\t\tin>>(ch+1);\n\t\tFur(j,1,m)\n\t\tb[i][j]=(ch[j]=='x');\n\t}\n\tint tot=4;\n\tif(r==c)tot=2;\n\tint dx[]={r,r,c,c},\n\t\tdy[]={c,-c,r,-r};\n\t\n\tFur(i,1,n)\n\t\tFur(j,1,m)\n\t\tif(!b[i][j]){\n\t\t\ttt++;\n\t\t\tadd(st,id(i,j),1);\n\t\t\tadd(id(i,j)+n*m,ed,1);\n\t\t\tFur(k,0,tot-1){\n\t\t\t\tint nx=i+dx[k],ny=j+dy[k];\n\t\t\t\tif(nx<1||nx>n||ny<1||ny>m||b[nx][ny])continue;\n\t\t\t\tadd(id(i,j),id(nx,ny)+n*m,1);\n\t\t\t}\n\t\t}\n\tout<<tt-dinic()<<ln;\n}\n```\n", "link": "/posts/LG 2172 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u90e8\u843d\u6218\u4e89/", "tags": ["\u7f51\u7edc\u6d41"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF8C Looking-for-Order", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF8C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF8C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f[x]$\u8868\u793a\u72b6\u6001\u4e3a$x$\u65f6\u6700\u5c11\u8d70\u591a\u5c11\u6b65\n\n\u679a\u4e3e\u73b0\u5728\u53d6\u54ea\u4e24\u4e2a\u70b9,\u7136\u540e\n\n$f[x|2^{i-1}|2^{j-1}]=\\min(f[x|2^{i-1}|2^{j-1}],f[x])$\n\n\u5982\u679c\u76f4\u63a5\u679a\u4e3e\u4e0d\u526a\u679d\u7684\u8bdd\u53ef\u80fd\u4f1a$TLE$\n\n\u6240\u4ee5\u6211\u4eec\u53ea\u8981\u627e\u5230\u7b2c\u4e00\u4f4d\u662f$1$\u7684,\u7136\u540e\u5f80\u540e\u9762\u679a\u4e3e\u5c31\u53ef\u4ee5\u4e86,\u56e0\u4e3a\u4e0d\u5173\u600e\u4e48\u6837\u6211\u4eec\u90fd\u8981\u628a\u5168\u90e8\u53d6\u5b8c,\u5148\u53d6\u540e\u53d6\u662f\u4e00\u6837\u7684\n\n(\u5982\u679c\u4e0d\u61c2\u53ef\u4ee5\u81ea\u5df1\u6a21\u62df\u4e00\u4e0b)\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10001\nint n;\nstruct node{\n    int x,y;\n}a[N];\nint f[1<<24];\nint d(int i,int j){\n    return (a[i].x-a[j].x)*(a[i].x-a[j].x)+(a[i].y-a[j].y)*(a[i].y-a[j].y);\n}\nint calc(int i,int j){\n    return MIN(d(0,i)+d(i,j)+d(j,0),d(0,j)+d(j,i)+d(i,0));\n}\nint main(){\n    cin>>a[0].x>>a[0].y>>n;\n    Fur(i,1,n)cin>>a[i].x>>a[i].y;\n    out<<\"23333\\n\";\n    clr(f,126);\n    f[0]=0;\n    Fur(x,0,(1<<24)-1)\n        Fur(i,1,24)\n            Fur(j,i+1,24)\n            if(!(x&(1<<(i-1)))&&!(x&(1<<(j-1)))){\n                int y=(x|(1<<(i-1)))|(1<<(j-1));\n                f[y]=MIN(f[y],f[x]+calc(i,j));\n            }\n    out<<f[(1<<24)-1]<<ln;\n}\n\n```\n", "link": "/posts/LG CF8C Looking-for-Order/", "tags": ["\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2575 \u9ad8\u624b\u8fc7\u62db", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2575&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2575\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e00\u884c\u7684$SG$\u5f02\u6216\n\n\u6bcf\u4e00\u884c\u53ea\u6709$20$\u4e2a,\u6240\u4ee5\u53ef\u4ee5\u7528\u72b6\u6001\u538b\u7f29\n\n\u53ef\u4ee5\u901a\u8fc7\u52a8\u6001\u89c4\u5212\u6216\u8bb0\u5fc6\u5316\u641c\u7d22\u7684\u65b9\u5f0f\u5904\u7406\u51fa\u6bcf\u79cd\u72b6\u6001\u7684$SG$\u503c\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,f[1<<20],a[22];\n#define lb(x) ((x)&(-(x)))\nint dfs(int x){\n    if (f[x]!=-1)return f[x];\n    int t=(x+1)-lb(x+1),k=lb(t),cnt=0,tmp;\n    while (k){\n        t^=k;tmp=k;\n        for(;(x^k)<x;k>>=1);\n        a[cnt++]=dfs(x^k^tmp);\n        k=lb(t);\n    }\n    sort(a,a+cnt);\n    if(a[0])return f[x]=0;\n    for (int i=1;i<cnt;i++)\n        if (a[i]-a[i-1]>1) return f[x]=a[i-1]+1;\n    return f[x]=a[cnt-1]+1;\n}\nint main(){\n    fin(\"in\");\n    clr(f,-1);\n    Fur(i,1,20)f[(1<<i)-1]=0;\n    Fur(i,1,(1<<20)-1)f[i]=dfs(i);\n    int T;in>>T;\n    while(T--){\n        int n,m,x,s=0,sg=0;\n        in>>n;\n        Fur(i,1,n){\n            s=0;\n            in>>m;\n            while(m--)in>>x,s|=(1<<(20-x));\n            sg^=f[s];\n        }\n        if(sg)out<<\"YES\\n\";\n        else out<<\"NO\\n\";\n    }\n}\n```\n", "link": "/posts/LG 2575 \u9ad8\u624b\u8fc7\u62db/", "tags": ["\u535a\u5f08\u8bba", "\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212", "\u8bb0\u5fc6\u5316\u641c\u7d22"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF5E Bindian Signalizing", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF5E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF5E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 2011\nint n,a[N][N],b[N][N],f[N][N],F[N][N],p[N][N],q[N][N];\nchar ans[N*N];\nint main(){\n    fin(\"in\");\n    in>>n;\n    int x,y,X=0,Y=0;\n    Fur(i,1,n)Fur(j,1,n){\n        int x;in>>x;\n        if(x==0)X=i,Y=j;\n        else{\n            while(x%2==0)a[i][j]++,x>>=1;\n            while(x%5==0)b[i][j]++,x/=5;\n        }\n    }\n    if(X){\n        out<<\"0\\n\";\n        Fur(i,1,X-1)out<<\"D\";\n        Fur(i,1,Y-1)out<<\"R\";\n        Fur(i,X+1,n)out<<\"D\";\n        Fur(i,Y+1,n)out<<\"R\";\n        return 0;\n    }\n    f[1][1]=a[1][1];\n    F[1][1]=b[1][1];\n    Fur(i,2,n){\n        f[1][i]=f[1][i-1]+a[1][i];\n        F[1][i]=F[1][i-1]+b[1][i];\n        f[i][1]=f[i-1][1]+a[i][1];p[i][1]=1;\n        F[i][1]=F[i-1][1]+b[i][1];q[i][1]=1;\n    }\n    Fur(i,2,n)\n        Fur(j,2,n){\n            if(f[i-1][j]<f[i][j-1])f[i][j]=f[i-1][j]+a[i][j];\n            else p[i][j]=1,f[i][j]=f[i][j-1]+a[i][j];\n            if(F[i-1][j]<F[i][j-1])F[i][j]=F[i-1][j]+b[i][j];\n            else q[i][j]=1,F[i][j]=F[i][j-1]+b[i][j];\n        }\n    int d=0;\n    if(f[n][n]<F[n][n]){\n        out<<f[n][n]<<ln;\n        x=n,y=n;\n        while(x!=1||y!=1){\n            if(p[x][y])ans[d++]='D',x--;\n            else ans[d++]='R',y--;\n        }\n    }\n    else{\n        out<<F[n][n]<<ln;\n        x=n,y=n;\n        while(x!=1||y!=1){\n            if(q[x][y])ans[d++]='D',x--;\n            else ans[d++]='R',y--;\n        }\n    }\n    reverse(ans,ans+d);\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG CF5E Bindian Signalizing/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG UVA12730 Skyrks-Bar", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/UVA12730&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/UVA12730\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000001\ndb f[N];\nint main(){\n    int n,k,t;\nin>>t;\nFur(T,1,t){\n    in>>n>>k;\n    db s=0;clr(f,0);\n    Fur(i,1,k+1)f[i]=1;\n    Fur(i,k+2,n){\n        s+=f[i-k-1];\n        f[i]=1+2.0*s/i;\n    }\n    printf(\"Case #%d: %.5f\\n\",T,f[n]);\n}\n}\n```\n", "link": "/posts/LG UVA12730 Skyrks-Bar/", "tags": ["\u671f\u671b"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "HDU 1465 \u4e0d\u5bb9\u6613\u7cfb\u5217\u4e4b\u4e00", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=1465&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"http://acm.hdu.edu.cn/showproblem.php?pid=1465\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fd9\u4e2a\u663e\u7136\u662f\u9519\u6392\u95ee\u9898\n\n\u8bbe$A_i$\u4e3a$i$\u5728\u4f4d\u7f6e$i$\u4e0a\u7684\u6240\u6709\u6392\u5217\n\n$ans=|\\overline A_1\\bigcap \\overline A_2 \\bigcap ...\\bigcap \\overline A_n|$\n\n$=|N|$\n\n$-(|A_1|+|A_2|+...+|A_n|)$\n\n$+(|A_1\\bigcap A_2|+...+|A_{n-1}\\bigcap A_n|)$\n\n$-\\ ...$\n\n$+ (-1)^n |A_1\\bigcap A_2\\bigcap ... \\bigcap A_n$\n\n$=n!- {n\\choose 1}\\cdot (n-1)! + {n\\choose 2}\\cdot (n-2)! - ...\\ + (-1)^n {n\\choose n}$\n\n$=n!(1-\\frac{1}{1!}+\\frac{1}{2!}-\\frac{1}{3!}+...+(-1)^n\\frac{1}{n!}) = D_n$\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\nusing namespace std;\n#define ll long long\n#define Fur(i,x,y) for(int i(x);i<=y;++i)\n#define N 100011\nint n;\nll f[22],c[22][22];\nint main(){\n    Fur(i,0,20){\n        c[i][0]=1;\n        Fur(j,1,i)c[i][j]=c[i-1][j]+c[i-1][j-1];\n    }\n    f[0]=1;\n    Fur(i,1,20)f[i]=f[i-1]*i;\n    while(~scanf(\"%d\",&n)){\n        ll ans=f[n];\n        int k=-1;\n        Fur(i,1,n){\n            ans+=c[n][i]*f[n-i]*k;\n            k=-k;\n        }\n        printf(\"%lld\\n\",ans);\n    }\n}\n```\n", "link": "/posts/HDU 1465 \u4e0d\u5bb9\u6613\u7cfb\u5217\u4e4b\u4e00/", "tags": ["\u5bb9\u65a5", "\u9519\u6392\u95ee\u9898"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1654 OSU!", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1654&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1654\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 10011\nint n;\nint main(){\n\tdouble ans=0,a=0,b=0,x;\n\tscanf(\"%d\",&n);\n\twhile(n--){\n\t\tscanf(\"%lf\",&x);\n\t\tans=ans+x*(3*a+3*b+1);\n\t\ta=(a+b*2+1)*x;\n\t\tb=(b+1)*x;\n\t}\n\tprintf(\"%.1f\\n\",ans);\n}\n```\n", "link": "/posts/LG 1654 OSU!/", "tags": ["\u671f\u671b"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2219 [HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2219&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2219\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9884\u5904\u7406\u51fa\u4e8c\u7ef4\u524d\u7f00\u548c\n\n\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u4ee5$(i,j)$\u4e3a\u53f3\u4e0b\u89d2\u7684A*B\u77e9\u9635\u7684\u548c\n\n\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u4ee5$(i,j)$\u4e3a\u53f3\u4e0b\u89d2\u7684C*D\u77e9\u9635\u7684\u548c\n\n\u5148\u7528\u5355\u8c03\u961f\u5217\u51fa\u5217\u7684C*D\u7684\u6700\u5c0f\u503c\n\n\u518d\u7528\u53e6\u4e00\u4e2a\u5355\u8c03\u961f\u5217\u5904\u7406\u51fa\u884c\u7684\n\n\u7136\u540e\u679a\u4e3e\u6bd4\u8f83\u5373\u53ef\n\n\u7167\u7740\u4ee3\u7801\u610f\u4f1a\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\nint n,m,A,B,C,D,Q[N];\nint s[N][N],a[N][N],b[N][N],p[N][N],q[N][N];\nint main(){\n\tin>>n>>m>>A>>B>>C>>D;\n\tFur(i,1,n)\n\t\tFur(j,1,m)\n\t\tin>>s[i][j],s[i][j]+=s[i-1][j]+s[i][j-1]-s[i-1][j-1];\n\t\n\tFur(i,C+1,n-1)\n\t\tFur(j,D+1,m-1)\n\t\ta[i][j]=s[i][j]-s[i][j-D]-s[i-C][j]+s[i-C][j-D];\n\t\n\tFur(i,A,n)\n\t\tFur(j,B,m)\n\t\tb[i][j]=s[i][j]-s[i][j-B]-s[i-A][j]+s[i-A][j-B];\n\n\tFur(i,C+1,n-1){\n\t\tint h=1,t=0;\n\t\tFur(j,D+1,m-1){\n\t\t\twhile(h<=t&&Q[h]<j-B+D+2)h++;\n\t\t\twhile(h<=t&&a[i][Q[t]]>=a[i][j])t--;\n\t\t\tQ[++t]=j;\n\t\t\tif(j>=B-1)p[i][j+1]=a[i][Q[h]];\n\t\t}\n\t}\n\n\tFur(j,B,m){\n\t\tint h=1,t=0;\n\t\tFur(i,C+1,n-1){\n\t\t\twhile(h<=t&&Q[h]<i-A+2+C)h++;\n\t\t\twhile(h<=t&&p[Q[t]][j]>=p[i][j])t--;\n\t\t\tQ[++t]=i;\n\t\t\tif(i>=A-1)q[i+1][j]=p[Q[h]][j];\n\t\t}\n\t}\n\tint ans=0;\n\tFur(i,A,n)\n\t\tFur(j,B,m)\n\t\tans=MAX(ans,b[i][j]-q[i][j]);\n\t\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 2219 [HAOI2007]\u4fee\u7b51\u7eff\u5316\u5e26/", "tags": ["\u5355\u8c03\u961f\u5217", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP3724 RAINBOW", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP3724&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP3724\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nRainbow-Ride\ntop: 0\n\n\u7528\u5e76\u67e5\u96c6\u5408\u5e76\u8054\u901a\u5757,\u7136\u540e\u80cc\u5305\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,c,val[N],f[N],siz[N],s[N];\nint gf(int x){\n    return f[x]==x?x:(f[x]=gf(f[x]));\n}\nint main(){\n    in(n,c);\n    while(n&&c){\n        Fur(i,1,n)in(val[i]),f[i]=i,siz[i]=1;\n        Fur(i,1,n){\n            int k,x;in(k);\n            Fur(j,1,k){\n                in(x);\n                int fi=gf(i),fx=gf(x);\n                if(fi!=fx){\n                    f[fx]=fi;\n                    siz[fi]+=siz[fx];siz[fx]=0;\n                    val[fi]+=val[fx];\n                }\n            }\n        }\n        Fur(i,1,c)s[i]=0;\n        Fur(i,1,n)if(f[i]==i)\n            Fdr(j,c,val[i])\n            s[j]=MAX(s[j],s[j-val[i]]+siz[i]);\n        out(s[c],ln);\n        in(n,c);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG SP3724 RAINBOW/", "tags": ["\u5e76\u67e5\u96c6", "\u80cc\u5305"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3195 [HNOI2008]\u73a9\u5177\u88c5\u7bb1TOY", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3195&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3195\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u659c\u7387\u4f18\u5316\u5165\u95e8\u9898\n\n\u8bbe$f_i$\u8868\u793a\u524d$i$\u4ef6\u73a9\u5177\u7684\u5236\u4f5c\u8d39\u7528\n\n$$\nf_i=\\min_{j=1}^{i-1}(f[j]+(i-j-1+s_i-s_j-L)^2)\n$$\n\n\u663e\u7136$\\Theta(n^2)$\u4e0d\u80fd\u6ee1\u8db3\u8981\u6c42\n\n\u4ee4$a_i=s_i+i,b[i]=s_i+i+L+1$\n\n(\u90fd\u53ea\u4e0e$i$\u6709\u5173)\n\n\u90a3\u4e48\n$$\nf_i=\\min_{j=1}^{i-1}(f_j+(a_i-b_j)^2)\n\\\\\\text{\u5c55\u5f00\u5f97}\\\\\nf_i=f_j+{a_i}^2-2a_ib_j+{b_j}^2\n\\\\\\text{\u79fb\u9879\u5f97}\\\\\n2a_ib_j+f_i-{a_i}^2=f_j+{b_j}^2\n$$\n\n\u8bbe$x=b_j,y=f_j+{b_j}^2$\n$$\ny=2a_ix+(f_i-{a_i}^2)\n$$\n\n\u53ef\u4ee5\u770b\u6210\u4e00\u6761\u659c\u7387\u4e3a$2a_i$\u7684\u76f4\u7ebf\n\n$f_i$\u542b\u4e49\u8f6c\u5316\u4e3a\u5f53\u4e0a\u8ff0\u76f4\u7ebf\u7ecf\u8fc7\u70b9$(x,y)$\u5373$(b_j,f_j+{b_j}^2)$\u65f6,\u76f4\u7ebf\u5728$y$\u8f74\u7684\u622a\u8ddd\u4e0a\u52a0\u4e0a${a_i}^2$\n\n\u9898\u76ee\u5c31\u662f\u8981\u627e\u8fd9\u4e2a\u6700\u5c0f\u7684\u622a\u8ddd\n\n\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u6761\u76f4\u7ebf\u4ece\u4e0b\u5f80\u4e0a\u5e73\u79fb,\u76f4\u5230\u7ecf\u8fc7\u7b2c\u4e00\u4e2a\u70b9\n\n\u8fd9\u6837\u7684\u8bdd\u6211\u4eec\u53ef\u4ee5\u7ef4\u62a4\u4e00\u4e2a\u4e0b\u51f8\u58f3\n\n\u6c42\u7684\u8fc7\u7a0b\u5927\u6982\u662f\u8fd9\u6837\uff1a\n\nhttps://www.desmos.com/calculator/mqsdvzuaee\n\n![](data:image/png;base64,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)\n\n\u5230\n\n![](data:image/png;base64,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)\n\n\u90a3\u4e48\u5982\u4f55\u7ef4\u62a4\u8fd9\u6837\u4e00\u4e2a\u4e0b\u51f8\u58f3\u5462\uff1f\n\n\u53ef\u4ee5\u53d1\u73b0\u51f8\u58f3\u4e2d\u7684\u76f8\u90bb\u4e24\u70b9\u7684\u659c\u7387\u662f\u9012\u589e\u7684\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u7ef4\u62a4\n\n\u90a3\u4e48\u67e5\u8be2\u5462\uff1f\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\uff1a\n\n\u5982\u679c\u5f53\u524d\u76f4\u7ebf\u7ecf\u8fc7\u7684\u70b9\u5de6\u8fb9\u7684\u659c\u7387<\u5f53\u524d\u659c\u7387<\u53f3\u8fb9\u7684\u659c\u7387,\n\n\u90a3\u4e48\u8fd9\u4e2a\u70b9\u5c31\u662f\u6700\u4f18\u7684\u3002\n\n\u6211\u4eec\u53ef\u4ee5\u6309\u7167\u4e0b\u9762\u7684\u65b9\u6848\u5b9e\u73b0\uff1a\n\n\u8bbe\u961f\u5934\u4e3a$h$,\u961f\u5c3e\u4e3a$t$,\u961f\u5217\u6570\u7ec4\u4e3a$q$,$s(i,j)$\u4e3a\u76f4\u7ebf$ij$\u7684\u659c\u7387\n\n1. while($s(q_h,q_{h+1})<2a_i$)++h;\n2. \u5f53\u524d\u961f\u5934\u7684\u70b9\u6700\u4f18,\u7528\u8fd9\u4e2a\u70b9\u8ba1\u7b97\u51fa$f_i$\n3. while($s(q_{t-1},q_t)>s(q_{t-1},i)$)--t;\n4. \u961f\u5c3e\u63d2\u5165\u70b9$i$\n\n\u5bf9\u4e8e$3$\u64cd\u4f5c\u7684\u89e3\u91ca\uff1a\n\n![](data:image/png;base64,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)\n\n\u5047\u8bbe\u5f53\u524d\u63d2\u5165\u7684\u662f\u7ea2\u70b9,\u90a3\u4e48\u7eff\u70b9\u660e\u663e\u5728\u51f8\u5305\u5185,\u8981\u5220\u9664\u6389\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 50011\nint n,L,c[N];\nll f[N],s[N];\ndb a(int i){return s[i]+i;}\ndb b(int i){return s[i]+i+L+1;}\ndb x(int i){return b(i);}\ndb y(int i){return f[i]+b(i)*b(i);}\ndb S(int i,int j){return (y(i)-y(j))/(x(i)-x(j));}\nint q[N];\nint main(){\n    in(n,L);\n    Fur(i,1,n)in(s[i]),s[i]+=s[i-1];\n    int h=1,t=1;\n    Fur(i,1,n){\n        while(h<t&&S(q[h],q[h+1])<(a(i)*2))++h;\n        f[i]=f[q[h]]+(a(i)-b(q[h]))*(a(i)-b(q[h]));\n        while(S(q[t-1],q[t])>S(q[t-1],i))--t;\n        q[++t]=i;\n    }\n    cout<<f[n]<<endl;\n}\n```\n", "link": "/posts/LG 3195 [HNOI2008]\u73a9\u5177\u88c5\u7bb1TOY/", "tags": ["\u659c\u7387\u4f18\u5316", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4116 Qtree3", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4116&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4116\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5728\u6bcf\u6761\u91cd\u94fe\u4e0a\u641e\u4e00\u4e2aset\n\n\u6216\u8005\u7528\u7ebf\u6bb5\u6811+\u4e8c\u5206\n<!-- more -->\n\n```cpp\n// luogu-judger-enable-o2\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define ls rt<<1\n#define rs rt<<1|1\nint head[N],n,q,sz=0,cnt=0;\nint top[N],d[N],f[N],siz[N],id[N],dfn[N];\nbool ff[N];\nset<int>mi[N]; \nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;dfn[id[x]=++sz]=x;\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint main(){\n    in>>n>>q;\n    int x,y,u,ans;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    dfs(1);bt(1,1);\n    while(q--){\n        in>>u>>x;\n        if(u==0){\n            if(ff[x])mi[top[x]].erase(id[x]);\n            else mi[top[x]].insert(id[x]);\n            ff[x]^=1;\n        }\n        else{\n            ans=-1;\n            while(x){\n                int k=*mi[top[x]].begin();\n                if(mi[top[x]].size()&&d[dfn[k]]<=d[x])ans=dfn[k];\n                x=f[top[x]];\n            }\n            out<<ans<<ln;\n        }\n    }\n}\n\n```\n", "link": "/posts/LG 4116 Qtree3/", "tags": ["\u6811\u94fe\u5256\u5206", "set", "\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1120 \u5c0f\u6728\u68cd \uff3b\u6570\u636e\u52a0\u5f3a\u7248\uff3d", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1120&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1120\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u641c\u7d22+\u526a\u679d\n\n\u8be6\u89c1\u6ce8\u91ca\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define rg register\n#define Fur(i,x,y) for(int i=x;i<=y;++i)\n#define Fdr(i,x,y) for(int i=x;i>=y;--i)\n#define fin(s) freopen(s\".in\",\"r\",stdin)\n#define fcin ios::sync_with_stdio(false)\nusing namespace std;\n#define N 70\nint n,a[N],nxt[N],len,s=0,tot;\nbool cmp(int x,int y){return x>y;}\nbool v[N];\nvoid dfs(int res,int d,int la){ // \u5f53\u524d\u6728\u68cd\u5269\u4e0b\u591a\u5c11\u6ca1\u62fc,\u7b2c\u51e0\u6839\u6728\u68cd,\u4e0a\u4e00\u6b21\u7528\u7684\u6700\u540e\u4e00\u6839\u7684\u4f4d\u7f6e\n    if(!res){\n        if(d==tot){\n            cout<<len<<endl;\n            exit(0);\n        }\n        Fur(i,1,n)if(!v[i]){\n            v[i]=1;\n            dfs(len-a[i],d+1,i);\n            v[i]=0;\n            break;\n        }\n    }\n    Fur(i,la+1,n)if(!v[i]&&res>=a[i]){\n        v[i]=1;\n        dfs(res-a[i],d,i);\n        v[i]=0;\n        if(res==a[i]||res==len)return;// a[i]\u7528\u5728\u5f53\u524d\u6728\u68cd\u4e0d\u5408\u9002\n        i=nxt[i];\n        if(i==n)return;\n    }\n}\nint main(){\n    fin(\"in\");\n    fcin;\n    cin>>n;\n    Fur(i,1,n){\n        cin>>a[i];\n        if(a[i]>50)--i,--n;\n    }\n    Fur(i,1,n)s+=a[i];\n    sort(a+1,a+n+1,cmp);//\u6392\u5e8f \u4ece\u5927\u5230\u5c0f\u653e\n\n    nxt[n]=n;\n    Fdr(i,n-1,1)\n        if(a[i]==a[i+1])nxt[i]=nxt[i+1];\n        else nxt[i]=i;\n    // \u9884\u5904\u7406\u51fa\u6700\u540e\u4e00\u4e2a\u4e0e\u4ed6\u76f8\u540c\u7684\u6570\n\n    for(len=a[1];len*2<=s;++len)\n    if(s%len==0){// \u5224\u65ad\u662f\u5426\u7b26\u5408\u6761\u4ef6\n        tot=s/len;\n        v[1]=1;\n        dfs(len-a[1],1,1);\n        v[1]=0;\n    }\n    cout<<s<<endl;\n}\n```\n", "link": "/posts/LG 1120 \u5c0f\u6728\u68cd \uff3b\u6570\u636e\u52a0\u5f3a\u7248\uff3d/", "tags": ["\u641c\u7d22", "\u526a\u679d"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1365 WJMZBMR\u6253osu!", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1365&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1365\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nEasy\ntop: 0\n\nSolution\uff1a\n\u3000\u3000\u671f\u671b\u9898\u603b\u662f\u8d3c\u6709\u610f\u601d\u3002\n\n\u3000\u3000\u672c\u9898\u671f\u671b$combo$\u4e3a$o$\u7684\u671f\u671b\u8fde\u7eed\u957f\u5ea6\u7684\u5e73\u65b9,\u6240\u4ee5\u6211\u4eec\u8bbe$f_i$\u8868\u793a\u5230\u4e86\u7b2c$i$\u4f4d\u7684\u603b\u671f\u671b$combo$,$g_i$\u8868\u793a\u5230\u4e86\u7b2c$i$\u4f4d\u7ed3\u5c3e\u7684\u8fde\u7eed$o$\u7684\u671f\u671b\u957f\u5ea6,\u90a3\u4e48\u5206\u60c5\u51b5\u8ba8\u8bba\uff1a\n\n1. $s_i == o$\n2. $s_i == x$\n3. $s_i ==\\ ?$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\ndb f[2],g[2];\nint n;\nchar ch;\nint main(){\n\tin>>n;\n\tint k=1;\n\tFur(i,1,n){\n\t\tin>>ch;\n\t\tif(ch=='o')f[k]=f[!k]+g[!k]*2+1,g[k]=g[!k]+1;\n\t\tif(ch=='x')f[k]=f[!k],g[k]=0;\n\t\tif(ch=='?')f[k]=f[!k]+g[!k]+0.5,g[k]=g[!k]/2+0.5;\n\t\tk^=1;\n\t}\n\tprintf(\"%.4f\\n\",f[!k]);\n}\n```\n", "link": "/posts/LG 1365 WJMZBMR\u6253osu!/", "tags": ["\u671f\u671b", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF417D Cunning Gena", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF417D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF417D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,m,b;\nint c[N],K[N],M[N];\nint main(){\n    in>>n>>m>>b;\n    Fur(i,1,n){\n        in>>c[i]>>K[i]>>M[i];\n    }\n\n}\n```\n", "link": "/posts/LG CF417D Cunning Gena/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1641 [SCOI2010]\u751f\u6210\u5b57\u7b26\u4e32", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1641&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1641\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n[\u8fd9\u4e2a\u9898\u89e3\u68d2\u68d2\u54d2](https://www.luogu.org/blog/user29936/solution-p1641)\n\n\u7b54\u6848\u5c31\u662f$C(n+m,m)-C(n+m,m-1)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 2000011\n#define mod 20100403\nint n,m,f[N],inv[N];\nint pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%mod;\n        p>>=1;x=1ll*x*x%mod;\n    }\n    return ans;\n}\nint C(int a,int b){\n    return 1ll*f[a]*inv[b]%mod*inv[a-b]%mod;\n}\nint main(){\n    cin>>n>>m;\n    f[0]=1;Fur(i,1,n+m)f[i]=1ll*f[i-1]*i%mod;\n    inv[n+m]=pw(f[n+m],mod-2);\n    Fdr(i,n+m-1,0)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n    out<<((C(n+m,m)-C(n+m,m-1)+mod)%mod)<<ln;\n}\n```\n", "link": "/posts/LG 1641 [SCOI2010]\u751f\u6210\u5b57\u7b26\u4e32/", "tags": ["\u9006\u5143", "\u7ec4\u5408\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2015 \u4e8c\u53c9\u82f9\u679c\u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2015&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2015\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5f88\u88f8\u7684\u6811\u5f62dp\n\n\u56e0\u4e3a\u662f\u4e8c\u53c9\u6811,\u6240\u4ee5\u5904\u7406\u8d77\u6765\u975e\u5e38\u65b9\u4fbf\n\n\u8bbe$f[i][j]$\u4e3a\u6839\u4e3a$i$\u7684\u5b50\u6811\u7528\u4e86$j$\u6761\u8fb9,\u6700\u591a\u4fdd\u7559\u591a\u5c11,\n\n$l,r$\u8868\u793a\u5de6\u53f3\u8282\u70b9,$lw,rw$\u8868\u793a\u8fde\u63a5\u5de6\u53f3\u513f\u5b50\u7684\u8fb9\u7684\u6743\u503c\u5206\u522b\u4e3a\u591a\u5c11\n\n$f[i][j]=\\max(lw+f[l][j-1],rw+f[r][j-1])$\n\n$f[i][j]=\\max(lw+f[l][k-1],rw+f[r][j-k-1])$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 111\nint n,m,cnt=0,head[N];\nstruct edge{\n    int to,nxt,w;\n}e[N*2];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint s[N][N];\nvoid dfs(int x,int f){\n    int l=0,r=0,lw=0,rw=0;\n    fl(i,x)if(to!=f){\n        if(l)r=to,rw=e[i].w;\n        else l=to,lw=e[i].w;\n    }\n    if(l)dfs(l,x),dfs(r,x);\n    Fur(i,1,m)s[x][i]=MAX(lw+s[l][i-1],rw+s[r][i-1]);\n    Fur(i,2,m){\n        Fur(j,1,i-1)\n        s[x][i]=MAX(s[x][i],lw+s[l][j-1]+rw+s[r][i-j-1]);\n    }\n}\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    int x,y,w;\n    Fur(i,1,n-1)in>>x>>y>>w,add(x,y,w),add(y,x,w);\n    dfs(1,0);\n    out<<s[1][m]<<ln;\n}\n```\n", "link": "/posts/LG 2015 \u4e8c\u53c9\u82f9\u679c\u6811/", "tags": ["\u6811\u5f62dp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4360 [CEOI2004]\u952f\u6728\u5382\u9009\u5740", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4360&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4360\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/LG 4360 [CEOI2004]\u952f\u6728\u5382\u9009\u5740/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u659c\u7387\u4f18\u5316"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4159 [SCOI2009]\u8ff7\u8def", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4159&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4159\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u56de\u60f3\u4e00\u4e0b 'TJOI2017\u53ef\u4e50'\n\n\u5982\u679c\u8fb9\u6743\u90fd\u662f1,\u6211\u4eec\u53ef\u4ee5\u7528\u77e9\u9635\u4e58\u6cd5\u6765\u6c42\u90bb\u63a5\u77e9\u9635\u7684$k$\u6b21\u5e42\n\n\u56e0\u4e3a\u8fb9\u6743\u53ea\u6709$0-9$,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u76f4\u63a5\u628a\u4e00\u4e2a\u70b9\u62c6\u62109\u4e2a\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nconst int mod=2009;\nint n,t,nn;\nstruct mat{\n    mat(){clr(a,0);}\n    int a[111][111];\n}a;\nmat operator*(mat x,mat y){\n    mat c;\n    Fur(i,1,nn)\n        Fur(j,1,nn)\n            Fur(k,1,nn)\n            c.a[i][j]=(c.a[i][j]+x.a[i][k]*y.a[k][j]%mod)%mod;\n    return c;\n}\nmat operator^(mat x,int p){\n    mat ans;\n    Fur(i,1,nn)ans.a[i][i]=1;\n    while(p){\n        if(p&1)ans=ans*x;\n        p>>=1;x=x*x;\n    }\n    return ans;\n}\nint main(){\n    in(n,t);\n    nn=n*9;\n    Fur(i,1,n)\n        Fur(j,1,8)\n        a.a[9*(i-1)+j][9*(i-1)+j+1]=1;\n    \n    char s[20];\n    Fur(i,1,n){\n        in(s+1);\n        Fur(j,1,n)\n        if(s[j]>'0')\n            a.a[9*(i-1)+s[j]-'0'][9*(j-1)+1]=1;\n    }\n    a=a^t;\n    printf(\"%d\\n\",a.a[1][n*9-8]);\n}\n```\n", "link": "/posts/LG 4159 [SCOI2009]\u8ff7\u8def/", "tags": ["\u77e9\u9635\u4e58\u6cd5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5144 \u8708\u86a3", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5144&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5144\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\nint n,m,a[N],s[N],f[N][111];\nint main(){\n\tin>>n>>m;\n\tFur(i,1,n)in>>a[i],s[i]=s[i-1]^a[i],f[i][1]=s[i];\n\tFur(k,2,m)\n\t\tFur(i,k,n)\n\t\t\tFur(j,k-1,i-1)\n\t\t\tf[i][k]=MAX(f[i][k],f[j][k-1]+(s[i]^s[j]));\n\t\n\tout<<f[n][m]<<ln;\n}\n```\n", "link": "/posts/LG 5144 \u8708\u86a3/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5424 [USACO19OPEN]Snakes", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5424&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5424\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f_{k,i}$:\u7b2c$i$\u4f4d,\u6539\u53d8$k$\u6b21\n\n\u663e\u7136$f_{k,i} = MIN(f_{k-1,j}+res(i,j))$\n\n\u90a3\u8fd9\u4e2a$res$\u8981\u600e\u4e48\u6c42\u5462\uff1f\n\n$res=MAX(a_i,..,a_j)-\\sum_{t=j-1}^i a_t$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 411\n#define int ll\nint n,k,f[N][N],a[N],s[N];\nsigned main(){\n\tin>>n>>k;\n\tclr(f,127);\n\tFur(i,1,n)in>>a[i],s[i]=a[i]+s[i-1];\n\tk++;\n\tf[0][0]=0;\n\tFur(i,1,n)\n\t\tFur(j,1,MIN(k,i)){\n\t\t\tint mx=a[i];\n\t\t\tFdr(t,i-1,0){\n\t\t\t\tf[j][i]=MIN(f[j][i],f[j-1][t]+mx*(i-t)-s[i]+s[t]);\n\t\t\t\tmx=MAX(mx,a[t]);\n\t\t\t}\n\t\t}\n\tint ans=inf;\n\tFur(i,0,k)ans=MIN(ans,f[i][n]);\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 5424 [USACO19OPEN]Snakes/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3413 SAC#1 - \u840c\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3413&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3413\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nhttps://www.luogu.org/blog/CSGO/solution-p3413\n\n\u76f4\u63a5\u809d\u4e0d\u884c,\u6211\u4eec\u53cd\u7740\u6765\n\n\u627e\u4e0d\u5305\u542b\u56de\u6587\u4e32\u7684\u4e2a\u6570\n\n\u4e00\u4e2a\u6570\u4efb\u4f55\u4e00\u4f4d\u90fd\u4e0e\u524d\u4e24\u4f4d\u4e0d\u76f8\u540c\u65f6,\u5b83\u5c31\u4e0d\u5305\u542b\u56de\u6587\u4e32\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1111\n#define mod 1000000007\n#define int ll\nint f[N][10][10],n1[N],n2[N];\nchar s1[N],s2[N];\nint solve(int *num){\n\tint n=num[0],ans=0,tot=0;\n\tFur(i,1,n)tot=(tot*10%mod+num[i])%mod;\n\tFur(i,1,n-1)\n\t\tFur(j,1,9)\n\t\t\tFur(k,0,9)\n\t\t\tif(j!=k)\n\t\t\t\tans=(ans+f[i][j][k])%mod;\n\tif(n>1)ans+=10;\n\tFdr(i,n,2){\n\t\tint v=num[n-i];\n\t\tFur(j,0,v-1)\n\t\t\tif(i!=n||j!=0){\n\t\t\t\t\n\t\t\t}\n\t}\n\treturn (tot+1-ans+mod)%mod;\n}\nsigned main(){\n\tin>>s1>>s2;\n\tFur(i,0,strlen(s1)-1)n1[++n1[0]]=s1[i]-48;\n\tFur(i,0,strlen(s2)-1)n2[++n2[0]]=s2[i]-48;\n\t\n\tFur(i,2,1000)\n\t\tFur(j,0,9)\n\t\t\tFur(k,0,9)\n\t\t\tif(k!=j){\n\t\t\t\tFur(a,0,9)\n\t\t\t\tif(a!=j&&a!=k)\n\t\t\t\t\tf[i][j][k]+=f[i-1][a][j];\n\t\t\t\tif(i-1==1)f[i][j][k]++;\n\t\t\t\tf[i][j][k]%=mod;\n\t\t\t}\n\t\n\t\n}\n```\n", "link": "/posts/LG 3413 SAC#1 - \u840c\u6570/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP375 Query on a tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP375&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP375\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<stdio.h>\n#include<string.h>\n#define clr(x,y) memset(x,y,sizeof(x))\n#define Fur(i,x,y) for(int i=x;i<=y;i++)\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nint MAX(int x,int y){return x>y?x:y;}\n#define SWAP(A, B)   \\\n    {                \\\n        int __T = A; \\\n        A = B;       \\\n        B = __T;     \\\n    }\n#define N 20011\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=MAX(s[ls],s[rs])\nint head[N],n,sz=0,cnt=0;\nint top[N],d[N],f[N],siz[N],id[N],val[N],a[N],s[N<<2];\nstruct edge{\n    int to,nxt,w;\n}e[N*2];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;val[to]=e[i].w;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;a[id[x]=++sz]=val[x];\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nvoid build(int l,int r,int rt){\n    if(l==r){\n        s[rt]=a[l];\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu;\n}\nint ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1,ans=0;\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans=MAX(ans,ask(L,R,m+1,r,rs));\n    return ans;\n}\nvoid upd(int x,int v,int l,int r,int rt){\n    if(l==r){\n        s[rt]=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    if(x<=m)upd(x,v,l,m,ls);\n    else upd(x,v,m+1,r,rs);\n    pu;\n}\nint fh(int x,int y){\n    int ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]]){SWAP(x,y);}\n        ans=MAX(ans,ask(id[top[x]],id[x],1,n,1));\n        x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    return MAX(ans,ask(id[x]+1,id[y],1,n,1));\n}\nint main(){\nint T;scanf(\"%d\",&T);\nwhile(T--){\n    scanf(\"%d\",&n);\n    int x,y,w;\n    char ch[20];\n    cnt=sz=0;\n    clr(head,0);clr(s,0);clr(f,0);clr(a,0);clr(top,0);clr(d,0);\n    Fur(i,1,n-1)scanf(\"%d%d%d\",&x,&y,&w),add(x,y,w),add(y,x,w);\n    dfs(1);bt(1,1);build(1,n,1);\n    while(1){\n        scanf(\"%s\",ch);\n        if(ch[0]=='D')break;\n        scanf(\"%d%d\",&x,&y);\n        if(ch[0]=='C'){\n            x*=2;\n            x=(d[e[x].to]>d[e[x-1].to])?e[x].to:e[x-1].to;\n            upd(id[x],y,1,n,1);\n        }\n        else printf(\"%d\\n\",fh(x,y));\n    }\n}\n}\n\n```\n", "link": "/posts/LG SP375 Query on a tree/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3400 \u4ed3\u9f20\u7a9d", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3400&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3400\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 3011\nint n,m,h[N],sta[N],v[N],tp;\nbool a[N][N];\nint main(){\n\tfin(\"in\");\n\tin>>n>>m;\n\tFur(i,1,n)\n\t\tFur(j,1,m)\n\t\tin>>a[i][j];\n\tll ans=0;\n\ttp=0;\n\tFur(i,1,n){\n\t\tFur(j,1,m){\n\t\t\tif(!a[i][j])h[j]=i;\n\t\t\twhile(tp&&h[sta[tp]]<h[j])tp--;\n\t\t\tsta[++tp]=j;\n\t\t\tv[tp]=v[tp-1]+(i-h[sta[tp]])*(sta[tp]-sta[tp-1]);\n\t\t\tans+=v[tp];\n\t\t}\n\t\ttp=0;\n\t}\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 3400 \u4ed3\u9f20\u7a9d/", "tags": ["\u5355\u8c03\u6808"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5283 [\u5341\u4e8c\u7701\u8054\u80032019]\u5f02\u6216\u7cbd\u5b50", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5283&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5283\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u6c42\u4e2a\u5f02\u6216\u524d\u7f00\u548c,\u7136\u540e\u5c31\u53d8\u6210\u6c42$k$\u5bf9\u6700\u5927\u5f02\u6216\u548c\n\n\u56e0\u4e3a(i^j) = (j^i)\n\n\u6240\u4ee5\u6211\u4eec\u8bbe$2k$\u5bf9,\u5230\u7b54\u6848\u5728\u9664\u4ee52\u5c31\u53ef\u4ee5\u4e86\n\n\u6211\u4eec\u5148\u627e\u51fa\u6bcf\u4e2a\u70b9\u80fd\u5f97\u5230\u7684\u6700\u5927\u5f02\u6216\u548c,\u7136\u540e\u653e\u5806\u91cc\n\n\u6bcf\u6b21\u53d6\u51fa\u5806\u9876,\u6c42\u51fa\u5b83\u80fd\u5f97\u5230\u7684\u7b2c$rk+1$\u5927\u7684\u5f02\u6216\u548c\n\n\u5982\u679c$rk+1 \\le n$,\u90a3\u5c31\u653e\u5230\u5806\u91cc\n\n(\u56e0\u4e3a\u4e00\u4e2a\u70b9\u6700\u591a\u7528$n$\u6b21,\u8981\u4e0d\u5c31\u91cd\u590d\u4e86)\n\n\u8bb0\u5f97$long\\ long$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 50000011\nint n,k,siz[N],c[N][2],cnt=0;\nll s[N],a[N];\nvoid ins(ll v){\n\tint x=0;\n\tFdr(i,31,0){\n\t\tint t=(v>>i)&1;siz[x]++;\n\t\tif(!c[x][t])c[x][t]=++cnt;\n\t\tx=c[x][t];\n\t}\n\tsiz[x]++;\n}\nll ask(ll v,int rk){\n\tint x=0;ll ans=0;\n\tFdr(i,31,0){\n\t\tint t=(v>>i)&1;\n\t\tif(!c[x][!t])x=c[x][t];\n\t\telse if(rk<=siz[c[x][!t]])x=c[x][!t],ans|=1ll<<i;\n\t\telse rk-=siz[c[x][!t]],x=c[x][t];\n\t}\n\treturn ans;\n}\nstruct node{\n\tll v;\n\tint rk,id;\n\tbool operator<(const node&y)const{\n\t\treturn v<y.v;\n\t}\n};\npriority_queue<node>q;\nint main(){\n\tin>>n>>k;k<<=1;\n\tll ans=0,x;\n\tins(s[0]);\n\tFur(i,1,n)in>>x,s[i]=s[i-1]^x,ins(s[i]);\n\tFur(i,0,n)q.push(node{ask(s[i],1),1,i});\n\tFur(i,1,k){\n\t\tnode t=q.top();q.pop();\n\t\tans+=t.v;\n\t\tif(t.rk<n)q.push(node{ask(s[t.id],t.rk+1),t.rk+1,t.id});\n\t}\n\tout<<(ans>>1)<<ln;\n}\n```\n", "link": "/posts/LG 5283 [\u5341\u4e8c\u7701\u8054\u80032019]\u5f02\u6216\u7cbd\u5b50/", "tags": ["trie", "\u5806", "\u5f02\u6216"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4058 [Code+t1]\u6728\u6750", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4058&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4058\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u76f4\u63a5\u4e8c\u5206\u5929\u6570\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 2000011\n#define int ull\nint n,S,L,h[N],a[N];\nbool chk(int w){\n\tint t=0;\n\tFur(i,1,n)\n\t\tif(h[i]+a[i]*w>=L){\n\t\t\tt+=(h[i]+a[i]*w);\n\t\t\tif(t>=S)return 1;\n\t\t}\n\treturn 0;\n}\nsigned main(){\n\tin>>n>>S>>L;\n\tFur(i,1,n)in>>h[i];\n\tFur(i,1,n)in>>a[i];\n\tint l=0,r=1000000000000000000ll,m,ans=0;\n\tif(chk(0))return out<<\"0\\n\",0;\n\twhile(l<=r){\n\t\tm=(l+r)>>1;\n\t\tif(chk(m))ans=m,r=m-1;\n\t\telse l=m+1;\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 4058 [Code+t1]\u6728\u6750/", "tags": ["\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2764 \u6700\u5c0f\u8def\u5f84\u8986\u76d6\u95ee\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2764&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2764\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ecf\u5178\u7684\u6700\u5c0f\u8def\u5f84\u8986\u76d6\u95ee\u9898\n\n\u53ef\u4ee5\u770b\u51fa\u4e00\u5f00\u59cb\u6709 $1$~$n$\u6761\u8def\u5f84\uff08$1\uff5en$)\n\n\u6bcf\u6b21\u53ef\u4ee5\u6311\u9009\u4e00\u4e2a\u70b9,\u5408\u5e76\u4e24\u6761\u8def\u5f84\n\n\u4f46\u662f\u4e00\u4e2a\u70b9\u53ea\u80fd\u7528\u4e00\u6b21\n\n\u6240\u4ee5\u6211\u4eec\u628a\u70b9\u62c6\u6210\u4e24\u4e2a\n\n\u4ece\u6e90\u70b9\u5411\u6bcf\u4e2a\u70b9\u7684\u5165\u70b9\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a$1$\u7684\u8fb9\n\n\u4ece\u6bcf\u4e2a\u70b9\u7684\u51fa\u70b9\u4e0e\u6c47\u70b9\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a$1$\u7684\u8fb9\n\n\u6bcf\u4e2a\u70b9\u7684\u5165\u70b9\u5411\u80fd\u5230\u8fbe\u7684\u70b9\u7684\u51fa\u70b9\u8fde\u4e00\u6761\u8fb9\u6743\u4e3a1\u7684\u8fb9\n\n\u7528 n-\u6700\u5927\u6d41 \u5c31\u662f\u7b54\u6848\n\n\u81f3\u4e8e\u8f93\u51fa\uff1a\n\n~~\u7a81\u7136\u6709\u70b9\u5c34\u5c2c~~\n\n\u968f\u4fbf\u4e71\u641e\u5427\n\n\u7528\u8fc7\u7684\u8fb9\u5c31\u662f\u5408\u5e76\u8fc7\u7684\n\n\u628a\u8fd9\u4e9b\u8fb9\u5408\u5e76\u8d77\u6765\u5c31\u53ef\u4ee5\u5f97\u51fa\u8def\u5f84\n\n\uff08\u641e\u4e2a\u5e76\u8336\u51e0\uff1f\uff1f\uff1f\uff09\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 355\n#define M 6011\nint n,head[N],d[N],q[M],cnt=1,st,ed,m;\nstruct edge{\n    int to,nxt,w;\n}e[M*2];\nbool v[M*2];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].w=0;e[cnt].nxt=head[y];head[y]=cnt;\n}\nbool bfs(){\n    int h=0,t=1;\n    clr(d,0);\n    d[q[h]=st]=1;    \n    while(h<t){\n        int x=q[h++];\n        if(x==ed)return 1;\n        fl(i,x)if(e[i].w&&!d[to]){\n            d[to]=d[x]+1;\n            q[t++]=to;\n        }\n    }\n    return 0;\n}\nint dfs(int x,int mf){\n    if(x==ed)return mf;\n    int us=0,w;\n    fl(i,x)\n    if(e[i].w&&d[to]==d[x]+1){\n        w=dfs(to,MIN(mf-us,e[i].w));\n        e[i].w-=w;e[i^1].w+=w;\n        us+=w;\n        if(us==mf)return mf;\n    }\n    if(!us)d[x]=-1;\n    return us;\n}\nint f[N];\nint gf(int x){return (f[x]==x)?x:(f[x]=gf(f[x]));}\nvoid op(int x){\n\tout<<x<<\" \";\n\tfl(i,x)\n\tif(!e[i].w&&e[i].to>n&&e[i].to<st)op(e[i].to-n);\n}\nint dinic(){\n    int ans=0;\n    while(bfs())ans+=dfs(st,inf);\n    return ans;\n}\nint main(){\n    in>>n>>m;\n\tint x,y;\n\tst=n*2+1,ed=n*2+2;\n\tFur(i,1,n)add(st,i,1),add(i+n,ed,1),f[i]=i;\n\tFur(i,1,m)\n\t\tin>>x>>y,\n\t\tadd(x,y+n,1);\n    \n\tint tmp=dinic();\n\tFur(i,2,cnt)\n\t\tif(e[i^1].to<=n&&e[i].to>n&&e[i].to<st&&!e[i].w)\n\t\tf[gf(e[i].to-n)]=gf(e[i^1].to);\n\t\t\n\tFur(i,1,n)\n\tif(gf(i)==i)op(i),out<<\"\\n\";\n\tout<<n-tmp<<ln;\n}\n```\n", "link": "/posts/LG 2764 \u6700\u5c0f\u8def\u5f84\u8986\u76d6\u95ee\u9898/", "tags": ["\u7f51\u7edc\u6d41"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF540D Bad-Luck-Island", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF540D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF540D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u671f\u671b \u8bb0\u5fc6\u5316\u641c\u7d22\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 111\nint A,B,C;\ndb f[N][N][N];\ndb F(int a,int b,int c){\n\tif(f[a][b][c])return f[a][b][c];\n\tif(a>A||b>B||c>C)return 0;\n\tif(b||c)\n\t\tf[a][b][c]=F(a+1,b,c)*((a+1)*c)/((b*c)+(a+1)*(b+c));\n\tif(a||c)\n\t\tf[a][b][c]+=F(a,b+1,c)*(a*(b+1))/(a*c+(b+1)*(a+c));\n\tif(a||b)\n\t\tf[a][b][c]+=F(a,b,c+1)*(b*(c+1))/(a*b+(c+1)*(a+b));\n\treturn f[a][b][c];\n}\nint main(){\n\tdb ans=0;\n\tin>>A>>B>>C;\n\tf[A][B][C]=1;\n\tFur(i,1,A)ans+=F(i,0,0);\n\tprintf(\"%.12lf \",ans);\n\tans=0;\n\tFur(i,1,B)ans+=F(0,i,0);\n\tprintf(\"%.12lf \",ans);\n\tans=0;\n\tFur(i,1,C)ans+=F(0,0,i);\n\tprintf(\"%.12lf\\n\",ans);\n}\n```\n", "link": "/posts/LG CF540D Bad-Luck-Island/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1039 \u4fa6\u63a2\u63a8\u7406", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1039&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1039\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u76f4\u63a5bfs\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint n,m;\nvoid bfs(){\n\t\n}\nint main(){\n\t\n}\n```\n", "link": "/posts/LG 1039 \u4fa6\u63a2\u63a8\u7406/", "tags": ["bfs", "\u6280\u5de7"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2949 [USACO09OPEN]\u5de5\u4f5c\u8c03\u5ea6Work-Scheduling", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2949&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2949\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u628a\u5de5\u4f5c\u6309\u622a\u6b62\u65f6\u95f4\u6392\u5e8f,\u5982\u679c\u5f53\u524d\u65f6\u95f4\u6ca1\u5230\u622a\u6b62\u65f6\u95f4,\u90a3\u4e48\u7b54\u6848\u52a0\u4e0a\u5b83\u7684\u4ef7\u503c,\u7136\u540e\u5f80\u5c0f\u6839\u5806\u4e2d\u63d2\u5165\u5b83\u7684\u4ef7\u503c\n\n\u5426\u5219,\u5982\u679c\u4ed6\u7684\u4ef7\u503c\u6bd4\u5806\u9876\u5927,\u90a3\u4e48\u7b54\u6848\u52a0\u4e0a\u5b83\u7684\u4ef7\u503c\u51cf\u53bb\u5806\u9876,\u5220\u9664\u5806\u9876,\u63d2\u5165\u5b83\u7684\u4ef7\u503c\n\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1000011\nint n;\nstruct node{\n    int v,d;\n}a[N];\nil bool cmp(node x,node y){return x.d<y.d;}\npriority_queue<int,vector<int>,greater<int>>q;\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i].d,a[i].v);\n    sort(a+1,a+n+1,cmp);\n    ll ans=0;\n    Fur(i,1,n){\n        if(a[i].d<=q.size()){\n            if(a[i].v>q.top())ans+=(a[i].v-q.top()),q.pop(),q.push(a[i].v);\n        }\n        else ans+=a[i].v,q.push(a[i].v);\n    }\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG 2949 [USACO09OPEN]\u5de5\u4f5c\u8c03\u5ea6Work-Scheduling/", "tags": ["\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1175D Array-Splitting", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1175D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1175D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u548b\u4e00\u770b\uff1a\n\n$f[i][j] = MAX(f[i-1][j-1]+a[j]*i,f[i][j-1]+a[j]*j)$\n\n\u4f46$n \\le 3 \\times 10^5$,\u3002\u3002\u3002\n\n\u3002\u3002\u3002\n\n\u90a3\u4e48\u5176\u5b9e\u8fd9\u4e0d\u662fdp\u9898,\u800c\u662f\u601d\u7ef4\u9898\n\n\u6211\u4eec\u53d1\u73b0\uff1a\n\n$(s[r]-s[l])\\times k +(s[r']-s[l'])\\times(k-1)+...+s[r''']$\n\n$s$\u8868\u793a\u524d\u7f00\u548c,$g$\u8868\u793a\u540e\u7f00\u548c\n\n\u76f8\u5f53\u4e8e\uff1a\n\n$g[x_1]+g[x_2]+g[x_3]+...$\n\n\u90a3\u6211\u4eec\u7ed9\u540e\u7f00\u548c\u6392\u4e2a\u5e8f\u5c31\u53ef\u4ee5\u4e86\n\n### \u6ce8\u610f\uff1a\n\n\u7b54\u6848\u91cc\u5fc5\u987b\u8981\u6709$g_1$,\u8fd9\u5c31\u662f\u4e3a\u4ec0\u4e48\u8981g1\u52a0(1ll<<50)\u518d\u7b54\u6848\u51cf(1ll<<50)\u7684\u539f\u56e0\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\nll n,k,g[N],a[N],ans=0;\nint main(){\n\tin>>n>>k;\n\tFur(i,1,n)in>>a[i];\n\tFdr(i,n,1)g[i]=g[i+1]+a[i];g[1]+=1ll<<50;\n\tsort(g+1,g+n+1);\n\tFdr(i,n,n-k+1)ans+=g[i];\n\tans-=1ll<<50;\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG CF1175D Array-Splitting/", "tags": ["\u524d\u7f00\u548c", "\u6392\u5e8f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF609E Minimum spanning tree for each edge", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF609E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF609E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 400011\n#define int ll\nstruct edge{\n    int to,nxt,w;\n}e[N*2];\nint n,m,cnt=0,head[N],B=0,sz=0;\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint fa[N];\nstruct node{\n    int x,y,w,id;\n    bool v=0;\n}E[N];\nbool cmp(node x,node y){\n    return x.w<y.w;\n}\nbool CMP(node x,node y){\n    return x.id<y.id;\n}\nint gf(int x){return (fa[x]==x)?x:(fa[x]=gf(fa[x]));}\nvoid kru(){\n    Fur(i,1,n)fa[i]=i;\n    sort(E+1,E+m+1,cmp);\n    int x,y,w;\n    Fur(i,1,m){\n        x=E[i].x,y=E[i].y,w=E[i].w;\n        if(gf(x)!=gf(y)){\n            E[i].v=1;\n            fa[fa[x]]=fa[y];\n            add(x,y,w);add(y,x,w);\n            B+=w;\n        }\n    }\n    sort(E+1,E+m+1,CMP);\n}\nint top[N],siz[N],f[N],v[N],s[N<<2],id[N],d[N],a[N];\nvoid dfs(int x){\n    siz[x]=1;id[x]=++sz;a[id[x]]=v[x];\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;v[to]=e[i].w;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\n#define ls rt<<1\n#define rs rt<<1|1\nvoid build(int l,int r,int rt){\n    if(l==r){\n        s[rt]=a[l];\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);\n    build(m+1,r,rs);\n    s[rt]=MAX(s[ls],s[rs]);\n}\nint ask(int L,int R,int l=1,int r=n,int rt=1){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1,ans=0;\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans=MAX(ans,ask(L,R,m+1,r,rs));\n    return ans;\n}\nint fh(int x,int y){\n    int ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans=MAX(ans,ask(id[top[x]],id[x]));x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    return MAX(ans,ask(id[x]+1,id[y]));\n}\nsigned main(){\n    fin(\"in\");\n    in>>n>>m;\n    int x,y;\n    Fur(i,1,m)in>>E[i].x>>E[i].y>>E[i].w,E[i].id=i;\n    kru();\n    dfs(1);\n    bt(1,1);\n    build(1,n,1);\n    Fur(i,1,m)\n        if(E[i].v)out<<B<<ln;\n        else out<<(ll)B+E[i].w-fh(E[i].x,E[i].y)<<ln;\n}\n```\n", "link": "/posts/LG CF609E Minimum spanning tree for each edge/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2658 \u6c7d\u8f66\u62c9\u529b\u6bd4\u8d5b", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2658&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2658\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e8c\u5206\u6700\u5927\u5dee\u503c\n\n\u7136\u540ebfs\u5224\u65ad\n\n~~\u6211\u600e\u4e48\u53c8\u5237\u6c34\u4e86QwQ~~\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 511\nint n,m,a[N][N],tot=0,sx,sy,p[N*N],q[N*N],dx[4]={0,1,0,-1},dy[4]={1,0,-1,0},b[N][N],v[N][N];\nbool chk(int w){\n\tclr(v,0);\n\tint h=0,t=1,ans=0;\n\tp[0]=sx;q[0]=sy;\n\twhile(h<t){\n\t\tint x=p[h],y=q[h++],nx,ny;\n\t\tans+=b[x][y];v[x][y]=1;\n\t\tFur(i,0,3){\n\t\t\tnx=x+dx[i];ny=y+dy[i];\n\t\t\tif(ABS(a[x][y]-a[nx][ny])>w||nx>n||nx<1||ny>m||ny<1||v[nx][ny])continue;\n\t\t\tp[t]=nx;q[t++]=ny;v[nx][ny]=1;\n\t\t}\n\t}\n\treturn ans==tot;\n}\nint main(){\n\tin>>n>>m;\n\tFur(i,1,n)\n\t\tFur(j,1,m)\n\t\tin>>a[i][j];\n\t\t\n\tFur(i,1,n)\n\t\tFur(j,1,m){\n\t\t\tin>>b[i][j];\n\t\t\tif(b[i][j])sx=i,sy=j,tot++;\n\t\t}\n\tint l=0,r=1000000000,ans=0;\n\twhile(l<=r){\n\t\tint mid=(l+r)>>1;\n\t\tif(chk(mid))ans=mid,r=mid-1;\n\t\telse l=mid+1;\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 2658 \u6c7d\u8f66\u62c9\u529b\u6bd4\u8d5b/", "tags": ["bfs", "\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3067 [USACO12OPEN]\u5e73\u8861\u7684\u5976\u725b\u7fa4Balanced-Cow", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3067&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3067\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u4e2a\u6570\u6709\u4e09\u79cd\u60c5\u51b5\uff1a\n\n1. \u653e\u5de6\u8fb9\n2. \u653e\u53f3\u8fb9\n3. \u4e0d\u9009\n\n\u6298\u534a\u641c\u7d22\n\n\u8fd8\u662f\u4e00\u6837\u7684\u5957\u8def\n\n\u5206\u524d\u90e8\u5206\u548c\u540e\u90e8\u5206\u641c\u7d22\n\n\u4f46\u662f\u6709\u53ef\u80fd\u51fa\u73b0\u524d\u540e\u9009\u7684\u6570\u51fa\u73b0\u91cd\u53e0\u72b6\u51b5\n\n\u6211\u4eec\u53ef\u4ee5\u7528\u72b6\u538b\u5e76\u5f00\u4e00\u4e2a\u6876\u6765\u8bb0\u5f55\u662f\u5426\u91cd\u590d\u51fa\u73b0\u8fc7\n\n\u6700\u540e\u7b54\u6848\u8bb0\u5f97-1,\u56e0\u4e3a\u7a7a\u96c6\u4e0d\u7b97\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 1000011\nint n,v[40],ans=0;\nstruct node{\n    int s,sta;    \n}a[1<<22],b[1<<22];\nbool cmp(node x,node y){\n    return x.s<y.s;\n}\nbool CMP(node x,node y){\n    return x.s>y.s;\n}\nint dep=0,ta=0,tb=0;\ninline void dfs(int d,int s,int now,bool f){\n    if(d==dep+1){\n        if(f)a[++ta]=node{s,now};\n        else b[++tb]=node{s,now};\n        return;\n    }\n    dfs(d+1,s,now,f);\n    dfs(d+1,s+v[d],(now+(1<<(d-1))),f);\n    dfs(d+1,s-v[d],(now+(1<<(d-1))),f);\n}\nbool vis[1<<22];\nint main(){\n    cin>>n;\n    for(int i=1;i<=n;++i)cin>>v[i];\n    dep=n/2;\n    dfs(1,0,0,1);\n    dep=n;\n    dfs(n/2+1,0,0,0);\n    sort(a+1,a+ta+1,cmp);\n    sort(b+1,b+tb+1,CMP);\n    int p=1,q=1;\n    while(p<=ta&&q<=tb){\n        while(-a[p].s<b[q].s&&q<=tb)++q;\n        int pos=q;\n        while(q<=tb&&-a[p].s==b[q].s){\n            if(!vis[a[p].sta|b[q].sta])\n                vis[a[p].sta|b[q].sta]=1,++ans;\n            ++q;\n        }\n        if(p<ta&&a[p].s==a[p+1].s)q=pos;\n        ++p;\n    }\n    cout<<ans-1<<endl; \n}\n```\n", "link": "/posts/LG 3067 [USACO12OPEN]\u5e73\u8861\u7684\u5976\u725b\u7fa4Balanced-Cow/", "tags": ["\u6298\u534a\u641c\u7d22"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1381 \u5355\u8bcd\u80cc\u8bf5", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1381&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1381\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,m,b[N];\nint v[N];\nmap<string,int>mp;\nint main(){\n    fcin;\n    cin>>n;\n    string ch;\n    Fur(i,1,n)cin>>ch,mp[ch]=i;\n    cin>>m;\n    int tot=0;\n    Fur(i,1,m){\n        cin>>ch;\n        if(mp.count(ch)){\n            int t=mp[ch];\n            if(!v[t])++tot;\n            v[t]=1;b[i]=t;\n        }\n        else b[i]=0;\n    }\n    out<<tot<<ln;\n    int L=0,s=0,ans=inf;\n    clr(v,0);\n    v[0]=inf;\n    Fur(i,1,m){\n        if(!v[b[i]])++s;\n        ++v[b[i]];\n        if(s==tot){\n            while(s==tot&&L<=i)if(--v[b[++L]]==0)--s;\n            ans=MIN(ans,i-L+1);\n        }\n    }\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 1381 \u5355\u8bcd\u80cc\u8bf5/", "tags": ["\u53cc\u6307\u9488"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4374 [USACO18OPEN]Disruption", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4374&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4374\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u6839\u636e\u539f\u6765\u7684\u8fb9\u5efa\u6811\n\n\u4e00\u6761\u65b0\u8fb9$(x,y)$\u80fd\u5f71\u54cd\u7684\u8fb9\u6709\u6811\u4e0a$x \\rightarrow y$\u8def\u5f84\u4e0a\u7684\u8fb9\n\n\u90a3\u4e48\u8fd9\u9053\u9898\u5c31\u8f6c\u5316\u6210\u4e86\u6811\u5256+\u7ebf\u6bb5\u6811\u7ef4\u62a4\u6700\u503c\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 50011\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=MIN(s[ls],s[rs])\nint n,m;\nint s[N<<2],laz[N<<2];\nvoid pd(int rt){\n    if(laz[rt]!=inf){\n        s[ls]=MIN(s[ls],laz[rt]);\n        s[rs]=MIN(s[rs],laz[rt]);\n        laz[ls]=MIN(laz[ls],laz[rt]);\n        laz[rs]=MIN(laz[rs],laz[rt]);\n        laz[rt]=inf;\n    }\n}\nvoid upd(int L,int R,int v,int l=1,int r=n,int rt=1){\n    if(L<=l&&r<=R){\n        s[rt]=MIN(s[rt],v);\n        laz[rt]=MIN(laz[rt],v);\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    pu;\n}\nint get(int x,int l=1,int r=n,int rt=1){\n    if(l==r)return s[rt];\n    int m=(l+r)>>1;\n    pd(rt);\n    if(x<=m)return get(x,l,m,ls);\n    else return get(x,m+1,r,rs);\n}\nstruct edge{\n    int to,nxt,id;\n}e[N*2];\nint head[N],cnt=0;\nvoid add(int x,int y,int id){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[cnt].id=id;\n}\nint siz[N],d[N],f[N],top[N],id[N],sz=0,pte[N];\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        d[to]=d[x]+1;f[to]=x;pte[to]=e[i].id;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    id[x]=++sz;top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nvoid ul(int x,int y,int v){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        upd(id[top[x]],id[x],v);x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    upd(id[x]+1,id[y],v);\n}\nint etp[N];\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    int x,y,w;\n    Fur(i,1,n-1){\n        in>>x>>y;\n        add(x,y,i);add(y,x,i);\n    }\n\n    dfs(1);bt(1,1);\n    clr(laz,126);clr(s,126);\n    Fur(i,1,m)\n        in>>x>>y>>w,ul(x,y,w);\n    \n    Fur(i,2,n)etp[pte[i]]=i;\n    Fur(i,1,n-1){\n        int t=get(id[etp[i]]);\n        if(t==inf)t=-1;\n        out<<t<<ln;\n    }\n}\n```\n", "link": "/posts/LG 4374 [USACO18OPEN]Disruption/", "tags": ["\u6811\u94fe\u5256\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1642 \u89c4\u5212", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1642&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1642\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e8c\u5206\u6700\u5927\u503c,\u7136\u540e\u6811\u578bdp\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 111\n#define eps 1e-4\nint n,k,cnt=0,head[N],a[N],b[N],sz[N];\ndb t[N],f[N][N];\nstruct edge{\n\tint to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n\te[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x,int fa){\n\tsz[x]=1;\n\tf[x][0]=0;\n\tfl(i,x)if(to!=fa){\n\t\tdfs(to,x);\n\t\tsz[x]+=sz[to];\n\t\tFdr(j,MIN(k,sz[x]),0)\n\t\t\tFur(p,0,MIN(j,sz[to]))\n\t\t\tf[x][j]=MAX(f[x][j],f[x][j-p]+f[to][p]);\n\t}\n\tFdr(i,MIN(k,sz[x]),1)f[x][i]=f[x][i-1]+t[x];\n}\nbool chk(db w){\n\tFur(i,1,n)\n\t\tFur(j,0,k)\n\t\tf[i][j]=-inf;\n\tFur(i,1,n)t[i]=(db)a[i]-w*(db)b[i];\n\tdfs(1,0);\n\tFur(i,1,n)\n\t\tif(f[i][k]>-eps)return 1;\n\treturn 0;\n}\nint main(){\n\tin>>n>>k;k=n-k;\n\tFur(i,1,n)in>>a[i];\n\tFur(i,1,n)in>>b[i];\n\tint x,y;\n\tFur(i,1,n-1)\n\t\tin>>x>>y,add(x,y),add(y,x);\n\n\tdb l=0,r=10000,m;\n\twhile(r-l>eps){\n\t\tm=(l+r)/2.0;\n\t\tif(chk(m))l=m;\n\t\telse r=m;\n\t}\n\tprintf(\"%.1f\\n\",m);\n}\n```\n", "link": "/posts/LG 1642 \u89c4\u5212/", "tags": ["01\u5206\u6570\u89c4\u5212", "\u6811\u578bdp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1405 \u6811\u7684\u8ddd\u79bb\u4e4b\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6811\u5f62dp up and down\n\n$\u8003\u8651 up$:\n\n\u8bbe$s_x$\u4e3a\u70b9$x$\u5b50\u6811\u4e2d\u6240\u6709\u70b9\u5230$x$\u7684\u8ddd\u79bb\u4e4b\u548c\n\n$S_x = \\sum (s_{to}+siz_{to})$\n\n$\u8003\u8651 down$:\n\n$s_{to} = s_{to} + (s_x-s_{to}-siz_{to}) + n - siz_{to}$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint f[N],siz[N];\nll s[N];\nvoid up(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;\n        up(to);\n        siz[x]+=siz[to];\n        s[x]+=s[to]+siz[to];\n    }\n}\nvoid down(int x){\n    fl(i,x)if(to!=f[x])\n        s[to]+=(s[x]-(s[to]+siz[to]))+n-siz[to],\n        down(to);\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    int x,y;\n    Fur(i,1,n-1){\n        in>>x>>y;\n        add(x,y);add(y,x);\n    }\n    up(1);\n    down(1);\n    Fur(i,1,n)out<<s[i]<<ln;\n}\n```\n", "link": "/posts/51nod 1405 \u6811\u7684\u8ddd\u79bb\u4e4b\u548c/", "tags": ["\u6811\u5f62dp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2569 [SCOI2010]\u80a1\u7968\u4ea4\u6613", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2569&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2569\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f[i][j]$\u8868\u793a\u7b2c$i$\u5929\u6709$j$\u53ea\u80a1\u7968\u6700\u591a\u8d5a\u591a\u5c11\u94b1\n$$\\\\$$\n\n1. \u76f4\u63a5\u4e70\n   $f[i][j] = -ap[i] \\times j$\n2. \u4e0d\u4e70\u4e0d\u5356\n\n    $f[i][j] =f[i-1][j]$\n\n3. \u4e70\u80a1\n\n   $f[i][j] = f[i-w-1][k] - ap[i] \\times (j-k) (j-as[i] \\le k \\le j)$\n\n4. \u5356\u80a1\n\n    $f[i][j] = f[i-w-1][k] + bp[i] \\times (k-j) (j \\le k \\le j + bs[i])$\n\n\u4f46\u662f\u8fd9\u6837\u8fd8\u662f$O(n^3)$\u7684\u590d\u6742\u5ea6,\u5f97\u60f3\u529e\u6cd5\u964d\u5230$O(n^2)$\n\n\u770b\u4e00\u4e0b$f[i][j] = f[i-w-1][k] - ap[i] \\times (j-k) (j-as[i] \\le k \\le j)$\n\n\u53ef\u4ee5\u5316\u4e3a$f[i][j] = (f[i-w-1][k] + ap[i] \\times k) - ap[i] \\times j (j-as[i] \\le k \\le j)$\n\n\u4e8e\u662f\u5c31\u53ef\u4ee5\u5355\u8c03\u961f\u5217\u4e86 O\u03c9O\n\n<!-- more -->\n\n```cpp\n\t#include<bits/stdc++.h>\n\tnamespace ZDY{\n\t\t#pragma GCC optimize(3)\n\t\t#define il __inline__ __attribute__ ((always_inline))\n\t\t#define rg register\n\t\t#define ll long long\n\t\t#define ull unsigned long long\n\t\t#define db double\n\t\t#define sht short\n\t\t#define MB template <class T>il\n\t\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t\t#define clr(x,y) memset(x,y,sizeof(x))\n\t\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t\t#define fcin ios::sync_with_stdio(false)\n\t\t#define l2(n) (int(log2(n)))\n\t\t#define inf 0x3f3f3f3f\n\t\tMB T ABS(T x){return x>0?x:-x;}\n\t\tMB T MAX(T x,T y){return x>y?x:y;}\n\t\tMB T MIN(T x,T y){return x<y?x:y;}\n\t\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\t\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n\t}using namespace ZDY;using namespace std;\n\tnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n\t#define N 2001\n\tint n,p,w,ap,bp,as,bs,f[N][N],q[N],ans=0;\n\tint main(){\n\t\tin>>n>>p>>w;\n\t\tclr(f,128);\n\t\tFur(i,1,n){\n\t\t\tin>>ap>>bp>>as>>bs;\n\t\t\tFur(j,0,as)f[i][j]=-ap*j;\n\t\t\tFur(j,0,p)f[i][j]=MAX(f[i][j],f[i-1][j]);\n\t\t\tif(i<=w)continue;\n\t\t\tint l=1,r=0;\n\t\t\tFur(j,0,p){\n\t\t\t\twhile(l<=r&&q[l]<j-as)l++;\n\t\t\t\twhile(l<=r&&f[i-w-1][q[r]]+q[r]*ap<=f[i-w-1][j]+j*ap)r--;\n\t\t\t\tq[++r]=j;\n\t\t\t\tif(l<=r)f[i][j]=MAX(f[i][j],f[i-w-1][q[l]]+q[l]*ap-j*ap);\n\t\t\t}\n\t\t\tl=1,r=0;\n\t\t\tFdr(j,p,0){\n\t\t\t\twhile(l<=r&&q[l]>j+bs)l++;\n\t\t\t\twhile(l<=r&&f[i-w-1][q[r]]+q[r]*bp<=f[i-w-1][j]+j*bp)r--;\n\t\t\t\tq[++r]=j;\n\t\t\t\tif(l<=r)f[i][j]=MAX(f[i][j],f[i-w-1][q[l]]+q[l]*bp-j*bp);\n\t\t\t}\n\t\t}\n\t\tFur(i,0,p)ans=MAX(ans,f[n][i]);\n\t\tout<<ans<<ln;\n\t}\n```\n", "link": "/posts/LG 2569 [SCOI2010]\u80a1\u7968\u4ea4\u6613/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5355\u8c03\u961f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4172 [WC2006]\u6c34\u7ba1\u5c40\u957f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4172&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4172\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7528$link\\ cut\\ tree$\u7ef4\u62a4\u6700\u5c0f\u751f\u6210\u6811\n\n\u76f4\u63a5\u5728\u7ebf\u5f88\u96be,\u6211\u4eec\u53ef\u4ee5\u79bb\u7ebf\u52a0\u8fb9\n\n\u5148\u628a\u6240\u6709\u8fb9(\u540e\u6765\u65ad\u6389\u7684\u4e0d\u7b97)\u8dd1\u4e00\u904d\u6700\u5c0f\u751f\u6210\u6811\n\n\u63a5\u7740\u6bcf\u6b21\u52a0\u8fb9,\u8bbe\u52a0$x$\u5230$y$,\u8fb9\u957f\u4e3a$w$\n\n\u5148\u6c42\u51fa$x$\u5230$y$\u8def\u5f84\u4e0a\u6700\u957f\u7684\u8fb9\n\n\u5982\u679c\u6bd4\u8981\u52a0\u7684\u8fb9\u957f,\u5219\u5220\u6389\u8fd9\u6761\u8fb9,\u52a0\u4e0a\u65b0\u8fb9\n\n\u8fd9\u6837\u5c31\u53ef\u4ee5$lct$\u7ef4\u62a4\u6700\u5c0f\u751f\u6210\u6811\n\n\u56e0\u4e3a$lct$\u4e0d\u80fd\u76f4\u63a5\u7ef4\u62a4\u70b9,\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u628a\u8fb9\u770b\u6210\u70b9\n\n$x\\rightarrow\u8fb9\\rightarrow y$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\n#define ls c[x][0]\n#define rs c[x][1]\nint st[N],f[N],c[N][2],v[N],s[N];\nbool rev[N];\nbool irt(int x){return c[f[x]][0]!=x&&c[f[x]][1]!=x;}\nvoid pu(int x){s[x]=MAX(MAX(s[ls],s[rs]),v[x]);}\nvoid pr(int x){\n\tSWAP(ls,rs);\n\trev[x]^=1;\n}\nvoid pd(int x){\n\tif(rev[x]){\n\t\tif(ls)pr(ls);\n\t\tif(rs)pr(rs);\n\t\trev[x]=0;\n\t}\n}\nbool g(int x){return c[f[x]][1]==x;}\nvoid turn(int x){\n\tint y=f[x],z=f[y],l=g(x),r=!l,w=c[x][r];\n\tif(!irt(y))c[z][g(y)]=x;\n\tc[x][r]=y;c[y][l]=w;\n\tif(w)f[w]=y;\n\tf[x]=z;f[y]=x;\n\tpu(y);pu(x);\n}\nvoid splay(int x){\n\tint y=x,z=0;\n\tst[++z]=y;\n\twhile(!irt(y))st[++z]=y=f[y];\n\twhile(z)pd(st[z--]);\n\twhile(!irt(x)){\n\t\ty=f[x],z=f[y];\n\t\tif(!irt(y))\n\t\t\tturn(((c[y][0]==x)^(c[z][0]==y))?x:y);\n\t\tturn(x);\n\t}\n\tpu(x);\n}\nvoid access(int x){\n\tfor(int y=0;x;x=f[y=x])\n\t\tsplay(x),rs=y,pu(x);\n}\nvoid mrt(int x){\n\taccess(x);splay(x);\n\tpr(x);\n}\nint frt(int x){\n\taccess(x);splay(x);\n\twhile(ls)pd(x),x=ls;\n\tsplay(x);\n\treturn x;\n}\nvoid sl(int x,int y){\n\tmrt(x);access(y);splay(y);\n}\nvoid link(int x,int y){\n\tmrt(x);\n\tif(frt(y)!=x)f[x]=y;\n}\nvoid cut(int x,int y){\n\tmrt(x);\n\tif(frt(y)==x&&f[y]==x&&!c[y][0]){\n\t\tc[x][1]=f[y]=0;\n\t\tpu(x);\n\t}\n}\nint find(int x,int k){\n\tif(v[x]==k)return x;\n\tif(s[ls]==k)return find(ls,k);\n\treturn find(rs,k);\n}\nint n,m,q;\nstruct edge{\n\tedge(){b=1;}\n\tint x,y,w,b;\n}e[N];\nstruct que{\n\tint u,x,y;\n}Q[N];\nint id[5011][5011],ff[N],ans[N],cnt=0;\nbool cmp(edge x,edge y){\n\treturn x.w<y.w;\n}\nint gf(int x){return x==ff[x]?x:(ff[x]=gf(ff[x]));}\nint main(){\n\tfin(\"in\");\n\tin>>n>>m>>q;\n\tint x,y,w,u,t;\n\tFur(i,1,m)in>>e[i].x>>e[i].y>>e[i].w;\n\tsort(e+1,e+m+1,cmp);\n\tFur(i,1,m){\n\t\tx=e[i].x,y=e[i].y;w=e[i].w;\n\t\tid[x][y]=id[y][x]=i;\n\t\tv[n+i]=w;\n\t}\n\tFur(i,1,q){\n\t\tin>>u>>x>>y;\n\t\tif(u==2)e[id[x][y]].b=0;\n\t\tQ[i]=(que){u,x,y};\n\t}\n\t\n\tFur(i,1,n)ff[i]=i;\n\tFur(i,1,m)if(e[i].b){\n\t\tx=e[i].x,y=e[i].y;\n\t\tif(gf(x)!=gf(y)){\n\t\t\tff[gf(x)]=gf(y);\n\t\t\tlink(x,n+i);link(y,n+i);\n\t\t}\n\t}\n\tFdr(i,q,1){\n\t\tu=Q[i].u;x=Q[i].x;y=Q[i].y;\n\t\tsl(x,y);\n\t\tif(u==1)ans[++cnt]=s[y];\n\t\telse\n\t\t\tif(s[y]>v[n+id[x][y]])\n\t\t\t\tt=find(y,s[y]),\n\t\t\t\tcut(e[t-n].x,t),\n\t\t\t\tcut(e[t-n].y,t),\n\t\t\t\tlink(x,n+id[x][y]),\n\t\t\t\tlink(y,n+id[x][y]);\n\t}\n\tFdr(i,cnt,1)out<<ans[i]<<ln;\n}\n```\n", "link": "/posts/LG 4172 [WC2006]\u6c34\u7ba1\u5c40\u957f/", "tags": ["lct", "\u6700\u5c0f\u751f\u6210\u6811", "\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF868F Yet-Another-Minimization-Problem", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF868F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF868F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f(i,j)$\u8868\u793a\u524d$i$\u4e2a\u5212\u5206\u6210$j$\u6bb5\u6700\u5c11\u7684\u8d39\u7528\n\n\u6211\u4eec\u8bbe$calc(l,r)$\u8868\u793a$[l,r]$\u5212\u5206\u6210\u4e00\u6bb5\u7684\u8d39\u7528\n\n$$f(i,j)=\\min_{x=1}^i(f(x-1,j-1)+calc(x,i))$$\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2adp\u65b9\u7a0b\u5177\u6709\u51b3\u7b56\u5355\u8c03\u6027\n\n\u82e5$i<i'$,\u90a3\u4e48$k_i\\le k_{i'}$(\u51b3\u7b56\u70b9)\n\n> \u628a\u8fde\u7eed\u4e00\u6bb5\u62c6\u6210\u4e24\u8fb9\u66f4\u4f18$x^2+y^2\\le (x+y)^2(x,y\\ge 0)$\n\n\u66f4\u5de7\u7684\u662f$w(l,r)$\u53ef\u4ee5\u7528\u7c7b\u4f3c\u83ab\u961f\u7684\u65b9\u6cd5\u7ebf\u6027\u8f6c\u79fb\n\n\u8fd9\u91cc\u91c7\u7528\u5206\u6cbb\u7684\u65b9\u6cd5\u5b9e\u73b0\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,q,a[N],c[N];\nll f[N],g[N],w=0;\n#define inc(x) w+=c[a[x]]++\n#define dec(x) w-=--c[a[x]]\nvoid solve(int L,int R,int l,int r){\n    if(L>R)return;\n    int k=0,m=(L+R)>>1,t;\n    g[m]=inf;\n    Fur(i,L,m)inc(i);\n    Fur(i,MIN(m,r),l){\n        dec(i);\n        if(f[i]+w<g[m])g[m]=f[i]+w,k=i;\n    }\n\n    Fur(i,l,MIN(m,r))inc(i);\n    Fur(i,L,m)dec(i);\n    //\u8fd8\u539f\n\n    solve(L,m-1,l,k);    \n\n    Fur(i,L,m)inc(i);\n    Fur(i,l,k-1)dec(i);\n\n    solve(m+1,R,k,r);\n\n    Fur(i,L,m)dec(i);\n    Fur(i,l,k-1)inc(i);\n    //\u8fd8\u539f\n}\nint main(){\n    in(n,q);\n    Fur(i,1,n)\n        in(a[i]),\n        f[i]=f[i-1]+c[a[i]]++;\n    //\u7b2c\u4e00\u6b21\u76f4\u63a5\u7b97\n    \n    clr(c,0);\n    while(--q)//\u8f6c\u79fbk\u6b21,\u7701\u53bb\u4e00\u7ef4\n        solve(1,n,1,n),std::swap(f,g);\n\n    cout<<f[n]<<endl;\n}\n```\n", "link": "/posts/LG CF868F Yet-Another-Minimization-Problem/", "tags": ["\u51b3\u7b56\u5355\u8c03\u6027", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1549 \u68cb\u76d8\u95ee\u9898\uff082\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1549&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1549\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 11\nint n,a[N][N],zs[N*N];\nbool v[N*N];\nvoid zs()\nvoid dfs(int x,int y){\n    Fur(i,1,n*n)\n}\nint main(){\n    \n}\n```\n", "link": "/posts/LG 1549 \u68cb\u76d8\u95ee\u9898\uff082\uff09/", "tags": ["\u641c\u7d22"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF570D Tree Requests", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF570D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF570D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u9898\u610f\n\n\u4e00\u68f5\u4ee51\u4e3a\u6839\u7684\u6811,\u6bcf\u4e2a\u8282\u70b9\u4e0a\u90fd\u67091\u4e2a\u5b57\u6bcd,\u6709m\u4e2a\u8be2\u95ee\u3002\u6bcf\u6b21\u8be2\u95eev\u5bf9\u5e94\u7684\u5b50\u6811\u4e2d,\u6df1\u5ea6\u4e3ah\u7684\u8fd9\u5c42\u8282\u70b9\u7684\u5b57\u6bcd,\u80fd\u5426\u6253\u4e71\u91cd\u6392\u7ec4\u6210\u56de\u6587\u4e32\u3002\u6839\u7684\u6df1\u5ea6\u4e3a1,\u6bcf\u4e2a\u70b9\u7684\u6df1\u5ea6\u4e3a\u5230\u6839\u7684\u8ddd\u79bb\u3002\n\n<!-- more -->\n\n## \u601d\u8def\n\n\u4e00\u5c42\u7ed3\u70b9\u7684\u5b57\u6bcd\u662f\u5426\u80fd\u7ec4\u6210\u56de\u6587\u4e32,\u53ea\u9700\u89c2\u5bdf\u6bcf\u4e2a\u5b57\u6bcd\u51fa\u73b0\u6b21\u6570\u8981\u4e48\u90fd\u662f\u5076\u6570,\u8981\u4e48\u53ea\u6709\u4e00\u4e2a\u5b57\u6bcd\u5947\u6570\u6b21\u51fa\u73b0\u3002\n\n### \u89e3\u6cd5\u4e00\n\nDSU\n\n\u4e8c\u8fdb\u5236\u4f18\u5316,\u6bcf\u6b21\u90fd\u5f02\u6216\u4e0a\u5b57\u6bcd\u5bf9\u5e94\u7684\u4e8c\u8fdb\u5236\u4f4d,\u53ea\u9700\u8bb0\u5f55\u7b54\u68481\u4f4d\u662f\u5426<2\u5373\u53ef\u3002\n\n\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n#define M 500005\nusing namespace std;\nstruct query {\n    int de,id;\n};\nint n,m;\nvector<int>G[M];\nvector<query>Q[M];\nint L[M],R[M],ID[M],T;\nint dep[M],son[M],sz[M];\nint check[M],ans[M];\nchar A[M];\nvoid dfs(int v,int d) {\n    L[v]=++T;\n    ID[T]=v;\n    dep[v]=d,son[v]=0,sz[v]=1;\n    for(int i=0; i<G[v].size(); i++) {\n        int u=G[v][i];\n        dfs(u,d+1);\n        if(sz[u]>sz[son[v]])son[v]=u;\n        sz[v]+=sz[u];\n    }\n    R[v]=T;\n}\nvoid Add_point(int x,int a) {\n    int r=A[x]-'a',d=dep[x];\n    check[d]^=(1<<r);//\u4e8c\u8fdb\u5236\u4f18\u5316\n}\nvoid Add_tree(int x,int a) {\n    for(int i=L[x]; i<=R[x]; i++)Add_point(ID[i],a);\n}\nvoid Solve(int v) {\n    for(int i=0; i<G[v].size(); i++) {\n        int u=G[v][i];\n        if(u==son[v])continue;\n        Solve(u);\n        Add_tree(u,-1);\n    }\n    if(son[v])Solve(son[v]);\n    for(int i=0; i<G[v].size(); i++) {\n        int u=G[v][i];\n        if(u==son[v])continue;\n        Add_tree(u,1);\n    }\n    Add_point(v,1);\n    for(int i=0; i<Q[v].size(); i++){\n        int d=Q[v][i].de,r=check[d],id=Q[v][i].id;\n        ans[id]=(r==(r&-r));\n    }\n}\nint main() {\n    scanf(\"%d%d\",&n,&m);\n    for(int i=2,f; i<=n; i++) {\n        scanf(\"%d\",&f);\n        G[f].push_back(i);\n    }\n    dfs(1,1);\n    scanf(\"%s\",A+1);\n    for(int i=1; i<=m; i++) {\n        int x,d;\n        scanf(\"%d%d\",&x,&d);\n        Q[x].push_back((query) {d,i});\n    }\n    Solve(1);\n    for(int i=1; i<=m; i++)\n        if(ans[i])puts(\"Yes\");\n        else puts(\"No\");\n    return 0;\n}\n```\n### \u89e3\u6cd5\u4e8c\n\ndfs\u4f5c\u5dee\n\n\u540c\u6837\u662f\u4e8c\u8fdb\u5236,\u6bcf\u6b21\u8fdb\u7ed3\u70b9\u65f6\u8bb0\u5f55\u539f\u5148\u7684\u4e8c\u8fdb\u5236\u6570,\u51fa\u7ed3\u70b9\u65f6\u518d\u7528\u66f4\u65b0\u8fc7\u7684\u6570\u636e\u5f02\u6216\u4e0a\u539f\u6765\u7684\u5373\u4e3a\u7b54\u6848\u3002\n\n\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n#define M 500005\nusing namespace std;\nstruct query{\n    int de,id;\n};\nint n,m;\nvector<int>G[M],tmp[M];\nvector<query>Q[M];\nint cnt[M],ans[M];\nchar A[M];\nvoid dfs(int v,int d){\n    cnt[d]^=1<<A[v]-'a';\n    for(int i=0;i<Q[v].size();i++)\n        tmp[v].push_back(cnt[Q[v][i].de]);\n    for(int i=0;i<G[v].size();i++)\n        dfs(G[v][i],d+1);\n    for(int i=0;i<Q[v].size();i++)\n        ans[Q[v][i].id]=(tmp[v][i]^cnt[Q[v][i].de]);\n}\nint main(){\n    scanf(\"%d%d\",&n,&m);\n    for(int i=2,f;i<=n;i++){\n        scanf(\"%d\",&f);\n        G[f].push_back(i);\n    }\n    scanf(\"%s\",A+1);\n    for(int i=1;i<=m;i++){\n        int x,d;\n        scanf(\"%d%d\",&x,&d);\n        Q[x].push_back((query){\n            d,i\n        });\n    }\n    dfs(1,1);\n    for(int i=1;i<=m;i++)\n        puts(ans[i]==(ans[i]&-ans[i])?\"Yes\":\"No\");\n    return 0;\n}\n```\n### \u89e3\u6cd5\u4e09\n\n\u5728\u7ebf\u505a\u6cd5, \u5f02\u6216\u524d\u7f00\u548c\n\n\u53ea\u9700\u5c06\u6bcf\u4e2a\u6df1\u5ea6\u7684\u7ed3\u70b9\u6309\u7167`dfs`\u5e8f\u6392\u5230\u4e00\u4e2a`vector`\u91cc,\u540c\u65f6\u8bb0\u5f55\u6bcf\u4e2a\u5bf9\u5e94\u7684\u5f02\u6216\u524d\u7f00\u548c,\u5219\u5bf9\u4e8e\u4e00\u4e2a\u8be2\u95ee$x$,\u53ea\u9700\u5728\u7ed9\u5b9a\u6df1\u5ea6\u91cc\u627e\u6bd4$L[x]$\u5927\u7684\u548c\u6bd4$R[x]$\u5c0f\u7684\u4e24\u4e2a\u7aef\u70b9\u5373\u53ef,\u518d\u5f02\u6216\u4e00\u4e0b\u524d\u7f00\u548c\u5373\u53ef\u3002\n\n\u4ee3\u7801:\n\n```cpp\n#include<bits/stdc++.h>\n#define M 500005\nusing namespace std;\nint n,m;\nvector<int>G[M],deep[M],Xor[M];\nint L[M],R[M],ID[M],T,mxdep;\nint dep[M];\nchar A[M];\nvoid dfs(int v,int d) {\n    L[v]=++T;\n    ID[T]=v,dep[v]=d;\n    mxdep=max(mxdep,d);\n    deep[d].push_back(L[v]);\n    for(int i=0; i<G[v].size(); i++) {\n        int u=G[v][i];\n        dfs(u,d+1);\n    }\n    R[v]=T;\n}\nint main() {\n    scanf(\"%d%d\",&n,&m);\n    for(int i=2,f; i<=n; i++) {\n        scanf(\"%d\",&f);\n        G[f].push_back(i);\n    }\n    scanf(\"%s\",A+1);\n    dfs(1,1);\n    for(int i=1;i<=mxdep;i++){\n        Xor[i].push_back(1<<(A[ID[deep[i][0]]]-'a'));\n        for(int j=1;j<deep[i].size();j++)//\u5f02\u6216\u524d\u7f00\u548c\n            Xor[i].push_back(Xor[i][j-1]^(1<<(A[ID[deep[i][j]]]-'a')));\n    }\n    while(m--){\n        int x,d,ans=0;\n        scanf(\"%d%d\",&x,&d);\n        int l=lower_bound(deep[d].begin(),deep[d].end(),L[x])-deep[d].begin();\n        int r=upper_bound(deep[d].begin(),deep[d].end(),R[x])-deep[d].begin()-1;\n        //\u5728\u5f53\u524d\u6df1\u5ea6\u627exdfs\u5e8f\u4e4b\u5185\u7684\u70b9\n        if(r<0)puts(\"Yes\");\n        else {\n            if(l==0)ans=Xor[d][r];//\u5904\u7406\u524d\u7f00\u548c\n            else ans=Xor[d][r]^Xor[d][l-1];\n            if(ans==(ans&-ans))puts(\"Yes\");\n            else puts(\"No\");\n        }\n    }\n    return 0;\n}\n```\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 500011\nint n,q,head[N],cnt=0;\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nchar ch[N];\nint T[N],L[N],R[N],dfn=0,d[N],siz[N],son[N];\nvoid dfs(int x){\n    L[x]=++dfn;\n    T[dfn]=x;\n    siz[x]=1;son[x]=0;\n    fl(i,x){\n        d[to]=d[x]+1;\n        dfs(to);\n        if(siz[to]>siz[son[x]])son[x]=to;\n        siz[x]+=siz[to];\n    }\n    R[x]=dfn;\n}\nint sta[N];\nstruct node{\n    int d,id;\n};\nvector<node>que[N];\nbool ans[N];\nvoid Add(int x){\n    int r=ch[x]-'a',D=d[x];\n    sta[D]^=(1<<r);\n}\nvoid upd(int x){\n    Fur(i,L[x],R[x])Add(T[i]);\n}\nvoid sol(int x){\n    fl(i,x)if(to!=son[x]){\n        sol(to);\n        upd(to);\n    }\n    if(son[x])sol(son[x]);\n    fl(i,x)if(to!=son[x])upd(to);\n    Add(x);\n    for(int i=0;i<que[x].size();++i){\n        int D=que[x][i].d,r;r=sta[D];\n        ans[que[x][i].id]=(r==(r&-r));\n    }\n}\nint main(){\n    fin(\"in\");\n    in>>n>>q;\n    int x,y;\n    Fur(i,2,n)in>>x,add(x,i);\n    in>>(ch+1);\n    d[1]=1;dfs(1);\n    Fur(i,1,q)in>>x>>y,que[x].push_back(node{y,i});\n    sol(1);\n    Fur(i,1,q)out<<(ans[i]?\"Yes\":\"No\")<<ln;\n}\n```\n", "link": "/posts/LG CF570D Tree Requests/", "tags": ["\u9759\u6001\u94fe\u5206\u6cbb", "\u4f4d\u8fd0\u7b97", "\u4e8c\u8fdb\u5236"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3479 [POI2009]GAS-Fire-Extinguishers", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3479&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3479\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10001\nstruct edge{\n    int to,nxt;\n}e[N];\nint n,cnt=0,head[N],s,k;\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x,int f){\n    \n}\nint main(){\n    in>>n>>s>>k;\n    int x,y;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    dfs(1,0);\n}\n\n```\n", "link": "/posts/LG 3479 [POI2009]GAS-Fire-Extinguishers/", "tags": ["dfs", "\u6811\u578bdp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1110 \u8ddd\u79bb\u4e4b\u548c\u6700\u5c0f V3", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5c31\u662f\u76f4\u63a5\u6c42\u4e2d\u4f4d\u6570\u4f5c\u90a3\u4e2a\u70b9\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10001\nstruct node{\n\tint p,w;\n}a[N];\nbool cmp(node x,node y){\n\treturn x.p<y.p;\n}\nint n,s=0;\nint main(){\n\tfin(\"in\");\n\tin>>n;\n\tFur(i,1,n)in>>a[i].p>>a[i].w,s+=a[i].w;\n\tsort(a+1,a+n+1,cmp);\n\tint t=0;\n\tFur(i,1,n){\n\t\tt+=a[i].w;\n\t\tif(t*2>=s){\n\t\t\tll ans=0;\n\t\t\tFur(j,1,n)ans+=(1ll*ABS(a[j].p-a[i].p)*a[j].w);\n\t\t\tout<<ans<<ln;\n\t\t\treturn 0;\n\t\t}\n\t}\n}\n\n```\n", "link": "/posts/51nod 1110 \u8ddd\u79bb\u4e4b\u548c\u6700\u5c0f V3/", "tags": ["\u6392\u5e8f", "\u4e2d\u4f4d\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3069 [USACO13JAN]\u725b\u7684\u9635\u5bb9Cow Lineup", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3069&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3069\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u628a\u8840\u7edf\u7f16\u53f7\u79bb\u6563\u5316\n\n\u4e24\u4e2a\u70b9\u4e4b\u524d\u6700\u591a\u53ea\u80fd\u6709$k$\u79cd\u8840\u7edf\u7684\u725b,\u6240\u4ee5\u6211\u4eec\u8003\u8651\u4f7f\u7528$two\\ pointers$\n\n$O(n)$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,k,a[N],cnt[N];\nstruct node{\n\tint v,id;\n\tfriend bool operator<(node &x,node &y){\n\t\treturn x.v<y.v;\n\t}\n}b[N];\nint main(){\n\tin>>n>>k;\n\tb[0].v=-1;\n\tFur(i,1,n)in>>b[i].v,b[i].id=i;\n\tsort(b+1,b+n+1);\n\tint d=0;\n\tFur(i,1,n){\n\t\tif(b[i].v!=b[i-1].v)d++;\n\t\ta[b[i].id]=d;\n\t}\n\tint l=0,ans=0,t=0;\n\tFur(i,1,n){\n\t\tif(!cnt[a[i]])++t;\n\t\t++cnt[a[i]];\n\t\twhile(t>k+1)t-=!(--cnt[a[++l]]);\n\t\tans=MAX(ans,cnt[a[i]]);\n\t}\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 3069 [USACO13JAN]\u725b\u7684\u9635\u5bb9Cow Lineup/", "tags": ["\u53cc\u6307\u9488", "\u79bb\u6563\u5316"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2627 \u4fee\u526a\u8349\u576a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2627&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2627\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5355\u8c03\u961f\u5217\u4f18\u5316dp\n\n$f[i]$\u8868\u793a\u4ece$1-i$\u6700\u591a\u80fd\u9009\u51fa\u7684\u6548\u7387\n\n\u679a\u4e3e\u65ad\u70b9$j$,\n\n$f[i] = \\max(f[j-1]+ \\sum_{t=j+1}^i a[t])$\n\n\u4f46\u662f\u76f4\u63a5\u8fd9\u6837\u7684\u590d\u6742\u5ea6\u4e0d\u53ef\u884c\n\n\u6211\u4eec\u53ef\u4ee5\u8003\u8651\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316\n\n$f[i] = \\max(f[j-1] - S_j) + S_i$\n\n\n<!-- more -->\n\n```cpp\n#include<iostream>\n#include<cstdio>\nusing namespace std;\n#define ll long long\nll n,m,a[100010],sum[100010],f[100010];\nll d[100010];\nint q[100010],head=0,tail=1;\nll que(int i){\n    d[i]=f[i-1]-sum[i];\n    while(head<=tail&&d[q[tail]]<d[i])tail--;\n    q[++tail]=i;\n    while(head<=tail&&q[head]<i-m)head++;\n    return d[q[head]];\n}\nint main(){\n    scanf(\"%lld%lld\",&n,&m);\n    for(int i=1;i<=n;++i)scanf(\"%d\",a+i),sum[i]=sum[i-1]+a[i];\n    for(int i=1;i<=n;++i)f[i]=que(i)+sum[i];\n    cout<<f[n];\n}\n```\n", "link": "/posts/LG 2627 \u4fee\u526a\u8349\u576a/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5355\u8c03\u961f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2515 [HAOI2010]\u8f6f\u4ef6\u5b89\u88c5", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2515&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2515\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\ntarjan\u627e\u51fa\u5f3a\u8fde\u901a\u5206\u91cf\u4e4b\u540e\u6811\u5f62dp\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 151\n#define M 511\nint n,m,f[N][M];\nint W[N],V[N],D[N];\nint cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint dfn[N],low[N],sz=0,tp=0,st[N],bl[N],tt=0,w[N],vv[N];\nbool v[N];\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;v[x]=1;\n    st[++tp]=x;\n    fl(i,x)\n    if(!dfn[to])tarjan(to),low[x]=MIN(low[x],low[to]);\n    else if(v[to])low[x]=MIN(low[x],dfn[to]);\n\n    if(low[x]==dfn[x]){\n        ++tt;\n        while(int k=st[tp--]){\n            bl[k]=tt;v[k]=0;\n            w[tt]+=W[k];vv[tt]+=V[k];\n            if(k==x)break;\n        }\n    }\n}\nint ind[N];\nvoid sol(int x){\n    Fur(i,w[x],m)f[x][i]=vv[x];\n    fl(i,x){\n        sol(to);\n        int k=m-w[x];\n        Fdr(i,k,0)\n            Fur(j,0,i)\n            f[x][i+w[x]]=MAX(f[x][i+w[x]],f[to][j]+f[x][i+w[x]-j]);\n    }\n}\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    Fur(i,1,n)in>>W[i];\n    Fur(i,1,n)in>>V[i];\n    Fur(i,1,n){\n        in>>D[i];\n        if(D[i])add(D[i],i);\n    }\n    Fur(i,1,n)if(!dfn[i])tarjan(i);\n    clr(head,0);cnt=0;\n    Fur(i,1,n)\n    if(bl[D[i]]!=bl[i]){\n        add(bl[D[i]],bl[i]);\n        // out<<bl[D[i]]<<\" \"<<bl[i]<<ln;\n        ind[bl[i]]++;\n    }\n    Fur(i,1,n)if(!ind[i])add(0,i);\n    sol(0);\n    out<<f[0][m]<<ln;\n}\n```\n", "link": "/posts/LG 2515 [HAOI2010]\u8f6f\u4ef6\u5b89\u88c5/", "tags": ["tarjan", "\u6811\u5f62dp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF220B Little-Elephant-and-Array", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF220B&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF220B\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#include<bits/extc++.h>\nusing namespace __gnu_pbds;\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,sz,Q,a[N];\ngp_hash_table<int,int>cnt;\nstruct que{\n    int l,r,id;\n}q[N];\nil int bl(int x){return (x-1)/sz+1;}\nbool cmp(que x,que y){\n    if(bl(x.l)==bl(y.l))return x.r<y.r;\n    return x.l<y.l;\n}\nint ans=0,ANS[N];\nil void add(int x){\n    if(cnt[a[x]]==a[x])--ans;\n    ++cnt[a[x]];\n    if(cnt[a[x]]==a[x])++ans;\n}\nil void del(int x){\n    if(cnt[a[x]]==a[x])--ans;\n    --cnt[a[x]];\n    if(cnt[a[x]]==a[x])++ans;\n}\nint main(){\n    in(n,Q);sz=sqrt(n);\n    Fur(i,1,n)in(a[i]);\n    Fur(i,1,Q)in(q[i].l,q[i].r),q[i].id=i;\n    sort(q+1,q+Q+1,cmp);\n    int l=1,r=1;\n    if(++cnt[a[1]]==a[1])++ans;\n    Fur(i,1,Q){\n        Fur(j,l,q[i].l-1)del(j);\n        Fdr(j,l-1,q[i].l)add(j);\n        Fur(j,r+1,q[i].r)add(j);\n        Fdr(j,r,q[i].r+1)del(j);\n        ANS[q[i].id]=ans;\n        l=q[i].l;r=q[i].r;\n    }\n    Fur(i,1,Q)out(ANS[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG CF220B Little-Elephant-and-Array/", "tags": ["\u83ab\u961f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG UVA1316 Supermarket", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/UVA1316&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/UVA1316\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u540cusaco\u5de5\u4f5c\u8c03\u5ea6\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 10011\nint n;\nstruct node{\n    int p,d;\n}a[N];\nil bool cmp(node x,node y){\n    return x.d<y.d;\n}\nint main(){\nwhile(1){\n    in(n);\n    if(__)break;\n    Fur(i,1,n)in(a[i].p,a[i].d);\n    sort(a+1,a+n+1,cmp);\n    priority_queue<int,vector<int>,greater<int>>q;\n    ll ans=0;\n    Fur(i,1,n)\n        if(q.size()<a[i].d){\n            ans+=a[i].p;\n            q.push(a[i].p);\n        }\n        else if(a[i].p>q.top()){\n                ans+=a[i].p-q.top();\n                q.pop();\n                q.push(a[i].p);\n            }\n    \n    printf(\"%lld\\n\",ans);\n}\n}\n```\n", "link": "/posts/LG UVA1316 Supermarket/", "tags": ["\u8d2a\u5fc3", "\u5806"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP1684 FREQUENT - Frequent values", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP1684&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP1684\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u9884\u5904\u7406\u51fa\u4ee5$i$\u7ed3\u5c3e\u6700\u957f\u591a\u5c11\u4e2a\u8fde\u7eed\n\n\u7136\u540e$rmq$\u9884\u5904\u7406\n\n\u67e5\u8be2\u7684\u65f6\u5019\u8981\u5148\u67e5\u4ee5\u5de6\u7aef\u70b9\u5f00\u59cb\u6700\u957f\u591a\u5c11,\u7136\u540e\u518d\u6c42\u5269\u4e0b\u7684\u90a3\u6bb5\u533a\u95f4\n\n*\u6ce8\u610f\u591a\u7ec4\u6570\u636e*\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,q,a[N],f[18][N];\nint ask(int l,int r){\n    if(l>r)return 0;\n    int k=l2(r-l+1);\n    return MAX(f[k][l],f[k][r-(1<<k)+1]);\n}\nint main(){\n    fin(\"in\");\nwhile(1){\n    clr(a,0);clr(f,0);\n    in>>n;\n    if(!n)break;\n    in>>q;\n    Fur(i,1,n)in>>a[i];\n    Fur(i,1,n)f[0][i]=((a[i]==a[i-1])?f[0][i-1]+1:1);\n    Fur(k,1,17)\n        Fur(i,1,n-(1<<k)+1)\n        f[k][i]=MAX(f[k-1][i],f[k-1][i+(1<<(k-1))]);\n    int x,y,ans;\n    while(q--){\n        in>>x>>y;\n        ans=1;\n        while(a[x]==a[x+1]&&x<y)++x,++ans;\n        ++x;\n        out<<MAX(ans,ask(x,y))<<ln;\n    }\n}\n}\n```\n", "link": "/posts/LG SP1684 FREQUENT - Frequent values/", "tags": ["rmq"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1081 \u5f00\u8f66\u65c5\u884c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1081&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1081\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u7528set\u9884\u5904\u7406\u51fa\u79bb\u6bcf\u4e2a\u70b9\u6700\u8fd1\u7684\u70b9\u548c\u7b2c\u4e8c\u8fd1\u7684\u70b9\n\n\u4ece$n$~$1$ \u6bcf\u6b21\u5f80$set$\u91cc\u63d2\u5165{$a[i],i$} \u7136\u540e\u628a\u524d\u9a71\u540e\u7ee7\u627e\u51fa\u6765\u6bd4\u8f83\u4e00\u4e0b ~~\u5177\u4f53\u770b\u4ee3\u7801~~\n\n\uff08\u542c\u8bf4\u6709\u6392\u5e8f\u540e\u53cc\u5411\u94fe\u8868\u7684\u795e\u4ed9\u505a\u6cd5\uff09\n\n\u63a5\u7740\u7528\u500d\u589e\u5904\u7406\u51fa\u5f00$2^i$\u5faa\u73af\u6b21\u7684\u6570\u636e\n\n\u7136\u540e\u5c31\u76f4\u63a5\u66b4\u529b\n\n~~\u5177\u4f53\u770b\u4ee3\u7801,\u7801\u98ce\u6709\u70b9\u65b0\u5947~~\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint a[N],n,m,A[N],B[N],f[N][20],fa[N][20],fb[N][20],P,Q;\nstruct node{\n\tint v,id;\n\tbool operator < (const node&x) const{\n\t\treturn v<x.v;\n\t}\n};\nset<node>T;\nvoid work(int p,int l){\n    int i,j;\n    P=Q=0;\n    Fdr(i,19,0){\n        if(f[p][i]&&P+Q+fa[p][i]+fb[p][i]<=l){\n            P+=fa[p][i];\n            Q+=fb[p][i];\n            p=f[p][i];\n        }\n    }\n    if(A[p]&&P+Q+fa[p][0]<=l)P+=fa[p][0];\n}\nint main(){\n\tin>>n;\n\tFur(i,1,n)in>>a[i];\n\tT.insert(node{a[n],n});\n\tFdr(i,n-1,1){\n\t\tset<node>::iterator it=T.lower_bound(node{a[i],i});\n\t\tnode t1,t2;\n\t\tt1.v=t2.v=inf;\n\t\tt1.id=t2.id=0;\n\t\tif((*it).v>a[i]){\n\t\t\tt1=(*it);\n\t\t\tif(++it!=T.end())t2=*it;\n\t\t\tit--;\n\t\t}\n\t\tif(it!=T.begin()){\n\t\t\tnode t=*--it;\n\t\t\t\n\t\t\tif(ABS(t.v-a[i])<ABS(t1.v-a[i]))t2=t1,t1=t;\n\t\t\telse if(ABS(t.v-a[i])==ABS(t1.v-a[i])&&t.v<t1.v)t2=t1,t1=t;\n\t\t\telse if(ABS(t.v-a[i])<ABS(t2.v-a[i]))t2=t;\n\t\t\telse if(ABS(t.v-a[i])==ABS(t2.v-a[i])&&t.v<t2.v)t2=t;\n\t\t\t\n\t\t\tif(it!=T.begin()){\n\t\t\t\tt=*--it;\n\t\t\t\t\n\t\t\t\tif(ABS(t.v-a[i])<ABS(t1.v-a[i]))t2=t1,t1=t;\n\t\t\t\telse if(ABS(t.v-a[i])==ABS(t1.v-a[i])&&t.v<t1.v)t2=t1,t1=t;\n\t\t\t\telse if(ABS(t.v-a[i])<ABS(t2.v-a[i]))t2=t;\n\t\t\t\telse if(ABS(t.v-a[i])==ABS(t2.v-a[i])&&t.v<t2.v)t2=t;\n\t\t\t}\n\t\t}\n\t\tB[i]=t1.id;A[i]=t2.id;\n\t\tT.insert(node{a[i],i});\n\t}\n\tFur(i,1,n){\n\t\tf[i][0]=B[A[i]];\n\t\tfa[i][0]=ABS(a[i]-a[A[i]]);\n\t\tfb[i][0]=ABS(a[A[i]]-a[B[A[i]]]);\n\t}\n\tFur(k,1,19)\n\t\tFur(i,1,n){\n\t\t\tf[i][k]=f[f[i][k-1]][k-1];\n\t\t\tfa[i][k]=fa[i][k-1]+fa[f[i][k-1]][k-1];\n\t\t\tfb[i][k]=fb[i][k-1]+fb[f[i][k-1]][k-1];\n\t\t}\n\tint x,len,ans=0;\n\tdb as=inf;\n\tin>>len;\n\tFur(i,1,n){\n\t\twork(i,len);\n\t\tif(Q){\n\t\t\tif(1.0*P/Q<as)as=1.0*P/Q,ans=i;\n\t\t}\n\t\telse if(a[i]>a[ans]&&as==inf)ans=i;\n\t}\n\tout<<ans<<ln;\n\tin>>m;\n\twhile(m--){\n\t\tin>>x>>len;\n\t\twork(x,len);\n\t\tout<<P<<\" \"<<Q<<ln;\n\t}\n}\n```\n", "link": "/posts/LG 1081 \u5f00\u8f66\u65c5\u884c/", "tags": ["\u500d\u589e", "set"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF343D Water-Tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF343D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF343D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u76f4\u63a5\u6811\u5256\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500011\nint n;\nstruct edge{\n    int to,nxt;\n}e[N*2];\nint cnt=0,head[N],d[N],top[N],f[N],siz[N],id[N],sz=0;\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;\n    id[x]=++sz;\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nstruct seg{\n    #define ls rt<<1\n    #define rs rt<<1|1\n    #define pu s[rt]=s[ls]|s[rs]\n    int s[N<<2],laz[N<<2];\n    seg(){clr(laz,-1);}\n    void pd(int rt){\n        if(~laz[rt]){\n            laz[ls]=laz[rs]=s[ls]=s[rs]=laz[rt];\n            laz[rt]=-1;\n        }\n    }\n    void upd(int L,int R,int v,int l,int r,int rt){\n        if(L<=l&&r<=R){\n            s[rt]=laz[rt]=v;\n            return;\n        }\n        int m=(l+r)>>1;\n        pd(rt);\n        if(L<=m)upd(L,R,v,l,m,ls);\n        if(R>m)upd(L,R,v,m+1,r,rs);\n        pu;\n    }\n    int get(int x,int l,int r,int rt){\n        if(!s[rt])return 0;\n        if(l==r)return s[rt];\n        int m=(l+r)>>1;\n        pd(rt);\n        if(x<=m)return get(x,l,m,ls);\n        else return get(x,m+1,r,rs);\n    }\n}T;\nint main(){\n    in(n);\n    int x,y,q,opt;\n    Fur(i,1,n-1){\n        in(x,y);\n        add(x,y);add(y,x);\n    }\n    dfs(1);bt(1,1);\n    in(q);\n    while(q--){\n        in(opt,x);\n        if(opt==1)\n            T.upd(id[x],id[x]+siz[x]-1,1,1,n,1);\n        \n        if(opt==2){\n            while(top[x]!=1){\n                T.upd(id[top[x]],id[x],0,1,n,1);\n                x=f[top[x]];\n            }\n            T.upd(1,id[x],0,1,n,1);\n        }\n        if(opt==3)pt(T.get(id[x],1,n,1)?'1':'0'),pt('\\n');\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF343D Water-Tree/", "tags": ["\u6811\u94fe\u5256\u5206", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1029E Tree-with-Small-Distances", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1029E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1029E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u89e3\u6cd51:\n\n\u8d2a\u5fc3\n\n\u628a\u6df1\u5ea6\u5927\u4e8e2\u7684\u90fd\u52a0\u5230\u5806\u4e2d\n\n\u6bcf\u6b21\u53d6\u51fa\u6df1\u5ea6\u6700\u5927\u7684\u70b9\n\n\u4ece\u6839\u7ed3\u70b9\u5f80\u5b83\u7236\u4eb2\u8fde\u8fb9\n\n\u7136\u540e\u628a\u5468\u56f4\u7684\u8282\u70b9\u6807\u8bb0\u4e3a\u5df2\u7ecf\u8986\u76d6\n\n## \u89e3\u6cd52:\n\n\u6811\u5f62dp\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,d[N],head[N],cnt=0;\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint f[N];\nvoid dfs(int x){\n    fl(i,x)if(to!=f[x]){\n        d[to]=d[x]+1;f[to]=x;\n        dfs(to);\n    }\n}\nstruct cmp{\n    bool operator()(int x,int y){return d[x]<d[y];}\n};\npriority_queue<int,vector<int>,cmp>q;\nbool v[N];\nint main(){\n    in(n);\n    int x,y,ans=0;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    dfs(1);\n    Fur(i,1,n)if(d[i]>2)q.push(i);\n    while(!q.empty()){\n        x=q.top();q.pop();\n        if(v[x])continue;\n        x=f[x];v[x]=1;\n\n        ++ans;\n        fl(i,x)v[to]=1;\n    }\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG CF1029E Tree-with-Small-Distances/", "tags": ["\u8d2a\u5fc3", "\u6811\u5f62dp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3924 \u5eb7\u5a1c\u7684\u7ebf\u6bb5\u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3924&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3924\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define int __int128\nusing namespace std;\nconst int MAXN = 1e6 + 10;\ninline int read() {\n    char c = getchar(); int x = 0, f = 1;\n    while(c < '0' || c > '9') {if(c == '-') f = -1; c = getchar();}\n    while(c >= '0' && c <= '9') x = x * 10 + c - '0', c = getchar();\n    return x * f;\n}\nvoid print(int x) {\n    if(x < 0) putchar('-'), x = -x;\n    if (x > 9) print(x / 10);\n    putchar('0' + x % 10);\n}\nint N, M, qwq, s[MAXN], a[MAXN], ans, Lim;\nint get(int dep) {\n    return 1 << (Lim - (dep - 1));\n}\nvoid Build(int l, int r, int dep, int sum) {\n    ans += (a[r] - a[l - 1]) * get(dep);\n    if(l == r) {s[l] = sum + get(dep); return ;}\n    int mid = l + r >> 1;\n    Build(l, mid, dep + 1, sum + get(dep)); \n    Build(mid + 1, r,dep + 1, sum + get(dep));\n}\nsigned main() {\n    N = read(); M = read(); qwq = read();\n    for(int cur = 1; cur <= N; Lim ++, cur <<= 1);\n    for(int i = 1; i <= N; i++) a[i] = read(), a[i] += a[i - 1];\n    Build(1, N, 1, 0);\n    for(int i = 1; i <= N; i++) s[i] += s[i - 1];\n    while(M--) {\n        int l = read(), r = read(), v = read();\n        ans += ((s[r] - s[l - 1]) * v);\n        print(((ans * qwq) >> Lim)); putchar('\\n');\n    }\n    return 0;\n}\n```\n", "link": "/posts/LG 3924 \u5eb7\u5a1c\u7684\u7ebf\u6bb5\u6811/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG UVA348 Optimal Array-Multiplication-Sequence", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/UVA348&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/UVA348\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bb0\u5fc6\u5316\u641c\u7d22\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define N 15\nint n,f[N][N],g[N][N],cnt;\nstruct node{\n    int al,ar,yk,zk;\n}a[N];\nvoid init(){\n    memset(a,0,sizeof(a));\n    memset(g,0,sizeof(g));\n    memset(f,0x3f,sizeof(f));\n    for(int i=1;i<=n;++i)scanf(\"%d %d\",&a[i].al,&a[i].ar);\n}\nint solve(int l,int r){\n    if(f[l][r]!=0x3f3f3f3f)return f[l][r];\n    if(l>=r)return f[l][r]=0;\n    int pos=0;\n    for(int k=l;k<r;++k){\n        int temp=solve(l,k)+solve(k+1,r)+a[l].al*a[k].ar*a[r].ar;\n        if(temp<f[l][r])pos=k,f[l][r]=temp;\n    }\n    g[l][r]=pos;\n    return f[l][r];\n}\nvoid dfs(int l,int r){\n    if(l==r)return ;\n    a[l].zk++,a[r].yk++;\n    dfs(l,g[l][r]),dfs(g[l][r]+1,r);\n}\nvoid out(){\n    printf(\"Case %d: \",++cnt);\n    for(int i=1;i<=n;++i){\n        if(i!=1)printf(\" x \");\n        while(a[i].zk)putchar('('),a[i].zk--;\n        printf(\"A%d\",i);\n        while(a[i].yk)putchar(')'),a[i].yk--;\n    }\n    putchar('\\n');\n}\nint main(){\n    while(scanf(\"%d\",&n)&&n){\n        init();\n        solve(1,n);\n        dfs(1,n);\n        out();\n    }\n}\n```\n", "link": "/posts/LG UVA348 Optimal Array-Multiplication-Sequence/", "tags": ["dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3018 [USACO11MAR]\u6811\u88c5\u9970Tree Decoration", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3018&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3018\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define int ll\nint n,f[N],c[N],v[N],w[N],q[N],t[N];\nsigned main(){\n    fin(\"in\");\n    in>>n;\n    Fur(i,1,n){\n        in>>f[i]>>w[i]>>v[i];\n        if(f[i]!=-1)c[f[i]]++;\n    }\n    int tp=0;ll ans=0;\n    Fur(i,1,n)if(!c[i])q[++tp]=i;\n    while(tp){\n        int x=q[tp--];\n        if(w[x]-t[x]>0)ans+=1ll*(w[x]-t[x])*v[x];\n        if(f[x]==-1)break;\n        t[f[x]]+=MAX(w[x],t[x]);v[f[x]]=MIN(v[f[x]],v[x]);\n        if(--c[f[x]]==0)q[++tp]=f[x];\n    }\n    out<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 3018 [USACO11MAR]\u6811\u88c5\u9970Tree Decoration/", "tags": ["\u62d3\u6251\u5e8f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3917 \u5f02\u6216\u5e8f\u5217", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3917&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3917\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u5b9a\u4e49\u7b2cx\u4e2a\u6570\u4e2d\u4ece\u53f3\u5f80\u5de6\u6570\u7b2ci\u4f4d\u7684\u8d21\u732e\uff1a\u6709\u591a\u5c11\u4e2a\u5728x\u4e4b\u524d\u7684\u6570j\u6ee1\u8db3$a_j \\bigoplus a_{j+1} \\bigoplus ... \\bigoplus a_x$\u7684\u7b2c$i$\u4f4d\u662f$1$.\n\n\u8bbe$f[x][i]$\u8868\u793a\u7b2cx\u4e2a\u6570\u7b2c$i$\u4f4d\u7684\u8d21\u732e,$a[x][i]$\u8868\u793a\u7b2c$x$\u4e2a\u6570\u7b2c$i$\u4f4d\u662f\u591a\u5c11\u3002\n\n\u82e5$a[x][i]=0$,\u53d6$j=x$\u4e0d\u4f1a\u4ea7\u751f\u8d21\u732e\u3002\u82e5$j < x,aj \\bigoplus a_{j+1} \\bigoplus ... \\bigoplus a_x=a_j \\bigoplus a_{j+1} \\bigoplus ... \\bigoplus a_{x-1}$\u3002\u6240\u4ee5$f[x][i]=f[x-1][i]$.\n\n\u82e5$a[x][i]=1$,\u53d6$j=x$\u4ea7\u751f$1$\u7684\u8d21\u732e\u3002\u82e5$j$\u5c0f\u4e8e$x,aj \\bigoplus a_{j+1} \\bigoplus ... \\bigoplus a_x$\u548c$a_j \\bigoplus a_{j+1} \\bigoplus ... \\bigoplus a_{x-1}$\u76f8\u53cd\u3002\u6240\u4ee5$f[x][i]=(x-1-f[x-1][i])(j\u5c0f\u4e8ex\u7684\u8d21\u732e\uff09+1(j=x\u7684\u8d21\u732e\uff09=x-f[x-1][i]$.\n\n\u8bbe$f[x]=f[x][0]\u00d71+f[x][1]\u00d72+f[x][2]\u00d74+...+f[x][31]\u00d72^{31}$.\n\n\u5219\u7b54\u6848\u5c31\u662f$f[1]+f[2]+...+f[n]$.\n\n\u53ef\u4ee5\u7528\u6eda\u52a8\u6570\u7ec4\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,a,f[32];\nlong long ans;\nint main(){\n    int i,j;\n    scanf(\"%d\",&n);\n    for(i=1;i<=n;++i){\n        scanf(\"%d\",&a);\n        for(j=31;j>-1;--j){\n            if(a&(1<<j)) f[j]=i-f[j];\n            ans+=1LL*f[j]*(1<<j);\n        }\n    }\n    printf(\"%lld\",ans);\n}\n```\n", "link": "/posts/LG 3917 \u5f02\u6216\u5e8f\u5217/", "tags": ["\u4f4d\u8fd0\u7b97"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP913 Query on a tree II", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP913&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP913\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nstruct edge{\n\tint to,nxt,w;\n}e[N*2];\nint head[N],cnt=0,f[N][31],dis[N],d[N],n;\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n\tfor(int i=1;(1<<i)<=d[x];i++)\n\tif(f[x][i-1])f[x][i]=f[f[x][i-1]][i-1];\n\tfl(i,x)if(to!=f[x][0]){\n\t\td[to]=d[x]+1;f[to][0]=x;\n\t\tdis[to]=dis[x]+e[i].w;\n\t\tdfs(to);\n\t}\n}\nint lca(int a,int b){\n\tif(d[a]<d[b])SWAP(a,b);\n\tFdr(i,30,0)\n\t\tif(d[b]<=d[a]-(1<<i))a=f[a][i];\n\tif(a==b)return a;\n\tFdr(i,30,0)\n\t\tif(f[a][i]!=f[b][i])a=f[a][i],b=f[b][i];\n\treturn f[a][0];\n}\nint ask(int a,int b,int k){\n\tint tp=lca(a,b);\n\tif(d[a]-d[tp]+1>=k){\n\t\tint res=d[a]-k+1;\n\t\tFdr(i,30,0)if((1<<i)<=d[a]-res)a=f[a][i];\n\t\treturn a;\n\t}\n\telse{\n\t\tint res=d[tp]*2+k-d[a]-1;\n\t\tFdr(i,30,0)\n\t\tif(d[b]-(1<<i)>=res)b=f[b][i];\n\t\treturn b;\n\t}\n}\nint main(){\n\tfin(\"in\");\n\tint T;\n\tin>>T;\n\twhile(T--){\n\t\tclr(head,0);cnt=0;\n\t\tclr(f,0);\n\t\tclr(dis,0);\n\t\tclr(d,0);\n\t\tin>>n;\n\t\tint x,y,w;\n\t\tFur(i,1,n-1)in>>x>>y>>w,add(x,y,w),add(y,x,w);\n\t\tdfs(1);\n\t\tchar ch[20];\n\t\twhile(1){\n\t\t\tin>>ch;if(ch[1]=='O')break;\n\t\t\tif(ch[0]=='D')in>>x>>y,out<<dis[x]+dis[y]-dis[lca(x,y)]*2<<ln;\n\t\t\telse in>>x>>y>>w,out<<ask(x,y,w)<<ln;\n\t\t}\n\t}\n}\n\n```\n", "link": "/posts/LG SP913 Query on a tree II/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3964 [TJOI2013]\u677e\u9f20\u805a\u4f1a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3964&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3964\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e24\u70b9\u4e4b\u95f4\u8ddd\u79bb\u4e3a$MAX(|x-x'|,|y-y'|)$\n\n\u8fd9\u79cd\u8ddd\u79bb\u597d\u50cf\u53eb\u505a\u5207\u6bd4\u96ea\u592b\u8ddd\u79bb\n\n> \u5957\u8def\uff1a\n>\n> \u5c06\u4e00\u4e2a\u70b9 $\\color{Blue}{(x,y)(x,y)}$ \u7684\u5750\u6807\u53d8\u4e3a $\\color{Blue}{(x+y,x-y)(x+y,x\u2212y)}$\u540e,\u539f\u5750\u6807\u7cfb\u4e2d\u7684\u66fc\u54c8\u987f\u8ddd\u79bb = \u65b0\u5750\u6807\u7cfb\u4e2d\u7684\u5207\u6bd4\u96ea\u592b\u8ddd\u79bb\n> \n> \u90a3\u4e48\uff1a\n> \u5c06\u4e00\u4e2a\u70b9 $\\color{Blue}{(x,y)(x,y)}$ \u7684\u5750\u6807\u53d8\u4e3a $\\color{Blue}{(\\frac{x+y}{2},\\frac{x-y}{2})}$\u540e,\u539f\u5750\u6807\u7cfb\u4e2d\u7684\u5207\u6bd4\u96ea\u592b\u8ddd\u79bb = \u65b0\u5750\u6807\u7cfb\u4e2d\u7684\u66fc\u54c8\u987f\u8ddd\u79bb!\n\n\u5047\u8bbe\u5f53\u524d\u6240\u6709\u677e\u9f20\u6765$x$\n\n\u8bbe$\\Delta X(a,b) = |a_x - b_x| , \\Delta Y(a,b) = |a_y-b_y|$\n\n$$\nans =\\sum_{i=1}^n d(i,x)\n\\\\\\\\\n= \\sum_{i=1}^n\\Delta X(i,x) + \\sum_{i=1}^n \\Delta Y(i,x)\n\n$$\n\n\u5047\u5b9a$x$,\u548c$y$\u90fd\u662f\u6709\u5e8f\u7684\u3002\n\n\u90a3\u662f\u4e0d\u662f\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u5462\uff1f\n\n$lowerbound$\u4e00\u4e0b,\u524d\u540e\u53cd\u8fc7\u6765\u5c31\u53ef\u4ee5\u4e86\n\n\u6700\u540e:\u8bb0\u5f97\u52a0 $\\color{red}{long\\ long}$ !\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nstruct node{\n\tint x,y;\n}a[N];\nint x[N],y[N],n;\nll sx[N],sy[N];\nint main(){\n\tin>>n;\n\tint p,q;\n\tFur(i,1,n){\n\t\tin>>p>>q;\n\t\tx[i]=a[i].x=p+q;\n\t\ty[i]=a[i].y=p-q;\n\t}\n\tsort(x+1,x+n+1);\n\tsort(y+1,y+n+1);\n\tFur(i,1,n)\n\t\tsx[i]=sx[i-1]+x[i],\n\t\tsy[i]=sy[i-1]+y[i];\n\tll ans=1ll<<62,res;\n\tFur(i,1,n){\n\t\tres=0;\n\t\tint p=lower_bound(x+1,x+n+1,a[i].x)-x;\n\t\tres+=sx[n]-sx[p]-1ll*a[i].x*(n-p)+1ll*a[i].x*p-sx[p];\n\t\t\n\t\tp=lower_bound(y+1,y+n+1,a[i].y)-y;\n\t\tres+=sy[n]-sy[p]-1ll*a[i].y*(n-p)+1ll*a[i].y*p-sy[p];\n\t\t\n\t\tans=MIN(ans,res);\n\t}\n\tout<<(ll)(ans/2ll)<<ln;\n}\n```\n", "link": "/posts/LG 3964 [TJOI2013]\u677e\u9f20\u805a\u4f1a/", "tags": ["\u679a\u4e3e", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP3871 GCDEX", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP3871&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP3871\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nGCD-Extreme\ntop: 0\n\n\u8bbe$g(n) = \\sum_{i=1}^{n-1} \\gcd(i,n)$\n\n$$\n\n\\sum_{i=1}^{n-1} \\sum_{j=i+1}^n \\gcd(i,j)\n\n\\\\\\\\\n\n= \\sum_{i=1}^n g(i)\n\n$$\n\n$$\n\ng(n) = \\sum_{i=1}^{n-1} \\gcd(i,n)\n\n\\\\\\\\\n\n= \\sum_{d|n}d \\sum_{i=1}^{n-1}[gcd(i,n)=d]\n\n\\\\\\\\\n\n= \\sum_{d|n}d \\sum_{i=1}^{\\frac nd - 1}[gcd(i,n)=1]\n\n\\\\\\\\\n\n= \\sum_{d|n}d \\times \\varphi(\\frac nd);\n\n$$\n\n\u6c42\u51fa$g$\u7684\u524d\u7f00\u548c\n\n\u53ef\u4ee5\u7528\u7b5b\u7684\u65b9\u5f0f\u6c42$g$\n\n$O(n \\sqrt n + T);$\n\n\u4e0d\u80fd\u7528\u4e4b\u524d\u7684\u5957\u8def,\u5426\u5219\u4f1atle\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nint phi[N],pri[N],tot=0;\nll ans[N];\nbool f[N];\nvoid ol(int n){\n\tphi[1]=0;\n\tFur(i,2,n){\n\t\tif(!f[i])phi[i]=i-1,pri[++tot]=i;\n\t\tFur(j,1,tot){\n\t\t\tif(pri[j]*i>n)break;\n\t\t\tf[pri[j]*i]=1;\n\t\t\tif(i%pri[j])phi[i*pri[j]]=phi[i]*phi[pri[j]];\n\t\t\telse{\n\t\t\t\tphi[i*pri[j]]=phi[i]*pri[j];\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tFur(i,1,n)ans[i]=phi[i];\n\tint len=sqrt(n);\n\tFur(i,2,len){\n\t\tans[i*i]+=phi[i]*i;\n\t\tfor(int j=i+1;i*j<=n;j++)\n\t\tans[i*j]+=phi[i]*j+phi[j]*i;\n\t}\n\tans[1]=0;\n\tFur(i,2,n)ans[i]+=ans[i-1];\n}\nint main(){\n\tol(1000000);\n\tint n;in>>n;\n\twhile(n){\n\t\tout<<ans[n]<<ln;\n\t\tin>>n;\n\t}\n}\n```\n", "link": "/posts/LG SP3871 GCDEX/", "tags": ["\u6570\u8bba", "\u524d\u7f00\u548c", "\u6b27\u62c9\u51fd\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2900 [USACO08MAR]\u571f\u5730\u5f81\u7528Land-Acquisition", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2900&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2900\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_i$\u8868\u793a\u524d$i$\u5757\u571f\u5730\n\n$$\nf_i=\\min_{j=1}^{i-1}(f_j+maxw[j-1][i]\\times maxh[j-1][i])\n$$\n\n\u8fd9\u6837\u7684\u8bdd\u600e\u4e48\u60f3\u90fd\u6ca1\u6709\u529e\u6cd5\u4f18\u5316\n\n\u6211\u4eec\u53d1\u73b0,\u5982\u679c\u4e00\u5757\u571f\u5730\u88ab\u53e6\u4e00\u5757\u571f\u5730\u6240\u5305\u542b(\u5373\u957f\u548c\u5bbd\u90fd\u6bd4\u53e6\u4e00\u5757\u571f\u5730\u5c0f),\n\n\u90a3\u4e48\u53ea\u9700\u8d2d\u4e70\u90a3\u53e6\u4e00\u5757\u571f\u5730\u5373\u53ef,\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u636e\u6b64\u7b5b\u6389\u5176\u4ed6\u7684\u571f\u5730,\n\n\u53ea\u5269\u4e0b\u4e00\u4e9b\u957f\u5ea6\u9012\u51cf,\u5bbd\u5ea6\u9012\u589e\u7684\u571f\u5730\n\n\u90a3\u4e48\uff1a\n\n$$\nf_i=\\min_{j=1}^{i-1}(f_j+l[j+1]\\times w[i])\n$$\n\n\u8bbe\u4efb\u610f$0\\le j<k<i$,\u82e5\u4ece$j$\u8f6c\u79fb\u6bd4\u4ece$k$\u8f6c\u79fb\u4f18,\u90a3\u4e48\n\n$$\nf_j+l[j+1]\\times w[i]\\le f_k+l[k+1]\\times w[i]\n\\\\\nw[i](l[j+1]-l[k+1])\\le f_k-f_j\n\\\\\nw[i]\\le \\frac{f_k-f_j}{l[j+1]-l[k+1]}\n$$\n\n\u7ef4\u62a4\u4e00\u4e2a\u4e0b\u51f8\u58f3\u5c31\u5b8c\u4e8b\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 50011\n#define int ll\nint n,f[N],q[N],l[N],w[N];\nstruct node{\n    int l,w;\n}a[N];\nbool cmp(node x,node y){\n    if(x.l!=y.l)return x.l>y.l;\n    return x.w<y.w;    \n}\ndb S(int i,int j){\n    return ((db)(f[j]-f[i]))/((db)(l[i+1]-l[j+1]));\n}\nsigned main(){\n    in(n);\n    Fur(i,1,n)in(a[i].w,a[i].l);\n    sort(a+1,a+n+1,cmp);\n    int h=1,t=1,d=0,mx=0;\n    Fur(i,1,n)\n    if(a[i].w>mx){\n        mx=a[i].w;\n        w[++d]=a[i].w;\n        l[d]=a[i].l;\n    }\n    n=d;\n    Fur(i,1,n){\n        while(h<t&&S(q[h],q[h+1])<=(db)w[i])++h;\n        f[i]=f[q[h]]+l[q[h]+1]*w[i];\n        while(h<t&&S(q[t-1],q[t])>=S(q[t-1],i))--t;\n        q[++t]=i;\n    }\n    cout<<f[n]<<endl;\n}\n```\n", "link": "/posts/LG 2900 [USACO08MAR]\u571f\u5730\u5f81\u7528Land-Acquisition/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u659c\u7387\u4f18\u5316"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3950 \u90e8\u843d\u51b2\u7a81", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3950&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3950\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$lct$\u65e0\u8111\u505a\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\n#define ls c[x][0]\n#define rs c[x][1]\nint st[N],f[N],c[N][2],v[N],s[N];\nbool rev[N];\nbool irt(int x){return c[f[x]][0]!=x&&c[f[x]][1]!=x;}\nvoid pr(int x){\n\tSWAP(ls,rs);\n\trev[x]^=1;\n}\nvoid pd(int x){\n\tif(rev[x]){\n\t\tif(ls)pr(ls);\n\t\tif(rs)pr(rs);\n\t\trev[x]=0;\n\t}\n}\nbool g(int x){return c[f[x]][1]==x;}\nvoid turn(int x){\n\tint y=f[x],z=f[y],l=g(x),r=!l,w=c[x][r];\n\tif(!irt(y))c[z][g(y)]=x;\n\tc[x][r]=y;c[y][l]=w;\n\tif(w)f[w]=y;\n\tf[x]=z;f[y]=x;\n}\nvoid splay(int x){\n\tint y=x,z=0;\n\tst[++z]=y;\n\twhile(!irt(y))st[++z]=y=f[y];\n\twhile(z)pd(st[z--]);\n\twhile(!irt(x)){\n\t\ty=f[x],z=f[y];\n\t\tif(!irt(y))\n\t\t\tturn(((c[y][0]==x)^(c[z][0]==y))?x:y);\n\t\tturn(x);\n\t}\n}\nvoid access(int x){\n\tfor(int y=0;x;x=f[y=x])\n\t\tsplay(x),rs=y;\n}\nvoid mrt(int x){\n\taccess(x);splay(x);\n\tpr(x);\n}\nint frt(int x){\n\taccess(x);splay(x);\n\twhile(ls)pd(x),x=ls;\n\tsplay(x);\n\treturn x;\n}\nvoid link(int x,int y){\n\tmrt(x);\n\tif(frt(y)!=x)f[x]=y;\n}\nvoid cut(int x,int y){\n\tmrt(x);\n\tif(frt(y)==x&&f[y]==x&&!c[y][0])\n\t\tc[x][1]=f[y]=0;\n}\nint n,m,X[N],Y[N],cnt=0;\nint main(){\n\tin>>n>>m;\n\tint x,y;char u;\n\tFur(i,1,n-1)in>>x>>y,link(x,y);\n\twhile(m--){\n\t\tin>>u>>x;\n\t\tif(u=='Q')in>>y,out<<(frt(x)==frt(y)?\"Yes\":\"No\")<<ln;\n\t\tif(u=='C')in>>y,cut(x,y),X[++cnt]=x,Y[cnt]=y;\n\t\tif(u=='U')link(X[x],Y[x]);\n\t}\n}\n```\n", "link": "/posts/LG 3950 \u90e8\u843d\u51b2\u7a81/", "tags": ["lct"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1037C Equalize", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1037C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1037C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u4ea4\u6362\u76f8\u90bb\u4e24\u4e2a\u4f4d\u7f6e\u75282\u64cd\u4f5c\u66f4\u4f18,\u5176\u4ed6\u7684\u75281\u64cd\u4f5c\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1000011\nint n,f[N];\nchar a[N],b[N];\nint main(){\n    in(n);\n    in(a+1),in(b+1);\n    f[0]=0;\n    Fur(i,1,n){\n        f[i]=f[i-1]+(a[i]!=b[i]);\n        if(i>=2&&a[i]!=b[i]&&a[i-1]!=b[i-1]&&a[i-1]!=a[i])f[i]=MIN(f[i],f[i-2]+1);\n    }\n    cout<<f[n]<<endl;\n}\n```\n", "link": "/posts/LG CF1037C Equalize/", "tags": ["\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1784 \u6570\u72ec", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1784&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1784\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint a[10][10],bl[10][10];\nbool h[10][10],l[10][10],block[10][10];\nint belong(int x,int y){\n    int p=(x-1)/3+1,q=(y-1)/3+1;\n    return (p-1)*3+q;\n}\nvoid add(int i,int j,int k){\n    l[i][k]^=1;\n    h[j][k]^=1;\n    block[bl[i][j]][k]^=1;\n}\nil bool chk(int x,int y,int k){\n    return !(l[x][k]||h[y][k]||block[bl[x][y]][k]);\n}\nil void op(){\n    Fur(i,1,9){\n        Fur(j,1,9)cout<<a[i][j]<<\" \";\n        cout<<endl;\n    }\n    exit(0);\n}\nvoid dfs(int x,int y){\n    if(a[x][y]){\n        if(x==9&&y==9)op();\n        if(y==9)dfs(x+1,1);\n        else dfs(x,y+1);\n    }\n    else\n    Fur(i,1,9)\n    if(chk(x,y,i)){\n        a[x][y]=i;\n        add(x,y,i);\n        if(x==9&&y==9)op();\n        if(y==9)dfs(x+1,1);\n        else dfs(x,y+1);\n        add(x,y,i);\n        a[x][y]=0;\n    }\n}\nint main(){\n    Fur(i,1,9)\n        Fur(j,1,9)\n        bl[i][j]=belong(i,j);\n\n    Fur(i,1,9)  \n        Fur(j,1,9){\n            cin>>a[i][j];\n            if(a[i][j])add(i,j,a[i][j]);\n        }\n\n    dfs(1,1);\n}\n```\n", "link": "/posts/LG 1784 \u6570\u72ec/", "tags": ["\u641c\u7d22"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3627 [APIO2009]\u62a2\u63a0\u8ba1\u5212", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3627&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3627\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7f29\u70b9\u540e\u8dd1\u6700\u957f\u8def\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000111\nint n,m,cnt=2,head[N],ST;\nstruct edge{\n    int x,to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].x=x;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint c[N];\nbool jiu[N],v[N],JIU[N];\nint dfn[N],low[N],sta[N],tp=0,sz=0,bl[N];\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;\n    v[x]=1;sta[++tp]=x;\n    fl(i,x)\n    if(!dfn[to]){\n        tarjan(to);\n        low[x]=MIN(low[x],low[to]);\n    }\n    else if(v[to])low[x]=MIN(low[x],dfn[to]);\n    if(low[x]==dfn[x]){\n        while(int k=sta[tp--]){\n            v[k]=0;\n            bl[k]=x;\n            if(k==x)break;\n            c[x]+=c[k];\n        }\n    }\n}\nint d[N],q[N];\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    int x,y;\n    Fur(i,1,m)in>>x>>y,add(x,y);\n    Fur(i,1,n)in>>c[i];\n    in>>ST>>y;\n    while(y--)in>>x,jiu[x]=1;\n    Fur(i,1,n)if(!dfn[i])tarjan(i);\n    Fur(i,1,n)if(jiu[i])JIU[bl[i]]=1;\n    int t=cnt;\n    cnt=0;clr(head,0);\n    Fur(i,3,t){\n        x=bl[e[i].x];y=bl[e[i].to];\n        if(x!=y)add(x,y);\n    }\n    // Fur(i,1,cnt)out<<e[i].x<<\" \"<<e[i].to<<ln;\n    // Fur(i,1,n)if(i==bl[i])out<<i<<\": \"<<c[i]<<ln;\n    clr(d,128);clr(v,0);\n    d[bl[ST]]=c[bl[ST]];\n    int h=0;t=1;\n    q[0]=bl[ST];\n    v[bl[ST]]=1;\n    while(h^t){\n        x=q[h++];v[x]=0;\n        fl(i,x)if(d[x]+c[to]>d[to]){\n            d[to]=d[x]+c[to];\n            if(!v[to])q[t++]=to,v[to]=1;\n        }\n    }\n    int ans=0;\n    Fur(i,1,n)if(i==bl[i]&&JIU[i])ans=MAX(ans,d[i]);\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 3627 [APIO2009]\u62a2\u63a0\u8ba1\u5212/", "tags": ["tarjan", "\u6700\u77ed\u8def"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1557 \u4e24\u4e2a\u96c6\u5408", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148,\u6211\u4eec\u53ea\u7528\u5206\u6790 NO \u7684\u60c5\u51b5,\u5176\u4ed6\u7684\u90fd\u662f YES,NO \u7684\u60c5\u51b5\u6709\u4e24\u79cd\uff1a \n\n1. x \u65e2\u4e0d\u5728 A \u4e2d,\u4e5f\u4e0d\u5728 B \u4e2d,\u5373\u627e\u4e0d\u5230 a-x \u548c b-x,NO\uff1b \n2. x \u65e2\u53ef\u4ee5\u5728 A \u4e2d,\u4e5f\u53ef\u4ee5\u5728 B \u4e2d,\u4e5f\u5c31\u662f\u627e\u5230\u4e86 a-x \u548c b-x,\u5982\u679c x \u5728 A \u4e2d,\u90a3\u4e48 b-x \u4e00\u5b9a\u4e0d\u5728 B \u4e2d,\u56e0\u4e3a\u6570\u552f\u4e00,\u6240\u4ee5 b-x \u53ea\u80fd\u5728 A \u4e2d,\u4e5f\u5c31\u662f\u8bf4\u5fc5\u987b\u5b58\u5728 a-(b-x),\u5982\u679c\u4e0d\u5b58\u5728\u5c31\u884c\u4e0d\u901a,\u540c\u7406\u5f97\u5982\u679c x \u5728 B \u4e2d,\u5219\u5fc5\u987b\u5b58\u5728 b-(a-x),\u5982\u679c\u4e0d\u5b58\u5728\u5c31\u884c\u4e0d\u901a,\u90a3\u4e48\u5982\u679c\u4e24\u4e2a\u65b9\u6848\u90fd\u884c\u4e0d\u901a\u4e86,\u4e5f\u5c31\u662f\u8bf4 NO \u4e86\u3002 \n   \n<!-- more -->\n\n```cpp\n#include <iostream>\n#include <algorithm>\n\n#define YES 1\n#define NO 0\n\nusing namespace std;\n\nconst int MAXN = 1e5 + 10;\n\nint p[MAXN];\n\nint bs(int l, int h, int v)\n{\n    int m;\n    while (l < h)\n    {\n        m = (l + h) >> 1;\n        if (p[m] == v)\n        {\n            return YES;\n        }\n        if (p[m] < v)\n        {\n            l = m + 1;\n        }\n        else\n        {\n            h = m;\n        }\n    }\n    return NO;\n}\n\nint main(int argc, const char * argv[])\n{\n//    freopen(\"/Users/zyj/Desktop/input.txt\", \"r\", stdin);\n\n    int n, a, b;\n    cin >> n >> a >> b;\n\n    for (int i = 0; i < n; i++)\n    {\n        scanf(\"%d\", p + i);\n    }\n    sort(p, p + n);\n\n    for (int i = 0; i < n; i++)\n    {\n        bool A = bs(0, n, a - p[i]);\n        bool B = bs(0, n, b - p[i]);\n        if (!A && !B)\n        {\n            cout << \"NO\\n\";\n            return 0;\n        }\n        if (A && B)\n        {\n            bool A_ = bs(0, n, a - b + p[i]);\n            bool B_ = bs(0, n, b - a + p[i]);\n            if (!A_ && !B_)\n            {\n                cout << \"NO\\n\";\n                return 0;\n            }\n        }\n    }\n    cout << \"YES\\n\";\n}\n\n```\n", "link": "/posts/51nod 1557 \u4e24\u4e2a\u96c6\u5408/", "tags": ["\u6392\u5e8f", "\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1297 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u5355\u9009\u9519\u4f4d", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1297&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1297\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10000011\n#define int ll\nint n,a[N];\nvoid init(){\n\tint A,B,C;\n\tin>>n>>A>>B>>C>>a[1];\n\tFur(i,2,n)a[i]=(1ll*a[i-1]*A+B)%100000001;\n\tFur(i,1,n)a[i]%=C,a[i]++;\n}\nsigned main(){\n\tinit();\n\tdb ans=(db)(MIN(a[n],a[1])*1.0/a[n]/a[1]);\n\tFur(i,2,n)ans+=(db)(MIN(a[i-1],a[i])*1.0/a[i]/a[i-1]);\n\tprintf(\"%.3f\\n\",ans);\n}\n```\n", "link": "/posts/LG 1297 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u5355\u9009\u9519\u4f4d/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3028 [USACO10OCT]\u6c7d\u6c34\u673aSoda-Machine", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3028&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3028\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include <bits/stdc++.h>\nusing namespace std;\nconst int maxn=5000110;\nint n;\nchar s[maxn];\nint Mini(int l){    \n    int i,j,k;  \n    i=0;j=1;k=0;  \n    while(i<l&&j<l)  \n    {  \n        k=0;  \n        while(s[(i+k)%l]==s[(j+k)%l]&&k<l) k++;  \n        if(k==l) return (i<j)?i:j;  \n        if(s[(i+k)%l]>s[(j+k)%l])i=i+k+1;\n        else j=j+k+1;\n        if(i==j)j++;\n    } \n    return (i<j)?i:j;\n}     \nint main(){\n    cin>>n;\n    for(int i=0;i<n;i++)cin>>s[i];\n    int l=Mini(n);\n    cout<<l<<endl;\n}\n```\n", "link": "/posts/LG 3028 [USACO10OCT]\u6c7d\u6c34\u673aSoda-Machine/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1731 [NOI1999]\u751f\u65e5\u86cb\u7cd5", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1731&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1731\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,m;\nvoid dfs(){\n    \n}\nint main(){\n    cin>>n>>m;\n\n}\n```\n", "link": "/posts/LG 1731 [NOI1999]\u751f\u65e5\u86cb\u7cd5/", "tags": ["dfs", "\u526a\u679d"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5200 [USACO19JAN]Sleepy Cow Sorting", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5200&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5200\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il __inline__ __attribute__ ((always_inline))\n#define rg register\n#define Fur(i,x,y) for(rg int i=x;i<=y;i++)\n#define Fdr(i,x,y) for(rg int i=x;i>=y;i--)\nusing namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100001\nint n,a[N],t[N],ans[N],tot=0;\nil void add(int x){while(x<=n)t[x]++,x+=x&-x;}\nil int ask(int x){int ans=0;while(x)ans+=t[x],x-=x&-x;return ans;}\nint main(){\n\tint x,k=n+1;\n\tFur(i,1,n)in>>a[i];\n\tFdr(i,n,1)\n\t\tif(a[i]>k){\n\t\t\tout<<i<<ln;\n\t\t\tFur(j,1,i)out<<i-j+ask(a[j])<<\" \",add(a[j]);\n\t\t\tout<<ln;\n\t\t\tbreak;\n\t\t}\n\t\telse add(a[i]),k=a[i];\n}\n\n```\n", "link": "/posts/LG 5200 [USACO19JAN]Sleepy Cow Sorting/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1023D Array-Restoration", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1023D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1023D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,m,a[N],b[N];\n\nbool chk(int l,int r){\n    if(l>r)return 1;\n    if(l==r)return 1;\n    if(a[l]==a[r])return chk(l+1,r-1);\n    if(chk(l+1,r))return 1;\n    if(chk(l,r-1))return 1;\n\n    return 0;\n}\nint main(){\n    in(n,m);\n    int d=0;\n    Fur(i,1,n){\n        in(a[i]);b[++d]=a[i];\n        if(!a[i]||a[i]==a[i-1])--i,--n;\n        if(a[i]>m)return printf(\"NO\\n\"),0;\n    }\n    if(!chk(1,n))return printf(\"NO\\n\"),0;\n    Fur(i,2,n)if(!b[i]&&b[i-1])b[i]=b[i-1];\n    Fdr(i,n-1,1)if(!b[i]&&b[i+1])b[i]=b[i+1];\n    printf(\"YES\\n\");\n    Fur(i,1,d)printf(\"%d \",b[i]);\n}\n```\n", "link": "/posts/LG CF1023D Array-Restoration/", "tags": ["set"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2713 \u7f57\u9a6c\u6e38\u620f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2713&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2713\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5f00$n$\u4e2a\u5c0f\u6839\u5806,\u7136\u540e\u542f\u53d1\u5f0f\u5408\u5e76\u5373\u53ef\n\n\u53ef\u4ee5\u7528\u5e76\u8336\u51e0\u5224\u65ad\u4e00\u4e2a\u4eba\u6240\u5728\u7684\u56e2\n\n\u5509\u5509,\u8fc7\u4e86,stl\u5f00$o2$\n\n~~\u7b49\u7b49,\u5c45\u7136\u662f\u5de6\u504f\u6811~~\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nint n,q,a[N],f[N];\nbool v[N];\nstruct cmp{\n\tbool operator()(int x,int y){return a[x]>a[y];}\n};\npriority_queue<int,vector<int>,cmp>t[N];\nint gf(int x){return f[x]==x?x:(f[x]=gf(f[x]));}\nint main(){\n\tin>>n;\n\tFur(i,1,n)in>>a[i],f[i]=i,t[i].push(i);\n\tin>>q;\n\tchar ch;\n\tint x,y;\n\twhile(q--){\n\t\tin>>ch;\n\t\tif(ch=='M'){\n\t\t\tin>>x>>y;\n\t\t\tif(v[x]||v[y]||gf(x)==gf(y))continue;\n\t\t\tif(t[gf(x)].size()>t[gf(y)].size())SWAP(x,y);\n\t\t\tint fx=gf(x),fy=gf(y);\n\t\t\twhile(!t[fx].empty()){\n\t\t\t\tt[fy].push(t[fx].top());\n\t\t\t\tt[fx].pop();\n\t\t\t}\n\t\t\tf[fx]=fy;\n\t\t}\n\t\telse{\n\t\t\tin>>x;\n\t\t\tif(v[x]){\n\t\t\t\tout<<\"0\\n\";\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tint fx=gf(x);\n\t\t\tx=t[fx].top();\n\t\t\tout<<a[x]<<ln;\n\t\t\tv[x]=1;\n\t\t\tt[fx].pop();\n\t\t}\n\t}\n}\n```\n", "link": "/posts/LG 2713 \u7f57\u9a6c\u6e38\u620f/", "tags": ["\u5806", "\u53ef\u5e76\u5806"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2568 GCD", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2568&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2568\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10000011\nint pri[N],tot=0;\nll phi[N];\nbool f[N];\nvoid ol(int n){\n    phi[1]=1;\n    Fur(i,2,n){\n        if(!f[i])phi[i]=i-1,pri[++tot]=i;\n        Fur(j,1,tot){\n            if(pri[j]*i>n)break;\n            f[i*pri[j]]=1;\n            if(i%pri[j])phi[i*pri[j]]=phi[i]*phi[pri[j]];\n            else{\n                phi[i*pri[j]]=phi[i]*pri[j];\n                break;\n            }\n        }\n    }\n    Fur(i,2,n)phi[i]+=phi[i-1];\n}\nint main(){\n\tfin(\"in\");\n    int T,n;ll ans=0;\n    in>>n;\n    ol(n);\n    Fur(i,1,tot)ans+=(phi[n/pri[i]]*2-1);\n    out<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 2568 GCD/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2365 \u4efb\u52a1\u5b89\u6392", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2365&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2365\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_i$\u4e3a\u524d$i$\u4e2a\u4efb\u52a1\u7684\u8d39\u7528,$t_i$\u4e3a\u524d$i$\u4e2a\u4efb\u52a1\u65f6\u95f4\u7684\u603b\u548c,$w_i$\u4e3a\u524d$i$\u4e2a\u4efb\u52a1\u8d39\u7528\u7684\u603b\u548c\n\n$$\nf_i=\\min_{j=0}^{i-1}(f_j+s\\times(w_n-w_j)+t_i\\times(w_i-w_j))\n$$\n\n\u8bbe\u4efb\u610f$0\\le j<k<i$\u4ece$j$\u8f6c\u79fb\u6bd4\u4ece$k$\u8f6c\u79fb\u4f18,\u90a3\u4e48\n\n$$\nf_j+s\\times(w_n-w_j)+t_i\\times(w_i-w_j)\n\\le\nf_k+s\\times(w_n-w_k)+t_i\\times(w_i-w_k)\n\\\\\nt_i(w_k-w_j)\\le f_k-f_j+s(w_j-w_k)\n\\\\\nt_i\\le \\frac{f_k-f_j+s(w_j-w_k)}{w_k-w_j}\n\\\\\nt_i+s\\le \\frac{f_k-f_j}{w_k-w_j}\n$$\n\n\u7ef4\u62a4\u4e2a\u4e0b\u51f8\u58f3\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 300011\nint s,n,q[N];\nll f[N],t[N],w[N];\n#define ld long double\nld S(int i,int j){\n    return (ld)(f[j]-f[i])/(ld)(w[j]-w[i]);\n}\nsigned main(){\n    in(n,s);\n    Fur(i,1,n)\n        in(t[i],w[i]),\n        t[i]+=t[i-1],\n        w[i]+=w[i-1];\n    int H=1,T=1;q[1]=0;\n    Fur(i,1,n){\n        while(H<T&&S(q[H],q[H+1])<=t[i]+s)++H;\n        f[i]=f[q[H]]+1ll*s*(w[n]-w[q[H]])+1ll*t[i]*(w[i]-w[q[H]]);\n        while(H<T&&S(q[T-1],q[T])>=S(q[T-1],i))--T;\n        q[++T]=i;\n    }\n    cout<<f[n]<<endl;\n}\n```\n", "link": "/posts/LG 2365 \u4efb\u52a1\u5b89\u6392/", "tags": ["\u659c\u7387\u4f18\u5316", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1778 \u4e07\u5723\u8282\u540e\u7684\u65e9\u6668", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1778&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1778\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5c31bfs\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 101\nint n,m,k;\nchar a[N][N];\n\nint main(){\n\tin>>n>>m>>k;\n\tFur(i,1,n)in>>(a[i]+1);\n\tFur(i,1,n)Fur(j,1,n)\n}\n```\n", "link": "/posts/LG 1778 \u4e07\u5723\u8282\u540e\u7684\u65e9\u6668/", "tags": ["bfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1415 \u62c6\u5206\u6570\u5217", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1415&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1415\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5206\u6210\u4e24\u90e8\u5206\n\n1. dp\u51fa\u7ed3\u5c3e\u6700\u5c0f\u662f\u591a\u5c11\n\n2. dp\u51fa\u5b57\u5178\u5e8f\u6700\u5927\u7684\u65b9\u6848\n\n\u7b2c\u4e00\u6b65\uff1a\n\n\u8bbe$f_i$\u8868\u793a\u4ee5$i$\u7ed3\u5c3e\u6700\u9760\u8fd1$i$\u7684\u4e0b\u6807\n\n\u679a\u4e3e$j$,\u5224\u65ad$j$\u662f\u5426\u53ef\u884c\n\n$f_i = max(j)|(num(f[j],j) < num(j+1,i))$\n\n\n\n\u7b2c\u4e8c\u6b65\uff1a\n\n\u65b9\u6cd5\u7c7b\u4f3c\u7b2c\u4e00\u6b65\n\n\u8bb0\u5f97\u8003\u8651\u524d\u5bfc\u96f6\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\nint n,f[N];\nchar a[N];\nil bool cmp(int l,int r,int L,int R){\n    while(a[l]=='0'&&l<=r)l++;\n    while(a[L]=='0'&&L<=R)L++;\n    if(R-L+1==0||r-l+1==0)return 0;\n    if(R-L+1>r-l+1)return 1;\n    if(R-L+1<r-l+1)return 0;\n    Fur(i,1,r-l+1)\n        if(a[L+i-1]<a[l+i-1])return 0;\n        else if(a[L+i-1]>a[l+i-1])return 1;\n    return 0;\n}\nint g[N];\nint main(){\n    fin(\"in\");\n    in>>(a+1);\n    n=strlen(a+1);\n    Fur(i,1,n){\n        f[i]=1;\n        Fdr(j,i,1)\n            if(cmp(f[j-1],j-1,j,i)){\n                f[i]=j;\n                break;\n            }\n    }\n    // Fur(i,1,n)out<<f[i]<<\" \"<<i<<ln;\n    g[f[n]]=n;\n    int zero=f[n];\n    while(a[zero-1]=='0')g[--zero]=n;\n    Fdr(i,f[n]-1,1){\n        Fdr(j,f[n]-1,i)\n            if(cmp(i,j,j+1,g[j+1])){\n                g[i]=j;\n                break;\n            }\n    }\n    int p=1,ff=0;\n    while(p<=n){\n        if(ff)out.pt(',');\n        ff=1;\n        Fur(i,p,g[p])out.pt(a[i]);\n        p=g[p]+1;\n    }\n}\n```\n", "link": "/posts/LG 1415 \u62c6\u5206\u6570\u5217/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3802 \u5c0f\u9b54\u5973\u5e15\u742a ", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3802&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3802\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint main(){\n\t\n}\n```\n", "link": "/posts/LG 3802 \u5c0f\u9b54\u5973\u5e15\u742a/", "tags": ["\u671f\u671b"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF52C Circular-RMQ", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF52C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF52C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ebf\u6bb5\u6811\u88f8\u9898\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define int ll\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{\n    const int str=1<<20;\n    //in\n    static char in_buf[str],*in_s,*in_t;\n    bool __=0;\n    il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}\n    template<typename T>\n    il int in(T &x){\n        if(__)return 0;\n        rg char c=gc();\n        bool f=0;\n        while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();\n        if(c==EOF){__=1;return 0;}\n        x=0;\n        while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();\n        if(c==EOF)__=1;\n        if(f)x=-x;\n        if(c==' ')return 1;\n        return 0;\n    }\n    template<typename T,typename ... arr>\n    il void in(T &x,arr & ... y){in(x),in(y...);}\n\n    //out\n    const char ln='\\n';\n    static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;\n    il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}\n    il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}\n    template<typename T>\n    il void out(T x){\n        if(!x){pt('0');return;}\n        if(x<0)pt('-'),x=-x;\n        char a[60],t=0;\n        while(x)a[t++]=x%10,x/= 10;\n        while(t--)pt(a[t]+'0');\n    }\n}using namespace IO;\n#define N 200011\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=MIN(s[ls],s[rs]);\nint n,s[N<<2],laz[N<<2];\nvoid build(int l,int r,int rt){\n    if(l==r){\n        in(s[rt]);\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu;\n}\nil void pd(int rt){\n    if(laz[rt]){\n        laz[ls]+=laz[rt];laz[rs]+=laz[rt];\n        s[ls]+=laz[rt];s[rs]+=laz[rt];\n        laz[rt]=0;\n    }\n}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt]+=v;\n        laz[rt]+=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    pu;\n}\nint ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1,ans=inf;\n    pd(rt);\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans=MIN(ans,ask(L,R,m+1,r,rs));\n    return ans;\n}\nsigned main(){\n    in(n);\n    build(1,n,1);\n    int q,l,r,v,ans;\n    in(q);\n    while(q--){\n        in(l);\n        bool ff=0;\n        ff=in(r);\n        ++l,++r;\n\n        if(ff){\n            in(v);\n            if(l<=r)upd(l,r,v,1,n,1);\n            else upd(l,n,v,1,n,1),upd(1,r,v,1,n,1);\n        }\n        else{\n            if(l<=r)ans=ask(l,r,1,n,1);\n            else ans=MIN(ask(l,n,1,n,1),ask(1,r,1,n,1));\n            out(ans);pt('\\n');\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF52C Circular-RMQ/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2245 \u661f\u9645\u5bfc\u822a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2245&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2245\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 210011\nint n,m,q;\nbool rev[N];\nint c[N][2],s[N],f[N],st[N],v[N];\n#define ls c[x][0]\n#define rs c[x][1]\nbool irt(int x){return c[f[x]][0]!=x&&c[f[x]][1]!=x;}\nvoid pu(int x){s[x]=MAX(MAX(s[ls],s[rs]),v[x]);}\nvoid pr(int x){\n\tSWAP(ls,rs);\n\trev[x]^=1;\n}\nvoid pd(int x){\n\tif(rev[x]){\n\t\tif(ls)pr(ls);\n\t\tif(rs)pr(rs);\n\t\trev[x]=0;\n\t}\n}\nbool g(int x){return c[f[x]][1]==x;}\nvoid turn(int x){\n\tint y=f[x],z=f[y],l=g(x),r=!l,w=c[x][r];\n\tif(!irt(y))c[z][g(y)]=x;\n\tc[x][r]=y;c[y][l]=w;\n\tif(w)f[w]=y;\n\tf[x]=z;f[y]=x;\n\tpu(y);pu(x);\n}\nvoid splay(int x){\n\tint y=x,z=0;\n\tst[++z]=y;\n\twhile(!irt(y))st[++z]=y=f[y];\n\twhile(z)pd(st[z--]);\n\twhile(!irt(x)){\n\t\ty=f[x],z=f[y];\n\t\tif(!irt(y))\n\t\t\tturn(((c[y][0]==x)^(c[z][0]==y))?x:y);\n\t\tturn(x);\n\t}\n\tpu(x);\n}\nvoid access(int x){\n\tfor(int y=0;x;x=f[y=x])\n\t\tsplay(x),rs=y,pu(x);\n}\nvoid mrt(int x){\n\taccess(x);splay(x);\n\tpr(x);\n}\nint frt(int x){\n\taccess(x);splay(x);\n\twhile(ls)pd(x),x=ls;\n\tsplay(x);\n\treturn x;\n}\nvoid sl(int x,int y){\n\tmrt(x);access(y);splay(y);\n}\nvoid link(int x,int y){\n\tmrt(x);\n\tif(frt(y)!=x)f[x]=y;\n}\nstruct edge{\n\tint x,y,w;\n}e[300011];\nbool cmp(edge x,edge y){\n\treturn x.w<y.w;\n}\nint main(){\nint T;in>>T;\nwhile(T--){\n\tin>>n>>m;\n\tint x,y,w,cnt=n;\n\tFur(i,1,m)in>>e[i].x>>e[i].y>>e[i].w;\n\tsort(e+1,e+m+1,cmp);\n\tFur(i,1,m){\n\t\tx=e[i].x;y=e[i].y;w=e[i].w;\n\t\tif(frt(x)!=frt(y))v[++cnt]=w,link(x,cnt),link(y,cnt);\n\t}\n\tin>>q;\n\twhile(q--){\n\t\tin>>x>>y;\n\t\tif(frt(x)==frt(y))\n\t\t\tsl(x,y),out<<s[y]<<ln;\n\t\telse out<<\"impossible\\n\";\n\t}\n}\n}\n```\n", "link": "/posts/LG 2245 \u661f\u9645\u5bfc\u822a/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF566D Restructuring Company", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF566D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF566D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5e76\u67e5\u96c6\u6280\u5de7\uff1a\u8bb0\u5f55\u6bcf\u4e2a\u70b9\u540e\u9762\u548c\u5b83\u4e0d\u5c5e\u4e8e\u540c\u4e00\u4e2a\u96c6\u5408\u7684\u7b2c\u4e00\u4e2a\u70b9\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\nint f[N],n,q,nxt[N];\nint gf(int x){\n    return (x==f[x])?x:(f[x]=gf(f[x]));\n}\nil void mg(int x,int y){\n    if(gf(x)!=gf(y))f[f[y]]=f[x];\n}\nint main(){\n    fin(\"in\");\n    in>>n>>q;\n    Fur(i,1,n)f[i]=i,nxt[i]=i+1;\n    int opt,x,y;\n    while(q--){\n        in>>opt>>x>>y;\n        if(opt==3)out<<(gf(x)==gf(y)?\"YES\":\"NO\")<<ln;\n        if(opt==2)\n            for(int i=x+1;i<=y;)mg(i-1,i),x=nxt[i],nxt[i]=nxt[y],i=x;\n        if(opt==1)mg(x,y);\n    }\n}\n```\n", "link": "/posts/LG CF566D Restructuring Company/", "tags": ["\u5e76\u67e5\u96c6", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3800 Power\u6536\u96c6", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3800&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3800\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u628a\u8282\u70b9\u6309\u884c\u6392\u5e8f\n\n\u56e0\u4e3a$k$\u5f88\u5c0f,\u6240\u4ee5\u76f4\u63a5$k^2$dp\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10001\nint n,m,t,k,f[N],ans=0;\nstruct node{\n\tint x,y,v;\n}a[N];\nbool cmp(node x,node y){\n\treturn (x.x==y.x)?(x.y<y.y):(x.x<y.x);\n}\nbool chk(node x,node y){\n\treturn ABS(x.y-y.y)<=t*ABS(x.x-y.x);\n}\nint main(){\n\tfin(\"in\");\n\tin>>n>>m>>k>>t;\n\tFur(i,1,k)in>>a[i].x>>a[i].y>>a[i].v;\n\tsort(a+1,a+k+1,cmp);\n\tFur(i,1,k){\n\t\tFur(j,1,i-1)\n\t\tif(chk(a[i],a[j]))\n\t\t\tf[i]=MAX(f[i],f[j]);\n\t\tf[i]+=a[i].v;\n\t\tans=MAX(ans,f[i]);\n\t}\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 3800 Power\u6536\u96c6/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1686 \u7b2cK\u5927\u533a\u95f4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u76f4\u63a5\u6c42\u5f88\u96be\n\n\u7a81\u7136\u770b\u5230\u4e8c\u5206\u7684\u6807\u7b7e\n\n\u90a3\u6211\u4eec\u4e8c\u5206$k$\u7684\u503c,\u5224\u65ad\u6392\u540d\u4e0d\u5c31\u53ef\u4ee5\u4e86\n\n\u5982\u4f55\u5224\u65ad\u6392\u540d\uff1a\n\n\u5982\u679c\u533a\u95f4$[l,r]$\u6ee1\u8db3\u8981\u6c42,\u90a3\u4e48\u5de6\u7aef\u70b9\u6362\u6210$[1,l-1]$\u4e2d\u7684\u4efb\u4f55\u4e00\u4e2a\u4e5f\u90fd\u6ee1\u8db3\u8981\u6c42\n\n\u90a3\u6211\u4eec\u53ea\u8981\u679a\u4e3e\u53f3\u7aef\u70b9,\u7136\u540e\u7528\u53cc\u6307\u9488\u6cd5\u5c31\u53ef\u4ee5\u4e86\n\n\u6c42\u4f17\u6570\u53ef\u4ee5\u7528\u83ab\u961f\u7684\u601d\u60f3\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define int ll\nint n,k,a[N];\nstruct node{\n\tint p,v;\n}b[N];\nbool cmp(node x,node y){return x.v<y.v;}\nint mx=0,cnt[N],tot[N];\nvoid add(int x){\n\ttot[cnt[a[x]]]--;tot[++cnt[a[x]]]++;\n\tmx=MAX(mx,cnt[a[x]]);\n}\nvoid del(int x){\n\tif(mx==cnt[a[x]]&&--tot[cnt[a[x]]]==0)mx--;\n\ttot[--cnt[a[x]]]++;\n}\nbool chk(int w){\n\tclr(cnt,0);clr(tot,0);\n\tmx=0;\n\tint l=1,ans=0;\n\tFur(i,1,n){\n\t\tif(mx<w)add(i);\n\t\twhile(l<=i&&mx>=w)del(l++);\n\t\tans+=(l-1);\n\t}\n\treturn ans>=k;\n}\nsigned main(){\n\tin>>n>>k;\n\tFur(i,1,n)in>>b[i].v,b[i].p=i;\n\tsort(b+1,b+n+1,cmp);\n\tint t=0;\n\tFur(i,1,n){\n\t\tif(b[i].v!=b[i-1].v)t++;\n\t\ta[b[i].p]=t;\n\t}\n\tint l=1,r=n,ans,m;\n\twhile(l<=r){\n\t\tm=(l+r)>>1;\n\t\tif(chk(m))ans=m,l=m+1;\n\t\telse r=m-1;\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/51nod 1686 \u7b2cK\u5927\u533a\u95f4/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5490 \u3010\u6a21\u677f\u3011\u626b\u63cf\u7ebf", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5490&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5490\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n![](https://cdn.luogu.org/upload/pic/70275.png)\n\n\u56fe\u5f62\u53ef\u4ee5\u5206\u5272\u6210\u4e00\u4e2a\u4e2a\u5c0f\u77e9\u9635\n\n![](https://s2.ax1x.com/2019/08/08/eTuDjP.gif)\n\n\u4e8e\u662f\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u4e2a\u77e9\u5f62\u53d8\u6210\u4e24\u6761\u7ebf\u6bb5\u540e\u5bf9\u8fd9\u4e9b\u7ebf\u6bb5\u8fdb\u884c\u6392\u5e8f\n\n![\u5982\u6b64](https://cdn.luogu.org/upload/pic/70291.png)\n\n\u90a3\u4e48\u603b\u5171\u8986\u76d6\u4e86\u591a\u5c11\u957f\u5ea6\uff1f\n\n\u7528**\u7ebf\u6bb5\u6811**\u6c42\uff01\n\n\u90a3\u7ba1\u513f\u5b50\u8282\u70b9\u7684\u4e8b\u5e72\u561b,\u8ba9\u4ed6\u4eec\u81ea\u751f\u81ea\u706d\u5f97\u4e86\n\n\u4e8e\u662f,\u6211\u4eec\u60f3\u5230,\u9664\u5de6\u53f3\u7aef\u70b9$l,r$\u4e4b\u5916,\u5728\u7ebf\u6bb5\u6811\u7684\u6bcf\u4e2a\u8282\u70b9\u4e0a\u7ef4\u62a4\u4e24\u4e2a\u503c\uff1a\u8be5\u8282\u70b9\u4ee3\u8868\u7684\u533a\u95f4\u88ab\u77e9\u5f62\u8986\u76d6\u7684\u957f\u5ea6$len$,\u8be5\u8282\u70b9\u81ea\u8eab\u88ab\u8986\u76d6\u7684\u6b21\u6570$cnt$\u3002\u6700\u521d,\u4e8c\u8005\u5747\u4e3a$0$.\n\n\u6ce8\u610f\uff1a\n    \u6bcf\u4e2a\u8282\u70b9\u4ee3\u8868\u7684\u8303\u56f4\u662f$[l,r+1]$,\u6700\u540e\u9762\u7684\u90a3\u4e2a\u8282\u70b9\u4e0d\u7b97\u5165\u7edf\u8ba1\n\n\u5bf9\u4e8e\u6bcf\u4e00\u4e2a$(x,y1,y2,k)$,\u6211\u4eec\u518d$[val(y1),val(y2)-1]$(\u79bb\u6563\u5316\u540e\u7684\u533a\u95f4)\u4e0a\u6267\u884c\u671f\u95f4\u4fee\u6539\u3002\u8be5\u533a\u95f4\u88ab\u7ebf\u6bb5\u6811\u5212\u5206\u6210$ \\log n$\u4e2a\u8282\u70b9,\u6211\u4eec\u628a\u8fd9\u4e9b\u8282\u70b9\u7684$cnt$\u90fd\u52a0$k$\u3002\n\n\u5bf9\u4e8e\u7ebf\u6bb5\u6811\u4e2d\u4efb\u610f\u4e00\u4e2a\u8282\u70b9 $[l,r]$ ,\u82e5$cnt>0$,\u5219$len$\u7b49\u4e8e$raw(r+1)-raw(l)$(\u79bb\u6563\u5316\u524d\u7684\u8ddd\u79bb),\u5426\u5219,\u8be5\u5e97$len$\u7b49\u4e8e\u4e24\u4e2a\u5b50\u8282\u70b9\u7684$len$\u4e4b\u548c\u3002\u5728\u4e00\u4e2a\u8282\u70b9\u7684$cnt$\u88ab\u4fee\u6539,\u4ee5\u53ca\u7ebf\u6bb5\u6811\u4ece\u4e0b\u5f80\u4e0a\u4f20\u9012\u4fe1\u606f\u65f6,\u6211\u4eec\u90fd\u6309\u7167\u8be5\u65b9\u6cd5\u66f4\u65b0$len$\u503c\u3002\u6839\u8282\u70b9\u7684$len$\u503c\u5c31\u662f\u6574\u4e2a\u626b\u63cf\u7ebf\u4e0a\u88ab\u8986\u76d6\u7684\u957f\u5ea6\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10001\nint n,b[N];\nstruct node{\n\tint p,x,y,v;\n}a[N];\nbool cmp(node x,node y){\n\treturn (x.p==y.p)?(x.v>y.v):(x.p<y.p);\n}\nint main(){\n\tint x1,y1,x2,y2;\n\tin>>n;\n\tFur(i,1,n){\n\t\tin>>x1>>y1>>x2>>y2;\n\t\ta[i]=node{x1,y1,y2,1};\n\t\ta[i*2]=node{x2,y1,y2,-1};\n\t\tb[i]=y1;b[i*2]=y2;\n\t}\n\tsort(a+1,a+n*2+1,cmp);\n\t\n}\n\n```\n", "link": "/posts/LG 5490 \u3010\u6a21\u677f\u3011\u626b\u63cf\u7ebf/", "tags": ["\u626b\u63cf\u7ebf", "\u6392\u5e8f", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3327 [SDOI2015]\u7ea6\u6570\u4e2a\u6570\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3327&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3327\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u524d\u7f6e\u5b9a\u7406\uff1a\n\n$$\nd(ij) = \\sum_{x|i} \\sum_{y|j}[gcd(x,y) = 1]\n$$\n\n\u6240\u4ee5\uff1a\n\n\u8bbe$n<m$\n\n$$\n\\sum_{i=1}^n \\sum_{j=1}^m d(ij)\n\\\\\n=\\sum_{i=1}^n \\sum_{j=1}^m \\sum_{x|i} \\sum_{y|j}[gcd(x,y) = 1]\n\\\\\n=\\sum\\limits_{x=1}^n\\sum\\limits_{y=1}^m \\left\\lfloor\\frac{n}{x}\\right\\rfloor \\left\\lfloor\\frac{m}{y}\\right\\rfloor [\\gcd(x,y)=1]\n$$\n\n$x\u3001y$\u6362\u6210$i\u3001j$\n\n$$\n\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\left\\lfloor\\frac{n}{i}\\right\\rfloor \\left\\lfloor\\frac{m}{j}\\right\\rfloor[\\gcd(i,j)=1]\n\\\\\n=\\sum\\limits_{i=1}^n\\sum\\limits_{j=1}^m \\left\\lfloor\\frac{n}{i}\\right\\rfloor \\left\\lfloor\\frac{m}{j}\\right\\rfloor \\sum_{k|gcd(i,j)}\\mu(k)\n$$\n\n\u8bbe$g(i)=\\sum_{i=1}^n \\left \\lfloor \\frac ni \\right \\rfloor$\n\n$$\nans=\\sum_{k=1}^n\\mu(k) g(\\left \\lfloor \\frac nk \\right \\rfloor) g(\\left \\lfloor \\frac mk \\right \\rfloor)\n\\\\\n$$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 50000\nint pri[N+11],mu[N+11],tot=0;\nll g[N+11];\nbool f[N+11];\nvoid sm(int n){\n\tmu[1]=f[1]=1;\n\tFur(i,2,n){\n\t\tif(!f[i])pri[++tot]=i,mu[i]=-1;\n\t\tFur(j,1,tot){\n\t\t\tif(pri[j]*i>n)break;\n\t\t\tf[i*pri[j]]=1;\n\t\t\tif(i%pri[j])mu[i*pri[j]]=-mu[i];\n\t\t\telse break;\n\t\t}\n\t}\n\tFur(i,2,n)mu[i]+=mu[i-1];\n\tFur(i,1,n)\n\t\tfor(int l=1,r=0;l<=i;l=r+1){\n\t\t\tr=i/(i/l);\n\t\t\tg[i]+=(r-l+1)*(i/l);\n\t\t}\n}  \nint main(){\n\tsm(N);\n\tint T,n,m;\n\tin>>T;\n\twhile(T--){\n\t\tin>>n>>m;\n\t\tif(n>m)SWAP(n,m);\n\t\tll ans=0;\n\t\tfor(int l=1,r=0;l<=n;l=r+1){\n\t\t\tr=MIN(n/(n/l),m/(m/l));\n\t\t\tans+=1ll*(mu[r]-mu[l-1])*g[n/l]*g[m/l];\n\t\t}\n\t\tout<<ans<<ln;\n\t}\n}\n```\n", "link": "/posts/LG 3327 [SDOI2015]\u7ea6\u6570\u4e2a\u6570\u548c/", "tags": ["\u6570\u8bba", "\u83ab\u6bd4\u4e4c\u65af"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1674 \u533a\u95f4\u7684\u4ef7\u503c V2", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9996\u5148\u5c06\u6570\u5217\u6309\u4f4d\u5206\u89e3\u621032\u4e2a\u4f4d\u6570\u5217.\n\n\u679a\u4e3e\u533a\u95f4\u7684\u5de6\u7aef\u70b9,,\u533a\u95f4\u7684and\u503c\u8981\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u5fc5\u987b\u4e3a1,\u968f\u7740\u53f3\u7aef\u70b9\u53f3\u79fb,and\u503c\u4e3a\u4e0d\u9012\u589e\u7684,\u800c\u533a\u95f4\u7684or\u503c\u8981\u5bf9\u7b54\u6848\u6709\u8d21\u732e\u5fc5\u987b\u4e3a1,\u968f\u7740\u53f3\u7aef\u70b9\u53f3\u79fb,or\u503c\u4e3a\u4e0d\u9012\u51cf\u7684\u3002\n\n\u53ef\u4ee5\u6c42\u51fa\u6bcf\u4e00\u6bb5\u4e00\u6bb5\u7684\u6700\u5927\u957f\u5ea6\u7136\u540e\u7edf\u8ba1\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define mod 1000000007\nint n,p[66],L[33][N],R[33][N];\nbool a[33][N];\nll ans=0;\nint main(){\n\tint x;\n\tin>>n;\n\tFur(i,1,n){\n\t\tin>>x;\n\t\tFur(j,0,32)\n\t\t\ta[j][i]=x&1,x>>=1;\n\t}\n\t\n\tp[0]=1;Fur(i,1,64)p[i]=(p[i-1]<<1)%mod;\n\t\n\tFur(i,0,32){\n\t\tint l=1,r=1;\n\t\twhile(l<=n){\n\t\t\tif(!a[i][l])L[i][l]=0;\n\t\t\telse{\n\t\t\t\tr=MAX(r,l);\n\t\t\t\twhile(r<n&&a[i][r+1])++r;\n\t\t\t\tL[i][l]=r;\n\t\t\t}\n\t\t\t++l;\n\t\t}\n\t}\n\t\n\tFur(i,0,32){\n\t\tint l=1,r=1;\n\t\twhile(l<=n){\n\t\t\tif(a[i][l])R[i][l]=l;\n\t\t\telse{\n\t\t\t\tr=MAX(r,l);\n\t\t\t\twhile(r<=n&&!a[i][r])++r;\n\t\t\t\tR[i][l]=r;\n\t\t\t}\n\t\t\t++l;\n\t\t}\n\t}\n\t\n\tFur(i,0,32)\n\t\tFur(j,1,n)\n\t\tif(a[i][j])\n\t\t\tFur(k,0,32)\n\t\t\t\tif(R[k][j]<=L[i][j])\n\t\t\t\tans=(ans+(ll)(L[i][j]-R[k][j]+1)*p[i+k])%mod;\n\t\t\t\t\n\tcout<<ans<<endl;\n}\n\n```\n", "link": "/posts/51nod 1674 \u533a\u95f4\u7684\u4ef7\u503c V2/", "tags": ["\u4f4d\u8fd0\u7b97"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1437 \u8fc8\u514b\u6b65", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bb0\u5f55\u6bcf\u4e2a\u70b9\u5de6\u8fb9\u548c\u53f3\u8fb9\u7b2c\u4e00\u4e2a\u6bd4\u5b83\u5c0f\u7684,\u5c31\u53ef\u4ee5\u6c42\u51fa\u5b83\u80fd\u7684\u8d21\u732e\u533a\u95f4\n\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<cctype>\n#include<algorithm>\nusing namespace std;\n#define rep(i,s,t) for(int i=s;i<=t;i++)\n#define dwn(i,s,t) for(int i=s;i>=t;i--)\n#define clr(x,c) memset(x,c,sizeof(x))\nint read(){\n    int x=0;char c=getchar();\n    while(!isdigit(c)) c=getchar();\n    while(isdigit(c)) x=x*10+c-'0',c=getchar();\n    return x;\n}\nchar sh[15];\nvoid print(int x){\n    int cnt=0;\n    while(x) sh[++cnt]=x%10,x/=10;\n    dwn(i,cnt,1) putchar(sh[i]+48);\n    putchar(32);\n}\nconst int nmax=2e5+5;\nconst int inf=0x7f7f7f7f;\nint a[nmax],ans[nmax],l[nmax],r[nmax],q[nmax];\nvoid maxs(int &a,int b){\n    if(a<b) a=b;\n}\nint main(){\n    int n=read();rep(i,1,n) a[i]=read();\n    l[1]=1;int cur=1;q[1]=1;\n    rep(i,2,n){\n        while(a[q[cur]]>=a[i]&&cur) --cur;\n        l[i]=q[cur]+1;q[++cur]=i;\n    }\n    r[n]=n;cur=1;q[1]=n;q[0]=n+1;\n    dwn(i,n-1,1){\n        while(a[q[cur]]>=a[i]&&cur) --cur;\n        r[i]=q[cur]-1;q[++cur]=i;\n    }\n    rep(i,1,n) maxs(ans[r[i]-l[i]+1],a[i]);\n    int tmp=0;\n    dwn(i,n,1) maxs(ans[i],tmp),maxs(tmp,ans[i]);\n    rep(i,1,n) print(ans[i]);printf(\"\\n\");\n    return 0;\n}\n\n```\n", "link": "/posts/51nod 1437 \u8fc8\u514b\u6b65/", "tags": ["\u5355\u8c03\u6808"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1896 [SCOI2005]\u4e92\u4e0d\u4fb5\u72afKing", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1896&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1896\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint n,m,c[1024],sta[1024],tot=0;\nll ans=0,f[10][1024][100];\nint main(){\n\tin>>n>>m;\n\tint x,y,len=(1<<n)-1;\n\tFur(i,0,len){\n\t\tx=i;\n\t\twhile(x)c[i]+=(x&1),x>>=1;\n\t}\n\tFur(i,0,len)if(!((i<<1)&i)&&c[i]<=m)sta[++tot]=i;\n\tFur(i,1,tot)f[1][sta[i]][c[sta[i]]]=1;\n\tFur(i,2,n)\n\t\tFur(j,1,tot)\n\t\t\tFur(k,1,tot){\n\t\t\t\tx=sta[j],y=sta[k];\n\t\t\t\tif((x&y)||((x<<1)&y)||((x>>1)&y))continue;\n\t\t\t\tFdr(t,m,c[y])\n\t\t\t\t\tf[i][x][t]+=f[i-1][y][t-c[x]];\n\t\t\t}\n\t\n\tFur(i,1,tot)ans+=f[n][sta[i]][m];\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 1896 [SCOI2005]\u4e92\u4e0d\u4fb5\u72afKing/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1799 \u6570\u5217_NOI\u5bfc\u520a2010\u63d0\u9ad8\uff0806\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1799&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1799\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f[i][j]$\u8868\u793a\u524d$i$\u4e2a\u6570\u9009\u4e86$j$\u4e2a\u6700\u591a\u591a\u5c11\n\n$f[i][j]=\\max(f[i-1][j-1]+[a[i]=j],f[i-1][j]);$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1011\nint n,a[N],f[N][N];\nint main(){\n    fin(\"in\");\n    in(n);\n    Fur(i,1,n)in(a[i]);\n    Fur(i,1,n)\n        Fur(j,1,i)\n        f[i][j]=MAX(f[i-1][j-1]+(a[i]==j),f[i-1][j]);\n    \n    int ans=0;\n    Fur(i,1,n)ans=MAX(ans,f[n][i]);\n    out(ans,ln);\n    flush();\n}\n```\n", "link": "/posts/LG 1799 \u6570\u5217_NOI\u5bfc\u520a2010\u63d0\u9ad8\uff0806\uff09/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3165 [CQOI2014]\u6392\u5e8f\u673a\u68b0\u81c2", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3165&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3165\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n`fhq treap` or `splay`\n\n\u8bb0\u5f55\u533a\u95f4\u6700\u5c0f\u503c\n\n\u76f4\u63a5\u6a21\u62df\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\n#define ls c[rt][0]\n#define rs c[rt][1]\nint sz[N],val[N],rnd[N],rev[N],c[N][2],RT,cnt,n,s[N];\nvoid pu(int rt){\n    sz[rt]=sz[ls]+sz[rs]+1;\n    s[rt]=MIN(val[rt],MIN(s[ls],s[rs]));\n}\nvoid pd(int rt){\n    if(rev[rt]){\n        SWAP(ls,rs);\n        rev[ls]^=1;rev[rs]^=1;\n        rev[rt]=0;\n    }\n}\nint ne(int v){val[++cnt]=v;s[cnt]=v;sz[cnt]=1;rnd[cnt]=rand();return cnt;}\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt){x=y=0;return;}\n    pd(rt);\n    if(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k-sz[ls]-1,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    pd(x);pd(y);\n    if(rnd[x]<rnd[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);\n        return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);\n        return y;\n    }\n}\nint get(int rt){\n    pd(rt);\n    if(s[ls]==s[rt])return get(ls);\n    if(val[rt]==s[rt])return sz[ls]+1;\n    return sz[ls]+1+get(rs);\n}\nstruct node{\n    int v,p;\n    bool operator<(node t){if(v!=t.v)return v<t.v;return p<t.p;}\n}a[N];\nint b[N];\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i].v),a[i].p=i;\n    sort(a+1,a+n+1);\n    Fur(i,1,n)b[a[i].p]=i;\n    int x,y,z,t;\n    s[0]=inf;sz[0]=0;\n    Fur(i,1,n)RT=mg(RT,ne(b[i]));\n    Fur(i,1,n){\n        sl(RT,i-1,x,y);\n        int p=get(y);\n        out(p+i-1,\" \");\n        sl(y,p,y,z);\n        rev[y]^=1;\n        RT=mg(x,mg(y,z));\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3165 [CQOI2014]\u6392\u5e8f\u673a\u68b0\u81c2/", "tags": ["\u5e73\u8861\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3848 [TJOI2007]\u8df3\u68cb", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3848&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3848\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$n\\le 100$,\u6bcf\u4e2a\u70b9\u90fd\u53ea\u80fd\u7ecf\u8fc7\u4e00\u6b21\n\n\u5f53\u7136\u76f4\u63a5dfs\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 111\nint n,a[N][N],sx,sy;\nbool v[N][N];\nint dx[4]={0,1,0,-1},dy[4]={1,0,-1,0},ans=0;\nvoid dfs(int x,int y,int d){\n    ans=MAX(ans,d);\n    v[x][y]=1;\n    Fur(i,0,3){\n        int nx=x+dx[i],ny=y+dy[i],t=1;\n        while(1<=nx&&nx<=n&&1<=ny&&ny<=n){\n            if(a[nx][ny])nx+=dx[i],ny+=dy[i],++t;\n            else{\n                if(t>1&&!v[nx][ny])dfs(nx,ny,d+t);\n                break;\n            }            \n        }\n    }\n    v[x][y]=0;\n}\nint main(){\n    in(n,sx,sy);\n    Fur(i,1,n)\n        Fur(j,1,n)\n        in(a[i][j]);\n\n    dfs(sx,sy,0);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 3848 [TJOI2007]\u8df3\u68cb/", "tags": ["dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4187 [USACO18JAN]Stamp Painting", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4187&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4187\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u52a8\u6001\u89c4\u5212\n\n\u9006\u5411\u601d\u7ef4\n\n\u7528\u6240\u6709\u7684\u51cf\u53bb\u4e0d\u5408\u6cd5\u7684\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000001\n#define mod 1000000007\nll n,m,k,f[N],sum,ans=1;\nint main(){\n\tfin(\"in\");\n\tin>>n>>m>>k;\n\tFur(i,1,n)ans=ans*m%mod;\n\tf[0]=1;\n\tFur(i,1,k-1)\n\t\tf[i]=f[i-1]*m%mod,\n\t\tsum=(sum+f[i])%mod;\n\t\n\tFur(i,k,n)\n\t\tf[i]=sum*(m-1)%mod,\n\t\tsum=(sum+f[i]-f[i-k+1])%mod;\n\t\n\tout<<(ans-f[n]+mod)%mod<<ln;\n}\n\n```\n", "link": "/posts/LG 4187 [USACO18JAN]Stamp Painting/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4099 [HEOI2013]SAO", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4099&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4099\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\n#define mod 1000000007\nint n,head[N],cnt=0,c[N][N];\nstruct edge{\n\tint to,nxt;\n}e[N];\nvoid add(int x,int y){\n\te[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint s[N];\nint dfs(int x){\n\tif(s[x])return s[x];\n\ts[x]=1;\n\tfl(i,x)dfs(to);\n}\nint main(){\n\tc[0][0]=1;\n\tFur(i,1,20)c[i][0]=1;\n\tFur(i,1,20)\n\t\tFur(j,1,20)c[i][j]=(c[i-1][j]+c[i-1][j-1])%mod;\n\tint T;in>>T;\n\twhile(T--){\n\t\tclr(head,0);cnt=0;\n\t\t\n\t\tin>>n;\n\t\tchar ch;\n\t\tint x,y;\n\t\tFur(i,1,n-1){\n\t\t\tin>>x>>ch>>y;\n\t\t\tif(ch=='>')SWAP(x,y);\n\t\t\tadd(x,y);\n\t\t}\n\t}\n}\n```\n", "link": "/posts/LG 4099 [HEOI2013]SAO/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1055 \u6700\u957f\u7b49\u5dee\u6570\u5217", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f_{i,j} =f_{i,k}+1(|a_i-a_k| = |a_k-a_j|)$\n\n\u5148\u5bf9$a$\u6392\u5e8f,\u7136\u540e$dp$,\u53cc\u6307\u9488,\u8bb0\u5f97\u6570\u7ec4\u5f00\u6210$short$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10001\nint n,a[N];\nshort f[N][N];\nint main(){\n\tfin(\"in\");\n\tin>>n;\n\tFur(i,1,n)in>>a[i];\n\tsort(a+1,a+n+1);\n\tint ans=0,j,k;\n\tFur(i,2,n-1){\n\t\tj=i-1;k=i+1;\n\t\twhile(j&&k<=n){\n\t\t\tif(a[j]+a[k]>2*a[i])--j;\n\t\t\telse if(a[j]+a[k]<2*a[i])++k;\n\t\t\telse{\n\t\t\t\tif(!f[j][i])f[j][i]=f[i][k]=3;\n\t\t\t\telse f[j][i]=f[i][k]=f[j][i]+1;\n\t\t\t\tans=MAX(ans,int(f[i][k]));--j,++k;\n\t\t\t}\n\t\t}\n\t}\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/51nod 1055 \u6700\u957f\u7b49\u5dee\u6570\u5217/", "tags": ["\u53cc\u6307\u9488"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1038E Maximum-Matching", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1038E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1038E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 111\nint n;\nint f[N][N][5][5];\nint main(){\n    in(n);\n    int a,b,c;\n    Fur(i,1,n)\n        Fur(j,1,n)\n            Fur(x,1,4)\n                Fur(y,1,4)\n                f[i][j][x][y]=-(1<<25);\n    Fur(i,1,n){\n        in(a,b,c);\n        f[i][i][a][c]=f[i][i][c][a]=b;\n    }\n    int ans=0;\n    Fdr(i,n,1)\n        Fur(j,i,n)\n            Fur(x,1,4)\n                Fur(y,1,4){\n                    Fur(k,i,j-1){\n                        f[i][j][x][y]=MAX(f[i][j][x][y],MAX(f[i][k][x][y],f[k+1][j][x][y]));\n                        Fur(p,1,4)\n                            f[i][j][x][y]=MAX(f[i][j][x][y],MAX(f[i][k][p][y]+f[k+1][j][x][p],f[i][k][x][p]+f[k+1][j][p][y]));\n                    }\n                    ans=MAX(ans,f[i][j][x][y]);\n                }\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG CF1038E Maximum-Matching/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u6b27\u62c9\u56fe"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1962 \u533a\u95f4\u8ba1\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7ef4\u62a4\u4e24\u4e2a\u5355\u8c03\u9012\u51cf\u6808,\u5f53$i$\u52a0\u8fdb\u6808,\u4f4d\u7f6e$x$\u7684\u6570\u5f39\u51fa\u7684\u65f6\u5019,\u5728\u53e6\u4e00\u4e2a\u6808\u4e2d\u627e\u5230\u548c\u8fd9\u4e2a\u6570\u4e00\u6837\u5927\u7684\u6570,\u8ba1\u7b97\u8d21\u732e$(x-$\u9760\u53f3\u5de6\u7aef\u70b9$)\\times (i-x)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define ll long long \nusing namespace std;\nconst int maxn=500010,inf=1e9;\nint n,m,x,y,z,tot,topa,topb;\nint a[maxn],b[maxn],sta[maxn],stb[maxn];\nll ans;\nvoid read(int &k){\n    int f=1;k=0;char c=getchar();\n    while(c<'0'||c>'9')c=='-'&&(f=-1),c=getchar();\n    while(c<='9'&&c>='0')k=k*10+c-'0',c=getchar();\n    k*=f;\n}\nint main(){\n    read(n);\n    for(int i=1;i<=n;i++)read(a[i]);\n    for(int i=1;i<=n;i++)read(b[i]);\n    a[++n]=inf;b[n]=inf-1;\n    for(int i=1;i<=n;i++){\n        for(;topa&&a[sta[topa]]<=a[i];topa--)\n        if(topb){\n            int l=1,r=topb;\n            while(l<r){\n                int mid=(l+r)>>1;\n                if(b[stb[mid]]<=a[sta[topa]])r=mid;\n                else l=mid+1;\n            }\n            int x=l;if(b[stb[x]]!=a[sta[topa]])continue;\n            ans+=1ll*max(0,min(stb[x],sta[topa])-max(stb[x-1],sta[topa-1]))*(i-max(stb[x],sta[topa]));\n        }\n        for(;topb&&b[stb[topb]]<=b[i];topb--)\n        if(topa){\n            int l=1,r=topa;\n            while(l<r){\n                int mid=(l+r)>>1;\n                if(a[sta[mid]]<=b[stb[topb]])r=mid;\n                else l=mid+1;\n            }\n            int x=l;if(a[sta[x]]!=b[stb[topb]])continue;\n            ans+=1ll*max(0,min(sta[x],stb[topb])-max(sta[x-1],stb[topb-1]))*(i-max(sta[x],stb[topb]));\n        }\n        sta[++topa]=stb[++topb]=i;\n    }\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/51nod 1962 \u533a\u95f4\u8ba1\u6570/", "tags": ["\u5355\u8c03\u6808", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF617E XOR-and-Favorite-Number", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF617E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF617E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$S_i$\u8868\u793a$[1,i]$\u7684\u5f02\u6216\u548c,\u533a\u95f4$[l,r]$\u7684\u5f02\u6216\u548c\u5c31\u662f$S_r \\bigoplus S_{l-1}$\n\n\u90a3\u4e48\u9898\u76ee\u53ef\u4ee5\u8f6c\u5316\u4e3a$[l-1,r]$\u4e2d\u6709\u591a\u5c11\u5bf9$S_i \\bigoplus S_j = k$,\u76f4\u63a5\u7528\u83ab\u961f\u7edf\u8ba1\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,k,sz,Q,s[N],cnt[1200010];\nstruct que{\n    int l,r,id;\n}q[N];\nil int bl(int x){return (x-1)/sz+1;}\nbool cmp(que x,que y){\n    if(bl(x.l)==bl(y.l))return x.r<y.r;\n    return x.l<y.l;\n}\nll ans=0,ANS[N];\nil void add(int x){\n    ans+=cnt[s[x]^k];\n    ++cnt[s[x]];\n}\nil void del(int x){\n    --cnt[s[x]];\n    ans-=cnt[s[x]^k];\n}\nint main(){\n    in(n,Q,k);sz=sqrt(n);\n    s[0]=0;\n    Fur(i,1,n){\n        int x;\n        in(x);\n        s[i]=x^s[i-1];\n    }\n    Fur(i,1,Q)in(q[i].l,q[i].r),--q[i].l,q[i].id=i;\n    sort(q+1,q+Q+1,cmp);\n    cnt[0]=1;\n    int l=0,r=0;\n    Fur(i,1,Q){\n        Fur(j,l,q[i].l-1)del(j);\n        Fdr(j,l-1,q[i].l)add(j);\n        Fur(j,r+1,q[i].r)add(j);\n        Fdr(j,r,q[i].r+1)del(j);\n        ANS[q[i].id]=ans;\n        l=q[i].l;r=q[i].r;\n    }\n    Fur(i,1,Q)out(ANS[i],ln);\n    flush();\n}\n```\n", "link": "/posts/LG CF617E XOR-and-Favorite-Number/", "tags": ["\u83ab\u961f", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1051D Bicolorings", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1051D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1051D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u8bbe$f[i][k][j]$\u8868\u793a\u7b2c$i$\u5217\u72b6\u6001\u4e3a$j$,\u8054\u901a\u5757\u4e2a\u6570\u4e3a$k$\u7684\u65b9\u6848\u6570\n\n\u6211\u4eec\u53ef\u4ee5\u5217\u51fa\u4e2a\u79cd\u72b6\u6001\u7684\u8f6c\u79fb\n\n```plain\n00 | 00 | 10 | 10\n00 | 10 | 00 | 10\n\n00 | 00 | 10 | 10\n01 | 11 | 01 | 11\n\n01 | 01 | 11 | 11\n00 | 10 | 00 | 10\n\n01 | 01 | 11 | 11\n01 | 11 | 01 | 11\n```\n\n\u589e\u52a0\u7684\u8054\u901a\u5757\u6570(\u8bbe\u8fd9\u4e2a\u77e9\u9635\u4e3a$g$):\n\n|      |      |      |      |\n| ---- | ---- | ---- | ---- |\n| 0    | 0    | 0    | 1    |\n| 1    | 0    | 2    | 1    |\n| 1    | 2    | 0    | 1    |\n| 1    | 0    | 0    | 0    |\n\n\u90a3\u4e48$f[i][k][j] = \\sum f[i-1][k-g[j][t]][t]$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1011\nconst int mod=998244353;\nint n,m,f[N][N*2][4],g[4][4]={\n    0,0,0,1,\n    1,0,2,1,\n    1,2,0,1,\n    1,0,0,0\n};\nsigned main(){\n    in(n,m);\n    f[1][1][0]=f[1][1][3]=f[1][2][1]=f[1][2][2]=1;\n    Fur(i,2,n)\n        Fur(k,1,2*i)\n            Fur(j,0,3)\n                Fur(t,0,3)\n                if(k-g[j][t]>0)\n                    (f[i][k][j]+=f[i-1][k-g[j][t]][t])%=mod;\n\n    ll ans=0;\n    Fur(t,0,3)(ans+=f[n][m][t])%=mod;\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG CF1051D Bicolorings/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1761 \u76f8\u4f3c\u5173\u7cfb", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u96c6\u5408hash\n\n1. \u4e24\u4e2a\u70b9\u4e0d\u8ba4\u8bc6\n\n   \u4e24\u4e2a\u70b9\u662f\u76f8\u4f3c\u5173\u7cfb\u8bf4\u660e\u4ed6\u4eec\u7684\u6240\u6709\u670b\u53cb\u90fd\u76f8\u540c,\u53ef\u4ee5\u628a\u4e00\u4e2a\u70b9\u7684\u670b\u53cb\u5f53\u6210\u96c6\u5408$hash$\u4e00\u4e0b,\u7136\u540e\u5c31\u53ef\u4ee5\u7edf\u8ba1\u4e86\n\n2. \u4e24\u4e2a\u70b9\u8ba4\u8bc6\n\n   \u4e24\u4e2a\u70b9\u662f\u76f8\u4f3c\u5173\u7cfb\u8bf4\u660e\u4ed6\u4eec\u7684\u6240\u6709\u670b\u53cb\u52a0\u4e0a\u5bf9\u65b9\u90fd\u76f8\u540c,\u53ef\u4ee5\u628a\u4e00\u4e2a\u70b9\u7684\u670b\u53cb\u52a0\u4e0a\u5b83\u81ea\u5df1\u5f53\u6210\u96c6\u5408$hash$\u4e00\u4e0b,\u7136\u540e\u5c31\u53ef\u4ee5\u7edf\u8ba1\u4e86\n\n\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000001\nint n,m;\nstruct node{\n\tull v;\n\tint id;\n}s[N];\nbool cmp(node x,node y){\n\treturn x.v<y.v;\n}\nint main(){\n\tfin(\"in\");\n\tin>>n>>m;\n\tint x,y;\n\tull ans=0;\n\tFur(i,1,n)s[i].id=i;\n\tFur(i,1,m){\n\t\tin>>x>>y;\n\t\ts[x].v+=1ull*y*y*y;\n\t\ts[y].v+=1ull*x*x*x;\n\t}\n\tsort(s+1,s+n+1,cmp);\n\ty=0;\n\tFur(i,1,n){\n\t\tif(s[i].v!=s[i-1].v)y=0;\n\t\ty++;\n\t\tans+=y-1;\n\t}\n\tFur(i,1,n)s[i].v+=1ull*s[i].id*s[i].id*s[i].id;\n\tsort(s+1,s+n+1,cmp);\n\tFur(i,1,n){\n\t\tif(s[i].v!=s[i-1].v)y=0;\n\t\ty++;\n\t\tans+=y-1;\n\t}\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/51nod 1761 \u76f8\u4f3c\u5173\u7cfb/", "tags": ["hash"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2157 [SDOI2009]\u5b66\u6821\u98df\u5802", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2157&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2157\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/LG 2157 [SDOI2009]\u5b66\u6821\u98df\u5802/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u72b6\u538bdp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF375D Tree and Queries", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF375D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF375D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9759\u6001\u94fe\u5206\u6cbb \u53c2\u89c1\u6a21\u677f\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\nint n,q,f[N],son[N],siz[N],a[N];\nint cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;dfs(to);\n        siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n}\nint c[N],ans[N],ANS[N];\nil void Add(int x,int v){\n    if(~v)++ans[++c[a[x]]];\n    else --ans[c[a[x]]--];\n}\nvoid upd(int x,int v){\n    Add(x,v);\n    fl(i,x)if(to!=f[x])upd(to,v);\n}\nstruct node{\n    int x,k,id;\n};\nvector<node>que[N];\nvoid sol(int x){\n    fl(i,x)if(to!=f[x]&&to!=son[x]){\n        sol(to);\n        upd(to,-1);\n    }\n    if(son[x])sol(son[x]);\n    Add(x,1);\n    fl(i,x)if(to!=f[x]&&to!=son[x])upd(to,1);\n    for(int i=0;i<que[x].size();++i)\n        ANS[que[x][i].id]=ans[que[x][i].k];\n}\nint main(){\n    fin(\"in\");\n    in>>n>>q;\n    Fur(i,1,n)in>>a[i];\n    int x,y;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    dfs(1);\n    Fur(i,1,q){\n        in>>x>>y;\n        que[x].push_back(node{x,y,i});\n    }\n    sol(1);\n    Fur(i,1,q)out<<ANS[i]<<ln;\n}\n```\n", "link": "/posts/LG CF375D Tree and Queries/", "tags": ["\u9759\u6001\u94fe\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1712 \u533a\u95f4\u6c42\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5b98\u65b9\uff1a\n\n>\u5bf9\u4e8e\u4e00\u6bb5\u533a\u95f4l~r,\u5176\u4e2d\u4e00\u4e2a\u6570x\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u4e3a(2x-l-r)\u6b21\u3002\n>\n>\u56e0\u6b64\u6211\u4eec\u53ea\u8981\u6c42\u51fa\u6240\u6709\u6570\u5bf9\u7b54\u6848\u7684\u8d21\u732e\u5e76\u7d2f\u52a0\u8d77\u6765\u5373\u53ef\u3002\n>\n>\u5c062x-l-r\u5206\u4e3a\u4e24\u90e8\u5206,\u4e00\u90e8\u5206\u4e3a\u6c422x\u7684\u548c,\u5373\u4e3ax\u5de6\u8fb9\u4e0ex\u53f3\u8fb9\u76f8\u540c\u7684\u6570\u7684\u5bf9\u6570\u3002\n>\n>\u53e6\u4e00\u90e8\u5206\u4e3al+r,\u5c06\u5176\u62c6\u5f00\u6765,\u5e76\u8bb0\u5f55\u524d\u7f00\u548c,\u5bf9\u4e8e\u4e00\u4e2a\u6570a[i],\u6211\u4eec\u9700\u8981\u7ef4\u62a4\u7684\u662f\u03a3k,\u03a3s[i-1],\u03a3s[i-1]*i,\u4ee5\u53caa[i]\u51fa\u73b0\u7684\u6b21\u6570\u5c31\u53ef\u4ee5\u4e86\u3002\n>\n>\u8fd9\u91cc\u6211\u4eec\u53ef\u4ee5\u5728\u679a\u4e3e\u7684\u540c\u65f6,\u8bb0\u5f55\u8fd9\u4e9b\u4fe1\u606f,\u5e76\u66f4\u65b0\u7b54\u6848,\u5c31\u53ef\u4ee5\u4e86\u3002\n>\n>\u590d\u6742\u5ea6\u4e3a\u7ebf\u6027O(n)\u3002\n\n\u66f4\u52a0\u8be6\u7ec6\uff1a\n\nhttps://www.cnblogs.com/zkGaia/p/6108204.html\n<!-- more -->\n\n```cpp\n#include <cstdio>\n#include <cstdlib>\n#include <cstring>\n#include <iostream>\n#define ll long long \n#define db double\n#define uint unsigned int\n#define N 3000100\n#define max(a, b) ((a) > (b) ? (a) : (b))\n#define min(a, b) ((a) < (b) ? (a) : (b))\n#define swap(T, a, b) ({T ttt = a; a = b; b = ttt;})\nint n, lrk[N], rrk[N], pre[N], next[N], pos[N];\nuint a[N], decA[N], decB[N], f[N], g[N], Ans = 0;\nvoid G(uint &w) {\n   w = 0; char c = getchar();\n   while (c > '9' || c < '0') c = getchar();\n   while (c >= '0' && c <= '9') { w = w * 10 + c - '0'; c = getchar(); }\n}\nuint Mult(uint a, uint b){\n   uint s = 0; \n   while(b){\n      if (b & 1) s += a;\n      a += a; b >>= 1;\n   }\n   return s;\n}\nint main(){\n   scanf(\"%d\", &n);\n   for (int i = 1; i <= n; i++)\n      G(a[i]);\n   memset(pos, 0, sizeof(pos));\n   for (int i = 1; i <= n; i++){\n      pre[i] = pos[a[i]]; pos[a[i]] = i;\n      lrk[i] = lrk[pre[i]] + 1;\n      decA[i] = decA[pre[i]] + pre[i];\n   }\n   memset(pos, 0, sizeof(pos)); \n   for (int i = n; i >= 1; i--){\n      next[i] = pos[a[i]]; pos[a[i]] = i;\n      rrk[i] = rrk[next[i]] + 1;\n      decB[i] = decB[next[i]] + next[i]; \n   }\n   for (int i = 1; i <= n; i++){\n      if (rrk[i] == 1){\n         next[i] = i+n; pre[i+n] = i;\n         lrk[next[i]] = lrk[i] + 1; \n         decA[i+n] = decA[i] + i;\n      }\n      if (lrk[i] == 1){\n         pre[i] = i+n*2; next[i+n*2] = i;\n         rrk[pre[i]] = rrk[i] + 1; \n         decB[i+n*2] = decB[i] + i;\n      }\n   }\n   for (int i = 1; i <= n; i++)\n      f[i] = f[i-1] + i*rrk[i] - decA[next[i-1]];\n   for (int i = n; i >= 1; i--)\n      g[i] = g[i+1] + i*lrk[i] - decB[pre[i+1]];\n   for (int i = 1; i <= n; i++)\n      f[i] = f[i] + g[i] - i*2; \n   memset(g, 0, sizeof(g));\n   memset(decA, 0, sizeof(decA));\n   for (int i = 1; i <= n; i++){\n      decA[i] = decA[pre[i]] + (pre[i] >= 1 && pre[i] <= n);\n      if (rrk[i] == 1) decA[i+n] = decA[i] + 1;\n   }\n   for (int i = 1; i <= n; i++){\n      g[i] = g[i-1] + rrk[i] - decA[next[i-1]];\n      f[i] = Mult(g[i] - 1, i) * 2 - f[i];\n      Ans += Mult(f[i], a[i]); \n   }\n   std::cout << Ans << std::endl; \n}\n\n```\n", "link": "/posts/51nod 1712 \u533a\u95f4\u6c42\u548c/", "tags": ["\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF734E Anton and Tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF734E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF734E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u7528\u5e76\u67e5\u96c6\u6c42\u51fa\u6240\u6709\u8fde\u901a\u5757(\u76f8\u90bb\u4e14\u76f8\u540c\u989c\u8272\u7684\u8282\u70b9)\n\n\u63a5\u7740\u662f\u76f8\u90bb\u8282\u70b9\u7684\u989c\u8272\u90fd\u4e0d\u4e00\u6837\u7684\u4e00\u68f5\u6811\n\n\u6700\u5c11\u6b21\u6570\u5c31\u662f\u6811\u7684\u76f4\u5f84/2\u4e86\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define Fur(i,x,y) for(int i=x;i<=y;i++)\n#define N 200011\nint n,a[N],b[N];\nstruct edge{\n\tint to,nxt;\n}e[N*2];\nint head[N],cnt=1;\nvoid add(int x,int y){\n\te[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint mx=0,d[N];\nvoid dfs(int x,int f){\n\tif(d[x]>d[mx])mx=x;\n\tfor(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t\tif(to!=f)d[to]=d[x]+1,dfs(to,x);\n}\nint f[N];\nint gf(int x){\n\treturn (x==f[x])?x:(f[x]=gf(f[x]));\n}\nint main(){\n\tscanf(\"%d\",&n);\n\tFur(i,1,n)scanf(\"%d\",&a[i]),f[i]=i;\n\tint x,y,t;\n\tFur(i,1,n-1)\n\t\tscanf(\"%d%d\",&x,&y),\n\t\tadd(x,y),add(y,x);\n\t\t\n\tFur(i,2,cnt){\n\t\tx=e[i].to,y=e[i^1].to;\n\t\tif(a[x]==a[y]&&gf(x)!=gf(y))f[f[y]]=f[x];\n\t\t++i;\n\t}\n\tt=cnt;cnt=0;\n\tmemset(head,0,sizeof(head));\n\tFur(i,2,t){\n\t\tx=gf(e[i].to),y=gf(e[i^1].to);\n\t\tif(x!=y)add(x,y),add(y,x);\n\t\t++i;\n\t}\n\tdfs(f[1],0);\n\tmemset(d,0,sizeof(d));\n\tdfs(mx,0);\n\tprintf(\"%d\\n\",(d[mx]+1)/2);\n}\n```\n", "link": "/posts/LG CF734E Anton and Tree/", "tags": ["\u5e76\u67e5\u96c6", "\u6811\u7684\u76f4\u5f84"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2602 [ZJOI2010]\u6570\u5b57\u8ba1\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2602&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2602\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6570\u4f4ddp\u6a21\u677f\u9898\n\n\u6211\u4eec\u5148\u4e0d\u8003\u8651\u524d\u5bfc$0$,\u90a3\u4e48\u6ee1i\u4f4d\u6240\u6709\u6570\u5b57\u51fa\u73b0\u7684\u6b21\u6570\u662f\u76f8\u540c\u7684\n\n\u8bbe$f_i$\u4e3a\u6ee1$i$\u4f4d\u6570\u5b57\u51fa\u73b0\u7684\u4e2a\u6570(\u56e0\u4e3a\u76f8\u540c\u5c31\u4e0d\u9700\u8981\u518d\u52a0\u4e00\u7ef4\u4e86)\n\n\u90a3\u4e48$f_i = f_{i-1} \\times 10 + 10^{i-1}$\n\n($(0-9)+(0-9.....)$)\n\n($0-9:10^{i-1},(0-9.....):f_{i-1} \\times 10$)\n\n\n\u6211\u4eec\u6765\u60f3\u60f3$ABCD$\u7684\u7b54\u6848\n\n\u5148\u8003\u8651$A000$\u4e2d\u7684$000$,\u6bcf\u79cd\u6570\u636e\u51fa\u73b0\u7684\u6b21\u6570\u662f$A \\times f_3$(\u56e0\u4e3a$A$\u540e\u9762\u6709$3$\u4f4d)\n\n\u90a3\u4e48$0$~$A-1$\u51fa\u73b0\u7684\u6b21\u6570\u8fd8\u8981\u52a0\u4e0a$10^{i-1}$($X xxx(xxx:0-999)$)\n\n\n\u63a5\u7740\u8003\u8651$ABCD$\u4e2d\u7684$BCD$,$A$\u51fa\u73b0\u7684\u6b21\u6570\u52a0\u4e0a$BCD+1(000-BCD)$\n\n\n\u6700\u540e\u51cf\u53bb\u524d\u5bfc$0$,\u4e5f\u5c31\u662f$0001,0002,...0101,0102,...,0999$\u8fd9\u4e9b,\u90a3\u4e48$0$\u51fa\u73b0\u7684\u6b21\u6570\u51cf\u53bb$10^{i-1}$\n\n\n\u7b54\u6848\u5c31\u662f$solve(r)-solve(l-1)$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nll f[N],a,b,A[10],B[10],ten[N];\nvoid solve(ll x,ll *cnt){\n\tint num[20]={0},len=0;\n\tll t=x;\n\twhile(x){\n\t\tnum[++len]=x%10,x/=10;\n\t}\n\tFdr(i,len,1){\n\t\tFur(j,0,9)cnt[j]+=f[i-1]*num[i];\n\t\tFur(j,0,num[i]-1)cnt[j]+=ten[i-1];\n\t\tt%=ten[i-1];\n\t\tcnt[num[i]]+=t+1;\n\t\tcnt[0]-=ten[i-1];\t\t\n\t}\n}\nint main(){\n\tin>>a>>b;\n\tten[0]=1;\n\tFur(i,1,12)\n\t\tf[i]=f[i-1]*10+ten[i-1],\n\t\tten[i]=ten[i-1]*10;\n\t\t\n\tsolve(a-1,A);solve(b,B);\n\tFur(i,0,9)out<<B[i]-A[i]<<\" \";\n}\n```\n", "link": "/posts/LG 2602 [ZJOI2010]\u6570\u5b57\u8ba1\u6570/", "tags": ["\u6570\u4f4ddp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF446C DZY Loves Fibonacci Numbers", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF446C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF446C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6253\u7b97\u76f4\u63a5\u628a\u6807\u8bb0\u7528$vector$\u8bb0\u5f55\u91cc,\u4ee5\u4e3a\u53ef\u4ee5\u6c34\u8fc7\u53bb,\u7ed3\u679cmle\u4e86\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\n#define ls rt<<1\n#define rs rt<<1|1\n#define mod 1000000009\n#define pu s[rt]=(s[ls]+s[rs])%mod\nint n,q;\nll f[N],sf[N],s[N<<2];\nvector<int>add[N<<2];\nvoid build(int l,int r,int rt){\n    if(l==r){\n        in>>s[rt];\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu;\n}\nint get(int p,int len){\n    return (sf[p+len-1]-sf[p-1]+mod)%mod;\n}\nvoid pd(int rt,int ln,int rn){\n    if(add[rt].empty())return;\n    Fur(i,0,add[rt].size()-1){\n        int v=add[rt][i];\n        add[ls].push_back(v);\n        add[rs].push_back(v+ln);\n        s[ls]+=get(v,ln);\n        s[rs]+=get(v+ln,rn);\n    }\n    add[rt].clear();\n}\nvoid upd(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt]=(s[rt]+get(l-L+1,r-l+1))%mod;\n        add[rt].push_back(l-L+1);\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)upd(L,R,l,m,ls);\n    if(R>m)upd(L,R,m+1,r,rs);\n    pu;\n}\nint ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt]%mod;\n    int m=(l+r)>>1,ans=0;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans+=ask(L,R,m+1,r,rs);\n    return ans%mod;\n}\nsigned main(){\n    in>>n>>q;\n    f[1]=f[2]=1;\n    Fur(i,3,n)f[i]=(f[i-1]+f[i-2])%mod;\n    Fur(i,1,n)sf[i]=(sf[i-1]+f[i])%mod;\n    build(1,n,1);\n    int l,r,u;\n    while(q--){\n        in>>u>>l>>r;\n        if(u==1)upd(l,r,1,n,1);\n        else out<<ask(l,r,1,n,1)<<ln;\n    }\n}\n```\n\n[\u6b63\u89e3\uff1a](https://xiaohuang888.github.io/2019/08/02/%E3%80%8E%E9%A2%98%E8%A7%A3%E3%80%8FCodeforces446C%20DZY%20Loves%20Fibonacci%20Numbers)\n\n\u8bbe$S_n=\\sum_{i=1}^n f_i$\n\n$S_n = f_{n+2} - f_2$\n\n\u8bc1\u660e\uff1a\n\n$S_{i+1}=S_i + f_{i+1} = f_{i+2} - f_2 + f_{i+1} = f_{i+3} - f_2$\n\n\u4efb\u610f\u4e24\u6bb5\u4e0d\u540c\u7684\u5e7f\u4e49\u6590\u6ce2\u90a3\u5951\u6570\u5217\u6bb5\u76f8\u52a0\uff08\u9010\u9879\u76f8\u52a0\uff09,\u6240\u5f97\u7684\u6570\u5217\u4efb\u7136\u662f\u5e7f\u4e49\u6590\u6ce2\u90a3\u5951\u6570\u5217\u3002\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\n#define ls rt<<1\n#define rs rt<<1|1\n#define mod 1000000009\nint n,q;\nll f[N],S[N],s[N<<2],sum[N],a1[N<<2],a2[N<<2];\nvoid pu(int rt,int p){\n    a1[rt]%=mod,a2[rt]%=mod;\n    s[rt]=(s[ls]+s[rs]+a1[rt]*f[p]+a2[rt]*f[p+1]-a2[rt])%mod;\n}\nvoid pd(int rt,int ln,int rn){\n    if(!a1[rt]&&!a2[rt])return;\n    a1[ls]+=a1[rt];a1[rs]+=a1[rt]*(ln-1)+a2[rt]*f[ln];\n    a2[ls]+=a2[rt];a2[rs]+=a1[rt]*ln+a2[rt]*f[ln+1];\n    a1[rt]=a2[rt]=0;\n    pu(ls,ln);pu(rs,rn);\n}\nvoid upd(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        a1[rt]+=f[l-L+1];a1[rt]%=mod;\n        a2[rt]+=f[l-L+2];a2[rt]%=mod;\n        pu(rt,r-l+1);\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)upd(L,R,l,m,ls);\n    if(R>m)upd(L,R,m+1,r,rs);\n    pu(rt,r-l+1);\n}\nint ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt]%mod;\n    int m=(l+r)>>1,ans=0;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans+=ask(L,R,m+1,r,rs);\n    return ans%mod;\n}\nsigned main(){\n    fin(\"in\");\n    in>>n>>q;\n    f[1]=f[2]=1;\n    Fur(i,3,n+1)f[i]=(f[i-1]+f[i-2])%mod;\n    Fur(i,1,n+1)S[i]=(S[i-1]+f[i])%mod;\n    Fur(i,1,n)in>>sum[i],sum[i]+=sum[i-1];\n    int l,r,u;\n    while(q--){\n        in>>u>>l>>r;\n        if(u==1)upd(l,r,1,n,1);\n        else out<<(ask(l,r,1,n,1)+(sum[r]-sum[l-1]+mod)%mod)%mod<<ln;\n    }\n}\n```\n", "link": "/posts/LG CF446C DZY Loves Fibonacci Numbers/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3067 [USACO12OPEN]\u5e73\u8861\u7684\u5976\u725b\u7fa4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3067&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3067\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 22\nint n,a[N],s=0;\nbool cmp(int x,int y){return x>y;}\nvoid dfs(){\n\n}\nint main(){\n\tfin(\"in\");\n\tin>>n;\n\tFur(i,1,n)in>>a[i],s+=a[i];\n\tsort(a+1,a+n+1,cmp);\n\n}\n```\n", "link": "/posts/LG 3067 [USACO12OPEN]\u5e73\u8861\u7684\u5976\u725b\u7fa4/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2698 [USACO12MAR]\u82b1\u76c6Flowerpot", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2698&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2698\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e8c\u5206\n\n\u5224\u65ad\u7684\u65f6\u5019\u679a\u4e3e\u533a\u95f4,\u7528rmq\u6216\u5355\u8c03\u961f\u5217\u6765\u6c42\u6700\u503c,~~\u8fd8\u53ef\u4ee5\u7528\u5806(\u770b\u9898\u89e3\u7684)~~\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,d,f[17][N],g[17][N];\nstruct node{int x,y;}a[N];\nbool cmp(node x,node y){return x.x<y.x;}\nint ask(int l,int r){\n\tint k=l2(r-l+1);\n\treturn MAX(f[k][l],f[k][r-(1<<k)+1])-MIN(g[k][l],g[k][r-(1<<k)+1]);\n}\nbool chk(int w){\n\tint r=1;\n\tFur(i,1,n){\n\t\twhile(a[r].x-a[i].x<=w&&r<=n)r++;\n\t\tr--;\n\t\tif(ask(i,r)>=d)return 1;\n\t}\n\treturn 0;\n}\nint main(){\n\tin>>n>>d;\n\tFur(i,1,n)in>>a[i].x>>a[i].y;\n\t\n\tsort(a+1,a+n+1,cmp);\n\t\n\tFur(i,1,n)f[0][i]=g[0][i]=a[i].y;\n\tFur(k,1,17)\n\t\tFur(i,1,n-(1<<k)+1)\n\t\tf[k][i]=MAX(f[k-1][i],f[k-1][i+(1<<(k-1))]),\n\t\tg[k][i]=MIN(g[k-1][i],g[k-1][i+(1<<(k-1))]);\n\t\n\tint l=0,r=1000000,ans=-1;\n\twhile(l<=r){\n\t\tint m=(l+r)>>1;\n\t\tif(chk(m))ans=m,r=m-1;\n\t\telse l=m+1;\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 2698 [USACO12MAR]\u82b1\u76c6Flowerpot/", "tags": ["\u4e8c\u5206", "rmq", "\u5355\u8c03\u961f\u5217", "\u5806"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3761 [TJOI2017]\u57ce\u5e02", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3761&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3761\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 5011\nint n,cnt=1,d[N],head[N],q[N],f[N],mx,link[N],ans=inf;\nstruct edge{\n\tint to,nxt,w;\n}e[N*100];\nbool b[N*100],v[N];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].nxt=head[x];e[cnt].w=w;head[x]=cnt;\n}\nvoid bfs(int x){\n\tclr(d,0);clr(f,0);clr(v,0);\n\tint h=0,t=1;mx=x;\n\tq[0]=x;\n\twhile(h<t){\n\t\tx=q[h++];v[x]=1;\n\t\tfl(i,x)\n\t\tif(!b[i]&&!v[to]){\n\t\t\td[to]=d[x]+e[i].w;\n\t\t\tf[to]=i^1;\n\t\t\tq[t++]=to;v[to]=1;\n\t\t\tif(d[to]>d[mx])mx=to;\n\t\t}\n\t}\n}\nint work(int w){\n\tint tmp=0,x,y,t;\n\tbfs(1);bfs(mx);tmp=d[mx];\n//\tout<<w<<\":\\n\";\n\tx=mx;t=(d[x]+1)/2;\n\twhile(t>0)t-=e[f[x]].w,x=e[f[x]].to;\n//\tout<<x<<\" \"<<d[mx]<<ln;\n\tFur(i,1,n)if(!v[i]){\n\t\tbfs(i);bfs(mx);\n\t\ttmp=MAX(tmp,d[mx]);\n\t\ty=mx;t=(d[y]+1)/2;\n\t\twhile(t>0)t-=e[f[y]].w,y=e[f[y]].to;\n//\t\tout<<y<<\" \"\t\t<<d[mx]<<ln;\n\t\tbreak;\n\t}\n\tadd(x,y,w),add(y,x,w);\n\tbfs(1);\n\tbfs(mx);\n//\tout<<mx<<\" \"<<d[mx]<<ln;\n\tb[cnt]=b[cnt-1]=1;\n\ttmp=MAX(tmp,d[mx]);\n\treturn tmp;\n}\nint main(){\n\tin>>n;\n\tint x,y,w;\n\tFur(i,1,n-1){\n\t\tin>>x>>y>>w;\n\t\tadd(x,y,w),add(y,x,w);\n\t}\n\tbfs(1);\n\tbfs(x=mx);y=mx;\n\tint d=0;\n\tfor(int i=y;i!=x;i=e[f[i]].to)link[++d]=f[i];\n//\tout<<i<<\" \";out<<x<<ln;\n\tFur(i,1,d){\n\t\tb[link[i]]=b[(link[i]^1)]=1;\n\t\tans=MIN(ans,work(e[link[i]].w));\n\t\tb[link[i]]=b[(link[i]^1)]=0;\n\t}\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 3761 [TJOI2017]\u57ce\u5e02/", "tags": ["\u6811\u7684\u76f4\u5f84"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF383C Propagating tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF383C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF383C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n### \u7ebf\u6bb5\u6811\u89e3\u6cd5\uff1a\n\n\u6211\u4eec\u8bb0\u5f55$d_x$\u8868\u793a$x$\u7684\u6df1\u5ea6\u8fd8\u6709$dfs$\u5e8f\n\n\u6bcf\u4e2a\u70b9\u4fee\u6539\u7684\u65f6\u5019\u628a\u5b83\u7684\u5b50\u6811\u90fd\u52a0\u4e0a$val$\n\n\u56e0\u4e3a\u8bb0\u5f55\u4e86\u6df1\u5ea6,\u6240\u4ee5$d_{x'}$\u5982\u679c\u548c$d_x$\u540c\u5947\u5076\u5219\u52a0\u4e0a$val$,\u5426\u5219\u51cf\u53bb$val$\n\n\n### \u6811\u72b6\u6570\u7ec4\u89e3\u6cd5\uff1a\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,q,a[N],head[N],cnt=0;\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint L[N],R[N],dfn=0,d[N];\nvoid dfs(int x,int f){\n    L[x]=++dfn;\n    fl(i,x)if(to!=f){\n        d[to]=d[x]^1;\n        dfs(to,x);\n    }\n    R[x]=dfn;\n}\n#define lb(x) (x&-x)\nint s[N];\nil void upd(int x,int v){\n    while(x<=n)s[x]+=v,x+=lb(x);\n}\nil  int ask(int x){\n    int ans=0;\n    while(x)ans+=s[x],x^=lb(x);\n    return ans;\n}\n\nint main(){\n    in>>n;\n    Fur(i,1,n)in>>a[i];\n    int x,y;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    dfs(1,0);\n    in>>q;\n    int u,v,c;\n    while(q--){\n        in>>c>>u;\n        if(c==1){\n            in>>v;\n            upd(L[u],d[u]?v:-v),upd(R[u]+1,d[u]?-v:v);\n        }\n        else{\n            int t=ask(L[u],v)\n        }\n    }\n}\n```\n", "link": "/posts/LG CF383C Propagating tree/", "tags": ["dfs\u5e8f", "\u6811\u72b6\u6570\u7ec4", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1463 \u627e\u670b\u53cb", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u628a\u6240\u6709\u533a\u95f4\u6309\u53f3\u7aef\u70b9\u6392\u5e8f\u3002\n\n\u56e0\u4e3a$m \\le 10$,\u6240\u4ee5\u76f4\u63a5\u679a\u4e3e$k$\u503c\u5c31\u53ef\u4ee5\u4e86\n\n\u5047\u8bbe\u5f53\u524d\u4f4d\u7f6e\u4e3a$i$,\u73b0\u5728\u8981\u627e\u4f4d\u7f6e$j$\u6ee1\u8db3$|b_i-b_j|$\u7b49\u4e8e\u5f53\u524d$k$\u503c,\u53ef\u4ee5\u662f$b_i-b_j$,\u5373$b_i > k$,\u4e5f\u53ef\u4ee5\u662f$b_j - b_i = k$\n\n\u5373$b_i+k = b_j, b_i+k\\le n$\u6211\u4eec\u4e8b\u5148\u7528$p_x$\u8bb0\u5f55\u503c\u4e3a$x$\u5728$b$\u6570\u7ec4\u4e2d\u7684\u54ea\u4e2a\u4f4d\u7f6e($b_i$\u4e92\u4e0d\u76f8\u540c,\u4e5f\u5c31\u662f$b$\u6570\u7ec4\u662f$1$~$n$\u7684\u7ec4\u5408)\n\n\u7528\u7ebf\u6bb5\u6811\u7ef4\u62a4\u4f4d\u7f6e$i$\u53ef\u4ee5\u8fbe\u5230\u7684\u6700\u5927\u7684\u503c\u5c31\u53ef\u4ee5\u4e86,\u56e0\u4e3a\u5df2\u7ecf\u6309\u53f3\u7aef\u70b9\u6392\u5e8f\u597d\u4e86,\u4e0d\u4f1a\u8d85\u8fc7\u5f53\u524d\u533a\u95f4\u7684\u53f3\u7aef\u70b9\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,m,Q,a[N],b[N],k[N],ans[N],p[N],s[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=MAX(s[ls],s[rs])\nvoid upd(int x,int c,int l=1,int r=n,int rt=1){\n\tif(l==r){\n\t\ts[rt]=MAX(s[rt],c);\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tif(x<=m)upd(x,c,l,m,ls);\n\telse upd(x,c,m+1,r,rs);\n\tpu;\n}\nint ask(int L,int R,int l=1,int r=n,int rt=1){\n\tif(L<=l&&r<=R)return s[rt];\n\tint m=(l+r)>>1,ans=-(1<<30);\n\tif(L<=m)ans=ask(L,R,l,m,ls);\n\tif(R>m)ans=MAX(ans,ask(L,R,m+1,r,rs));\n\treturn ans;\n}\nstruct que{\n\tint l,r,id;\n}q[N];\nbool cmp(que x,que y){\n\treturn x.r<y.r;\n}\nint main(){\n\tin>>n>>Q>>m;\n\tFur(i,1,n)in>>a[i];\n\tFur(i,1,n)in>>b[i],p[b[i]]=i;\n\tFur(i,1,m)in>>k[i];\n\tFur(i,1,Q)in>>q[i].l>>q[i].r,q[i].id=i;\n\tsort(q+1,q+Q+1,cmp);\n\tint x=0;\n\tFur(i,1,Q){\n\t\twhile(x<q[i].r){\n\t\t\tx++;\n\t\t\tFur(j,1,m){\n\t\t\t\tif(b[x]>k[j]&&p[b[x]-k[j]]<=x)\n\t\t\t\t\tupd(p[b[x]-k[j]],a[x]+a[p[b[x]-k[j]]]);\n\t\t\t\tif(b[x]+k[j]<=n&&p[k[j]+b[x]]<=x)\n\t\t\t\t\tupd(p[k[j]+b[x]],a[x]+a[p[k[j]+b[x]]]);\n\t\t\t}\n\t\t}\n\t\tans[q[i].id]=ask(q[i].l,q[i].r);\n\t}\n\tFur(i,1,Q)out<<ans[i]<<ln;\n}\n\n```\n", "link": "/posts/51nod 1463 \u627e\u670b\u53cb/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1788 \u6ce2\u6d6a\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint main(){\n\t\n}\n```\n", "link": "/posts/51nod 1788 \u6ce2\u6d6a\u6570/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1037D Valid-BFS", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1037D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1037D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u76f4\u63a5\u8fb9bfs\u8fb9\u5224\u65ad\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\nint n,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint q[N],b[N];\nbool v[N],T[N];\nvoid bfs(){\n    int h=0,t=1,x,p=2;\n    q[0]=1;\n    while(h<t){\n        x=q[h++];v[x]=1;\n        int k=0;\n        fl(i,x)if(!v[to])T[to]=1,++k;\n        while(k--){\n            if(T[b[p]]){\n                T[b[p]]=0;\n                q[t++]=b[p];\n                ++p;\n            }\n            else puts(\"No\"),exit(0);\n        }\n    }\n}\nint main(){\n    in(n);\n    int x,y;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    Fur(i,1,n)in(b[i]);\n    if(b[1]!=1)return puts(\"No\"),0;\n    bfs();\n    puts(\"Yes\");\n}\n```\n", "link": "/posts/LG CF1037D Valid-BFS/", "tags": ["bfs", "\u6a21\u62df"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1411 \u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1411&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1411\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u601d\u8def\u5267\u6bd2\u65e0\u6bd4\n\n\u8bbe$f[i][j]$\u8868\u793a\u5728$i$\u7684\u5b50\u6811\u4e2d,$i$\u6240\u5728\u7684\u8fde\u4f53\u5757\u5927\u5c0f\u4e3a$j$\u65f6$\\frac{\\text{\u6700\u5927\u5f97\u5206}}{j}$\n\n$f[i][j] = \\max(f[i][k] \\times f[to][j-k])$\n\n$f[i][0] = \\max(f[i][0],f[i][j] \\times j)$\n\n\u8fd8\u6ca1\u5b8c\n\n\u5410\u8840\u7684\u662f\u8fd8\u8981\u5199\u9ad8\u7cbe\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 711\nint n,cnt=0,head[N],siz[N];\n#define M 20\n#define base 1000000000\nstruct node{\n    node(){clr(a,0);len=1;}\n    ll a[M],len;\n    il void operator = (node x){cpy(a,x.a);len=x.len;}\n    il bool operator > (node x){\n        if(len!=x.len)return len>x.len;\n        Fdr(i,len,1)\n            if(a[i]<x.a[i])return 0;\n            else if(a[i]>x.a[i])return 1;\n        return 1;\n    }\n    il void op(){\n        printf(\"%d\",a[len]);\n        Fdr(i,len-1,1)printf(\"%10d\",a[i]);\n    }\n}f[N][N];\nnode operator * (node c,int y){\n    node x;\n    Fur(i,1,x.len){\n        x.a[i]+=c.a[i]*y;\n        if(x.a[i]>=base)\n            x.a[i+1]+=x.a[i]/base;\n    }\n    while(x.a[x.len]>=base){\n        x.a[x.len+1]+=x.a[x.len]/base;\n        x.a[x.len]%=base;\n        ++x.len;\n    }\n    return x;\n}\nnode operator * (node x,node y){\n    node c;\n    c.len=x.len+y.len-1;\n    Fur(i,1,x.len)\n        Fur(j,1,y.len){\n            c.a[i+j-1]+=x.a[i]*y.a[j];\n            if(c.a[i+j-1]>=base)\n                c.a[i+j]+=c.a[i+j-1]/base,\n                c.a[i+j-1]%=base;\n        }\n    \n    while(c.a[c.len]>=base){\n        c.a[c.len+1]+=c.a[c.len]/base;\n        c.a[c.len]%=base;\n        ++c.len;\n    }\n    return c;\n}\nstruct edge{\n    int to,nxt;\n}e[N*2];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x,int fa){\n    f[x][0].a[1]=1;\n    f[x][1].a[1]=1;\n    siz[x]=1;\n    fl(i,x)if(to!=fa){\n        dfs(to,x);\n        siz[x]+=siz[to];\n        Fdr(j,siz[x],0)\n            Fdr(k,MIN(j,siz[x]-siz[to]),MAX(1,j-siz[to]))\n                f[x][j]=MAX(f[x][j],f[x][k]*f[to][j-k]);\n    }\n    Fur(i,1,siz[x])\n        f[x][0]=MAX(f[x][0],f[x][i]*i);\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    int x,y;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    dfs(1,0);\n    f[1][0].op();\n}\n```\n", "link": "/posts/LG 1411 \u6811/", "tags": ["\u6811\u5f62dp", "\u9ad8\u7cbe\u5ea6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1044D Deduction-Queries", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1044D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1044D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u7528\u5e26\u6743\u5e76\u67e5\u96c6\u7ef4\u62a4\n\n\u8bbe$s_x$\u8868\u793a$x$\u5230\u7236\u4eb2\u7684\u5f02\u6216\u503c\n\n\u5f53\u5408\u5e76\u7684\u65f6\u5019\n\n\u5148$l=l-1$\n\n\u8bbe$fl,fr$\u5206\u522b\u4e3a$l,r$\u7684\u7236\u4eb2\n\n\u5408\u5e76\u540e\u5e94\u8be5\u662f:$s_r \\bigoplus s_l = x$\n\n$\\because s_r' = x \\bigoplus s_l, s_r' = s_r \\bigoplus s_{fr}'$,\n\n$\\therefore s_{fr}' = x \\bigoplus s_l \\bigoplus s_r$\n\n\u6211\u4eec\u53c8\u770b\u5230$0 \\leq i < 2^{30}$\n\n\u6211\u4eec\u53ef\u4ee5\u7528hash\u6216map\u79bb\u6563\u5316\n\n\u6ce8\u610f$l,r$\u53ef\u4ee5\u4e3a$0$,\u6240\u4ee5\u5b9e\u9645\u64cd\u4f5c\u65f6\u5e94\u8be5`++r`\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 400022\n#include<bits/extc++.h>\nusing namespace __gnu_pbds;\nmap<int,int>f,s;\nint q;\nint gf(int x){\n    if(!f.count(x))return x;\n    int t=gf(f[x]);\n    s[x]^=s[f[x]];\n    return f[x]=t;\n}\nint main(){\n    in(q);\n    int la=0;\n    while(q--){\n        int opt,l,r,x;\n        in(opt,l,r);\n        l^=la;r^=la;\n        if(l>r)SWAP(l,r);\n        --l;\n        if(opt==1){\n            in(x);x^=la;\n            int fl=gf(l),fr=gf(r);\n            if(fl!=fr){\n                f[fr]=fl;\n                s[fr]=x^s[l]^s[r];\n            }\n        }\n        else{\n            if(gf(l)!=gf(r))out(\"-1\\n\"),la=1;\n            else{\n                la=s[r]^s[l];\n                out(la,ln);\n            }\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF1044D Deduction-Queries/", "tags": ["\u4f4d\u8fd0\u7b97", "\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF580D Kefa-and-Dishes", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF580D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF580D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f[i][j]$\u8868\u793a\u72b6\u6001\u4e3a$i$,\u4e0a\u4e00\u4e2a\u5403\u7684\u662f\u7b2c$j$\u9053\u83dc\n\n$f[i'][k]=\\max(f[i'][k],f[i][j]+a[j]+d[j][k])$ ($d[j][k]$\u8868\u793a\u8fde\u7eed\u5403$j,k$\u80fd\u989d\u5916\u83b7\u5f97\u591a\u5c11\u6ee1\u610f\u5ea6)\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 600\nint n,m,K,a[N],d[N][N];\nll f[1<<18][20],ans=0;\nint main(){\n    in>>n>>m>>K;\n    Fur(i,1,n)in>>a[i];\n    int x,y,w;\n    Fur(i,1,K){\n        in>>x>>y>>w;\n        d[x][y]=MAX(d[x][y],w);\n    }\n    Fur(i,1,n)f[1<<(i-1)][i]=a[i];\n    Fur(i,0,(1<<n)-1){\n        int t=i,s=0;\n        while(t)s+=(t&1),t>>=1;\n        Fur(j,1,n)\n        if(i&(1<<(j-1))){\n            if(s==m)ans=MAX(ans,f[i][j]);\n            else{\n                Fur(k,1,n)\n                if(k!=j&&!(i&(1<<(k-1))))f[i|(1<<(k-1))][k]=MAX(f[i|(1<<(k-1))][k],f[i][j]+a[k]+d[j][k]);\n            }   \n        }\n    }\n    out<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG CF580D Kefa-and-Dishes/", "tags": ["\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1038C Gambling", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1038C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1038C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/LG CF1038C Gambling/", "tags": ["\u535a\u5f08\u8bba", "\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5585 \u3010SWTR-01\u3011Doing-Homework", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5585&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5585\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5982\u679c\u6ca1\u6709\u65f6\u95f4\u9650\u5236\u90a3\u5c31\u662f\u4e00\u4e2a\u88f8\u7684\u5b8c\u5168\u80cc\u5305\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u6309\u65f6\u95f4\u4ece\u5927\u5230\u5c0f\u6392\u5e8f,\u4fdd\u8bc1\u5982\u679c\u9009\u4e86\u540e\u9762\u4f5c\u4e1a\u80fd\u9009\u7684\u8bdd\u4e0d\u4f1a\u5f71\u54cd\u5f53\u524d\u4f5c\u4e1a\n\n\u63a5\u7740\u80cc\u5305\u6c42\u51fa\u6bcf\u5929\u7684\u6700\u5c0f\u82b1\u8d39\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 5011\n#define int ll\nint x,w,n,f[N*2];\nstruct node{\n    int x,w,t,c;\n}a[N];\nbool cmp(node p,node q){\n    return p.t>q.t;\n}\nsigned main(){\n    in(x,w,n);\n    Fur(i,1,n)in(a[i].x,a[i].w,a[i].t);\n    sort(a+1,a+n+1,cmp);\n    clr(f,0x3f);\n    f[0]=0;\n    Fur(i,1,n){\n        if(a[i].w>=w)f[w]=MIN(f[w],a[i].x);//\u7279\u5224\n        else \n            Fur(j,a[i].w,w+a[i].w)\n                f[j]=MIN(f[j],f[j-a[i].w]+a[i].x);\n        a[i].c=inf;\n        Fur(j,w,w*2)//\u4e0d\u4f1a\u8d85\u8fc7w*2\n            a[i].c=MIN(a[i].c,f[j]);\n    }\n    Fdr(i,n,1){\n        int c=a[i].c*(a[i].t-a[i+1].t);\n        if(c<=x)x-=c;\n        else printf(\"%d %d\\n\",a[i+1].t+x/a[i].c,x%a[i].c),exit(0);\n    }\n    printf(\"%d %d\\n\",a[1].t,x);\n}\n```\n", "link": "/posts/LG 5585 \u3010SWTR-01\u3011Doing-Homework/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u80cc\u5305"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1496 \u6700\u5c0f\u5f02\u6216\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u90a3\u4e2a\u53ea\u8981\u6709\n10000\u2026\u2026\n11000\u2026\u2026\n\u2026\u2026\n\u5c31\u53ef\u4ee5\u4e00\u76f4\u641e\u4e0b\u53bb\n\u76f4\u5230\u4e3a0\n\n\u4f46\u662f\u4e5f\u6709\u7279\u6b8a\u60c5\u51b5\uff1a\n\n\u6bd4\u5982$k \\le 4$\n\n\u4e0d\u8fc7\u8fd9\u79cd\u60c5\u51b5\u7279\u5224\u548cdfs\u90fd\u53ef\u4ee5\u89e3\u51b3\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\n#define N 10001\nll l,r;\nint k;\nvoid work(){\n\tll t=1ll<<l2(l);\n\tif(r>=(t+(t<<1)))cout<<0;\n\telse cout<<1;\n}\nll ans;\nvoid dfs(ll x,ll y){\n\tif(x>r){\n\t\tans=MIN(ans,y);\n\t\treturn;\n\t}\n\tdfs(x+1,y);dfs(x+1,y^x);\n}\nint main(){\n\tcin>>l>>r>>k;\n\tif(k==1)return cout<<l,0;\n\tif(k==2){\n\t\tif(r-l<=1)cout<<MIN(l,l^r);\n\t\telse cout<<1;\n\t\treturn 0;\n\t}\n\tif(k==3)work();\n\tif(k>3){\n\t\tif(r-l+1==4){\n\t\t\tans=1;\n\t\t\tdfs(l+1,l);\n\t\t\tdfs(l+2,l+1);\n\t\t\tdfs(l+3,l+2);\n\t\t\tdfs(l+4,l+3);\n\t\t\tcout<<ans;\n\t\t}\n\t\telse cout<<0;\n\t}\n\t\n}\n\n```\n", "link": "/posts/51nod 1496 \u6700\u5c0f\u5f02\u6216\u548c/", "tags": ["\u4f4d\u8fd0\u7b97"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4407 [JSOI2009]\u7535\u5b50\u5b57\u5178", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4407&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4407\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bb0\u5f55\u6bcf\u4e2a\u5355\u8bcd\u7684hash\u503c\n\n\u7136\u540e\u6309\u7167\u9898\u76ee\u6240\u8bf4\u64cd\u4f5c\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il inline\n#define ull unsigned long long \nusing namespace std;\nconst int N=1e5+5;const ull B=233;\null h[N],H[25],S[N],b[25];\nint n,m;char s[25]; \nil int find(ull x){\n    int l=1,r=n,mid;\n    while(l<=r) (h[mid=l+r>>1]<=x)?l=mid+1:r=mid-1;\n    return h[l-1]==x&&x;\n}\nint main(){\n    ios::sync_with_stdio(0);\n    b[0]=1;for(int i=1;i<=21;++i) b[i]=b[i-1]*B;\n    cin>>n>>m;\n    for(int i=1;i<=n;++i){\n        cin>>s+1;\n        for(int j=1,lg=strlen(s+1);j<=lg;++j) h[i]=h[i]*B+s[j]-96;\n    }\n    sort(h+1,h+n+1);\n    while(m--){\n        cin>>s+1;int lg=strlen(s+1),ct=0;S[lg+1]=0;\n        for(int i=1;i<=lg;++i) H[i]=H[i-1]*B+s[i]-96;\n        for(int i=lg;i>=1;--i) S[i]=S[i+1]+(s[i]-96)*b[lg-i];\n        if(find(H[lg])){printf(\"-1\\n\");continue;}\n        for(int i=0;i<lg;++i) if(s[i]^s[i+1])\n        if(find(H[i]*b[lg-i-1]+S[i+2])) ++ct;\n        for(int i=0;i<=lg;++i) for(int j=1;j<=26;++j) if(j!=s[i]-96)\n        if(find(H[i]*b[lg-i+1]+j*b[lg-i]+S[i+1])) ++ct;\n        for(int i=1;i<=lg;++i) for(int j=1;j<=26;++j)\n        if(find(H[lg]+(j-s[i]+96)*b[lg-i])) ++ct;\n        printf(\"%d\\n\",ct);\n    }\n}\n```\n", "link": "/posts/LG 4407 [JSOI2009]\u7535\u5b50\u5b57\u5178/", "tags": ["hash"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1912 [NOI2009]\u8bd7\u4eba\u5c0fG", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1912&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1912\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_i$\u4e3a\u524d$i$\u4e2a\u6700\u5c0f\u4ee3\u4ef7\n\n\u8bbe$s_i$\u4e3a\u524d$i$\u4e2a\u5b57\u7b26\u4e32\u603b\u5b57\u7b26\u6570\n\n$$\nf_i=\\min(f_j+|(s_i-s_j)+(i-j-1)-L|^p)\n$$\n\n\u53ef\u4ee5\u53d1\u73b0\u8fd9\u4e2a\u65b9\u7a0b\u6709\u51b3\u7b56\u5355\u8c03\u6027\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,L,P,s[N],k[N],pre[N];\n#define ld long double\nld f[N];\nld calc(int i,int j){\n    return f[j]+pow(ABS(s[i]-s[j]-L-1),P);\n}\nchar ch[N][33];\nil int bound(int x,int y){\n    int l=x,r=n+1,ret=n+1,m;\n    while(l<=r){\n        m=(l+r)>>1;\n        if(calc(m,x)>=calc(m,y))\n            ret=m,r=m-1;\n        else l=m+1;\n    }\n    return ret;\n}\nint q[N];\nvoid work(){\n    in(n,L,P);\n    Fur(i,1,n){\n        in(ch[i]);\n        s[i]=s[i-1]+strlen(ch[i])+1;\n    }\n\n    int h=1,t=1;\n    q[1]=0;\n    Fur(i,1,n){\n        while(h<t&&k[h]<=i)++h;\n        f[i]=calc(i,q[h]);pre[i]=q[h];\n        while(h<t&&k[t-1]>=bound(q[t],i))--t;\n        k[t]=bound(q[t],i);\n        q[++t]=i;\n    }\n\n    if(f[n]>1e18)out(\"Too hard to arrange\\n\");\n    else{\n        out((ll)f[n],ln);\n        int i;\n        for(q[t=0]=i=n;i;q[++t]=i=pre[i]);\n        for(;t;--t){\n            for(i=q[t]+1;i<q[t-1];++i)\n                out(ch[i],\" \");\n            out(ch[i],ln);\n        }\n    }\n    out(\"--------------------\\n\");\n}\nint main(){\n    int T;in(T);\n    while(T--)work();\n    flush();\n}\n```\n", "link": "/posts/LG 1912 [NOI2009]\u8bd7\u4eba\u5c0fG/", "tags": ["\u51b3\u7b56\u5355\u8c03\u6027", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1140 \u77e9\u9635\u76f8\u4e58\u7ed3\u679c\u7684\u5224\u65ad", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6784\u9020$1 \\times n$\u7684\u77e9\u9635$X$\n\n\u77e9\u9635\u6ee1\u8db3\n\n$\\because A \\times B = C$\n\n$\\therefore X \\times A \\times B = X \\times C$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 511\nint a[N][N],b[N][N],X[1][N],n,c[N][N],C[N][N];\nbool t=0;\nvoid times(int a[N][N], int b[N][N]){\n\tclr(c,0);\n\tFur(i,1,n)\n\t\tFur(j,1,n)\n\t\t\tFur(k,1,n)\n\t\t\t\tc[i][j] += a[i][k] * b[k][j];\n\n\tif(t)cpy()\n}\nint main(){\n\tsrand((int)time(NULL));\n\tin>>n;\n\tFur(i,1,n)\n\t\tFur(j,1,n)\n\t\t\tin>>a[i][j];\n\n\tFur(i,1,n)\n\t\tFur(j,1,n)\n\t\t\tin>>b[i][j];\n\n\tFur(i,1,n)\n\t\tFur(j,1,n)\n\t\t\tin>>c[i][j];\n\t\n\tFur(i,1,n)X[1][n] = rand()%17;\n\n\ttimes(X,a,c);times(C,b,C);times(c,X,c);\n\n\tbool f = 1;\n\tFur(i,1,n)\n\tif(f)\n\t\tFur(j,1,n)\n\t\tif(c[i][j] != C[i][j]){\n\t\t\tf = 0;\n\t\t\tbreak;\n\t\t}\n\tif(f) out << \"Yes\\n\";\n\telse out << \"No\\n\";\n}\n```\n", "link": "/posts/51nod 1140 \u77e9\u9635\u76f8\u4e58\u7ed3\u679c\u7684\u5224\u65ad/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP4580 ABCDEF", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP4580&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP4580\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nABCDEF\ntop: 0\n\n$\\frac{a \\times b + c}d -e = f$\n\n$a \\times b + c = de+df$\n\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u641c\u7d22$a+b+c$\u53ef\u80fd\u7684\u7ed3\u679c\u548c$de+df$\u53ef\u80fd\u7684\u7ed3\u679c,\u7136\u540e\u5408\u5e76\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10000011\nint n,v[N],a[N],b[N],ta=0,tb=0;\nint main(){\n    in>>n;\n    Fur(i,1,n)in>>v[i];\n    Fur(i,1,n)\n        Fur(j,1,n)\n            Fur(k,1,n)\n            a[++ta]=v[i]*v[j]+v[k];\n    \n    Fur(i,1,n)\n    if(v[i])\n        Fur(j,1,n)\n            Fur(k,1,n)\n            b[++tb]=v[i]*(v[j]+v[k]);\n    \n    sort(a+1,a+ta+1);\n    sort(b+1,b+tb+1);\n    int ans=0,r=1;\n    Fur(i,1,ta){\n        int p=1,q=0;\n        while(a[i]==a[i+1])++i,++p;\n        while(b[r]<a[i])++r;\n        if(b[r]==a[i]){\n            q=1;\n            while(b[r]==b[r+1])++q,++r;\n            ans+=p*q;\n        }\n    }\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG SP4580 ABCDEF/", "tags": ["\u6298\u534a\u641c\u7d22"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3794 \u7b7e\u5230\u9898IV", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3794&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3794\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0$gcd(a_l,...,a_r)$\u662f\u5355\u8c03\u9012\u51cf\u7684,\u800c$or(a_l,...,a_r)$\u662f\u5355\u8c03\u9012\u589e\u7684\n\n\u6240\u4ee5\u6211\u4eec\u53ef\u4ee5\u4e24\u6b21\u4e8c\u5206\u6765\u627e\u5230\u5408\u6cd5\u533a\u95f4\n\n\u81f3\u4e8e\u6c42$gcd(a_l,...,a_r),or(a_l,...,a_r)$\u6211\u4eec\u53ef\u4ee5\u7528$rmq$\u6765\u6c42\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500011\nint n,k,a[N],f[21][N],g[21][N];\nvoid st(){\n    Fur(i,1,n)f[0][i]=g[0][i]=a[i];\n    Fur(i,1,20)\n        Fur(j,1,n-(1<<i)+1){\n            f[i][j]=f[i-1][j]|f[i-1][j+(1<<(i-1))];\n            g[i][j]=GCD(g[i-1][j],g[i-1][j+(1<<(i-1))]);\n        }\n}\nint g1(int l,int r){\n    int sz=l2(r-l+1);\n    return f[sz][l]|f[sz][r-(1<<sz)+1];\n}\nint g2(int l,int r){\n    int sz=l2(r-l+1);\n    return GCD(g[sz][l],g[sz][r-(1<<sz)+1]);\n}\nll ans=0;\nint find(int s,int x,int l,int r){\n    int as;\n    while(l<=r){\n        int m=(l+r)>>1,z=g2(s,m);\n        if(x==z)as=m,l=m+1;\n        else r=m-1;\n    }\n    return as;\n}\nvoid solve(int s,int x,int l,int r){\n    int L=l,R=r,num=0,Num=-1; \n    while(l<=r){\n        int m=(l+r)>>1,z=g1(s,m);\n        if(x==z)r=m-1,num=m; \n        else if(x<z)r=m-1;\n        else if(x>z)l=m+1;\n    }\n    while(L<=R){\n        int m=(L+R)>>1,z=g1(s,m);\n        if(x==z)L=m+1,Num=m;\n        else if(x<z)R=m-1;\n        else if(x>z)L=m+1;\n    }\n    ans+=Num-num+1;\n}\nint main(){\n    in(n,k);\n    Fur(i,1,n)in(a[i]);\n    st();\n    Fur(i,1,n)\n        Fur(j,i,n){\n            int t=g2(i,j),p=find(i,t,j,n);\n            solve(i,t^k,j,p);\n            j=p;\n        }\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/LG 3794 \u7b7e\u5230\u9898IV/", "tags": ["rmq", "\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1950 \u957f\u65b9\u5f62_NOI\u5bfc\u520a2009\u63d0\u9ad8\uff082\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1950&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1950\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\nint n,m,h[N],sta[N],v[N],tp;\nbool a[N][N];\nchar ch[N];\nint main(){\n\tfin(\"in\");\n\tin>>n>>m;\n\tFur(i,1,n){\n\t\tin>>(ch+1);\n\t\tFur(j,1,m)\n\t\ta[i][j]=ch[j]=='.';\n\t}\n\tll ans=0;\n\ttp=0;\n\tFur(i,1,n){\n\t\tFur(j,1,m){\n\t\t\tif(!a[i][j])h[j]=i;\n\t\t\twhile(tp&&h[sta[tp]]<h[j])tp--;\n\t\t\tsta[++tp]=j;\n\t\t\tv[tp]=v[tp-1]+(i-h[sta[tp]])*(sta[tp]-sta[tp-1]);\n\t\t\tans+=v[tp];\n\t\t}\n\t\ttp=0;\n\t}\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 1950 \u957f\u65b9\u5f62_NOI\u5bfc\u520a2009\u63d0\u9ad8\uff082\uff09/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF833B The-Bakery", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF833B&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF833B\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f[i][k]$\u4e3a\u7b2c$i$\u4f4d,\u5206\u6210$k$\u6bb5\n\n$f[i][k] = MAX(f[j][k-1] + cnt[j+1][i])$\n\n\u8fd9\u6837\u7684\u8bdd\u80af\u5b9a\u590d\u6742\u5ea6\u7206\u70b8\n\n\u65e2\u7136\u770b\u5230$MAX$,\u90a3\u662f\u4e0d\u662f\u53ef\u4ee5\u7528\u7ebf\u6bb5\u6811\u4f18\u5316\u5462\uff1f\n\n\u8bb0\u5f55\u6bcf\u4e2a\u70b9\u8d21\u732e\u7684\u8303\u56f4,\u66f4\u65b0\u65f6\u628a\u8fd9\u4e2a\u8303\u56f4\u7684\u70b9++\u5c31\u53ef\u4ee5\u4e86\u3002\n\n\u76f8\u4fe1\u770b\u4ee3\u7801\u53ef\u4ee5\u770b\u61c2\n\n~~\u5176\u5b9e\u6211\u8fd8\u52a0\u4e86\u6eda\u52a8\u6570\u7ec4OwO~~\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 35011\nint pre[N],p[N],n,k,s[N<<2],laz[N<<2],f[N];\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=MAX(s[ls],s[rs]);\nvoid build(int l,int r,int rt){\n\tif(l==r){\n\t\ts[rt]=f[l-1];laz[rt]=0;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tbuild(l,m,ls);build(m+1,r,rs);\n\tpu;\n}\nvoid pd(int rt){\n\tif(laz[rt]){\n\t\tlaz[ls]+=laz[rt];laz[rs]+=laz[rt];\n\t\ts[ls]+=laz[rt];s[rs]+=laz[rt];\n\t\tlaz[rt]=0;\n\t}\n}\nvoid upd(int L,int R,int l,int r,int rt){\n\tif(L<=l&&r<=R){\n\t\ts[rt]++;\n\t\tlaz[rt]++;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tpd(rt);\n\tif(L<=m)upd(L,R,l,m,ls);\n\tif(R>m)upd(L,R,m+1,r,rs);\n\tpu;\n}\nint ask(int L,int R,int l,int r,int rt){\n\tif(L<=l&&r<=R)return s[rt];\n\tint m=(l+r)>>1,ans=0;\n\tpd(rt);\n\tif(L<=m)ans=ask(L,R,l,m,ls);\n\tif(R>m)ans=MAX(ans,ask(L,R,m+1,r,rs));\n\treturn ans;\n}\nint main(){\n\tin>>n>>k;\n\tint x;\n\tFur(i,1,n)\n\t\tin>>x,\n\t\tpre[i]=p[x]+1,\n\t\tp[x]=i;\n\t\t\n\tFur(i,1,k){\n\t\tclr(laz,0);clr(s,0);\n\t\tbuild(1,n,1);\n\t\tFur(j,1,n)\n\t\t\tupd(pre[j],j,1,n,1),\n\t\t\tf[j]=ask(1,j,1,n,1);\n\t}\n\tout<<f[n]<<ln;\n}\n```\n", "link": "/posts/LG CF833B The-Bakery/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1029C Maximal-Intersection", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1029C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1029C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5176\u5b9e\u4e00\u70b9stl\u4ec0\u4e48\u7684\u90fd\u4e0d\u7528\u7528\u5230\n\n\u533a\u95f4\u4ea4\u4e5f\u5c31\u662f$[\\max(l_i),\\min(r_i)]$\n\n\u6211\u4eec\u8981\u6c42\u7684\u5c31\u662f\u6bcf\u6b21\u5220\u6389\u67d0\u4e2a\u533a\u95f4\u540e\u5176\u4ed6\u533a\u95f4\u7684\u533a\u95f4\u4ea4\n\n\u6211\u4eec\u53ea\u9700\u8981\u8bb0\u5f55\u6700\u5927$l_i$\u548c\u6b21\u5927$l_i$\u8fd8\u6709\u6700\u5c0f$r_i$\u548c\u6b21\u5c0f$r_i$\n\n\u82e5\u5f53\u524d\u8981\u5220\u6389\u7684\u533a\u95f4$[l_i,r_i],l_i$\u4e3a\u6700\u5927L,\u90a3\u6211\u4eec\u5c31\u53d6\u6b21\u5927L\n\nR\u540c\u7406\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 300011\nint n,ml1=0,ml2=0,mr1=inf,mr2=inf;\nstruct node{\n    int l,r;\n}a[N];\nint main(){\n    in(n);\n    int l,r;\n    Fur(i,1,n){\n        in(l,r);\n        a[i]={l,r};\n        if(l>=ml1)ml2=ml1,ml1=l;\n        else if(l>ml2)ml2=l;\n\n        if(r<=mr1)mr2=mr1,mr1=r;\n        else if(r<mr2)mr2=r;\n    }\n    int ans=0,L,R;\n    Fur(i,1,n){\n        l=a[i].l,r=a[i].r;\n        if(l==ml1)L=ml2;\n        else L=ml1;\n\n        if(r==mr1)R=mr2;\n        else R=mr1;\n        ans=MAX(ans,R-L);\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG CF1029C Maximal-Intersection/", "tags": ["\u6a21\u62df", "\u679a\u4e3e"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4996 \u5495\u5495\u5495 ", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4996&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4996\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 31\n#define mod 998244353\nint n,m;\nll f[N],c[N][N],ans=0;\nchar ch[N];\nint main(){\n\tin>>n>>m;\n\tc[0][0]=1;\n\tFur(i,1,20)c[i][0]=1;\n\tFur(i,1,20)\n\t\tFur(j,1,20)c[i][j]=(c[i-1][j]+c[i-1][j-1])%mod;\n\t\n\tf[0]=1;\n\tFur(i,1,20)\n\t\tFur(j,1,i)\n\t\t\tf[i]=(f[i]+f[i-j]*c[i][j])%mod;\n\tint x;ll v;\n\tFur(i,1,m){\n\t\tin>>ch>>v;x=0;\n\t\tFur(i,0,n-1)x+=ch[i]-48;\n\t\tans=(ans+v*f[x]%mod*f[n-x]%mod)%mod;\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 4996 \u5495\u5495\u5495/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4813 [CCO 2014]Troy \u4e0e\u4e09\u89d2\u5f62", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4813&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4813\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bb0\u5f55$up[i][j]$\u8868\u793a\u4f4d\u7f6e$(i,j)$\u53ef\u4ee5\u5411\u4e0a\u591a\u5c11\u4e2a`#`\n\n$s[i][j]$\u8868\u793a\u4f4d\u7f6e$(i,j)$\u4f5c\u4e3a\u4e09\u89d2\u5f62\u4e2d\u5fc3\u53ef\u4ee5\u5411\u5de6\u591a\u5c11\u4e2a`#`\n\n$S[i][j]$\u8868\u793a\u4f4d\u7f6e$(i,j)$\u4f5c\u4e3a\u4e09\u89d2\u5f62\u4e2d\u5fc3\u53ef\u4ee5\u5411\u53f3\u591a\u5c11\u4e2a`#`\n\n$ans = \\sum_{i=1}^n\\sum_{j=1}^n \\min(s[i][j],S[i][j])$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 2011\nint n,up[N][N],s[N][N],S[N][N];\nchar ch[N][N];\nbool b[N][N];\nint main(){\n    fin(\"in\");\n    in>>n;\n    Fur(i,1,n)in>>(ch[i]+1);\n    Fur(i,1,n)\n        Fur(j,1,n)\n        b[i][j]=(ch[i][j]=='#');\n    Fur(i,1,n)\n        Fur(j,1,n)\n        if(b[i][j])up[i][j]=up[i-1][j]+1;\n    \n    Fur(i,1,n)\n        Fur(j,1,n)\n        if(b[i][j])s[i][j]=MIN(up[i][j],s[i][j-1]+1);\n\n    Fur(i,1,n)\n        Fdr(j,n,1)\n        if(b[i][j])S[i][j]=MIN(up[i][j],S[i][j+1]+1);\n    \n    ll ans=0;\n    Fur(i,1,n)Fur(j,1,n)if(b[i][j])ans+=MIN(s[i][j],S[i][j]);\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 4813 [CCO 2014]Troy \u4e0e\u4e09\u89d2\u5f62/", "tags": ["\u524d\u7f00\u548c", "\u601d\u7ef4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF235B Lets-Play-Osu", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF235B&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF235B\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 10011\nint n;\nint main(){\n\tdouble ans=0,t=0,x;\n\tscanf(\"%d\",&n);\n\twhile(n--){\n\t\tscanf(\"%lf\",&x);\n\t\tans=ans+x*(2*t+1);\n\t\tt=(t+1)*x;\n\t}\n\tprintf(\"%.10f\\n\", ans);\n}\n```\n", "link": "/posts/LG CF235B Lets-Play-Osu/", "tags": ["\u671f\u671b"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4291 [HAOI2008]\u6392\u540d\u7cfb\u7edf", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4291&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4291\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#include<ext/pb_ds/assoc_container.hpp>\n#include<ext/pb_ds/tree_policy.hpp>\n#define il inline\n#define ll long long\n#define RE register\n#define For(i,a,b) for(RE int (i)=(a);(i)<=(b);(i)++)\n#define Bor(i,a,b) for(RE int (i)=(b);(i)>=(a);(i)--)\nusing namespace std;\nusing namespace __gnu_pbds;\n#define N 500005;\nint n,val[N],cnt,tot;\nmap<string,int> mp;\nstring ss[N];\nstruct node{\n    int v,id;\n    bool operator < (const node &x) const {return v==x.v?id<x.id:v>x.v;}\n};\ntree<node,null_type,less<node>,rb_tree_tag,tree_order_statistics_node_update> T;\nil bool isdig(char x){return x>='0'&&x<='9';}\nint main(){\n    ios::sync_with_stdio(0);\n    cin>>n;char c;string s;int x,tp;\n    while(n--){\n        cin>>c>>s;\n        if(c=='+'){\n            if(mp[s]){\n            tp=mp[s],T.erase(node{val[tp],tp});tot--;\n        }\n        mp[s]=++cnt,cin>>val[cnt],T.insert(node{val[cnt],cnt});tot++;\n            ss[cnt]=s;\n        }\n        else if(c=='?'&&!isdig(s[0])){\n            x=mp[s];cout<<T.order_of_key(node{val[x],x})+1<<endl;\n        }\n        else{\n            x=0;\n            For(i,0,s.size()-1) x=(x<<3)+(x<<1)+(s[i]^48);\n            tp=min(tot,x+9);\n            For(i,x-1,tp-1)cout<<ss[T.find_by_order(i)->id]<<' ';cout<<endl;\n        }\n    }\n} \n```\n", "link": "/posts/LG 4291 [HAOI2008]\u6392\u540d\u7cfb\u7edf/", "tags": ["\u5e73\u8861\u6811", "hash"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2174 \u5c0fZ\u7684\u795e\u5947\u6570\u5217", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2174&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2174\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u79bb\u7ebf\u5904\u7406,\u5012\u7740\u6dfb\u52a0\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\nconst int mod = 317847191;\npriority_queue<int>p,dp;\npriority_queue<int,vector<int>,greater<int> >q,dq;\nint n,m,s=1;\nil int gmx(){\n    while(!dp.empty()&&p.top()==dp.top())p.pop(),dp.pop();\n    return p.top();\n}\nil int gmi(){\n    while(!dq.empty()&&q.top()==dq.top())q.pop(),dq.pop();\n    return q.top();\n}\nil int pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=(ans*x)%mod;\n        p>>=1;x=(x*x)%mod;\n    }\n    return ans;\n}\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    int x;char ch;\n    Fur(i,1,n)in>>x,p.push(x),q.push(x),s=(s*x)%mod;\n    while(m--){\n        in>>ch;\n        if(ch=='D'){\n            in>>x;\n            dp.push(x);dq.push(x);\n            s=(s*pw(x,mod-2)%mod+mod)%mod;\n        }\n        if(ch=='B')\n            out<<gmx()<<ln;\n        if(ch=='S')\n            out<<gmi()<<ln;\n        if(ch=='M')\n            out<<pw(gmx(),gmi())<<ln;\n        if(ch=='T')\n            out<<s<<ln;\n    }\n}\n```\n", "link": "/posts/LG 2174 \u5c0fZ\u7684\u795e\u5947\u6570\u5217/", "tags": ["\u79bb\u7ebf", "\u5806"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1330 \u5c01\u9501\u9633\u5149\u5927\u5b66", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1330&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1330\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint n,m,ans=0,cnt=0,head[N],s[2],C[N];\nstruct edge{\n\tint to,nxt;\n}e[N];\nvoid add(int x,int y){\n\te[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nbool u[N];\nbool dfs(int x,int c){\n\tif(u[x])return (C[x]==c);\n\tu[x]=1;\n\ts[C[x]=c]++;\n\tfl(i,x)if(!dfs(to,c^1))return 0;\n\treturn 1;\n}\nint main(){\n\tin>>n>>m;\n\tint x,y;\n\tFur(i,1,m)\n\t\tin>>x>>y,\n\t\tadd(x,y),add(y,x);\n\t\n\tFur(i,1,n)\n\tif(!u[i]){\n\t\ts[0]=s[1]=0;\n\t\tif(!dfs(i,0))return out<<\"Impossible\\n\",0;\n\t\tans+=MIN(s[1],s[0]);\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 1330 \u5c01\u9501\u9633\u5149\u5927\u5b66/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2327 [SCOI2005]\u626b\u96f7", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2327&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2327\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u539f\u672c\u6253\u7b97\u5199dp\u7684,\u4f46\u662f~~\u4ed4\u7ec6\u89c2\u5bdf\u4e00\u4e0b~~,\u53ea\u8981\u7b2c\u4e00\u4e2a\u70b9\u786e\u5b9a\u4e86,\u540e\u9762\u7684\u70b9\u4e5f\u786e\u5b9a\u4e86\n\n\u7b54\u6848\u53ea\u6709\u53ef\u80fd\u662f$0,1,2$\u4e2d\u7684\u4e00\u79cd\n\n~~(\u53ef\u80fd\u662f\u6211\u626b\u96f7\u73a9\u592a\u5c11\u4e86)~~\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint n,a[N],ans=0;\nint b[N];\nbool chk(){\n    Fur(i,2,n+1){\n        b[i]=a[i-1]-b[i-1]-b[i-2];\n        if(b[i]!=1&&b[i]!=0)return 0;\n        if(i==n+1&&b[i]!=0)return 0;\n    }\n    return 1;\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    b[0]=0;\n    Fur(i,1,n)in>>a[i];\n    b[1]=1;\n    ans+=chk();\n    b[1]=0;\n    ans+=chk();\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 2327 [SCOI2005]\u626b\u96f7/", "tags": ["\u601d\u7ef4", "\u9012\u63a8"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1984 \u5f02\u6216\u7ea6\u6570\u548c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$i$\u5bf9\u7b54\u6848\u4f1a\u7edf\u8ba1$\\left \\lfloor \\frac ni \\right \\rfloor$\u6b21,\u4f46\u53ea\u6709\u51fa\u73b0\u5947\u6570\u6b21\u624d\u4f1a\u4ea7\u751f\u8d21\u732e\n\n\n\n\u6bcf\u6b21\u7684\u8d21\u732e\u662f$i \\bigoplus i+1 \\bigoplus ... \\bigoplus j$,\u90a3\u4e48\u53ef\u4ee5\u7528[\u6570\u5217\u4e4b\u5f02\u6216](https://www.luogu.org/problem/P3908)\u8fd9\u9053\u9898\u7684\u601d\u8def\u505a\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\n#define N 10001\nll n,ans=0;\nll get(ll x){\n\tint t=x%4;\n\tif(!t)return x;\n\tif(t==1)return 1;\n\tif(t==2)return x+1;\n\treturn 0;\n}\nint main(){\n\tcin>>n;\n\tfor(ll i=1,j;i<=n;i=j+1){\n\t\tj=n/(n/i);\n\t\tif((n/i)&1)ans^=get(j)^get(i-1);\n\t}\n\tcout<<ans<<endl;\n}\n\n```\n", "link": "/posts/51nod 1984 \u5f02\u6216\u7ea6\u6570\u548c/", "tags": ["\u6570\u8bba\u5206\u5757", "\u5f02\u6216"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3127 [USACO15OPEN]\u88ab\u56f0\u5728haybales\uff08\u91d1\uff09Trappe\u2026", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3127&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3127\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u9898\u76ee\u610f\u601d\u5c31\u662f\u6709$n$\u4e2a\u5e72\u8349\u5305,\u5c06\u4e00\u6761\u8def\u5206\u6210\u4e86$n-1$\u6bb5\u533a\u95f4,\u628a\u8d77\u70b9\u8bbe\u5728\u8fd9$n-1$\u6bb5\u7684\u6bcf\u4e00\u6bb5\u4e2d,\u5224\u65ad\u4ece\u90a3\u91cc\u5f00\u59cb\u662f\u5426\u80fd\u591f\u9003\u8131,\u8f93\u51fa\u6240\u6709\u4e0d\u80fd\u9003\u8131\u7684\u533a\u95f4\u957f\u5ea6\u4e4b\u548c\u3002\n\n\u8bb0\u5f55\u6bcf\u4e2a\u533a\u95f4\u80fd\u4e0d\u80fd\u51b2\u51fa\u53bb\n\n\u4e00\u4e2a\u533a\u95f4\u53ea\u8981\u4e2d\u95f4\u6709\u4e00\u4e2a\u70b9\u53ef\u4ee5\u51b2\u51fa\u53bb\u5c31\u6bcf\u4e2a\u70b9\u90fd\u53ef\u4ee5\u51b2\u51fa\u53bb\n\n\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u4e00\u76f4\u5411\u5de6\u8fb9\u548c\u53f3\u8fb9\u51b2,\u4e00\u76f4\u5230\u6ca1\u6cd5\u7ee7\u7eed\u51b2\u4f4d\u7f6e,\u53ea\u8981\u51b2\u5230\u4e00\u4e2a\u53ef\u4ee5\u51b2\u51fa\u53bb\u7684\u533a\u95f4,\u5c31\u53ef\u4ee5\u51b2\u51fa\u53bb\n\n~~\u51b2\u51b2\u51b2~~\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n;\nbool b[N];\nstruct node{\n    int v,p;\n}a[N];\nbool cmp(node x,node y){return x.p<y.p;}\nbool chk(int p){\n    int s=a[p+1].p-a[p].p,l=p,r=p+1;\n    while(1<=l&&r<=n){\n        bool ff=0;\n        if(s>a[l].v){\n            ff=1;--l;\n            if(b[l])return b[p]=1,1;\n            s+=a[l+1].p-a[l].p;\n        }\n        if(s>a[r].v){\n            ff=1;++r;\n            if(b[r])return b[p]=1,1;\n            s+=a[r].p-a[r-1].p;\n        }\n        if(!ff)return 0;\n    }\n    return 1;\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    Fur(i,1,n)in>>a[i].v>>a[i].p;\n    sort(a+1,a+n+1,cmp);\n    b[0]=b[n]=1;\n    int ans=0;\n    Fur(i,1,n)\n        if(!chk(i))ans+=a[i+1].p-a[i].p;\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 3127 [USACO15OPEN]\u88ab\u56f0\u5728haybales\uff08\u91d1\uff09Trappe\u2026/", "tags": ["\u6a21\u62df"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF208E Blood Cousins", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF208E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF208E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u500d\u589e\u627e$k$\u7ea7\u7956\u5148+~~dsu on tree~~\u9759\u6001\u94fe\u5206\u6cbb\n\n\u8bbe\u5f53\u524d\u8282\u70b9\u4e3a$x$\n\n\u5982\u679c$d_x < k$,\u90a3\u4e48\u7b54\u6848\u5f53\u7136\u4e3a$0$\n\u53ef\u4ee5\u627e\u5230\u7b2c$k$\u7ea7\u7956\u5148,\u7136\u540e\u5728$k$\u7ea7\u7956\u5148\u4e0a\u6dfb\u52a0\u4e00\u7ec4\u8be2\u95ee(\u6c42\u5b83\u5b50\u6811\u4e2d\u6df1\u5ea6\u4e3a$d_x$\u7684\u8282\u70b9\u6570)\n\n\u56e0\u4e3a\u8fd9\u4e2a\u8fd8\u7b97\u4e0a\u4e86$x$\u672c\u8eab,\u6240\u4ee5\u628a\u7ed3\u679c-1\u5c31\u662f\u7b54\u6848\u4e86\n\n\u7edf\u8ba1\u533a\u95f4\u4e2d\u5404\u4e2a\u6df1\u5ea6\u7684\u70b9\u6709\u591a\u5c11\u4e2a\u5c31\u76f4\u63a5$tot[d_x]+=(1\\text{\u6216}-1)$\u5c31\u53ef\u4ee5\u4e86\n\n\n\u4e0a\u4ee3\u7801\uff1a\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il inline\n#define rg register\n#define Fur(i,x,y) for(register int i=x;i<=y;++i)\n#define fl(i,x) for(register int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define fin(s) freopen(s\".in\",\"r\",stdin)\n#define l2(n) ((int)(log2(n)))\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,m,cnt=0,head[N],CNT=0,HEAD[N],tt=0,RT[N];\nstruct edge{\n    int to,nxt;\n}e[N],E[N];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nil void pb(int x,int y){\n    E[++CNT].to=y;E[CNT].nxt=HEAD[x];HEAD[x]=CNT;\n}\nint f[17][N],d[N],siz[N],son[N],T[N],L[N],R[N],dfn=0;\nil void dfs(int x){\n    siz[x]=1;T[L[x]=++dfn]=x;\n    fl(i,x){\n        f[0][to]=x;d[to]=d[x]+1;\n        dfs(to);siz[x]+=siz[to];\n        if(siz[to]>siz[son[x]])son[x]=to;\n    }\n    R[x]=dfn;\n}\nil void st(){\n    int k=l2(n);\n    Fur(j,1,k)\n        Fur(i,1,n)\n        if(~f[j-1][i])f[j][i]=f[j-1][f[j-1][i]];\n}\nil int get(int x,int k){\n    int t=0;\n    while(k){\n        if(k&1){\n            x=f[t][x];\n            if(!(~x))return -1;\n        }\n        k>>=1;++t;\n    }\n    return x;\n}\nstruct que{int d,id;}q[N];\nint ANS[N];\nint tot[N];\nil void Add(int x,int v){\n    tot[d[x]]+=v;\n}\nil void upd(int x,int v){\n    Fur(i,L[x],R[x])Add(T[i],v);\n}\nil void sol(int x){\n    fl(i,x)if(to!=son[x]){\n        sol(to);\n        upd(to,-1);\n    }\n    if(son[x])sol(son[x]);\n    Add(x,1);\n    fl(i,x)if(to!=son[x])upd(to,1);\n    for(register int i=HEAD[x],to;to=E[i].to,i;i=E[i].nxt)ANS[q[to].id]=tot[q[to].d]-1;\n}\nint main(){\n    in>>n;\n    register int x,k;\n    Fur(i,1,n){\n        in>>x;\n        if(!x)RT[++RT[0]]=i;\n        else add(x,i);\n    }\n    clr(f,-1);\n    Fur(i,1,RT[0])dfs(RT[i]);\n    st();\n    in>>m;\n    Fur(i,1,m){\n        in>>x>>k;\n        if(d[x]>=k)q[++tt]=que{d[x],i},pb(get(x,k),tt);\n        else ANS[i]=0;\n    }\n    Fur(i,1,RT[0])sol(RT[i]),upd(RT[i],-1);\n    Fur(i,1,m)out<<ANS[i]<<\" \";\n}\n```\n", "link": "/posts/LG CF208E Blood Cousins/", "tags": ["\u9759\u6001\u94fe\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1385 \u5bc6\u4ee4", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1385&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1385\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 111\n#define mod 1000000007\nchar s[N];\nll f[N][3010];\nint main(){\nFur(i,0,25)f[1][i]=1;\nFur(j,2,100)\n\tFur(k,0,3000)\n\t\tFur(i,0,25)\n\t\tif(k>=i)\n\t\t\tf[j][k]+=f[j-1][k-i],\n\t\t\tf[j][k]%=mod;\n\nint T;in>>T;\nwhile(T--){\n\tin>>s;\n\tint tot=0,len=strlen(s);\n\tFur(i,0,len-1)tot+=s[i]-'a';\n\tout<<f[len][tot]-1<<ln;\n}\n}\n```\n", "link": "/posts/LG 1385 \u5bc6\u4ee4/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1059E Split-the-Tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1059E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1059E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6709\u8da3\u7684\u9898\n\n\u5148\u500d\u589e\u5904\u7406\u51fa$len_x$\u4e00\u4e2a\u70b9\u6700\u957f\u5f80\u4e0a\u8df3\u591a\u5c11\u4e2a\n\n\u7136\u540e\u52a8\u6001\u89c4\u5212\n\n\u8bbe$dp_x$\u4e3a\u5728\u653e\u7f6e\u6700\u5c11\u7684\u60c5\u51b5\u4e0b$x$\u8fd8\u80fd\u518d\u5411\u4e0a\u8df3\u591a\u5c11\u4e2a\n\n\u90a3\u4e48$dp_x = \\max(f[to])-1$\n\n\u5982\u679c$dp_x = -1$,\u90a3\u4e48\u5728\u9009\u4e2d$++ans_x,dp_x = len_x-1$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100111\n#define int ll\nint n,L,S,cnt=0,head[N],w[N],f[N],d[N],D[N],up[N][22],len[N];\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x){\n    D[x]=D[f[x]]+w[x];\n    d[x]=d[f[x]]+1;\n    up[x][0]=f[x];\n    int k=l2(d[x]);\n    Fur(i,1,k)\n        up[x][i]=up[up[x][i-1]][i-1];\n    \n    fl(i,x)dfs(to);\n}\nint ans[N],dp[N];\nvoid sol(int x){\n    dp[x]=-1;ans[x]=0;\n    fl(i,x){\n        sol(to);\n        ans[x]+=ans[to];\n        dp[x]=MAX(dp[x],dp[to]-1);\n    }\n    if(dp[x]==-1)dp[x]=len[x]-1,++ans[x];\n}\nsigned main(){\n    in(n,L,S);\n    if(!L)return puts(\"-1\"),0;\n    Fur(i,1,n){\n        in(w[i]);\n        if(w[i]>S)return puts(\"-1\"),0;\n    }\n    Fur(i,2,n)in(f[i]),add(f[i],i);\n    dfs(1);\n    Fur(i,1,n){\n        int x=i;\n        Fdr(j,20,0)\n        if(up[x][j]&&D[i]-D[f[up[x][j]]]<=S&&d[i]-d[f[up[x][j]]]<=L)\n            x=up[x][j];\n        len[i]=d[i]-d[x]+1;\n    }\n    sol(1);\n    cout<<ans[1]<<endl;\n}\n```\n", "link": "/posts/LG CF1059E Split-the-Tree/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u500d\u589e"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP2059 CERC07S", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP2059&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP2059\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nRobotic-Sort\ntop: 0\n\n\u540c\u6392\u5e8f\u673a\u68b0\u81c2\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\n#define ls c[rt][0]\n#define rs c[rt][1]\nint sz[N],val[N],rnd[N],rev[N],c[N][2],RT,cnt,n,s[N];\nvoid pu(int rt){\n    sz[rt]=sz[ls]+sz[rs]+1;\n    s[rt]=MIN(val[rt],MIN(s[ls],s[rs]));\n}\nvoid pd(int rt){\n    if(rev[rt]){\n        SWAP(ls,rs);\n        rev[ls]^=1;rev[rs]^=1;\n        rev[rt]=0;\n    }\n}\nint ne(int v){val[++cnt]=v;s[cnt]=v;sz[cnt]=1;rnd[cnt]=rand();return cnt;}\nvoid sl(int rt,int k,int &x,int &y){\n    if(!rt){x=y=0;return;}\n    pd(rt);\n    if(sz[ls]>=k)y=rt,sl(ls,k,x,ls);\n    else x=rt,sl(rs,k-sz[ls]-1,rs,y);\n    pu(rt);\n}\nint mg(int x,int y){\n    if(!x||!y)return x+y;\n    pd(x);pd(y);\n    if(rnd[x]<rnd[y]){\n        c[x][1]=mg(c[x][1],y);\n        pu(x);\n        return x;\n    }\n    else{\n        c[y][0]=mg(x,c[y][0]);\n        pu(y);\n        return y;\n    }\n}\nint get(int rt){\n    pd(rt);\n    if(s[ls]==s[rt])return get(ls);\n    if(val[rt]==s[rt])return sz[ls]+1;\n    return sz[ls]+1+get(rs);\n}\nstruct node{\n    int v,p;\n    bool operator<(node t){if(v!=t.v)return v<t.v;return p<t.p;}\n}a[N];\nint b[N];\nvoid work(){\n    clr(s,0);clr(c,0);clr(val,0);clr(rev,0);RT=0;clr(rnd,0);clr(sz,0);\n    in(n);\n    if(!n)flush(),exit(0);\n    Fur(i,1,n)in(a[i].v),a[i].p=i;\n    sort(a+1,a+n+1);\n    Fur(i,1,n)b[a[i].p]=i;\n    int x,y,z,t;\n    s[0]=inf;sz[0]=0;\n    Fur(i,1,n)RT=mg(RT,ne(b[i]));\n    Fur(i,1,n){\n        sl(RT,i-1,x,y);\n        int p=get(y);\n        out(p+i-1,\" \");\n        sl(y,p,y,z);\n        rev[y]^=1;\n        RT=mg(x,mg(y,z));\n    }\n    out(ln);\n}\nint main(){\n    while(1)work();\n}\n```\n", "link": "/posts/LG SP2059 CERC07S/", "tags": ["\u5e73\u8861\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "POJ 1430 Binary-Stirling-Numbers", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570\n\n\u5c06$n$\u4e2a\u4e0d\u540c\u7684\u7403\u653e\u8fdb$m$\u4e2a\u76f8\u540c\u7684\u76d2\u5b50,\u4fdd\u8bc1\u76d2\u5b50\u975e\u7a7a,\u6c42\u65b9\u6848\u6570\u3002\n\n### \u5bb9\u65a5\u6cd5\uff1a\n\n$S(n,m)=\\frac 1{m!}\\sum_{i=0}^m {m\\choose i}(m-i)^n(-1)^i$\n\n\u679a\u4e3e\u7a7a\u76d2\u4e2a\u6570,\u5269\u4e0b\u968f\u4fbf\u653e,\u5230\u8fd9\u91cc\u5f00\u59cb\u4e5f\u6709\u4e86\u4e8c\u9879\u5f0f\u53cd\u6f14\u7684\u5f62\u5f0f\n\n\u7531\u4e8e\u76d2\u5b50\u76f8\u540c,\u6240\u4ee5\u9664\u4ee5$m!$\n\n### \u9012\u63a8\u6cd5\uff1a\n\n$S(n,m)=S(n-1,m-1)+mS(n-1,m)$\n\n\u76f8\u5f53\u4e8e\u8003\u8651\u73b0\u5728\u8981\u653e\u7684\u6c42\u662f\u5426\u5355\u72ec\u5728\u4e00\u4e2a\u76d2\u5b50\u91cc\uff1a\n\n1. \u4e0d\u5360\u4e00\u76d2\uff1a\n   \n   \u5176\u4f59$n-1$\u4e2a\u7403\u653e\u5230$m-1$\u4e2a\u76d2\u5b50\u91cc\n\n2. \u653e\u5230\u67d0\u4e2a\u6709\u7403\u7684\u76d2\u5b50\u91cc\uff1a\n   \n   \u6709$m$\u4e2a\u76d2\u5b50\u53ef\u653e($m$\u79cd\u53ef\u80fd),\u5176\u4f59$n-1$\u4e2a\u7403\u653e\u5230$m$\u4e2a\u76d2\u5b50\u91cc\n\n\u6b64\u9898\u8981\u6c42\u7684\u662f$S(n,m) \\mod 2$\n\n\u5f53$m$\u4e3a\u5076\u6570,$S(n,m) \\equiv S(n-1,m-1)$\n\n\u5f53$m$\u4e3a\u5947\u6570,$S(n,m) \\equiv S(n-1,m-1)+s(n-1,m)$\n\n\u8fd9\u6837\u7684\u8bdd,\u76f8\u5f53\u4e8e\uff1a\n\n\u5f53$(x,y)$\u4e2d$y$\u4e3a\u5947\u6570\u65f6,\u53ef\u4ee5\u8d70\u5230$(x+1,y+1)(a$\u53d8\u6362\n\n\u5426\u5219\u53ef\u4ee5\u8d70\u5230$(x+1,y+1)(a$\u53d8\u6362,\u6216$(x+1,y)(b$\u53d8\u6362\n\n\u6c42\u4ece$(0,0)$\u8d70\u5230$(n,m)$\u7684\u65b9\u6848\u6570$\\mod 2$\n\n\u8fd9\u4e2a\u8fc7\u7a0b\u5fc5\u7136\u8d70\u4e86$m$\u6b21$a$\u53d8\u6362,\u8d70\u4e86$n-m$\u6b21$b$\u53d8\u6362\n\n\u800c$b$\u53d8\u6362\u53ea\u80fd\u5728\u5076\u6570\u4f4d\u7f6e\u51fa\u73b0,\u90a3\u4e48\u53d8\u6362\u7684\u5e8f\u5217\u5fc5\u7136\u662f\u5982\u4e0b\u5f62\u5f0f\uff1a\n\n$a,b\\times ?,a,a,b\\times ?,a,a,...,a$\n\n\u4e5f\u5c31\u662f\u5728$\\frac {m+1}2$\u4e2a\u95f4\u9694\u4e2d\u63d2\u5165$n-m$\u4e2a$b$,\u5373\u9694\u677f\u6cd5\n\n\u65b9\u6848\u6570:$C(n-m+\\frac{m+1}2-1,\\frac{m+1}2 -1) \\mod 2$\n\n\u8fd8\u6709\u4e00\u4e2a\u7ed3\u8bba\uff1a\u4ec5\u5f53$n\\&m==m$\u65f6,$C(n,m) \\equiv 1 \\bmod 2$\n<!-- more -->\n\n```cpp\n#include<cstdio>\nbool C(int n,int m){\n    return (n&m)==m;\n}\nint main(){\n    int T;scanf(\"%d\",&T);\n    while(T--){\n        int n,m;\n        scanf(\"%d%d\",&n,&m);\n        if(!n&&!m)puts(\"1\");\n        else if(!n||!m||n<0)puts(\"0\");\n        else{\n            int b=n-m,a=(m+1)>>1;\n            puts(C(b+a-1,a-1)?\"1\":\"0\");\n        }\n    }\n}\n```\n", "link": "/posts/POJ 1430 Binary-Stirling-Numbers/", "tags": ["\u5bb9\u65a5", "\u9012\u63a8", "\u7b2c\u4e8c\u7c7b\u65af\u7279\u6797\u6570"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2257 YY\u7684GCD", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2257&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2257\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10000000\nint mu[N+11],pri[N+11],tot=0,s[N+11];\nbool f[N+11];\nvoid sieve(){\n\tf[1]=mu[1]=1;\n\tFur(i,2,N){\n\t\tif(!f[i])pri[++tot]=i,mu[i]=-1;\n\t\tFur(j,1,tot){\n\t\t\tif(pri[j]*i>N)break;\n\t\t\tf[pri[j]*i]=1;\n\t\t\tif(i%pri[j])mu[i*pri[j]]=-mu[i];\n\t\t\telse break;\n\t\t}\n\t}\n\tFur(i,1,tot)\n\t\tfor(int j=1;pri[i]*j<=N;j++)\n\t\ts[j*pri[i]]+=mu[j];\n\tFur(i,1,N)s[i]+=s[i-1];\n}\nll solve(int a,int b){\n\tll ans=0;\n\tfor(int l=1,r=0;l<=a;l=r+1){\n\t\tr=MIN(a/(a/l),b/(b/l));\n\t\tans+=1ll*(s[r]-s[l-1])*(a/l)*(b/l);\n\t}\n\treturn ans;\n}\nint main(){\n\tfin(\"in\");\n\tint n,m,t;\n\tsieve();\n\tin>>t;\n\twhile(t--){\n\t\tin>>n>>m;\n\t\tif(n>m)SWAP(n,m);\n\t\tout<<solve(n,m)<<ln;\n\t}\n}\n\n```\n", "link": "/posts/LG 2257 YY\u7684GCD/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1197C Array-Splitting", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1197C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1197C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u56e0\u4e3a$a$\u662f\u5355\u8c03\u9012\u589e\u7684\n\n\u6240\u4ee5\u6bcf\u4e2a\u6bb5\u7684\u503c\u5c31\u662f$a_n-a_1$\n\n\u6211\u4eec\u53ef\u4ee5\u5206\u6210$k$\u4e2a\u6bb5,\u76f8\u5f53\u4e8e\u9009$k-1$\u7684\u5207\u70b9\n\n\u6bd4\u5982\u6211\u4eec\u5c06$[1,n]$\u5206\u6210$[1,x],[x+1,n]$\n\n\u539f\u6765\u7684\u503c\u662f$a_n-a_1$\n\n\u73b0\u5728\u53d8\u6210\u4e86$a_n-a_{x+1}+a_x-a_1$\n\n\u76f8\u5f53\u4e8e\u51cf\u53bb\u4e86$a_{x+1}-a_x$\n\n\u5bf9\u6240\u6709$a_{x+1}-a_x$\u6392\u4e2a\u5e8f\u7136\u540e\u8d2a\u5fc3\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 300011\nint n,k,a[N],b[N];\npriority_queue<int>q;\nint main(){\n    in(n,k);\n    Fur(i,1,n)in(a[i]);\n    Fur(i,2,n)q.push(a[i]-a[i-1]);\n    int ans=a[n]-a[1];\n    while(--k)ans-=q.top(),q.pop();\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG CF1197C Array-Splitting/", "tags": ["\u8d2a\u5fc3"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1277 \u5b57\u7b26\u4e32\u4e2d\u7684\u6700\u5927\u503c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6ca1\u60f3\u5230kmp\u4e5f\u53ef\u4ee5\u8fd9\u4e48\u79d2\n\n\u4ecen\u52301\u60f3\u4e00\u4e0b\n\n\u7b97\u51fanext\u6570\u7ec4\u4e4b\u540e\u53ef\u4ee5\u76f4\u63a5\u9012\u63a8\n<!-- more -->\n\n```cpp\n#include <iostream>\n#include <cstring>\nusing namespace std;\nconst int N = 1e5 + 10;\nchar str[N];\nint len;\nint nt[N];\nint res[N];\nvoid getNext(){\n    nt[0] = -1;\n    int i = 0, j = -1;\n    while (i <= len){\n        if (j == -1 || str[i] == str[j])\n            nt[++i] = ++j;\n        else\n            j = nt[j];\n    }\n}\n\nint main(){\n    scanf(\"%s\", str);\n    len = (int)strlen(str);\n    getNext();\n    for (int i = len; i >= 1; i--){\n        res[i]++;\n        res[nt[i]] += res[i];\n    }\n    long long ans = 0;\n    for (long long i = 1; i <= len; i++)\n        ans = max(i * res[i], ans);\n    printf(\"%lld\\n\", ans);\n}\n```\n", "link": "/posts/51nod 1277 \u5b57\u7b26\u4e32\u4e2d\u7684\u6700\u5927\u503c/", "tags": ["kmp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2964 [USACO09NOV]\u786c\u5e01\u7684\u6e38\u620fA-Coin-Game", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2964&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2964\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10001\nint main(){\n\n}\n\n```\n", "link": "/posts/LG 2964 [USACO09NOV]\u786c\u5e01\u7684\u6e38\u620fA-Coin-Game/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1188B Count-Pairs", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1188B&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1188B\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$\n(a_i+a_j)(a_i^2+a_j^2)\\equiv k \\mod p\n\\\\\\\\\n(a_i + a_j) \\times (a_i - a_j) \\times (a_i^2 + a_j^2) \\equiv k(a_i - a_j) \\mod p\n\n\\\\\\\\\n\n(a_i^2 - a_j^2) \\times (a_i^2 + a_j^2) \\equiv k(a_i - a_j) \\mod p\n\n\\\\\\\\\n\na_i^4 - a_j^4 \\equiv ka_i - ka_j \\mod p\n\n\\\\\\\\\n\na_i^4 - ka_i \\equiv a_j^4 - ka_j \\mod p\n\n$$\n\n\u90a3\u4e48\u53ea\u8981\u628a$(a_i^4 - ka_i) \\mod p$\u653e\u5230\u6876\u91cc\u5c31\u53ef\u4ee5\u77e5\u9053\u6709\u591a\u5c11\u4e2a\u6570\u7b26\u5408\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint n,k,p;\nmap<int,int>t;\nint main(){\n\tin>>n>>p>>k;\n\tll x,ans=0;\n\tFur(i,1,n){\n\t\tin>>x;\n\t\tx=(1ll*x*x%p*x%p*x%p-(1ll*k*x%p)+p)%p;\n\t\tif(t.count(x))ans+=t[x];\n\t\tt[x]++;\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG CF1188B Count-Pairs/", "tags": ["\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2182 \u7ffb\u786c\u5e01", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2182&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2182\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f[i][j]$\u8868\u793a\u7ffb\u8f6c$i$\u6b21,\u8fd8\u6709$j$\u4e2a\u4e0e\u76ee\u6807\u72b6\u6001\u4e0d\u540c\u4f4d\u7f6e\u7684\u65b9\u6848\u6570\n\n\u6bcf\u6b21\u7ffb\u8f6c\u53ef\u4ee5\u4f7f\u4e0e\u76ee\u6807\u72b6\u6001\u4e0d\u540c\u4f4d\u7f6e\u6570\u91cf\u6539\u53d8\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 111\n#define mod 1000000007\nint n,m,k;\nll f[N][N],C[N][N];\nchar a[N],b[N];\nint main(){\n    in>>n>>k>>m>>(a+1)>>(b+1);\n    int tot=0;\n    Fur(i,1,n)tot+=(a[i]!=b[i]);\n    Fur(i,0,MAX(n,m))C[i][0]=C[i][i]=1;\n    Fur(i,1,n)\n        Fur(j,1,m)\n        C[i][j]=(C[i-1][j]+C[i-1][j-1])%mod;\n    \n    f[0][tot]=1;\n    Fur(i,1,k)\n        Fur(j,0,n)\n            Fur(t,0,MIN(j,m))\n            if(j-t*2+m>=0&&j-t*2+m<=n)\n                f[i][j-t*2+m]=(f[i][j-t*2+m]+(f[i-1][j]*C[n-j][m-t]%mod*C[j][t]%mod))%mod;\n\n    out<<f[k][0]<<ln;\n}\n\n```\n", "link": "/posts/LG 2182 \u7ffb\u786c\u5e01/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3145 [USACO16OPEN]\u5206\u5272\u7530\u5730Splitting-the-Field", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3145&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3145\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ea\u7528\u4e00\u4e2a\u77e9\u5f62\u7684\u5f53\u7136\u5f88\u5bb9\u6613\u6c42\n\n\u7528\u4e24\u4e2a\u77e9\u5f62\u7684\u8bdd\uff1a\n\n\u5148\u628a\u6240\u6709\u70b9\u6309$x$\u5750\u6807\u6392\u5e8f,\u63d0\u524d\u8bb0\u5f55\u4ece\u524d\u6570\u548c\u4ece\u540e\u9762\u6570\u7684\u6700\u5927\u7684\u5750\u6807\u548c\u6700\u5c0f\u7684\u5750\u6807($x,y$\u90fd\u8981)\n\n\u679a\u4e3e\u65ad\u5f00\u7684\u4f4d\u7f6e,\u8bb0\u5f55\u6700\u5c0f\u503c\n\n\u8ba1\u7b97\u6309$y$\u8f74\u65b9\u5411\u65ad\u5f00\u7684\u65b9\u5f0f\u4e00\u6837,\u628a$x,y$\u4ea4\u6362\u540e\u5982\u6cd5\u70ae\u5236\u5c31\u53ef\u4ee5\u4e86\n\ntip:\n\n\u8bb0\u5f55\u5750\u6807\u6700\u5c0f\u503c\u65f6\u8981\u628a\u5750\u6807\u521d\u59cb\u5316\u4e3a$- \\infty$,\u8981\u5f00$long\\ long$,\u8981\u4e0d\u7136\u4f1a\u51fa\u9505\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    // #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define int ll\n#define inf (1ll<<60)\nstruct node{\n    int x,y;\n}a[N];\nil bool cmp(node x,node y){\n    return (x.x==y.x)?(x.y<y.y):(x.x<y.x);\n}\n\nint n,x=inf,X=-inf,y=inf,Y=-inf,a1;\nint xx[N],XX[N],yy[N],YY[N];\nint xxx[N],XXX[N],yyy[N],YYY[N];\nint work(){\n    sort(a+1,a+n+1,cmp);\n    xx[0]=inf,XX[0]=-inf;\n    yy[0]=inf,YY[0]=-inf;\n    Fur(i,1,n){\n        xx[i]=MIN(xx[i-1],a[i].x);\n        yy[i]=MIN(yy[i-1],a[i].y);\n        XX[i]=MAX(XX[i-1],a[i].x);\n        YY[i]=MAX(YY[i-1],a[i].y);\n    }\n    xxx[n+1]=inf,XXX[n+1]=-inf;\n    yyy[n+1]=inf,YYY[n+1]=-inf;\n    Fdr(i,n,1){\n        xxx[i]=MIN(xxx[i+1],a[i].x);\n        yyy[i]=MIN(yyy[i+1],a[i].y);\n        XXX[i]=MAX(XXX[i+1],a[i].x);\n        YYY[i]=MAX(YYY[i+1],a[i].y);\n    }\n    int a2=inf;\n    Fur(i,1,n-1)if(a[i].x!=a[i+1].x)a2=MIN(a2,(XX[i]-xx[i])*(YY[i]-yy[i])+(XXX[i+1]-xxx[i+1])*(YYY[i+1]-yyy[i+1]));\n    return a2;\n}\nsigned main(){\n    in>>n;\n    Fur(i,1,n){\n        in>>a[i].x>>a[i].y;\n        x=MIN(x,a[i].x);\n        y=MIN(y,a[i].y);\n        X=MAX(X,a[i].x);\n        Y=MAX(Y,a[i].y);\n    }\n    a1=(X-x)*(Y-y);\n    int a2=work();\n    Fur(i,1,n)SWAP(a[i].x,a[i].y);\n    a2=MIN(a2,work());\n    a1-=a2;\n    out<<a1<<ln;\n}\n\n```\n", "link": "/posts/LG 3145 [USACO16OPEN]\u5206\u5272\u7530\u5730Splitting-the-Field/", "tags": ["\u8ba1\u7b97\u51e0\u4f55", "\u679a\u4e3e", "\u6392\u5e8f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2704 [NOI2001]\u70ae\u5175\u9635\u5730", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2704&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2704\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<iostream>\nusing namespace std;\nint n,m,ans,dp[(1<<10)][(1<<10)][3],a[105],Sum[(1<<10)];\nchar x;\nint getsum(int S){\n    int tot=0;\n    while(S) {if(S&1) tot++; S>>=1;}\n    return tot;\n}\nint main(){\n    cin>>n>>m;\n    for(int i=0;i<n;i++)\n        for(int j=0;j<m;j++)\n            cin>>x,a[i]<<=1,a[i]+=(x=='H'?1:0);\n    for(int i=0;i<(1<<m);i++)\n        Sum[i]=getsum(i);\n    for(int S=0;S<(1<<m);S++)\n        if(!(S&a[0] || (S&(S<<1)) || (S&(S<<2))))\n            dp[0][S][0]=Sum[S];\n    for(int L=0;L<(1<<m);L++)\n        for(int S=0;S<(1<<m);S++)\n            if(!(L&S || L&a[0] || S&a[1] || (L&(L<<1)) || (L&(L<<2)) || (S&(S<<1)) || (S&(S<<2))))\n                dp[L][S][1]=Sum[S]+Sum[L];\n    for(int i=2;i<n;i++)\n        for(int L=0;L<(1<<m);L++)\n            if(!(L&a[i-1] || (L&(L<<1)) || (L&(L<<2))))\n            for(int S=0;S<(1<<m);S++)\n                if(!(S&a[i] || L&S || (S&(S<<1)) || (S&(S<<2))))\n                for(int FL=0;FL<(1<<m);FL++)\n                    if(!(FL&L || FL&S || FL&a[i-2] || (FL&(FL<<1)) || (FL&(FL<<2))))\n                    dp[L][S][i%3]=max(dp[L][S][i%3],dp[FL][L][(i-1)%3]+Sum[S]);\n    for(int L=0;L<(1<<m);L++)\n        for(int S=0;S<(1<<m);S++)\n            ans=max(ans,dp[L][S][(n-1)%3]);\n    cout<<ans;\n}\n```\n", "link": "/posts/LG 2704 [NOI2001]\u70ae\u5175\u9635\u5730/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "BZ 2839 \u96c6\u5408\u8ba1\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://remmina.github.io/BZPRO/JudgeOnline/2839.html&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://remmina.github.io/BZPRO/JudgeOnline/2839.html\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$g_i$\u8868\u793a\u4ea4\u96c6\u4e2a\u6570\u81f3\u5c11\u4e3a$i$\u7684\u65b9\u6848\u6570\n\n\u90a3\u4e48$g_i = {n\\choose i}(2^{2^{n-i}}-1)$\n\n> \u5148\u4ece$n$\u4e2d\u9009$i$\u4e2a,\u7136\u540e\u5176\u4ed6\u53ef\u4ee5\u968f\u4fbf\u53d6\n> \n> \u90a3\u5c31\u662f\u6709$2^{n-i}$\u4e2a\u96c6\u5408\u53ef\u4ee5\u53d6\n> \n> \u7136\u540e\u53c8\u53ef\u4ee5\u53d6\u81f3\u5c111\u4e2a\u96c6\u5408\n> \n> \u90a3\u4e48\u7b54\u6848\u5c31\u662f${n\\choose i}(2^{2^{n-i}}-1)$\n\n\u8bbe$f_i$\u8868\u793a\u6070\u597d\u4e3a$i$\u7684\n\n\u90a3\u4e48$g_k=\\sum_{i=k}^n f_i\\cdot {i\\choose k}$\n\n\u53cd\u6f14$f_k=\\sum_{i=k}^n g_i\\cdot{i\\choose k} (-1)^{i-k}$\n\n\u4e0d\u80fd\u76f4\u63a5\u5feb\u901f\u5e42,\u56e0\u4e3a\u6307\u6570\u4e0d\u80fd$\\mod p$,\u8981\u7528$2^{2^i}=(2^{2^{i-1}})^2$\u5012\u7740\u679a\u4e3e\u7b97\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1000011\nconst int mod=1000000007;\nint n,k,g[N],fac[N],inv[N];\nint C(int a,int b){\n    return 1ll*fac[a]*inv[b]%mod*inv[a-b]%mod;\n}\nint pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%mod;\n        p>>=1;x=1ll*x*x%mod;\n    }\n    return ans;\n}\nsigned main(){\n    in(n,k);\n    fac[0]=inv[0]=1;\n    Fur(i,1,n)fac[i]=1ll*fac[i-1]*i%mod;\n    inv[n]=pw(fac[n],mod-2);\n    Fdr(i,n-1,1)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n\n    Fur(i,0,n)\n        g[i]=1ll*C(n,i)*(pw(2,(pw(2,n-i))-1+mod)%mod)%mod;\n    \n    int ans=0,b=2;\n    Fdr(i,n,k){\n        int t=1ll*C(n,i)%mod*C(i,k)%mod*(b-1)%mod;\n        if((i-k)&1)ans=(ans-t+mod)%mod;\n        else ans=(ans+t)%mod;\n        b=1ll*b*b%mod;\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/BZ 2839 \u96c6\u5408\u8ba1\u6570/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5bb9\u65a5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1041E Tree-Reconstruction", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1041E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1041E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u5148\u628a\u6240\u6709\u8fb9\u7684\u65b9\u5411\u6389\u8f6c\u4e3a\u4ece\u4e0a\u5230\u4e0b\n\n\u90a3\u4e48\u6240\u6709\u4e0b\u7aef\u5fc5\u987b\u662f$n$\n\n\u6709\u4e00\u79cd\u7b80\u5355\u7c97\u66b4\u65e0\u8111\u4f46\u662f\u597d\u7528\u7684\u6784\u9020\u65b9\u6848,\u5c31\u662f\u6784\u9020\u4e00\u6761\u94fe,\u5e76\u4e14$n$\u5728\u957f\u94fe\u7684\u4e00\u7aef\n\n\u95ee\u9898\u53d8\u6210\u4e86\u7ed9\u4f60\u4e00\u4e2a\u6570\u7ec4\u7684\u524d\u7f00$\\max$\u6570\u7ec4,\u53cd\u7740\u6784\u9020\u539f\u6570\u7ec4\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,b[N],a[N];\nil void no(){puts(\"NO\");exit(0);}\nbool v[N];\nint main(){\n    in(n);\n    int x,y;\n    Fur(i,1,n-1){\n        in(x,y);\n        if(x>y)SWAP(x,y);\n        if(y!=n)no();\n        b[i]=x;\n    }\n    sort(b+1,b+n);\n    Fur(i,1,n){\n        if(b[i]!=b[i-1])a[i]=b[i],v[a[i]]=1;\n        else{\n            Fur(j,1,b[i])\n                if(!v[j]){a[i]=j;b[j]=1;goto ed;}\n            no();\n            ed:;\n        }\n    }\n    out(\"YES\\n\");\n    a[n]=n;\n    Fur(i,1,n-1)out(a[i],\" \",a[i+1],ln);\n    flush();\n}\n```\n", "link": "/posts/LG CF1041E Tree-Reconstruction/", "tags": ["\u6784\u9020"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1383 \u6574\u6570\u5206\u89e3\u4e3a2\u7684\u5e42", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nint f[N],n;\nint main(){\n\tin>>n;\n\tf[0]=1;\n\tFur(i,1,n){\n\t\tif(i&1)f[i]=f[i-1];\n\t\telse f[i]=f[i-1]+f[i>>1];\n\t}\n\tout<<f[n]<<ln;\n}\n```\n", "link": "/posts/51nod 1383 \u6574\u6570\u5206\u89e3\u4e3a2\u7684\u5e42/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1840 Color-the-Axis_NOI\u5bfc\u520a2011\u63d0\u9ad8\uff0805\uff09", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1840&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1840\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=s[ls]+s[rs]\nint n,s[N<<2],laz[N<<2];\nvoid pd(int rt,int ln,int rn){\n    if(laz[rt]){\n        laz[ls]=laz[rs]=1;\n        s[ls]=ln,s[rs]=rn;\n        laz[rt]=0;\n    }\n}\nvoid upd(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt]=r-l+1;laz[rt]=1;\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt,m-l+1,r-m);\n    if(L<=m)upd(L,R,l,m,ls);\n    if(R>m)upd(L,R,m+1,r,rs);\n    pu;\n}\nint main(){\n    int q;\n    in(n,q);\n    while(q--){\n        int l,r;\n        in(l,r);\n        upd(l,r,1,n,1);\n        out(n-s[1],ln);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 1840 Color-the-Axis_NOI\u5bfc\u520a2011\u63d0\u9ad8\uff0805\uff09/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2254 [NOI2005]\u7470\u4e3d\u534e\u5c14\u5179", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2254&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2254\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f_{t,i,j} = MAX(f_{t-1,x',y'})+1$\n\n\u590d\u6742\u5ea6:$O(Tnm)$,\u53ea\u80fd\u8fc750%\n\n\u770b\u5230$k \\le 200$\u90a3\u4e48\u6211\u4eec\u662f\u4e0d\u662f\u53ef\u4ee5\u76f4\u63a5\u7528\uff1f\n\n\u8bbe$f_{k,i,j}$\u4e3a\u5728\u533a\u95f4$k$\u4e2d\u5728\u4f4d\u7f6e$(i,j)$\u80fd\u6700\u591a\u6ed1\u884c\u591a\u8fdc\n\n$f_{k,i,j} = MAX(f_{k-1,i,j},f_{k-1,i',j'}+dis_{(i,j),(i',j'))})$\n\n\u90a3\u4e48\u590d\u6742\u5ea6\u5c31\u662f$O(kn^3)$,\u53ef\u4ee5\u7528\u5355\u8c03\u961f\u5217\u4f18\u5316\u6389\u5176\u4e2d\u4e00\u4e2a$n$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 211\nint n,m,X,Y,K,u,len,ans=0,f[N][N],q[N],p[N];\nint dx[5]={0,-1,1,0,0},dy[5]={0,0,0,-1,1};\nchar a[N][N];\nvoid work(int x,int y){\n\tint h=1,t=0;\n\tfor(int i=1;x>=1&&x<=n&&y>=1&&y<=m;i++,x+=dx[u],y+=dy[u])\n\tif(a[x][y]=='x')h=1,t=0;\n\telse{\n\t\twhile(h<=t&&q[t]+i-p[t]<f[x][y])t--;\n\t\tp[++t]=i;\n\t\tq[t]=f[x][y];\n\t\tif(p[t]-p[h]>len)h++;\n\t\t\n\t\tf[x][y]=q[h]+i-p[h];\n\t\t\n\t\tans=MAX(ans,f[x][y]);\n\t}\n}\nint main(){\n\tin>>n>>m>>X>>Y>>K;\n\tFur(i,1,n)in>>(a[i]+1);\n\tint s,t;\n\tclr(f,128);\n\tf[X][Y]=0;\n\tFur(k,1,K){\n\t\tin>>s>>t>>u;\n\t\tlen=t-s+1;\n\t\tif(u==1)Fur(i,1,m)work(n,i);\n\t\tif(u==2)Fur(i,1,m)work(1,i);\n\t\tif(u==3)Fur(i,1,n)work(i,m);\n\t\tif(u==4)Fur(i,1,n)work(i,1);\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 2254 [NOI2005]\u7470\u4e3d\u534e\u5c14\u5179/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5355\u8c03\u961f\u5217"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2428 \u503a\u52a1\u6e05\u5355", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2428&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2428\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u8bbe\u5b66\u751f1\u7684\u503a\u52a1\u4e3a$x$\n\n\u53ef\u4ee5\u6839\u636e\u8fde\u8fb9\u6765\u8ba1\u7b97\u51fa\u5176\u4ed6\u5b66\u751f\u503a\u52a1\u7684\u8868\u8fbe\u5f0f($ax+b$)\n\n\u5982\u679c\u51fa\u73b0\u77db\u76fe,\u7acb\u5373\u8f93\u51fa`impossible`\u5e76\u8f93\u51fa\n\n\u6700\u540e\u53ef\u4ee5\u6c42\u51fa$x$,\u5e76\u63a8\u51fa\u6240\u6709\u5b66\u751f\u7684\u503a\u52a1\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1011\nint n,m;\nstruct node{\n    int x,b;\n}s[N];\nstruct edge{\n    int to,nxt,w;\n}e[200011];\nint cnt=0,head[N];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[cnt].w=w;\n}\nbool v[N];\ndb xx;\nvoid dfs(int x,int f){\n    fl(i,x)if(to!=f){\n        if(v[to]){\n            if(s[to].x+s[x].x==0){\n                if(s[to].b+s[x].b!=e[i].w){\n                    printf(\"IMPOSSIBLE\\n\");\n                    exit(0);\n                }\n            }\n            else\n                xx=(db)(e[i].w-s[x].b-s[to].b)/(s[x].x+s[to].x);\n        }\n        else{\n            v[to]=1;\n            s[to].x=-s[x].x;\n            s[to].b=e[i].w-s[x].b;\n            dfs(to,x);\n        }\n    }\n}\nint main(){\n    in(n,m);\n    int x,y,w;\n    Fur(i,1,m)in(x,y,w),add(x,y,w),add(y,x,w);\n    s[1]=node{1,0};v[1]=1;\n    dfs(1,0);\n    Fur(i,1,n)\n        printf(\"%.2f\\n\",(db)s[i].x*xx+s[i].b);\n}\n```\n", "link": "/posts/LG 2428 \u503a\u52a1\u6e05\u5355/", "tags": ["dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF835F Roads-in-the-Kingdom", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF835F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF835F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 400011\nint n,cnt=0,head[N];\nstruct edge{\n\tint to,nxt,w;\n}e[N*2];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nbool b[N];\nint dfn[N],sz=0,pre[N];\nint tt[N],tot=0;\nvoid dfs(int x){\n\tdfn[x]=++sz;\n\tfl(i,x)\n\tif(to!=pre[x]){\n\t\tif(dfn[to]){\n\t\t\tif(dfn[to]<dfn[x])continue;\n\t\t\ttt[tot++]=x;b[x]=1;\n\t\t\tint y=to;\n\t\t\tfor(;y!=x;y=pre[y])b[y]=1,tt[tot++]=y;\n\t\t}\n\t\telse pre[to]=x,dfs(to);\n\t}\n}\nll f[N],d[N],sum[N],ans=0,tmp=0;\nvoid dp(int x,int fa){\n\tfl(i,x)\n\tif(to!=fa&&!b[to]){\n\t\tdp(to,x);\n\t\tf[x]=MAX(f[x],MAX(f[to],d[x]+d[to]+e[i].w));\n\t\td[x]=MAX(d[x],d[to]+e[i].w);\n\t}\n}\ntypedef pair<ll,int>pli;\nmultiset<pli,greater<pli>>T1,T2;\nint main(){\n\tin>>n;\n\tint x,y,w;\n\tFur(i,1,n)in>>x>>y>>w,add(x,y,w),add(y,x,w);\n\ttot=0;\n\tint sl=0;\n\tdfs(1);\n\ttt[tot]=tt[0];\n\tsum[sl++]=0;\n\tFur(i,0,tot-1)\n\t\tfl(j,tt[i])\n\t\t\tif(to==tt[i+1])sum[sl++]=e[j].w;\n\tFur(i,1,tot)\n\t\ttt[i+tot]=tt[i],sum[i+tot]=sum[i];\n\n\tFur(i,1,tot*2-1)sum[i]+=sum[i-1];\n\tFur(i,0,tot-1)dp(tt[i],0),tmp=MAX(tmp,MAX(f[tt[i]],d[tt[i]]));\n\n\tans=(1ll<<50);\n\tFur(i,0,tot-1)\n\t\tT1.insert(make_pair(d[tt[i]]+sum[i],i)),\n\t\tT2.insert(make_pair(d[tt[i]]-sum[i],i));\n\n\tFur(i,0,tot-1){\n\t\tll t;\n\t\tif(T1.begin()->second==T2.begin()->second){\n\t\t\tmultiset<pli,greater<pli>>::iterator ptr = T2.begin();\n\t\t\t++ptr;\n\t\t\tt=T1.begin()->first+ptr->first;\n\t\t\tptr=T1.begin();\n\t\t\t++ptr;\n\t\t\tt=MAX(t,ptr->first+T2.begin()->first);\n\t\t}\n\t\telse\n\t\t\tt=T1.begin()->first+T2.begin()->first;\n\t\t\n\t\tans=MIN(ans,t);\n\t\tT1.erase(make_pair(d[tt[i]]+sum[i],i)),\n\t\tT2.erase(make_pair(d[tt[i]]-sum[i],i));\n\n\t\tT1.insert(make_pair(d[tt[i+tot]]+sum[i+tot],i+tot)),\n\t\tT2.insert(make_pair(d[tt[i+tot]]-sum[i+tot],i+tot));\n\t}\n\tout<<MAX(ans,tmp)<<ln;\n}\n```\n", "link": "/posts/LG CF835F Roads-in-the-Kingdom/", "tags": ["\u57fa\u73af\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP51 TOUR", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP51&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP51\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nFake-tournament\ntop: 0\n\ntarjan\u5f3a\u8fde\u901a\u5206\u91cf\u7f29\u70b9\u4e00\u4e0b\n\n\u6700\u591a\u53ea\u6709\u4e00\u4e2a\u5165\u5ea6\u4e3a0\u7684\u70b9,\n\n\u5426\u5219\u5c31\u662f\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u70b9\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1011\nint n,dfn[N],bl[N],low[N],sz=0,z[N],tp=0,cnt=0,head[N],siz[N];\nbool v[N];\nstruct edge{\n    int x,to,nxt;\n}e[N*N*2];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].x=x;}\nvoid tarjan(int x){\n    dfn[x]=low[x]=++sz;\n    z[++tp]=x;\n    fl(i,x)\n    if(!dfn[to])tarjan(to),low[x]=MIN(low[x],low[to]);\n    else if(v[to])low[x]=MIN(low[x],dfn[to]);\n\n    if(low[x]==dfn[x]){\n        while(int k=z[tp--]){\n            bl[k]=x;++siz[x];v[k]=0;\n            if(k==x)break;\n        }\n    }\n}\nint deg[N];\nvoid work(){\n    clr(head,0);cnt=0;clr(low,0);clr(z,0);clr(dfn,0);\n    in(n);\n    int x,y;\n    Fur(i,1,n){\n        in(y);\n        while(y--)in(x),add(i,x);\n        deg[i]=siz[i]=0;\n    }\n    Fur(i,1,n)if(!dfn[i])tarjan(i);\n    Fur(i,1,cnt){\n        x=e[i].x,y=e[i].to;\n        if(bl[x]!=bl[y])++deg[bl[y]];\n    }\n    bool f=0;\n    int ans=0;\n    Fur(i,1,n)if(i==bl[i]&&!deg[i])ans=siz[i],f^=1;\n    if(f)out(ans,ln);\n    else out(\"0\\n\");\n}\nint main(){\n    int T;in(T);\n    while(T--)work();\n    flush();\n}\n```\n", "link": "/posts/LG SP51 TOUR/", "tags": ["tarjan"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4064 [JXOI2017]\u52a0\u6cd5", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4064&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4064\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fd9\u9898\u771f\u7684\u5f88\u5999\n\n\u53ef\u4ee5\u60f3\u5230\u4e8c\u5206\u6700\u5927\u503c\n\n\u95ee\u9898\u5c31\u8f6c\u5316\u4e3a\u5982\u4f55\u5224\u65ad\u662f\u5426\u5408\u6cd5\n\n\u4ece\u5de6\u5230\u53f3\u626b\u63cf\u533a\u95f4\u7684\u5de6\u7aef\u70b9,\u626b\u63cf\u5230\u7684\u5c31\u628a\u53f3\u7aef\u70b9\u653e\u5165\u5806\n\n\u6bcf\u4e2a\u70b9\u7684\u6743\u503c\u53ef\u4ee5\u7528~~\u7ebf\u6bb5\u6811~~\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\n\n\u626b\u63cf\u65f6\u9047\u5230\u70b9\u503c\u4e0d\u591f\u65f6,\u5c31\u4ece\u4f18\u5148\u961f\u5217\u4e2d\u627e\u5230\u6700\u5927\u7684\u53f3\u7aef\u70b9,\u533a\u95f4\u52a0\u4e00\u904d\n\n\u5f53\u4f18\u5148\u961f\u5217\u4e3a\u7a7a\u6216\u6b21\u6570\u4e0d\u8db3\u65f6\u5c31\u4e0d\u7b26\u5408\u8981\u6c42\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\nint n,q,k,V,a[N],s[N];\nstruct node{\n    int l,r;\n    il bool operator<(node x){\n        return l<x.l;\n    }\n}b[N];\nil void add(int x,int v){\n    while(x<=n)s[x]+=v,x+=(x&-x);\n}\nil int ask(int x){\n    int ans=0;\n    while(x)ans+=s[x],x-=(x&-x);\n    return ans;\n}\nint que[N];\npriority_queue<int>T;\nbool chk(int w){\n    clr(s,0);\n    int tot=0;\n    Fur(i,1,n)if(a[i]<w)que[++tot]=i;\n    while(!T.empty())T.pop();\n    int j=1,cnt=0;\n    Fur(i,1,tot){\n        while(j<=q&&b[j].l<=que[i])\n            T.push(upper_bound(que+1,que+tot+1,b[j].r)-que-1),++j;\n        while(a[que[i]]+ask(i)<w){\n            ++cnt;\n            if(cnt>k||T.empty())return 0;\n            add(i,V);add(T.top()+1,-V);\n            T.pop();\n        }\n    }\n    return 1;\n}\nvoid work(){\n    in>>n>>q>>k>>V;\n    int mi=inf;\n    Fur(i,1,n)in>>a[i],mi=MIN(mi,a[i]);\n    Fur(i,1,q)in>>b[i].l>>b[i].r;\n    sort(b+1,b+q+1);\n    int l=mi,r=mi+k*V,ans;\n    while(l<=r){\n        int mid=(l+r)>>1;\n        if(chk(mid))ans=mid,l=mid+1;\n        else r=mid-1;\n    }\n    out<<ans<<ln;\n}\nint main(){\n    fin(\"in\");\n    int tt;in>>tt;\n    while(tt--)work();\n}\n```\n", "link": "/posts/LG 4064 [JXOI2017]\u52a0\u6cd5/", "tags": ["\u4e8c\u5206", "\u5806", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF587C Duff in the Army", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF587C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF587C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u5f00\u59cb\u770b\u5230\u9898\u9762\u662f\u61f5\u903c\u7684\n\n\u7a81\u7136\u53d1\u73b0$1 \\le a \\le 10$\n\n\u76f4\u63a5\u5728\u6bcf\u4e2a\u91cd\u94fe\u9876\u7aef\u548c\u8282\u70b9\u4e0a\u653e\u4e2a$vector$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,m,q,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvector<int>c[N];\nint f[N],d[N],siz[N],top[N];\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        d[to]=d[x]+1;f[to]=x;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;\n}\nint main(){\n    in>>n>>m>>q;\n    int x,y;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    Fur(i,1,m){\n        in>>x;\n        c[x].push_back(i);\n    }\n\n    while(q--){\n\n    }\n}\n```\n", "link": "/posts/LG CF587C Duff in the Army/", "tags": ["\u6811\u94fe\u5256\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "HDU 2089 \u4e0d\u898162", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;http://acm.hdu.edu.cn/showproblem.php?pid=2089&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"http://acm.hdu.edu.cn/showproblem.php?pid=2089\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\nhttps://www.cnblogs.com/dplearning/p/4719375.html\n\n\n$f[i][0]$\uff1a\u4e0d\u5305\u542b$62$\u548c$4$,\n\n$f[i][1]$:$2$\u5f00\u5934\u5e78\u8fd0\u6570,\n\n$f[i][2]$:\u542b$4$\u6216$62$,\n\n$f[0][0]=1,f[0][1]=f[0][2]=1$.\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint f[8][3];\nint solve(int x){\n\tint num[11],n=0,ans=0,t=x;\n\twhile(x){\n\t\tnum[++n]=x%10;\n\t\tx/=10;\n\t}\n\tbool ff=0;\n\tFdr(i,n,1){\n\t\tans+=num[i]*f[i-1][2];\n\t\tif(ff)ans+=num[i]*f[i-1][0];\n\t\telse{\n\t\t\tif(num[i]>4)\n\t\t\t\tans+=f[i-1][0];\n\t\t\tif(num[i]>6)\n\t\t\t\tans+=f[i-1][1];\n\t\t\tif(num[i+1]==6&&num[i]>2)\n\t\t\t\tans+=f[i][1];\n\t\t}\n\t\tif(num[i]==4||(num[i+1]==6&&num[i]==2))\n\t\t\tff=1;\n\t}\n\treturn t-ans;\n}\nint main(){\n\tclr(f,0);\n\tf[0][0]=1;\n\tFur(i,1,7)\n\t\tf[i][0]=f[i-1][0]*9-f[i-1][1],\n\t\tf[i][1]=f[i-1][0],\n\t\tf[i][2]=f[i-1][2]*10+f[i-1][0]+f[i-1][1];\n\t\n\tint l,r;\n\twhile(1){\n\t\tin>>l>>r;\n\t\tif(!l&&!r)break;\n\t\tout<<(solve(r+1)-solve(l))<<ln;\n\t}\n}\n```\n", "link": "/posts/HDU 2089 \u4e0d\u898162/", "tags": ["\u6570\u4f4ddp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF519D A and B and Interesting Substrings", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF519D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF519D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u533a\u95f4$[i,j]$\u5982\u679c\u6ee1\u8db3\u8981\u6c42,\u5219$S_{j-1}-S_i = 0$\u4e14$ch[i] = ch[j]$\n\n\u90a3\u4e48\u5148\u8bb0\u5f55\u524d\u7f00\u548c,\u7136\u540e\u5012\u7740\u679a\u4e3e,\u7edf\u8ba1$[i+1,n]$\u6709\u591a\u5c11\u4e2a\u6ee1\u8db3\u8981\u6c42\u7684\u4f4d\u7f6e\n\n\u8bb0\u5f97\u5f00$long\\ long$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,a[26];\nll s[N];\nmap<ll,int>k[26];\nchar ch[N];\nint main(){\n    fin(\"in\");\n    Fur(i,0,25)in>>a[i];\n    in>>(ch+1);\n    n=strlen(ch+1);\n    Fur(i,1,n)s[i]=s[i-1]+a[ch[i]-'a'];\n    ll ans=0;\n    Fdr(i,n,1){\n        ans+=k[ch[i]-'a'][s[i]+a[ch[i]-'a']];\n        k[ch[i]-'a'][s[i]]++;\n    }\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG CF519D A and B and Interesting Substrings/", "tags": ["\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1421 \u6700\u5927MOD\u503c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nint ans[300000],bns[300000],ap[1000005];\nusing namespace std;\nint main() {\n    int n;\n    scanf(\"%d\",&n);\n    int i,j;\n    int maxx = 0;\n    for(i = 0; i < n; i++)\n        scanf(\"%d\",&ans[i]),\n        maxx = max(ans[i],maxx);\n    \n    sort(ans,ans+n);\n    int cn = 0;\n    bns[cn++] = ans[0];\n    int t =bns[0];\n    for(i = 1; i < n; i++)\n        if(ans[i]!=t) {\n            t = ans[i];\n            bns[cn++] = t;\n        }\n    \n    if(n == 1)\n        printf(\"0\\n\");\n    else {\n        int ask = 0;\n        for(i = cn-1; i >= 0; i--) {\n            if(bns[i]!=1) {\n                for(j = 2; bns[i]*j <= maxx+bns[i]; j++) {\n                    int l = i+1,r = cn-1;\n                    int id = -1;\n                    while(l <= r) {\n                        int mid = (l+r)/2;\n                        if(bns[mid] < bns[i]*j) {\n                            id = mid;\n                            l = mid + 1;\n                        } else r = mid-1;\n                    }\n                    if(id!=-1) \n                        ask = max(bns[id]%bns[i],ask);\n                }\n            }\n            if(ask >= bns[i])break;\n        }\n        printf(\"%d\\n\",ask);\n    }\n}\n```\n", "link": "/posts/51nod 1421 \u6700\u5927MOD\u503c/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1476 \u62ec\u53f7\u5e8f\u5217\u7684\u6700\u5c0f\u4ee3\u4ef7", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u628a\u6240\u6709$($\u66ff\u6362\u6210$)$,\u7136\u540e\u6bcf\u6b21\u9047\u5230$($cnt++,\u5426\u5219$cnt--$,\u5982\u679c$cnt<0$,\u90a3\u4e48\u4ece\u524d\u9762\u7684\u95ee\u53f7\u4e2d\u6311\u4e00\u4e2a\u4ece$)$\u6539\u6210$($\u8d39\u7528\u6700\u5c0f\u7684\u66ff\u6362\u6389\n\n\u5982\u679c\u6700\u540e\u6ca1\u6cd5\u4f7f$cnt=0$,\u90a3\u4e48\u5c31\u8f93\u51fa$-1$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 50011\nchar s[N];\nint a[N],b[N];\npriority_queue<int>q;\nint main(){\n\tin>>(s+1);\n\tint n=strlen(s+1);\n\tll ans=0;\n\tFur(i,1,n)if(s[i]=='?')in>>a[i]>>b[i],ans+=b[i];\n\tint cnt=0;\n\tFur(i,1,n){\n\t\tif(s[i]=='(')cnt++;\n\t\telse cnt--;\n\t\tif(s[i]=='?')q.push(b[i]-a[i]);\n\t\tif(cnt<0){\n\t\t\tif(q.empty())return out<<-1,0;\n\t\t\tans-=q.top();q.pop();\n\t\t\tcnt+=2;\n\t\t}\n\t}\n\tif(cnt)return out<<-1,0;\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/51nod 1476 \u62ec\u53f7\u5e8f\u5217\u7684\u6700\u5c0f\u4ee3\u4ef7/", "tags": ["\u8d2a\u5fc3", "\u5806"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2519 [HAOI2011]problem a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2519&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2519\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8003\u8651\u6392\u5e8f\u540e\u7684\u5e8f\u5217\n\n\u7b2c$i$\u4e2a\u4eba\u8bf4\u6709$a_i$\u4e2a\u4eba\u5206\u6570\u6bd4\u4ed6\u9ad8,\u6709$b_i$\u4e2a\u5206\u6570\u6bd4\u4ed6\u4f4e\n\n\u4ece\u5927\u5230\u5c0f\u6392\u5e8f\u540e\u5206\u6570\u548c$i$\u76f8\u540c\u7684\u4eba\u7684\u533a\u95f4\u4e3a$[a_i+1,n-b_i]$\n\n\u6211\u4eec\u8bbe$L_i = a_i + 1, R_i = n - b_i$\n\n\u90a3\u4e48\u5982\u679c$L_i > R_i$\u663e\u7136\u662f\u5047\u8bdd\n\n\u5982\u679c$R_i-L_i+1$\u5c0f\u4e8e\u8fd9\u4e2a\u533a\u95f4\u7684\u4eba\u6570($L_{i'}=L_i$\u4e14$R_{i'}=R_i$),\u90a3\u4e48\u8fd9\u4e5f\u662f\u5047\u8bdd\n\n\u53bb\u6389\u6240\u6709\u4e00\u5b9a\u662f\u5047\u7684\u8bdd\u540e,\u95ee\u9898\u53d8\u6210\uff1a\u7ed9\u82e5\u5e72\u4e2a\u533a\u95f4$[l_i,r_i]$,\u4ef7\u503c\u4e3a$v_i$,\u4ece\u4e2d\u9009\u51fa\u82e5\u5e72\u4e2a\u6ca1\u6709\u4ea4\u96c6\u7684\u533a\u95f4,\u4ef7\u503c\u548c\u6700\u5927\u4e3a\u591a\u5c11\uff1f\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n;\nstruct node{\n    int l,r;\n}a[N];\nint main(){\n    in>>n;\n    int x,y;\n    Fur(i,1,n){\n        in>>x>>y;\n        a[i]=node{x+1,n-y};\n    }\n    \n}\n```\n", "link": "/posts/LG 2519 [HAOI2011]problem a/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1839 Play-with-Power_NOI\u5bfc\u520a2011\u63d0\u9ad8\uff0805", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1839&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1839\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\n#define int ll\nint n;\nint p(int x,int p){\n    if(x>n)return -1;\n    int ans=1;\n    while(p){\n        if(p&1)ans*=x;\n        p>>=1;x*=x;\n        if(ans>n)return -1;\n    }\n    return ans;\n}\nint g[35][10011];\nint f(int a,int b){\n    if(b>30)return 1;\n    if(!g[b][a])g[b][a]=p(a,b);\n    if(!~g[b][a])return 2;\n    int x=f(a+1,b),y=f(a,b+1);\n    if(x==2&&y==2)return 0;\n    if(!x||!y)return 2;\n    return 1;\n}\nsigned main(){\n    in(n);\n    int T;in(T);\n    while(T--){\n        int a,b,c;\n        in(a,b);\n        if(a>sqrt(n))c=(b==1)?(n-a&1?2:0):0;\n        else c=!~p(a,b)?0:f(a,b);\n        if(c==0)out(\"Stas\\n\");\n        if(c==1)out(\"Missing\\n\");\n        if(c==2)out(\"Masha\\n\");\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 1839 Play-with-Power_NOI\u5bfc\u520a2011\u63d0\u9ad8\uff0805/", "tags": ["\u535a\u5f08\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1616 \u6700\u5c0f\u96c6\u5408", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u68c0\u9a8c\u6bcf\u4e2a\u6570\u662f\u4e0d\u662f\u5728\u8fd9\u4e2a\u96c6\u5408\uff1a\n\u96c6\u5408\u4e2d\u6240\u6709\u662f\u5b83\u7684\u500d\u6570\u7684gcd\u662f\u4e0d\u662f\u5b83\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nint n,m,x,ans=0;\nbool v[N];\nint main(){\n\tin>>n;\n\tFur(i,1,n){\n\t\tin>>x;\n\t\tif(!v[x]){\n\t\t\tv[x]=1;ans++;\n\t\t\tm=MAX(m,x);\n\t\t}\n\t}\n\tFur(i,1,m)if(!v[i]){\n\t\tx=0;\n\t\tfor(int j=i;j<=m;j+=i)\n\t\tif(v[j])x=GCD(x,j);\n\t\tif(x==i)ans++,v[i]=1;\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/51nod 1616 \u6700\u5c0f\u96c6\u5408/", "tags": ["\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3008 [USACO11JAN]\u9053\u8def\u548c\u98de\u673aRoads and Planes", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3008&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3008\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 25011\n#define FL(i,x) for(int i(HEAD[x]),to;to=E[i].to,i;i=E[i].nxt)\nint n,cnt=0,head[N],R,P,S;\nint CNT=0,HEAD[N];\nstruct edge{\n    int to,nxt,w;\n}e[100011],E[50011];\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;e[cnt].w=w;\n}\nil void ADD(int x,int y,int w){\n    E[++CNT].to=y;E[CNT].nxt=HEAD[x];HEAD[x]=CNT;E[CNT].w=w;\n}\nvector<int>T[N];\nint bl[N],tt=0,d[N],deg[N];\nvoid dfs(int x,int y){\n    bl[x]=y;T[y].push_back(x);\n    fl(i,x)if(!bl[to])dfs(to,y);\n}\nstruct cmp{il bool operator()(int x,int y){return d[x]>d[y];}};\nbool v[N];\nil void spfa(int X){\n    priority_queue<int,vector<int>,cmp>p;\n    for(auto t:T[X])\n    if(d[t]!=inf)p.push(t),v[t]=1;\n    while(!p.empty()){\n        int x=p.top();p.pop();v[x]=0;\n        fl(i,x)if(d[x]+e[i].w<d[to]){\n            d[to]=d[x]+e[i].w;\n            if(!v[to])p.push(to);\n        }\n        FL(i,x)d[to]=MIN(d[to],d[x]+E[i].w);\n    }\n}\nint main(){\n    fin(\"in\");\n    in(n,R,P,S);\n    int x,y,w;\n    Fur(i,1,R){\n        in(x,y,w);\n        add(x,y,w);add(y,x,w);\n    }\n    Fur(i,1,n)if(!bl[i])dfs(i,++tt);\n    Fur(i,1,P){\n        in(x,y,w);\n        ADD(x,y,w);++deg[bl[y]];\n    }\n    clr(d,126);\n    d[S]=0;\n    queue<int>q;\n    Fur(i,1,tt)if(!deg[i])q.push(i);\n    while(!q.empty()){\n        x=q.front();q.pop();\n        spfa(x);\n        for(auto t:T[x])\n            FL(i,t)\n            if(--deg[bl[to]]==0)\n                q.push(bl[to]);\n    }\n    Fur(i,1,n)\n        if(d[i]==inf)out(\"NO PATH\\n\");\n        else out(d[i],ln);\n    flush();\n}\n\n```\n", "link": "/posts/LG 3008 [USACO11JAN]\u9053\u8def\u548c\u98de\u673aRoads and Planes/", "tags": ["\u62d3\u6251\u6392\u5e8f", "\u6700\u77ed\u8def"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4316 \u7eff\u8c46\u86d9\u7684\u5f52\u5bbf", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4316&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4316\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100111\nstruct edge{\n\tint to,nxt,w;\n}e[N*2];\nint n,m,head[N],r[N],c[N],cnt=0;\ndb s[N];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].nxt=head[x];e[cnt].w=w;head[x]=cnt;\n}\nint q[N];\nint main(){\n\tin>>n>>m;\n\tint x,y,w,top=0;\n\tFur(i,1,m)in>>x>>y>>w,add(y,x,w),r[x]++,c[x]++;\n\tq[++top]=n;\n\twhile(top){\n\t\tx=q[top--];\n\t\tfl(i,x){\n\t\t\ts[to]+=s[x]+e[i].w;\n\t\t\tif(--r[to]==0)s[to]/=(db)c[to],q[++top]=to;\n\t\t}\n\t}\n\tprintf(\"%.2f\\n\",s[1]);\n}\n```\n", "link": "/posts/LG 4316 \u7eff\u8c46\u86d9\u7684\u5f52\u5bbf/", "tags": ["\u671f\u671b", "\u62d3\u6251"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1711 \u5e73\u5747\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e8c\u5206\u7b2c$k$\u5927\u5e73\u5747\u6570$w$,\u7edf\u8ba1\u5e73\u5747\u6570\u5927\u4e8e\u7b49\u4e8e\u5b83\u7684\u533a\u95f4\u7684\u4e2a\u6570\n\n\u8fd9\u6837\u7684\u533a\u95f4\u6ee1\u8db3$\\frac {s_r - s_{l-1}}{r-l+1} \\ge w$\n\n\u5316\u7b80\u4e00\u4e0b\uff1a\n$$\ns_r - s_{l-1} \\ge w(r-(l-1))\n\\\\\\\\\ns_r - wr \\ge s_{l-1} - w(l-1)\n$$\n\u90a3\u4e48\u6211\u4eec\u53ea\u8981\u7528\u6811\u72b6\u6570\u7ec4\u7edf\u8ba1\u4e00\u4e0b\u5c31\u53ef\u4ee5\u4e86(\u5f53\u7136\u4f60\u8981\u7528\u6743\u503c\u7ebf\u6bb5\u6811\u4e5f\u53ef\u4ee5)\n\n\u56e0\u4e3a\u5e73\u5747\u6570\u53ef\u80fd\u4e0d\u662f\u6574\u6570,\u6240\u4ee5\u6211\u4eec\u8981\u79bb\u6563\u5316\u4e00\u4e0b\u624d\u80fd\u7edf\u8ba1\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define eps 1e-6\n#define int unsigned\nint n,k,a[N],tr[N*3],b[N];\nstruct node{\n\tdb v;\n\tint id;\n}s[N];\nbool cmp(node x,node y){\n\treturn x.v<y.v;\n}\nvoid add(int x){\n\tif(x<=0)return;\n\twhile(x<=n){\n\t\ttr[x]++;\n\t\tx+=(x&-x);\n\t}\n}\nint get(int x){\n\tif(x<=0)return 0;\n\tint ans=0;\n\twhile(x){\n\t\tans+=tr[x];\n\t\tx-=(x&-x);\n\t}\n\treturn ans;\n}\nbool chk(db w){\n\tclr(tr,0);\n\ts[0].v=0;s[0].id=0;\n\tFur(i,1,n)s[i].v=(db)s[i-1].v+w*i,s[i].id=i;\n\tsort(s,s+n+1,cmp);\n\tint t=0;\n\tFur(i,0,n){\n\t\tif(s[i].v!=s[i-1].v)t++;\n\t\tb[s[i].id]=t;\n\t}\n\tint tot=0;\n\tFur(i,0,n){\n\t\ttot+=get(b[i]);\n\t\tadd(b[i]);\n\t}\n\treturn tot>=k;\n}\nsigned main(){\n\tfin(\"in\");\n\tin>>n>>k;\n\tdb l=0,r=0,m;\n\tFur(i,1,n)in>>a[i],r=MAX(r,(db)a[i]);\n\twhile(r-l>eps){\n\t\tm=(l+r)/2.0;\n\t\tif(chk(m))l=m;\n\t\telse r=m;\n\t}\n\tprintf(\"%.4f\\n\",m);\n}\n\n```\n", "link": "/posts/51nod 1711 \u5e73\u5747\u6570/", "tags": ["\u4e8c\u5206", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4302 [SCOI2003]\u5b57\u7b26\u4e32\u6298\u53e0", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4302&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4302\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u533a\u95f4dp\n\n\u663e\u7136\u8bbe$f[i][j]$\u8868\u793a$[i,j]$\u6700\u5c0f\u7684\u8868\u793a\u65b9\u6cd5\n\n\u666e\u901a\u60c5\u51b5: \n\n$f[i][j] = \\min(f[i][k]+f[k+1][j])$\n\n\u5f53\u6211\u4eec\u627e\u5230\u5faa\u73af\u8282\uff1a\n\n$f[i][j] = \\min(f[i][j],f[i][k] + 2 + \\text{<\u5faa\u73af\u8282\u4e2a\u6570>})$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 111\n#define base 1331\nint n,f[N][N];\nchar s[N];\null h[N],pw[N];\null get(int l,int r){\n    return h[r]-h[l-1]*pw[r-l+1];\n}\nbool chk(int x,int y,int a,int b){\n    int p=y-x+1,q=b-a+1;\n    Fur(i,1,q/p)\n        if(get(x,y)!=get(a+p*(i-1),a+p*i-1))return 0;\n    return 1;\n}\nint le(int x){\n    int t=0;\n    while(x)++t,x/=10;\n    return t;\n}\nint main(){\n    in>>(s+1);\n    n=strlen(s+1);\n    pw[0]=1;Fur(i,1,n)h[i]=h[i-1]*base+s[i],pw[i]=pw[i-1]*base;\n    clr(f,126);\n    Fur(i,1,n)f[i][i]=1;\n    Fur(i,2,n)\n        Fur(l,1,n-i+1){\n            int r=l+i-1;\n            f[l][r]=r-l+1;\n            Fur(x,l,r-1){\n                f[l][r]=MIN(f[l][r],f[l][x]+f[x+1][r]);\n                if((r-x)%(x-l+1)==0){\n                    if(chk(l,x,x+1,r))\n                    f[l][r]=MIN(f[l][r],f[l][x]+2+le((r-l+1)/(x-l+1)));\n                }\n            }\n        }\n    out<<f[1][n]<<ln;\n}\n```\n", "link": "/posts/LG 4302 [SCOI2003]\u5b57\u7b26\u4e32\u6298\u53e0/", "tags": ["\u533a\u95f4dp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1502 \u7a97\u53e3\u7684\u661f\u661f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1502&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1502\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 40011\n#define int ll\n#define ls rt<<1\n#define rs rt<<1|1\nint n,W,H,s[N<<2],val[N],laz[N<<2];\nstruct node{\n\tint p,x,y,v;\n}a[N];\nstruct NODE{\n    int x,id,f;\n}b[N];\nil bool cmp(node x,node y){\n\treturn (x.p==y.p)?(x.v>y.v):(x.p<y.p);\n}\nil bool cmp2(NODE x,NODE y){\n    return x.x<y.x;\n}\nvoid pd(int rt){\n\tif(laz[rt]){\n\t\tlaz[ls]+=laz[rt];laz[rs]+=laz[rt];\n\t\ts[ls]+=laz[rt];s[rs]+=laz[rt];\n\t\tlaz[rt]=0;\n\t}\n}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt]+=v;laz[rt]+=v;\n        return;\n    }\n    int m=(l+r)>>1;\n\tpd(rt);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n\ts[rt]=MAX(s[ls],s[rs]);\n}\nsigned main(){\nint T;in>>T;\nwhile(T--){\n\tint x,y,v;\n\tclr(s,0),clr(laz,0);\n\tclr(a,0);clr(b,0);clr(val,0);\n\tin>>n>>W>>H;\n\tFur(i,1,n){\n\t\tin>>x>>y>>v;\n\t\ta[i]=node{x,y,y+H-1,v};\n\t\ta[i+n]=node{x+W-1,y,y+H-1,-v};\n\t\tb[i]=NODE{y,i,0};b[i+n]=NODE{y+H-1,i,1};\n\t}\n\tsort(b+1,b+n*2+1,cmp2);\n    int d=0;\n    Fur(i,1,n*2){\n        if(b[i].x!=b[i-1].x)d++;\n        val[d]=b[i].x;\n        if(b[i].f)a[b[i].id].y=a[b[i].id+n].y=d;\n        else a[b[i].id].x=a[b[i].id+n].x=d;\n    }\n\tsort(a+1,a+n*2+1,cmp);\n    int ans=0;\n    Fur(i,1,n*2){\n        upd(a[i].x,a[i].y-1,a[i].v,1,n*2,1);\n        ans=MAX(ans,s[1]);\n    }\n    out<<ans<<ln;\n}\n}\n```\n", "link": "/posts/LG 1502 \u7a97\u53e3\u7684\u661f\u661f/", "tags": ["\u626b\u63cf\u7ebf"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1793 \u5403\u6c49\u5821", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u6bb5\u533a\u95f4\u68c0\u67e5\u540e\u80fd\u4e0d\u88ab\u5403\u6389\u7684\u6c49\u5821\u6ee1\u8db3**\u5176\u4ed6\u6c49\u5821\u7684\u80fd\u91cf\u503c\u90fd\u662f\u5b83\u7684\u500d\u6570**\u3002\n\n\u90a3\u6211\u4eec\u5c31\u6c42\u51fa\u533a\u95f4$\\gcd$. \u800c\u8fd9\u4e2a\u6c49\u5821\u7684\u80fd\u91cf\u503c\u5fc5\u987b\u7b49\u4e8e\u533a\u95f4$gcd$,\u6240\u4ee5\u5b83\u7684\u80fd\u91cf\u503c\u4e5f\u662f\u533a\u95f4\u6700\u5c0f\u503c\u3002\n\n\u90a3\u6211\u4eec\u5c31\u518d\u8bb0\u5f55\u533a\u95f4\u6700\u5c0f\u503c\u5e76\u4e14\u8bb0\u5f55\u6570\u91cf\n\n\u90a3\u4e48\u6ee1\u8db3\u8fd9\u4e2a\u590d\u6742\u5ea6\u800c\u4e14\u6700\u65b9\u4fbf\u7684\u5f53\u7136\u662f\u7ebf\u6bb5\u6811\u4e86\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100001\n#define ls rt<<1\n#define rs rt<<1|1\nint n;\nstruct node{\n\tint s,g,t;\n}s[N<<2];\nnode operator + (node x,node y){\n\tnode c;\n\tc.g=MIN(x.g,y.g);\n\tc.s=GCD(x.s,y.s);\n\tif(x.g==y.g)c.t=x.t+y.t;\n\telse c.t=(x.g<y.g)?x.t:y.t;\n\tif(c.s!=c.g)c.t=0;\n\treturn c;\n}\nvoid build(int l,int r,int rt){\n\tif(l==r){\n\t\tin>>s[rt].s;s[rt].g=s[rt].s;s[rt].t=1;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tbuild(l,m,ls);\n\tbuild(m+1,r,rs);\n\ts[rt]=s[ls]+s[rs];\n}\nnode ask(int L,int R,int l,int r,int rt){\n\tif(L<=l&&r<=R)return s[rt];\n\tint m=(l+r)>>1;\n\tnode c;\n\tif(L>m)return ask(L,R,m+1,r,rs);\n\telse if(R<=m)return ask(L,R,l,m,ls);\n\treturn ask(L,R,l,m,ls)+ask(L,R,m+1,r,rs);\n}\nint main(){\n\tfin(\"in\");\n\tin>>n;\n\tbuild(1,n,1);\n\tint q;in>>q;\n\twhile(q--){\n\t\tint x,y;\n\t\tin>>x>>y;\n\t\tout<<y-x+1-ask(x,y,1,n,1).t<<ln;\n\t}\n}\n\n```\n", "link": "/posts/51nod 1793 \u5403\u6c49\u5821/", "tags": ["\u7ebf\u6bb5\u6811", "gcd"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LOJ 149 01-\u5206\u6570\u89c4\u5212", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://loj.ac/problem/149&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://loj.ac/problem/149\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define eps 1e-6\nint n,k,a[N],b[N];\ndb t[N];\nbool cmp(db x,db y){return x>y;}\nbool chk(db w){\n\tdb ans=0;\n\tFur(i,1,n)t[i]=(db)a[i]-w*(db)b[i];\n\tsort(t+1,t+n+1,cmp);\n\tFur(i,1,k)ans+=t[i];\n\treturn (ans>=0);\n}\nint main(){\n\tin>>n>>k;\n\tFur(i,1,n)in>>a[i];\n\tFur(i,1,n)in>>b[i];\n\tdb l=0,r=1000000,m;\n\twhile(r-l>eps){\n\t\tm=(l+r)/2.0;\n\t\tif(chk(m))l=m;\n\t\telse r=m;\n\t}\n\tprintf(\"%.4f\\n\",m);\n}\n```\n", "link": "/posts/LOJ 149 01-\u5206\u6570\u89c4\u5212/", "tags": ["01\u5206\u6570\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2221 [HAOI2012]\u9ad8\u901f\u516c\u8def", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2221&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2221\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include <iostream>\n#include <cstdio>\n#define lson now << 1\n#define rson now << 1 | 1\n#define ll long long\nconst ll maxN = 100000 + 7;\n\ninline ll read() {\n    ll x = 0,f = 1;char c = getchar();\n    while(c < '0' || c > '9') {if(c == '-')f = -1;c = getchar();}\n    while(c >= '0' && c <= '9') {x = x * 10 + c - '0';c = getchar();}\n    return x * f;\n}\n\nll gcd(ll a,ll b) {\n    return !b ? a : gcd(b,a % b);\n}\n\nstruct Node {\n    ll sum[6];\n    ll lazy;\n    ll l,r;\n}tree[maxN << 2];\nll sum1,sum2,sum3;\n\nvoid updata(ll now) {\n    tree[now].sum[1] = tree[lson].sum[1] + tree[rson].sum[1];\n    tree[now].sum[2] = tree[lson].sum[2] + tree[rson].sum[2];\n    tree[now].sum[3] = tree[lson].sum[3] + tree[rson].sum[3];\n    return ;\n}\n\nvoid build(ll l,ll r,ll now) {\n    tree[now].l = l;tree[now].r = r;\n    if(l == r) {\n        tree[now].sum[4] = l * l;\n        tree[now].sum[5] = l;\n        return ;\n    }\n    ll mid = (l + r) >> 1;\n    build(l,mid,lson);\n    build(mid + 1,r,rson);\n    tree[now].sum[4] = tree[lson].sum[4] + tree[rson].sum[4];\n    tree[now].sum[5] = tree[lson].sum[5] + tree[rson].sum[5];\n    return ;\n}\n\nvoid work(ll now,ll k) {\n    tree[now].sum[1] += (tree[now].r - tree[now].l + 1) * k;\n    tree[now].sum[2] += k * tree[now].sum[5];\n    tree[now].sum[3] += k * tree[now].sum[4];\n    tree[now].lazy += k;\n}\n\nvoid pushdown(ll now) {\n    work(lson,tree[now].lazy);\n    work(rson,tree[now].lazy);\n    tree[now].lazy = 0;\n    return ;\n}\n\nvoid modify(ll l,ll r,ll now,ll val) {\n    if(tree[now].l >= l && tree[now].r <= r) {\n        work(now,val);\n        return ;\n    }\n    if(tree[now].lazy) pushdown(now);\n    ll mid = (tree[now].l + tree[now].r) >> 1;\n    if(mid >= l) modify(l,r,lson,val);\n    if(mid < r) modify(l,r,rson,val);\n    updata(now);\n    return ;\n}\n\nvoid query(ll l,ll r,ll now) {\n    if(tree[now].l >= l && tree[now].r <= r)  {\n        sum1 += tree[now].sum[1];\n        sum2 += tree[now].sum[2];\n        sum3 += tree[now].sum[3];\n        return ;\n    }\n    if(tree[now].lazy) pushdown(now);\n    ll mid = (tree[now].l + tree[now].r) >> 1;\n    if(mid >= l) query(l,r,lson);\n    if(mid < r) query(l,r,rson);\n    return ;\n}\n\nint main(){   \n    ll n,m,l,r,v;\n    char s[3];\n    n = read();m = read();\n    build(1,n,1);\n    while(m --) {\n        scanf(\"%s\",&s);\n        l = read();r = read() - 1;\n        if(s[0] == 'C') {\n            v = read();\n            modify(l,r,1,v);\n        }\n        else {\n            ll a;\n            sum1 = sum2 = sum3 = 0;\n            query(l,r,1);\n            a = (r - l + 1 - r * l) * sum1 + (r + l) * sum2 - sum3;\n            ll b = ( r - l + 2 ) * (r - l + 1) / 2;\n            ll g = gcd(a,b);\n            printf(\"%lld/%lld\\n\", a / g,b / g);\n        }\n    }\n}\n```\n", "link": "/posts/LG 2221 [HAOI2012]\u9ad8\u901f\u516c\u8def/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3411 \u5e8f\u5217\u53d8\u6362", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3411&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3411\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\nint n,c[1000005],ans[1000005],m,ansl;\nvector<int>a[1000005];\nint cun[1000005],tot;\nint main(){\n    cin>>n;\n    for(int i=1;i<=n;i++)\n        cin>>c[i],a[c[i]].push_back(i),m=max(m,c[i]);\n    for(int i=1;i<=m;i++)\n        if(a[i].size()!=0)cun[++tot]=i;\n    for(int i=1;i<=tot;i++){\n        int now=cun[i],last=cun[i-1],nxt=cun[i+1];\n        ans[i]=a[now].size();\n        if(i!=1)\n            if(a[now].front()>a[last].back())ans[i]+=ans[i-1];\n            else{\n                int aa=lower_bound(a[last].begin(),a[last].end(),a[now].front())-a[last].begin();\n                ans[i]+=aa;\n            }\n        if(i!=tot)\n            if(a[now].back()>a[nxt].front()){\n                int aa=lower_bound(a[nxt].begin(),a[nxt].end(),a[now].back())-a[nxt].begin();\n                ans[i]+=(a[nxt].size()-aa);\n            }\n        ansl=max(ansl,ans[i]);\n    }\n    cout<<n-ansl<<endl;\n}\n\n```\n", "link": "/posts/LG 3411 \u5e8f\u5217\u53d8\u6362/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4550 \u6536\u96c6\u90ae\u7968", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4550&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4550\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint n;\ndb f[N];\nint main(){\n\tin>>n;\n\tdb ans=0;\n\tFur(i,1,n)ans+=1.0*n/(n-i+1);\n\tprintf(\"%.2f\\n\",ans);\n}\n```\n", "link": "/posts/LG 4550 \u6536\u96c6\u90ae\u7968/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2396 yyy-loves-Maths-VII", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2396&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2396\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$f[0] = 0$\u3000\n\n\uff08$i$\u6307\u72b6\u6001\u538b\u7f29\u540e\u7684\u4e8c\u8fdb\u5236\u6570\uff09$f[i]=\\sum f[i'])$\u3000\n\nlowbit\u53ef\u4ee5\u5f88\u5feb\u5730\u83b7\u53d6\u4e00\u4e2a\u6570\u5728\u4e8c\u8fdb\u5236\u4e0b\u7b2c\u4e00\u4e2a1\u5728\u54ea\u3000\n\n\u4e00\u76f4lowbit\u548c\u5f02\u6216\u5c31\u53ef\u4ee5\u628a\u6240\u67091\u627e\u5230\u3000\n\n\u56e0\u4e3a\u8fd9\u9053\u9898\u5361\u5e38,\u6240\u4ee5\u53ea\u80fd\u7528lowbit\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(rg int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(rg int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 24\nint f[1<<N|1],d[1<<N|1],n,m;\nint b1,b2;\nint main(){\n\tin>>n;\n\tFur(i,0,n-1)in>>d[1<<i];\n\tin>>m;\n\tif(m>0)in>>b1;\n\tif(m>1)in>>b2;\n\tf[0]=1;\n\tint len=(1<<n)-1;\n\tFur(i,1,len){\n\t\tint j=i&(-i);\n\t\td[i]=d[i^j]+d[j];\n\t\tif(d[i]==b1||d[i]==b2)continue;\n\t\tfor(rg int x=i,k;x;x^=k)k=x&(-x),f[i]=(f[i]+f[i^k])%1000000007;\n\t}\n\tout<<f[len]<<ln;\n}\n```\n", "link": "/posts/LG 2396 yyy-loves-Maths-VII/", "tags": ["\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212", "\u4f4d\u8fd0\u7b97"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF9D How many trees", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF9D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF9D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u52a8\u6001\u89c4\u5212\n\n\u8bbe$f[n][k]$\u8868\u793a$n$\u4e2a\u8282\u70b9,\u9ad8\u5ea6\u4e3a$k$\n\n\u6839\u8282\u70b9\u662f\u56fa\u5b9a\u4e0d\u53d8\u7684\n\n\u5de6\u53f3\u5b50\u6811\u53ef\u4ee5\u81ea\u7531\u53d8\u6362\n\n\u90a3\u4e48\uff1a\n\n$f[n][k] = \\sum_{i=1}^n f[i][k-1] \\times f[n-i-1][k-1]$\n\n\u633a\u597d\u7684\u9898\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,m;\nll f[39][39];\nint main(){\n    fin(\"in\");\n    in>>n>>m;\n    Fur(i,0,n)f[0][i]=1;\n    Fur(k,1,n)\n        Fur(i,1,n)\n            Fur(j,0,i-1)\n            f[i][k]+=f[j][k-1]*f[i-j-1][k-1];\n\n    out<<f[n][n]-f[n][m-1]<<ln;\n}\n```\n", "link": "/posts/LG CF9D How many trees/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF438D The-Child-and-Sequence", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF438D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF438D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u53ef\u4ee5\u53d1\u73b0\u5982\u679c$p\\le x$,\u90a3\u4e48$x\\mod p \\le \\frac x2$\n\n\u6240\u4ee5\u53d6\u6a21\u6700\u591a$\\log x$\u6b21\n\n\u8bb0\u5f55\u533a\u95f4\u6700\u5927\u503c,\u5982\u679c\u5c0f\u4e8e$p$\u90a3\u4e48\u76f4\u63a5\u8fd4\u56de\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\n#define int ll\nint n,q,s[N<<2],mx[N<<2];\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=s[ls]+s[rs],mx[rt]=MAX(mx[ls],mx[rs])\nvoid build(int l,int r,int rt){\n    if(l==r)return (void)(in(s[rt]),mx[rt]=s[rt]);\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu;\n}\nvoid upd(int x,int v,int l,int r,int rt){\n    if(l==r){\n        s[rt]=mx[rt]=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    if(x<=m)upd(x,v,l,m,ls);\n    else upd(x,v,m+1,r,rs);\n    pu;\n}\nvoid UPD(int L,int R,int v,int l,int r,int rt){\n    if(mx[rt]<v)return;\n    if(l==r){\n        s[rt]=(mx[rt]%=v);\n        return;\n    }\n    int m=(l+r)>>1;\n    if(L<=m)UPD(L,R,v,l,m,ls);\n    if(R>m)UPD(L,R,v,m+1,r,rs);\n    pu;\n}\nint ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1,ans=0;\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans+=ask(L,R,m+1,r,rs);\n    return ans;\n}\nsigned main(){\n    in(n,q);\n    build(1,n,1);\n    while(q--){\n        int opt,l,r,v;\n        in(opt,l,r);\n        if(opt==1)out(ask(l,r,1,n,1),ln);\n        if(opt==2)in(v),UPD(l,r,v,1,n,1);\n        if(opt==3)upd(l,r,1,n,1);\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF438D The-Child-and-Sequence/", "tags": ["\u7ebf\u6bb5\u6811", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3719 [AHOI2017\u521d\u4e2d\u7ec4]rexp", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3719&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3719\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u89e3\u91ca\u89c1\u4ee3\u7801\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#define il inline\nusing namespace std;\nil int max(int x,int y){return x>y?x:y;}\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,q[N],tp=0,a[N],mx[N];\nchar s[N];\nint main(){\n    in(s+1);\n    int len=strlen(s+1);\n    for(int i=1;i<=len;++i){\n        if(s[i]=='(')a[++tp]=0,mx[tp]=0; // \u5982\u679c\u662f'('\u5219\u8fdb\u5165\u4e0b\u4e00\u5c42\n        else if(s[i]==')')--tp,a[tp]+=mx[tp+1];// \u5982\u679c\u662f')'\u8fd4\u56de\u4e0a\u4e00\u5c42,\u4e0a\u4e00\u5c42\u52a0\u4e0a\u5f53\u524d\u7b54\u6848\n        else if(s[i]=='|')a[tp]=0;\n        else ++a[tp];\n        mx[tp]=max(mx[tp],a[tp]);//\u53bb\u5f53\u524d\u5408\u5e76\u540e\u7684\u957f\u5ea6\n    }\n    printf(\"%d\\n\",mx[0]);\n}\n```\n", "link": "/posts/LG 3719 [AHOI2017\u521d\u4e2d\u7ec4]rexp/", "tags": ["\u6808"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1880 [NOI1995]\u77f3\u5b50\u5408\u5e76", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1880&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1880\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8be6\u89c1\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u4f18\u5316\n\n\u6700\u5c0f\u503c\u6709\u5355\u8c03\u6027,\u53ef\u4ee5\u4f7f\u7528\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f\u4f18\u5316\n\n\u4f46\u662f\u6700\u5927\u503c\u6ca1\u6709\n\n\u4f46\u662f\u6700\u5927\u503c\u6709\u4e2a\u6027\u8d28\uff1a\n    \n> \u4e00\u5b9a\u662f\u4e00\u76f4\u628a\u5176\u4ed6\u77f3\u5b50\u5408\u5e76\u5230\u67d0\u5806\u77f3\u5b50\n\n\u90a3\u4e48\u6211\u4eec\u53ef\u4ee5$f[l][r]=\\max(f[l][r-1],f[l+1,r])+S_r-S_{l-1}$\n\n\u76f8\u5f53\u4e8e\u4e00\u76f4\u5411\u5de6\u8fb9\u7684\u77f3\u5b50\u5408\u5e76\u6216\u53f3\u8fb9\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 2011\nint n,f[N][N],a[N],S[N],s[N][N];\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i]),f[i][i]=0,s[i][i]=i,S[i]=S[i-1]+a[i];\n    Fur(i,n+1,n*2)a[i]=a[i-n],f[i][i]=0,s[i][i]=i,S[i]=S[i-1]+a[i];\n    Fur(i,2,n)\n        Fur(l,1,n*2-i+1){\n            int r=l+i-1;\n            f[l][r]=inf;\n            Fur(k,s[l][r-1],s[l+1][r])\n            if(f[l][k]+f[k+1][r]+S[r]-S[l-1]<f[l][r])\n                f[l][r]=f[l][k]+f[k+1][r]+S[r]-S[l-1],\n                s[l][r]=k;\n        }\n    int ans=inf;\n    Fur(i,1,n+1)ans=MIN(ans,f[i][i+n-1]);\n    printf(\"%d\\n\",ans);\n    Fur(i,2,n)\n        Fur(l,1,n*2-i+1){\n            int r=l+i-1;\n            f[l][r]=MAX(f[l][r-1],f[l+1][r])+S[r]-S[l-1];\n        }\n    ans=0;\n    Fur(i,1,n)ans=MAX(ans,f[i][i+n-1]);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 1880 [NOI1995]\u77f3\u5b50\u5408\u5e76/", "tags": ["\u533a\u95f4dp", "\u52a8\u6001\u89c4\u5212", "\u56db\u8fb9\u5f62\u4e0d\u7b49\u5f0f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4065 [JXOI2017]\u989c\u8272", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4065&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4065\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4e00\u4e2a\u533a\u95f4\u5408\u6cd5,\u4ec5\u5f53\u8fd9\u4e2a\u533a\u95f4\u4e2d\u5305\u542b\u7684\u989c\u8272\u6ca1\u5728\u533a\u95f4\u5916\u51fa\u73b0\u8fc7\n\n\u6211\u4eec\u53ef\u4ee5\u628a\u6bcf\u79cd\u989c\u8272\u51fa\u73b0\u7684\u6bcf\u4e2a\u4f4d\u7f6e\u90fd\u8d4b\u503c\u4f7f\u5f97\u8fd9\u4e9b\u4f4d\u7f6e\u4e0a\u7684\u503c\u52a0\u8d77\u6765\u4e3a$0$\n\n\u8fd9\u6837\u6211\u4eec\u5c31\u53ef\u4ee5\u7528\u524d\u7f00\u548c\u7684\u65b9\u5f0f\u7edf\u8ba1\u4e86\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\nint n,s[N];\nvector<int>b[N];\nmap<ll,int>mp;\nconst ll mod = 1000000000000;\nvoid work(){\n    in>>n;\n    ll res,x,ans=0;\n    clr(s,0);\n    Fur(i,1,n)in>>x,b[x].push_back(i);\n    Fur(i,1,n)\n    if(!b[i].empty()){\n        res=0;\n        for(int j=0;j<b[i].size()-1;++j){\n            x=rand()*rand()%mod*rand()%mod*rand()%mod*rand()%mod;\n            if(rand()&1)x=-x;\n            s[b[i][j]]=x;res+=x;\n        }\n        s[b[i][b[i].size()-1]]=-res;\n    }\n    mp.clear();mp[0]=1;res=0;\n    Fur(i,1,n){\n        res+=s[i];\n        ans+=mp[res];\n        ++mp[res];\n    }\n    out<<ans<<ln;\n    Fur(i,1,n)b[i].clear();\n}\nint main(){\n    fin(\"in\");\n    int tt;in>>tt;\n    while(tt--)work();\n}\n```\n", "link": "/posts/LG 4065 [JXOI2017]\u989c\u8272/", "tags": ["hash"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2322 [HNOI2006]\u6700\u77ed\u6bcd\u4e32\u95ee\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2322&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2322\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$n\\le12$\n\n\u8bbe$f[sta][x]$\u8868\u793a\u72b6\u6001\u4e3a$sta$,\u5f53\u524d\u4f4d\u7f6e\u4e3a$x$\u7684\u60c5\u51b5\u4e0b\u6700\u77ed\u7684(\u5b57\u5178\u5e8f\u6700\u5c0f)\n\n$f[sta][y]=\\min(f[sta'][x]+cost)$\n\n\u770b\u5230\u8fd9\u4e2a\u53ef\u4ee5\u8054\u60f3\u5230**AC\u81ea\u52a8\u673a**\u548c**\u6700\u77ed\u8def**(\u8c8c\u4f3c\u662f\u6700\u77ed\u54c8\u5bc6\u987f\u8def\u5f84?)\n\n\u6bcf\u4e2a\u5b57\u7b26\u4e32\u957f\u5ea6\u90fd\u5c0f\u4e8e$50$,\u5982\u679c\u7528**AC\u81ea\u52a8\u673a**\u53ef\u80fd\u5c31~~\u6838\u5f39\u6253\u868a\u5b50~~\u4e86\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 15\nint n,g[N][N],f[N][15];\nchar s[N][55];\nint cost(int x,int y){\n    int lx=strlen(s[x]+1),ly=strlen(s[y]+1);\n    Fur(i,1,lx){\n        bool ff=1;\n        Fur(j,1,ly){\n            if(i+j-1>lx)break;\n            if(s[x][i+j-1]!=s[y][j]){ff=0;break;}\n        }\n        if(ff)return MAX(i+ly-1-x,0);\n    }\n}\nint main(){\n    in(n);\n    Fur(i,1,n)in(s[i]+1);\n    sort(s+1,s+n+1);\n    Fur(i,1,n)\n        Fur(j,1,n)\n        if(i!=j)g[i][j]=cost(i,j);\n    \n    Fur(i,1,n)f[1<<(i-1)][i];\n\n    Fur(i,1,(1<<n)-1){\n        Fur(j,1,n)\n            if()\n    }\n}\n```\n", "link": "/posts/LG 2322 [HNOI2006]\u6700\u77ed\u6bcd\u4e32\u95ee\u9898/", "tags": ["\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212", "\u5b57\u7b26\u4e32", "AC\u81ea\u52a8\u673a", "\u6700\u77ed\u8def"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4949 \u6700\u77ed\u8ddd\u79bb", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4949&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4949\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53ef\u4ee5\u7528\u5e76\u67e5\u96c6\u628a\u73af\u5957\u6811\u4e0a\u989d\u5916\u7684\u4e00\u6761\u8fb9\u627e\u51fa\u6765\n\n\u7136\u540e\u5c31\u662f\u6811\u5256\u4e86\n\n\u7528\u6811\u72b6\u6570\u7ec4\u7ef4\u62a4\u524d\u7f00\u548c\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nstruct edge{\n    int to,nxt,w,id;\n}e[N*2];\nstruct link{\n    int x,y,w,p;\n    il bool operator<(link b){\n        return w<b.w;\n    }\n}E[N];\nint head[N],cnt=0,n,q,ext;\nil void add(int x,int y,int w,int id){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[cnt].w=w;e[cnt].id=id;\n}\nstruct BIT{\n    int s[N];\n    il void upd(int x,int v){while(x<=n)s[x]+=v,x+=(x&-x);}\n    il int g(int x){\n        int ans=0;\n        while(x)ans+=s[x],x-=(x&-x);\n        return ans;\n    }\n    il int ask(int l,int r){\n        return g(r)-g(l-1);\n    }\n}T;\nint f[N],top[N],id[N],d[N],siz[N],sz=0,val[N];\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;\n        d[to]=d[x]+1;\n        val[to]=e[i].id;\n        dfs(to);\n        siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;\n    T.upd(id[x],E[val[x]].w);\n    E[val[x]].p=id[x];\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nil int ask(int x,int y){\n    int ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans+=T.ask(id[top[x]],id[x]);x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    return ans+T.ask(id[x]+1,id[y]);\n}\nint fa[N];\nint gf(int x){return (x==fa[x])?x:(fa[x]=gf(fa[x]));}\nint main(){\n    in(n,q);\n    int x,y,w,opt;\n    Fur(i,1,n)in(x,y,w),E[i]={x,y,w,0},fa[i]=i;\n    Fur(i,1,n){\n        x=E[i].x,y=E[i].y,w=E[i].w;\n        if(gf(x)!=gf(y)){\n            fa[gf(x)]=gf(y);\n            add(x,y,w,i),add(y,x,w,i);\n        }\n        else ext=i;\n    }\n    dfs(1);bt(1,1);\n    while(q--){\n        in(opt,x,y);\n        if(opt==1){\n            if(x!=ext)T.upd(E[x].p,y-E[x].w);\n            E[x].w=y;\n        }\n        else{\n            int ans=ask(x,y);\n            ans=MIN(ans,ask(x,E[ext].x)+E[ext].w+ask(E[ext].y,y));\n            ans=MIN(ans,ask(x,E[ext].y)+E[ext].w+ask(E[ext].x,y));\n            out(ans,ln);\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 4949 \u6700\u77ed\u8ddd\u79bb/", "tags": ["\u6811\u94fe\u5256\u5206", "\u6811\u72b6\u6570\u7ec4"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5664 Emiya-\u5bb6\u4eca\u5929\u7684\u996d", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5664&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5664\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n## \u9898\u610f\uff1a\n\n\u7ed9\u51fa\u4e00\u4e2a\u77e9\u9635,\u8981\u6c42\u6bcf\u884c\u53ea\u80fd\u9009\u4e00\u4e2a\u8282\u70b9,\u6bcf\u5217\u9009\u7684\u8282\u70b9\u4e0d\u80fd\u8d85\u8fc7\u6240\u6709\u9009\u7684\u8282\u70b9\u7684\u4e00\u534a,\u4e0d\u80fd\u4e0d\u9009,\n\u7ed9\u51fa\u6bcf\u4e2a\u8282\u70b9\u7684\u9009\u62e9\u65b9\u6848\u6570,\u6c42\u603b\u65b9\u6848\u6570\n\n## \u89e3\u6cd5\n\n\u8003\u8651\u5230\u9650\u5236\u662f\u6bcf\u5217\u9009\u62e9\u7684\u4e0d\u80fd\u8d85\u8fc7\u4e00\u534a,\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u4e0d\u5408\u6cd5\u7684\u6700\u591a\u53ea\u6709\u4e00\u5217 \n\n\u6211\u4eec\u53ef\u4ee5\u7528\u603b\u65b9\u6848\u6570\u51cf\u53bb\u4e0d\u7b26\u5408\u7684\n\n$s_i=\\sum_{j=1}^m a_{ij}$\n\n\u603b\u65b9\u6848\u6570\uff1a$\\prod_{i=1}^n (s_i+1) - 1$\n\n$\\because k=\\frac {tot}2$\n\n\u6240\u4ee5\u6211\u4eec\u6709\u4e00\u4e2a\u5f88\u5999\u7684\u65b9\u6cd5:\n\n\u8bbe\u9009\u4e2d\u76ee\u6807\u884c\u4e4b\u5916\u7684\u6743\u503c+1,\u4e0d\u9009+0,\u9009\u4e2d\u76ee\u6807\u884c\u6743\u503c\u4f4d+2\n\n\u6700\u540e\u53ea\u8981\u6743\u503c$> n$,\u90a3\u4e48\u76ee\u6807\u884c\u4e00\u5b9a\u88ab\u9009\u4e86\u8d85\u8fc7$\\frac n2$\u6b21\n\n\u8bbe$f(i,k)$\u8868\u793a\u603b\u5171\u9009\u4e86$i$\u6b21(\u4e5f\u5c31\u662f\u9009\u5230\u7b2c$i$\u884c)\u6743\u503c\u4e3a$k$\u7684\u65b9\u6848\u6570 \n\n\n$f(i,k) += f(i-1,k)*(s_i-a_{ij})$(\u5f53\u524d\u884c\u4e0d\u9009\u76ee\u6807\u5217\n\n$f(i,k+1) += f(i-1,k)$(\u5f53\u524d\u884c\u5b8c\u5168\u4e0d\u9009\n\n$f(i,k+2) += f(i-1,k)\\times a_{ij}$(\u5f53\u524d\u884c\u9009\u4e2d\u76ee\u6807\u5217\n\n$ans = \\prod_{i=1}^n (s_i+1) - 1 - \\sum_{i=n+1}^{2n} f(n,i)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define N 111\ntypedef long long ll;\nconst int mod=998244353;\nint a[N][2011],n,m;\nll f[N][2011],s[N];\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tfor(int i=1;i<=n;++i)\n\t\tfor(int j=1;j<=m;++j)\n\t\t\tscanf(\"%d\",&a[i][j]),\n            s[i]=(s[i]+a[i][j])%mod;\n\t\t\t\n\tll ans=1; \n\tfor(int i=1;i<=n;++i)\n\t\tans=(ans*(s[i]+1))%mod;\n\t\n    --ans;\n\tfor(int j=1;j<=m;++j){\n        memset(f,0,sizeof f);\n        f[0][0]=1;\n        for(int i=1;i<=n;++i)\n            for(int k=0;k<=n*2;++k){\n                f[i][k]=(f[i][k]+f[i-1][k]*(s[i]-a[i][j]))%mod;\n                f[i][k+1]=(f[i][k+1]+f[i-1][k])%mod;\n                f[i][k+2]=(f[i][k+2]+f[i-1][k]*a[i][j])%mod;\n            }\n        for(int i=n+1;i<=n*2;++i)\n            ans=(ans-f[n][i])%mod;\n    }\n    printf(\"%lld\\n\",(ans+mod)%mod);\n}\n```\n", "link": "/posts/LG 5664 Emiya-\u5bb6\u4eca\u5929\u7684\u996d/", "tags": ["\u5bb9\u65a5", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1445 [Violet]\u6a31\u82b1", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1445&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1445\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nint pri[N],tot=0,g[N],cnt[N];\nbool f[N];\nvoid ol(int n){\n\tFur(i,2,n){\n\t\tif(!f[i])pri[++tot]=i,g[i]=tot;\n\t\tFur(j,1,tot){\n\t\t\tif(pri[j]*i>n)break;\n\t\t\tf[i*pri[j]]=1;g[i*pri[j]]=j;\n\t\t\tif(i%pri[j]==0)break;\n\t\t}\n\t}\n}\nint main(){\n\tfin(\"in\");\n\tint n;\n\tll ans=1;\n\tin>>n;\n\tol(n);\n\tFur(i,2,n)\n\t\tfor(int x=i;x!=1;x/=pri[g[x]])cnt[g[x]]++;\n\tFur(i,1,tot)ans=ans*(cnt[i]*2+1)%1000000007;\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 1445 [Violet]\u6a31\u82b1/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1383 \u9ad8\u7ea7\u6253\u5b57\u673a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1383&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1383\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint q,cnt=0,sz=0,ls[N*20],rs[N*20],rt[N*20],siz[N*20];\nchar s[N*20];\nvoid ins(int l,int r,int p,char ch,int &x,int pre){\n    x=++sz;\n    ls[x]=ls[pre];\n    rs[x]=rs[pre];\n    s[x]=s[pre];\n    if(l==r){s[x]=ch;return;}\n    int m=(l+r)>>1;\n    if(p<=m)ins(l,m,p,ch,ls[x],ls[pre]);\n    else ins(m+1,r,p,ch,rs[x],rs[pre]);\n}\nchar get(int l,int r,int p,int x){\n    if(l==r)return s[x];\n    int m=(l+r)>>1;\n    if(p<=m)return get(l,m,p,ls[x]);\n    else return get(m+1,r,p,rs[x]);\n}\nint main(){\n    in(q);\n    rt[0]=++sz;\n    siz[0]=0;\n    Fur(i,1,q){\n        char opt,c;\n        int x;\n        in(opt);\n        if(opt=='T'){\n            in(c);\n            ++cnt;\n            siz[cnt]=siz[cnt-1]+1;\n            ins(1,q,siz[cnt],c,rt[cnt],rt[cnt-1]);\n        }\n        else if(opt=='U'){\n            in(x);\n            ++cnt;\n            siz[cnt]=siz[cnt-x-1];\n            rt[cnt]=rt[cnt-x-1];\n        }\n        else{\n            in(x);\n            pt(get(1,q,x,rt[cnt])),pt('\\n');\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 1383 \u9ad8\u7ea7\u6253\u5b57\u673a/", "tags": ["\u4e3b\u5e2d\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3556 [POI2013]MOR-Tales-of-seafaring", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3556&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3556\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u56e0\u4e3a\u8fb9\u6743\u4e3a1,\u6240\u4ee5\u76f4\u63a5\u8dd1\u5947\u5076\u6700\u77ed\u8def\u5373\u53ef\n\n\u4f46\u662f\u5f53$x=y$\u65f6,\u6211\u4eec\u9700\u8981\u5224\u65ad$x$\u662f\u5426\u6709\u5411\u5916\u8fde\u8fb9\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 5011\nshort n,m,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[10011];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nshort d[2][N][N];\nshort q[N*3],p[N*3];\nvoid bfs(int st){\n    int h=0,t=1,x,y;\n    x=st;\n    q[0]=x;d[0][st][x]=1;p[0]=0;\n    while(h<t){\n        x=q[h];y=p[h++];\n        fl(i,x)\n        if(!d[y^1][st][to]||d[y][st][x]+1<d[y^1][st][to]){\n            d[y^1][st][to]=d[y][st][x]+1;\n            q[t]=to,p[t++]=y^1;\n        }\n    }\n}\nint main(){\n    int q;\n    in(n,m,q);\n    int x,y,w;\n    Fur(i,1,m)in(x,y),add(x,y),add(y,x);\n    Fur(i,1,n)bfs(i);\n    while(q--){\n        in(x,y,w);\n        if(d[w&1][x][y]&&(x!=y||head[x])&&d[w&1][x][y]-1<=w)out(\"TAK\\n\");\n        else out(\"NIE\\n\");\n    }\n    flush();\n}\n```\n", "link": "/posts/LG 3556 [POI2013]MOR-Tales-of-seafaring/", "tags": ["\u6700\u77ed\u8def", "bfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5142 \u533a\u95f4\u65b9\u5dee", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5142&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5142\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$$\n\\frac{1}{n}\\sum_{i=1}^{n}(a_i-\\bar a)^2\n\n\\\\\\\\\n\n= \\frac 1n \\sum_{i=1}^{n}(a_i^2-2\\bar a\\times a_i+{\\bar a}^2)\n\n\\\\\\\\\n\n= \\frac 1n (\\sum_{i=1}^na_i^2 - 2\\bar a\\sum_{i=1}^n a_i + n \\bar a^2)\n\n\\\\\\\\\n\n= \\frac 1n \\sum_{i=1}^n a_i^2 - \\bar a^2\n$$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define int ll\n#define mod 1000000007\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=(s[ls]+s[rs])%mod,g[rt]=(g[ls]+g[rs])%mod\nint n,q,s[N<<2],g[N<<2];\nvoid build(int l,int r,int rt){\n\tif(l==r){\n\t\tin>>s[rt];g[rt]=(s[rt]*s[rt])%mod;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tbuild(l,m,ls);build(m+1,r,rs);\n\tpu;\n}\nvoid upd(int x,int c,int l,int r,int rt){\n\tif(l==r){\n\t\tc%=mod;\n\t\ts[rt]=c;g[rt]=(c*c)%mod;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tif(x<=m)upd(x,c,l,m,ls);\n\telse upd(x,c,m+1,r,rs);\n\tpu;\n}\nint rev(int x){\n\tint ans=1,p=mod-2;\n\twhile(p){\n\t\tif(p&1)ans=(ans*x)%mod;\n\t\tx=(x*x)%mod;\n\t\tp>>=1;\n\t}\n\treturn ans;\n}\nint ask(int L,int R,int v,int l=1,int r=n,int rt=1){\n\tif(L<=l&&r<=R)return (v?g[rt]:s[rt])%mod;\n\tint m=(l+r)>>1,ans=0;\n\tif(L<=m)ans=ask(L,R,v,l,m,ls);\n\tif(R>m)ans+=ask(L,R,v,m+1,r,rs);\n\treturn ans%mod;\n}\nsigned main(){\n\tin>>n>>q;\n\tbuild(1,n,1);\n\tint u,x,y;\n\twhile(q--){\n\t\tin>>u>>x>>y;\n\t\tif(u==1)upd(x,y,1,n,1);\n\t\telse{\n\t\t\tint a=ask(x,y,0),A=ask(x,y,1),inv=rev(y-x+1);\n\t\t\ta=1ll*a*inv%mod;a=1ll*a*a%mod;\n\t\t\tout<<((1ll*A*inv%mod+mod)%mod-a+mod)%mod<<ln;\n\t\t}\n\t}\n}\n```\n", "link": "/posts/LG 5142 \u533a\u95f4\u65b9\u5dee/", "tags": ["\u7ebf\u6bb5\u6811", "\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF733F Drivers Dissatisfaction", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF733F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF733F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4ed4\u7ec6\u8003\u8651\u4e00\u4e0b,\u6700\u7ec8\u80fd\u591f\u5f62\u6210\u6700\u5c0f\u6743\u503c\u7684\u751f\u6210\u6811\u7684\u60c5\u51b5\u4e00\u5b9a\u662f\u628aS\u90fd\u7528\u5728\u51cf\u5c0f\u67d0\u6761\u8fb9\u7684\u8d39\u7528\n\n1. \u5982\u679c\u90a3\u6761\u8fb9\u5728\u6700\u5c0f\u751f\u6210\u6811\u4e0a,\u90a3\u4e48\u76f4\u63a5\u5904\u7406\u5373\u53ef\n\n2. \u5982\u679c\u5728\u5916\u9762,\u8bbe\u8fd9\u6761\u8fb9\u4e3a$x \\rightarrow y$,\u6211\u4eec\u6c42\u51fa\u6700\u5c0f\u751f\u6210\u6811\u4e0a$x$\u5230$y$\u4e0a\u6700\u5927\u7684\u4e00\u6761\u8fb9,\u5220\u6389\u8fd9\u6761\u8fb9\n\n\u679a\u4e3e\u5220\u6389\u54ea\u6761\u8fb9,\u7136\u540e\u6267\u884c\u4e0a\u9762\u7684\u64cd\u4f5c\u5c31\u53ef\u4ee5\u4e86\n\n\u8bb0\u5f97\u5f00$long\\ long$,$rmq$\u7684\u6570\u7ec4\u5f00\u5927\u70b9\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300111\n#define int ll\nint n,m,S,OLD=0;\nint cnt=0,head[N];\nstruct edge{\n    int to,nxt,w,old;\n}e[N*2];\nvoid add(int x,int y,int w,int old){\n    e[++cnt].to=y;e[cnt].old=old;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nstruct link{\n    int id,x,y,w,c;\n}E[N];\nbool used[N];\nbool cmp(link x,link y){\n    return x.w<y.w;\n}\nint fa[N];\nint gf(int x){\n    return (x==fa[x])?x:(fa[x]=gf(fa[x]));\n}\nint f[N],top[N],d[N],siz[N],id[N],sz=0,s[25][N],val[N];\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;val[to]=i;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;id[x]=++sz;\n    s[0][id[x]]=val[x];\n    int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint get(int x,int y){\n    return e[x].w>e[y].w?x:y;\n}\nvoid st(){\n    Fur(k,1,20)\n\t\tFur(i,1,n-(1<<k)+1)\n\t\ts[k][i]=get(s[k-1][i],s[k-1][i+(1<<(k-1))]);\n}\nint ask(int l,int r){\n    if(l>r)return 0;\n\tint k=l2(r-l+1);\n\treturn get(s[k][l],s[k][r-(1<<k)+1]);\n}\nint fm(int x,int y){\n    int ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans=get(ans,ask(id[top[x]],id[x]));x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    ans=get(ans,ask(id[x]+1,id[y]));\n    return ans;\n}\nsigned main(){\n    fin(\"in\");\n    in>>n>>m;\n    Fur(i,1,m)in>>E[i].w;\n    Fur(i,1,m)in>>E[i].c;\n    Fur(i,1,m)in>>E[i].x>>E[i].y,E[i].id=i;\n    in>>S;\n    sort(E+1,E+m+1,cmp);\n    Fur(i,1,n)fa[i]=i;\n    int x,y,w;\n    e[0].w=-inf;\n    Fur(i,1,m){\n        x=E[i].x,y=E[i].y,w=E[i].w;\n        if(gf(x)!=gf(y)){\n            fa[fa[x]]=fa[y];\n            OLD+=w;\n            add(x,y,w,i);add(y,x,w,i);\n            used[i]=1;\n        }\n    }\n    dfs(1);bt(1,1);\n    st();\n    int ans=OLD,as,aw=0;\n    Fur(i,1,m){\n        int tmp,w=0;\n        if(used[i])tmp=OLD-(S/E[i].c);\n        else tmp=OLD-e[(w=fm(E[i].x,E[i].y))].w+E[i].w-(S/E[i].c);\n        if(tmp<ans)ans=tmp,as=i,aw=w;\n    }\n    out<<ans<<ln;\n    used[as]=1;E[as].w-=(S/E[as].c);\n    used[e[aw].old]=0;\n    Fur(i,1,m)if(used[i])\n        out<<E[i].id<<\" \"<<E[i].w<<ln;\n}\n```\n", "link": "/posts/LG CF733F Drivers Dissatisfaction/", "tags": ["\u6811\u94fe\u5256\u5206", "\u6700\u5c0f\u751f\u6210\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF401D Roman and Numbers", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF401D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF401D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<iostream>\n#include<cstring>\n#define int long long\nusing namespace std;\nconst int maxs=(1<<18)+10,maxm=110;\nint w[20],cnt=-1,m,n,f[maxs][maxm];\nbool vis[10];\nsigned main()\n{\n    for(cin>>n>>m;n;n/=10)\n        w[++cnt]=n%10;\n    f[0][0]=1;\n    for(int s=1;s<1<<cnt+1;s++)\n    {\n        memset(vis,0,sizeof(vis));\n        for(int i=0;i<=cnt;i++)\n        {\n            if(s==(1<<i)&&!w[i])\n                break;\n            if(!(s&(1<<i))||vis[w[i]])\n                continue;\n            vis[w[i]]=1;\n            for(int j=0;j<m;j++)\n                f[s][(j*10+w[i])%m]=f[s][(j*10+w[i])%m]+f[s^(1<<i)][j];\n        }\n    }\n    cout<<f[(1<<cnt+1)-1][0]<<endl;\n    return 0;\n}\n```\n", "link": "/posts/LG CF401D Roman and Numbers/", "tags": ["\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2988 [USACO10MAR]\u8003\u8bd5Test-Taking", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2988&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2988\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nint n,k,a[N];\nint main(){\n\tin>>n>>k;\n\tFur(i,1,k)in>>a[i];\n\tsort(a+1,a+k+1);\n\tint ans=MAX(a[1],n-a[k]);\n\tFur(i,2,k)ans=MAX(ans,(a[i]-a[i-1])/2);\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 2988 [USACO10MAR]\u8003\u8bd5Test-Taking/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5340 [TJOI2019]\u5927\u4e2d\u950b\u7684\u6e38\u4e50\u573a", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5340&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5340\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 10011\nint st,ed;\nint n,m,k,cnt=0,head[N],val[N];\nstruct edge{\n    int to,nxt,w;\n}e[200011];\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[cnt].w=w;\n}\nint d[N][30];\nbool v[N][30];\nstruct node{\n    int x,k;\n    il bool operator<(node y)const{\n        return d[x][k]>d[y.x][y.k];\n    }\n};\nint main(){\nint T;in(T);\nwhile(T--){\n    cnt=0;clr(head,0);\n    in(n,m,k);\n    int x,y,w;\n    Fur(i,1,n)in(x),val[i]=((x==1)?-1:1);\n    Fur(i,1,m)in(x,y,w),add(x,y,w),add(y,x,w);\n    in(st,ed);\n    clr(d,126);\n    d[st][k+val[st]]=0;\n    priority_queue<node>q;\n    q.push(node{st,k+val[st]});\n    while(!q.empty()){\n        node tmp=q.top();q.pop();\n        x=tmp.x,y=tmp.k;v[x][y]=0;\n        fl(i,x){\n            int nk=y+val[to];\n            if(nk<0||nk>2*k)continue;\n            if(d[x][y]+e[i].w<d[to][nk]){\n                d[to][nk]=d[x][y]+e[i].w;\n                if(!v[to][nk])q.push(node{to,nk}),v[to][nk]=1;\n            }\n        }\n    }\n    int ans=inf;\n    Fur(i,0,2*k)ans=MIN(ans,d[ed][i]);\n    if(ans==inf)ans=-1;\n    out(ans,ln);\n}\n    flush();\n}\n```\n", "link": "/posts/LG 5340 [TJOI2019]\u5927\u4e2d\u950b\u7684\u6e38\u4e50\u573a/", "tags": ["\u5206\u5c42\u56fe", "\u6700\u77ed\u8def"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4332 [SHOI2014]\u4e09\u53c9\u795e\u7ecf\u6811", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4332&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4332\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\n#include<algorithm>\n#define RG register\n#define I inline\n#define R int\n#define lc c[x][0]\n#define rc c[x][1]\n#define G if(++ip==ie)if(fread(ip=ibuf,1,L,stdin))\nusing namespace std;\nconst int N=5e5+9,M=1.5e6+9,L=1<<19;\nchar ibuf[L],*ie=ibuf+L,*ip=ie-1;\nint n,f[M],c[N][2],t[N],n1[N],n2[N],v[M],q[M],d[N];\nI int max(R x,R y){return x>y?x:y;}\nI int in(){\n    G;while(*ip<'-')G;\n    R x=*ip&15;G;\n    while(*ip>'-'){(x*=10)+=*ip&15;G;}\n    return x;\n}\nI bool nrt(R x){\n    return c[f[x]][0]==x||c[f[x]][1]==x;\n}\nI void up(R x){\n    if(!(n1[x]=n1[rc])&&!(n1[x]=x*(v[x]!=1)))n1[x]=n1[lc];\n    if(!(n2[x]=n2[rc])&&!(n2[x]=x*(v[x]!=2)))n2[x]=n2[lc];\n}\nI void dn(R x,R tg){\n    v[x]^=3;swap(n1[x],n2[x]);t[x]+=tg;\n}\nI void all(R x){\n    if(nrt(x))all(f[x]);\n    if(t[x])dn(lc,t[x]),dn(rc,t[x]),t[x]=0;\n}\nI void rot(R x){\n    R y=f[x],z=f[y],k=c[y][1]==x,w=c[x][!k];\n    if(nrt(y))c[z][c[z][1]==y]=x;\n    f[f[f[c[c[x][!k]=y][k]=w]=y]=x]=z;up(y);\n}\nI void sp(R x){\n    all(x);\n    for(R y;nrt(x);rot(x))\n        if(nrt(y=f[x]))rot((c[f[y]][0]==y)^(c[y][0]==x)?x:y);\n    up(x);\n}\nI void ac(R x){\n    for(R y=0;x;sp(x),rc=y,up(y=x),x=f[x]);\n}\nint main(){\n    n=in();R he,tl=0,i,x,tp,nowrt;\n    for(i=1;i<=n;++i)d[f[in()]=f[in()]=f[in()]=i]=3;\n    for(;i<=3*n+1;++i)v[q[++tl]=i]=in()<<1;\n    for(he=1;he<=tl;++he){\n        x=q[he];if(x<=n)up(x);\n        v[f[x]]+=v[x]>>1;\n        if(!--d[f[x]])q[++tl]=f[x];\n    }\n    nowrt=v[1]>>1;\n    for(R q=in();q;--q){\n        tp=(v[x=in()]^=2)-1;\n        ac(x=f[x]);sp(x);\n        if((~tp?n1:n2)[x]){\n            sp(x=(~tp?n1:n2)[x]);\n            dn(rc,tp),up(rc);\n            v[x]+=tp;up(x);\n        }\n        else dn(x,tp),up(x),nowrt^=1;\n        putchar(nowrt|'0');putchar('\\n');\n    }\n}\n```\n", "link": "/posts/LG 4332 [SHOI2014]\u4e09\u53c9\u795e\u7ecf\u6811/", "tags": ["lct"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1208D Restore-Permutation", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1208D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1208D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6211\u4eec\u6bcf\u6b21\u627e\u6700\u53f3\u76840,\u8fd9\u4e2a\u4f4d\u7f6ep\u7684\u7b54\u6848\u4e3a++cnt,\u7136\u540e\u628a$a_p+1,...a_n$\u51cf\u53bbcnt\n\n\u4e00\u76f4\u91cd\u590dn\u904d\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    // #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 200011\n#define int ll\n#define inf (1ll<<50)\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=MIN(s[ls],s[rs])\nint n;\nll s[N<<2],laz[N<<2];\nvoid build(int l,int r,int rt){\n    if(l==r)return void(in(s[rt]));\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu;\n}\nvoid pd(int rt){\n    if(laz[rt]){\n        laz[ls]+=laz[rt];\n        laz[rs]+=laz[rt];\n        s[ls]+=laz[rt];\n        s[rs]+=laz[rt];\n        laz[rt]=0;\n    }\n}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L==n+1)return;\n    if(L<=l&&r<=R){\n        s[rt]+=v;laz[rt]+=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    pu;\n}\nll ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1;\n    ll ans=inf;\n    pd(rt);\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans=MIN(ans,ask(L,R,m+1,r,rs));\n    return ans;\n}\nint lz(){\n    int l=1,r=n,ans=n;\n    while(l<=r){\n        int m=(l+r)>>1;\n        if(ask(m,n,1,n,1)==0)ans=m,l=m+1;\n        else r=m-1;\n    }\n    return ans;\n}\nint ANS[N];\nsigned main(){\n    in(n);\n    build(1,n,1);\n    Fur(i,1,n){\n        int x=lz();\n        ANS[x]=i;\n        upd(x,x,inf,1,n,1);\n        upd(x+1,n,-i,1,n,1);\n    }\n    Fur(i,1,n)out(ANS[i],\" \");\n    flush();\n}\n```\n", "link": "/posts/LG CF1208D Restore-Permutation/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF2B The least round way", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF2B&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF2B\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1011\nint n,a[N][N],b[N][N],f[N][N],F[N][N],p[N][N],q[N][N];\nchar ans[N*2];\nint main(){\n    fin(\"in\");\n    in>>n;\n    int x,y,X=0,Y=0;\n    Fur(i,1,n)Fur(j,1,n){\n        int x;in>>x;\n        if(x==0){\n            X=i,Y=j;\n            a[i][j]=b[i][j]=1;\n        }\n        else{\n            while(x%2==0)a[i][j]++,x>>=1;\n            while(x%5==0)b[i][j]++,x/=5;\n        }\n    }\n    f[1][1]=a[1][1];\n    F[1][1]=b[1][1];\n    Fur(i,2,n){\n        f[1][i]=f[1][i-1]+a[1][i];\n        F[1][i]=F[1][i-1]+b[1][i];\n        f[i][1]=f[i-1][1]+a[i][1];p[i][1]=1;\n        F[i][1]=F[i-1][1]+b[i][1];q[i][1]=1;\n    }\n    Fur(i,2,n)\n        Fur(j,2,n){\n            if(f[i-1][j]<f[i][j-1])p[i][j]=1,f[i][j]=f[i-1][j]+a[i][j];\n            else f[i][j]=f[i][j-1]+a[i][j];\n            if(F[i-1][j]<F[i][j-1])q[i][j]=1,F[i][j]=F[i-1][j]+b[i][j];\n            else F[i][j]=F[i][j-1]+b[i][j];\n        }\n    int d=0;\n    if(f[n][n]>1&&F[n][n]>1&&X){\n        out<<\"1\\n\";\n        Fur(i,1,X-1)out<<\"D\";\n        Fur(i,1,Y-1)out<<\"R\";\n        Fur(i,X+1,n)out<<\"D\";\n        Fur(i,Y+1,n)out<<\"R\";\n        return 0;\n    }\n    if(f[n][n]<F[n][n]){\n        out<<f[n][n]<<ln;\n        x=n,y=n;\n        while(x!=1||y!=1){\n            if(p[x][y])ans[d++]='D',x--;\n            else ans[d++]='R',y--;\n        }\n    }\n    else{\n        out<<F[n][n]<<ln;\n        x=n,y=n;\n        while(x!=1||y!=1){\n            if(q[x][y])ans[d++]='D',x--;\n            else ans[d++]='R',y--;\n        }\n    }\n    reverse(ans,ans+d);\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG CF2B The least round way/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4742 [Wind-Festival]Running-In-The-Sky", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4742&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4742\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u7f29\u70b9,\u7136\u540e\u8dd1\u6700\u957f\u8def\n\n\u7136\u540e\u66f4\u65b0\u7684\u65f6\u5019\u987a\u4fbf\u8bb0\u5f55\u6700\u5927\u4eae\u5ea6\u5c31\u53ef\u4ee5\u4e86\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 2000011\nint head[N],n,m,cnt=0,z[N],bl[N],dfn[N],low[N],c[N],tp=0,sz=0,mx[N];\nint Head[N],Cnt=0,r[N],q[N],top=0,f[N],F[N];\nbool v[N];\nstruct edge{\n\tint x,to,nxt;\n}e[N*10],E[N*10];\nvoid add(int x,int y){\n\te[++cnt].to=y;e[cnt].x=x;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid Add(int x,int y){\n\tE[++Cnt].to=y;E[Cnt].x=x;E[Cnt].nxt=Head[x];Head[x]=Cnt;\n}\nvoid tarjan(ll x){\n\tdfn[x]=low[x]=++sz;v[x]=1;z[++tp]=x;\n\tfl(i,x)\n\tif(!dfn[to]){\n\t\ttarjan(to);\n\t\tlow[x]=min(low[x],low[to]);\n\t}\n\telse if(v[to])low[x]=min(low[x],dfn[to]);\n\tif(low[x]==dfn[x])\n\twhile(ll k=z[tp--]){\n\t\tv[k]=0,bl[k]=x;\n\t\tif(k==x)break;\n\t\tc[x]+=c[k];\n\t}\n}\nint main(){\n\tin>>n>>m;\n\tFur(i,1,n)in>>c[i],mx[i]=c[i];\n\tint x,y;\n\tFur(i,1,m)in>>x>>y,add(x,y);\n\tFur(i,1,n)if(!dfn[i])tarjan(i);\n\tFur(i,1,m){\n\t\tx=bl[e[i].x];y=bl[e[i].to];\n\t\tif(x!=y)Add(x,y),r[y]++;\n\t}\n\tFur(i,1,n)if(bl[i]==i&&!r[i])q[++top]=i,f[i]=c[i],F[i]=mx[i];\n\twhile(top){\n\t\tx=q[top--];\n\t\tfor(int i=Head[x],to;to=E[i].to,i;i=E[i].nxt){\n\t\t\tif(f[x]+c[to]==f[to])\n\t\t\t\tF[to]=MAX(F[to],MAX(F[x],mx[to]));\n\t\t\t\n\t\t\tif(f[x]+c[to]>f[to]){\n\t\t\t\tf[to]=f[x]+c[to];\n\t\t\t\tF[to]=MAX(F[x],mx[to]);\n\t\t\t}\n\t\t\t\n\n\t\t\tif(--r[to]==0)q[++top]=to;\n\t\t}\n\t}\n\tint ans=0,as=0;\n\tFur(i,1,n){\n\t\tif(f[i]>ans)ans=f[i],as=F[i];\n\t\telse if(f[i]==ans)as=MAX(as,F[i]);\n\t}\n\tout<<ans<<\" \"<<as<<ln;\n}\n```\n", "link": "/posts/LG 4742 [Wind-Festival]Running-In-The-Sky/", "tags": ["tarjan"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1259 \u6574\u6570\u5212\u5206-V2", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\ntypedef long long ll;\nconst ll MOD=1e9+7;\nconst ll N=50005;\nll f[2][N];\nll g[2][N];\nll h[N];\nll n,m;\nint main(){\n    scanf(\"%lld\",&n);m=sqrt(n);\n    f[0][0]=1;\n    int now=0,now1=0;\n    for (ll u=1;u<=m;u++){\n        now^=1;\n        for (ll i=0;i<u;i++) f[now][i]=f[now^1][i];\n        for (ll i=u;i<=n;i++) f[now][i]=(f[now][i-u]+f[now^1][i])%MOD;\n    }\n    m++;\n    g[0][0]=1;h[0]=1;\n    for (ll u=1;u<=m;u++){\n        now1^=1;\n        for (ll i=0;i<=n;i++)\n        {\n            g[now1][i]=0;\n            if (i>=m) g[now1][i]=(g[now1][i]+g[now1^1][i-m])%MOD;\n            if (i>=u) g[now1][i]=(g[now1][i]+g[now1][i-u])%MOD;\n            h[i]=(h[i]+g[now1][i])%MOD;\n        }\n    }\n    ll ans=0;\n    for (ll u=0;u<=n;u++)   ans=(ans+f[now][u]*h[n-u]%MOD)%MOD;\n    printf(\"%lld\\n\",ans);\n}\n```\n", "link": "/posts/51nod 1259 \u6574\u6570\u5212\u5206-V2/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF620E New-Year-Tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF620E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF620E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 400011\n// #define int ll\n#define ls rt<<1\n#define rs rt<<1|1\n#define pu s[rt]=s[ls]|s[rs]\nint n,q;\nll s[N<<2],a[N],laz[N<<2];\nvoid build(int l,int r,int rt){\n    if(l==r){\n        s[rt]=(1ll<<a[l]);\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    pu;\n}\nvoid pd(int rt){\n    if(laz[rt]){\n        s[ls]=s[rs]=laz[ls]=laz[rs]=laz[rt];\n        laz[rt]=0;\n    }\n}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt]=laz[rt]=(1ll<<v);\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    pu;\n}\nll ask(int L,int R,int l,int r,int rt){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1;\n    ll ans=0;\n    pd(rt);\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans|=ask(L,R,m+1,r,rs);\n    return ans;\n}\nint dfn,L[N],R[N],cnt=0,head[N],c[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;}\nvoid dfs(int x){\n    L[x]=++dfn;\n    a[dfn]=c[x];\n    fl(i,x)if(!L[to])dfs(to);\n    R[x]=dfn;\n}\nsigned main(){\n    in(n,q);\n    Fur(i,1,n)in(c[i]);\n    int opt,x,y;\n    Fur(i,1,n-1)in(x,y),add(x,y),add(y,x);\n    dfs(1);\n    build(1,n,1);\n    while(q--){\n        in(opt,x);\n        if(opt==1){\n            in(y);\n            upd(L[x],R[x],y,1,n,1);\n        }\n        else{\n            ll t=ask(L[x],R[x],1,n,1),ans=0;\n            while(t)++ans,t-=(t&-t);\n            out(ans,ln);\n        }\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF620E New-Year-Tree/", "tags": ["\u7ebf\u6bb5\u6811", "\u72b6\u6001\u538b\u7f29"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3736 [HAOI2016]\u5b57\u7b26\u5408\u5e76", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3736&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3736\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u770b\u4e86\u770b\u6570\u636e\u8303\u56f4,\u53ef\u4ee5\u77e5\u9053\u662f\u72b6\u6001\u538b\u7f29+\u533a\u95f4dp\n\n\u6211\u4eec\u8bbe$f[i][j][t]$\u8868\u793a$[i,j]$\u5408\u5e76\u540e\u72b6\u6001\u4e3a$t$\u83b7\u5f97\u7684\u5206\u6570\n\n$f[i][j][t] = f[i][k][t'] + f[k+1][j][t''] (t'|t'' = t)$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 311\n#define inf (1ll<<60)\nint n,k,c[1<<8],a[N];\nll f[N][N][1<<8],w[1<<8];\nint main(){\n    fin(\"in\");\n    in>>n>>k;\n    Fur(i,1,n)in>>a[i];\n    Fur(i,0,(1<<k)-1)in>>c[i]>>w[i];\n    clr(f,254);\n    Fdr(l,n,1)\n        Fur(r,l,n){\n            if(l==r){\n                f[l][r][a[l]]=0;\n                continue;\n            }\n            int len=(r-l)%(k-1);\n            if(!len)len=k-1;\n            for(int j=r;j>l;j-=k-1)\n                Fur(t,0,(1<<len)-1){\n                f[l][r][t<<1]=MAX(f[l][r][t<<1],f[l][j-1][t]+f[j][r][0]);\n                f[l][r][t<<1|1]=MAX(f[l][r][t<<1|1],f[l][j-1][t]+f[j][r][1]);\n            }\n            if(len==k-1){\n                ll g[2]={-inf,-inf};\n                Fur(t,0,(1<<k)-1)\n                    g[c[t]]=MAX(g[c[t]],f[l][r][t]+w[t]);\n                f[l][r][0]=g[0];\n                f[l][r][1]=g[1];\n            }\n        }\n    \n    ll ans=-inf;\n    Fur(i,0,(1<<k)-1)ans=MAX(ans,f[1][n][i]);\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 3736 [HAOI2016]\u5b57\u7b26\u5408\u5e76/", "tags": ["\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212", "\u533a\u95f4dp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3648 [APIO2014]\u5e8f\u5217\u5206\u5272", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3648&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3648\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f(i,k)$\u8868\u793a\u5c06\u524d$i$\u4e2a\u5206$k$\u6b21\u7684\u5206\u6570\n\n\u6211\u4eec\u53ef\u4ee5dp$k$\u6b21\u5c31\u53ef\u4ee5\u4e86\n\n\u8bbe$f_i$\u4e3a\u524d$i$\u4e2a,$g_i$\u4e3a\u4e0a\u4e00\u6b21dp\u7684\u7ed3\u679c\n\n$$\nf_i=\\max_{j=1}^{i-1}(g_j+s_j\\times(s_i-s_j))\n$$\n\n\u53d6\u4efb\u610f$0\\le k<j <i$\u4e14\u4ece$j$\u8f6c\u79fb\u6bd4\u4ece$k$\u66f4\u4f18,\u90a3\u4e48\n\n$$g_j+s_j\\times(s_i-s_j)\\ge g_k+s_k\\times(s_i-s_k)$$\n\u5c55\u5f00\u5f97\n\n$$g_j+s_is_j-{s_j}^2\\ge g_k+s_is_k-{s_k}^2$$\n\u79fb\u9879\u5f97\n$$s_i(s_j-s_k) \\ge {s_j}^2-{s_k}^2+g_k-g_j$$\n\u6574\u7406\u5f97\n$$s_i\\ge \\frac{({s_j}^2-g_j)-({s_k}^2-g_k)}{s_j-s_k}\n$$\n\n\u6ce8\u610f$s_j-s_k$\u6709\u53ef\u80fd\u4e3a$0$,\u8981\u7279\u5224\n\n\u56e0\u4e3a\u8981\u6c42\u7684\u662f\u6700\u5927\u503c,\u6240\u4ee5\u6211\u4eec\u7ef4\u62a4\u4e00\u4e2a\u4e0a\u51f8\u58f3\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,k,q[N],pre[N][201];\nll s[N],f[N],g[N];\ndb S(int i,int j){\n    if(s[i]==s[j])return -1e18;\n    return (db)(s[i]*s[i]-g[i]-s[j]*s[j]+g[j])/(db)(s[i]-s[j]);\n}\nvoid op(int n,int t){\n    if(pre[n][t])op(pre[n][t],t-1);\n    out(n,\" \");\n}\nint main(){\n    in(n,k);\n    Fur(i,1,n)in(s[i]),s[i]+=s[i-1];\n    Fur(tt,1,k){\n        int h=1,t=1;\n        q[1]=0;\n        Fur(i,1,n){\n            while(h<t&&S(q[h],q[h+1])<=s[i])++h;\n            f[i]=g[q[h]]+s[q[h]]*(s[i]-s[q[h]]);\n            pre[i][tt]=q[h];\n            while(h<t&&S(q[t-1],q[t])>=S(q[t-1],i))--t;\n            q[++t]=i;\n        }\n        std::swap(f,g);\n    }\n    out(g[n],ln);\n    op(pre[n][k],k-1);\n    flush();\n}\n```\n", "link": "/posts/LG 3648 [APIO2014]\u5e8f\u5217\u5206\u5272/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u659c\u7387\u4f18\u5316", "\u524d\u7f00\u548c"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 2372 \u56de\u6587\u4e32\u7edf\u8ba1", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8003\u8651\u5982\u4f55\u5feb\u901f\u627e\u51fa\u62e5\u6709\uff08\u4e0e\u5b83\u7684\u524d\u7f00\u76f8\u540c\u7684\uff09\u540e\u7f00\u7684\u4e32\u3002\u8fd9\u4e2a\u4e1c\u897f\u53ef\u4ee5\u901a\u8fc7\u628a\u5b57\u7b26\u4e32\u653e\u5230$Trie$\u91cc\u9762\u3002 \u5206\u7c7b\u4e24\u79cd\u60c5\u51b5,**\u77ed\u4e32+\u957f\u4e32**\u548c**\u957f\u4e32+\u77ed\u4e32**\u3002\u5bf9\u4e8e**\u77ed\u4e32+\u957f\u4e32**\u7684\u60c5\u51b5,\u5148\u5c06\u5b57\u7b26\u4e32\u6309$len$\u6392\u5e8f,\u7136\u540e\u987a\u5e8f\u5c06\u5b57\u7b26\u4e32\u5012\u7740\u63d2\u5165$trie$\u91cc\u9762,\u5e76\u5728$trie$\u4e2d\u7684\u5c3e\u8282\u70b9\u8bb0\u5f55$hash$\u3002\u5229\u7528\u5f53\u524d\u4e32\u4f5c\u4e3a\u67e5\u8be2\u4e32\u6765\u627e\u7b54\u6848,\u8fd9\u6837\u80fd\u4fdd\u8bc1\u5f53\u524d\u4e32\u4e00\u5b9a\u662f\u957f\u4e32,\u5e76\u4e14\u627e\u5230\u7684\u6240\u6709\u77ed\u4e32\u90fd\u6709\u548c\u5b83\u7684\u524d\u7f00\u76f8\u540c\u7684\u540e\u7f00,\u6240\u4ee5\u518d\u5229\u7528$hash$\u5224\u65ad\u4e00\u4e0b\u5c31\u53ef\u4ee5\u786e\u5b9a\u62fc\u51fa\u6765\u7684\u662f\u4e0d\u662f\u56de\u6587\u4e32\u4e86\u3002\u53e6\u5916\u4e00\u4e2a\u60c5\u51b5\u540c\u7406\u3002 \u590d\u6742\u5ea6\u662f$O(26\\sum len)$\u3002\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\n#define M 1000011\n#define base 233\nint n;\nchar s[M];\nint bg[N],ed[N],pos[N],c[M][27],v[M],cnt[M],len,sz=0;\null  h[M],g[M],p[M];\nil bool cmp(int x,int y){return ed[x]-bg[x]<ed[y]-bg[y];}\nil int idx(char c){return c-'a';}\nil void ins(int i){\n    int rt=0;\n    Fdr(j,ed[i],bg[i]){\n        int k=idx(s[j]);\n        if(!c[rt][k])c[rt][k]=++sz;\n        rt=c[rt][k];\n    }\n    v[rt]=i;cnt[rt]++;\n}\nil void INS(int i){\n    int rt=0;\n    Fur(j,bg[i],ed[i]){\n        int k=idx(s[j]);\n        if(!c[rt][k])c[rt][k]=++sz;\n        rt=c[rt][k];\n    }\n    v[rt]=i;cnt[rt]++;\n}\nil ull gh(int l,int r){return h[r]-h[l-1]*p[r-l+1];}\nil ull gg(int l,int r){return g[l]-g[r+1]*p[r-l+1];}\nil bool chk(int x,int y){\n    ull a=gh(bg[x],ed[x])*p[ed[y]-bg[y]+1]+gh(bg[y],ed[y]);\n    ull b=gg(bg[y],ed[y])*p[ed[x]-bg[x]+1]+gg(bg[x],ed[x]);\n    return a==b;\n}\nint main(){\n    in>>n;\n    Fur(i,1,n){\n        bg[i]=ed[i]=ed[i-1]+1;\n        in>>(s+bg[i]);\n        ed[i]+=strlen(s+bg[i])-1;\n    }\n    len=ed[n];\n    p[0]=1;\n    Fur(i,1,len){\n        h[i]=h[i-1]*base+s[i];\n        p[i]=p[i-1]*base;\n    }\n    Fdr(i,len,1)g[i]=g[i+1]*base+s[i];\n    Fur(i,1,n)pos[i]=i;\n    sort(pos+1,pos+n+1,cmp);\n    ll ans=0;\n    Fur(t,1,n){\n        int i=pos[t],rt=0;\n        Fur(j,bg[i],ed[i]){\n            int k=idx(s[j]);\n            if(!c[rt][k])break;\n            if(v[rt]&&chk(i,v[rt]))ans+=cnt[rt];\n            rt=c[rt][k];\n        }\n        if(v[rt]&&chk(i,v[rt]))ans+=cnt[rt];\n        ins(i);\n    }\n    clr(c,0);clr(cnt,0);clr(v,0);sz=0;\n    Fur(t,1,n){\n        int i=pos[t],rt=0;\n        Fdr(j,ed[i],bg[i]){\n            int k=idx(s[j]);\n            if(!c[rt][k])break;\n            if(v[rt]&&chk(v[rt],i))ans+=cnt[rt];\n            rt=c[rt][k];\n        }\n        if(v[rt]&&chk(v[rt],i))ans+=cnt[rt];\n        INS(i);\n    }\n    out<<ans<<ln;\n}\n\n```\n", "link": "/posts/51nod 2372 \u56de\u6587\u4e32\u7edf\u8ba1/", "tags": ["trie", "hash"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "BZ 4804 \u6b27\u62c9\u5fc3\u7b97", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://remmina.github.io/BZPRO/JudgeOnline/4804.html&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://remmina.github.io/BZPRO/JudgeOnline/4804.html\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10000011\nint pri[N],tot=0;\nll phi[N];\nbool f[N];\nvoid ol(int n){\n    phi[1]=1;\n    Fur(i,2,n){\n        if(!f[i])phi[i]=i-1,pri[++tot]=i;\n        Fur(j,1,tot){\n            if(pri[j]*i>n)break;\n            f[i*pri[j]]=1;\n            if(i%pri[j])phi[i*pri[j]]=phi[i]*phi[pri[j]];\n            else{\n                phi[i*pri[j]]=phi[i]*pri[j];\n                break;\n            }\n        }\n    }\n    Fur(i,2,n)phi[i]+=phi[i-1];\n}\nint main(){\n\tfin(\"in\");\n    ol(10000000);\n    int T,n;ll ans;\n    in>>T;\n    while(T--){\n        in>>n;ans=0;\n        for(int l=1,r;l<=n;l=r+1){\n            r=n/(n/l);\n            ans+=(phi[r]-phi[l-1])*(2*phi[(n/l)]-1);\n        }\n        out<<ans<<ln;\n    }\n}\n\n```\n", "link": "/posts/BZ 4804 \u6b27\u62c9\u5fc3\u7b97/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2491 [SDOI2011]\u6d88\u9632", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2491&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2491\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n[\u540c\u6811\u7f51\u7684\u6838](../LG%201099%20\u6811\u7f51\u7684\u6838/index.html)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\nint n,s,cnt=0,head[N],d[N],f[N],tmp=0,top,ans=inf;\nbool b[N];\nstruct edge{\n\tint to,nxt,w;\n}e[N*2];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n\tif(d[x]>d[tmp])tmp=x;\n\tfl(i,x)\n\tif(to!=f[x]&&!b[to])d[to]=d[x]+e[i].w,f[to]=x,dfs(to);\n}\nint main(){\n\tin>>n>>s;\n\tint x,y,w;\n\tFur(i,1,n-1)\n\t\tin>>x>>y>>w,\n\t\tadd(x,y,w),add(y,x,w);\n\t\n\td[1]=1;dfs(1);\n\td[tmp]=0;f[tmp]=0;\n\tdfs(tmp);\n\ttop=tmp;\n\tint h=0,t=1;\n\tfor(int i=top,j=top;i;i=f[i]){\n\t\twhile(d[j]-d[i]>s)j=f[j];\n\t\tans=MIN(ans,MAX(d[top]-d[j],d[i]));\n\t}\n\tfor(int i=top;i;i=f[i])b[i]=1;\n\tfor(int i=top;i;i=f[i]){\n\t\tx=i;d[i]=0;\n\t\tdfs(i);\n\t}\n\tFur(i,1,n)ans=MAX(ans,d[i]);\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 2491 [SDOI2011]\u6d88\u9632/", "tags": ["dfs"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1197D Yet-Another-Subarray-Problem", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1197D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1197D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$\\sum\\limits_{i=l}^{r} a_i - k \\lceil \\frac{r - l + 1}{m} \\rceil$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/LG CF1197D Yet-Another-Subarray-Problem/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF6E Exposition", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF6E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF6E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,k,a[N],L[N],R[N];\nset<int>T;\nint main(){\n    fin(\"in\");\n    in>>n>>k;\n    Fur(i,1,n)in>>a[i];\n    int l=0,ans=0,tot=1;\n    Fur(i,1,n){\n        T.insert(a[i]);\n        while(*(--T.end())-*T.begin()>k)T.erase(a[++l]);\n        if(i-l>ans)ans=i-l,tot=1,L[1]=l+1,R[1]=i;\n        else if(i-l==ans)L[++tot]=l+1,R[tot]=i;\n    }\n    out<<ans<<\" \"<<tot<<ln;\n    Fur(i,1,tot)\n        out<<L[i]<<\" \"<<R[i]<<ln;\n}\n\n```\n", "link": "/posts/LG CF6E Exposition/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3607 [USACO17JAN]Subsequence-Reversal\u5e8f\u5217\u53cd\u8f6c", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3607&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3607\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u53cd\u8f6c\u5b50\u5e8f\u5217\u76f8\u5f53\u4e8e\u591a\u6b21\u4ea4\u6362\u5b50\u533a\u95f4\u7684\u4e24\u7aef\n\n\u8bbe$f[l][r][d][u]$\u4e3a\u533a\u95f4$[l,r]$,\u503c\u57df\u4e3a$[d,u]$\n\n$$\nf[l][r][d][u]=max(\n\\\\\\\\ f[l][r][d+1][u],\n\\\\\\\\ f[l][r][d][u-1],\n\\\\\\\\ f[l+1][r][d][u]+(a[l]==d),\n\\\\\\\\ f[l][r-1][d][u]+(a[r]==u),\n\\\\\\\\ f[l+1][r-1][d][u]+(a[r]==d)+(a[l]==u))(\\text{\u53cd\u8f6c})$$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 53\nint n,a[N],f[N][N][N][N];\nint main(){\n    in(n);\n    Fur(i,1,n){\n        in(a[i]);\n        Fur(d,1,a[i])\n            Fur(u,a[i],50)\n            f[i][i][d][u]=1;\n    }\n    Fur(i,2,n)\n        Fur(l,1,n-i+1){\n            int r=l+i-1;\n            Fur(j,1,50)\n            Fur(d,1,50-j+1){\n                int u=d+j-1,&v=f[l][r][d][u];\n                v=MAX(f[l][r][d+1][u],f[l][r][d][u-1]);\n                v=MAX(v,f[l+1][r][d][u]+(a[l]==d));\n                v=MAX(v,f[l][r-1][d][u]+(a[r]==u));\n                v=MAX(v,f[l+1][r-1][d][u]+(a[r]==d)+(a[l]==u));\n            }\n        }\n    printf(\"%d\\n\",f[1][n][1][50]);\n}\n```\n", "link": "/posts/LG 3607 [USACO17JAN]Subsequence-Reversal\u5e8f\u5217\u53cd\u8f6c/", "tags": ["\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1515 \u660e\u8fa8\u662f\u975e", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,f[N];\nset<int>T[N];\nvoid gf(int x){\n\n}\nvoid mg(int x,int y){\n    \n}\nint main(){\n    \n}\n```\n", "link": "/posts/51nod 1515 \u660e\u8fa8\u662f\u975e/", "tags": ["\u5e76\u67e5\u96c6", "set"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3246 [HNOI2016]\u5e8f\u5217", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3246&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3246\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$[l,r]$\u4e4b\u95f4\u6700\u5c0f\u503c\u4f4d\u7f6e\u4e3a$p$,\u539f\u6570\u7ec4\u4e3a$a$\n\n\u90a3\u4e48\u5de6\u7aef\u70b9\u5728$[l,p]$,\u53f3\u7aef\u70b9\u5728$[p,r]$\u7684\u533a\u95f4\u7684\u6700\u5c0f\u503c\u90fd\u662f$a[p]$\n\n\u90a3\u4e48\u8fd9\u90e8\u5206\u7684\u8d21\u732e\u4e3a$a[p] \\times (p-l+1) \\times (r-p+1)$\n\n\u63a5\u4e0b\u6765\u8fd8\u6709$[l,p-1],[p+1,r]$\u6ca1\u6709\u5904\u7406\n\n\n\u8bbe$pre_i$\u4e3a$i$\u524d\u7b2c\u4e00\u4e2a\u6bd4$a[i]$\u5c0f\u7684\u6570\u7684\u4f4d\u7f6e(\u7528\u5355\u8c03\u6808\u7b5b\u51fa)\n\n\u5b58\u5728$x$,\u6ee1\u8db3$pre_x=p$\n\n\u8bbe$f[l][r]$\u8868\u793a\u4ee5$r$\u4e3a\u53f3\u7aef\u70b9,\u5de6\u7aef\u70b9\u5728$[l,r]$\u7684\u533a\u95f4\u7684\u7b54\u6848\n\n\u90a3\u4e48$f[l][r]=f[l][pre_r]+a_r\\times(r-pre_r)$\n\n\u56e0\u4e3a$f$\u7684\u53d8\u5316\u53ea\u4e0e$r$\u6709\u5173,\u6240\u4ee5\u53ef\u4ee5\u5220\u6389\u4e00\u7ef4\n\n\u90a3\u4e48$f_r= a_r \\times (r-pre_r) +f_{pre_r}$\n\n\u6240\u4ee5$[p+1,r]$\u7684\u7b54\u6848\u5c31\u662f$f_r-f_{p-1}$\n\n$[l,p-1]$\u6c42\u6cd5\u7c7b\u4f3c\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t//#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,m,f[18][N],a[N],pre[N],sta[N],tp=0,suf[N];\nll fl[N],fr[N],gl[N],gr[N];\n#define cmp(x,y) ((a[x]<a[y])?x:y)\nvoid st(){\n\tFur(k,1,17)\n        Fur(i,1,n)\n        f[k][i]=cmp(f[k-1][i],f[k-1][i+(1<<(k-1))]);\n}\nint ask(int l,int r){\n    int k=l2(r-l+1);\n    return cmp(f[k][l],f[k][r-(1<<k)+1]);\n}\nint main(){\n    in>>n>>m;\n    Fur(i,1,n)in>>a[i],f[0][i]=i;\n\tst();\n    Fur(i,1,n){\n\t\twhile(tp&&a[sta[tp]]>a[i])suf[sta[tp--]]=i;\n\t\tpre[i]=sta[tp];\n\t\tsta[++tp]=i;\n\t}\n\twhile(tp)pre[sta[tp]]=sta[tp-1],suf[sta[tp--]]=n+1;\n\tFur(i,1,n)fr[i]=fr[pre[i]]+1ll*a[i]*(i-pre[i]),gr[i]=gr[i-1]+fr[i];\n\tFdr(i,n,1)fl[i]=fl[suf[i]]+1ll*a[i]*(suf[i]-i),gl[i]=gl[i+1]+fl[i];\n\t\n\tint l,r,p;\n    while(m--){\n        in>>l>>r;\n\t\tp=ask(l,r);\n\t\tout<<(ll)(gr[r]-gr[p]-1ll*fr[p]*(r-p)+1ll*a[p]*(p-l+1)*(r-p+1)+gl[l]-gl[p]-1ll*fl[p]*(p-l))<<ln;\n    }\n}\n```\n", "link": "/posts/LG 3246 [HNOI2016]\u5e8f\u5217/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4859 \u5df2\u7ecf\u6ca1\u6709\u4ec0\u4e48\u597d\u5bb3\u6015\u7684\u4e86", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4859&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4859\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u5c06$b$\u6570\u7ec4\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\n\n\u8bbe\u9009\u4e2d\u4e86$x$\u5bf9$a > b$,\u7531\u603b\u5bf9\u6570\u4e3a$n$,\u7531$x-(n-x)=k$,\u53ef\u4ee5\u77e5\u9053$x=\\frac{n+k}2$\n\n\u6211\u4eec\u8bbe$f(i,j)$\u4e3a\u524d$i$\u4e2a$a$\u4e2d\u9009\u4e2d\u4e86$j$\u7ec4$a > b$\u7684\u65b9\u6848\u6570\n\n\u90a3\u4e48$f(i,j)=f(i-1,j)+f(i-1,j-1)\\times(l_i-j+1)$\n\n($l_i$\u8868\u793a$b$\u4e2d\u5c0f\u4e8e$a_i$\u7684\u6700\u540e\u4e00\u4e2a\u4f4d\u7f6e)\n\n\u4f46\u662f\u8fd8\u6709\u5269\u4e0b\u7684$n-x$\u5bf9\n\n\u6211\u4eec\u53ef\u4ee5\u8bbe$g_i$\u8868\u793a$a>b$\u5bf9\u6570$\\ge i$\u7684\u65b9\u6848\u6570\n\n\u90a3\u4e48$g_i = f(n,i) \\times (n-i)!$(\u76f8\u5f53\u4e8e\u5269\u4e0b\u7684\u968f\u4fbf\u6392\u5217\u7ec4\u5408)\n\n\u6211\u4eec\u8bbe$f_i$\u8868\u793a$a>b$\u5bf9\u6570\u6070\u597d\u4e3a$i$\u5bf9\u7684\u65b9\u6848\u6570\n\n\u90a3\u4e48$g_k = \\sum_{i=k}^n f_i \\times {i\\choose k}$\n (\u76f8\u5f53\u4e8e\u4ece\u6070\u597d$i$\u4e2a\u65b9\u6848\u4e2d\u9009$k$\u5bf9\u51fa\u6765)\n\n\u7ecf\u8fc7\u4e8c\u9879\u5f0f\u53cd\u6f14\u53ef\u4ee5\u77e5\u9053:\n\n$f(k)=\\sum_{i=k}^n(-1)^{i-k}{i\\choose k}g(i)$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 4011\nconst int mod = 1000000009;\nint n,k,f[N][N],a[N],b[N],l[N],fac[N],inv[N],g[N];\nil int pw(int x,int p){\n    int ans=1;\n    while(p){\n        if(p&1)ans=1ll*ans*x%mod;\n        p>>=1;x=1ll*x*x%mod;\n    }\n    return ans;\n}\nint C(int a,int b){\n    return 1ll*fac[a]*inv[b]%mod*inv[a-b]%mod;\n}\nsigned main(){\n    in(n,k);\n    if((n+k)&1){puts(\"0\");return 0;};\n    k=(n+k)>>1;\n    Fur(i,1,n)in(a[i]);\n    Fur(i,1,n)in(b[i]);\n    fac[0]=inv[0]=1;\n    Fur(i,1,n)fac[i]=1ll*fac[i-1]*i%mod;\n    inv[n]=pw(fac[n],mod-2);\n    Fdr(i,n-1,0)inv[i]=1ll*inv[i+1]*(i+1)%mod;\n    sort(a+1,a+n+1);\n    sort(b+1,b+n+1);\n    int p=0;\n    Fur(i,1,n){\n        while(p<n&&b[p+1]<a[i])++p;\n        l[i]=p;\n    }\n    f[0][0]=1;\n    Fur(i,1,n){\n        f[i][0]=1;\n        Fur(j,1,i)\n            f[i][j]=(f[i-1][j]+1ll*f[i-1][j-1]*MAX(0,l[i]-j+1)%mod)%mod;\n    }\n    Fur(i,0,n)g[i]=1ll*f[n][i]*fac[n-i]%mod;\n    int ans=0;\n    Fur(i,k,n)\n        if((i-k)&1)ans=(ans-1ll*C(i,k)*g[i]%mod+mod)%mod;\n        else ans=(ans+1ll*C(i,k)*g[i]%mod)%mod;\n    \n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 4859 \u5df2\u7ecf\u6ca1\u6709\u4ec0\u4e48\u597d\u5bb3\u6015\u7684\u4e86/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u5bb9\u65a5"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4555 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u6700\u957f\u53cc\u56de\u6587\u4e32", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4555&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4555\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u849f\u84bb\u61d2\u5f97\u5b66\u9a6c\u62c9\u8f66,\u4e8e\u662f\u5c31\u7528hash\u5199\u4e86\u3002\n\n\u9884\u5904\u7406\u51fa\u6bcf\u4e2a\u70b9\u4f5c\u4e3a\u56de\u6587\u4e32\u7684\u5de6\u7aef\u70b9\u548c\u53f3\u7aef\u70b9\u65f6\u56de\u6587\u4e32\u6700\u957f\u4e3a\u591a\u5c11\n\n\u7136\u540e\u679a\u4e3e\u65ad\u70b9,\u7edf\u8ba1\u7b54\u6848\u5c31\u53ef\u4ee5\u4e86\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nchar s[N];\null h1[N],h2[N],p[N];\nint n,ans=0;\nint L[N],R[N];\null gh1(int l,int r){\n    return h1[r]-h1[l-1]*p[r-l+1];\n}\null gh2(int l,int r){\n    return h2[l]-h2[r+1]*p[r-l+1];\n}\nvoid a1(int x){\n    int l=1,r=MIN(x,n-x);\n    while(l<=r){\n        int m=(l+r)>>1;\n        if(gh1(x-m,x+m)==gh2(x-m,x+m))\n            l=m+1;\n        else r=m-1;\n    }\n    L[x+r]=MAX(L[x+r],r*2+1);\n    R[x-r]=MAX(R[x-r],r*2+1);\n}\nvoid a2(int x){\n    int l=1,r=MIN(x,n-x);\n    while(l<=r){\n        int m=(l+r)>>1;\n        if(gh1(x-m+1,x+m)==gh2(x-m+1,x+m))\n            l=m+1;\n        else r=m-1;\n    }\n    L[x+r]=MAX(L[x+r],r*2);\n    R[x-r+1]=MAX(R[x-r+1],r*2);\n}\n#define base 233\nint main(){\n    in>>(s+1);\n    p[0]=1;\n    n=strlen(s+1);\n    Fur(i,1,n){\n        L[i]=R[i]=1;\n        h1[i]=h1[i-1]*base+s[i];\n        p[i]=p[i-1]*base;\n    }\n    Fdr(i,n,1)\n        h2[i]=h2[i+1]*base+s[i];\n    \n    Fur(i,1,n)a1(i),a2(i);\n\n    Fur(i,1,n)R[i]=MAX(R[i],R[i-1]-2);\n    Fdr(i,n,1)L[i]=MAX(L[i],L[i+1]-2);\n\n    Fur(i,1,n-1)ans=MAX(ans,L[i]+R[i+1]);\n    out<<ans<<ln;\n}\n\n```\n", "link": "/posts/LG 4555 [\u56fd\u5bb6\u96c6\u8bad\u961f]\u6700\u957f\u53cc\u56de\u6587\u4e32/", "tags": ["\u9a6c\u62c9\u8f66", "hash"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF891C Envy", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF891C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF891C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5173\u4e8e\u540c\u4e00\u5f20\u56fe\u4e0a\u7684\u6700\u5c0f\u751f\u6210\u6811,\u6709\u4e00\u4e9b\u6027\u8d28\uff1a\n\n\u5bf9\u4e8e\u4efb\u610f\u6743\u503c\u7684\u8fb9,\u6240\u6709\u6700\u5c0f\u751f\u6210\u6811\u4e2d\u8fd9\u4e2a\u6743\u503c\u7684\u8fb9\u7684\u6570\u91cf\u662f\u4e00\u5b9a\u7684\n\n\u5bf9\u4e8e\u4efb\u610f\u6b63\u786e\u52a0\u8fb9\u65b9\u6848,\u52a0\u5b8c\u5c0f\u4e8e\u67d0\u6743\u503c\u7684\u6240\u6709\u8fb9\u540e\u56fe\u7684\u8fde\u901a\u6027\u662f\u4e00\u6837\u7684\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500011\nint n,m,q;\nstruct link{\n    int x,y,w,id,bx,by;\n}E[N],tmp[N];\nbool cmp(link x,link y){return x.w<y.w;}\nbool CMP(link x,link y){return x.id<y.id;}\nint f[N];\nint gf(int x){return (x==f[x])?x:(f[x]=gf(f[x]));}\nil void mg(int x,int y){f[gf(y)]=gf(x);}\nint cnt[N];\nint main(){\n    in(n,m);\n    int x,y,w;\n    Fur(i,1,m){\n        in(x,y,w);\n        E[i]=link{x,y,w,i,0,0};\n    }\n    sort(E+1,E+m+1,cmp);\n    Fur(i,1,n)f[i]=i;\n    E[0].w=-1;\n    for(int i=1;i<=m;){\n        int j=i;\n        do{\n            E[j].bx=gf(E[j].x);\n            E[j].by=gf(E[j].y);\n            ++j;\n        }while(j<=m&&E[j].w==E[j-1].w);\n        while(i<j){\n            while(gf(E[i].x)==gf(E[i].y)&&i<j)++i;\n            if(i<j)mg(E[i].x,E[i].y);\n        }\n    }\n    sort(E+1,E+m+1,CMP);\n    in(q);\n    Fur(i,1,n)f[i]=i;\n    while(q--){\n        bool ff=1;\n        int t;in(t);\n        Fur(i,1,t){\n            in(x);\n            tmp[i]=E[x];\n        }\n        sort(tmp+1,tmp+t+1,cmp);\n        int tot=0;\n        Fur(i,1,t){\n            x=tmp[i].bx,y=tmp[i].by;\n            if(x==y){ff=0;break;}\n            mg(x,y);\n            int j=i+1;\n            while(j<=t&&tmp[j].w==tmp[i].w){\n                if(gf(tmp[j].bx)==gf(tmp[j].by)){ff=0;break;}\n                mg(tmp[j].bx,tmp[j].by);++j;\n            }\n            while(i<j)f[tmp[i].bx]=tmp[i].bx,f[tmp[i].by]=tmp[i].by,++i;\n        }\n        if(ff)out(\"YES\\n\");\n        else out(\"NO\\n\");\n    }\n    flush();\n}\n```\n", "link": "/posts/LG CF891C Envy/", "tags": ["kruskal"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1025D Recovering-BST", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1025D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1025D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u597d\u9898\n\n\u601d\u8def\u5f88\u5999\n\n$L[i][j]$\u8868\u793a\u533a\u95f4$[i,j-1]$\u4f5c\u4e3a$j$\u7684\u5de6\u513f\u5b50\u662f\u5426\u5408\u6cd5\n\n$R[i][j]$\u8868\u793a\u533a\u95f4$[i+1,j]$\u4f5c\u4e3a$i$\u7684\u53f3\u513f\u5b50\u662f\u5426\u5408\u6cd5\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 711\nint n,a[N];\nbool g[N][N],L[N][N],R[N][N];\nint main(){\n    in(n);\n    Fur(i,1,n)in(a[i]);\n    Fur(i,1,n)\n        Fur(j,i,n)if(GCD(a[i],a[j])>1)g[i][j]=g[j][i]=1;\n\n    Fur(i,1,n)L[i][i]=R[i][i]=1;\n    Fur(i,1,n-1)\n        Fur(l,1,n-i+1){\n            int r=l+i-1;\n            Fur(p,l,r)\n            if(L[l][p]&&R[p][r]){\n                if(g[l-1][p])R[l-1][r]=1;\n                if(g[p][r+1])L[l][r+1]=1;\n            }\n        }\n\n    Fur(i,1,n)\n        if(L[1][i]&&R[i][n])return puts(\"Yes\"),0;\n    \n    puts(\"No\");\n}\n```\n", "link": "/posts/LG CF1025D Recovering-BST/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u533a\u95f4dp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5122 [USACO18DEC]Fine-Dining", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5122&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5122\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u601d\u8def\u5f88\u5999\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u6c42\u51fa$n$\u5230\u6bcf\u4e2a\u70b9\u7684\u8ddd\u79bb\n\n\u5982\u679c\u76f4\u63a5\u679a\u4e3e$k$\u4e2a\u5e72\u8349\u5806,\u7136\u540e\u5224\u65ad\u6bcf\u4e2a\u70b9\u662f\u5426\u53ef\u884c,$\\Theta(nk)$\u7684\u590d\u6742\u5ea6\u663e\u7136TLE\n\n\u56e0\u4e3a\u4e00\u5b9a\u8981\u7ecf\u8fc7\u5e72\u8349\u5806,\u6240\u4ee5\u53ef\u4ee5\u65b0\u5efa\u4e00\u4e2a\u8282\u70b9$n+1$,\u5411\u6240\u6709\u5e72\u8349\u5806\u8fde\u5355\u5411\u8fb9(\u8fb9\u6743\u4e3a\u8fd9\u4e2a\u5e72\u8349\u5806\u7684\u5f71\u54cd)\n\n\u5728\u4ece$n+1$\u8dd1\u4e00\u904d\u6700\u77ed\u8def\u5c31\u53ef\u4ee5\u4e86\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 50011\n#define int ll\nint n,m,k,head[N],cnt=0;\nstruct edge{\n    int to,nxt,w;\n}e[300011];\nil void add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n    e[cnt].w=w;\n}\nint d[N],s[N];\nstruct cmp{\n    bool operator()(int x,int y){return d[x]>d[y];}\n};\npriority_queue<int,vector<int>,cmp>q;\nbool v[N];\nvoid dij(int st){\n    Fur(i,1,n+1)d[i]=(1ll<<50);\n    d[st]=0;q.push(st);\n    while(!q.empty()){\n        int x=q.top();q.pop();\n        v[x]=0;\n        fl(i,x)if(d[x]+e[i].w<d[to]){\n            d[to]=d[x]+e[i].w;\n            if(!v[to])q.push(to),v[to]=1;\n        }\n    }\n}\nsigned main(){\n    in(n,m,k);\n    int x,y,w;\n    Fur(i,1,m)in(x,y,w),add(x,y,w),add(y,x,w);\n    dij(n);cpy(s,d);\n    Fur(i,1,k){\n        in(x,w);\n        add(n+1,x,s[x]-w);\n    }\n    dij(n+1);\n    Fur(i,1,n-1)if(d[i]<=s[i])out(1,ln);\n    else out(0,ln);\n    flush();\n}\n```\n", "link": "/posts/LG 5122 [USACO18DEC]Fine-Dining/", "tags": ["\u6700\u77ed\u8def"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4799 [CEOI2015 Day2]\u4e16\u754c\u51b0\u7403\u9526\u6807\u8d5b", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4799&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4799\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n;\nint main(){\n    \n}\n```\n", "link": "/posts/LG 4799 [CEOI2015 Day2]\u4e16\u754c\u51b0\u7403\u9526\u6807\u8d5b/", "tags": ["\u6298\u534a\u641c\u7d22"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF160D Edges in MST", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF160D&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF160D\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 400011\n#define int ll\nstruct edge{\n    int to,nxt,w;\n}e[N*2];\nint n,m,cnt=0,head[N],B=0,sz=0;\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint fa[N];\nstruct node{\n    int x,y,w,id;\n    bool v=0;\n}E[N];\nbool cmp(node x,node y){\n    return x.w<y.w;\n}\nbool CMP(node x,node y){\n    return x.id<y.id;\n}\nint gf(int x){return (fa[x]==x)?x:(fa[x]=gf(fa[x]));}\nvoid kru(){\n    Fur(i,1,n)fa[i]=i;\n    sort(E+1,E+m+1,cmp);\n    int x,y,w;\n    Fur(i,1,m){\n        x=E[i].x,y=E[i].y,w=E[i].w;\n        if(gf(x)!=gf(y)){\n            E[i].v=1;\n            fa[fa[x]]=fa[y];\n            add(x,y,w);add(y,x,w);\n            B+=w;\n        }\n    }\n    sort(E+1,E+m+1,CMP);\n}\nint top[N],siz[N],f[N],v[N],s[N<<2],id[N],d[N],a[N];\nvoid dfs(int x){\n    siz[x]=1;id[x]=++sz;a[id[x]]=v[x];\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;v[to]=e[i].w;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\n#define ls rt<<1\n#define rs rt<<1|1\nvoid build(int l,int r,int rt){\n    if(l==r){\n        s[rt]=a[l];\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);\n    build(m+1,r,rs);\n    s[rt]=MAX(s[ls],s[rs]);\n}\nint ask(int L,int R,int l=1,int r=n,int rt=1){\n    if(L<=l&&r<=R)return s[rt];\n    int m=(l+r)>>1,ans=0;\n    if(L<=m)ans=ask(L,R,l,m,ls);\n    if(R>m)ans=MAX(ans,ask(L,R,m+1,r,rs));\n    return ans;\n}\nint fh(int x,int y){\n    int ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans=MAX(ans,ask(id[top[x]],id[x]));x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    return MAX(ans,ask(id[x]+1,id[y]));\n}\nsigned main(){\n    fin(\"in\");\n    in>>n>>m;\n    int x,y;\n    Fur(i,1,m)in>>E[i].x>>E[i].y>>E[i].w,E[i].id=i;\n    kru();\n    dfs(1);\n    bt(1,1);\n    build(1,n,1);\n    Fur(i,1,m)\n        if(E[i].v)out<<B<<ln;\n        else out<<(ll)B+E[i].w-fh(E[i].x,E[i].y)<<ln;\n}\n```\n", "link": "/posts/LG CF160D Edges in MST/", "tags": ["\u6811\u94fe\u5256\u5206", "\u6700\u5c0f\u751f\u6210\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4053 [JSOI2007]\u5efa\u7b51\u62a2\u4fee", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4053&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4053\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u7b97\u6cd5\uff1a\u8d2a\u5fc3+\u5806\u7ef4\u62a4\n\n\u8d2a\u5fc3\u7b56\u7565\uff1a\n\n\u6211\u4eec\u8003\u8651\u5148\u6309$t$\u8d2a\u5fc3,\u4e2d\u9014\u518d\u66f4\u6539\u3002\n\u6309$t$\u4ece\u5c0f\u5230\u5927\u6392\u5e8f\u4e4b\u540e,\u5f00\u59cb\u8f6e\u6d41\u904d\u5386\u6bcf\u4e2a\u5efa\u7b51\u3002\n\u5982\u679c\u4e2d\u9014\u67d0\u4e2a\u5efa\u7b51$i$\u65e0\u6cd5\u5728$t_it$\u7684\u65f6\u95f4\u5185\u4fee\u590d,\u90a3\u4e48\u5728\u5148\u524d\u9009\u62e9\u4fee\u590d\u7684\u5efa\u7b51\u4e2d\u62ff\u51fa$a_j$\u6700\u5927\u7684$j$\u53f7\u5efa\u7b51\u3002\u82e5$a_i < a_j$,\u5219\u653e\u5f03$j$\u8f6c\u800c\u4fee$i$\n\n\u7b56\u7565\u8bc1\u660e:\n\n\u82e5\u7b2c$i$\u53f7\u51fa\u73b0\u65f6\u95f4\u4e0d\u8db3,\u90a3\u4e48\u524d$i$\u4e2a\u5efa\u7b51\u4e2d\u6700\u591a\u4fee\u590d$i-1$\u4e2a\u5efa\u7b51\n\u5219\u6211\u4eec\u5fc5\u7136\u9009\u62e9$a_i$\u8f83\u5c0f\u7684\u524d$i-1$\u4e2a\u5efa\u7b51,\u7ed9\u540e\u9762\u7684\u4fee\u590d\u7559\u4e0b\u66f4\u591a\u7684\u65f6\u95f4\n\u5b9e\u73b0\u65b9\u6cd5:\n\n\u4f7f\u7528\u5806\u6765\u7ef4\u62a4\u9009\u62e9\u7684\u5efa\u7b51\u4e2d$a_i$\u6700\u5927\u7684\u3002\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 150011\nint n,ans=0;\nstruct node{\n    int t,a;\n}b[N];\nbool cmp(node x,node y){\n    return x.t<y.t;\n}\nbool v[N];\nint main(){\n    fin(\"in\");\n    in(n);\n    Fur(i,1,n)in(b[i].a,b[i].t);\n    sort(b+1,b+n+1,cmp);\n    int now=0;\n    priority_queue<int>q;\n    Fur(i,1,n)\n        if(now+b[i].a>b[i].t){\n            if(b[i].a<q.top()){\n                now-=q.top();q.pop();\n                q.push(b[i].a);\n                now+=b[i].a;\n            }\n        }\n        else{\n            q.push(b[i].a);\n            ++ans;\n            now+=b[i].a;\n        }\n    IO::out(ans,ln);\n    IO::flush();\n}\n```\n", "link": "/posts/LG 4053 [JSOI2007]\u5efa\u7b51\u62a2\u4fee/", "tags": ["\u8d2a\u5fc3", "\u5806"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF915F Imbalance Value of a Tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF915F&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF915F\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1000011\nint n,b[N],a[N],cnt=0,head[N];\nbool cmp(int x,int y){return a[x]>a[y];}\nbool cmp2(int x,int y){return a[x]<a[y];}\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint f[N],sz[N];\nint gf(int x){\n    return (x==f[x])?x:(f[x]=gf(f[x]));\n}\nbool v[N];\nint main(){\n    fin(\"in\");\n    in>>n;\n    Fur(i,1,n)in>>a[i],b[i]=i;\n    sort(b+1,b+n+1,cmp2);\n    int x,y;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    ll ans=0;\n    Fur(i,1,n)f[i]=i,sz[i]=1;\n    Fur(i,1,n){\n        x=b[i];v[x]=1;\n        int t=0;\n        fl(i,x)if(v[to]){\n            ans+=1ll*sz[x]*sz[gf(to)]*a[x];\n            sz[x]+=sz[gf(to)];\n            f[gf(to)]=x;\n        }\n    }\n    clr(v,0);\n    Fur(i,1,n)f[i]=i,sz[i]=1;\n    sort(b+1,b+n+1,cmp);\n    Fur(i,1,n){\n        x=b[i];v[x]=1;\n        int t=0;\n        fl(i,x)if(v[to]){\n            ans-=1ll*sz[x]*sz[gf(to)]*a[x];\n            sz[x]+=sz[gf(to)];\n            f[gf(to)]=x;\n        }\n    }\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG CF915F Imbalance Value of a Tree/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF739C Alyona and towers", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF739C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF739C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5047\u8bbe\u6211\u4eec\u5df2\u7ecf\u77e5\u9053\u533a\u95f4$[l,r]$\u5de6\u53f3\u8282\u70b9\u7684\u7b54\u6848\n\n\u8bb0\u5f55\uff1a\n\n```plain\nlv,rv:\u5de6\u53f3\u7aef\u70b9\u7684\u503c\ns: \u533a\u95f4\u7b54\u6848\nl:\u4ee5\u5de6\u7aef\u5f00\u59cb\u6700\u957f\u4e0b\u964d\nr:\u4ee5\u53f3\u7aef\u7ed3\u675f\u7684\u6700\u957f\u4e0a\u5347\nL:\u4ee5\u5de6\u7aef\u5f00\u59cb\u6700\u957f\u5148\u4e0a\u5347(\u518d\u4e0b\u964d)\nR:\u4ee5\u53f3\u7aef\u7ed3\u675f\u6700\u957f\u5148\u4e0a\u5347(\u518d\u4e0b\u964d)\n```\n\u7136\u540e\u8003\u8651\u6700\u9ad8\u70b9\u518d\u5de6\u8282\u70b9\u8fd8\u662f\u6709\u8282\u70b9\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 300011\n#define int ll\nint n,a[N];\nstruct node{\n    int l,r,lv,rv,s,L,R,len;\n    // lv,rv:\u5de6\u53f3\u7aef\u70b9\u7684\u503c\n    // s: \u533a\u95f4\u7b54\u6848\n    // l:\u4ee5\u5de6\u7aef\u5f00\u59cb\u6700\u957f\u4e0b\u964d\n    // r:\u4ee5\u53f3\u7aef\u7ed3\u675f\u7684\u6700\u957f\u4e0a\u5347\n    // L:\u4ee5\u5de6\u7aef\u5f00\u59cb\u6700\u957f\u5148\u4e0a\u5347(\u518d\u4e0b\u964d)\n    // R:\u4ee5\u53f3\u7aef\u7ed3\u675f\u6700\u957f\u5148\u4e0a\u5347(\u518d\u4e0b\u964d)\n}s[N<<2];\nint add[N<<2];\nnode operator + (node x,node y){\n    node c;\n    c.len=x.len+y.len;\n\n    c.lv=x.lv;c.rv=y.rv;\n\n    c.l=x.l;\n    if(x.l==x.len&&x.rv>y.lv)c.l+=y.l;\n\n    c.r=y.r;\n    if(y.r==y.len&&y.lv>x.rv)c.r+=x.r;\n\n    c.L=x.L;c.R=y.R;\n    if(x.L==x.len&&x.rv>y.lv)c.L+=y.l;\n    if(x.r==x.len&&x.rv<y.lv)c.L=MAX(c.L,x.r+y.L);\n\n    if(y.R==y.len&&y.lv>x.rv)c.R+=x.r;\n    if(y.l==y.len&&y.lv<x.rv)c.R=MAX(c.R,x.R+y.l);\n\n    c.s=MAX(x.s,y.s);\n\n    if(x.rv>y.lv)c.s=MAX(c.s,x.R+y.l);\n    if(y.lv>x.rv)c.s=MAX(c.s,y.L+x.r);\n        \n    return c;\n}\n#define ls rt<<1\n#define rs rt<<1|1\nvoid build(int l,int r,int rt){\n    if(l==r){\n        s[rt].lv=s[rt].rv=a[l];\n        s[rt].len=s[rt].l=s[rt].r=s[rt].s=s[rt].L=s[rt].R=1;\n        return;\n    }\n    int m=(l+r)>>1;\n    build(l,m,ls);build(m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nvoid pd(int rt){\n    if(add[rt]){\n        add[ls]+=add[rt];add[rs]+=add[rt];\n        s[ls].lv+=add[rt];\n        s[ls].rv+=add[rt];\n        s[rs].lv+=add[rt];\n        s[rs].rv+=add[rt];\n        add[rt]=0;\n    }\n}\nvoid upd(int L,int R,int v,int l,int r,int rt){\n    if(L<=l&&r<=R){\n        s[rt].lv+=v;s[rt].rv+=v;\n        add[rt]+=v;\n        return;\n    }\n    int m=(l+r)>>1;\n    pd(rt);\n    if(L<=m)upd(L,R,v,l,m,ls);\n    if(R>m)upd(L,R,v,m+1,r,rs);\n    s[rt]=s[ls]+s[rs];\n}\nsigned main(){\n    fin(\"in\");\n    in>>n;\n    Fur(i,1,n)in>>a[i];\n    build(1,n,1);\n    int q,l,r,v;\n    in>>q;\n    while(q--){\n        in>>l>>r>>v;\n        upd(l,r,v,1,n,1);\n        out<<s[1].s<<ln;\n    }\n}\n```\n", "link": "/posts/LG CF739C Alyona and towers/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2891 [USACO07OPEN]\u5403\u996dDining", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2891&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2891\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 2000011\nint n,F,D,m,st=N-1,ed=N-2,cnt=1;\nint head[N],d[N],q[N];\nstruct edge{int to,nxt,w;}e[N];\nvoid add(int x,int y,int w){\n    e[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n    e[++cnt].to=x;e[cnt].w=0;e[cnt].nxt=head[y];head[y]=cnt;\n}\nbool bfs(){\n    int h=0,t=1,x;\n    clr(d,0);d[q[h]=st]=1;\n    while(h<t){\n        x=q[h++];if(x==ed)return 1;\n        fl(i,x)if(e[i].w&&!d[to]){\n            d[to]=d[x]+1;\n            q[t++]=to;\n        }\n    }\n    return 0;\n}\nint dfs(int x,int mf){\n    if(x==ed)return mf;\n    int us=0,w;\n    fl(i,x)\n    if(e[i].w&&d[to]==d[x]+1){\n        w=dfs(to,MIN(mf-us,e[i].w));\n        e[i].w-=w;e[i^1].w+=w;\n        us+=w;\n        if(us==mf)return mf;\n    }\n    if(!us)d[x]=-1;\n    return us;\n}\nint main(){\n\tin>>n>>F>>D;\n\tFur(i,1,F)add(st,i,inf),add(i,i+F,1);\n\tFur(i,1,D)add(2*F+i,2*F+D+i,1),add(2*F+D+i,ed,inf);\n\tFur(i,1,n)add(2*(F+D)+i,2*(F+D)+n+i,1);\n\tFur(i,1,n){\n\t\tint x,a,b;\n\t\tin>>a>>b;\n\t\tFur(j,1,a)in>>x,add(x+F,2*(F+D)+i,1);\n\t\tFur(j,1,b)in>>x,add(2*(F+D)+n+i,2*F+x,1);\n\t}\n\tint ans=0;\n\twhile(bfs())ans+=dfs(st,inf);\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 2891 [USACO07OPEN]\u5403\u996dDining/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 2714 \u56db\u5143\u7ec4\u7edf\u8ba1", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5f00\u4e00\u4e2a\u6876$f$\u8bb0\u5f55\u6bcf\u4e2a\u6570\u51fa\u73b0\u6b21\u6570,\u7136\u540e$f[i]=\\sum_{i|d}f[d]$\n\n\u6c42\u51fa\u6240\u6709$i$\u7684\u500d\u6570\u53ef\u80fd\u7ec4\u6210\u7684\u56db\u5143\u7ec4,\u8fd9\u65f6$\\gcd$\u4e00\u5b9a\u662f$i,2i,3i,\\cdots$,\u7136\u540e\u51cf\u53bb$\\gcd$\u662f$2i,3i,\\cdots$\u7684\u56db\u5143\u7ec4\u4e2a\u6570\u3002\u5373$f[i]={cnt\\choose 4}-\\sum_{i|d,i\\neq d}f[d]$\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10001\n#define M 10000\n#define int ll\nint n,f[N];\nsigned main(){\n\tfin(\"in\");\nwhile(1){\n\tin>>n;\n\tif(in._)break;\n\tint x;\n\tclr(f,0);\n\tFur(i,1,n)in>>x,f[x]++;\n\tFur(i,1,M)\n\t\tfor(int j=i*2;j<=M;j+=i)\n\t\t\tf[i]+=f[j];\n\t\n\tFdr(i,M,1){\n\t\tf[i]=f[i]*(f[i]-1)*(f[i]-2)*(f[i]-3)/24;\n\t\tfor(int j=i*2;j<=M;j+=i)f[i]-=f[j];\n\t}\n\tout<<f[1]<<ln;\n}\n}\n\n```\n", "link": "/posts/51nod 2714 \u56db\u5143\u7ec4\u7edf\u8ba1/", "tags": ["\u6570\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2938 [USACO09FEB]\u80a1\u7968\u5e02\u573aStock-Market", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2938&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2938\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u4fdd\u8bc1\u8fd9\u4e2a\u6570\u4e0d\u4f1a\u8d85\u8fc7$500000$\n\n\u90a3\u4e48\u5c31\u662f\u80cc\u5305\u4e86\n\n\u4e70\u5356\u80a1\u7968\u67093\u79cd\u65b9\u6cd5:\n\n1. \u4e70,\u7b2c\u4e8c\u5929\u5356\u4e86\n   \n2. \u4e0d\u4e70(\u76f8\u5f53\u4e8e\u4e70\u4e86\u7136\u540e\u5356\u4e86)\n   \n3. \u4e70\u4e86,\u8fc7\u51e0\u5929\u518d\u5356(\u76f8\u5f53\u4e8e\u4e70\u4e86\u4e86,\u63a5\u4e0b\u6765\u5356\u4e86\u518d\u4e70\u4e86)\n\n\u8dd1$d-1$\u6b21\u80cc\u5305\u5373\u53ef\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 500011\nint n,m,V,a[51][51],f[N];\nint main(){\n    in(n,m,V);\n    Fur(i,1,n)\n        Fur(j,1,m)\n        in(a[i][j]);\n    int ans=V,mx;\n    Fur(i,2,m){\n        mx=0;\n        clr(f,0);\n        Fur(j,1,n)\n            Fur(k,a[j][i-1],ans){\n                f[k]=MAX(f[k],f[k-a[j][i-1]]+a[j][i]-a[j][i-1]);\n                mx=MAX(mx,f[k]);\n            }\n        ans+=mx;\n    }\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/LG 2938 [USACO09FEB]\u80a1\u7968\u5e02\u573aStock-Market/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u80cc\u5305"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG SP7586 NUMOFPAL - Number of Palindromes", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/SP7586&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/SP7586\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5de6\u53f3\u90fd$hash$\u4e00\u904d\n\n\u7136\u540e\u4e8c\u5206\u6bcf\u4e2a\u4f4d\u7f6e\u53ef\u4ee5\u7ec4\u6210\u56de\u6587\u4e32\u7684\u957f\u5ea6(\u5224\u65ad\u5947\u6570\u548c\u5076\u6570\u957f\u5ea6)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1001\nchar s[N];\null h1[N],h2[N],p[N],ans=0;\nint n;\null gh1(int l,int r){\n\treturn h1[r]-h1[l-1]*p[r-l+1];\n}\null gh2(int l,int r){\n\treturn h2[l]-h2[r+1]*p[r-l+1];\n}\null a1(int x){\n\tint l=1,r=MIN(x,n-x);\n\twhile(l<=r){\n\t\tint m=(l+r)>>1;\n\t\tif(gh1(x-m,x+m)==gh2(x-m,x+m))\n\t\t\tl=m+1;\n\t\telse r=m-1;\n\t}\n\treturn r;\n}\null a2(int x){\n\tint l=1,r=MIN(x,n-x);\n\twhile(l<=r){\n\t\tint m=(l+r)>>1;\n\t\tif(gh1(x-m+1,x+m)==gh2(x-m+1,x+m))\n\t\t\tl=m+1;\n\t\telse r=m-1;\n\t}\n\treturn r;\n}\n#define base 233\nint main(){\n\tin>>(s+1);\n\tp[0]=1;\n\tn=strlen(s+1);\n\tFur(i,1,n){\n\t\th1[i]=h1[i-1]*base+s[i];\n\t\tp[i]=p[i-1]*base;\n\t}\n\tFdr(i,n,1)\n\t\th2[i]=h2[i+1]*base+s[i];\n\t\t\n\tFur(i,1,n)ans+=a1(i)+a2(i);\n\tout<<ans+n<<ln;\n}\n\n```\n", "link": "/posts/LG SP7586 NUMOFPAL - Number of Palindromes/", "tags": ["hash", "\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG UVA10308 Roads-in-the-North", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/UVA10308&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/UVA10308\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6c42\u6811\u7684\u76f4\u5f84\n\n\u8bfb\u5165\u6bd2\u7624\n\n\u81ea\u5df1\u63a2\u7d22\u5427(\u4e0d\u6000\u597d\u610f\n\n(tips:getline,ssstream)\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\n#define N 20000011\nstruct edge{\n\tint nxt,to,w;\n}e[N*2];\nint d[N],head[N],q[N],f[N],n,k=0,cnt=0;\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].w=w;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid bfs(int x){\n\tint h=0,t=1;\n\tq[h]=x;\n\tclr(d,0);clr(f,0);\n\twhile(h<t){\n\t\tint x=q[h++];\n\t\tif(d[k]<d[x])k=x;\n\t\tfl(i,x)if(to!=f[x]){\n\t\t\tf[to]=x;d[to]=d[x]+e[i].w;\n\t\t\tq[t++]=to;\n\t\t}\n\t}\n}\nint main(){\n\tint x,y,w;\n\tfcin;\n\tstring s;\n\tstringstream ss;\n\twhile(getline(cin,s)){\n\t\tcnt=0;clr(head,0);\n\t\tss.clear();\n\t\tss.str(s);\n\t\twhile(ss>>x>>y>>w){\n\t\t\tadd(x,y,w);add(y,x,w);\n\t\t\tgetline(cin,s);\n\t\t\tss.clear();\n\t\t\tss.str(s);\n\t\t}\n\t\tbfs(1);\n\t\tbfs(k);\n\t\tcout<<d[k]<<endl;\n\t}\n}\n```\n", "link": "/posts/LG UVA10308 Roads-in-the-North/", "tags": ["\u6811\u7684\u76f4\u5f84"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF1042C Array Product", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF1042C&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF1042C\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5148\u628a\u6240\u67090\u5408\u62101\u4e2a,\u6240\u6709\u6b63\u6570\u5408\u6210\u4e00\u4e2a,\u628a\u8d1f\u6570(\u9664\u4e86\u6700\u5927\u7684\u90a3\u4e2a\u8d1f\u6570\u4e4b\u5916\u7684(\u5982\u679c\u8d1f\u6570\u4e2a\u6570\u4e3a\u5947\u6570)))\u5408\u6210\u4e00\u4e2a\n\n1.\u5982\u679c\u5168\u662f0\n\n2.\u6ca1\u67090\n\n3.\u6ca1\u6709\u8d1f\u6570\n\n4.\u6ca1\u6709\u6b63\u6570\n<!-- more -->\n\n```cpp\n#include <algorithm>\n#include <iostream>\n#include <cstring>\n#include <cstdio>\n#include <cmath>\nusing namespace std;\nint cnt,cnt1,cnt2,n,x;\nstruct ahah\n{\n    int x,pos;\n} a[200006],b[200006],c[200006];\nbool cmp(ahah a,ahah b){ return abs(a.x)<abs(b.x); }\nint main()\n{\n    scanf(\"%d\",&n);\n    for(int i=1; i<=n; i++)\n    {\n        scanf(\"%d\",&x);\n        if(x==0)c[++cnt].pos=i;\n        if(x<0)a[++cnt1].x=x,a[cnt1].pos=i;\n        if(x>0)b[++cnt2].x=x,b[cnt2].pos=i;\n    }\n    sort(a+1,a+1+cnt1,cmp);\n    sort(b+1,b+1+cnt2,cmp);\n    int v=-1;\n    if(cnt!=0)\n    {\n        v=c[1].pos;\n        for(int i=2; i<=cnt; i++)\n        {\n            printf(\"1 %d %d\\n\",v,c[i].pos);\n            v=c[i].pos;\n        }\n    }\n    if(cnt==n)return 0;\n    if(cnt1%2==0)\n    {\n        if(v!=-1)printf(\"2 %d\\n\",v),v=-1;\n        if(cnt1!=0)\n        {\n            if(v==-1)v=a[1].pos;\n            else printf(\"1 %d %d\\n\",v,a[1].pos),v=a[1].pos;\n            for(int i=2; i<=cnt1; i++)\n            {\n                printf(\"1 %d %d\\n\",v,a[i].pos);\n                v=a[i].pos;\n            }\n        }\n        if(cnt2!=0)\n        {\n            if(v==-1)v=b[1].pos;\n            else printf(\"1 %d %d\\n\",v,b[1].pos),v=b[1].pos;\n            for(int i=2; i<=cnt2; i++)\n            {\n                printf(\"1 %d %d\\n\",v,b[i].pos);\n                v=b[i].pos;\n            }\n        }\n    }\n    else\n    {\n        if(v==-1)v=a[1].pos;\n        else printf(\"1 %d %d\\n\",v,a[1].pos),v=a[1].pos;\n        if(cnt+1!=n)printf(\"2 %d\\n\",v),v=-1;\n        else return 0;\n        if(cnt1>1)\n        {\n            v=a[2].pos;\n            for(int i=3; i<=cnt1; i++)\n            {\n                printf(\"1 %d %d\\n\",v,a[i].pos);\n                v=a[i].pos;\n            }\n        }\n        if(cnt2>0)\n        {\n            if(v==-1)v=b[1].pos;\n            else printf(\"1 %d %d\\n\",v,b[1].pos),v=b[1].pos;\n            for(int i=2; i<=cnt2; i++)\n            {\n                printf(\"1 %d %d\\n\",v,b[i].pos);\n                v=b[i].pos;\n            }\n        }\n    }\n}\n```\n", "link": "/posts/LG CF1042C Array Product/", "tags": ["\u8d2a\u5fc3", "\u6392\u5e8f"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF960E Alternating Tree", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF960E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF960E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fd9\u7bc7\u9898\u89e3\u53ef\u80fd\u662f\u5bf9\u697c\u4e0b\u7684\u8865\u5145\n\n\u6211\u4eec\u8003\u8651\u6bcf\u4e2a\u70b9\u80fd\u8d21\u732e\u591a\u5c11\u6b21\n\n![\u65e0\u6807\u9898.png](https://i.loli.net/2019/10/25/Evy74V8rpIaec1F.png)\n\n\u8bbe\u5f53\u524d\u8282\u70b9\u4e3a$x$,\u8def\u5f84\u6709\u4e09\u79cd\u60c5\u51b5,\u4e0a\u56fe\u5206\u522b\u5bf9\u5e94\u60c5\u51b5$1$,\u60c5\u51b5$2$,\u60c5\u51b5$3$\n\n1. $x$\u5b50\u6811\u5185$\\rightarrow x \\rightarrow x$\u5b50\u6811\u5916(\u5305\u62ec$x$)\n    \n2. $x$\u5b50\u6811\u5185(\u5305\u62ec$x$)$\\rightarrow x \\rightarrow x$\u5b50\u6811\u5185\n\n3. $x$\u5b50\u6811\u5916$\\rightarrow x \\rightarrow x$\u5b50\u6811\u5185\n\n\u6211\u4eec\u53ef\u4ee5\u5148\u5904\u7406\u51fa\u4e0e$x$\u7684\u8ddd\u79bb\u4e3a\u5076\u6570\u548c\u4e0e$x$\u7684\u8ddd\u79bb\u4e3a\u5947\u6570\u7684\u70b9\u7684\u4e2a\u6570,\u5206\u522b\u8bb0\u4f5c$f_x,g_x$\n\n\u90a3\u4e48$f_x = 1 + \\sum g_{to},g_x = 1 + \\sum f_{to}$($to$\u6307$x$\u7684\u5b69\u5b50)\n\n\u6211\u4eec\u6765\u8003\u8651\u6240\u6709\u60c5\u51b5\n\n1. $ans += V_x \\times (f_x-g_x) \\times (n-siz_x+1)$(\u53ef\u4ee5\u5728$x$\u7684\u5b50\u6811\u4e2d\u968f\u673a\u9009\u4e00\u4e2a\u5f80\u5b50\u6811\u5916\u9762\u8d70(\u53ef\u4ee5\u6307\u8d70\u5230$x$))\n\n2. $ans += V_x \\times (g_{to}-f_{to}) \\times (siz_x-siz_{to}-1)$\n  \n   $ans+= V_x \\times (siz_x-1)$(\u53ef\u4ee5\u4ece$x$\u76f4\u63a5\u5411\u4e0b\u8d70)\n\n3. \u6211\u4eec\u9700\u8981\u8bb0\u5f55$x$\u5b50\u6811\u5916\u4e0e$x$\u7684\u8ddd\u79bb\u4e3a\u5076\u6570\u548c\u4e0e$x$\u7684\u8ddd\u79bb\u4e3a\u5947\u6570\u7684\u70b9\u7684\u4e2a\u6570,\u5206\u522b\u8bb0\u4f5c$uf_x,ug_x$\n\n\t\u6211\u4eec\u53ef\u4ee5\u901a\u8fc7$bfs$\u4ece\u4e0a\u5230\u4e0b\u6765\u5904\u7406,\u90a3\u4e48\n    \n   $uf_x=ug_{fa_x}+g_{fa_x}-f_x$\n    \n   $ug_x=uf_{fa_x}+f_{fa_x}-g_x$\n   \n   $ans += V_x \\times (uf_x-ug_x) \\times siz_x$\n   \n\u63a5\u4e0b\u6765\u653e\u4ee3\u7801\uff1a\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\nconst ll mod = 1000000007;\nint n,cnt=0,head[N];\nll ans=0;\nstruct edge{\n    int to,nxt;\n}e[N*2];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint a[N],siz[N],f[N],g[N],fa[N];\nil ll mo(ll x,ll y){\n    if(x>y)return x-y;\n    return x;\n}\n#define A%B mo(A,B)\nvoid dfs(int x){\n    f[x]=siz[x]=1;\n    fl(i,x)if(to!=fa[x]){\n        fa[to]=x;dfs(to);\n        siz[x]+=siz[to];\n        f[x]+=g[to];\n        g[x]+=f[to];\n    }\n    // 1:\n    ans=(ans+1ll*(f[x]-g[x])*(n-siz[x]+1)%mod*a[x]%mod)%mod;\n    //2:\n    ans=(ans+1ll*(siz[x]-1)*a[x]%mod)%mod;\n    fl(i,x)if(to!=fa[x])\n        ans=(ans+1ll*(g[to]-f[to])*(siz[x]-siz[to]-1)%mod*a[x]%mod)%mod;\n}\nint uf[N],ug[N];\nil void bfs(){\n    queue<int>q;\n    fl(i,1)q.push(to);\n    while(!q.empty()){\n        int x=q.front();q.pop();\n        uf[x]=ug[fa[x]]+g[fa[x]]-f[x];\n        ug[x]=uf[fa[x]]+f[fa[x]]-g[x];\n        ans=(ans+1ll*(uf[x]-ug[x])*siz[x]%mod*a[x]%mod)%mod;\n        fl(i,x)if(to!=fa[x])q.push(to);\n    }\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    Fur(i,1,n)in>>a[i];\n    int x,y;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    dfs(1);\n    bfs();\n    cout<<(ans+mod)%mod<<endl;\n}\n```\n", "link": "/posts/LG CF960E Alternating Tree/", "tags": ["\u52a8\u6001\u89c4\u5212", "\u6811\u5f62dp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3797 \u5996\u68a6\u65a9\u6728\u68d2", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3797&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3797\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bb0\u5f55\u533a\u95f4\u5185\u6700\u5148\u51fa\u73b0\u7684\u5de6\u62ec\u53f7\u548c\u53f3\u62ec\u53f7\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\n#define ls rt<<1\n#define rs rt<<1|1\nint n,q,s[N<<2],sl[N<<2],sr[N<<2];\nvoid pu(int rt){\n\ts[rt]=s[ls]+s[rs];\n\tif(sl[ls]&&sr[rs])s[rt]++;\n\tif(sl[rs])sl[rt]=sl[rs];\n\telse if(!s[rs]&&!sr[rs]&&!sl[rs]&&sl[ls])sl[rt]=sl[ls];\n\telse sl[rt]=0;\n\tif(sr[ls])sr[rt]=s[ls];\n\telse if(!s[ls]&&!sl[ls]&&!sr[ls]&&sr[rs])sr[rt]=sr[rs];\n\telse sr[rt]=0;\n}\nvoid build(int l,int r,int rt){\n\tif(l==r){\n\t\tif(l==1)sl[rt]=1;\n\t\tif(l==n)sr[rt]=n;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tbuild(l,m,ls);\n\tbuild(m+1,r,rs);\n\tpu(rt);\n}\nvoid upd(int x,int c,int l,int r,int rt){\n\tif(l==r){\n\t\tif(c==0)sl[rt]=sr[rt]=0;\n\t\tif(c==1)sl[rt]=l,sr[rt]=0;\n\t\tif(c==2)sr[rt]=l,sl[rt]=0;\n\t\treturn;\n\t}\n\tint m=(l+r)>>1;\n\tif(x<=m)upd(x,c,l,m,ls);\n\telse upd(x,c,m+1,r,rs);\n\tpu(rt);\n}\nint ask(int L,int R,int l,int r,int rt){\n\tif(L<=l&&r<=R)return s[rt];\n\tint m=(l+r)>>1,ans=0;\n\tif(L<=m)ans=ask(L,R,l,m,ls);\n\tif(R>m)ans+=ask(L,R,m+1,r,rs);\n\tif(L<=sl[ls]&&sr[rs]<=R&&sr[rs])ans++;\n\treturn ans;\n}\nint main(){\n\tfin(\"in\");\n\tin>>n>>q;\n\tint u,x,y;\n\tchar ch;\n\tbuild(1,n,1);\n\twhile(q--){\n\t\tin>>u>>x;\n\t\tif(u==1){\n\t\t\tin>>ch;\n\t\t\tif(ch=='X')y=0;\n\t\t\tif(ch=='(')y=1;\n\t\t\tif(ch==')')y=2;\n\t\t\tupd(x,y,1,n,1);\n\t\t}\n\t\telse{\n\t\t\tin>>y;\n\t\t\tout<<ask(x,y,1,n,1)<<ln;\n\t\t}\n\t}\n}\n\n```\n", "link": "/posts/LG 3797 \u5996\u68a6\u65a9\u6728\u68d2/", "tags": ["\u7ebf\u6bb5\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3565 [POI2014]HOT-Hotels", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3565&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3565\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6811\u5f62dp \u957f\u94fe\u5256\u5206\n\n[\u52a0\u5f3a\u7248](https://remmina.github.io/BZPRO/JudgeOnline/4543.html)\n\n\u5148\u6765\u8003\u8651$1 \\le n \\le 5000$\n\n\u8bbe$f[i][j]$\u8868\u793a\u5728$i$\u7684\u5b50\u6811\u4e2d\u4e0e$i$\u8ddd\u79bb\u4e3a$j$\u7684\u70b9\u6570\n\n\u663e\u7136$f[i][j] = \\sum f[to][j-1](f[i][0] = 1)$\n\n\u8bbe$g[i][j]$\u8868\u793a\u4ee5$i$\u4e3a\u6839\u7684\u5b50\u6811\u4e2d,\u70b9\u5bf9$(x,y)$\u6ee1\u8db3$x,y$\u5230$lca(x,y)$\u8ddd\u79bb\u90fd\u662f$d$,\u5e76\u4e14$lca(x,y)$\u5230$i$\u7684\u8ddd\u79bb\u4e3a$d-j$\u7684\u70b9\u5bf9\u6570\n\n$g[i][j] = \\sum g[to][j+1]$\n\n$ans = \\sum_{i=1}^n (g[i][0]+g[i][j] \\times f[to][j-1])$\n\n\u6211\u4eec\u6765\u8003\u8651\u52a0\u5f3a\u7248\n\n$n \\le 100000$\n\n\u6709\u70b9\u50cf\u9759\u6001\u94fe\u5206\u6cbb\u548c\u6811\u94fe\u5256\u5206\n\n\u6211\u4eec\u8ba1\u7b97\u957f\u94fe\u7684\u65f6\u5019\u7ed3\u679c\u4e0d\u9700\u8981\u6e05\u7a7a,\u5176\u4ed6\u513f\u5b50\u8282\u70b9\u91cd\u65b0\u8ba1\u7b97\n\n\u8fd9\u6837\u53ef\u4ee5\u7701\u4e0b\u957f\u94fe\u7684\u65f6\u95f4\n\n\u957f\u94fe\u5256\u5206\u771f\u662f\u4e2a\u6bd2\u7624(\u6307\u9488\u6bd2\u7624)\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\nconst int N(100011);\nint n,cnt=0,head[N];\nstruct edge{\n    int to,nxt;\n}e[N*2];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint d[N],mxd[N],son[N];\nvoid dfs(int x,int fa){\n    fl(i,x)if(to!=fa){\n        d[to]=d[x]+1;\n        dfs(to,x);\n        mxd[x]=MAX(mxd[x],mxd[to]);\n        if(mxd[to]>mxd[son[x]])son[x]=to;\n    }\n    mxd[x]=mxd[son[x]]+1;\n}\nll *f[N],*g[N],ans=0,pool[N<<2],*id=pool;\nvoid sol(int x,int fa){\n    if(son[x])f[son[x]]=f[x]+1,g[son[x]]=g[x]-1,sol(son[x],x);\n    f[x][0]=1;ans+=g[x][0];\n    fl(i,x)if(to!=fa&&to!=son[x]){\n        f[to]=id;id+=mxd[to]<<1;\n        g[to]=id;id+=mxd[to]<<1;\n        sol(to,x);\n        Fur(j,0,mxd[to]-1){\n            if(j)ans+=f[x][j-1]*g[to][j];\n            ans+=g[x][j+1]*f[to][j];\n        }\n        Fur(j,0,mxd[to]-1){\n            g[x][j+1]+=f[x][j+1]*f[to][j];\n            if(j)g[x][j-1]+=g[to][j];\n            f[x][j+1]+=f[to][j];\n        }\n    }\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    int x,y;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    dfs(1,0);\n    f[1]=id;id+=mxd[1]<<1;g[1]=id;id+=mxd[1]<<1;\n    sol(1,0);\n    out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 3565 [POI2014]HOT-Hotels/", "tags": ["\u6811\u5f62dp", "\u957f\u94fe\u5256\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 5021 \u8d5b\u9053\u4fee\u5efa", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P5021&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P5021\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n1. $b_i = a_i + 1$\n   > \u4e00\u6761\u94fe\n   > \n   > \u76f4\u63a5\u4e8c\u5206\u6700\u5c0f\u503c,\u7136\u540e\u5224\u65ad\u5373\u53ef\n2. $m=1$\n   > \u76f4\u63a5\u627e\u6811\u7684\u76f4\u5f84\n3. $a_i = 1$\n   > \u8bb0\u5f55\u6240\u6709\u8fb9\u6743,\u8bbe\u8fb9\u6743\u4e3a$w$,\u7136\u540e\u6392\u5e8f\n   > \n   > \u6c42$w_1 + w_{2m} , w_2 + w_{2m-1}, ...$\u7684\u6700\u5c0f\u503c\n4. \u5206\u652f\u4e0d\u8d85\u8fc7$3$(\u57fa\u672c\u4e0a\u5c31\u662f\u6b63\u89e3\u4e86)\n\n\u660e\u6446\u7740\u5c31\u662f\u6b63\u89e3\u561b\n\n$dfs(x,f,w)$\u6c42\u51fa$x$\u7684\u5b50\u6811\u8fde\u63a5$x$\u957f\u5ea6\u4e0d\u8d85\u8fc7$w$\u7684\u6700\u957f\u8def\u5f84\n\n\u8def\u5f84\u5206\u4e3a\u4e24\u79cd\n\n\u4e00\u79cd$\\ge w$,\u90a3\u76f4\u63a5\u6761\u6570++\n\n\u53e6\u4e00\u79cd$a+b \\ge w$\n\n\u90a3\u6211\u4eec\u76f4\u63a5\u7528multiset\u5b58,\u6bcf\u6b21lowerbound\u627e\u5230\u6700\u63a5\u8fd1\u7684,\u7136\u540e\u8fd4\u56de\n\n\u6211$stl$,\u8fd8\u662f\u592a\u5f31\u4e86$Q\\omega Q$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 50011\nint n,m,head[N],cnt=0,ans;\nmultiset<int>s[N];\nstruct edge{\n\tint to,nxt,w;\n}e[N*2];\nvoid add(int x,int y,int w){\n\te[++cnt].to=y;e[cnt].nxt=head[x];e[cnt].w=w;head[x]=cnt;\n}\nint dfs(int x,int f,int w){\n\ts[x].clear();\n\tint v;\n\tfl(i,x)if(to!=f){\n\t\tv=dfs(to,x,w)+e[i].w;\n\t\tif(v>=w)ans++;\n\t\telse s[x].insert(v);\n\t}\n\tmultiset<int>::iterator it;\n\tv=0;\n\twhile(!s[x].empty()){\n\t\tint t=*s[x].begin();\n\t\tif(s[x].size()==1)return MAX(v,t);\n\t\tit=s[x].lower_bound(w-t);\n\t\tif(it==s[x].begin()&&s[x].count(*it))it++;\n\t\tif(it==s[x].end())v=MAX(v,t),s[x].erase(s[x].begin());\n\t\telse{\n\t\t\tans++;\n\t\t\ts[x].erase(s[x].begin());\n\t\t\ts[x].erase(it);\n\t\t}\n\t}\n\treturn v;\n}\nbool chk(int w){\n\tans=0;\n\tdfs(1,0,w);\n\treturn ans>=m;\n}\nint main(){\n\tin>>n>>m;\n\tint x,y,w;\n\tFur(i,1,n-1)in>>x>>y>>w,add(x,y,w),add(y,x,w);\n\tint l=0,r=1<<30,mid,as=0;\n\twhile(l<=r){\n\t\tmid=(l+r)>>1;\n\t\tif(chk(mid))as=mid,l=mid+1;\n\t\telse r=mid-1;\n\t}\n\tout<<as<<ln;\n}\n```\n", "link": "/posts/LG 5021 \u8d5b\u9053\u4fee\u5efa/", "tags": ["dfs", "set"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2915 [USACO08NOV]\u5976\u725b\u6df7\u5408\u8d77\u6765Mixed-Up-Cows", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2915&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2915\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f[i][sta]$\u8868\u793a\u4ee5\u7b2c$i$\u53ea\u5976\u725b\u7ed3\u5c3e,\u72b6\u6001\u4e3a$sta$\u7684\u60c5\u51b5\u4e0b\u6709\u591a\u5c11\u79cd\n\n$f[i][sta] = \\sum f[i-1][sta']$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 17\nint n,k,a[N];\nll f[N][1<<N];\nint main(){\n    in(n,k);\n    Fur(i,1,n)in(a[i]);\n    Fur(i,1,n)f[i][1<<(i-1)]=1;\n    Fur(sta,1,(1<<n)-1)\n        Fur(i,1,n)\n        if((sta&(1<<(i-1)))&&!f[i][sta]){\n            int STA=sta^(1<<(i-1));\n            Fur(j,1,n)\n            if(i!=j&&(STA&(1<<(j-1)))&&(ABS(a[i]-a[j])>k))\n                f[i][sta]+=f[j][STA];\n        }\n    ll ans=0;\n    Fur(i,1,n)ans+=f[i][(1<<n)-1];\n    cout<<ans<<endl;\n}\n```\n", "link": "/posts/LG 2915 [USACO08NOV]\u5976\u725b\u6df7\u5408\u8d77\u6765Mixed-Up-Cows/", "tags": ["\u72b6\u538bdp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4165 [SCOI2007]\u7ec4\u961f", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4165&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4165\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n$H:minH , V:minV$\n\n\n\u3000\n$A \\times (h-H) + B \\times (v-V) \\le C$\n\n$A \\times h + B \\times v -C \\le A \\times H + B \\times V$\n\n\u8bbe$s = Ah + Bv - C$,\u6309$s$\u6392\u5e8f,\u786e\u4fdd$i$\u53ef\u4ee5\u53d6$j$\u5c31\u53ef\u4ee5\u53d6$(j<i)$\n\n\u679a\u4e3e$H,V$,\u7136\u540e\u7528\u53cc\u6307\u9488,\u5177\u4f53\u770b\u4ee3\u7801\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\n#define int ll\nint n,A,B,C,ans=0;\nstruct node{\n\tint h,v,s;\n}a[N],h[N],v[N];\nbool cmp(node x,node y){return x.s<y.s;}\nbool cmp2(node x,node y){return x.h<y.h;}\nbool cmp3(node x,node y){return x.v<y.v;}\nsigned main(){\n\tin>>n>>A>>B>>C;\n\tFur(i,1,n)\n\t\tin>>a[i].h>>a[i].v,\n\t\ta[i].s=A*a[i].h+B*a[i].v-C;\n\t\n\tcpy(h,a);cpy(v,a);\n\t\n\tsort(a+1,a+n+1,cmp);\n\tsort(h+1,h+n+1,cmp2);\n\tsort(v+1,v+n+1,cmp3);\n\t\n\tFur(i,1,n){\n\t\tint l=0,r=0,cnt=0;\n\t\tll mV=v[i].v,lV=mV+C/B;\n\t\tFur(j,1,n){\n\t\t\tll lS=A*h[j].h+B*mV;\n\t\t\twhile(r<n&&a[r+1].s<=lS){\n\t\t\t\tr++;\n\t\t\t\tif(mV<=a[r].v&&a[r].v<=lV)cnt++;\n\t\t\t}\n\t\t\twhile(l<n&&h[l+1].h<h[j].h){\n\t\t\t\tl++;\n\t\t\t\tif(mV<=h[l].v&&h[l].v<=lV)cnt--;\n\t\t\t}\n\t\t\tans=MAX(ans,cnt);\n\t\t}\n\t}\n\tout<<ans<<ln;\n}\n```\n", "link": "/posts/LG 4165 [SCOI2007]\u7ec4\u961f/", "tags": ["\u679a\u4e3e", "\u53cc\u6307\u9488"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3621 [APIO2007]\u98ce\u94c3", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P3621&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P3621\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u628a\u98ce\u94c3\u770b\u6210\u4e00\u68f5\u6811\n\n\u56e0\u4e3a\u4ea4\u6362\u4e00\u6839\u6746\u7684\u4e24\u7aef\u4e0d\u4f1a\u5f71\u54cd\u5b83\u4e0b\u9762\u7684\u5b50\u6811\u7684\u60c5\u51b5,\u6240\u4ee5\u53ef\u4ee5\u91c7\u7528**\u5206\u6cbb+\u5206\u7c7b\u8ba8\u8bba**\n\n\u6211\u4eec\u5148\u9884\u5904\u7406\u51fa\u6700\u5c0f\u6df1\u5ea6\u548c\u6700\u5927\u6df1\u5ea6\n\n\u5982\u679c\u5dee\u5927\u4e8e1,\u90a3\u4e48\u4e0d\u6ee1\u8db3\u8981\u6c42\n\n\u4e00\u4e2a\u7aef\u70b9\u53ef\u4ee5\u5206\u6210\u4e09\u79cd\u60c5\u51b5\n\n0. \u90fd\u662f\u6700\u5c0f\u6df1\u5ea6\n\n1. \u90fd\u662f\u6700\u5927\u6df1\u5ea6\n   \n2. \u4e24\u79cd\u90fd\u6709\n\n\u5982\u679c\u4e00\u6839\u6746\u5de6\u53f3\u7aef\u70b9\u5206\u522b\u4e3a$0,1$\u6216$0,2$\u6216$2,1$\u90a3\u4e48\u5b83\u5c31\u9700\u8981\u4ea4\u6362\u5de6\u53f3\u7aef\u70b9\n\n\u5982\u679c\u5de6\u53f3\u7aef\u70b9\u90fd\u662f$2$\u90a3\u4e48\u4ea4\u6362\u4e5f\u6ca1\u7528,\u76f4\u63a5\u8f93\u51fa$-1$,\u7ed3\u675f\u7a0b\u5e8f\n\n\u7136\u540e\u628a\u72b6\u6001\u5411\u4e0a\u4f20\u9012\u5c31\u53ef\u4ee5\u4e86\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,ans=0,l[N],r[N],mx=0,mi=inf;\nvoid dfs(int x,int d){\n    if(x==-1){\n        mi=MIN(d,mi);\n        mx=MAX(d,mx);\n        return;\n    }\n    dfs(l[x],d+1);dfs(r[x],d+1);\n}\nint DFS(int x,int d){\n    if(x==-1)return d!=mi;\n    int ls=DFS(l[x],d+1),rs=DFS(r[x],d+1);\n    if((ls==0&&rs==1)||(ls==2&&rs==1)||(ls==0&&rs==2))++ans;\n    if(ls==2&&rs==2)out<<\"-1\\n\",exit(0);\n    if(ls==2||rs==2)return 2;\n    if(ls^rs)return 2;\n    if(!ls&&!rs)return 0;\n    return 1;\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    int x,y;\n    Fur(i,1,n)in>>l[i]>>r[i];\n    dfs(1,0);\n    DFS(1,0);\n    if(mx-mi>1)out<<\"-1\\n\";\n    else if(mx-mi==0)out<<\"0\\n\";\n    else out<<ans<<ln;\n}\n```\n", "link": "/posts/LG 3621 [APIO2007]\u98ce\u94c3/", "tags": ["dfs", "\u5206\u6cbb"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1323 \u5220\u6570\u95ee\u9898", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1323&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1323\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 100011\nint n,k,a[N],ans[5000010],nxt[5000010];\nint main(){\n    in(k,n);\n    priority_queue<int,vector<int>,greater<int>>q;\n    q.push(1);\n    Fur(i,1,k){\n        a[i]=q.top();q.pop();\n        q.push(a[i]<<1|1);q.push(a[i]*4+5);\n        out(a[i]);\n    }out(ln);\n    clr(ans,126);\n    int d=0,x;\n    Fdr(i,k,1){\n        x=a[i];\n        while(x){\n            ans[++d]=x%10;\n            x/=10;\n        }\n    }\n    reverse(ans+1,ans+d+1);\n    Fur(i,0,d-1)nxt[i]=i+1;\n    while(n--){\n        int l=0;\n        while(ans[nxt[l]]>=ans[nxt[nxt[l]]])l=nxt[l];\n        nxt[l]=nxt[nxt[l]];\n    }\n    for(int i=0;nxt[i];i=nxt[i])out(ans[nxt[i]]);\n    flush();\n}\n```\n", "link": "/posts/LG 1323 \u5220\u6570\u95ee\u9898/", "tags": ["\u8d2a\u5fc3", "\u5806"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4216 [SCOI2015]\u60c5\u62a5\u4f20\u9012", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4216&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4216\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n~~\u4e00\u770b\u5c31\u662f\u6811\u5256~~\n\n\u5148\u8bbe\u6240\u6709\u60c5\u62a5\u5458\u5f00\u59cb\u641c\u7d22\u60c5\u62a5\u7684\u65f6\u95f4(\u6211\u4eec\u5047\u8bbe\u7ed9\u8fd9\u4e2a\u60c5\u62a5\u5458\u8d4b\u503c)\u662f$q$,\u5373\u8be2\u95ee\u4e2a\u6570\n\n\u5bf9\u4e8e\u7b2c$i$\u4e2a\u8be2\u95ee\u5982\u679c\u662f\u67e5\u8be2,\u5219\u67e5\u627e\u503c\u6bd4$i-c$\u5c0f\u7684\u60c5\u62a5\u5458\u6709\u591a\u5c11\u4e2a(\u6811\u5256)\n\n\u53c2\u4e0e\u4f20\u9012\u7684\u4eba\u6570\u663e\u7136\u662f$d_x+d_y-2 \\times d_{LCA(x,y)} + 1$\n\n\u5982\u679c\u662f\u8ba9\u67d0\u4e2a\u60c5\u62a5\u5458\u5f00\u59cb\u641c\u96c6,\u5219\u628a\u8fd9\u4e2a\u60c5\u62a5\u5458\u8d4b\u503c\u4e3a$i$\n\n### \u89e3\u6cd5\u4e00\uff1a\n\n\u5957\u4e2a\u4e3b\u5e2d\u6811\u5e94\u8be5\u5c31\u53ef\u4ee5\u4e86(\u8bf7\u53c2\u89c1\u697c\u4e0b)\n\n### \u89e3\u6cd5\u4e8c\uff1a\n\n\u79bb\u7ebf\u6309\u7167\u6743\u503c\u6392\u5e8f\u6dfb\u52a0,\u7136\u540e\u7528\u7ebf\u6bb5\u6811\u6216\u6811\u72b6\u6570\u7ec4\u7edf\u8ba1\u5c31\u53ef\u4ee5\u4e86)\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#pragma GCC optimize(3)\n#define il __inline__ __attribute__ ((always_inline))\n#define Fur(i,x,y) for(int i=x;i<=y;++i)\n#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nil void SWAP(int &x,int &y){int t=x;x=y;y=t;}\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\nint n,cnt=0,head[N],RT;\nstruct edge{\n    int to,nxt;\n}e[N];\nil void add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint top[N],f[N],siz[N],d[N],id[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x){\n        f[to]=x;d[to]=d[x]+1;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    id[x]=++sz;top[x]=tp;int k=0;\n    fl(i,x)if(siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(to!=k)bt(to,to);\n}\nint s[N];\nil void upd(int x){\n    while(x<=n)++s[x],x+=(x&-x);\n}\nil int ask(int x){\n    int ans=0;\n    while(x)ans+=s[x],x^=(x&-x);\n    return ans;\n}\nint a1[N],a2[N];\nstruct que{\n    int x,y,c,id;\n    il bool operator<(que a){\n        return c<a.c;\n    }\n}Q[N];\nvoid work(int x,int y,int ID){\n    int ox=x,oy=y,lca,ans=0;\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans+=ask(id[x])-ask(id[top[x]]-1);x=f[top[x]];\n    }\n    if(id[x]>id[y])SWAP(x,y);\n    lca=x;\n    ans+=ask(id[y])-ask(id[x]-1);\n    a1[ID]=d[ox]+d[oy]-d[lca]*2+1;\n    a2[ID]=ans;\n}\nstruct node{\n    int x,i;\n}b[N];\nint main(){\n    int opt,x,y,c,q;\n    in>>n;\n    Fur(i,1,n){\n        in>>x;\n        if(!x)RT=i;\n        else add(x,i);\n    }\n    dfs(RT);bt(RT,RT);\n    in>>q;\n    int tot=0,TOT=0;\n    Fur(i,1,q){\n        in>>opt>>x;\n        if(opt==1){\n            in>>y>>c;\n            c=i-c;\n            Q[++TOT]=que{x,y,c,TOT};\n        }\n        else b[++tot]=node{x,i};\n    }\n    std::sort(Q+1,Q+TOT+1);\n    int d=1;\n    Fur(i,1,TOT){\n        while(d<=tot&&b[d].i<Q[i].c)upd(id[b[d++].x]);\n        work(Q[i].x,Q[i].y,Q[i].id);\n    }\n    Fur(i,1,TOT)out<<a1[i]<<\" \"<<a2[i]<<ln;\n}\n```\n\n~~### \u89e3\u6cd5\u4e09\uff1a~~\n\n~~\u5728\u6bcf\u4e2a\u91cd\u94fe\u7684\u9876\u7aef\u641e\u4e2a$pbds$,\u5e73\u8861\u6811~~\n\n### TLE\n\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\n#include<bits/extc++.h>\nusing namespace __gnu_pbds;\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 200011\nint n,cnt=0,head[N],RT;\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint top[N],f[N],siz[N],d[N],sz=0;\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x){\n        f[to]=x;d[to]=d[x]+1;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(to!=k)bt(to,to);\n}\nint a[N];\ntree<int,null_type,less<int>,rb_tree_tag,tree_order_statistics_node_update>T[N];\nvoid upd(int x,int i){\n    a[x]=i;T[top[x]].insert(i);\n}\nint ask(int x,int y,int c){\n    int ans=0;\n    while(x!=y){\n        if(a[x]<c)++ans;\n        x=f[x];\n    }\n    ans+=(a[y]<c);\n    return ans;\n}\nvoid work(int x,int y,int c){\n    int ox=x,oy=y,lca,ans=0;\n    ans+=ask(x,top[x],c);x=f[top[x]];\n    ans+=ask(y,top[y],c);y=f[top[y]];\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        ans+=T[top[x]].order_of_key(c)-1;\n        x=f[top[x]];\n    }\n    if(d[x]>d[y])SWAP(x,y);\n    lca=x;\n    ans+=ask(x,y,c);\n    out<<d[ox]+d[oy]-d[lca]*2+1<<\" \"<<ans<<ln;\n}\nint main(){\n    int opt,x,y,c,q;\n    in>>n;\n    Fur(i,1,n){\n        in>>x;\n        if(!x)RT=i;\n        else add(x,i);\n    }\n    dfs(RT);bt(RT,RT);\n    in>>q;\n    Fur(i,1,q)a[i]=q;\n    Fur(i,1,q){\n        in>>opt>>x;\n        if(opt==1){\n            in>>y>>c;\n            work(x,y,i-c);\n        }\n        else upd(x,i);\n    }\n}\n```\n", "link": "/posts/LG 4216 [SCOI2015]\u60c5\u62a5\u4f20\u9012/", "tags": ["\u6811\u94fe\u5256\u5206", "\u4e3b\u5e2d\u6811"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4185 [USACO18JAN]MooTube", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4185&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4185\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8fd8\u662f\u7528\u5e76\u67e5\u96c6\u7edf\u8ba1\u8fde\u901a\u5757\u5927\u5c0f\n\n\u79bb\u7ebf\u5904\u7406,\u6309\u76f8\u5173\u6027\u4ece\u5927\u5230\u5c0f\u52a0\u8fb9\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,q,ans[N];\nstruct que{\n    int k,x,id;\n}b[N];\nstruct link{\n    int x,y,w;\n}e[N];\nbool cmp(link x,link y){return x.w>y.w;}\nbool cmp2(que x,que y){return x.k>y.k;}\nint f[N],sz[N];\nint gf(int x){\n    return (x==f[x])?x:(f[x]=gf(f[x]));\n}\nint main(){\n    fin(\"in\");\n    in>>n>>q;\n    Fur(i,1,n-1)in>>e[i].x>>e[i].y>>e[i].w;\n    sort(e+1,e+n,cmp);\n    Fur(i,1,q)in>>b[i].k>>b[i].x,b[i].id=i;\n    sort(b+1,b+q+1,cmp2);\n    int t=1,x,y;\n    Fur(i,1,n)f[i]=i,sz[i]=1;\n    Fur(i,1,q){\n        while(e[t].w>=b[i].k&&t<n){\n            x=e[t].x,y=e[t].y;\n            int fx=gf(x),fy=gf(y);\n            if(fx!=fy){\n                f[fx]=fy;\n                sz[fy]+=sz[fx];\n                sz[fx]=sz[fy];\n            }\n            ++t;\n        }\n        ans[b[i].id]=sz[gf(b[i].x)]-1;\n    }\n    Fur(i,1,q)out<<ans[i]<<ln;\n}\n```\n", "link": "/posts/LG 4185 [USACO18JAN]MooTube/", "tags": ["\u5e76\u67e5\u96c6"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2458 [SDOI2006]\u4fdd\u5b89\u7ad9\u5c97", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2458&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2458\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$f_x$\u8868\u793a\u5728$x$\u653e\u7f6e\u4e14$x$\u7684\u5b50\u6811\u90fd\u88ab\u8986\u76d6\u6700\u5c11\u591a\u5c11\n\n\u8bbe$g_x$\u8868\u793a\u4e0d\u5728$x$\u653e\u7f6e\u4e14$x$\u7684\u5b50\u6811\u90fd\u88ab\u8986\u76d6\u6700\u5c11\u591a\u5c11($x$\u53ef\u4ee5\u4e0d\u88ab\u8986\u76d6)\n\n\u8bbe$s_x$\u8868\u793a\u5728$x$\u653e\u7f6e\u4e14$x$\u7684\u5b50\u6811\u90fd\u88ab\u8986\u76d6\u6700\u5c11\u591a\u5c11($x$\u4e00\u5b9a\u88ab\u8986\u76d6)\n\n$f_u = \\sum min(f_v,s_v,g_v)$\n\n$g_u = \\sum min(f_v,s_v)$\n\n$s_u = (\\sum \\min(f_v,s_v)) - max(0,min(f_v-s_v))$\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 1511\nint n,a[N],cnt=0,head[N],ind[N];\nstruct edge{\n    int to,nxt;\n}e[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nint f[N],g[N],s[N];\nvoid dfs(int x){\n    f[x]=a[x];\n    s[x]=g[x]=0;\n    bool ff=1;\n    int tt=inf;\n    fl(i,x){\n        dfs(to);\n        f[x]+=MIN(MIN(g[to],s[to]),f[to]);\n        g[x]+=MIN(f[to],s[to]);\n        if(f[to]<=s[to])s[x]+=f[to],ff=0;\n        else s[x]+=s[to],tt=MIN(tt,f[to]-s[to]);\n    }\n    if(ff)s[x]+=tt;\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    int x,y,t;\n    Fur(i,1,n){\n        in>>x;in>>a[x];\n        in>>t;\n        while(t--)in>>y,add(x,y),ind[y]++;\n    }\n    int rt;\n    Fur(i,1,n)if(!ind[i]){rt=i;break;}\n    dfs(rt);\n    out<<MIN(f[rt],s[rt]);\n}\n```\n", "link": "/posts/LG 2458 [SDOI2006]\u4fdd\u5b89\u7ad9\u5c97/", "tags": ["\u6811\u5f62dp", "\u52a8\u6001\u89c4\u5212"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1686 \u7b2cK\u5927\u533a\u95f42", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u8bbe$S_i$\u4e3a$[1,i]$\u4e2d$\\ge w$\u7684\u6570\u7684\u4e2a\u6570\n\n\u5982\u679c\u4e00\u4e2a\u533a\u95f4\u8981\u6ee1\u8db3\u4e2d\u4f4d\u6570$\\ge w$,\u90a3\u4e48$\\frac {S_r-S_{l-1}}{\\frac {r-l+1}2} \\ge w$\n\n\u5316\u7b80\u4e00\u4e0b\uff1a$2S_r-r > 2S_{l-1}-(l-1)$\n\n\u90a3\u4e48\u4e8c\u5206$w$\u7136\u540e\u7528\u6811\u72b6\u6570\u7ec4\u7edf\u8ba1\u4e4b\u540e\u5224\u65ad\u6392\u540d\u662f\u5426$\\ge k$\u5c31\u53ef\u4ee5\u4e86\n\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\n#define int unsigned\nint n,k,a[N],s[N],tr[N*3][2];\nvoid add(int x,int k){\n\tif(x<=0)return;\n\twhile(x<=n*3){\n\t\ttr[x][k]++;\n\t\tx+=(x&-x);\n\t}\n}\nint get(int x,int k){\n\tif(x<=0)return 0;\n\tint ans=0;\n\twhile(x){\n\t\tans+=tr[x][k];\n\t\tx-=(x&-x);\n\t}\n\treturn ans;\n}\nbool chk(int w){\n\tclr(tr,0);\n\tFur(i,1,n)s[i]=s[i-1]+(a[i]>=w);\n\tFur(i,1,n)s[i]=2*s[i]-i+n;\n\tadd(n,0);\n\tint tot=0;\n\tFur(i,1,n){\n\t\ttot+=get(s[i],!(i&1));\n\t\tadd(s[i],(i&1));\n\t}\n\treturn tot>=k;\n}\nsigned main(){\n\tfin(\"in\");\n\tin>>n>>k;\n\tint l=0,r=0,m,ans;\n\tFur(i,1,n)in>>a[i],r=MAX(r,a[i]);\n\twhile(l<=r){\n\t\tm=(l+r)>>1;\n\t\tif(chk(m))ans=m,l=m+1;\n\t\telse r=m-1;\n\t}\n\tout<<ans<<ln;\n}\n\n```\n", "link": "/posts/51nod 1686 \u7b2cK\u5927\u533a\u95f42/", "tags": ["\u6811\u72b6\u6570\u7ec4", "\u4e8c\u5206"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1274 \u6700\u957f\u9012\u589e\u8def\u5f84", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nusing namespace std;\n#define Fur(i,s,t) for(int i=s;i<=t;i++)\n#define dwn(i,s,t) for(int i=s;i>=t;i--)\n#define clr(x,c) memset(x,c,sizeof(x))\nint read(){\n    int x=0;char c=getchar();\n    while(!isdigit(c)) c=getchar();\n    while(isdigit(c)) x=x*10+c-'0',c=getchar();\n    return x;\n}\nconst int nmax=5e4+5;\nconst int inf=0x7f7f7f7f;\nstruct node{\n    int u,v,d;\n    node(int u,int v,int d):u(u),v(v),d(d){};\n    node(){};\n    bool operator<(const node&rhs)const{\n      return d<rhs.d;}\n};\nnode ns[nmax];\nvoid maxs(int &a,int b){\n    if(a<b) a=b;\n}\nint g[nmax],dp[nmax];\nint main(){\n    int n=read(),m=read(),u,v,d;\n    Fur(i,1,m) ns[i].u=read(),ns[i].v=read(),ns[i].d=read();\n    sort(ns+1,ns+m+1);\n    int last=0;\n    Fur(i,1,m){\n        if(i==m||ns[i].d<ns[i+1].d){\n            Fur(j,last+1,i) g[ns[j].u]=dp[ns[j].u],g[ns[j].v]=dp[ns[j].v];\n            Fur(j,last+1,i){\n                maxs(dp[ns[j].u],g[ns[j].v]+1);\n                maxs(dp[ns[j].v],g[ns[j].u]+1);\n            }\n            last=i;\n        }\n    }\n    int ans=0;\n    Fur(i,0,n-1) maxs(ans,dp[i]);\n    printf(\"%d\\n\",ans);\n}\n```\n", "link": "/posts/51nod 1274 \u6700\u957f\u9012\u589e\u8def\u5f84/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG CF519E A and B and Lecture Rooms", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/CF519E&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/CF519E\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u6c42\u51fa$LCA$\n\n\u5982\u679c\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;++i)\n    #define Fdr(i,x,y) for(int i=x;i>=y;--i)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n;\nstruct edge{\n    int to,nxt;\n}e[N];\nint head[N],cnt=0,d[N],f[N],siz[N],top[N];\nvoid add(int x,int y){\n    e[++cnt].to=y;e[cnt].nxt=head[x];head[x]=cnt;\n}\nvoid dfs(int x){\n    siz[x]=1;\n    fl(i,x)if(to!=f[x]){\n        f[to]=x;d[to]=d[x]+1;\n        dfs(to);siz[x]+=siz[to];\n    }\n}\nvoid bt(int x,int tp){\n    top[x]=tp;int k=0;\n    fl(i,x)if(to!=f[x]&&siz[to]>siz[k])k=to;\n    if(!k)return;bt(k,tp);\n    fl(i,x)if(!top[to])bt(to,to);\n}\nint lca(int x,int y){\n    while(top[x]!=top[y]){\n        if(d[top[x]]<d[top[y]])SWAP(x,y);\n        x=f[top[x]];\n    }\n    return d[x]<d[y]?x:y;\n}\nint main(){\n    fin(\"in\");\n    in>>n;\n    int x,y;\n    Fur(i,1,n-1)in>>x>>y,add(x,y),add(y,x);\n    d[1]=1;dfs(1);bt(1,1);\n    int q;in>>q;\n    while(q--){\n        in>>x>>y;\n        if(d[x]<d[y])SWAP(x,y);\n        int t=lca(x,y),len=d[x]-d[t]+d[y]-d[t]+1;\n        if(len==1)out<<n<<ln;\n        else if(len&1){\n            if(t==y){\n\n            }\n            else{\n\n            }\n        }\n        else out<<\"0\\n\";\n    }\n}\n```\n", "link": "/posts/LG CF519E A and B and Lecture Rooms/", "tags": ["lca", "\u6811\u5256"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 2235 [HNOI2002]Kathy\u51fd\u6570", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P2235&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P2235\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 10011\nint f[N],s[N];\nvoid sl(int x){\n\twhile(x)out<<(x&1),x>>=1;out<<ln;\n}\nint main(){\n\tint n;in>>n;\n\tf[1]=1;f[3]=3;\n\tf[2]=1;\n\tFur(i,1,n){\n\t\ts[i]=s[i-1];\n\t\tif(i%2==0)f[i]=f[i>>1];\n\t\tif(i>4){\n\t\tif(i%4==1){\n\t\t\tint t=i>>2;\n\t\t\tf[i]=2*f[2*t+1]-f[t];\n\t\t}\n\t\tif(i%4==3){\n\t\t\tint t=i>>2;\n\t\t\tf[i]=3*f[2*t+1]-2*f[t];\n\t\t}\n\t\t}\n\t\tif(f[i]==i)sl(i);\n\t}\n}\n```\n", "link": "/posts/LG 2235 [HNOI2002]Kathy\u51fd\u6570/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 4824 [USACO15FEB]Censoring", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P4824&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P4824\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5220\u9664\u5b8c\u8fd9\u4e2a\u5b57\u7b26\u4e32\u540e\u9762\u7684\u5c31\u63a5\u5230\u524d\u9762\n\n\u6211\u4eec\u53ef\u4ee5\u60f3\u5230\u7528\u6808\u89e3\u51b3\n\n\u7136\u540e\u5224\u65ad\u5269\u4e0b\u7684\u4e32\u5f53\u524d\u4f4d\u7f6e\u662f\u5426\u548c\u76ee\u6807\u5b57\u7b26\u4e32\u5339\u914d\u6211\u4eec\u53ef\u4ee5\u7528hash\u6765\u89e3\u51b3\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i(x);i<=y;++i)\n    #define Fdr(i,x,y) for(int i(x);i>=y;--i)\n    #define fl(i,x) for(int i(head[x]),to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) ((int)(log2(n)))\n    #define inf 2122219134\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const int str=1<<20;static char in_buf[str],*in_s,*in_t;bool __=0;il char gc(){return (in_s==in_t)&&(in_t=(in_s=in_buf)+fread(in_buf,1,str,stdin)),in_s==in_t?EOF:*in_s++;}il void in(string &ch){ch.clear();if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)__=1;}il void in(char &ch){if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)__=1;else ch=c;}il void in(char *ch){*ch='\\0';if(__)return;rg char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF){__=1;return;}*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)__=1;*ch='\\0';}template<typename T>il void in(T &x){if(__)return;rg char c=gc();bool f=0;while(c!=EOF&&(c<'0'||c>'9'))f^=(c=='-'),c=gc();if(c==EOF){__=1;return;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=x*10+c-48,c=gc();if(c==EOF)__=1;if(f)x=-x;}template<typename T,typename ... arr>il void in(T &x,arr & ... y){in(x),in(y...);}const char ln='\\n';static char out_buf[str],*out_s=out_buf,*out_t=out_buf+str;il void flush(){fwrite(out_buf,1,out_s-out_buf,stdout);out_s=out_buf;}il void pt(char c){(out_s==out_t)?(fwrite(out_s=out_buf,1,str,stdout),*out_s++=c):(*out_s++=c);}il void out(const char* s){while(*s)pt(*s++);}il void out(char* s){while(*s)pt(*s++);}il void out(char c){pt(c);}il void out(string s){for(int i=0;s[i];i++)pt(s[i]);}template<typename T>il void out(T x){if(!x){pt('0');return;}if(x<0)pt('-'),x=-x;char a[50],t=0;while(x)a[t++]=x%10,x/= 10;while(t--)pt(a[t]+'0');}template<typename T,typename ... arr>il void out(T x,arr & ... y){out(x),out(y...);}}using namespace IO;\n#define N 1000011\n#define base 1331\nint n,q[N],tp=0,m;\nchar a[N],s[N];\null h[N],pw[N],sta=0;\nint main(){\n    in(a+1);\n    in(s+1);\n    n=strlen(a+1);\n    m=strlen(s+1);\n    pw[0]=1;\n    Fur(i,1,n)\n        pw[i]=pw[i-1]*base;\n    Fur(i,1,m)sta=sta*base+s[i];\n    Fur(i,1,n){\n        q[++tp]=i;\n        h[tp]=h[tp-1]*base+a[i];\n        if(tp>=m&&h[tp]-h[tp-m]*pw[m]==sta)tp-=m;\n    }\n    Fur(i,1,tp)pt(a[q[i]]);\n    flush();\n}\n```\n", "link": "/posts/LG 4824 [USACO15FEB]Censoring/", "tags": ["\u5b57\u7b26\u4e32", "\u6808", "hash", "kmp"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1400 \u5e8f\u5217\u5206\u89e3", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){clr(ch,0);if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 100011\nint n,a[N];\nbool v[N];\nint main(){\n\tfin(\"in\");\nint T;in>>T;\nwhile(T--){\n\tin>>n;\n\tclr(v,0);\n\tFur(i,1,n)in>>a[i];\n\tbool ff=1;\n\tFur(i,1,n)\n\tif(!v[i]){\n\t\tbool f=1;\n\t\tFur(j,i+1,n)\n\t\tif(!v[j]&&a[j]==a[i]){\n\t\t\tv[j]=1,f=0;\n\t\t\tbreak;\n\t\t}\n\t\tif(f){\n\t\t\tff=0;\n\t\t\tout<<\"What a pity!\\n\";\n\t\t\tbreak;\n\t\t}\n\t}\n\tif(ff)out<<\"Good job!!\\n\";\n}\n}\n\n```\n", "link": "/posts/51nod 1400 \u5e8f\u5217\u5206\u89e3/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "51nod 1765 \u8c37\u6b4c\u7684\u6050\u9f99", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n\u5176\u5b9e\u4e0b\u9762\u7ed9\u51fa\u7684$a$\u6570\u7ec4\u6ca1\u4ec0\u4e48\u9e1f\u7528\n\n\u5217\u51fa\u65b9\u7a0b\uff1a\n\n$E = \\sum_{i=0}^{n-1} \\frac 1n \\times ( i+ flag \\times E)$\n\n\u89e3\u65b9\u7a0b\uff1a\n$$\nE = \\sum_{i=0}^{n-1} \\frac 1n \\times ( i+ flag \\times E)\n\\\\\\\\\nE = \\sum_{i=0}^{n-1} \\frac in + (1 - \\frac mn)E \n\\\\\\\\\n\\frac mnE = \\frac {\\frac 12n(n-1)}n\n\\\\\\\\\nE = \\frac {n(n-1)}{2m}\n$$\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n    #pragma GCC optimize(3)\n    #define il __inline__ __attribute__ ((always_inline))\n    #define rg register\n    #define ll long long\n    #define ull unsigned long long\n    #define db double\n    #define sht short\n    #define MB template <class T>il\n    #define Fur(i,x,y) for(int i=x;i<=y;i++)\n    #define Fdr(i,x,y) for(int i=x;i>=y;i--)\n    #define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n    #define clr(x,y) memset(x,y,sizeof(x))\n    #define cpy(x,y) memcpy(x,y,sizeof(x))\n    #define fin(s) freopen(s\".in\",\"r\",stdin)\n    #define fout(s) freopen(s\".out\",\"w\",stdout)\n    #define fcin ios::sync_with_stdio(false)\n    #define l2(n) (int(log2(n)))\n    #define inf 0x3f3f3f3f\n    MB T ABS(T x){return x>0?x:-x;}\n    MB T MAX(T x,T y){return x>y?x:y;}\n    MB T MIN(T x,T y){return x<y?x:y;}\n    MB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n    MB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nint n,m;\nint main(){\n\tscanf(\"%d%d\",&n,&m);\n\tprintf(\"%.6f\\n\",(double)n*(n-1)/2/m);\n}\n\n```\n", "link": "/posts/51nod 1765 \u8c37\u6b4c\u7684\u6050\u9f99/", "tags": ["\ufeff\u671f\u671b"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 1709 [USACO5.5]\u9690\u85cf\u53e3\u4ee4Hidden-Password", "content": "<details><summary>\u67e5\u770b\u539f\u9898</summary><p><div class='from'></div><button onclick=\"this.previousElementSibling.innerHTML='<iframe src=&quot;https://www.luogu.com.cn/problem/P1709&quot; width=100% height=800px style=&quot;border: none;&quot;><iframe>'\" class='mdui-btn mdui-btn-raised'>\u70b9\u51fb\u52a0\u8f7d</button><a class='mdui-btn mdui-btn-raised' href=\"https://www.luogu.com.cn/problem/P1709\" target='_blank'>\u70b9\u51fb\u8df3\u8f6c</a><p></details>\n\n<!-- more -->\n\n```cpp\n#include<bits/stdc++.h>\nnamespace ZDY{\n\t#pragma GCC optimize(3)\n\t#define il __inline__ __attribute__ ((always_inline))\n\t#define rg register\n\t#define ll long long\n\t#define ull unsigned long long\n\t#define db double\n\t#define sht short\n\t#define MB template <class T>il\n\t#define Fur(i,x,y) for(int i=x;i<=y;i++)\n\t#define Fdr(i,x,y) for(int i=x;i>=y;i--)\n\t#define fl(i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\n\t#define clr(x,y) memset(x,y,sizeof(x))\n\t#define cpy(x,y) memcpy(x,y,sizeof(x))\n\t#define fin(s) freopen(s\".in\",\"r\",stdin)\n\t#define fout(s) freopen(s\".out\",\"w\",stdout)\n\t#define fcin ios::sync_with_stdio(false)\n\t#define l2(n) (int(log2(n)))\n\t#define inf 0x3f3f3f3f\n\tMB T ABS(T x){return x>0?x:-x;}\n\tMB T MAX(T x,T y){return x>y?x:y;}\n\tMB T MIN(T x,T y){return x<y?x:y;}\n\tMB T GCD(T x,T y){return y?GCD(y,x%y):x;}\n\tMB void SWAP(T &x,T &y){T t=x;x=y;y=t;}\n}using namespace ZDY;using namespace std;\nnamespace IO{const char* ln=\"\\n\";const int str=1<<20;struct IN{char buf[str],*s,*t;bool _;IN():s(buf),t(buf),_(0){}il char gc(){return s==t&&((t=(s=buf)+fread(buf,1,str,stdin))==s)?EOF:(*s++);}IN&operator>>(char&ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)_=1;else ch=c;return *this;}IN& operator>>(char* ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;*ch=c;ch++;while((c=gc())!=EOF&&!isspace(c))*ch=c,ch++;if(c==EOF)_=1;return *this;}IN& operator>>(string& ch){if(_)return *this;char c;while((c=gc())!=EOF&&isspace(c));if(c==EOF)return _=1,*this;ch+=c;while((c=gc())!=EOF&&!isspace(c))ch+=c;if(c==EOF)_=1;return *this;}template<typename T>IN&operator>>(T&x){if(_)return *this;char c=gc();bool ff=0;while(c!=EOF&&(c<'0'||c>'9'))ff^=(c=='-'),c=gc();if(c==EOF){_=1;return *this;}x=0;while(c!=EOF&&'0'<=c&&c<='9')x=(x<<3)+(x<<1)+c-48,c=gc();if(c==EOF)_=1;if(ff)x=-x;return *this;}}in;struct OUT{char buf[str],*s,*t;OUT():s(buf),t(buf+str){}~OUT(){fwrite(buf,1,s-buf,stdout);}void pt(char c){(s==t)?(fwrite(s=buf,1,str,stdout),*s++=c):(*s++=c);}OUT&operator<<(const char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(char*s){while(*s)pt(*s++);return *this;}OUT&operator<<(string s){for(int i=0;s[i];i++)pt(s[i]);return *this;}template<typename T>OUT&operator<<(T x){if(!x)return pt('0'),*this;if(x<0)pt('-'),x=-x;char a[30],t=0;while(x)a[t++]=x%10,x/=10;while(t--)pt(a[t]+'0');return *this;}}out;}using namespace IO;\n#define N 5000111\nchar a[N];\nint n;\nint main(){\n\tin>>n>>(a+1);\n\t\n}\n```\n", "link": "/posts/LG 1709 [USACO5.5]\u9690\u85cf\u53e3\u4ee4Hidden-Password/", "tags": [], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "LG 3953 \u901b\u516c\u56ed", "content": "[LG 3953 \u901b\u516c\u56ed](https://www.luogu.org/problemnew/show/P3953)\n\n\u9898\u610f: \u6c42$dis(1,n)<=MinDis(1,n)+K$\u7684\u8def\u5f84\u6570\n\n\u7528\u62d3\u6251\u554a\u4ec0\u4e48\u7684\u4e00\u60f3\u5c31\u5f88\u9ebb\u70e6\u3002\n\n\u6709\u4e00\u79cd\u7384\u5b66\u7684\u505a\u6cd5\uff1a\u8bb0\u5fc6\u5316\u641c\u7d22\n\n$f[x][k]$\u8868\u793a$dis(x,n)<=MinDis(x,n)+k$\u7684\u8def\u5f84\u6570\u3002\n\n\u5148\u8dd1\u4e00\u822c\u53cd\u5411\u7684\u6700\u77ed\u8def,\u7136\u540edfs\n\n\u8003\u8651\u8fb9$(x,y,w)$,\n\n$\\because Mindis[x]-Mindis[y]+w<k$\n\n$\\therefore f[x][k]+=f[y][k-(Mindis[x]-Mindis[y]+w)]$\n\n$\\therefore f[x][k] = \\sum f[y][k-(Mindis[x]-Mindis[y]+w)]$\n\n<!-- more -->\n\n```cpp\n#include<cstdio>\n#include<cstring>\n#include<queue>\n#define Fur(i,x,y) for(int i=x;i<=y;i++)\n#define clr(x,y) memset(x,y,sizeof(x))\n#define gc getchar\nint gi(){int x=0,f=0;char c=gc();while(c<'0'||'9'<c){if(c=='-')f=!f;c=gc();}while('0'<=c&&c<='9'){x=x*10+c-48;c=gc();}return f?(-x):x;}\nusing namespace std;\n#define N 100010\n#define fl(head,i,x) for(int i=head[x],to;to=e[i].to,i;i=e[i].nxt)\nint n,m,cnt,k,mod,f[N][51],h1[N],h2[N],d[N];\nbool is[N][51],v[N];\nstruct eg{int to,w,nxt;}e[N*4];\nvoid add(int x,int y,int w,int *head){e[++cnt]=(eg){y,w,head[x]};head[x]=cnt;}\nstruct cmp{bool operator()(int a,int b){return d[a]>d[b];}};\npriority_queue<int,vector<int>,cmp>q;\nvoid spfa(){\n    clr(d,126);\n    int x;d[n]=0;q.push(n);\n    while(!q.empty()){\n        x=q.top();q.pop();v[x]=0;\n        fl(h2,i,x)\n        if(d[x]+e[i].w<d[to]){\n            d[to]=d[x]+e[i].w;\n            if(!v[to])q.push(to),v[to]=1;\n        }\n    }\n}\nint dfs(int x,int k){\n    if(is[x][k])return -1;\n    if(f[x][k])return f[x][k];\n    is[x][k]=1;f[x][k]=(x==n);\n    int tmp,w;\n    fl(h1,i,x)\n    if((tmp=d[to]-d[x]+e[i].w)<=k)\n        if((w=dfs(to,k-tmp))){\n            if(w==-1)return w;\n            f[x][k]+=w;if(f[x][k]>mod)f[x][k]-=mod;\n        }\n    is[x][k]=0;\n    return f[x][k];\n}\nint main(){\nint T=gi(),x,y,w;\nwhile(T--){\n    n=gi();m=gi();k=gi();mod=gi();cnt=0;\n    clr(f,0);clr(h1,0);clr(h2,0);clr(is,0);\n    Fur(i,1,m)x=gi(),y=gi(),w=gi(),add(x,y,w,h1),add(y,x,w,h2);\n    spfa();printf(\"%d\\n\",dfs(1,k));\n}\n}\n```\n\n", "link": "/posts/LG 3953 \u901b\u516c\u56ed/", "tags": ["spfa", "\u8bb0\u5fc6\u5316\u641c\u7d22", "\u56fe\u8bba"], "categories": [["\u5237\u9898\u8bb0\u5f55"]]}, {"title": "Readme", "content": "## \u7b80\u4ecb\n\n[demo](https://blog.zcmimi.top/)\n\n\u672c\u535a\u5ba2\u751f\u6210\u5668\u57fa\u4e8e`python`,\u4f7f\u7528\u82e5\u5e72`pip`\u5305,\u517c\u5bb9`hexo`,`jekyll`\u7b49\u535a\u5ba2\u751f\u6210\u5668\n\n\u4f7f\u7528`markdown`,\u652f\u6301`LaTeX`\n\n\u5efa\u8bae\u5148\u4e86\u89e3\u4e0b`markdown`\u548c`yaml`\u7b49\u8bed\u6cd5\n\n\n\u76ee\u524d\u7684\u4e3b\u9898\u4e3a\u57fa\u4e8e`MDUI`\u7684`material design`\n\n## \u4f9d\u8d56\n\n### \u5fc5\u987b\n\n\u8bf7\u5148\u5b89\u88c5`python-frontmatter`\n\n```bash\npip install frontmatter\n```\n\n\u5efa\u8bae\u5148\u5c06`pip`\u6362\u4e3a\u56fd\u5185\u6e90\n\n### \u53ef\u9009\u529f\u80fd\n\n1. `htmlmin`\n\n   \u7528\u4e8e\u538b\u7f29\u7f51\u9875\u6e90\u4ee3\u7801\n\n2. `pypinyin`\n\n   \u7528\u4e8e\u751f\u6210\u535a\u6587\u7684\u62fc\u97f3\u5730\u5740\n\n3. `PyRSS2Gen`\n\n   \u7528\u4e8e\u751f\u6210\u535a\u5ba2\u7684`rss`\n   \n4. `requests`\n\n   \u7528\u4e8e\u767e\u5ea6\u63a8\u9001\n\n## \u914d\u7f6e\u6587\u4ef6\n\n`config.yml`\n\n```yaml\nsite_name: \"your blog name\" # \u7ad9\u70b9\u540d\u79f0\nsite_domain: \"example.com\" # \u57df\u540d\nsite_rt: \"\" # \u7f51\u7ad9\u6839\u76ee\u5f55\u4f4d\u7f6e\n# \u6ca1\u6709\u7279\u6b8a\u60c5\u51b5\u8bf7\u586b \"\"\n# \u6bd4\u5982\u4f60\u56e0\u4e3a\u67d0\u4e9b\u7279\u6b8a\u539f\u56e0,\u6ca1\u6cd5\u76f4\u63a5\u5728\u57df\u540d\u6839\u76ee\u5f55\u90e8\u7f72\u7f51\u7ad9,\u4f4d\u7f6e\u53d8\u6210\u4e86 example.com/web\n#   \u90a3\u4e48:\n#   site_domain: example.com\n#   site_rt: \"/web\"\n#   \u672c\u5730\u8c03\u8bd5\u65f6\u8bf7 site_rt: \"\"\n\nsite_icon: /img/avatar.webp # \u535a\u5ba2\u56fe\u6807\u56fe\u7247\u5730\u5740\nassets_rt: \n# \u5982\u679c\u6709cdn\u63d0\u9ad8assets\u6587\u4ef6\u5939\u7684\u52a0\u8f7d\u901f\u5ea6,\u8bf7\u586b\u5165\u5730\u5740\n# \u5426\u5219\u7559\u7a7a\n\navatar: /img/avatar.webp # \u535a\u5ba2\u5934\u50cf,\u9ed8\u8ba4\u5934\u50cf\u5730\u5740\nauthor: \"your name\" # \u9ed8\u8ba4\u4f5c\u8005\ntheme: clean # \u81ea\u5e26\u4e3b\u9898\u4e24\u79cd\u98ce\u683c(beauty|clean)\n\narticle_address: number # \u6587\u7ae0\u5730\u5740(number|pinyin)\n# \u82e5\u9009\u62e9pinyin,\u8bf7\u5148pip install pypinyin\n\n# \u9996\u9875\npage_articles: 10 # \u9996\u9875\u6bcf\u9875\u6587\u7ae0\u6570\npreview_len: 100  # \u9996\u9875\u6587\u7ae0\u9884\u89c8\u5b57\u6570\n\nrandomimg_type: folder # \u968f\u673a\u56fe\u7247\u5730\u5740\u7c7b\u578b(folder | list)\nrandomimg_list:        # \u968f\u673a\u56fe\u7247\u5730\u5740\u5217\u8868\n# - url\nrandomimg_path: /img # \u968f\u673a\u56fe\u7247\u6587\u4ef6\u5939\u5730\u5740\nrandomimg_tot: 33    # \u56fe\u7247\u603b\u6570\nrandomimg_suf: webp  # \u56fe\u7247\u6587\u4ef6\u540e\u7f00\u540d\n\nhtmlmin: False # \u662f\u5426\u538b\u7f29\u6e90\u4ee3\u7801\n# \u82e5\u586b1,\u8bf7\u5148pip install htmlmin\n\ncomment: False # \u662f\u5426\u5f00\u542f\u8bc4\u8bba\ncomment_typ: valine # \u76ee\u524d\u4ec5\u652f\u6301valine\n# Valine\u8bc4\u8bba(\u8bf7\u53c2\u8003https://valine.js.org/configuration.html)\nvaline_appid: <your appid>\nvaline_appkey: <your appkey>\nvaline_placeholder: \u6765\u5feb\u6d3b\u554a # \u63d0\u793a\u8bed\n\npjax: False # \u662f\u5426\u9ed8\u8ba4\u5f00\u542fpjax\n\n# \u97f3\u4e50\u64ad\u653e\u5668(\u4f7f\u7528MetingJS)\nmusic_server: netease  # \u670d\u52a1\u5668\nmusic_id: 765727960    # \u6b4c\u5355id\nmusic_order: random    # \u968f\u673a/\u987a\u5e8f\nmusic_theme: '#f7a4b9' # \u989c\u8272\n# \u8be6\u89c1https://github.com/metowolf/MetingJS\n\nbaidu_push: True # \u767e\u5ea6\u63a8\u9001 \u8bf7\u5b89\u88c5requests(pip install requests\nbaidu_push_url: http://data.zz.baidu.com/urls?site=<your site url>&token=<your token> #\u767e\u5ea6\u63a8\u9001\u63a5\u53e3\u8c03\u7528\u5730\u5740\n\nrss: False # \u751f\u6210rss(/atom.xml)\n           # \u8bf7\u5148pip install PyRSS2Gen\n\nrepo: # \u53ef\u4ee5\u540c\u65f6\u63a8\u9001\u81f3\u591a\u4e2a\u4ed3\u5e93\n  - git@github.com:zcmimi/blog.git # \u90e8\u7f72\u4ed3\u5e93\u5730\u5740\n```\n\n\n\n## \u5f00\u59cb\u5199\u4f5c\n\n### \u65b0\u5efa\u6587\u7ae0: \n\n`python blog.py n/new xxxx`\n\n\u5c06\u4f1a\u5728`source/_posts`\u6587\u4ef6\u5939\u521b\u5efa`xxxx.md`\n\n### \u65b0\u5efa\u9875\u9762\n\n`python blog.py np/newpage xxxx`\n\n\u5c06\u4f1a\u5728`source/_pages`\u6587\u4ef6\u5939\u521b\u5efa`xxxx.md`\n\n### \u9884\u89c8\n\n`python blog.py d/deploy`\n\n\n### front-matter\n\n\u4f7f\u7528`front-matter`\u8bb0\u5f55\u6587\u7ae0\u4fe1\u606f\n\n```yaml\ntitle: {title} # \u6587\u7ae0\u6807\u9898\ndate:  {date}  # \u521b\u5efa\u65e5\u671f\nauthor:        # \u6587\u7ae0\u4f5c\u8005\n               # (\u4e0d\u586b\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u4f5c\u8005)\n               \navatar:        # \u6587\u7ae0\u4f5c\u8005\u5934\u50cf\n               # (\u4e0d\u586b\u9ed8\u8ba4\u4e3a\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u5934\u50cf)\n               \ntags:          # \u6587\u7ae0\u6807\u7b7e\n# - ***\n\ncategories:    # \u6587\u7ae0\u6240\u5c5e\u5206\u7c7b\n# - [***,***]\n\nthumbnail:     # \u6587\u7ae0\u7f29\u7565\u56fe\ntop: 0         # \u9996\u9875\u7f6e\u9876\u4f18\u5148\u7ea7\n               # 0\u4e3a\u5173\u95ed\u7f6e\u9876\n               # >0,\u8d8a\u5927\u4f18\u5148\u7ea7\u8d8a\u9ad8\n               \ncomment: 1     # \u5f00\u542f/\u5173\u95ed\u8bc4\u8bba\nhtml:          # \u5728\u6587\u7ae0\u524d\u52a0\u5165html\u4ee3\u7801\n\n\u4f60\u7684\u6587\u7ae0\n```\n\n\u6ce8\u610f,\u5206\u7c7b\u4f7f\u7528\u65b9\u6cd5:\n\n```yaml\ncategories:\n- [Diary, PlayStation]\n- [Diary, Games]\n- [Life]\n```\n\n\u6b64\u65f6\u8fd9\u7bc7\u6587\u7ae0\u540c\u65f6\u5305\u62ec\u4e09\u4e2a\u5206\u7c7b\uff1a `PlayStation` \u548c `Games` \u5206\u522b\u90fd\u662f\u7236\u5206\u7c7b `Diary` \u7684\u5b50\u5206\u7c7b,\u540c\u65f6 `Life` \u662f\u4e00\u4e2a\u6ca1\u6709\u5b50\u5206\u7c7b\u7684\u5206\u7c7b\u3002\n\n### \u5185\u5bb9\n\n\u4f7f\u7528`markdown`+`latex`\n\n\u884c\u5185\u516c\u5f0f: `$...$`,$E=mc^2$\n\n\u884c\u5916\u516c\u5f0f: `$$...$$`\n$$\nE=mc^2\n$$\n\n### \u6587\u7ae0\u9875\u9762\n\n\u751f\u6210\u7684\u6587\u4ef6\u5728`/posts/xxx`\n\n\u652f\u6301\u6807\u7b7e\u548c\u5206\u7c7b\n\n\u5982\u9700\u5728\u6587\u7ae0\u4e2d\u5f15\u7528\u56fe\u7247\u6216\u6587\u4ef6,\u8bf7\u5728`source/posts/`\u6587\u4ef6\u5939\u4e2d\u65b0\u5efa\u4e00\u4e2a\u4ee5\u8be5\u7bc7\u6587\u7ae0\u6807\u9898\u547d\u540d\u7684\u6587\u4ef6\u5939,\u653e\u5165\u6587\u4ef6\u5373\u53ef\u76f4\u63a5\u5f15\u7528,\u5982`![233.png]`\n\n### \u5176\u4ed6\u9875\u9762\n\n\u751f\u6210\u7684\u6587\u4ef6\u5728`/xxx`\n\n\u652f\u6301\u6807\u7b7e,\u4e0d\u652f\u6301\u5206\u7c7b,\u4e0d\u4f1a\u5728\u9996\u9875\u663e\u793a\n\n\u8bf7\u4e0d\u8981\u65b0\u5efa\u53eb\u505a`links`\u7684\u9875\u9762,\u4f1a\u88ab\u53cb\u94fe\u9875\u9762\u8986\u76d6\n\n## \u8d44\u6e90\u6587\u4ef6\u5939\n\n\u5728`source`\u6587\u4ef6\u5939\u4e2d,\u9664\u4e86`_posts`\u548c`_pages`\u4e24\u4e2a\u6587\u4ef6\u5939,\u5176\u4ed6\u6587\u4ef6\u5939\u4f1a\u88ab\u590d\u5236\u5230\u751f\u6210\u7684\u6587\u4ef6\u5939\u7684\u6839\u76ee\u5f55\n\n\u6bd4\u5982\u65b0\u5efa`source/img/`,\u5c31\u4f1a\u88ab\u535a\u5ba2\u6839\u76ee\u5f55,\u53ef\u4ee5\u901a\u8fc7`/img/`\u8bbf\u95ee\n\n## \u90e8\u7f72\n\n\u9996\u5148\u6e32\u67d3\u535a\u5ba2,`python blog.py`\u751f\u6210\u7684\u535a\u5ba2\u6587\u4ef6\u5728`web`\u6587\u4ef6\u5939\u4e2d\n\n`python blog.py s/server`\u53ef\u4ee5\u9884\u89c8\u751f\u6210\u7684\u6587\u4ef6\n\n\u60a8\u5c06\u5b83\u53ef\u4ee5\u4e0a\u4f20\u5230\u60a8\u559c\u6b22\u7684\u5730\u65b9\n\n\u63a8\u8350\u90e8\u7f72\u5230: \n\n1. `github pages`\n\n2. `coding pages`\n\n3. `netlify`\n\n4. \u817e\u8baf\u4e91`cos`\n\n5. `gitlab pages`\n\n6. \u7528`rsync`\u6216\u5176\u4ed6\u5de5\u5177\u63a8\u9001\u5230\u60a8\u7684\u670d\u52a1\u5668\n\n\n\u76ee\u524d\u652f\u6301`git`\u7684\u65b9\u5f0f\u90e8\u7f72,\u5982\u90e8\u7f72\u5230`github pages`(\u63a8\u8350)\n\n\u8bf7\u5148\u586b\u597d`config.yml`\u4e2d\u7684`repo`\n\n\u8fd0\u884c`python blog.py d`\u4ee5\u90e8\u7f72\u535a\u5ba2\n\n\n\u5176\u4ed6\u65b9\u5f0f\u8bf7\u81ea\u884c\u4e0a\u4f20`web`\u6587\u4ef6\u5939\n\n## \u81ea\u5b9a\u4e49\n\n### \u81ea\u5b9a\u4e49\u9876\u90e8\u5e94\u7528\u680f\n\n\u8bf7\u4fee\u6539`layout/appbar.html`\n\n### \u81ea\u5b9a\u4e49\u4fa7\u8fb9\u680f\n\n\u8bf7\u7f16\u8f91`source/drawer.yml`\n\n\u5982\u679c\u4f60\u4e0d\u6ee1\u610f\u81ea\u5e26\u7684\u6a21\u677f,\u8bf7\u5220\u9664`source/drawer.yml`,\n\n\u65b0\u5efa`source/drawer.html`,\u81ea\u884c\u7f16\u8f91\n\n### \u81ea\u5b9a\u4e49\u53cb\u60c5\u94fe\u63a5\n\n\u4fee\u6539`source/_pages/links.yml`\n\n\u4f7f\u7528`yaml`\u8bed\u6cd5\n\n\u4ee5\u6211\u7684\u53cb\u94fe\u4e3a\u4f8b\u5b50: \n\n```yaml\ncomment: 1 # \u662f\u5426\u5f00\u542f\u8bc4\u8bba\ninfo: # \u6dfb\u52a0\u53cb\u94fe\u90e8\u5206\u4e0b\u65b9\u7684html\u4ee3\u7801\nFriends: # \u6b64\u680f\u76ee\u6807\u9898\n  - name: zcmimi                 # \u540d\u79f0\n    url: https://blog.zcmimi.top # \u6307\u5411\u5730\u5740\n    avatar: /img/avatar.webp     # \u5934\u50cf\n    content: \u4e00\u53ea\u53ef\u7231\u7684\u83dc\u9e21        # \u63cf\u8ff0\n    background-color: \"#ffe9f0\"  # \u5361\u7247\u80cc\u666f\u989c\u8272\n  # \u4e0b\u9762\u4ee5\u6b64\u7c7b\u63a8\n\nWebsites: # \u6b64\u680f\u76ee\u6807\u9898\n  - name: Luogu\n    url: https://www.luogu.com.cn\n    avatar: /assets/icon/luogu.png\n    content: \u8ba1\u7b97\u673a\u79d1\u5b66\u6559\u80b2\u65b0\u751f\u6001\n    background-color: \"#89aaff\"\n# \u4ee5\u6b64\u7c7b\u63a8\n```\n\n### \u6dfb\u52a0\u81ea\u5b9a\u4e49\u4ee3\u7801\n\n1. \u81ea\u5b9a\u4e49`css`\n   \n   \u4fee\u6539`assets/custom.css`,\u5b83\u4f1a\u5728\u6e90\u4ee3\u7801`head`\u90e8\u5206\u88ab\u5f15\u5165\n\n2. \u81ea\u5b9a\u4e49`html`\n   \n   \u4fee\u6539`layout/custom.html`,\u8fd9\u90e8\u5206\u4ee3\u7801\u4f1a\u6dfb\u52a0\u5230\u6e90\u4ee3\u7801\u672b\u5c3e(`</html>`\u7684\u524d\u9762)\n\n", "link": "/readme/", "tags": [], "categories": []}, {"title": "\u6570\u8bba\u5de5\u5177", "content": "\n<ul class=\"mdui-list\">\n    <li class=\"mdui-list-item\">\n        <i class=\"mdui-list-item-icon mdui-icon material-icons\" style=\"color: #1abc9c\">check_circle</i>\n        <div class=\"mdui-list-item-content\">\u8d28\u6570\u68c0\u6d4b</div>\n        <div class=\"mdui-list-item mdui-textfield\">\n            <input class=\"mdui-textfield-input\" placeholder=\"\u8bf7\u8f93\u5165\u8981\u68c0\u9a8c\u7684\u6570\u5b57\" onchange=\"prime_chk(this.value)\">\n        </div>\n    </li>\n    <li class=\"mdui-list-item\">\n        <i class=\"mdui-list-item-icon mdui-icon material-icons\" style=\"color: #1abc9c\">check_circle</i>\n        <div class=\"mdui-list-item-content\">\u6c42\u539f\u6839</div>\n        <div class=\"mdui-list-item mdui-textfield\">\n            <input class=\"mdui-textfield-input\" placeholder=\"\u8bf7\u8f93\u5165\u6a21\u6570\" onchange=\"get_primitive_root(this.value)\">\n        </div>\n    </li>\n</ul>\n\n<script>\nfunction prime_chk(x){\n    if(isNaN(x)||x<0){mdui.alert('\u8bf7\u8f93\u5165\u6709\u6548\u6570\u5b57!');node.value=\"\";return;}\n    if(x<=1){mdui.alert(x.toString()+'\u4e0d\u662f\u8d28\u6570');return;}\n    for(i=2;i*i<=x;++i)if(x%i==0){\n        mdui.alert(x.toString()+'\u4e0d\u662f\u8d28\u6570,\u53ef\u4ee5\u88ab'+i.toString()+'\u6574\u9664');\n        return;\n    }\n    mdui.alert(x.toString()+'\u662f\u8d28\u6570!');\n}\nfunction pw(x,b,p){\n    var res=1;\n    while(b){\n        if(b&1)res=res*x%p;\n        b>>=1,x=x*x%p;\n    }\n    return res;\n}\nfunction get_primitive_root(m){\n    var a=[],tt=0;\n    for(var i=2;i<=m-2;++i)\n        if((m-1)%i==0)a[++tt]=i;\n    for(var i=2;i<=10000;++i){\n        var ff=1;\n        for(var j=1;j<=tt;++j)\n            if(pw(i,a[j],m)==1){ff=0;break;}\n        if(ff){\n            mdui.alert(m.toString()+'\u7684\u539f\u6839\u662f'+i.toString());\n            return;\n        }\n    }\n    return -1;\n}\n</script>", "link": "/math-tools/", "tags": ["\u6570\u8bba"], "categories": []}, {"title": "About me", "content": "\n\n`ZC`\u662f\u6211\u540d\u5b57\u7684\u7f29\u5199,\u4f60\u4e5f\u53ef\u4ee5\u53eb\u6211`ZC`\n\n`mimi`\u662f\u5c0f\u540d,\u4f60\u4e5f\u53ef\u4ee5\u5f53\u4f5c\u662f\u732b\u732b\u7684\u610f\u601d\n\n\n`zcmimi`\u662f\u6765\u81ea\u504f\u8fdc\u5c0f\u6e14\u6751\u7684\u83dc\u9e21\n\n\u9ad8\u4e8c\u73b0\u5f79`OIer`,\u662f`Archlinuxer`\n\n\u662f`google`\u4e0e`material design`\u7684\u7c89\u4e1d\n\n\u6027\u683c\u5728`ISTP`\u4e0e`ISFJ`\u4e4b\u95f4\u5de6\u53f3\u6a2a\u8df3\n\n\u662f\u5355\u8eab\u97f3\u6e38\u72d7,\u4e3b\u73a9`malody`,\u4e5f\u4f1a\u73a9\u73a9`arcaea`,`phigros`,`cytus`\u7b49\n\n\u559c\u6b22\u5e72\u7684\u4e8b\u60c5: \u73a9\u97f3\u6e38,\u6574\u524d\u7aef,\u5f00\u53d1\u5c0f\u9879\u76ee,\u7f8e\u5316Linux,\u6253\u6570\u636e\u7ed3\u6784\n\n\u7f16\u8f91\u5668: `vscode`, \u4e3b\u9898: `nord`\n\n\u7801\u98ce: 4tab,\u5927\u62ec\u53f7\u4e0d\u6362\u884c,\u8bf4\u8bdd\u4e0d\u5e26\u7a7a\u683c,\u80fd\u77ed\u5c31\u77ed,~~\u538b\u884c\u80fd\u624b~~\n\n\u5f53\u524d\u8bbe\u5907: \n\n```zsh\n                   -`                    zcmimi@zc \n                  .o+`                   --------- \n                 `ooo/                   OS: Arch Linux x86_64 \n                `+oooo:                  Host: G3 3590 \n               `+oooooo:                 Kernel: 5.4.54-1-lts \n               -+oooooo+:                Uptime: 20 hours, 1 min \n             `/:-:++oooo+:               Packages: 1582 (pacman) \n            `/++++/+++++++:              Shell: zsh 5.8 \n           `/++++++++++++++:             Resolution: 1920x1080 \n          `/+++ooooooooooooo/`           DE: GNOME \n         ./ooosssso++osssssso+`          WM: Mutter \n        .oossssso-````/ossssss+`         WM Theme: vimix-dark-doder \n       -osssssso.      :ssssssso.        Theme: vimix-dark-laptop-doder [GTK2/3] \n      :osssssss/        osssso+++.       Icons: Vimix-Doder [GTK2/3] \n     /ossssssss/        +ssssooo/-       Terminal: gnome-terminal \n   `/ossssso+/:-        -:/+osssso+-     CPU: Intel i5-9300H (8) @ 4.100GHz \n  `+sso+:-`                 `.-/+oso:    GPU: Intel UHD Graphics 630 \n `++:.                           `-/+/   GPU: NVIDIA GeForce GTX 1650 Mobile / Max-Q \n .`                                 `/   Memory: 7596MiB / 19850MiB\n```\n\n```bash                                                                                                          \n         -o          o-            u0_a143@localhost\n          +hydNNNNdyh+             --------------        +mMMMMMMMMMMMMm+           OS: Android 9 aarch64\n      dMMm:NMMMMMMN:mMMd         Host: xiaomi Redmi Note 8\n      hMMMMMMMMMMMMMMMMMMh         Kernel: 4.14.98-perf+\n  ..  yyyyyyyyyyyyyyyyyyyy  ..     Uptime: 14 days, 4 hours, 17 mins\n.mMMmMMMMMMMMMMMMMMMMMMMMmMMm.   Packages: 104 (dpkg), 1 (pkg)\n:MMMM-MMMMMMMMMMMMMMMMMMMM-MMMM:   Shell: zsh 5.8\n:MMMM-MMMMMMMMMMMMMMMMMMMM-MMMM:   CPU: Qualcomm TRINKET (8) @ 1.804GHz\n:MMMM-MMMMMMMMMMMMMMMMMMMM-MMMM:   Memory: 3510MiB / 5637MiB\n:MMMM-MMMMMMMMMMMMMMMMMMMM-MMMM:\n-MMMM-MMMMMMMMMMMMMMMMMMMM-MMMM-\n +yy+ MMMMMMMMMMMMMMMMMMMM +yy+\n      mMMMMMMMMMMMMMMMMMMm\n      /++MMMMh++hMMMM++/\n          MMMMo  oMMMM\n          MMMMo  oMMMM\n          oNMm-  -mMNs\n```\n", "link": "/about/", "tags": [], "categories": []}, {"title": "Readme", "content": "\nhttps://www.avogado6.com/\n\n\n\n\n\n", "link": "/collection/", "tags": [], "categories": []}, {"title": "Tools", "content": "\n<ul class=\"mdui-list\">\n    <li class=\"mdui-list-item\">\n        <img class=\"mdui-list-item-icon\" src=\"https://csacademy.com/static/favicon.png\">\n        <a href=\"https://csacademy.com/app/graph_editor/\" target=\"_blank\" class=\"mdui-list-item-content\">\u6839\u636e\u6570\u636e\u751f\u6210\u56fe\u6216\u6811</a>\n    </li>\n    <li class=\"mdui-list-item\">\n        <img class=\"mdui-list-item-icon\" src=\"https://stackedit.io/static/landing/favicon.ico\">\n        <a href=\"https://stackedit.io\" target=\"_blank\" class=\"mdui-list-item-content\">\u5728\u7ebfmarkdown(\u652f\u6301latex)</a>\n    </li>\n    <li class=\"mdui-list-item\">\n        <i class=\"mdui-list-item-icon mdui-icon material-icons\">edit</i>\n        <a href=\"http://latex.codecogs.com/eqneditor/editor.php\" target=\"_blank\" class=\"mdui-list-item-content\">\u5728\u7ebfLaTeX\u7f16\u8f91\u5668</a>\n    </li>\n    <li class=\"mdui-list-item\">\n        <img class=\"mdui-list-item-icon\" src=\"https://www.geogebra.org/apps/icons/graphing.ico\">\n        <a href=\"https://www.geogebra.org/graphing\" target=\"_blank\" class=\"mdui-list-item-content\">\u5728\u7ebf\u6570\u5b66\u7ed8\u56fe</a>\n    </li>\n    <li class=\"mdui-list-item\">\n        <i class=\"mdui-list-item-icon mdui-icon material-icons\">content_paste</i>\n        <a href=\"https://paste.ubuntu.com\" target=\"_blank\" class=\"mdui-list-item-content\">\u8d34\u4ee3\u7801</a>\n    </li>\n    <li class=\"mdui-list-item\">\n        <i class=\"mdui-list-item-icon mdui-icon material-icons\" style=\"color: #ff4081\">queue_music</i>\n        <a href=\"https://music.zcmimi.top\" class=\"mdui-list-item-content\">\u6b4c\u5355\u4e0b\u8f7d\u5668</a>\n    </li>\n    <li class=\"mdui-list-item\">\n        <i class=\"mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue\">info</i>\n        <a href=\"/readme\" class=\"mdui-list-item-content\">\u5173\u4e8e\u535a\u5ba2\u751f\u6210\u5668</a>\n    </li>\n    <li class=\"mdui-list-item\">\n        <i class=\"mdui-list-item-icon mdui-icon material-icons\" style=\"color: #0041ff\">book</i>\n        <a href=\"https://mdui.org\" target=\"_blank\" class=\"mdui-list-item-content\">MDUI\u6587\u6863</a>\n    </li>\n    <li class=\"mdui-list-item\">\n        <i class=\"mdui-list-item-icon mdui-icon material-icons\" style=\"color: #0041ff\">layers</i>\n        <a href=\"/math-tools\" target=\"_blank\" class=\"mdui-list-item-content\">\u6570\u8bba\u5de5\u5177</a>\n    </li>\n    <li class=\"mdui-list-item\">\n        <i class=\"mdui-list-item-icon mdui-icon material-icons\" style=\"color: #66ccff\">functions</i>\n        <a href=\"https://webdemo.myscript.com/\" target=\"_blank\" class=\"mdui-list-item-content\">\u5728\u7ebf\u8bc6\u522b\u624b\u5199\u516c\u5f0f</a>\n    </li>\n    <li class=\"mdui-list-item\">\n        <i class=\"mdui-list-item-icon mdui-icon material-icons\" style=\"color: #66ccff\">location_searching</i>\n        <a href=\"http://oeis.org/\" target=\"_blank\" class=\"mdui-list-item-content\">\u6570\u5217\u627e\u89c4\u5f8b</a>\n    </li>\n</ul>", "link": "/tools/", "tags": [], "categories": []}, {"title": "\u53cb\u94fe", "content": "## \u6b22\u8fce\u4e92\u52a0\u53cb\u94fe!\n\n\u63a8\u8350\u65b9\u5f0f:\n\n\u8bf7\u5230[github\u4ed3\u5e93](https://github.com/zcmimi/index)\u63d0\u4ea4`pullrequest`\u7533\u8bf7,\u5ba1\u6838\u901a\u8fc7\u540e\u81ea\u52a8\u90e8\u7f72\n\n\u8be6\u89c1\u4ed3\u5e93\u8bf4\u660e\n\n\n\u53e6\u4e00\u79cd\u65b9\u5f0f:\n\n\u8bf7\u5728\u4e0b\u65b9\u8bc4\u8bba\u533a\u7559\u4e0b\u81ea\u5df1\u7684\u53cb\u94fe\n\n\u683c\u5f0f:\n- \u540d\u5b57\u6216\u6635\u79f0\n- \u7f51\u5740\n- \u63cf\u8ff0(\u5982\u4f55\u63cf\u8ff0\u60a8)\n- \u5361\u7247\u989c\u8272(\u6bd4\u5982 `#f7a4b9` )\n\n\u8bf7\u987a\u4fbf\u4e3a\u60a8\u7684\u7f51\u7ad9\u6dfb\u52a0\u4e0a\u6211\u7684\u53cb\u94feqwq\n\n> \u6635\u79f0: zcmimi\n> \n> \u7f51\u5740: https://blog.zcmimi.top\n> \n> \u5934\u50cf: https://blog.zcmimi.top/img/avatar.webp\n> \n> \u63cf\u8ff0: \u4e00\u4e2a\u83dc\u9e21OIer,\u662farchlinuxer", "link": "/links/", "tags": [], "categories": []}]